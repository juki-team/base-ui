"use strict";(self.webpackChunk_juki_team_base_ui=self.webpackChunk_juki_team_base_ui||[]).push([[2946],{"./src/components/atoms/DateLiteral/DateLiteral.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{P:function(){return DateLiteral}});var _juki_team_commons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),_helpers__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/helpers/index.ts")),_T__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/atoms/T/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js"),DateLiteral=function DateLiteral(props){var date=props.date,className=props.className,_props$show=props.show,show=void 0===_props$show?"year-month-day-hours-minutes-seconds":_props$show,twoLines=props.twoLines,withDayName=props.withDayName,_showOfDateDisplayTyp=(0,_helpers__WEBPACK_IMPORTED_MODULE_2__.lO)(show),showYears=_showOfDateDisplayTyp.showYears,showMonths=_showOfDateDisplayTyp.showMonths,showDays=_showOfDateDisplayTyp.showDays,showHours=_showOfDateDisplayTyp.showHours,showMinutes=_showOfDateDisplayTyp.showMinutes,showSeconds=_showOfDateDisplayTyp.showSeconds,showMilliseconds=_showOfDateDisplayTyp.showMilliseconds;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:(0,_helpers__WEBPACK_IMPORTED_MODULE_2__.AK)("date-literal jk-border-radius-inline",{"jk-row gap nowrap center":!twoLines,"jk-col nowrap center":!!twoLines},className),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{children:[withDayName&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_T__WEBPACK_IMPORTED_MODULE_3__.T,{children:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.kC[date.getDay()]}),", "]}),showDays&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[date.getDate()," "]}),showMonths&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_T__WEBPACK_IMPORTED_MODULE_3__.T,{children:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.Yi[date.getMonth()]})," "]}),showYears&&date.getFullYear()]}),showHours&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"cr-g3",children:[date.getHours().padStart(2),showMinutes&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[" : ",date.getMinutes().padStart(2)]}),showSeconds&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[" : ",date.getSeconds().padStart(2)]}),showMilliseconds&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[" . ",date.getMilliseconds().padStart(3)]})]})]})};DateLiteral.defaultProps={show:"year-month-day-hours-minutes-seconds"};try{DateLiteral.displayName="DateLiteral",DateLiteral.__docgenInfo={description:"",displayName:"DateLiteral",props:{date:{defaultValue:null,description:"",name:"date",required:!0,type:{name:"Date"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},show:{defaultValue:{value:"'year-month-day-hours-minutes-seconds' as DateDisplayType"},description:"",name:"show",required:!1,type:{name:"enum",value:[{value:'"year"'},{value:'"year-month"'},{value:'"year-month-day"'},{value:'"year-month-day-hours"'},{value:'"year-month-day-hours-minutes"'},{value:'"year-month-day-hours-minutes-seconds"'},{value:'"year-month-day-hours-minutes-seconds-milliseconds"'},{value:'"hours"'},{value:'"hours-minutes"'},{value:'"hours-minutes-seconds"'},{value:'"hours-minutes-seconds-milliseconds"'}]}},twoLines:{defaultValue:null,description:"",name:"twoLines",required:!1,type:{name:"boolean"}},withDayName:{defaultValue:null,description:"",name:"withDayName",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/atoms/DateLiteral/DateLiteral.tsx#DateLiteral"]={docgenInfo:DateLiteral.__docgenInfo,name:"DateLiteral",path:"src/components/atoms/DateLiteral/DateLiteral.tsx#DateLiteral"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/atoms/T/index.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{T:function(){return T}});__webpack_require__("./node_modules/react/index.js");var es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),helpers=__webpack_require__("./src/helpers/index.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),T=function T(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,children=_ref.children,t=(0,es.$G)().t;return(0,jsx_runtime.jsx)("span",{className:(0,helpers.AK)(className),children:t(children)})};try{T.displayName="T",T.__docgenInfo={description:"",displayName:"T",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/atoms/T/T.tsx#T"]={docgenInfo:T.__docgenInfo,name:"T",path:"src/components/atoms/T/T.tsx#T"})}catch(__react_docgen_typescript_loader_error){}},"./src/config/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{X:function(){return settings}});var classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),esm=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),settings=new(function(){function Settings(){(0,classCallCheck.Z)(this,Settings),this._SERVICE_API_URL="",this._UTILS_UI_URL="",this._TOKEN_NAME="",this._SERVICE_SOCKET_URL="",this._ON_ERROR=function(error){return(0,esm.Kd)({message:"a error happened",error:error})}}return(0,createClass.Z)(Settings,[{key:"SERVICE_API_URL",get:function get(){return this._SERVICE_API_URL}},{key:"UTILS_UI_URL",get:function get(){return this._UTILS_UI_URL}},{key:"TOKEN_NAME",get:function get(){return this._TOKEN_NAME}},{key:"SERVICE_SOCKET_URL",get:function get(){return this._SERVICE_SOCKET_URL}},{key:"reportError",get:function get(){return this._ON_ERROR}},{key:"getAPI",value:function getAPI(){var _this=this,valid=function valid(callback){return _this._SERVICE_API_URL?callback:function(){return{url:""}}},injectPage=function injectPage(path,page,size){return path+"page=".concat(page,"&size=").concat(size)},injectSort=function injectSort(path,sortUrl){return path+(sortUrl?"&"+sortUrl:"")},injectFilter=function injectFilter(path,filterUrl){return path+(filterUrl?"&"+filterUrl:"")},injectBaseUrl=function injectBaseUrl(prefix,path){return"".concat(_this._SERVICE_API_URL,"/").concat(prefix).concat(path)};return{auth:{ping:valid((function(){return{url:injectBaseUrl("auth","/ping"),method:esm.Ik.GET}})),signIn:valid((function(_ref){var body=_ref.body;return{url:injectBaseUrl("auth","/sign-in"),method:esm.Ik.POST,body:JSON.stringify(body)}})),signUp:valid((function(_ref2){var body=_ref2.body;return{url:injectBaseUrl("auth","/sign-up"),method:esm.Ik.POST,body:JSON.stringify(body)}})),signOut:valid((function(){return{url:injectBaseUrl("auth","/sign-out"),method:esm.Ik.POST}})),initiateResetPassword:valid((function(_ref3){var body=_ref3.body;return{url:injectBaseUrl("auth","/initiate-reset-password"),method:esm.Ik.POST,body:JSON.stringify(body)}})),updatePassword:valid((function(_ref4){var body=_ref4.body;return{url:injectBaseUrl("auth","/update-password"),method:esm.Ik.POST,body:JSON.stringify(body)}})),resetPassword:valid((function(_ref5){var _ref5$params=_ref5.params,companyKey=_ref5$params.companyKey,nickname=_ref5$params.nickname;return{url:injectBaseUrl("auth","/company/".concat(companyKey,"/nickname/").concat(nickname,"/reset-password")),method:esm.Ik.POST}}))},log:valid((function(_ref6){var body=_ref6.body;return{url:injectBaseUrl("log","/error"),method:esm.Ik.POST,body:JSON.stringify(body)}})),user:{summary:valid((function(_ref7){var nickname=_ref7.params.nickname;return{url:injectBaseUrl("user","/nickname/".concat(nickname,"/summary")),method:esm.Ik.GET}})),summaryList:valid((function(_ref8){var companyKey=_ref8.params.companyKey;return{url:injectBaseUrl("user","/company/".concat(companyKey,"/summary-list")),method:esm.Ik.GET}})),updateProfileData:valid((function(_ref9){var nickname=_ref9.params.nickname,body=_ref9.body;return{url:injectBaseUrl("user","/nickname/".concat(nickname,"/profile-data")),method:esm.Ik.PUT,body:JSON.stringify(body)}})),updateProfileImage:valid((function(_ref10){var nickname=_ref10.params.nickname,body=_ref10.body;return{url:injectBaseUrl("user","/nickname/".concat(nickname,"/profile-image")),method:esm.Ik.PUT,body:body}})),updatePreferences:valid((function(_ref11){var nickname=_ref11.params.nickname,body=_ref11.body;return{url:injectBaseUrl("user","/nickname/".concat(nickname,"/preferences")),method:esm.Ik.PUT,body:JSON.stringify(body)}})),deleteSession:valid((function(_ref12){var sessionId=_ref12.params.sessionId;return{url:injectBaseUrl("user","/session/".concat(sessionId)),method:esm.Ik.DELETE}}))},problem:{list:valid((function(_ref13){var _ref13$params=_ref13.params,page=_ref13$params.page,size=_ref13$params.size,filterUrl=_ref13$params.filterUrl,sortUrl=_ref13$params.sortUrl;return{url:injectSort(injectFilter(injectPage(injectBaseUrl("problem","/list?"),page,size),filterUrl),sortUrl)}})),summary:valid((function(_ref14){var _ref14$params=_ref14.params,judge=_ref14$params.judge,key=_ref14$params.key;return{url:injectBaseUrl("problem","/".concat((0,esm.a3)(judge,key),"/summary"))}}))},image:{list:valid((function(){return{url:injectBaseUrl("image","/list")}})),create:valid((function(_ref15){var body=_ref15.body;return{url:injectBaseUrl("image",""),method:esm.Ik.POST,body:body}}))},note:{publish:valid((function(_ref16){var body=_ref16.body;return{url:injectBaseUrl("note","/publish"),method:esm.Ik.POST,headers:{"Content-Type":"application/json"},body:JSON.stringify(body)}})),view:valid((function(_ref17){var sourceUrl=_ref17.params.sourceUrl;return{url:injectBaseUrl("note","/v?sourceUrl=".concat(sourceUrl))}})),viewFullscreen:valid((function(_ref18){var sourceUrl=_ref18.params.sourceUrl;return{url:injectBaseUrl("note","/v?sourceUrl=".concat(sourceUrl,"&view=fullscreen"))}})),pdf:valid((function(_ref19){var sourceUrl=_ref19.params.sourceUrl;return{url:injectBaseUrl("note","/pdf?sourceUrl=".concat(sourceUrl))}}))},code:{run:valid((function(_ref20){var body=_ref20.body;return{url:injectBaseUrl("code","/run"),method:esm.Ik.POST,body:JSON.stringify(body)}}))},websocket:{connect:function connect(){return{url:_this._SERVICE_SOCKET_URL}}}}}},{key:"setSetting",value:function setSetting(serviceApiUrl,socketServiceUrl,utilsUiUrl,tokenName){this._SERVICE_API_URL=serviceApiUrl,this._SERVICE_SOCKET_URL=socketServiceUrl,this._UTILS_UI_URL=utilsUiUrl,this._TOKEN_NAME=tokenName}},{key:"setOnError",value:function setOnError(onError){this._ON_ERROR=onError}}]),Settings}())},"./src/helpers/index.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{AK:function(){return classNames},io:function(){return downloadBlobAsFile},FB:function(){return getTextContent},q$:function(){return handleShareMdPdf},YO:function(){return isOverflowed},Jd:function(){return isTrigger},ks:function(){return localStorageCrossDomains},mp:function(){return renderChildrenWithProps},zl:function(){return renderReactNodeOrFunction},c_:function(){return renderReactNodeOrFunctionP1},lO:function(){return showOfDateDisplayType},SE:function(){return toBlob}});var regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),esm=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),react=__webpack_require__("./node_modules/react/index.js"),config=__webpack_require__("./src/config/index.tsx"),services=__webpack_require__("./src/services/index.tsx"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),_excluded=["url"],openNewTab=function openNewTab(url){var _window,newWindow=null===(_window=window)||void 0===_window?void 0:_window.open(url,"_blank","noopener,noreferrer");newWindow&&(newWindow.opener=null)},utils_publishNote=function(){var _ref=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(source){var _settings$getAPI$note,url,options,request;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _settings$getAPI$note=config.X.getAPI().note.publish({body:{source:source.trim()}}),url=_settings$getAPI$note.url,options=(0,objectWithoutProperties.Z)(_settings$getAPI$note,_excluded),_context.t0=services.XG,_context.next=4,(0,services.Bb)(url,options);case 4:if(_context.t1=_context.sent,null==(request=(0,_context.t0)(_context.t1))||!request.success||null==request||!request.content.sourceUrl){_context.next=8;break}return _context.abrupt("return",request.content.sourceUrl);case 8:return(0,esm.Kd)({message:"error on publish note",request:request}),_context.abrupt("return","");case 10:case"end":return _context.stop()}}),_callee)})));return function publishNote(_x){return _ref.apply(this,arguments)}}(),handleShareMdPdf=function handleShareMdPdf(type,source,sourceUrl,setSourceUrl){return(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(){var url;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(url=sourceUrl,sourceUrl){_context2.next=6;break}return _context2.next=4,utils_publishNote(source);case 4:url=_context2.sent,setSourceUrl(url);case 6:if(!url){_context2.next=10;break}openNewTab("md-fullscreen"===type?config.X.getAPI().note.viewFullscreen({params:{sourceUrl:url}}).url:"md"===type?config.X.getAPI().note.view({params:{sourceUrl:url}}).url:config.X.getAPI().note.pdf({params:{sourceUrl:url}}).url),_context2.next=11;break;case 10:throw new Error("no url generated");case 11:case"end":return _context2.stop()}}),_callee2)})))},getTextContent=function getTextContent(elem){if(!elem)return"";if("string"==typeof elem||"number"==typeof elem)return elem+"";if(elem instanceof Array)return elem.map(getTextContent).join("");if("object"==typeof elem&&"props"in elem){var children=elem.props.children;return children instanceof Array?children.map(getTextContent).join(""):getTextContent(children)}return""},downloadLink=function downloadLink(href,fileName){var tempLink=document.createElement("a");tempLink.style.display="none",tempLink.setAttribute("href",href),tempLink.setAttribute("download",fileName),void 0===tempLink.download&&tempLink.setAttribute("target","_blank"),document.body.appendChild(tempLink),tempLink.click(),document.body.removeChild(tempLink),setTimeout((function(){var _window;null===(_window=window)||void 0===_window||_window.URL.revokeObjectURL(href)}),100)};function downloadBlobAsFile(_x){return _downloadBlobAsFile.apply(this,arguments)}function _downloadBlobAsFile(){return _downloadBlobAsFile=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee3(data){var _window3,fileName,blob,blobURL,_args3=arguments;return(0,regeneratorRuntime.Z)().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:fileName=_args3.length>1&&void 0!==_args3[1]?_args3[1]:"file",blob=new Blob([data],{type:data.type||"application/octet-stream"}),blobURL=null===(_window3=window)||void 0===_window3?void 0:_window3.URL.createObjectURL(blob),downloadLink(blobURL,fileName);case 4:case"end":return _context3.stop()}}),_callee3)}))),_downloadBlobAsFile.apply(this,arguments)}var renderChildrenWithProps=function renderChildrenWithProps(children,props){return"function"==typeof children?children(props):react.Children.map(children,(function(child){return child?(0,react.cloneElement)(child,props):child}))},renderReactNodeOrFunction=function renderReactNodeOrFunction(content){return"function"==typeof content?content():content},renderReactNodeOrFunctionP1=function renderReactNodeOrFunctionP1(content,prop1){return"function"==typeof content?content(prop1):content},classNames=function classNames(c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15){var classes="";return[c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15].forEach((function(prop){if(prop)if("string"==typeof prop)classes+=(classes?" ":"")+prop;else for(var propKey in prop)prop[propKey]&&(classes+=(classes?" ":"")+propKey)})),classes},isTrigger=function isTrigger(trigger,value){return trigger===value||Array.isArray(trigger)&&trigger.includes(value)};function toBlob(canvas){return new Promise((function(resolve){canvas.toBlob(resolve)}))}var isOverflowed=function isOverflowed(ref){var _ref$current,_ref$current2;return(null===(_ref$current=ref.current)||void 0===_ref$current?void 0:_ref$current.scrollWidth)>(null===(_ref$current2=ref.current)||void 0===_ref$current2?void 0:_ref$current2.offsetWidth)},showOfDateDisplayType=function showOfDateDisplayType(type){var showMilliseconds=type.includes("milliseconds"),showSeconds=type.includes("seconds"),showMinutes=type.includes("minutes"),showHours=type.includes("hours"),showDays=type.includes("day"),showMonths=type.includes("month");return{showYears:type.includes("year"),showMonths:showMonths,showDays:showDays,showHours:showHours,showMinutes:showMinutes,showSeconds:showSeconds,showMilliseconds:showMilliseconds}},createForOfIteratorHelper=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js"),isIFrame=function isIFrame(input){return null!==input&&"IFRAME"===input.tagName},localStorageCrossDomains={setItem:function setItem(key,value){localStorage.setItem(key,value);var _step,iframes=document.getElementsByClassName("juki-iframe-cross-domain"),_iterator=(0,createForOfIteratorHelper.Z)(iframes);try{for(_iterator.s();!(_step=_iterator.n()).done;){var iframe=_step.value;if(isIFrame(iframe)&&iframe.contentWindow){var window=iframe.contentWindow;null==window||window.postMessage({action:"localStorage.setItem",key:key,value:value},new URL(iframe.src).origin)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}},removeItem:function removeItem(key){localStorage.removeItem(key);var _step2,iframes=document.getElementsByClassName("juki-iframe-cross-domain"),_iterator2=(0,createForOfIteratorHelper.Z)(iframes);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var iframe=_step2.value;if(isIFrame(iframe)&&iframe.contentWindow){var window=iframe.contentWindow;null==window||window.postMessage({action:"localStorage.removeItem",key:key},new URL(iframe.src).origin)}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}},"./src/services/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{pz:function(){return SocketIo},Bb:function(){return authorizedRequest},XG:function(){return fetch_cleanRequest}});var regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),esm=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),config=__webpack_require__("./src/config/index.tsx"),fetch_cleanRequest=function cleanRequest(responseText){if(!(0,esm.DI)(responseText)){var _response={success:!1,message:esm.pn[esm.jK.ERR9999].message,errors:[{code:esm.jK.ERR9999,detail:"",message:esm.pn[esm.jK.ERR9999].message}]};return config.X.reportError({message:"success false on cleaning request",responseText:responseText,response:_response}),_response}var responseJson=JSON.parse(responseText);if("boolean"==typeof responseJson.success){if(!0===responseJson.success&&"string"==typeof responseJson.message&&responseJson.content)return{success:!0,message:responseJson.message,content:responseJson.content};if(!0===responseJson.success&&"string"==typeof responseJson.message&&Array.isArray(responseJson.contents)&&responseJson.meta)return{success:!0,message:responseJson.message,contents:responseJson.contents,meta:responseJson.meta};if(!1===responseJson.success&&"string"==typeof responseJson.message&&Array.isArray(responseJson.errors)){var _response2={success:!1,message:responseJson.message,errors:responseJson.errors};return config.X.reportError({message:"success false on cleaning request",responseText:responseText,response:_response2}),_response2}}var response={success:!1,message:esm.pn[esm.jK.ERR9998].message,errors:[{code:esm.jK.ERR9998,detail:"",message:esm.pn[esm.jK.ERR9998].message}]};return config.X.reportError({message:"success false on cleaning request",responseText:responseText,response:response}),response},authorizedRequest=function(){var _ref=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(url,options){var _ref2,method,body,signal,responseType,requestHeaders,token;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return method=(_ref2=options||{}).method,body=_ref2.body,signal=_ref2.signal,responseType=_ref2.responseType,(requestHeaders=new Headers).set("Accept","application/json"),body instanceof FormData||requestHeaders.set("Content-Type","application/json"),(token=(null==options?void 0:options.token)||localStorage.getItem(config.X.TOKEN_NAME))&&requestHeaders.set("Authorization","Bearer ".concat(token)),_context.next=8,fetch(url,(0,objectSpread2.Z)((0,objectSpread2.Z)({method:method||esm.Ik.GET,headers:requestHeaders,credentials:"include"},body?{body:body}:{}),signal?{signal:signal}:{})).then((function(response){return"blob"===responseType?response.blob():response.text()})).catch((function(error){return(0,esm.Kd)({message:"error on fetch url: ".concat(url),error:error}),null!=signal&&signal.aborted?JSON.stringify({success:!1,message:esm.pn[esm.jK.ERR9997].message,errors:[{code:esm.jK.ERR9997,detail:"[".concat(method,"] ").concat(url," \n ").concat(body)}]}):JSON.stringify({success:!1,message:esm.pn[esm.jK.ERR9998].message,errors:[{code:esm.jK.ERR9998,detail:"FETCH CATCH ERROR : "+JSON.stringify({method:method,url:url,body:body,error:error})}]})}));case 8:return _context.abrupt("return",_context.sent);case 9:case"end":return _context.stop()}}),_callee)})));return function authorizedRequest(_x,_x2){return _ref.apply(this,arguments)}}(),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),build_esm=__webpack_require__("./node_modules/socket.io-client/build/esm/index.js"),SocketIo=function(){function SocketIo(){(0,classCallCheck.Z)(this,SocketIo),this._socket=null,this._sessionId=""}var _leaveSession,_joinSession;return(0,createClass.Z)(SocketIo,[{key:"start",value:function start(){var _this=this;this._socket&&this._socket.disconnect(),this._socket=(0,build_esm.ZP)(config.X.getAPI().websocket.connect().url,{withCredentials:!0,transports:["websocket"],autoConnect:!1,reconnection:!0}),this._socket.connect(),this._socket.on("connect",(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(){return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return console.info("socket connected"),_context.next=3,_this.joinSession();case 3:case"end":return _context.stop()}}),_callee)})))),this._socket.on("disconnect",(function(){console.info("socket disconnect")})),this._socket.on("connect_error",(function(err){(0,esm.Kd)("connect_error due to ".concat(err.message))}))}},{key:"stop",value:function stop(){this._socket&&this._socket.disconnect(),this._socket=null}},{key:"emitAsync",value:function emitAsync(event,payload){var _this2=this;return new Promise((function(resolve,reject){var _this2$_socket;return _this2._socket||(0,esm.Kd)("the socket isn't ready, the event will be lost"),null===(_this2$_socket=_this2._socket)||void 0===_this2$_socket?void 0:_this2$_socket.emit(event,payload,(function(response){if(response.success)return resolve(response);reject(response)}))}))}},{key:"joinSession",value:(_joinSession=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(){var response;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(this._sessionId=localStorage.getItem(config.X.TOKEN_NAME)||"",!this._sessionId){_context2.next=14;break}return _context2.prev=2,_context2.next=5,this.emitAsync(esm.VG.SIGN_IN,this._sessionId);case 5:response=_context2.sent,console.info(response.message),_context2.next=12;break;case 9:_context2.prev=9,_context2.t0=_context2.catch(2),(0,esm.Kd)({message:"error on joinSession",error:_context2.t0});case 12:_context2.next=15;break;case 14:(0,esm.Kd)({message:"join session failed, invalid cookie session"});case 15:case"end":return _context2.stop()}}),_callee2,this,[[2,9]])}))),function joinSession(){return _joinSession.apply(this,arguments)})},{key:"leaveSession",value:(_leaveSession=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee3(){var response;return(0,regeneratorRuntime.Z)().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!this._sessionId){_context3.next=13;break}return _context3.prev=1,_context3.next=4,this.emitAsync(esm.VG.SIGN_OUT,this._sessionId);case 4:response=_context3.sent,console.info(response.message),_context3.next=11;break;case 8:_context3.prev=8,_context3.t0=_context3.catch(1),(0,esm.Kd)({message:"error on leaveSession",error:_context3.t0});case 11:_context3.next=14;break;case 13:(0,esm.Kd)({message:"leave session failed, invalid cookie session"});case 14:this._sessionId="";case 15:case"end":return _context3.stop()}}),_callee3,this,[[1,8]])}))),function leaveSession(){return _leaveSession.apply(this,arguments)})},{key:"on",value:function on(message,listener){return this._socket?(this._socket.on(message,listener),!0):((0,esm.Kd)("the socket isn't ready, the listener will be added when socket is ready"),!1)}},{key:"off",value:function off(message,listener){return this._socket?(this._socket.off(message,listener),!0):((0,esm.Kd)("the socket isn't ready, the listener will be added when socket is ready"),!1)}}]),SocketIo}();try{cleanRequest.displayName="cleanRequest",cleanRequest.__docgenInfo={description:"",displayName:"cleanRequest",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/services/index.tsx#cleanRequest"]={docgenInfo:cleanRequest.__docgenInfo,name:"cleanRequest",path:"src/services/index.tsx#cleanRequest"})}catch(__react_docgen_typescript_loader_error){}}}]);