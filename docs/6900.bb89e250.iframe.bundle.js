"use strict";(self.webpackChunk_juki_team_base_ui=self.webpackChunk_juki_team_base_ui||[]).push([[6392,6900],{"./src/components/organisms/UserCodeEditor/UserCodeEditor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{UserCodeEditor:()=>UserCodeEditor});var _juki_team_commons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_helpers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/helpers/index.ts"),_hooks__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/hooks/index.ts"),_CodeRunnerEditor_CodeRunnerEditor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/organisms/CodeRunnerEditor/CodeRunnerEditor.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");const getStoreRecovered=storeKey=>{let storeRecovered={};const localStorageData=storeKey&&localStorage.getItem(storeKey)||"{}";return(0,_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.UWh)(localStorageData)&&(storeRecovered=JSON.parse(localStorageData)),storeRecovered},useSaveChunkStorage=(storeKey,initialValue,merge)=>{const initialValueString=JSON.stringify(initialValue),mergeRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(merge);mergeRef.current=merge;const mergeState=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((()=>{let initialValue={};(0,_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.UWh)(initialValueString)&&(initialValue=JSON.parse(initialValueString));const newState={},storeRecovered=Object.entries(getStoreRecovered(storeKey));for(const[key,value]of Object.entries(initialValue)){var _storeRecovered$find;newState[key]=mergeRef.current(value,null===(_storeRecovered$find=storeRecovered.find((_ref=>{let[storeRecoveredKey]=_ref;return storeRecoveredKey===key})))||void 0===_storeRecovered$find?void 0:_storeRecovered$find[1])}for(const[key,value]of storeRecovered)newState[key]||(newState[key]=value);return newState}),[initialValueString,storeKey]),[value,setValue]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(mergeState());return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{setValue(mergeState())}),[mergeState]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{const stringValue=JSON.stringify(value);localStorage.getItem(storeKey)!==stringValue&&localStorage.setItem(storeKey,stringValue)}),[storeKey,value]),[value,setValue]},UserCodeEditor=props=>{var _sourceStore$storeKey;const{className,expandPosition,initialTestCases,initialLanguage,storeKey,languages,leftButtons,centerButtons,rightButtons,onSourceChange,onLanguageChange,onTestCasesChange,initialSource,enableAddSampleCases,enableAddCustomSampleCases,onIsRunningChange,readOnly,withoutRunCodeButton,onCodeRunStatusChange,onlyCodeEditor}=props,userNickname=(0,_hooks__WEBPACK_IMPORTED_MODULE_3__.kH)((state=>state.user.nickname)),editorSettingsStorageKey=(0,_helpers__WEBPACK_IMPORTED_MODULE_2__.rK)(userNickname),[editorSettings,setEditorSettings]=((storeKey,defaultValue)=>{const storeRecovered=getStoreRecovered(storeKey),[value,setValue]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({...defaultValue,...storeRecovered}),defaultValueRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(defaultValue);defaultValueRef.current=defaultValue;const storeRecoveredRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(storeRecovered);return storeRecoveredRef.current=storeRecovered,(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{setValue({...defaultValueRef.current,...storeRecoveredRef.current})}),[storeKey]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{if(storeKey){const stringValue=JSON.stringify(value);localStorage.getItem(storeKey)!==stringValue&&localStorage.setItem(storeKey,stringValue)}}),[storeKey,value]),[value,setValue]})(editorSettingsStorageKey,{theme:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.Sxu.LIGHT,lastLanguageUsed:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.A3Q.CPP,tabSize:2,fontSize:14}),[language,setLanguage]=(0,_hooks__WEBPACK_IMPORTED_MODULE_3__.ID)(null!=initialLanguage?initialLanguage:editorSettings.lastLanguageUsed),newInitialTestCases={[storeKey+"_"+language]:{...initialTestCases}};newInitialTestCases[storeKey+"_"+language]["*"]={key:"*",in:"",testOut:"",withPE:!1,sample:!1,hidden:!1,index:-1,messageTimestamp:0,out:"",err:"",log:"",status:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.aeR.NONE};const[_testCases,setTestCases]=useSaveChunkStorage((0,_helpers__WEBPACK_IMPORTED_MODULE_2__.YR)(userNickname),newInitialTestCases,((a,b)=>{const newTestCases={};for(const[key,testCase]of Object.entries(a)){var _ref2,_b$key$out,_b$key,_ref3,_b$key$err,_b$key2,_ref4,_b$key$log,_b$key3,_ref5,_b$key$status,_b$key4,_ref6,_b$key$messageTimesta,_b$key5,_ref7,_b$key$in,_b$key6;if(newTestCases[key]={...testCase,out:null!==(_ref2=null!==(_b$key$out=null==b||null===(_b$key=b[key])||void 0===_b$key?void 0:_b$key.out)&&void 0!==_b$key$out?_b$key$out:null==testCase?void 0:testCase.out)&&void 0!==_ref2?_ref2:"",err:null!==(_ref3=null!==(_b$key$err=null==b||null===(_b$key2=b[key])||void 0===_b$key2?void 0:_b$key2.err)&&void 0!==_b$key$err?_b$key$err:null==testCase?void 0:testCase.err)&&void 0!==_ref3?_ref3:"",log:null!==(_ref4=null!==(_b$key$log=null==b||null===(_b$key3=b[key])||void 0===_b$key3?void 0:_b$key3.log)&&void 0!==_b$key$log?_b$key$log:null==testCase?void 0:testCase.log)&&void 0!==_ref4?_ref4:"",status:null!==(_ref5=null!==(_b$key$status=null==b||null===(_b$key4=b[key])||void 0===_b$key4?void 0:_b$key4.status)&&void 0!==_b$key$status?_b$key$status:null==testCase?void 0:testCase.status)&&void 0!==_ref5?_ref5:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.aeR.NONE,messageTimestamp:null!==(_ref6=null!==(_b$key$messageTimesta=null==b||null===(_b$key5=b[key])||void 0===_b$key5?void 0:_b$key5.messageTimestamp)&&void 0!==_b$key$messageTimesta?_b$key$messageTimesta:null==testCase?void 0:testCase.messageTimestamp)&&void 0!==_ref6?_ref6:0},"*"===key)newTestCases[key].in=null!==(_ref7=null!==(_b$key$in=null==b||null===(_b$key6=b[key])||void 0===_b$key6?void 0:_b$key6.in)&&void 0!==_b$key$in?_b$key$in:null==testCase?void 0:testCase.in)&&void 0!==_ref7?_ref7:""}for(const[key,testCase]of Object.entries(null!=b?b:{}))newTestCases[key]||(newTestCases[key]=testCase);return newTestCases})),testCases=_testCases[storeKey+"_"+language],onLanguageChangeRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(onLanguageChange);onLanguageChangeRef.current=onLanguageChange,(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{var _onLanguageChangeRef$;null===(_onLanguageChangeRef$=onLanguageChangeRef.current)||void 0===_onLanguageChangeRef$||_onLanguageChangeRef$.call(onLanguageChangeRef,language)}),[language]);const languagesString=JSON.stringify(languages);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{const languages=JSON.parse(languagesString);if(languages.length&&!languages.some((lang=>lang.value===language))){const newLanguage=languages[0].value;setLanguage(newLanguage)}}),[language,languagesString,setLanguage]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{null==onTestCasesChange||onTestCasesChange(testCases)}),[onTestCasesChange,testCases]);const newInitialSource={[storeKey]:{...initialSource,key:storeKey}};for(const{value}of JSON.parse(languagesString)){var _PROGRAMMING_LANGUAGE;if(!newInitialSource[storeKey][value])newInitialSource[storeKey][value]=(null===(_PROGRAMMING_LANGUAGE=_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tcq[value])||void 0===_PROGRAMMING_LANGUAGE?void 0:_PROGRAMMING_LANGUAGE.templateSourceCode)||""}const[sourceStore,setSourceStore]=useSaveChunkStorage((0,_helpers__WEBPACK_IMPORTED_MODULE_2__.x$)(userNickname),newInitialSource,((a,b)=>({...a,...b}))),sourceCode=(null===(_sourceStore$storeKey=sourceStore[storeKey])||void 0===_sourceStore$storeKey?void 0:_sourceStore$storeKey[language])||"";return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_CodeRunnerEditor_CodeRunnerEditor__WEBPACK_IMPORTED_MODULE_4__.CodeRunnerEditor,{className,theme:editorSettings.theme,tabSize:editorSettings.tabSize,fontSize:editorSettings.fontSize,sourceCode,language,languages,readOnly,onChange:_ref8=>{let{sourceCode:newSourceCode,language:newLanguage,onTestCasesChange,theme,tabSize,fontSize,isRunning,codeRunStatus}=_ref8;codeRunStatus&&(null==onCodeRunStatusChange||onCodeRunStatusChange(codeRunStatus,{language,sourceCode,testCases})),"boolean"==typeof isRunning&&(null==onIsRunningChange||onIsRunningChange(isRunning)),"string"==typeof newSourceCode&&(setSourceStore((prevState=>({...prevState,[storeKey]:{...prevState[storeKey]||{},[language]:newSourceCode}}))),null==onSourceChange||onSourceChange(newSourceCode)),newLanguage&&(setLanguage(newLanguage),setEditorSettings((prevState=>({...prevState,lastLanguageUsed:newLanguage})))),onTestCasesChange&&setTestCases((prevState=>({...prevState,[storeKey+"_"+language]:onTestCasesChange(prevState[storeKey+"_"+language]||{})}))),theme&&setEditorSettings((prevState=>({...prevState,theme}))),tabSize&&setEditorSettings((prevState=>({...prevState,tabSize}))),fontSize&&setEditorSettings((prevState=>({...prevState,fontSize})))},leftButtons,centerButtons,rightButtons,testCases,expandPosition,enableAddSampleCases,enableAddCustomSampleCases,withoutRunCodeButton,onlyCodeEditor})};try{UserCodeEditor.displayName="UserCodeEditor",UserCodeEditor.__docgenInfo={description:"",displayName:"UserCodeEditor",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},expandPosition:{defaultValue:null,description:"",name:"expandPosition",required:!1,type:{name:"CodeEditorExpandPositionType"}},initialTestCases:{defaultValue:null,description:"",name:"initialTestCases",required:!1,type:{name:"CodeEditorTestCasesType"}},initialLanguage:{defaultValue:null,description:"",name:"initialLanguage",required:!1,type:{name:"T"}},storeKey:{defaultValue:null,description:"",name:"storeKey",required:!0,type:{name:"string"}},languages:{defaultValue:null,description:"",name:"languages",required:!0,type:{name:"{ value: T; label: string; }[]"}},leftButtons:{defaultValue:null,description:"",name:"leftButtons",required:!1,type:{name:"CodeEditorCenterButtonsType<T>"}},centerButtons:{defaultValue:null,description:"",name:"centerButtons",required:!1,type:{name:"CodeEditorCenterButtonsType<T>"}},rightButtons:{defaultValue:null,description:"",name:"rightButtons",required:!1,type:{name:'((props: Omit<CodeEditorCenterButtonsPropertiesType<T>, "widthContainer">) => ReactNode)'}},onSourceChange:{defaultValue:null,description:"",name:"onSourceChange",required:!1,type:{name:"((source: string) => void)"}},onLanguageChange:{defaultValue:null,description:"",name:"onLanguageChange",required:!1,type:{name:"((language: T) => void)"}},onTestCasesChange:{defaultValue:null,description:"",name:"onTestCasesChange",required:!1,type:{name:"((testCases: CodeEditorTestCasesType) => void)"}},onIsRunningChange:{defaultValue:null,description:"",name:"onIsRunningChange",required:!1,type:{name:"((isRunning: boolean) => void)"}},initialSource:{defaultValue:null,description:"",name:"initialSource",required:!1,type:{name:"{ [key: string]: string; }"}},enableAddSampleCases:{defaultValue:null,description:"",name:"enableAddSampleCases",required:!1,type:{name:"boolean"}},enableAddCustomSampleCases:{defaultValue:null,description:"",name:"enableAddCustomSampleCases",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},withoutRunCodeButton:{defaultValue:null,description:"",name:"withoutRunCodeButton",required:!1,type:{name:"boolean"}},onCodeRunStatusChange:{defaultValue:null,description:"",name:"onCodeRunStatusChange",required:!1,type:{name:"((runStatus: SubmissionRunStatus, props: { sourceCode: string; language: T; testCases: CodeEditorTestCasesType; }) => void)"}},onlyCodeEditor:{defaultValue:null,description:"",name:"onlyCodeEditor",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/UserCodeEditor/UserCodeEditor.tsx#UserCodeEditor"]={docgenInfo:UserCodeEditor.__docgenInfo,name:"UserCodeEditor",path:"src/components/organisms/UserCodeEditor/UserCodeEditor.tsx#UserCodeEditor"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/organisms/worksheet/WorksheetBody.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WorksheetBody:()=>WorksheetBody});var esm=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),react=__webpack_require__("./node_modules/react/index.js"),helpers=__webpack_require__("./src/helpers/index.ts"),constants=__webpack_require__("./src/constants/index.ts"),atoms=__webpack_require__("./src/components/atoms/index.tsx"),server=__webpack_require__("./src/components/atoms/server/index.ts"),molecules=__webpack_require__("./src/components/molecules/index.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const AddNewChild=props=>{const{index,setSheet,mdSheet,codeEditorSheet,graphSheet,listSheet,quizProblemSheet,pageDivider,compacted,quizOptionsSheetType,floatToolbarPlacement}=props,actionButtons=[];if(mdSheet){const onClick=()=>{setSheet((sheet=>{const newSheet=[...sheet];return newSheet.splice(index+1,0,(0,constants.Wg)()),newSheet}))};actionButtons.push({icon:(0,constants._z)("tiny")[esm.Lc_.JK_MD],label:(0,jsx_runtime.jsx)(atoms.T,{children:"+ jk md"}),onClick})}if(codeEditorSheet){const onClick=()=>{setSheet((sheet=>{const newSheet=[...sheet];return newSheet.splice(index+1,0,(0,constants.qL)()),newSheet}))};actionButtons.push({icon:(0,constants._z)("tiny")[esm.Lc_.CODE_EDITOR],label:(0,jsx_runtime.jsx)(atoms.T,{children:"+ code editor"}),onClick})}if(graphSheet){const onClick=()=>{setSheet((sheet=>{const newSheet=[...sheet];return newSheet.splice(index+1,0,(0,constants.Zk)()),newSheet}))};actionButtons.push({icon:(0,constants._z)("tiny")[esm.Lc_.GRAPH],label:(0,jsx_runtime.jsx)(atoms.T,{children:"+ graph"}),onClick})}if(listSheet){const onClick=()=>{setSheet((sheet=>{const newSheet=[...sheet];return newSheet.splice(index+1,0,(0,constants.z_)()),newSheet}))};actionButtons.push({icon:(0,jsx_runtime.jsx)(server.kpM,{}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"+ list"}),onClick})}if(quizProblemSheet){const onClick=()=>{setSheet((sheet=>{const newSheet=[...sheet];return newSheet.splice(index+1,0,(0,constants.KN)()),newSheet}))};actionButtons.push({icon:(0,jsx_runtime.jsx)(server.BVL,{}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"+ quiz problem"}),onClick})}if(quizOptionsSheetType){const onClick=()=>{setSheet((sheet=>{const newSheet=[...sheet];return newSheet.splice(index+1,0,(0,constants.lH)()),newSheet}))};actionButtons.push({icon:(0,constants._z)("tiny")[esm.Lc_.QUIZ_OPTIONS],label:(0,jsx_runtime.jsx)(atoms.T,{children:"+ quiz options"}),onClick})}if(pageDivider){const onClick=()=>{setSheet((sheet=>{const newSheet=[...sheet];return newSheet.splice(index+1,0,(0,esm.lgH)()),newSheet}))};actionButtons.push({icon:(0,jsx_runtime.jsx)(server.A4j,{}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"+ page divider"}),onClick})}return(0,jsx_runtime.jsxs)("div",{className:"jk-row gap",children:[compacted&&(0,jsx_runtime.jsx)(molecules.GK,{actionButtons:[{icon:(0,jsx_runtime.jsx)(server.c11,{}),buttons:actionButtons}],placement:floatToolbarPlacement}),!compacted&&actionButtons.map(((_ref,index)=>{let{icon,label,onClick}=_ref;return(0,jsx_runtime.jsx)(atoms.$n,{size:"small",icon,onClick,children:label},index)}))]})};try{AddNewChild.displayName="AddNewChild",AddNewChild.__docgenInfo={description:"",displayName:"AddNewChild",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},setSheet:{defaultValue:null,description:"",name:"setSheet",required:!0,type:{name:"SetSheetType<T>"}},mdSheet:{defaultValue:null,description:"",name:"mdSheet",required:!1,type:{name:"boolean"}},codeEditorSheet:{defaultValue:null,description:"",name:"codeEditorSheet",required:!1,type:{name:"boolean"}},graphSheet:{defaultValue:null,description:"",name:"graphSheet",required:!1,type:{name:"boolean"}},listSheet:{defaultValue:null,description:"",name:"listSheet",required:!1,type:{name:"boolean"}},quizProblemSheet:{defaultValue:null,description:"",name:"quizProblemSheet",required:!1,type:{name:"boolean"}},quizOptionsSheetType:{defaultValue:null,description:"",name:"quizOptionsSheetType",required:!1,type:{name:"boolean"}},pageDivider:{defaultValue:null,description:"",name:"pageDivider",required:!1,type:{name:"boolean"}},compacted:{defaultValue:null,description:"",name:"compacted",required:!1,type:{name:"boolean"}},floatToolbarPlacement:{defaultValue:null,description:"",name:"floatToolbarPlacement",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"center"'},{value:'"bottom"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/AddNewChild.tsx#AddNewChild"]={docgenInfo:AddNewChild.__docgenInfo,name:"AddNewChild",path:"src/components/organisms/worksheet/sheets/AddNewChild.tsx#AddNewChild"})}catch(__react_docgen_typescript_loader_error){}var hooks=__webpack_require__("./src/hooks/index.ts");const EditSheetModal=props=>{const{isOpen,onClose,content,setContent}=props,[value,setValue]=(0,hooks.ID)(isOpen&&(0,esm.on3)(content)?JSON.stringify(content,null,2):"");return(0,jsx_runtime.jsx)(atoms.aF,{isOpen,onClose,children:(0,jsx_runtime.jsxs)("div",{className:"jk-col gap jk-pg stretch",children:[(0,jsx_runtime.jsx)(atoms.lI,{className:"wh-100",size:"auto",value,onChange:setValue}),(0,jsx_runtime.jsxs)("div",{className:"jk-row-col gap right",children:[(0,jsx_runtime.jsx)(atoms.$n,{onClick:onClose,type:"light",children:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"close"})}),(0,jsx_runtime.jsx)(atoms.$n,{disabled:!(0,esm.UWh)(value)||!(0,helpers.c0)(JSON.parse(value)),onClick:()=>{if((0,esm.UWh)(value)){const obj=JSON.parse(value);(0,helpers.c0)(obj)&&(setContent(obj),onClose())}},children:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"save"})})]})]})})};try{EditSheetModal.displayName="EditSheetModal",EditSheetModal.__docgenInfo={description:"",displayName:"EditSheetModal",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"BodyWorksheetType"}},setContent:{defaultValue:null,description:"",name:"setContent",required:!0,type:{name:"Dispatch<T>"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/EditSheetModal.tsx#EditSheetModal"]={docgenInfo:EditSheetModal.__docgenInfo,name:"EditSheetModal",path:"src/components/organisms/worksheet/sheets/EditSheetModal.tsx#EditSheetModal"})}catch(__react_docgen_typescript_loader_error){}const upRemoveDownButtons=_ref=>{let{index,length,onChange}=_ref;const actionButtons=[];return 0!=index&&actionButtons.push({icon:(0,jsx_runtime.jsx)(server.U1D,{}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"move up"}),onClick:()=>{onChange((list=>{const newSheets=[...list];return[newSheets[index],newSheets[index-1]]=[newSheets[index-1],newSheets[index]],newSheets}))},disabled:0===index}),actionButtons.push({icon:(0,jsx_runtime.jsx)(server.d7y,{}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"remove"}),onClick:()=>{onChange((list=>list.filter(((_,i)=>i!==index))))}}),index!=length-1&&actionButtons.push({icon:(0,jsx_runtime.jsx)(server.RSQ,{}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"move down"}),onClick:()=>{onChange((list=>{const newSheets=[...list];return[newSheets[index],newSheets[index+1]]=[newSheets[index+1],newSheets[index]],newSheets}))},disabled:index===length-1}),actionButtons};try{upRemoveDownButtons.displayName="upRemoveDownButtons",upRemoveDownButtons.__docgenInfo={description:"",displayName:"upRemoveDownButtons",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},length:{defaultValue:null,description:"",name:"length",required:!0,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(callback: (newList: T[]) => T[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/upRemoveDownActions.tsx#upRemoveDownButtons"]={docgenInfo:upRemoveDownButtons.__docgenInfo,name:"upRemoveDownButtons",path:"src/components/organisms/worksheet/sheets/upRemoveDownActions.tsx#upRemoveDownButtons"})}catch(__react_docgen_typescript_loader_error){}const getActionButtons=props=>{const{type,edit,setEdit,saveContent,content,index,sheetLength,setSheet,setModal,reset}=props;return[{children:(0,jsx_runtime.jsxs)("div",{className:"bc-pl jk-pg-xsm jk-row cr-we gap nowrap jk-br-ie tx-t",style:{opacity:.6},children:[(0,constants._z)("tiny")[type],(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se ws-np",children:"jk md"})]})},{icon:edit?(0,jsx_runtime.jsx)(server.ITR,{size:"small"}):(0,jsx_runtime.jsx)(server.qUP,{size:"small"}),children:edit?(0,jsx_runtime.jsxs)("div",{className:" jk-col gap stretch",children:[(0,jsx_runtime.jsx)(atoms.$n,{size:"small",icon:(0,jsx_runtime.jsx)(server.LPu,{}),children:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"save"})}),(0,jsx_runtime.jsx)(atoms.$n,{size:"small",type:"light",icon:(0,jsx_runtime.jsx)(server.USm,{}),children:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"cancel"})})]}):void 0,buttons:[{icon:edit?(0,jsx_runtime.jsx)(server.LPu,{}):(0,jsx_runtime.jsx)(server.qUP,{}),label:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:edit?"save":"edit"}),onClick:()=>{setEdit(!edit),null==saveContent||saveContent(content)}},...edit?[{type:"light",icon:(0,jsx_runtime.jsx)(server.USm,{}),label:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"cancel"}),onClick:()=>{setEdit(!edit),reset()}}]:[]]},{icon:(0,jsx_runtime.jsx)(server.ycB,{className:"cr-we",up:!0,down:!0}),buttons:upRemoveDownButtons({index,length:sheetLength,onChange:callback=>null==setSheet?void 0:setSheet((sheet=>callback(sheet)))})},{icon:(0,jsx_runtime.jsx)(server.Zes,{}),buttons:[{icon:(0,jsx_runtime.jsx)(server.Zes,{}),label:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"view settings"}),onClick:()=>setModal(!0)}]}]};try{getActionButtons.displayName="getActionButtons",getActionButtons.__docgenInfo={description:"",displayName:"getActionButtons",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"JK_MD"'},{value:'"CODE_EDITOR"'},{value:'"LIST"'},{value:'"GRAPH"'},{value:'"QUIZ_PROBLEM"'},{value:'"QUIZ_TEXT"'},{value:'"QUIZ_OPTIONS"'},{value:'"NEW_PAGE"'}]}},edit:{defaultValue:null,description:"",name:"edit",required:!0,type:{name:"boolean"}},setEdit:{defaultValue:null,description:"",name:"setEdit",required:!0,type:{name:"(edit: boolean) => void"}},setModal:{defaultValue:null,description:"",name:"setModal",required:!0,type:{name:"(modal: boolean) => void"}},content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"BodyWorksheetType"}},saveContent:{defaultValue:null,description:"",name:"saveContent",required:!1,type:{name:"SetContentType<T>"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},sheetLength:{defaultValue:null,description:"",name:"sheetLength",required:!0,type:{name:"number"}},setSheet:{defaultValue:null,description:"",name:"setSheet",required:!1,type:{name:"SetSheetType<BodyWorksheetType>"}},reset:{defaultValue:null,description:"",name:"reset",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/getActionButtons.tsx#getActionButtons"]={docgenInfo:getActionButtons.__docgenInfo,name:"getActionButtons",path:"src/components/organisms/worksheet/sheets/getActionButtons.tsx#getActionButtons"})}catch(__react_docgen_typescript_loader_error){}var CodeRunnerEditor=__webpack_require__("./src/components/organisms/CodeRunnerEditor/CodeRunnerEditor.tsx");const CodeEditorSheetSectionEditor=_ref=>{var _sheet$sourceCode,_sheet$languages;let{content:initialSheet,setContent:_setSheet}=_ref;const[sheet,setSheet]=(0,react.useState)(initialSheet),[languageEditor,setLanguageEditor]=(0,react.useState)(esm.A3Q.CPP17),sourceCode=(null===(_sheet$sourceCode=sheet.sourceCode)||void 0===_sheet$sourceCode?void 0:_sheet$sourceCode[languageEditor])||"";return(0,jsx_runtime.jsxs)("div",{className:"jk-col gap stretch left jk-pg-md",children:[(0,jsx_runtime.jsxs)("div",{className:"jk-row gap",children:[(0,jsx_runtime.jsxs)("div",{className:"flex-1",children:[(0,jsx_runtime.jsx)(atoms.T,{className:"fw-bd tt-se",children:"languages"}),":",(0,jsx_runtime.jsx)(atoms.KF,{options:esm.O5.map((key=>({value:key,label:esm.tcq[key].label}))),selectedOptions:null===(_sheet$languages=sheet.languages)||void 0===_sheet$languages?void 0:_sheet$languages.map((language=>({value:language}))),onChange:options=>setSheet((prevState=>({...prevState,languages:options.map((option=>option.value))}))),expand:!0})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{className:"jk-row gap space-between",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(atoms.T,{className:"fw-bd tt-se",children:"height"}),":"]}),(0,jsx_runtime.jsx)(atoms.GL,{checked:0===sheet.height,label:(0,jsx_runtime.jsx)(atoms.T,{children:"auto"}),onChange:value=>setSheet((prevState=>({...prevState,height:value?0:constants.o})))})]}),0!==sheet.height&&(0,jsx_runtime.jsxs)("div",{className:"jk-row",children:[(0,jsx_runtime.jsx)(atoms.pd,{type:"number",value:sheet.height,onChange:value=>setSheet((prevState=>({...prevState,height:Math.abs(value)}))),size:"auto"}),(0,jsx_runtime.jsx)(atoms.T,{children:"px"})]})]})]}),(0,jsx_runtime.jsx)("div",{style:{height:(0,helpers.Oq)(sheet.height,sourceCode)},className:"jk-row",children:(0,jsx_runtime.jsx)(CodeRunnerEditor.CodeRunnerEditor,{sourceCode,onChange:_ref2=>{let{sourceCode,language,onTestCasesChange}=_ref2;void 0!==sourceCode&&setSheet((prevState=>({...prevState,sourceCode:{...prevState.sourceCode,[languageEditor]:sourceCode}}))),language&&setLanguageEditor(language),onTestCasesChange&&setSheet((prevState=>({...prevState,testCases:onTestCasesChange(prevState.testCases)})))},language:languageEditor,testCases:sheet.testCases,languages:sheet.languages.map((lang=>{var _PROGRAMMING_LANGUAGE;return{value:lang,label:(null===(_PROGRAMMING_LANGUAGE=esm.tcq[lang])||void 0===_PROGRAMMING_LANGUAGE?void 0:_PROGRAMMING_LANGUAGE.label)||lang}})),enableAddSampleCases:!0})})]})};try{CodeEditorSheetSectionEditor.displayName="CodeEditorSheetSectionEditor",CodeEditorSheetSectionEditor.__docgenInfo={description:"",displayName:"CodeEditorSheetSectionEditor",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"CodeEditorSheetType"}},setContent:{defaultValue:null,description:"",name:"setContent",required:!0,type:{name:"SetContentType<CodeEditorSheetType>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/CodeEditorSheetSection/CodeEditorSheetSectionEditor.tsx#CodeEditorSheetSectionEditor"]={docgenInfo:CodeEditorSheetSectionEditor.__docgenInfo,name:"CodeEditorSheetSectionEditor",path:"src/components/organisms/worksheet/sheets/CodeEditorSheetSection/CodeEditorSheetSectionEditor.tsx#CodeEditorSheetSectionEditor"})}catch(__react_docgen_typescript_loader_error){}var settings=__webpack_require__("./src/settings/index.ts"),types=__webpack_require__("./src/types/index.ts"),UserCodeEditor=__webpack_require__("./src/components/organisms/UserCodeEditor/UserCodeEditor.tsx");const CodeEditorSheetSectionView=props=>{var _userResults$data$sub,_userResults$data,_userResults$data$sub2,_userResults$data2,_submissions$submissi,_submissions$submissi2,_submissions$submissi5,_submissions$submissi6,_submissions$submissi7;const{content,worksheetKey,chunkId,userResults,readOnly}=props,[sourceCode,setSourceCode]=(0,react.useState)(""),{notifyResponse}=(0,hooks.Eq)(),searchParams=(0,hooks.Ic)((state=>state.searchParams)),routeParams=(0,hooks.Ic)((state=>state.routeParams)),[_submissionIndex,setSubmissionIndex]=(0,react.useState)(0),submissions=null!==(_userResults$data$sub=null==userResults||null===(_userResults$data=userResults.data)||void 0===_userResults$data||null===(_userResults$data$sub2=_userResults$data.submissions[esm.Lc_.CODE_EDITOR])||void 0===_userResults$data$sub2?void 0:_userResults$data$sub2[chunkId])&&void 0!==_userResults$data$sub?_userResults$data$sub:[];(0,react.useEffect)((()=>{setSubmissionIndex(0)}),[null==userResults||null===(_userResults$data2=userResults.data)||void 0===_userResults$data2?void 0:_userResults$data2.user.nickname]);const totalSubmissions=submissions.length,submissionIndex=totalSubmissions-_submissionIndex-1,initialSource={};for(const[langKey,source]of Object.entries(content.sourceCode))initialSource[langKey]=source;var _submissions$submissi3,_submissions$submissi4;null!==(_submissions$submissi=submissions[submissionIndex])&&void 0!==_submissions$submissi&&_submissions$submissi.language&&null!==(_submissions$submissi2=submissions[submissionIndex])&&void 0!==_submissions$submissi2&&_submissions$submissi2.sourceCode&&(initialSource[null===(_submissions$submissi3=submissions[submissionIndex])||void 0===_submissions$submissi3?void 0:_submissions$submissi3.language]=null===(_submissions$submissi4=submissions[submissionIndex])||void 0===_submissions$submissi4?void 0:_submissions$submissi4.sourceCode);const setLoaderStatusRef=(0,react.useRef)(void 0),saveCode=async(sourceCode,language,testCases)=>{var _setLoaderStatusRef$c,_userResults$mutate;null===(_setLoaderStatusRef$c=setLoaderStatusRef.current)||void 0===_setLoaderStatusRef$c||_setLoaderStatusRef$c.call(setLoaderStatusRef,esm.nW6.LOADING),setSubmissionIndex(0);const codeEditorSubmissionDTO={type:esm.Lc_.CODE_EDITOR,id:content.id,language,sourceCode,testCases};let response;const classKey=routeParams.classKey,cycleId=routeParams.cycleId,sessionId=searchParams.get(types.QueryParamKey.SESSION),assignmentId=searchParams.get(types.QueryParamKey.ASSIGNMENT);if(classKey&&cycleId&&sessionId&&assignmentId){const{url,...options}=settings.u.API_V1.class.viewAssignmentMyWorksheetSubmitCodeEditor({params:{classKey,cycleId,sessionId,assignmentId},body:codeEditorSubmissionDTO});response=(0,esm.Hu3)(await(0,helpers.zb)(url,options))}else{const{url,...options}=settings.u.API_V1.worksheet.submitCodeEditor({params:{worksheetKey},body:codeEditorSubmissionDTO});response=(0,esm.Hu3)(await(0,helpers.zb)(url,options))}await(null==userResults||null===(_userResults$mutate=userResults.mutate)||void 0===_userResults$mutate?void 0:_userResults$mutate.call(userResults)),notifyResponse(response,setLoaderStatusRef.current)};return(0,jsx_runtime.jsx)("div",{className:"jk-col stretch flex-1 gap",children:(0,jsx_runtime.jsx)("div",{style:{height:(0,helpers.Oq)(content.height,sourceCode),minWidth:200,width:"100%"},className:"jk-row",children:(0,jsx_runtime.jsx)(UserCodeEditor.UserCodeEditor,{withoutRunCodeButton:readOnly,initialLanguage:null===(_submissions$submissi5=submissions[submissionIndex])||void 0===_submissions$submissi5?void 0:_submissions$submissi5.language,readOnly,initialSource,onSourceChange:setSourceCode,initialTestCases:null!==(_submissions$submissi6=null===(_submissions$submissi7=submissions[submissionIndex])||void 0===_submissions$submissi7?void 0:_submissions$submissi7.testCases)&&void 0!==_submissions$submissi6?_submissions$submissi6:content.testCases,languages:content.languages.map((lang=>{var _PROGRAMMING_LANGUAGE;return{value:lang,label:(null===(_PROGRAMMING_LANGUAGE=esm.tcq[lang])||void 0===_PROGRAMMING_LANGUAGE?void 0:_PROGRAMMING_LANGUAGE.label)||lang}})),storeKey:content.id+"view",enableAddCustomSampleCases:!0,onCodeRunStatusChange:(status,_ref)=>{let{sourceCode,language,testCases}=_ref;status===esm.aeR.COMPILED&&saveCode(sourceCode,language,testCases)},centerButtons:_ref2=>{let{sourceCode,language,testCases}=_ref2;const buttons=[];return readOnly||buttons.push((0,jsx_runtime.jsx)(molecules.mT,{size:"tiny",type:"secondary",onClick:()=>saveCode(sourceCode,language,testCases),setLoaderStatusRef:setLoaderStatus=>setLoaderStatusRef.current=setLoaderStatus,children:(0,jsx_runtime.jsx)(atoms.T,{children:"save"})},"save")),buttons.push((0,jsx_runtime.jsxs)("div",{className:"jk-row bc-hl jk-br-ie",children:[(0,jsx_runtime.jsx)("div",{className:(0,helpers.xW)("clickable br-50-pc jk-row",{"cr-ht":0===totalSubmissions}),onClick:totalSubmissions?()=>setSubmissionIndex((prevState=>(prevState+1)%totalSubmissions)):void 0,children:(0,jsx_runtime.jsx)(server.A60,{})}),null!=userResults&&userResults.isLoading?(0,jsx_runtime.jsx)(server.Gcs,{}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[submissionIndex+1," / ",totalSubmissions,(0,jsx_runtime.jsx)(atoms.T,{children:"v."})]}),(0,jsx_runtime.jsx)("div",{className:(0,helpers.xW)("clickable br-50-pc jk-row",{"cr-ht":0===totalSubmissions}),onClick:totalSubmissions?()=>setSubmissionIndex((prevState=>(prevState-1+totalSubmissions)%totalSubmissions)):void 0,children:(0,jsx_runtime.jsx)(server.flY,{})})]},"buttons")),(0,jsx_runtime.jsx)("div",{className:"jk-row gap",children:buttons})}})})})};try{CodeEditorSheetSectionView.displayName="CodeEditorSheetSectionView",CodeEditorSheetSectionView.__docgenInfo={description:"",displayName:"CodeEditorSheetSectionView",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"CodeEditorSheetType"}},worksheetKey:{defaultValue:null,description:"",name:"worksheetKey",required:!0,type:{name:"string"}},chunkId:{defaultValue:null,description:"",name:"chunkId",required:!0,type:{name:"string"}},userResults:{defaultValue:null,description:"",name:"userResults",required:!1,type:{name:"UserResultsType"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/CodeEditorSheetSection/CodeEditorSheetSectionView.tsx#CodeEditorSheetSectionView"]={docgenInfo:CodeEditorSheetSectionView.__docgenInfo,name:"CodeEditorSheetSectionView",path:"src/components/organisms/worksheet/sheets/CodeEditorSheetSection/CodeEditorSheetSectionView.tsx#CodeEditorSheetSectionView"})}catch(__react_docgen_typescript_loader_error){}const CodeEditorSheetSection=props=>{const{content:initialContent,setContent:saveContent,index,chunkId,sheetLength,setSheet,worksheetKey,userResults,readOnly}=props,[edit,setEdit]=(0,react.useState)(!1),[modal,setModal]=(0,react.useState)(!1),[content,_setContent]=(0,hooks.ID)(initialContent),setContent=saveContent?_setContent:void 0;return(0,jsx_runtime.jsxs)("div",{className:"jk-row stretch flex-1 sheet-section jk-br-ie relative",children:[setContent&&(0,jsx_runtime.jsx)(EditSheetModal,{isOpen:modal,onClose:()=>setModal(!1),content,setContent}),setContent&&edit?(0,jsx_runtime.jsx)(CodeEditorSheetSectionEditor,{content,setContent}):(0,jsx_runtime.jsx)(CodeEditorSheetSectionView,{content,worksheetKey,chunkId,userResults,readOnly}),setSheet&&(0,jsx_runtime.jsx)(molecules.GK,{actionButtons:getActionButtons({type:esm.Lc_.JK_MD,edit,setEdit,setModal,content,saveContent,index,sheetLength,setSheet,reset:()=>{_setContent(initialContent)}}),placement:"out rightTop"})]})};try{CodeEditorSheetSection.displayName="CodeEditorSheetSection",CodeEditorSheetSection.__docgenInfo={description:"",displayName:"CodeEditorSheetSection",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"CodeEditorSheetType"}},setContent:{defaultValue:null,description:"",name:"setContent",required:!1,type:{name:"SetContentType<CodeEditorSheetType>"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},chunkId:{defaultValue:null,description:"",name:"chunkId",required:!0,type:{name:"string"}},sheetLength:{defaultValue:null,description:"",name:"sheetLength",required:!0,type:{name:"number"}},setSheet:{defaultValue:null,description:"",name:"setSheet",required:!1,type:{name:"SetSheetType<BodyWorksheetType>"}},worksheetKey:{defaultValue:null,description:"",name:"worksheetKey",required:!0,type:{name:"string"}},isSolvable:{defaultValue:null,description:"",name:"isSolvable",required:!0,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!0,type:{name:"boolean"}},userResults:{defaultValue:null,description:"",name:"userResults",required:!1,type:{name:"UserResultsType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/CodeEditorSheetSection/CodeEditorSheetSection.tsx#CodeEditorSheetSection"]={docgenInfo:CodeEditorSheetSection.__docgenInfo,name:"CodeEditorSheetSection",path:"src/components/organisms/worksheet/sheets/CodeEditorSheetSection/CodeEditorSheetSection.tsx#CodeEditorSheetSection"})}catch(__react_docgen_typescript_loader_error){}var MdMathViewer=__webpack_require__("./src/components/organisms/mdMath/MdMathViewer.tsx");const ResultHeader=_ref=>{let{isResolved,points,userPoints,children}=_ref;return(0,jsx_runtime.jsxs)("div",{className:"jk-pg-sm jk-col gap stretch space-between result-header sticky-top",children:[!!points&&(0,jsx_runtime.jsxs)("div",{className:(0,helpers.xW)("jk-tag tx-s ws-np",{success:isResolved,"gray-6":!isResolved}),children:[userPoints.toFixed(2)," ",(0,jsx_runtime.jsx)(atoms.T,{children:1===userPoints?"pt":"pts"})," / ",points," ",(0,jsx_runtime.jsx)(atoms.T,{children:1===points?"pt":"pts"})]}),(0,jsx_runtime.jsx)("div",{className:"jk-row gap",children})]})};try{ResultHeader.displayName="ResultHeader",ResultHeader.__docgenInfo={description:"",displayName:"ResultHeader",props:{points:{defaultValue:null,description:"",name:"points",required:!0,type:{name:"number"}},userPoints:{defaultValue:null,description:"",name:"userPoints",required:!0,type:{name:"number"}},isResolved:{defaultValue:null,description:"",name:"isResolved",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/ResultHeader.tsx#ResultHeader"]={docgenInfo:ResultHeader.__docgenInfo,name:"ResultHeader",path:"src/components/organisms/worksheet/sheets/ResultHeader.tsx#ResultHeader"})}catch(__react_docgen_typescript_loader_error){}var MdMathEditor=__webpack_require__("./src/components/organisms/mdMath/MdMathEditor.tsx");const JkmdSheetSectionEditor=_ref=>{let{content,setContent,isSolvable}=_ref;return(0,jsx_runtime.jsxs)("div",{className:"jk-col left gap wh-100",children:[isSolvable&&(0,jsx_runtime.jsx)("div",{className:"jk-row extend left",children:(0,jsx_runtime.jsx)(atoms.pd,{label:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"points"}),type:"number",value:content.points,onChange:points=>setContent((prevState=>({...prevState,points})))})}),(0,jsx_runtime.jsx)("div",{className:"flex-1 jk-md-math-editor-expanded wh-100",children:(0,jsx_runtime.jsx)(MdMathEditor.MdMathEditor,{uploadImageButton:!0,informationButton:!0,source:content.content,onChange:content=>setContent((prevState=>({...prevState,content})))})})]})};try{JkmdSheetSectionEditor.displayName="JkmdSheetSectionEditor",JkmdSheetSectionEditor.__docgenInfo={description:"",displayName:"JkmdSheetSectionEditor",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"JkmdSheetType"}},setContent:{defaultValue:null,description:"",name:"setContent",required:!0,type:{name:"SetContentType<JkmdSheetType>"}},isSolvable:{defaultValue:null,description:"",name:"isSolvable",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/JkmdSheetSection/JkmdSheetSectionEditor.tsx#JkmdSheetSectionEditor"]={docgenInfo:JkmdSheetSectionEditor.__docgenInfo,name:"JkmdSheetSectionEditor",path:"src/components/organisms/worksheet/sheets/JkmdSheetSection/JkmdSheetSectionEditor.tsx#JkmdSheetSectionEditor"})}catch(__react_docgen_typescript_loader_error){}const JkmdSheetSection=props=>{var _userResults$data$sub,_userResults$data,_userResults$data$sub2,_lastSubmission$point;const{content:initialContent,setContent:saveContent,index,chunkId,sheetLength,setSheet,worksheetKey,isSolvable=!1,userResults}=props,{notifyResponse}=(0,hooks.Eq)(),[edit,setEdit]=(0,react.useState)(!1),[modal,setModal]=(0,react.useState)(!1),[content,_setContent]=(0,hooks.ID)(initialContent),setContent=saveContent?_setContent:void 0,lastSubmission=(null!==(_userResults$data$sub=null==userResults||null===(_userResults$data=userResults.data)||void 0===_userResults$data||null===(_userResults$data$sub2=_userResults$data.submissions[esm.Lc_.JK_MD])||void 0===_userResults$data$sub2?void 0:_userResults$data$sub2[chunkId])&&void 0!==_userResults$data$sub?_userResults$data$sub:[]).at(-1);return(0,jsx_runtime.jsxs)("div",{className:"jk-row top left nowrap stretch sheet-section jk-br-ie pn-re wh-100",onDoubleClick:()=>setEdit(!0),children:[setContent&&(0,jsx_runtime.jsx)(EditSheetModal,{isOpen:modal,onClose:()=>setModal(!1),content,setContent}),setContent&&edit?(0,jsx_runtime.jsx)(JkmdSheetSectionEditor,{content,setContent,isSolvable:!!isSolvable}):(0,jsx_runtime.jsx)("div",{className:"jk-pg bc-we jk-br-ie jk-md-sheet-section-view",style:{width:isSolvable&&!setContent?"calc(100% - 100px)":"100%"},children:(0,jsx_runtime.jsx)(MdMathViewer.MdMathViewer,{source:content.content})}),setSheet&&(0,jsx_runtime.jsx)(molecules.GK,{actionButtons:getActionButtons({type:esm.Lc_.JK_MD,edit,setEdit,setModal,content,saveContent,index,sheetLength,setSheet,reset:()=>{_setContent(initialContent)}}),placement:"out rightTop"}),isSolvable&&!setSheet&&(0,jsx_runtime.jsx)(ResultHeader,{points:content.points,userPoints:null!==(_lastSubmission$point=null==lastSubmission?void 0:lastSubmission.points)&&void 0!==_lastSubmission$point?_lastSubmission$point:0,isResolved:!(null==lastSubmission||!lastSubmission.isCompleted),children:(0,jsx_runtime.jsx)(molecules.mT,{type:"light",expand:!0,size:"small","data-tooltip-id":"jk-tooltip","data-tooltip-content":null!=lastSubmission&&lastSubmission.read?"mark as unread":"mark as read",onClick:async setLoaderStatus=>{var _userResults$mutate;setLoaderStatus(esm.nW6.LOADING);const jkMdSubmissionDTO={type:esm.Lc_.JK_MD,id:content.id,read:!(null!=lastSubmission&&lastSubmission.read)},{url,...options}=settings.u.API_V1.worksheet.submitJkMd({params:{worksheetKey},body:jkMdSubmissionDTO}),response=(0,esm.Hu3)(await(0,helpers.zb)(url,options));await(null==userResults||null===(_userResults$mutate=userResults.mutate)||void 0===_userResults$mutate?void 0:_userResults$mutate.call(userResults)),notifyResponse(response,setLoaderStatus)},icon:(0,jsx_runtime.jsx)(atoms.GL,{checked:!(null==lastSubmission||!lastSubmission.read),onChange:()=>null}),children:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:null!=lastSubmission&&lastSubmission.read?"_read":"unread"})})})]})};try{JkmdSheetSection.displayName="JkmdSheetSection",JkmdSheetSection.__docgenInfo={description:"",displayName:"JkmdSheetSection",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"JkmdSheetType"}},setContent:{defaultValue:null,description:"",name:"setContent",required:!1,type:{name:"SetContentType<JkmdSheetType>"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},chunkId:{defaultValue:null,description:"",name:"chunkId",required:!0,type:{name:"string"}},sheetLength:{defaultValue:null,description:"",name:"sheetLength",required:!0,type:{name:"number"}},setSheet:{defaultValue:null,description:"",name:"setSheet",required:!1,type:{name:"SetSheetType<BodyWorksheetType>"}},worksheetKey:{defaultValue:null,description:"",name:"worksheetKey",required:!0,type:{name:"string"}},isSolvable:{defaultValue:null,description:"",name:"isSolvable",required:!0,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!0,type:{name:"boolean"}},userResults:{defaultValue:null,description:"",name:"userResults",required:!1,type:{name:"UserResultsType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/JkmdSheetSection/JkmdSheetSection.tsx#JkmdSheetSection"]={docgenInfo:JkmdSheetSection.__docgenInfo,name:"JkmdSheetSection",path:"src/components/organisms/worksheet/sheets/JkmdSheetSection/JkmdSheetSection.tsx#JkmdSheetSection"})}catch(__react_docgen_typescript_loader_error){}var v4=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js");const QuizOptionsSheetSectionEditor=_ref=>{let{content,setContent,isSolvable}=_ref;return(0,jsx_runtime.jsxs)("div",{className:"jk-col gap stretch left jk-pg wh-100 br-ht jk-br-ie",children:[(0,jsx_runtime.jsxs)("div",{className:"jk-row-col gap tx-s",children:[(0,jsx_runtime.jsxs)("div",{className:"jk-col",children:[(0,jsx_runtime.jsx)(atoms.T,{className:"fw-bd tt-se",children:"options"}),(0,jsx_runtime.jsx)(atoms.JN,{size:"small",checked:content.multiple,onChange:newValue=>setContent((prevState=>({...prevState,multiple:newValue,options:prevState.options.map((option=>({...option,correct:!1})))}))),leftLabel:(0,jsx_runtime.jsx)(atoms.T,{className:(0,helpers.xW)("tt-se",{"fw-bd":!content.multiple}),children:"single"}),rightLabel:(0,jsx_runtime.jsx)(atoms.T,{className:(0,helpers.xW)("tt-se",{"fw-bd":content.multiple}),children:"multiple"})})]}),isSolvable&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"jk-row left",style:{width:64},children:(0,jsx_runtime.jsx)(atoms.pd,{label:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"points"}),labelPlacement:"top",type:"number",expand:!0,value:content.points,onChange:points=>setContent((prevState=>({...prevState,points})))})}),(0,jsx_runtime.jsxs)("div",{className:"jk-col",children:[(0,jsx_runtime.jsx)(atoms.T,{className:"fw-bd tt-se",children:"scoring mode"}),(0,jsx_runtime.jsx)(atoms.JN,{size:"small",checked:"TOTAL"===content.scoringMode,onChange:newValue=>setContent((prevState=>({...prevState,scoringMode:newValue?"TOTAL":"PARTIAL"}))),leftLabel:(0,jsx_runtime.jsx)(atoms.T,{className:(0,helpers.xW)("tt-se",{"fw-bd":"PARTIAL"===content.scoringMode}),children:"partial"}),rightLabel:(0,jsx_runtime.jsx)(atoms.T,{className:(0,helpers.xW)("tt-se",{"fw-bd":"TOTAL"===content.scoringMode}),children:"total"})})]})]})]}),(0,jsx_runtime.jsx)(atoms.pd,{label:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"title"}),labelPlacement:"top",value:content.title,onChange:title=>setContent((prevState=>({...prevState,title}))),expand:!0}),(0,jsx_runtime.jsxs)("div",{className:"jk-col stretch",children:[(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se fw-bd",children:"description"}),(0,jsx_runtime.jsx)(MdMathEditor.MdMathEditor,{source:content.description,onChange:description=>setContent((prevState=>({...prevState,description})))})]}),(0,jsx_runtime.jsxs)("div",{className:"jk-col stretch left gap",children:[(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se cr-pl",children:"select the correct options"}),content.options.map(((option,index)=>(0,jsx_runtime.jsxs)("div",{className:"jk-row gap nowrap extend",children:[content.multiple?(0,jsx_runtime.jsx)(atoms.GL,{checked:option.correct,onChange:newValue=>{setContent((prevState=>{const newOptions=[...prevState.options];return newOptions[index]={...newOptions[index],correct:newValue},{...prevState,options:newOptions}}))}}):(0,jsx_runtime.jsx)(atoms.U6,{name:content.id,checked:option.correct,onChange:newValue=>{setContent((prevState=>{const newOptions=[...prevState.options].map((option=>({...option,correct:!1})));return newOptions[index]={...newOptions[index],correct:newValue},{...prevState,options:newOptions}}))}}),(0,jsx_runtime.jsx)(atoms.lI,{value:option.label,onChange:label=>{setContent((prevState=>{const newOptions=[...prevState.options];return newOptions[index]={...newOptions[index],label},{...prevState,options:newOptions}}))},expand:!0})]},`${index}`))),(0,jsx_runtime.jsxs)(atoms.$n,{type:"light",className:"jk-row gap",onClick:()=>setContent((prevState=>({...prevState,options:[...prevState.options,{label:"",correct:!1,id:(0,v4.A)()}]}))),children:[(0,jsx_runtime.jsx)(server.REV,{})," ",(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"add option"})]})]})]})};try{QuizOptionsSheetSectionEditor.displayName="QuizOptionsSheetSectionEditor",QuizOptionsSheetSectionEditor.__docgenInfo={description:"",displayName:"QuizOptionsSheetSectionEditor",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"QuizOptionsSheetType"}},setContent:{defaultValue:null,description:"",name:"setContent",required:!0,type:{name:"SetContentType<QuizOptionsSheetType>"}},isSolvable:{defaultValue:null,description:"",name:"isSolvable",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/QuizOptionsSheetSection/QuizOptionsSheetSectionEditor.tsx#QuizOptionsSheetSectionEditor"]={docgenInfo:QuizOptionsSheetSectionEditor.__docgenInfo,name:"QuizOptionsSheetSectionEditor",path:"src/components/organisms/worksheet/sheets/QuizOptionsSheetSection/QuizOptionsSheetSectionEditor.tsx#QuizOptionsSheetSectionEditor"})}catch(__react_docgen_typescript_loader_error){}const QuizOptionsSheetSectionView=props=>{const{content,checkedOptions,setCheckedOptions}=props;return(0,jsx_runtime.jsxs)("div",{className:"jk-col stretch gap wh-100",children:[(0,jsx_runtime.jsx)("p",{className:"tt-se tx-l fw-bd",children:content.title}),(0,jsx_runtime.jsx)(MdMathViewer.MdMathViewer,{source:content.description}),(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se tx-l fw-bd",children:content.multiple?"select one or more options":"select one option"}),(0,jsx_runtime.jsx)("div",{className:"jk-col stretch left gap",children:content.options.map(((option,index)=>(0,jsx_runtime.jsxs)("div",{className:"jk-row gap nowrap extend left jk-br-ie option",onClick:()=>{content.multiple?checkedOptions.includes(option.id)?setCheckedOptions(checkedOptions.filter((o=>o!==option.id))):setCheckedOptions([...checkedOptions,option.id]):setCheckedOptions([option.id])},children:[content.multiple?(0,jsx_runtime.jsx)(atoms.GL,{checked:checkedOptions.includes(option.id),onChange:()=>null,className:(0,helpers.xW)({"bc-sl jk-br-ie":option.correct})}):(0,jsx_runtime.jsx)(atoms.U6,{checked:checkedOptions.includes(option.id),onChange:()=>null,className:(0,helpers.xW)({"bc-sl br-50-pc":option.correct})}),(0,jsx_runtime.jsx)("div",{children:option.label})]},option.id)))})]})};try{QuizOptionsSheetSectionView.displayName="QuizOptionsSheetSectionView",QuizOptionsSheetSectionView.__docgenInfo={description:"",displayName:"QuizOptionsSheetSectionView",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"QuizOptionsSheetType"}},checkedOptions:{defaultValue:null,description:"",name:"checkedOptions",required:!0,type:{name:"string[]"}},setCheckedOptions:{defaultValue:null,description:"",name:"setCheckedOptions",required:!0,type:{name:"Dispatch<SetStateAction<string[]>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/QuizOptionsSheetSection/QuizOptionsSheetSectionView.tsx#QuizOptionsSheetSectionView"]={docgenInfo:QuizOptionsSheetSectionView.__docgenInfo,name:"QuizOptionsSheetSectionView",path:"src/components/organisms/worksheet/sheets/QuizOptionsSheetSection/QuizOptionsSheetSectionView.tsx#QuizOptionsSheetSectionView"})}catch(__react_docgen_typescript_loader_error){}const QuizOptionsSheetSection=props=>{var _userResults$data$sub,_userResults$data,_userResults$data$sub2,_lastSubmission$check,_lastSubmission$point;const{content:initialContent,setContent:saveContent,index,chunkId,sheetLength,setSheet,worksheetKey,isSolvable=!1,userResults}=props,{notifyResponse}=(0,hooks.Eq)(),[edit,setEdit]=(0,react.useState)(!1),[modal,setModal]=(0,react.useState)(!1),[content,_setContent]=(0,hooks.ID)(initialContent),setContent=saveContent?_setContent:void 0,submissions=null!==(_userResults$data$sub=null==userResults||null===(_userResults$data=userResults.data)||void 0===_userResults$data||null===(_userResults$data$sub2=_userResults$data.submissions[esm.Lc_.QUIZ_OPTIONS])||void 0===_userResults$data$sub2?void 0:_userResults$data$sub2[chunkId])&&void 0!==_userResults$data$sub?_userResults$data$sub:[],lastSubmission=submissions.at(-1);console.log({lastSubmission,userResults,submissions});const[checkedOptions,setCheckedOptions]=(0,hooks.ID)(null!==(_lastSubmission$check=null==lastSubmission?void 0:lastSubmission.checkedOptions)&&void 0!==_lastSubmission$check?_lastSubmission$check:[]);return(0,jsx_runtime.jsxs)("div",{className:"jk-row top left nowrap stretch sheet-section jk-br-ie pn-re wh-100",onDoubleClick:()=>setEdit(!0),children:[setContent&&(0,jsx_runtime.jsx)(EditSheetModal,{isOpen:modal,onClose:()=>setModal(!1),content,setContent}),setContent&&edit?(0,jsx_runtime.jsx)(QuizOptionsSheetSectionEditor,{content,setContent,isSolvable}):(0,jsx_runtime.jsx)("div",{className:"jk-pg bc-we jk-br-ie jk-quiz-options-section-view",style:{width:isSolvable&&!setContent?"calc(100% - 100px)":"100%"},children:(0,jsx_runtime.jsx)(QuizOptionsSheetSectionView,{content,checkedOptions,setCheckedOptions})}),setSheet&&(0,jsx_runtime.jsx)(molecules.GK,{actionButtons:getActionButtons({type:esm.Lc_.JK_MD,edit,setEdit,setModal,content,saveContent,index,sheetLength,setSheet,reset:()=>{_setContent(initialContent)}}),placement:"out rightTop"}),isSolvable&&!setSheet&&(0,jsx_runtime.jsx)(ResultHeader,{points:content.points,userPoints:null!==(_lastSubmission$point=null==lastSubmission?void 0:lastSubmission.points)&&void 0!==_lastSubmission$point?_lastSubmission$point:0,isResolved:!(null==lastSubmission||!lastSubmission.isCompleted),children:(0,jsx_runtime.jsx)(molecules.mT,{type:"light",size:"small",expand:!0,onClick:async setLoaderStatus=>{var _userResults$mutate;setLoaderStatus(esm.nW6.LOADING);const jkMdSubmissionDTO={type:esm.Lc_.QUIZ_OPTIONS,id:content.id,checkedOptions},{url,...options}=settings.u.API_V1.worksheet.submitQuizOptions({params:{worksheetKey},body:jkMdSubmissionDTO}),response=(0,esm.Hu3)(await(0,helpers.zb)(url,options));await(null==userResults||null===(_userResults$mutate=userResults.mutate)||void 0===_userResults$mutate?void 0:_userResults$mutate.call(userResults)),notifyResponse(response,setLoaderStatus)},children:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"save"})})})]})};try{QuizOptionsSheetSection.displayName="QuizOptionsSheetSection",QuizOptionsSheetSection.__docgenInfo={description:"",displayName:"QuizOptionsSheetSection",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"QuizOptionsSheetType"}},setContent:{defaultValue:null,description:"",name:"setContent",required:!1,type:{name:"SetContentType<QuizOptionsSheetType>"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},chunkId:{defaultValue:null,description:"",name:"chunkId",required:!0,type:{name:"string"}},sheetLength:{defaultValue:null,description:"",name:"sheetLength",required:!0,type:{name:"number"}},setSheet:{defaultValue:null,description:"",name:"setSheet",required:!1,type:{name:"SetSheetType<BodyWorksheetType>"}},worksheetKey:{defaultValue:null,description:"",name:"worksheetKey",required:!0,type:{name:"string"}},isSolvable:{defaultValue:null,description:"",name:"isSolvable",required:!0,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!0,type:{name:"boolean"}},userResults:{defaultValue:null,description:"",name:"userResults",required:!1,type:{name:"UserResultsType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/sheets/QuizOptionsSheetSection/QuizOptionsSheetSection.tsx#QuizOptionsSheetSection"]={docgenInfo:QuizOptionsSheetSection.__docgenInfo,name:"QuizOptionsSheetSection",path:"src/components/organisms/worksheet/sheets/QuizOptionsSheetSection/QuizOptionsSheetSection.tsx#QuizOptionsSheetSection"})}catch(__react_docgen_typescript_loader_error){}const WorksheetBody=(0,react.forwardRef)((function Cmp(props,ref){const{sheet=[],setSheet,userResults,readOnly,isSolvable,worksheetKey,children}=props;return(0,jsx_runtime.jsxs)("div",{className:"jk-col gap center nowrap wh-100",id:"jk-worksheet-body",ref,children:[react.Children.toArray(sheet.map(((chunk,index,array)=>{var _sheet;const setContent=setSheet?value=>{setSheet((sheet=>{const newSheet=[...sheet],newContent="function"==typeof value?value(newSheet[index]):value;return newSheet.splice(index,1,newContent),newSheet}))}:void 0,isNextJkmd=(null===(_sheet=sheet[index+1])||void 0===_sheet?void 0:_sheet.type)===esm.Lc_.JK_MD;return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:(0,helpers.xW)("jk-row nowrap stretch top gap pn-re jk-br-ie wh-100",`${chunk.type}-chunk`,{editing:!!setSheet,"next-jkmd":isNextJkmd}),children:[chunk.type===esm.Lc_.JK_MD&&(0,jsx_runtime.jsx)(JkmdSheetSection,{content:chunk,setContent,index,chunkId:chunk.id,sheetLength:sheet.length,setSheet,worksheetKey,isSolvable,userResults,readOnly}),chunk.type===esm.Lc_.CODE_EDITOR&&(0,jsx_runtime.jsx)(CodeEditorSheetSection,{content:chunk,setContent,index,chunkId:chunk.id,sheetLength:sheet.length,setSheet,worksheetKey,isSolvable,userResults,readOnly}),chunk.type===esm.Lc_.QUIZ_OPTIONS&&(0,jsx_runtime.jsx)(QuizOptionsSheetSection,{content:chunk,setContent,index,chunkId:chunk.id,sheetLength:sheet.length,setSheet,worksheetKey,isSolvable,userResults,readOnly})]}),setSheet&&(0,jsx_runtime.jsx)("div",{className:"jk-row gap extend nowrap center jk-divider tiny editing",children:(0,jsx_runtime.jsx)(AddNewChild,{index,setSheet,mdSheet:!0,codeEditorSheet:!0,graphSheet:!0,quizProblemSheet:!0,quizOptionsSheetType:!0,pageDivider:!0,compacted:!0,floatToolbarPlacement:0===index?"bottom":index<array.length-1?"center":"top"})})]},chunk.id)}))),!sheet.length&&setSheet&&(0,jsx_runtime.jsx)("div",{className:"jk-row gap extend nowrap center jk-divider tiny",children:(0,jsx_runtime.jsx)(AddNewChild,{index:0,setSheet,mdSheet:!0,codeEditorSheet:!0,graphSheet:!0,quizProblemSheet:!0,quizOptionsSheetType:!0,pageDivider:!0,floatToolbarPlacement:"top"})}),children]})}));try{WorksheetBody.displayName="WorksheetBody",WorksheetBody.__docgenInfo={description:"",displayName:"WorksheetBody",props:{sheet:{defaultValue:null,description:"",name:"sheet",required:!1,type:{name:"BodyWorksheetType[]"}},setSheet:{defaultValue:null,description:"",name:"setSheet",required:!1,type:{name:"SetSheetType<BodyWorksheetType>"}},userResults:{defaultValue:null,description:"",name:"userResults",required:!1,type:{name:"UserResultsType"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!0,type:{name:"boolean"}},isSolvable:{defaultValue:null,description:"",name:"isSolvable",required:!0,type:{name:"boolean"}},isEditor:{defaultValue:null,description:"",name:"isEditor",required:!1,type:{name:"boolean"}},worksheetKey:{defaultValue:null,description:"",name:"worksheetKey",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/worksheet/WorksheetBody.tsx#WorksheetBody"]={docgenInfo:WorksheetBody.__docgenInfo,name:"WorksheetBody",path:"src/components/organisms/worksheet/WorksheetBody.tsx#WorksheetBody"})}catch(__react_docgen_typescript_loader_error){}}}]);