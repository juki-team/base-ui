"use strict";(self.webpackChunk_juki_team_base_ui=self.webpackChunk_juki_team_base_ui||[]).push([[5678,7869],{"./src/components/templates/members/DocumentMembersButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DocumentMembersButton:()=>DocumentMembersButton});var esm=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),react=__webpack_require__("./node_modules/react/index.js"),helpers=__webpack_require__("./src/helpers/index.ts"),hooks=__webpack_require__("./src/hooks/index.ts"),atoms=__webpack_require__("./src/components/atoms/index.tsx"),server=__webpack_require__("./src/components/server/index.ts"),molecules=__webpack_require__("./src/components/molecules/index.tsx"),DocumentMembersContent=__webpack_require__("./src/components/templates/members/DocumentMembersContent.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const DocumentMembersModal=props=>{const{documentName,documentMembers,documentOwner,onClose,onSave,isOpen}=props,[members,setMembers]=(0,react.useState)(documentMembers),[loading,setLoading]=(0,react.useState)(!1),done=JSON.stringify(documentMembers)===JSON.stringify(members);return(0,jsx_runtime.jsx)(atoms.aF,{isOpen,onClose:loading?()=>null:onClose,closeOnClickOverlay:done,closeOnKeyEscape:done,className:"wh-ao",children:(0,jsx_runtime.jsxs)("div",{className:"jk-col stretch gap jk-pg-md",children:[(0,jsx_runtime.jsx)("div",{className:"jk-row left extend",children:(0,jsx_runtime.jsxs)("h3",{children:[(0,jsx_runtime.jsx)(atoms.T,{children:"share"}),"Â ",`"${documentName}"`]})}),(0,jsx_runtime.jsx)(DocumentMembersContent.DocumentMembersContent,{members,setMembers,documentOwner}),(0,jsx_runtime.jsxs)("div",{className:"jk-row-col gap block",children:[(0,jsx_runtime.jsx)(molecules.mT,{type:"light",onClick:onClose,disabled:loading,children:(0,jsx_runtime.jsx)(atoms.T,{children:"close"})}),(0,jsx_runtime.jsx)(molecules.mT,{disabled:done,type:"primary",submit:!0,onClick:async setLoaderStatus=>{setLoaderStatus(esm.nW6.LOADING),setLoading(!0),await onSave(members,onClose),setLoading(!1),setLoaderStatus(esm.nW6.SUCCESS)},children:(0,jsx_runtime.jsx)(atoms.T,{children:"save"})})]})]})})};try{DocumentMembersModal.displayName="DocumentMembersModal",DocumentMembersModal.__docgenInfo={description:"",displayName:"DocumentMembersModal",props:{documentName:{defaultValue:null,description:"",name:"documentName",required:!0,type:{name:"string"}},documentMembers:{defaultValue:null,description:"",name:"documentMembers",required:!0,type:{name:"DocumentMembersResponseDTO"}},documentOwner:{defaultValue:null,description:"",name:"documentOwner",required:!0,type:{name:"UserCompanyBasicInfoResponseDTO"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(members: DocumentMembersResponseDTO, close: () => void) => Promise<void>"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/templates/members/DocumentMembersModal/DocumentMembersModal.tsx#DocumentMembersModal"]={docgenInfo:DocumentMembersModal.__docgenInfo,name:"DocumentMembersModal",path:"src/components/templates/members/DocumentMembersModal/DocumentMembersModal.tsx#DocumentMembersModal"})}catch(__react_docgen_typescript_loader_error){}const DocumentMembersButton=props=>{const{documentMembers,documentOwner,documentName,onSave:initialOnSave,saveUrl,reloadDocument}=props,[show,setShow]=(0,react.useState)(!1),nickname=(0,hooks.kH)((state=>state.user.nickname)),{notifyResponse}=(0,hooks.Eq)(),onSave=null!=initialOnSave?initialOnSave:async(members,close)=>{const worksheetToPatch={members:{access:members.access,managers:Object.keys(members.managers),spectators:Object.keys(members.spectators)}},response=(0,helpers.Hu)(await(0,helpers.zb)(saveUrl,{method:esm.aGj.PUT,body:JSON.stringify(worksheetToPatch)}));await(null==reloadDocument?void 0:reloadDocument()),notifyResponse(response),close()},info=(0,jsx_runtime.jsx)(atoms.AM,{popoverClassName:"bc-we jk-br-ie elevation-1",content:(0,jsx_runtime.jsxs)("div",{style:{width:120},children:[(0,jsx_runtime.jsx)("div",{className:"fw-bd",children:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:esm.bz0[documentMembers.access].label})}),(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:esm.bz0[documentMembers.access].description})]}),children:(0,jsx_runtime.jsx)("div",{className:"jk-row",children:(0,jsx_runtime.jsx)(server.mo0,{})})});return nickname!==documentOwner.nickname?info:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(atoms.$n,{size:"small",onClick:()=>setShow(!0),children:(0,jsx_runtime.jsxs)("div",{className:"jk-row gap nowrap",children:[(0,jsx_runtime.jsx)(atoms.T,{children:"share"}),info]})}),(0,jsx_runtime.jsx)(DocumentMembersModal,{isOpen:show,onClose:()=>setShow(!1),documentMembers,documentName,documentOwner,onSave})]})};try{DocumentMembersButton.displayName="DocumentMembersButton",DocumentMembersButton.__docgenInfo={description:"",displayName:"DocumentMembersButton",props:{documentName:{defaultValue:null,description:"",name:"documentName",required:!0,type:{name:"string"}},documentMembers:{defaultValue:null,description:"",name:"documentMembers",required:!0,type:{name:"DocumentMembersResponseDTO"}},documentOwner:{defaultValue:null,description:"",name:"documentOwner",required:!0,type:{name:"UserCompanyBasicInfoResponseDTO"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!1,type:{name:"((members: DocumentMembersResponseDTO, close: () => void) => Promise<void>)"}},saveUrl:{defaultValue:null,description:"",name:"saveUrl",required:!1,type:{name:"string"}},reloadDocument:{defaultValue:null,description:"",name:"reloadDocument",required:!1,type:{name:"(() => Promise<void>)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/templates/members/DocumentMembersButton.tsx#DocumentMembersButton"]={docgenInfo:DocumentMembersButton.__docgenInfo,name:"DocumentMembersButton",path:"src/components/templates/members/DocumentMembersButton.tsx#DocumentMembersButton"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/templates/members/DocumentMembersContent.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DocumentMembersContent:()=>DocumentMembersContent});var _juki_team_commons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),_hooks__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/hooks/index.ts")),_atoms__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/atoms/index.tsx"),_organisms__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/organisms/index.tsx"),_server__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/server/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js");const DocumentMembersContent=_ref=>{let{members,setMembers,documentOwner}=_ref;const companyKey=(0,_hooks__WEBPACK_IMPORTED_MODULE_2__.kH)((state=>state.company.key)),FileAccessIcons={[_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.gTA.PRIVATE]:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_server__WEBPACK_IMPORTED_MODULE_5__.XAi,{}),[_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.gTA.RESTRICTED]:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_server__WEBPACK_IMPORTED_MODULE_5__.GVH,{}),[_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.gTA.PUBLIC]:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_server__WEBPACK_IMPORTED_MODULE_5__.DzZ,{}),[_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.gTA.EXPOSED]:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_server__WEBPACK_IMPORTED_MODULE_5__.fCU,{})};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"jk-col gap stretch gap",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.T,{className:"fw-bd tt-se",children:"access type"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.l6,{options:Object.values(_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.bz0).map((fileAccess=>({value:fileAccess.value,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"jk-row gap left jk-pg-sm",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"jk-col left stretch",style:{maxWidth:300},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"jk-row gap left",children:[FileAccessIcons[fileAccess.value],(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.T,{className:"tt-se fw-bd",children:fileAccess.label})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.T,{className:"tt-se",children:fileAccess.description})]})})}))),selectedOption:{value:members.access},expand:!0,onChange:setMembers?_ref2=>{let{value}=_ref2;setMembers((prevState=>({...prevState,access:value})))}:void 0})})]}),(members.access===_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.gTA.RESTRICTED||members.access===_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.gTA.PUBLIC)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"jk-col stretch extend",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.T,{className:"fw-bd tt-se",children:"People with access"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"jk-row gap space-between extend hover-highlight gap-full-borders jk-br-ie",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_organisms__WEBPACK_IMPORTED_MODULE_4__.A1,{imageUrl:documentOwner.imageUrl,nickname:documentOwner.nickname,className:"flex-1"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.l6,{options:[{value:"owner",label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.T,{children:"owner"})}],selectedOption:{value:"owner"}})]}),[...Object.values(members.managers).map((mem=>({...mem,role:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tot.EDITOR}))),...Object.values(members.spectators).map((mem=>({...mem,role:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tot.VIEWER})))].map((_ref3=>{let{nickname,imageUrl,company,role}=_ref3;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"jk-row gap space-between extend hover-highlight gap-full-borders jk-br-ie",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_organisms__WEBPACK_IMPORTED_MODULE_4__.A1,{imageUrl,nickname,className:"flex-1"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.l6,{options:[...members.access===_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.gTA.RESTRICTED?[{value:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tot.VIEWER,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.T,{children:"viewer"})}]:[],{value:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tot.EDITOR,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.T,{children:"editor"})}],selectedOption:{value:role},onChange:setMembers?_ref4=>{let{value}=_ref4;const{[nickname]:_1,...newManagers}=members.managers,{[nickname]:_2,...newSpectators}=members.spectators;value===_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tot.EDITOR?newManagers[nickname]={nickname,imageUrl,company,type:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.Z9T.USER}:newSpectators[nickname]={nickname,imageUrl,company,type:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.Z9T.USER},setMembers((prevState=>({...prevState,managers:newManagers,spectators:newSpectators})))}:void 0}),setMembers&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.$n,{onClick:()=>{const{[nickname]:_1,...newManagers}=members.managers,{[nickname]:_2,...newSpectators}=members.spectators;setMembers((prevState=>({...prevState,managers:newManagers,spectators:newSpectators})))},icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{"data-tooltip-id":"jk-tooltip","data-tooltip-content":"remove access",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_server__WEBPACK_IMPORTED_MODULE_5__.d7y,{})}),size:"small",type:"light"})]},nickname)}))]}),setMembers&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_3__.T,{className:"fw-bd tt-se",children:"add people"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_organisms__WEBPACK_IMPORTED_MODULE_4__.qj,{companyKey,selectedUsers:[],onChangeSelectedUsers:_ref5=>{let[user]=_ref5;if(user&&!members.managers[user.nickname]&&!members.spectators[user.nickname]){if((members.access===_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.gTA.PUBLIC?_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tot.EDITOR:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tot.VIEWER)===_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.tot.EDITOR){const newManagers={...members.managers};newManagers[user.nickname]={nickname:user.nickname,imageUrl:user.imageUrl,company:user.company,type:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.Z9T.USER},setMembers((prevState=>({...prevState,managers:newManagers})))}else{const newSpectators={...members.spectators};newSpectators[user.nickname]={nickname:user.nickname,imageUrl:user.imageUrl,company:user.company,type:_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.Z9T.USER},setMembers((prevState=>({...prevState,spectators:newSpectators})))}}},maxUsersSelection:1})]})]})]})};try{DocumentMembersContent.displayName="DocumentMembersContent",DocumentMembersContent.__docgenInfo={description:"",displayName:"DocumentMembersContent",props:{members:{defaultValue:null,description:"",name:"members",required:!0,type:{name:"DocumentMembersResponseDTO"}},setMembers:{defaultValue:null,description:"",name:"setMembers",required:!1,type:{name:"Dispatch<SetStateAction<DocumentMembersResponseDTO>>"}},documentOwner:{defaultValue:null,description:"",name:"documentOwner",required:!0,type:{name:"UserCompanyBasicInfoResponseDTO"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/templates/members/DocumentMembersContent.tsx#DocumentMembersContent"]={docgenInfo:DocumentMembersContent.__docgenInfo,name:"DocumentMembersContent",path:"src/components/templates/members/DocumentMembersContent.tsx#DocumentMembersContent"})}catch(__react_docgen_typescript_loader_error){}}}]);