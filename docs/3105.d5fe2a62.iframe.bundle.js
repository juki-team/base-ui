"use strict";(self.webpackChunk_juki_team_base_ui=self.webpackChunk_juki_team_base_ui||[]).push([[3105],{"./src/components/molecules/DataGrid/DataGrid.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DataGrid:()=>DataGrid});var _handsontable_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@handsontable/react/es/react-handsontable.mjs"),handsontable_registry__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/handsontable/registry.mjs"),handsontable_renderers__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/handsontable/renderers/registry.mjs"),handsontable_renderers__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/handsontable/renderers/textRenderer/textRenderer.mjs"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),xlsx__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/xlsx/xlsx.mjs"),_helpers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/helpers/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");(0,handsontable_registry__WEBPACK_IMPORTED_MODULE_4__.um)();const alignment={hleft:"htLeft",hcenter:"htCenter",hright:"htRight",hjustify:"htJustify",vtop:"htTop",vmiddle:"htMiddle",vbottom:"htBottom"},DataGrid=(0,react__WEBPACK_IMPORTED_MODULE_1__.memo)((_ref=>{let{rows,cols,freeze,styles,autofilter,firstRowAsHeaders}=_ref;const data=[],dataStyles=[],cell=[],colHeaders=!firstRowAsHeaders||[];Object.entries(rows).forEach((_ref2=>{let[i,rowData]=_ref2,row=+i;if(firstRowAsHeaders){if(0===row)return void colHeaders.push(...Object.entries(rowData.cells).map((_ref3=>{let[_,cellData]=_ref3;return cellData.text})));row-=1}data[row]=[],Object.entries(rowData.cells).forEach((_ref4=>{let[j,cellData]=_ref4;const col=+j;data[row][col]=cellData.text,"number"==typeof cellData.style&&null!=styles&&styles[cellData.style]&&(dataStyles[row]||(dataStyles[row]=[]),dataStyles[row][col]=null==styles?void 0:styles[cellData.style],cell.push({row,col,renderer:"customStylesRenderer",className:(0,_helpers__WEBPACK_IMPORTED_MODULE_2__.xW)(alignment[`h${null==styles?void 0:styles[cellData.style].align}`],alignment[`v${null==styles?void 0:styles[cellData.style].valign}`])}))}))}));const colWidths=[];Object.entries(cols||{}).forEach((_ref5=>{let[i,colProperty]=_ref5;"number"==typeof colProperty.width&&(colWidths[+i]=colProperty.width)}));const freezeCell=xlsx__WEBPACK_IMPORTED_MODULE_5__.utils.decode_cell(freeze||""),autofilterRange=xlsx__WEBPACK_IMPORTED_MODULE_5__.utils.decode_range((null==autofilter?void 0:autofilter.ref)||"");firstRowAsHeaders&&-1!==freezeCell.r&&(freezeCell.r-=1);return(0,handsontable_renderers__WEBPACK_IMPORTED_MODULE_6__.TS)("customStylesRenderer",((instance,td,row,col,prop,value,cellProperties)=>{var _cellProperties$style,_cellProperties$style2,_cellProperties$style3,_cellProperties$style5,_cellProperties$style4,_cellProperties$style6;((0,handsontable_renderers__WEBPACK_IMPORTED_MODULE_7__.F)(instance,td,row,col,prop,value,cellProperties),null!==(_cellProperties$style=cellProperties.style)&&void 0!==_cellProperties$style&&null!==(_cellProperties$style2=_cellProperties$style.font)&&void 0!==_cellProperties$style2&&_cellProperties$style2.bold&&(td.style.fontWeight="bold"),null!==(_cellProperties$style3=cellProperties.style)&&void 0!==_cellProperties$style3&&_cellProperties$style3.color)&&(td.style.color=null===(_cellProperties$style4=cellProperties.style)||void 0===_cellProperties$style4?void 0:_cellProperties$style4.color);null!==(_cellProperties$style5=cellProperties.style)&&void 0!==_cellProperties$style5&&_cellProperties$style5.bgcolor&&(td.style.background=null===(_cellProperties$style6=cellProperties.style)||void 0===_cellProperties$style6?void 0:_cellProperties$style6.bgcolor)})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_handsontable_react__WEBPACK_IMPORTED_MODULE_0__.sH,{data,rowHeaders:!0,colHeaders,licenseKey:"non-commercial-and-evaluation",fixedColumnsStart:-1!==freezeCell.c?freezeCell.c:void 0,fixedRowsTop:-1!==freezeCell.r?freezeCell.r:void 0,filters:!0,dropdownMenu:!0,height:"100%",width:"100%",afterGetColHeader:(col,TH)=>{if(!(autofilterRange.s.c<=col&&col<=autofilterRange.e.c)){var _button$parentElement;const button=TH.querySelector(".changeType");if(!button)return;null===(_button$parentElement=button.parentElement)||void 0===_button$parentElement||_button$parentElement.removeChild(button)}},cell,cells:function(row,col){var _dataStyles$row;const cellProperties={style:{}};return null!=dataStyles&&null!==(_dataStyles$row=dataStyles[row])&&void 0!==_dataStyles$row&&_dataStyles$row[col]&&(cellProperties.style=dataStyles[row][col]),cellProperties},colWidths:colWidths.length?colWidths:void 0})}));try{DataGrid.displayName="DataGrid",DataGrid.__docgenInfo={description:"",displayName:"DataGrid",props:{rows:{defaultValue:null,description:"",name:"rows",required:!0,type:{name:"{ [key: number]: RowDataType; }"}},cols:{defaultValue:null,description:"",name:"cols",required:!1,type:{name:"{ [key: number]: ColPropertiesType; }"}},freeze:{defaultValue:null,description:"",name:"freeze",required:!1,type:{name:"string"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"CellStyleType[]"}},autofilter:{defaultValue:null,description:"",name:"autofilter",required:!1,type:{name:"{ ref: string; filters: []; }"}},firstRowAsHeaders:{defaultValue:null,description:"",name:"firstRowAsHeaders",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/molecules/DataGrid/DataGrid.tsx#DataGrid"]={docgenInfo:DataGrid.__docgenInfo,name:"DataGrid",path:"src/components/molecules/DataGrid/DataGrid.tsx#DataGrid"})}catch(__react_docgen_typescript_loader_error){}}}]);