"use strict";(self.webpackChunk_juki_team_base_ui=self.webpackChunk_juki_team_base_ui||[]).push([[8530],{"./src/components/molecules/FetcherLayer/FetcherLayer.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FetcherLayer:()=>FetcherLayer});var _juki_team_commons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_helpers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/helpers/index.ts"),_hooks__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/hooks/index.ts"),_atoms__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/atoms/index.ts"),_layouts__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/molecules/layouts/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js");const isContentResponseType=data=>!(null==data||!data.success||null==data||!data.content),isContentsResponseType=data=>!(null==data||!data.success||null==data||!data.contents),FetcherLayer=props=>{const{url,options,errorView,loadingView,children,onError:_onError,triggerFetch}=props,onErrorRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(_onError);onErrorRef.current=_onError;const{isLoading,data,error,mutate,isValidating}=(0,_hooks__WEBPACK_IMPORTED_MODULE_3__.Ls)(url,options),{notifyResponse}=(0,_hooks__WEBPACK_IMPORTED_MODULE_3__.Eq)();(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{triggerFetch&&mutate()}),[triggerFetch,mutate]);const dataRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(data);dataRef.current=data;const errorRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(error);errorRef.current=error;const isError=!isLoading&&(!1===(null==data?void 0:data.success)||error);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{var _onErrorRef$current;isError&&((data=>!1===(null==data?void 0:data.success))(dataRef.current)&&notifyResponse(dataRef.current),(0,_juki_team_commons__WEBPACK_IMPORTED_MODULE_0__.yAk)(errorRef.current),null===(_onErrorRef$current=onErrorRef.current)||void 0===_onErrorRef$current||_onErrorRef$current.call(onErrorRef,errorRef.current))}),[notifyResponse,isError]);const validChild=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((()=>isContentResponseType(data)||isContentsResponseType(data)?(0,_helpers__WEBPACK_IMPORTED_MODULE_2__._v)(children,{data,isLoading,error,mutate}):null),[data,error,isLoading,mutate]);return isLoading?loadingView?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:(0,_helpers__WEBPACK_IMPORTED_MODULE_2__.lm)(loadingView)}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_layouts__WEBPACK_IMPORTED_MODULE_5__.Q,{}):isContentResponseType(data)||isContentsResponseType(data)?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:[validChild,isValidating&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{style:{position:"absolute",top:0,width:"100%"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_4__.QdK,{})})]}):errorView?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:(0,_helpers__WEBPACK_IMPORTED_MODULE_2__._v)(errorView,{data,isLoading,error,mutate})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"jk-row jk-col extend",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_atoms__WEBPACK_IMPORTED_MODULE_4__.CZe,{})})};try{FetcherLayer.displayName="FetcherLayer",FetcherLayer.__docgenInfo={description:"",displayName:"FetcherLayer",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string | null"}},options:{defaultValue:null,description:"",name:"options",required:!1,type:{name:"SWRConfiguration"}},errorView:{defaultValue:null,description:"",name:"errorView",required:!1,type:{name:"ReactNodeOrFunctionP1Type<{ data: ErrorResponseType; isLoading: boolean; error: any; mutate: KeyedMutator<any>; }>"}},loadingView:{defaultValue:null,description:"",name:"loadingView",required:!1,type:{name:"ReactNodeOrFunctionType"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"((error?: any) => void)"}},triggerFetch:{defaultValue:null,description:"",name:"triggerFetch",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/molecules/FetcherLayer/FetcherLayer.tsx#FetcherLayer"]={docgenInfo:FetcherLayer.__docgenInfo,name:"FetcherLayer",path:"src/components/molecules/FetcherLayer/FetcherLayer.tsx#FetcherLayer"})}catch(__react_docgen_typescript_loader_error){}}}]);