/*! For license information please see 8558.38f90a7d.iframe.bundle.js.LICENSE.txt */
(self.webpackChunk_juki_team_base_ui=self.webpackChunk_juki_team_base_ui||[]).push([[8558],{"./node_modules/@handsontable/react/es/react-handsontable.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{sH:()=>HotTable});var react=__webpack_require__("./node_modules/react/index.js"),react_dom=__webpack_require__("./node_modules/react-dom/index.js"),dom_element=(__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/es.set.difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.intersection.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-subset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-superset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.symmetric-difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.union.v2.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./node_modules/core-js/modules/web.immediate.js"),__webpack_require__("./node_modules/handsontable/helpers/dom/element.mjs")),helpers_function=__webpack_require__("./node_modules/handsontable/helpers/function.mjs"),mixed=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs"),browser=__webpack_require__("./node_modules/handsontable/helpers/browser.mjs"),unicode=__webpack_require__("./node_modules/handsontable/helpers/unicode.mjs"),dom_event=__webpack_require__("./node_modules/handsontable/helpers/dom/event.mjs"),registry=__webpack_require__("./node_modules/handsontable/editors/registry.mjs"),handsontable_eventManager=__webpack_require__("./node_modules/handsontable/eventManager.mjs");function _classPrivateMethodInitSpec(e,a){(function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _EditorManager_brand=new WeakSet;class EditorManager{constructor(hotInstance,tableMeta,_selection){_classPrivateMethodInitSpec(this,_EditorManager_brand),_defineProperty(this,"hot",void 0),_defineProperty(this,"tableMeta",void 0),_defineProperty(this,"selection",void 0),_defineProperty(this,"eventManager",void 0),_defineProperty(this,"destroyed",!1),_defineProperty(this,"activeEditor",void 0),_defineProperty(this,"cellProperties",void 0),this.hot=hotInstance,this.tableMeta=tableMeta,this.selection=_selection,this.eventManager=new handsontable_eventManager.A(hotInstance),this.hot.addHook("afterDocumentKeyDown",(event=>_assertClassBrand(_EditorManager_brand,this,_onAfterDocumentKeyDown).call(this,event))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(event=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",event)})),this.hot.view._wt.update("onCellDblClick",((event,coords,elem)=>_assertClassBrand(_EditorManager_brand,this,_onCellDblClick).call(this,event,coords,elem)))}getActiveEditor(){return this.activeEditor}prepareEditor(){var _this$hot$getSelected;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(dataSaved=>{dataSaved&&this.prepareEditor()}));const highlight=null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.highlight;if(!highlight||highlight.isHeader())return;const{row,col}=highlight,modifiedCellCoords=this.hot.runHooks("modifyGetCellCoords",row,col,!1,"meta");let visualRowToCheck=row,visualColumnToCheck=col;if(Array.isArray(modifiedCellCoords)&&([visualRowToCheck,visualColumnToCheck]=modifiedCellCoords),this.cellProperties=this.hot.getCellMeta(visualRowToCheck,visualColumnToCheck),!this.isCellEditable())return void this.clearActiveEditor();const td=this.hot.getCell(row,col,!0);if(td){const editorClass=this.hot.getCellEditor(this.cellProperties),prop=this.hot.colToProp(visualColumnToCheck),originalValue=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(visualRowToCheck),visualColumnToCheck);this.activeEditor=(0,registry.L3)(editorClass,this.hot),this.activeEditor.prepare(row,col,prop,td,originalValue,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(newInitialValue,event){let enableFullEditMode=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const selection=this.hot.getSelectedRangeLast();let allowOpening=this.hot.runHooks("beforeBeginEditing",selection.highlight.row,selection.highlight.col,newInitialValue,event,enableFullEditMode);event instanceof MouseEvent&&"boolean"!=typeof allowOpening&&(allowOpening=0===this.hot.selection.getLayerLevel()&&selection.isSingle()),!1!==allowOpening?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(enableFullEditMode&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(newInitialValue,event))):this.clearActiveEditor()}closeEditor(restoreOriginalValue,isCtrlPressed,callback){this.activeEditor?this.activeEditor.finishEditing(restoreOriginalValue,isCtrlPressed,callback):callback&&callback(!1)}closeEditorAndSaveChanges(isCtrlPressed){this.closeEditor(!1,isCtrlPressed)}closeEditorAndRestoreOriginalValue(isCtrlPressed){this.closeEditor(!0,isCtrlPressed)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const selection=this.hot.getSelectedRangeLast();if(!selection)return!1;const editorClass=this.hot.getCellEditor(this.cellProperties),{row,col}=selection.highlight,{rowIndexMapper,columnIndexMapper}=this.hot,isCellHidden=rowIndexMapper.isHidden(this.hot.toPhysicalRow(row))||columnIndexMapper.isHidden(this.hot.toPhysicalColumn(col));return!(this.cellProperties.readOnly||!editorClass||isCellHidden)}moveSelectionAfterEnter(event){const enterMoves={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves};event.shiftKey&&(enterMoves.row=-enterMoves.row,enterMoves.col=-enterMoves.col),this.hot.selection.isMultiple()?this.selection.transformFocus(enterMoves.row,enterMoves.col):this.selection.transformStart(enterMoves.row,enterMoves.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function _onAfterDocumentKeyDown(event){const selection=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!selection||selection.highlight.isHeader()||(0,dom_event.d)(event))return;const{keyCode}=event,isCtrlPressed=(event.ctrlKey||event.metaKey)&&!event.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&((0,unicode.Yf)(keyCode)||(0,unicode.SI)(keyCode)||isCtrlPressed||this.isEditorOpened()||this.openEditor("",event))}function _onCellDblClick(event,coords){coords.isCell()&&this.openEditor(null,event,!0)}const instances=new WeakMap;EditorManager.getInstance=function(hotInstance,tableMeta,selection){let editorManager=instances.get(hotInstance);return editorManager||(editorManager=new EditorManager(hotInstance,tableMeta,selection),instances.set(hotInstance,editorManager)),editorManager};const handsontable_editorManager=EditorManager;var object=__webpack_require__("./node_modules/handsontable/helpers/object.mjs"),helpers_console=__webpack_require__("./node_modules/handsontable/helpers/console.mjs");function _classPrivateFieldInitSpec(e,t,a){focusManager_checkPrivateRedeclaration(e,t),t.set(e,a)}function focusManager_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(s,a){return s.get(focusManager_assertClassBrand(s,a))}function _classPrivateFieldSet(s,a,r){return s.set(focusManager_assertClassBrand(s,a),r),r}function focusManager_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const FOCUS_MODES=Object.freeze({CELL:"cell",MIXED:"mixed"});var _hot=new WeakMap,_focusMode=new WeakMap,_refocusDelay=new WeakMap,_refocusElementGetter=new WeakMap,_debouncedSelect=new WeakMap,_FocusManager_brand=new WeakSet;class FocusManager{constructor(hotInstance){var _this=this;!function focusManager_classPrivateMethodInitSpec(e,a){focusManager_checkPrivateRedeclaration(e,a),a.add(e)}(this,_FocusManager_brand),_classPrivateFieldInitSpec(this,_hot,void 0),_classPrivateFieldInitSpec(this,_focusMode,void 0),_classPrivateFieldInitSpec(this,_refocusDelay,1),_classPrivateFieldInitSpec(this,_refocusElementGetter,null),_classPrivateFieldInitSpec(this,_debouncedSelect,new Map);const hotSettings=hotInstance.getSettings();_classPrivateFieldSet(_hot,this,hotInstance),_classPrivateFieldSet(_focusMode,this,hotSettings.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL),_classPrivateFieldGet(_hot,this).addHook("afterUpdateSettings",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return focusManager_assertClassBrand(_FocusManager_brand,_this,_onUpdateSettings).call(_this,...args)})),_classPrivateFieldGet(_hot,this).addHook("afterSelection",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return focusManager_assertClassBrand(_FocusManager_brand,_this,_focusCell).call(_this,...args)})),_classPrivateFieldGet(_hot,this).addHook("afterSelectionFocusSet",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return focusManager_assertClassBrand(_FocusManager_brand,_this,_focusCell).call(_this,...args)})),_classPrivateFieldGet(_hot,this).addHook("afterSelectionEnd",(function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return focusManager_assertClassBrand(_FocusManager_brand,_this,_focusEditorElement).call(_this,...args)}))}getFocusMode(){return _classPrivateFieldGet(_focusMode,this)}setFocusMode(focusMode){Object.values(FOCUS_MODES).includes(focusMode)?_classPrivateFieldSet(_focusMode,this,focusMode):(0,helpers_console.R8)(`"${focusMode}" is not a valid focus mode.`)}getRefocusDelay(){return _classPrivateFieldGet(_refocusDelay,this)}setRefocusDelay(delay){_classPrivateFieldSet(_refocusDelay,this,delay)}setRefocusElementGetter(getRefocusElementFunction){_classPrivateFieldSet(_refocusElementGetter,this,getRefocusElementFunction)}getRefocusElement(){var _classPrivateFieldGet2;return"function"==typeof _classPrivateFieldGet(_refocusElementGetter,this)?_classPrivateFieldGet(_refocusElementGetter,this).call(this):null===(_classPrivateFieldGet2=_classPrivateFieldGet(_hot,this).getActiveEditor())||void 0===_classPrivateFieldGet2?void 0:_classPrivateFieldGet2.TEXTAREA}focusOnHighlightedCell(selectedCell){const focusElement=element=>{var _classPrivateFieldGet3,_classPrivateFieldGet4;const currentHighlightCoords=null===(_classPrivateFieldGet3=_classPrivateFieldGet(_hot,this).getSelectedRangeLast())||void 0===_classPrivateFieldGet3?void 0:_classPrivateFieldGet3.highlight;if(!currentHighlightCoords)return;let elementToBeFocused=_classPrivateFieldGet(_hot,this).runHooks("modifyFocusedElement",currentHighlightCoords.row,currentHighlightCoords.col,element);(0,dom_element.sb)(elementToBeFocused)||(elementToBeFocused=element),!elementToBeFocused||null!==(_classPrivateFieldGet4=_classPrivateFieldGet(_hot,this).getActiveEditor())&&void 0!==_classPrivateFieldGet4&&_classPrivateFieldGet4.isOpened()||elementToBeFocused.focus({preventScroll:!0})};selectedCell?focusElement(selectedCell):focusManager_assertClassBrand(_FocusManager_brand,this,_getSelectedCell).call(this,(element=>focusElement(element)))}refocusToEditorTextarea(){var _classPrivateFieldGet5;let delay=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_classPrivateFieldGet(_refocusDelay,this);var _classPrivateFieldGet6,_classPrivateFieldGet7;!_classPrivateFieldGet(_hot,this).getSettings().imeFastEdit||null!==(_classPrivateFieldGet5=_classPrivateFieldGet(_hot,this).getActiveEditor())&&void 0!==_classPrivateFieldGet5&&_classPrivateFieldGet5.isOpened()||(null===(_classPrivateFieldGet6=_classPrivateFieldGet(_hot,this).getActiveEditor())||void 0===_classPrivateFieldGet6||null===(_classPrivateFieldGet7=_classPrivateFieldGet6.refreshValue)||void 0===_classPrivateFieldGet7||_classPrivateFieldGet7.call(_classPrivateFieldGet6),_classPrivateFieldGet(_debouncedSelect,this).has(delay)||_classPrivateFieldGet(_debouncedSelect,this).set(delay,(0,helpers_function.sg)((()=>{var _this$getRefocusEleme;null===(_this$getRefocusEleme=this.getRefocusElement())||void 0===_this$getRefocusEleme||_this$getRefocusEleme.select()}),delay)),_classPrivateFieldGet(_debouncedSelect,this).get(delay)())}}function _getSelectedCell(callback){var _classPrivateFieldGet8;const highlight=null===(_classPrivateFieldGet8=_classPrivateFieldGet(_hot,this).getSelectedRangeLast())||void 0===_classPrivateFieldGet8?void 0:_classPrivateFieldGet8.highlight;if(!highlight||!_classPrivateFieldGet(_hot,this).selection.isCellVisible(highlight))return void callback(null);const cell=_classPrivateFieldGet(_hot,this).getCell(highlight.row,highlight.col,!0);null===cell?_classPrivateFieldGet(_hot,this).addHookOnce("afterScroll",(()=>{callback(_classPrivateFieldGet(_hot,this).getCell(highlight.row,highlight.col,!0))})):callback(cell)}function _focusCell(){focusManager_assertClassBrand(_FocusManager_brand,this,_getSelectedCell).call(this,(selectedCell=>{const{activeElement}=_classPrivateFieldGet(_hot,this).rootDocument;activeElement&&(0,dom_element.E3)(activeElement)&&activeElement.blur(),this.focusOnHighlightedCell(selectedCell)}))}function _focusEditorElement(){focusManager_assertClassBrand(_FocusManager_brand,this,_getSelectedCell).call(this,(selectedCell=>{this.getFocusMode()===FOCUS_MODES.MIXED&&"TD"===(null==selectedCell?void 0:selectedCell.nodeName)&&this.refocusToEditorTextarea()}))}function _onUpdateSettings(newSettings){"boolean"==typeof newSettings.imeFastEdit&&this.setFocusMode(newSettings.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL)}var array=__webpack_require__("./node_modules/handsontable/helpers/array.mjs"),parseTable=__webpack_require__("./node_modules/handsontable/utils/parseTable.mjs"),plugins_registry=__webpack_require__("./node_modules/handsontable/plugins/registry.mjs"),renderers_registry=__webpack_require__("./node_modules/handsontable/renderers/registry.mjs"),validators_registry=__webpack_require__("./node_modules/handsontable/validators/registry.mjs"),string=__webpack_require__("./node_modules/handsontable/helpers/string.mjs"),number=__webpack_require__("./node_modules/handsontable/helpers/number.mjs"),feature=__webpack_require__("./node_modules/handsontable/helpers/feature.mjs");function event_classPrivateFieldInitSpec(e,t,a){(function event_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function event_classPrivateFieldGet(s,a){return s.get(event_assertClassBrand(s,a))}function event_classPrivateFieldSet(s,a,r){return s.set(event_assertClassBrand(s,a),r),r}function event_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _wtSettings=new WeakMap,_domBindings=new WeakMap,_wtTable=new WeakMap,_selectionManager=new WeakMap,_parent=new WeakMap,_eventManager=new WeakMap,_facadeGetter=new WeakMap,_selectedCellBeforeTouchEnd=new WeakMap,_dblClickTimeout=new WeakMap,_dblClickOrigin=new WeakMap;const src_event=class Event{constructor(facadeGetter,domBindings,wtSettings,eventManager,wtTable,selectionManager){let parent=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;event_classPrivateFieldInitSpec(this,_wtSettings,void 0),event_classPrivateFieldInitSpec(this,_domBindings,void 0),event_classPrivateFieldInitSpec(this,_wtTable,void 0),event_classPrivateFieldInitSpec(this,_selectionManager,void 0),event_classPrivateFieldInitSpec(this,_parent,void 0),event_classPrivateFieldInitSpec(this,_eventManager,void 0),event_classPrivateFieldInitSpec(this,_facadeGetter,void 0),event_classPrivateFieldInitSpec(this,_selectedCellBeforeTouchEnd,void 0),event_classPrivateFieldInitSpec(this,_dblClickTimeout,[null,null]),event_classPrivateFieldInitSpec(this,_dblClickOrigin,[null,null]),event_classPrivateFieldSet(_wtSettings,this,wtSettings),event_classPrivateFieldSet(_domBindings,this,domBindings),event_classPrivateFieldSet(_wtTable,this,wtTable),event_classPrivateFieldSet(_selectionManager,this,selectionManager),event_classPrivateFieldSet(_parent,this,parent),event_classPrivateFieldSet(_eventManager,this,eventManager),event_classPrivateFieldSet(_facadeGetter,this,facadeGetter),this.registerEvents()}registerEvents(){event_classPrivateFieldGet(_eventManager,this).addEventListener(event_classPrivateFieldGet(_wtTable,this).holder,"contextmenu",(event=>this.onContextMenu(event))),event_classPrivateFieldGet(_eventManager,this).addEventListener(event_classPrivateFieldGet(_wtTable,this).TABLE,"mouseover",(event=>this.onMouseOver(event))),event_classPrivateFieldGet(_eventManager,this).addEventListener(event_classPrivateFieldGet(_wtTable,this).TABLE,"mouseout",(event=>this.onMouseOut(event)));const initTouchEvents=()=>{event_classPrivateFieldGet(_eventManager,this).addEventListener(event_classPrivateFieldGet(_wtTable,this).holder,"touchstart",(event=>this.onTouchStart(event))),event_classPrivateFieldGet(_eventManager,this).addEventListener(event_classPrivateFieldGet(_wtTable,this).holder,"touchend",(event=>this.onTouchEnd(event))),this.momentumScrolling||(this.momentumScrolling={}),event_classPrivateFieldGet(_eventManager,this).addEventListener(event_classPrivateFieldGet(_wtTable,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||event_classPrivateFieldGet(_wtSettings,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,event_classPrivateFieldGet(_wtSettings,this).getSetting("onAfterMomentumScroll"))}),200)}))},initMouseEvents=()=>{event_classPrivateFieldGet(_eventManager,this).addEventListener(event_classPrivateFieldGet(_wtTable,this).holder,"mouseup",(event=>this.onMouseUp(event))),event_classPrivateFieldGet(_eventManager,this).addEventListener(event_classPrivateFieldGet(_wtTable,this).holder,"mousedown",(event=>this.onMouseDown(event)))};(0,browser.rr)()?initTouchEvents():((0,feature.yd)()&&initTouchEvents(),initMouseEvents())}selectedCellWasTouched(touchTarget){const coordsOfCellUnderFinger=this.parentCell(touchTarget).coords;if(event_classPrivateFieldGet(_selectedCellBeforeTouchEnd,this)&&coordsOfCellUnderFinger){const[rowTouched,rowSelected]=[coordsOfCellUnderFinger.row,event_classPrivateFieldGet(_selectedCellBeforeTouchEnd,this).from.row],[colTouched,colSelected]=[coordsOfCellUnderFinger.col,event_classPrivateFieldGet(_selectedCellBeforeTouchEnd,this).from.col];return rowTouched===rowSelected&&colTouched===colSelected}return!1}parentCell(elem){const cell={},TABLE=event_classPrivateFieldGet(_wtTable,this).TABLE,TD=(0,dom_element.cr)(elem,["TD","TH"],TABLE);return TD?(cell.coords=event_classPrivateFieldGet(_wtTable,this).getCoords(TD),cell.TD=TD):(0,dom_element.nB)(elem,"wtBorder")&&(0,dom_element.nB)(elem,"current")?(cell.coords=event_classPrivateFieldGet(_selectionManager,this).getFocusSelection().cellRange.highlight,cell.TD=event_classPrivateFieldGet(_wtTable,this).getCell(cell.coords)):(0,dom_element.nB)(elem,"wtBorder")&&(0,dom_element.nB)(elem,"area")&&event_classPrivateFieldGet(_selectionManager,this).getAreaSelection().cellRange&&(cell.coords=event_classPrivateFieldGet(_selectionManager,this).getAreaSelection().cellRange.to,cell.TD=event_classPrivateFieldGet(_wtTable,this).getCell(cell.coords)),cell}onMouseDown(event){const activeElement=event_classPrivateFieldGet(_domBindings,this).rootDocument.activeElement,getParentNode=(0,helpers_function.OH)(dom_element.PA,event.target),realTarget=event.target;if(!["TD","TH"].includes(activeElement.nodeName)&&(realTarget===activeElement||getParentNode(0)===activeElement||getParentNode(1)===activeElement))return;const cell=this.parentCell(realTarget);(0,dom_element.nB)(realTarget,"corner")?event_classPrivateFieldGet(_wtSettings,this).getSetting("onCellCornerMouseDown",event,realTarget):cell.TD&&event_classPrivateFieldGet(_wtSettings,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",event,cell.coords,cell.TD),(0===event.button||this.touchApplied)&&cell.TD&&(event_classPrivateFieldGet(_dblClickOrigin,this)[0]=cell.TD,clearTimeout(event_classPrivateFieldGet(_dblClickTimeout,this)[0]),event_classPrivateFieldGet(_dblClickTimeout,this)[0]=setTimeout((()=>{event_classPrivateFieldGet(_dblClickOrigin,this)[0]=null}),1e3))}onContextMenu(event){if(event_classPrivateFieldGet(_wtSettings,this).has("onCellContextMenu")){const cell=this.parentCell(event.target);cell.TD&&this.callListener("onCellContextMenu",event,cell.coords,cell.TD)}}onMouseOver(event){if(!event_classPrivateFieldGet(_wtSettings,this).has("onCellMouseOver"))return;const table=event_classPrivateFieldGet(_wtTable,this).TABLE,td=(0,dom_element.cr)(event.target,["TD","TH"],table),parent=event_classPrivateFieldGet(_parent,this)||this;td&&td!==parent.lastMouseOver&&(0,dom_element.aO)(td,table)&&(parent.lastMouseOver=td,this.callListener("onCellMouseOver",event,event_classPrivateFieldGet(_wtTable,this).getCoords(td),td))}onMouseOut(event){if(!event_classPrivateFieldGet(_wtSettings,this).has("onCellMouseOut"))return;const table=event_classPrivateFieldGet(_wtTable,this).TABLE,lastTD=(0,dom_element.cr)(event.target,["TD","TH"],table),nextTD=(0,dom_element.cr)(event.relatedTarget,["TD","TH"],table),parent=event_classPrivateFieldGet(_parent,this)||this;lastTD&&lastTD!==nextTD&&(0,dom_element.aO)(lastTD,table)&&(this.callListener("onCellMouseOut",event,event_classPrivateFieldGet(_wtTable,this).getCoords(lastTD),lastTD),null===nextTD&&(parent.lastMouseOver=null))}onMouseUp(event){const cell=this.parentCell(event.target);cell.TD&&event_classPrivateFieldGet(_wtSettings,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",event,cell.coords,cell.TD),(0===event.button||this.touchApplied)&&(cell.TD===event_classPrivateFieldGet(_dblClickOrigin,this)[0]&&cell.TD===event_classPrivateFieldGet(_dblClickOrigin,this)[1]?((0,dom_element.nB)(event.target,"corner")?this.callListener("onCellCornerDblClick",event,cell.coords,cell.TD):this.callListener("onCellDblClick",event,cell.coords,cell.TD),event_classPrivateFieldGet(_dblClickOrigin,this)[0]=null,event_classPrivateFieldGet(_dblClickOrigin,this)[1]=null):cell.TD===event_classPrivateFieldGet(_dblClickOrigin,this)[0]&&(event_classPrivateFieldGet(_dblClickOrigin,this)[1]=cell.TD,clearTimeout(event_classPrivateFieldGet(_dblClickTimeout,this)[1]),event_classPrivateFieldGet(_dblClickTimeout,this)[1]=setTimeout((()=>{event_classPrivateFieldGet(_dblClickOrigin,this)[1]=null}),500)))}onTouchStart(event){event_classPrivateFieldSet(_selectedCellBeforeTouchEnd,this,event_classPrivateFieldGet(_selectionManager,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(event)}onTouchEnd(event){var _this$parentCell;const target=event.target,parentCellCoords=null===(_this$parentCell=this.parentCell(target))||void 0===_this$parentCell?void 0:_this$parentCell.coords,isCellsRange=(0,mixed.O9)(parentCellCoords)&&parentCellCoords.row>=0&&parentCellCoords.col>=0;if(event.cancelable&&isCellsRange&&event_classPrivateFieldGet(_wtSettings,this).getSetting("isDataViewInstance")){const interactiveElements=["A","BUTTON","INPUT"];(0,browser.un)()&&((0,browser.B6)()||(0,browser.wF)())&&this.selectedCellWasTouched(target)&&!interactiveElements.includes(target.tagName)?event.preventDefault():this.selectedCellWasTouched(target)||event.preventDefault()}this.onMouseUp(event),this.touchApplied=!1}callListener(name,event,coords,target){const listener=event_classPrivateFieldGet(_wtSettings,this).getSettingPure(name);listener&&listener(event,coords,target,event_classPrivateFieldGet(_facadeGetter,this).call(this))}destroy(){clearTimeout(event_classPrivateFieldGet(_dblClickTimeout,this)[0]),clearTimeout(event_classPrivateFieldGet(_dblClickTimeout,this)[1]),event_classPrivateFieldGet(_eventManager,this).destroy()}};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js");function column_defineProperty(e,r,t){return(r=function column_toPropertyKey(t){var i=function column_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const column=class ColumnFilter{constructor(offset,total,countTH){column_defineProperty(this,"offset",void 0),column_defineProperty(this,"total",void 0),column_defineProperty(this,"countTH",void 0),this.offset=offset,this.total=total,this.countTH=countTH}offsetted(index){return index+this.offset}unOffsetted(index){return index-this.offset}renderedToSource(index){return this.offsetted(index)}sourceToRendered(index){return this.unOffsetted(index)}offsettedTH(index){return index-this.countTH}unOffsettedTH(index){return index+this.countTH}visibleRowHeadedColumnToSourceColumn(index){return this.renderedToSource(this.offsettedTH(index))}sourceColumnToVisibleRowHeadedColumn(index){return this.unOffsettedTH(this.sourceToRendered(index))}};function row_defineProperty(e,r,t){return(r=function row_toPropertyKey(t){var i=function row_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const row=class RowFilter{constructor(offset,total,countTH){row_defineProperty(this,"offset",void 0),row_defineProperty(this,"total",void 0),row_defineProperty(this,"countTH",void 0),this.offset=offset,this.total=total,this.countTH=countTH}offsetted(index){return index+this.offset}unOffsetted(index){return index-this.offset}renderedToSource(index){return this.offsetted(index)}sourceToRendered(index){return this.unOffsetted(index)}offsettedTH(index){return index-this.countTH}unOffsettedTH(index){return index+this.countTH}visibleColHeadedRowToSourceRow(index){return this.renderedToSource(this.offsettedTH(index))}sourceRowToVisibleColHeadedRow(index){return this.unOffsettedTH(this.sourceToRendered(index))}};function viewSize_defineProperty(e,r,t){return(r=function viewSize_toPropertyKey(t){var i=function viewSize_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ViewSize{constructor(){viewSize_defineProperty(this,"currentSize",0),viewSize_defineProperty(this,"nextSize",0),viewSize_defineProperty(this,"currentOffset",0),viewSize_defineProperty(this,"nextOffset",0)}setSize(size){this.currentSize=this.nextSize,this.nextSize=size}setOffset(offset){this.currentOffset=this.nextOffset,this.nextOffset=offset}}function viewSizeSet_defineProperty(e,r,t){return(r=function viewSizeSet_toPropertyKey(t){var i=function viewSizeSet_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ViewSizeSet{constructor(){viewSizeSet_defineProperty(this,"size",new ViewSize),viewSizeSet_defineProperty(this,"workingSpace",0),viewSizeSet_defineProperty(this,"sharedSize",null)}setSize(size){this.size.setSize(size)}setOffset(offset){this.size.setOffset(offset)}getViewSize(){return this.size}isShared(){return null!==this.sharedSize}isPlaceOn(workingSpace){return this.workingSpace===workingSpace}append(viewSize){this.workingSpace=1,viewSize.workingSpace=2,this.sharedSize=viewSize.getViewSize()}prepend(viewSize){this.workingSpace=2,viewSize.workingSpace=1,this.sharedSize=viewSize.getViewSize()}}__webpack_require__("./node_modules/core-js/modules/es.array.unshift.js");function viewOrder_defineProperty(e,r,t){return(r=function viewOrder_toPropertyKey(t){var i=function viewOrder_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ViewOrder{constructor(viewOffset,viewSize){viewOrder_defineProperty(this,"order",[]),this.order=[...Array(viewSize).keys()].map((i=>viewOffset+i))}get length(){return this.order.length}has(offsetIndex){return this.order.indexOf(offsetIndex)>-1}get(zeroBasedIndex){return zeroBasedIndex<this.order.length?this.order[zeroBasedIndex]:-1}remove(offsetIndex){this.order.splice(this.order.indexOf(offsetIndex),1)}prepend(offsetIndex){return this.order.unshift(offsetIndex),this.order.pop()}}function viewDiffer_defineProperty(e,r,t){return(r=function viewDiffer_toPropertyKey(t){var i=function viewDiffer_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ViewDiffer{constructor(sizeSet){viewDiffer_defineProperty(this,"sizeSet",void 0),this.sizeSet=sizeSet}diff(){const{sizeSet}=this,{currentSize:currentViewSize,nextSize:nextViewSize}=sizeSet.getViewSize();let maxSize=Math.max(nextViewSize,currentViewSize);if(0===maxSize)return[];const{currentOffset,nextOffset}=sizeSet.getViewSize(),currentViewOrder=new ViewOrder(currentOffset,currentViewSize),nextViewOrder=new ViewOrder(nextOffset,nextViewSize),leads=[];for(let i=0;i<maxSize;i++){const currentIndex=currentViewOrder.get(i),nextIndex=nextViewOrder.get(i);if(-1===nextIndex)leads.push(["remove",currentIndex]);else if(-1===currentIndex)!sizeSet.isShared()||sizeSet.isShared()&&sizeSet.isPlaceOn(2)?leads.push(["append",nextIndex]):leads.push(["prepend",nextIndex]);else if(nextIndex>currentIndex)currentViewOrder.has(nextIndex)&&(currentViewOrder.remove(nextIndex),nextViewSize<=currentViewOrder.length&&(maxSize-=1)),leads.push(["replace",nextIndex,currentIndex]);else if(nextIndex<currentIndex){const indexToRemove=currentViewOrder.prepend(nextIndex);leads.push(["insert_before",nextIndex,currentIndex,indexToRemove])}else leads.push(["none",nextIndex])}return leads}}function view_defineProperty(e,r,t){return(r=function view_toPropertyKey(t){var i=function view_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class OrderView{constructor(rootNode,nodesPool){view_defineProperty(this,"rootNode",void 0),view_defineProperty(this,"nodesPool",void 0),view_defineProperty(this,"sizeSet",new ViewSizeSet),view_defineProperty(this,"collectedNodes",[]),view_defineProperty(this,"viewDiffer",new ViewDiffer(this.sizeSet)),view_defineProperty(this,"leads",[]),this.rootNode=rootNode,this.nodesPool=nodesPool}setSize(size){return this.sizeSet.setSize(size),this}setOffset(offset){return this.sizeSet.setOffset(offset),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(visualIndex){return visualIndex<this.collectedNodes.length?this.collectedNodes[visualIndex]:null}getCurrentNode(){const length=this.collectedNodes.length;return length>0?this.collectedNodes[length-1]:null}applyCommand(command){const{rootNode}=this,[name,nodeIndex,nodePrevIndex,nodeIndexToRemove]=command,node=this.nodesPool(nodeIndex);switch(this.collectedNodes.push(node),name){case"prepend":rootNode.insertBefore(node,rootNode.firstChild);break;case"append":rootNode.appendChild(node);break;case"insert_before":rootNode.insertBefore(node,this.nodesPool(nodePrevIndex)),rootNode.removeChild(this.nodesPool(nodeIndexToRemove));break;case"replace":rootNode.replaceChild(node,this.nodesPool(nodePrevIndex));break;case"remove":rootNode.removeChild(node)}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class SharedOrderView extends OrderView{prependView(orderView){return this.sizeSet.prepend(orderView.sizeSet),orderView.sizeSet.append(this.sizeSet),this}appendView(orderView){return this.sizeSet.append(orderView.sizeSet),orderView.sizeSet.prepend(this.sizeSet),this}}function nodesPool_defineProperty(e,r,t){return(r=function nodesPool_toPropertyKey(t){var i=function nodesPool_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class NodesPool{constructor(nodeType){nodesPool_defineProperty(this,"nodeType",void 0),nodesPool_defineProperty(this,"pool",new Map),this.nodeType=nodeType.toUpperCase()}setRootDocument(rootDocument){this.rootDocument=rootDocument}obtain(rowIndex,columnIndex){const key="number"==typeof columnIndex?`${rowIndex}x${columnIndex}`:rowIndex.toString();if(this.pool.has(key))return this.pool.get(key);const node=this.rootDocument.createElement(this.nodeType);return this.pool.set(key,node),node}}function _base_defineProperty(e,r,t){return(r=function _base_toPropertyKey(t){var i=function _base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class BaseRenderer{constructor(nodeType,rootNode){_base_defineProperty(this,"nodesPool",null),_base_defineProperty(this,"nodeType",void 0),_base_defineProperty(this,"rootNode",void 0),_base_defineProperty(this,"table",null),_base_defineProperty(this,"renderedNodes",0),this.nodesPool="string"==typeof nodeType?new NodesPool(nodeType):null,this.nodeType=nodeType,this.rootNode=rootNode}setTable(table){this.nodesPool&&this.nodesPool.setRootDocument(table.rootDocument),this.table=table}adjust(){}render(){}}var a11y=__webpack_require__("./node_modules/handsontable/helpers/a11y.mjs");function rowHeaders_defineProperty(e,r,t){return(r=function rowHeaders_toPropertyKey(t){var i=function rowHeaders_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RowHeadersRenderer extends BaseRenderer{constructor(){super("TH"),rowHeaders_defineProperty(this,"orderViews",new WeakMap),rowHeaders_defineProperty(this,"sourceRowIndex",0)}obtainOrderView(rootNode){let orderView;return this.orderViews.has(rootNode)?orderView=this.orderViews.get(rootNode):(orderView=new SharedOrderView(rootNode,(sourceColumnIndex=>this.nodesPool.obtain(this.sourceRowIndex,sourceColumnIndex))),this.orderViews.set(rootNode,orderView)),orderView}render(){const{rowsToRender,rowHeaderFunctions,rowHeadersCount,rows,cells}=this.table;for(let visibleRowIndex=0;visibleRowIndex<rowsToRender;visibleRowIndex++){const sourceRowIndex=this.table.renderedRowToSource(visibleRowIndex),TR=rows.getRenderedNode(visibleRowIndex);this.sourceRowIndex=sourceRowIndex;const orderView=this.obtainOrderView(TR),cellsView=cells.obtainOrderView(TR);orderView.appendView(cellsView).setSize(rowHeadersCount).setOffset(0).start();for(let visibleColumnIndex=0;visibleColumnIndex<rowHeadersCount;visibleColumnIndex++){orderView.render();const TH=orderView.getCurrentNode();TH.className="",TH.removeAttribute("style"),(0,dom_element.De)(TH,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&(0,dom_element.Bq)(TH,[(0,a11y.Nf)(),(0,a11y.D9)(),(0,a11y.wD)(visibleColumnIndex+1),(0,a11y.vC)(-1)]),rowHeaderFunctions[visibleColumnIndex](sourceRowIndex,TH,visibleColumnIndex)}orderView.end()}}}class ColumnHeadersRenderer extends BaseRenderer{constructor(rootNode){super(null,rootNode)}adjust(){const{columnHeadersCount,rowHeadersCount}=this.table;let TR=this.rootNode.firstChild;if(columnHeadersCount){const{columnsToRender}=this.table,allColumnsToRender=columnsToRender+rowHeadersCount;for(let i=0,len=columnHeadersCount;i<len;i++){for(TR=this.rootNode.childNodes[i],TR||(TR=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(TR)),this.renderedNodes=TR.childNodes.length;this.renderedNodes<allColumnsToRender;)TR.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>allColumnsToRender;)TR.removeChild(TR.lastChild),this.renderedNodes-=1}const theadChildrenLength=this.rootNode.childNodes.length;if(theadChildrenLength>columnHeadersCount)for(let i=columnHeadersCount;i<theadChildrenLength;i++)this.rootNode.removeChild(this.rootNode.lastChild)}else TR&&(0,dom_element.Ie)(TR)}render(){const{columnHeadersCount}=this.table;this.table.isAriaEnabled()&&(0,dom_element.Bq)(this.rootNode,[(0,a11y.t0)()]);for(let rowHeaderIndex=0;rowHeaderIndex<columnHeadersCount;rowHeaderIndex+=1){const{columnHeaderFunctions,columnsToRender,rowHeadersCount}=this.table,TR=this.rootNode.childNodes[rowHeaderIndex];this.table.isAriaEnabled()&&(0,dom_element.Bq)(TR,[(0,a11y.Sb)(),(0,a11y.Qg)(rowHeaderIndex+1)]);for(let renderedColumnIndex=-1*rowHeadersCount;renderedColumnIndex<columnsToRender;renderedColumnIndex+=1){const sourceColumnIndex=this.table.renderedColumnToSource(renderedColumnIndex),TH=TR.childNodes[renderedColumnIndex+rowHeadersCount];TH.className="",TH.removeAttribute("style"),(0,dom_element.De)(TH,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&(0,dom_element.Bq)(TH,[(0,a11y.wD)(renderedColumnIndex+1+this.table.rowHeadersCount),(0,a11y.vC)(-1),(0,a11y.Jg)(),...renderedColumnIndex>=0?[(0,a11y.L2)()]:[(0,a11y.Sb)()]]),columnHeaderFunctions[rowHeaderIndex](sourceColumnIndex,TH,rowHeaderIndex)}}}}var templateLiteralTag=__webpack_require__("./node_modules/handsontable/helpers/templateLiteralTag.mjs");let performanceWarningAppeared=!1;class ColGroupRenderer extends BaseRenderer{constructor(rootNode){super(null,rootNode)}adjust(){const{columnsToRender,rowHeadersCount}=this.table,allColumnsToRender=columnsToRender+rowHeadersCount;for(;this.renderedNodes<allColumnsToRender;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>allColumnsToRender;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender,rowHeadersCount}=this.table;!performanceWarningAppeared&&columnsToRender>1e3&&(performanceWarningAppeared=!0,(0,helpers_console.R8)(templateLiteralTag.O`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let visibleColumnIndex=0;visibleColumnIndex<rowHeadersCount;visibleColumnIndex++){const sourceColumnIndex=this.table.renderedColumnToSource(visibleColumnIndex),width=this.table.columnUtils.getHeaderWidth(sourceColumnIndex);this.rootNode.childNodes[visibleColumnIndex].style.width=`${width}px`}for(let visibleColumnIndex=0;visibleColumnIndex<columnsToRender;visibleColumnIndex++){const sourceColumnIndex=this.table.renderedColumnToSource(visibleColumnIndex),width=this.table.columnUtils.getWidth(sourceColumnIndex);this.rootNode.childNodes[visibleColumnIndex+rowHeadersCount].style.width=`${width}px`}const firstChild=this.rootNode.firstChild;firstChild&&(0,dom_element.iQ)(firstChild,"rowHeader")}}function rows_defineProperty(e,r,t){return(r=function rows_toPropertyKey(t){var i=function rows_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const ROW_CLASSNAMES_rowEven="ht__row_even",ROW_CLASSNAMES_rowOdd="ht__row_odd";let rows_performanceWarningAppeared=!1;class RowsRenderer extends BaseRenderer{constructor(rootNode){super("TR",rootNode),rows_defineProperty(this,"orderView",void 0),this.orderView=new OrderView(rootNode,(sourceRowIndex=>this.nodesPool.obtain(sourceRowIndex)))}getRenderedNode(visualIndex){return this.orderView.getNode(visualIndex)}hasStaleContent(visualIndex){return this.orderView.hasStaleContent(visualIndex)}render(){const{rowsToRender}=this.table;!rows_performanceWarningAppeared&&rowsToRender>1e3&&(rows_performanceWarningAppeared=!0,(0,helpers_console.R8)(templateLiteralTag.O`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,dom_element.Bq)(this.rootNode,[(0,a11y.t0)()]),this.orderView.setSize(rowsToRender).setOffset(this.table.renderedRowToSource(0)).start();for(let visibleRowIndex=0;visibleRowIndex<rowsToRender;visibleRowIndex++){this.orderView.render();const TR=this.orderView.getCurrentNode(),sourceRowIndex=this.table.renderedRowToSource(visibleRowIndex);var _this$table$rowUtils$,_this$table$rowUtils;if(this.table.isAriaEnabled())(0,dom_element.Bq)(TR,[(0,a11y.Sb)(),(0,a11y.Qg)(sourceRowIndex+(null!==(_this$table$rowUtils$=null===(_this$table$rowUtils=this.table.rowUtils)||void 0===_this$table$rowUtils||null===(_this$table$rowUtils=_this$table$rowUtils.dataAccessObject)||void 0===_this$table$rowUtils?void 0:_this$table$rowUtils.columnHeaders.length)&&void 0!==_this$table$rowUtils$?_this$table$rowUtils$:0)+1)]);(sourceRowIndex+1)%2==0?(0,dom_element.nB)(TR,ROW_CLASSNAMES_rowEven)||((0,dom_element.vy)(TR,ROW_CLASSNAMES_rowOdd),(0,dom_element.iQ)(TR,ROW_CLASSNAMES_rowEven)):(0,dom_element.nB)(TR,ROW_CLASSNAMES_rowOdd)||((0,dom_element.vy)(TR,ROW_CLASSNAMES_rowEven),(0,dom_element.iQ)(TR,ROW_CLASSNAMES_rowOdd))}this.orderView.end()}}function cells_defineProperty(e,r,t){return(r=function cells_toPropertyKey(t){var i=function cells_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class CellsRenderer extends BaseRenderer{constructor(){super("TD"),cells_defineProperty(this,"orderViews",new WeakMap),cells_defineProperty(this,"sourceRowIndex",0)}obtainOrderView(rootNode){let orderView;return this.orderViews.has(rootNode)?orderView=this.orderViews.get(rootNode):(orderView=new SharedOrderView(rootNode,(sourceColumnIndex=>this.nodesPool.obtain(this.sourceRowIndex,sourceColumnIndex)),this.nodeType),this.orderViews.set(rootNode,orderView)),orderView}render(){const{rowsToRender,columnsToRender,rows,rowHeaders}=this.table;for(let visibleRowIndex=0;visibleRowIndex<rowsToRender;visibleRowIndex++){const sourceRowIndex=this.table.renderedRowToSource(visibleRowIndex),TR=rows.getRenderedNode(visibleRowIndex);this.sourceRowIndex=sourceRowIndex;const orderView=this.obtainOrderView(TR),rowHeadersView=rowHeaders.obtainOrderView(TR);orderView.prependView(rowHeadersView).setSize(columnsToRender).setOffset(0).start();for(let visibleColumnIndex=0;visibleColumnIndex<columnsToRender;visibleColumnIndex++){orderView.render();const sourceColumnIndex=this.table.renderedColumnToSource(visibleColumnIndex),TD=orderView.getCurrentNode();var _this$table$rowUtils$,_this$table$rowUtils;if((0,dom_element.nB)(TD,"hide")||(TD.className=""),TD.removeAttribute("style"),TD.removeAttribute("dir"),(0,dom_element.De)(TD,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(sourceRowIndex,sourceColumnIndex,TD),this.table.isAriaEnabled())(0,dom_element.Bq)(TD,[...TD.hasAttribute("role")?[]:[(0,a11y.g)()],(0,a11y.vC)(-1),(0,a11y.wD)(sourceColumnIndex+(null!==(_this$table$rowUtils$=null===(_this$table$rowUtils=this.table.rowUtils)||void 0===_this$table$rowUtils||null===(_this$table$rowUtils=_this$table$rowUtils.dataAccessObject)||void 0===_this$table$rowUtils?void 0:_this$table$rowUtils.rowHeaders.length)&&void 0!==_this$table$rowUtils$?_this$table$rowUtils$:0)+1)])}orderView.end()}}}function table_defineProperty(e,r,t){return(r=function table_toPropertyKey(t){var i=function table_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class TableRenderer{constructor(rootNode){let{cellRenderer,stylesHandler}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};table_defineProperty(this,"rootNode",void 0),table_defineProperty(this,"rootDocument",void 0),table_defineProperty(this,"rowHeaders",null),table_defineProperty(this,"columnHeaders",null),table_defineProperty(this,"colGroup",null),table_defineProperty(this,"rows",null),table_defineProperty(this,"cells",null),table_defineProperty(this,"rowFilter",null),table_defineProperty(this,"columnFilter",null),table_defineProperty(this,"rowUtils",null),table_defineProperty(this,"columnUtils",null),table_defineProperty(this,"rowsToRender",0),table_defineProperty(this,"columnsToRender",0),table_defineProperty(this,"rowHeaderFunctions",[]),table_defineProperty(this,"rowHeadersCount",0),table_defineProperty(this,"columnHeaderFunctions",[]),table_defineProperty(this,"columnHeadersCount",0),table_defineProperty(this,"cellRenderer",void 0),table_defineProperty(this,"activeOverlayName",void 0),table_defineProperty(this,"stylesHandler",void 0),this.rootNode=rootNode,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=cellRenderer,this.stylesHandler=stylesHandler}setActiveOverlayName(overlayName){this.activeOverlayName=overlayName}setAxisUtils(rowUtils,columnUtils){this.rowUtils=rowUtils,this.columnUtils=columnUtils}setViewportSize(rowsCount,columnsCount){this.rowsToRender=rowsCount,this.columnsToRender=columnsCount}setFilters(rowFilter,columnFilter){this.rowFilter=rowFilter,this.columnFilter=columnFilter}setHeaderContentRenderers(rowHeaders,columnHeaders){this.rowHeaderFunctions=rowHeaders,this.rowHeadersCount=rowHeaders.length,this.columnHeaderFunctions=columnHeaders,this.columnHeadersCount=columnHeaders.length}setRenderers(){let{rowHeaders,columnHeaders,colGroup,rows,cells}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rowHeaders.setTable(this),columnHeaders.setTable(this),colGroup.setTable(this),rows.setTable(this),cells.setTable(this),this.rowHeaders=rowHeaders,this.columnHeaders=columnHeaders,this.colGroup=colGroup,this.rows=rows,this.cells=cells}renderedRowToSource(rowIndex){return this.rowFilter.renderedToSource(rowIndex)}renderedColumnToSource(columnIndex){return this.columnFilter.renderedToSource(columnIndex)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender,rows}=this;for(let visibleRowIndex=0;visibleRowIndex<rowsToRender;visibleRowIndex++){const TR=rows.getRenderedNode(visibleRowIndex),rowUtils=this.rowUtils;if(TR.firstChild){const sourceRowIndex=this.renderedRowToSource(visibleRowIndex),rowHeight=rowUtils.getHeightByOverlayName(sourceRowIndex,this.activeOverlayName),borderCompensation=this.stylesHandler.areCellsBorderBox()?0:1;TR.firstChild.style.height=rowHeight?rowHeight-borderCompensation+"px":""}}}}class Renderer{constructor(){let{TABLE,THEAD,COLGROUP,TBODY,rowUtils,columnUtils,cellRenderer,stylesHandler}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new TableRenderer(TABLE,{cellRenderer,stylesHandler}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(THEAD),colGroup:new ColGroupRenderer(COLGROUP),rows:new RowsRenderer(TBODY),cells:new CellsRenderer}),this.renderer.setAxisUtils(rowUtils,columnUtils)}setActiveOverlayName(overlayName){return this.renderer.setActiveOverlayName(overlayName),this}setFilters(rowFilter,columnFilter){return this.renderer.setFilters(rowFilter,columnFilter),this}setViewportSize(rowsCount,columnsCount){return this.renderer.setViewportSize(rowsCount,columnsCount),this}setHeaderContentRenderers(rowHeaders,columnHeaders){return this.renderer.setHeaderContentRenderers(rowHeaders,columnHeaders),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function utils_column_defineProperty(e,r,t){return(r=function utils_column_toPropertyKey(t){var i=function utils_column_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ColumnUtils{constructor(dataAccessObject,wtSettings){utils_column_defineProperty(this,"dataAccessObject",void 0),utils_column_defineProperty(this,"wtSettings",void 0),utils_column_defineProperty(this,"headerWidths",new Map),this.dataAccessObject=dataAccessObject,this.wtSettings=wtSettings}getWidth(sourceIndex){return this.wtSettings.getSetting("columnWidth",sourceIndex)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(level){let height=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const oversizedHeight=this.dataAccessObject.wtViewport.oversizedColumnHeaders[level];return void 0!==oversizedHeight&&(height=height?Math.max(height,oversizedHeight):oversizedHeight),height}getHeaderWidth(sourceIndex){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(sourceIndex))}calculateWidths(){const{wtSettings}=this;let rowHeaderWidthSetting=wtSettings.getSetting("rowHeaderWidth");if(rowHeaderWidthSetting=wtSettings.getSetting("onModifyRowHeaderWidth",rowHeaderWidthSetting),null!=rowHeaderWidthSetting){const rowHeadersCount=wtSettings.getSetting("rowHeaders").length,defaultColumnWidth=wtSettings.getSetting("defaultColumnWidth");for(let visibleColumnIndex=0;visibleColumnIndex<rowHeadersCount;visibleColumnIndex++){let width=Array.isArray(rowHeaderWidthSetting)?rowHeaderWidthSetting[visibleColumnIndex]:rowHeaderWidthSetting;width=null==width?defaultColumnWidth:width,this.headerWidths.set(visibleColumnIndex,width)}}}}function utils_row_defineProperty(e,r,t){return(r=function utils_row_toPropertyKey(t){var i=function utils_row_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RowUtils{constructor(dataAccessObject,wtSettings){utils_row_defineProperty(this,"dataAccessObject",void 0),utils_row_defineProperty(this,"wtSettings",void 0),this.dataAccessObject=dataAccessObject,this.wtSettings=wtSettings}getHeight(sourceIndex){let height=this.wtSettings.getSetting("rowHeight",sourceIndex);const oversizedHeight=this.dataAccessObject.wtViewport.oversizedRows[sourceIndex];return void 0!==oversizedHeight&&(height=void 0===height?oversizedHeight:Math.max(height,oversizedHeight)),height}getHeightByOverlayName(sourceIndex,overlayName){let height=this.wtSettings.getSetting("rowHeightByOverlayName",sourceIndex,overlayName);const oversizedHeight=this.dataAccessObject.wtViewport.oversizedRows[sourceIndex];return void 0!==oversizedHeight&&(height=void 0===height?oversizedHeight:Math.max(height,oversizedHeight)),height}}const CLONE_TYPES=["top","bottom","inline_start","top_inline_start_corner","bottom_inline_start_corner"],CLONE_CLASS_NAMES=new Map([["top","ht_clone_top"],["bottom","ht_clone_bottom"],["inline_start","ht_clone_inline_start ht_clone_left"],["top_inline_start_corner","ht_clone_top_inline_start_corner ht_clone_top_left_corner"],["bottom_inline_start_corner","ht_clone_bottom_inline_start_corner ht_clone_bottom_left_corner"]]);function src_table_defineProperty(e,r,t){return(r=function src_table_toPropertyKey(t){var i=function src_table_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const table=class Table{constructor(dataAccessObject,facadeGetter,domBindings,wtSettings,name){src_table_defineProperty(this,"wtSettings",null),src_table_defineProperty(this,"domBindings",void 0),src_table_defineProperty(this,"TBODY",null),src_table_defineProperty(this,"THEAD",null),src_table_defineProperty(this,"COLGROUP",null),src_table_defineProperty(this,"hasTableHeight",!0),src_table_defineProperty(this,"hasTableWidth",!0),src_table_defineProperty(this,"isTableVisible",!1),src_table_defineProperty(this,"tableOffset",0),src_table_defineProperty(this,"holderOffset",0),this.domBindings=domBindings,this.isMaster="master"===name,this.name=name,this.dataAccessObject=dataAccessObject,this.facadeGetter=facadeGetter,this.wtSettings=wtSettings,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=domBindings.rootTable,(0,dom_element.vg)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const origRowHeaderWidth=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(origRowHeaderWidth))),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(overlayTypeName){return this.name===overlayTypeName}fixTableDomTree(){const rootDocument=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=rootDocument.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=rootDocument.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=rootDocument.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(table){const parent=table.parentNode;let spreader;return parent&&parent.nodeType===Node.ELEMENT_NODE&&(0,dom_element.nB)(parent,"wtHolder")||(spreader=this.domBindings.rootDocument.createElement("div"),spreader.className="wtSpreader",parent&&parent.insertBefore(spreader,table),spreader.appendChild(table)),spreader.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,dom_element.Bq)(spreader,[(0,a11y.gg)()]),spreader}createHider(spreader){const parent=spreader.parentNode;let hider;return parent&&parent.nodeType===Node.ELEMENT_NODE&&(0,dom_element.nB)(parent,"wtHolder")||(hider=this.domBindings.rootDocument.createElement("div"),hider.className="wtHider",parent&&parent.insertBefore(hider,spreader),hider.appendChild(spreader)),this.wtSettings.getSetting("ariaTags")&&(0,dom_element.Bq)(hider,[(0,a11y.gg)()]),hider}createHolder(hider){const parent=hider.parentNode;let holder;return parent&&parent.nodeType===Node.ELEMENT_NODE&&(0,dom_element.nB)(parent,"wtHolder")||(holder=this.domBindings.rootDocument.createElement("div"),holder.style.position="relative",holder.className="wtHolder",(0,dom_element.Bq)(holder,[(0,a11y.vC)(-1)]),parent&&parent.insertBefore(holder,hider),this.isMaster&&(holder.parentNode.className+="ht_master handsontable",holder.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,dom_element.Bq)(holder.parentNode,[(0,a11y.gg)()])),holder.appendChild(hider)),this.wtSettings.getSetting("ariaTags")&&(0,dom_element.Bq)(holder,[(0,a11y.gg)()]),holder}draw(){let fastDraw=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings}=this,{wtOverlays,wtViewport}=this.dataAccessObject,totalRows=wtSettings.getSetting("totalRows"),totalColumns=wtSettings.getSetting("totalColumns"),rowHeaders=wtSettings.getSetting("rowHeaders"),rowHeadersCount=rowHeaders.length,columnHeaders=wtSettings.getSetting("columnHeaders"),columnHeadersCount=columnHeaders.length;let runFastDraw=fastDraw;if(this.isMaster&&(wtOverlays.beforeDraw(),this.holderOffset=(0,dom_element.cY)(this.holder),runFastDraw=wtViewport.createCalculators(runFastDraw),rowHeadersCount&&!wtSettings.getSetting("fixedColumnsStart"))){const leftScrollPos=wtOverlays.inlineStartOverlay.getScrollPosition(),previousState=this.correctHeaderWidth;this.correctHeaderWidth=0!==leftScrollPos,previousState!==this.correctHeaderWidth&&(runFastDraw=!1)}if(runFastDraw)this.isMaster&&wtOverlays.refresh(!0);else{this.isMaster?this.tableOffset=(0,dom_element.cY)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const startRow=totalRows>0?this.getFirstRenderedRow():0,startColumn=totalColumns>0?this.getFirstRenderedColumn():0;this.rowFilter=new row(startRow,totalRows,columnHeadersCount),this.columnFilter=new column(startColumn,totalColumns,rowHeadersCount);let performRedraw=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const skipRender={};this.wtSettings.getSetting("beforeDraw",!0,skipRender),performRedraw=!0!==skipRender.skipRender}performRedraw&&(this.tableRenderer.setHeaderContentRenderers(rowHeaders,columnHeaders),(this.is("bottom")||this.is("bottom_inline_start_corner"))&&this.tableRenderer.setHeaderContentRenderers(rowHeaders,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is("bottom"))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||wtViewport.createVisibleCalculators(),wtOverlays.refresh(!1),wtOverlays.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is("bottom")&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let positionChanged=!1;return this.isMaster&&(positionChanged=wtOverlays.topOverlay.resetFixedPosition(),wtOverlays.bottomOverlay.clone&&(positionChanged=wtOverlays.bottomOverlay.resetFixedPosition()||positionChanged),positionChanged=wtOverlays.inlineStartOverlay.resetFixedPosition()||positionChanged,wtOverlays.topInlineStartCornerOverlay&&wtOverlays.topInlineStartCornerOverlay.resetFixedPosition(),wtOverlays.bottomInlineStartCornerOverlay&&wtOverlays.bottomInlineStartCornerOverlay.clone&&wtOverlays.bottomInlineStartCornerOverlay.resetFixedPosition()),positionChanged?(wtOverlays.refreshAll(),wtOverlays.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(runFastDraw),this.isMaster&&wtOverlays.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(col){const sourceColIndex=this.columnFilter.renderedToSource(col);let level=this.wtSettings.getSetting("columnHeaders").length;const defaultRowHeight=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let previousColHeaderHeight,currentHeader,currentHeaderHeight;const columnHeaderHeightSetting=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;level;)level-=1,previousColHeaderHeight=this.getColumnHeaderHeight(level),currentHeader=this.getColumnHeader(sourceColIndex,level),currentHeader&&(currentHeaderHeight=(0,dom_element.eU)(currentHeader),(!previousColHeaderHeight&&defaultRowHeight<currentHeaderHeight||previousColHeaderHeight<currentHeaderHeight)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[level]=currentHeaderHeight),Array.isArray(columnHeaderHeightSetting)?null!==columnHeaderHeightSetting[level]&&void 0!==columnHeaderHeightSetting[level]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[level]=columnHeaderHeightSetting[level]):isNaN(columnHeaderHeightSetting)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[level]=columnHeaderHeightSetting),this.dataAccessObject.wtViewport.oversizedColumnHeaders[level]<(columnHeaderHeightSetting[level]||columnHeaderHeightSetting)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[level]=columnHeaderHeightSetting[level]||columnHeaderHeightSetting))}adjustColumnHeaderHeights(){const{wtSettings}=this,children=this.THEAD.childNodes,oversizedColumnHeaders=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let i=0,len=wtSettings.getSetting("columnHeaders").length;i<len;i++)if(oversizedColumnHeaders[i]){if(!children[i]||0===children[i].childNodes.length)return;children[i].childNodes[0].style.height=`${oversizedColumnHeaders[i]}px`}}resetOversizedRows(){const{wtSettings}=this,{wtViewport}=this.dataAccessObject;if((this.isMaster||this.is("bottom"))&&!wtSettings.getSetting("externalRowCalculator")){const rowsToRender=this.getRenderedRowsCount();for(let visibleRowIndex=0;visibleRowIndex<rowsToRender;visibleRowIndex++){const sourceRow=this.rowFilter.renderedToSource(visibleRowIndex);wtViewport.oversizedRows&&wtViewport.oversizedRows[sourceRow]&&(wtViewport.oversizedRows[sourceRow]=void 0)}}}getCell(coords){let row=coords.row,column=coords.col;const hookResult=this.wtSettings.getSetting("onModifyGetCellCoords",row,column,!this.isMaster,"render");if(hookResult&&Array.isArray(hookResult)&&([row,column]=hookResult),this.isRowBeforeRenderedRows(row))return-1;if(this.isRowAfterRenderedRows(row))return-2;if(this.isColumnBeforeRenderedColumns(column))return-3;if(this.isColumnAfterRenderedColumns(column))return-4;const TR=this.getRow(row);if(!TR&&row>=0)throw new Error("TR was expected to be rendered but is not");const TD=TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(column)];if(!TD&&column>=0)throw new Error("TD or TH was expected to be rendered but is not");return TD}getRow(rowIndex){let renderedRowIndex=null,parentElement=null;var _this$rowFilter,_this$rowFilter2;rowIndex<0?(renderedRowIndex=null===(_this$rowFilter=this.rowFilter)||void 0===_this$rowFilter?void 0:_this$rowFilter.sourceRowToVisibleColHeadedRow(rowIndex),parentElement=this.THEAD):(renderedRowIndex=null===(_this$rowFilter2=this.rowFilter)||void 0===_this$rowFilter2?void 0:_this$rowFilter2.sourceToRendered(rowIndex),parentElement=this.TBODY);return void 0!==renderedRowIndex&&void 0!==parentElement&&(!(parentElement.childNodes.length<renderedRowIndex+1)&&parentElement.childNodes[renderedRowIndex])}getColumnHeader(col){let level=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const TR=this.THEAD.childNodes[level];return null==TR?void 0:TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)]}getColumnHeaders(column){const THs=[],visibleColumn=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(column);return this.THEAD.childNodes.forEach((TR=>{const TH=TR.childNodes[visibleColumn];TH&&THs.push(TH)})),THs}getRowHeader(row){let level=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(level>=this.wtSettings.getSetting("rowHeaders").length)return;const renderedRow=this.rowFilter.sourceToRendered(row),visibleRow=renderedRow<0?this.rowFilter.sourceRowToVisibleColHeadedRow(row):renderedRow,TR=(renderedRow<0?this.THEAD:this.TBODY).childNodes[visibleRow];return null==TR?void 0:TR.childNodes[level]}getRowHeaders(row){const THs=[],rowHeadersCount=this.wtSettings.getSetting("rowHeaders").length;for(let renderedRowIndex=0;renderedRowIndex<rowHeadersCount;renderedRowIndex++){const TR=this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)],TH=null==TR?void 0:TR.childNodes[renderedRowIndex];TH&&THs.push(TH)}return THs}getCoords(TD){let cellElement=TD;if("TD"!==cellElement.nodeName&&"TH"!==cellElement.nodeName&&(cellElement=(0,dom_element.kp)(cellElement,["TD","TH"])),null===cellElement)return null;const TR=cellElement.parentNode,CONTAINER=TR.parentNode;let row=(0,dom_element.Pe)(TR),col=cellElement.cellIndex;if((0,dom_element.yn)("top_inline_start_corner",cellElement,this.wtRootElement)||(0,dom_element.yn)("top",cellElement,this.wtRootElement))"THEAD"===CONTAINER.nodeName&&(row-=CONTAINER.childNodes.length);else if((0,dom_element.yn)("bottom_inline_start_corner",cellElement,this.wtRootElement)||(0,dom_element.yn)("bottom",cellElement,this.wtRootElement)){row=this.wtSettings.getSetting("totalRows")-CONTAINER.childNodes.length+row}else CONTAINER===this.THEAD?row=this.rowFilter.visibleColHeadedRowToSourceRow(row):this.rowFilter&&(row=this.rowFilter.renderedToSource(row));(0,dom_element.yn)("top_inline_start_corner",cellElement,this.wtRootElement)||(0,dom_element.yn)("inline_start",cellElement,this.wtRootElement)||(0,dom_element.yn)("bottom_inline_start_corner",cellElement,this.wtRootElement)?col=this.columnFilter.offsettedTH(col):this.columnFilter&&(col=this.columnFilter.visibleRowHeadedColumnToSourceColumn(col));const hookResult=this.wtSettings.getSetting("onModifyGetCoordsElement",row,col);return hookResult&&Array.isArray(hookResult)&&([row,col]=hookResult),this.wot.createCellCoords(row,col)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let rowCount=this.TBODY.childNodes.length;const expectedTableHeight=rowCount*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),actualTableHeight=(0,dom_element.eU)(this.TBODY)-1,borderBoxSizing=this.wot.stylesHandler.areCellsBorderBox(),rowHeightFn=borderBoxSizing?dom_element.DK:dom_element.eU,borderCompensation=borderBoxSizing?0:1,firstRowBorderCompensation=borderBoxSizing?1:0;let previousRowHeight,rowCurrentHeight,sourceRowIndex,currentTr,rowHeader;if(expectedTableHeight!==actualTableHeight||this.wtSettings.getSetting("fixedRowsBottom"))for(;rowCount;){rowCount-=1,sourceRowIndex=this.rowFilter.renderedToSource(rowCount),previousRowHeight=this.getRowHeight(sourceRowIndex),currentTr=this.getTrForRow(sourceRowIndex),rowHeader=currentTr.querySelector("th");const topBorderCompensation=0===sourceRowIndex?firstRowBorderCompensation:0;rowCurrentHeight=rowHeader?rowHeightFn(rowHeader):rowHeightFn(currentTr)-borderCompensation,(!previousRowHeight&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<rowCurrentHeight-topBorderCompensation||previousRowHeight<rowCurrentHeight)&&(borderBoxSizing||(rowCurrentHeight+=1),this.dataAccessObject.wtViewport.oversizedRows[sourceRowIndex]=rowCurrentHeight)}}getTrForRow(row){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)]}isColumnHeaderRendered(column){if(column>=0)return!1;const rowHeadersCount=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(column)<=rowHeadersCount}isRowHeaderRendered(row){if(row>=0)return!1;const columnHeadersCount=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(row)<=columnHeadersCount}isRowBeforeRenderedRows(row){const first=this.getFirstRenderedRow();return row<0&&first<=0?!this.isRowHeaderRendered(row):row<first}isRowAfterRenderedRows(row){return row>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(column){const first=this.getFirstRenderedColumn();return column<0&&first<=0?!this.isColumnHeaderRendered(column):column<first}isColumnAfterRenderedColumns(column){return this.columnFilter&&column>this.getLastRenderedColumn()}isColumnAfterViewport(column){return this.columnFilter&&column>this.getLastVisibleColumn()}isRowAfterViewport(row){return this.rowFilter&&row>this.getLastVisibleRow()}isColumnBeforeViewport(column){return this.columnFilter&&this.columnFilter.sourceToRendered(column)<0&&column>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(sourceRow){return this.rowUtils.getHeight(sourceRow)}getColumnHeaderHeight(level){return this.columnUtils.getHeaderHeight(level)}getColumnWidth(sourceColumn){return this.columnUtils.getWidth(sourceColumn)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,dom_element.Gq)(this.TABLE)}getHeight(){return(0,dom_element.DK)(this.TABLE)}getTotalWidth(){const width=(0,dom_element.Gq)(this.hider);return 0!==width?width:this.getWidth()}getTotalHeight(){const height=(0,dom_element.DK)(this.hider);return 0!==height?height:this.getHeight()}isVisible(){return(0,dom_element.zN)(this.TABLE)}_modifyRowHeaderWidth(rowHeaderWidthFactory){let widths=(0,helpers_function.Tn)(rowHeaderWidthFactory)?rowHeaderWidthFactory():null;return Array.isArray(widths)?(widths=[...widths],widths[widths.length-1]=this._correctRowHeaderWidth(widths[widths.length-1])):widths=this._correctRowHeaderWidth(widths),widths}_correctRowHeaderWidth(width){let rowHeaderWidth=width;return"number"!=typeof width&&(rowHeaderWidth=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(rowHeaderWidth+=1),rowHeaderWidth}},stickyRowsTop={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const totalRows=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),totalRows)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,object.LH)(stickyRowsTop,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const mixin_stickyRowsTop=stickyRowsTop,calculatedColumns={getFirstRenderedColumn(){const startColumn=this.dataAccessObject.startColumnRendered;return null===startColumn?-1:startColumn},getFirstVisibleColumn(){const startColumn=this.dataAccessObject.startColumnVisible;return null===startColumn?-1:startColumn},getFirstPartiallyVisibleColumn(){const startColumn=this.dataAccessObject.startColumnPartiallyVisible;return null===startColumn?-1:startColumn},getLastRenderedColumn(){const endColumn=this.dataAccessObject.endColumnRendered;return null===endColumn?-1:endColumn},getLastVisibleColumn(){const endColumn=this.dataAccessObject.endColumnVisible;return null===endColumn?-1:endColumn},getLastPartiallyVisibleColumn(){const endColumn=this.dataAccessObject.endColumnPartiallyVisible;return null===endColumn?-1:endColumn},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,object.LH)(calculatedColumns,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const mixin_calculatedColumns=calculatedColumns;class TopOverlayTable extends table{constructor(dataAccessObject,facadeGetter,domBindings,wtSettings){super(dataAccessObject,facadeGetter,domBindings,wtSettings,"top")}}(0,object.co)(TopOverlayTable,mixin_stickyRowsTop),(0,object.co)(TopOverlayTable,mixin_calculatedColumns);const table_top=TopOverlayTable;function scroll_classPrivateMethodInitSpec(e,a){(function scroll_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function scroll_defineProperty(e,r,t){return(r=function scroll_toPropertyKey(t){var i=function scroll_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function scroll_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _Scroll_brand=new WeakSet;function _getLastColumnIndex(lastColumnIndex){const{wtSettings,inlineStartOverlay,wtTable,wtViewport,totalColumns,rootWindow}=this.dataAccessObject;if(inlineStartOverlay.mainTableScrollableElement===rootWindow){let inlineStartRootElementOffset=null;if(wtSettings.getSetting("rtlMode")){const tableRect=wtTable.TABLE.getBoundingClientRect(),docOffsetWidth=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;inlineStartRootElementOffset=Math.abs(tableRect.right-docOffsetWidth)}else{inlineStartRootElementOffset=(0,dom_element.cY)(wtTable.wtRootElement).left}const windowScrollLeft=Math.abs((0,dom_element.v_)(rootWindow,rootWindow));if(inlineStartRootElementOffset>windowScrollLeft){const windowWidth=(0,dom_element.xM)(rootWindow);let columnsWidth=wtViewport.getRowHeaderWidth();for(let column=1;column<=totalColumns;column++)if(columnsWidth+=inlineStartOverlay.sumCellSizes(column-1,column),inlineStartRootElementOffset+columnsWidth-windowScrollLeft>=windowWidth){lastColumnIndex=column-2;break}}}return lastColumnIndex}function _getLastRowIndex(lastRowIndex){const{topOverlay,wtTable,wtViewport,totalRows,rootWindow}=this.dataAccessObject;if(topOverlay.mainTableScrollableElement===rootWindow){const rootElementOffset=(0,dom_element.cY)(wtTable.wtRootElement),windowScrollTop=(0,dom_element.hY)(rootWindow,rootWindow);if(rootElementOffset.top>windowScrollTop){const windowHeight=(0,dom_element.eU)(rootWindow);let rowsHeight=wtViewport.getColumnHeaderHeight();for(let row=1;row<=totalRows;row++)if(rowsHeight+=topOverlay.sumCellSizes(row-1,row),rootElementOffset.top+rowsHeight-windowScrollTop>=windowHeight){lastRowIndex=row-2;break}}}return lastRowIndex}const src_scroll=class Scroll{constructor(dataAccessObject){scroll_classPrivateMethodInitSpec(this,_Scroll_brand),scroll_defineProperty(this,"dataAccessObject",void 0),this.dataAccessObject=dataAccessObject}scrollViewport(coords,horizontalSnap,verticalSnap){if(coords.col<0||coords.row<0)return!1;const scrolledHorizontally=this.scrollViewportHorizontally(coords.col,horizontalSnap),scrolledVertically=this.scrollViewportVertically(coords.row,verticalSnap);return scrolledHorizontally||scrolledVertically}scrollViewportHorizontally(column){let snapping=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn,totalColumns}=this.dataAccessObject;if(!drawn)return!1;const snappingObject=(0,object.nA)(snapping);if(column=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",column,snappingObject),!Number.isInteger(column)||column<0||column>totalColumns)return!1;snapping=snappingObject.value;const{fixedColumnsStart,inlineStartOverlay}=this.dataAccessObject,autoSnapping="auto"===snapping;if(autoSnapping&&column<fixedColumnsStart)return!1;const firstColumn=this.getFirstVisibleColumn(),lastColumn=this.getLastVisibleColumn();let result=!1;return(autoSnapping&&(column<firstColumn||column>lastColumn)||!autoSnapping)&&(result=inlineStartOverlay.scrollTo(column,autoSnapping?column>=this.getLastPartiallyVisibleColumn():"end"===snapping)),result}scrollViewportVertically(row){let snapping=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn,totalRows}=this.dataAccessObject;if(!drawn)return!1;const snappingObject=(0,object.nA)(snapping);if(row=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",row,snappingObject),!Number.isInteger(row)||row<0||row>totalRows)return!1;snapping=snappingObject.value;const{fixedRowsBottom,fixedRowsTop,topOverlay}=this.dataAccessObject,autoSnapping="auto"===snapping;if(autoSnapping&&(row<fixedRowsTop||row>totalRows-fixedRowsBottom-1))return!1;const firstRow=this.getFirstVisibleRow(),lastRow=this.getLastVisibleRow();let result=!1;return(autoSnapping&&(row<firstRow||row>lastRow)||!autoSnapping)&&(result=topOverlay.scrollTo(row,autoSnapping?row>=this.getLastPartiallyVisibleRow():"bottom"===snapping)),result}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return scroll_assertClassBrand(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return scroll_assertClassBrand(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return scroll_assertClassBrand(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return scroll_assertClassBrand(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};var coords=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/cell/coords.mjs"),range=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/cell/range.mjs");function core_base_defineProperty(e,r,t){return(r=function core_base_toPropertyKey(t){var i=function core_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class CoreAbstract{get eventManager(){return new handsontable_eventManager.A(this)}constructor(table,settings){core_base_defineProperty(this,"wtTable",void 0),core_base_defineProperty(this,"wtScroll",void 0),core_base_defineProperty(this,"wtViewport",void 0),core_base_defineProperty(this,"wtOverlays",void 0),core_base_defineProperty(this,"selectionManager",void 0),core_base_defineProperty(this,"wtEvent",void 0),core_base_defineProperty(this,"guid",`wt_${(0,string.DU)()}`),core_base_defineProperty(this,"drawInterrupted",!1),core_base_defineProperty(this,"drawn",!1),core_base_defineProperty(this,"activeOverlayName","master"),core_base_defineProperty(this,"domBindings",void 0),core_base_defineProperty(this,"wtSettings",void 0),this.domBindings={rootTable:table,rootDocument:table.ownerDocument,rootWindow:table.ownerDocument.defaultView},this.wtSettings=settings,this.wtScroll=new src_scroll(this.createScrollDao())}findOriginalHeaders(){const originalHeaders=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let c=0,clen=this.wtTable.THEAD.childNodes[0].childNodes.length;c<clen;c++)originalHeaders.push(this.wtTable.THEAD.childNodes[0].childNodes[c].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(column,TH){(0,dom_element.c6)(TH,originalHeaders[column])}])}}createCellCoords(row,column){return new coords.A(row,column,this.wtSettings.getSetting("rtlMode"))}createCellRange(highlight,from,to){return new range.A(highlight,from,to,this.wtSettings.getSetting("rtlMode"))}draw(){let fastDraw=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(fastDraw):this.drawInterrupted=!0,this}getCell(coords){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(coords);const totalRows=this.wtSettings.getSetting("totalRows"),fixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),fixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),fixedColumnsStart=this.wtSettings.getSetting("fixedColumnsStart");if(coords.row<fixedRowsTop&&coords.col<fixedColumnsStart)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(coords);if(coords.row<fixedRowsTop)return this.wtOverlays.topOverlay.clone.wtTable.getCell(coords);if(coords.col<fixedColumnsStart&&coords.row>=totalRows-fixedRowsBottom){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(coords)}else{if(coords.col<fixedColumnsStart)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(coords);if(coords.row<totalRows&&coords.row>=totalRows-fixedRowsBottom&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(coords)}return this.wtTable.getCell(coords)}scrollViewport(coords,horizontalSnap,verticalSnap){return this.wtScroll.scrollViewport(coords,horizontalSnap,verticalSnap)}scrollViewportHorizontally(column,snapping){return this.wtScroll.scrollViewportHorizontally(column,snapping)}scrollViewportVertically(row,snapping){return this.wtScroll.scrollViewportVertically(row,snapping)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const wot=this;return{get drawn(){return wot.drawn},get topOverlay(){return wot.wtOverlays.topOverlay},get inlineStartOverlay(){return wot.wtOverlays.inlineStartOverlay},get wtTable(){return wot.wtTable},get wtViewport(){return wot.wtViewport},get wtSettings(){return wot.wtSettings},get rootWindow(){return wot.domBindings.rootWindow},get totalRows(){return wot.wtSettings.getSetting("totalRows")},get totalColumns(){return wot.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return wot.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return wot.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return wot.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const wot=this;return{get wot(){return wot},get parentTableOffset(){return wot.cloneSource.wtTable.tableOffset},get cloneSource(){return wot.cloneSource},get workspaceWidth(){return wot.wtViewport.getWorkspaceWidth()},get wtViewport(){return wot.wtViewport},get wtOverlays(){return wot.wtOverlays},get selectionManager(){return wot.selectionManager},get stylesHandler(){return wot.stylesHandler},get drawn(){return wot.drawn},set drawn(v){wot.drawn=v},get wtTable(){return wot.wtTable},get startColumnRendered(){return wot.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return wot.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return wot.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return wot.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return wot.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return wot.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return wot.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return wot.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return wot.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return wot.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return wot.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return wot.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return wot.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return wot.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return wot.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return wot.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return wot.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return wot.wtSettings.getSetting("rowHeaders")}}}}function clone_defineProperty(e,r,t){return(r=function clone_toPropertyKey(t){var i=function clone_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class Clone extends CoreAbstract{constructor(table,settings,clone){super(table,settings),clone_defineProperty(this,"cloneSource",void 0),clone_defineProperty(this,"cloneOverlay",void 0);const facadeGetter=this.wtSettings.getSetting("facade",this);this.cloneSource=clone.source,this.cloneOverlay=clone.overlay,this.stylesHandler=clone.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),facadeGetter,this.domBindings,this.wtSettings),this.wtViewport=clone.viewport,this.selectionManager=clone.selectionManager,this.wtEvent=new src_event(facadeGetter,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,clone.event),this.findOriginalHeaders()}}function overlay_base_defineProperty(e,r,t){return(r=function overlay_base_toPropertyKey(t){var i=function overlay_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class Overlay{constructor(wotInstance,facadeGetter,type,wtSettings,domBindings){overlay_base_defineProperty(this,"wtSettings",null),(0,object.LH)(this,"wot",wotInstance,{writable:!1}),this.domBindings=domBindings,this.facadeGetter=facadeGetter,this.wtSettings=wtSettings;const{TABLE,hider,spreader,holder,wtRootElement}=this.wot.wtTable;this.instance=this.wot,this.type=type,this.mainTableScrollableElement=null,this.TABLE=TABLE,this.hider=hider,this.spreader=spreader,this.holder=holder,this.wtRootElement=wtRootElement,this.trimmingContainer=(0,dom_element.fX)(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(drawPhase){"before"===drawPhase&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==drawPhase||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,dom_element.fX)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable}=this.wot,{rootWindow}=this.domBindings;"hidden"===rootWindow.getComputedStyle(wtTable.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,dom_element.K7)(wtTable.TABLE)}getRelativeCellPosition(element,rowIndex,columnIndex){if(!1===this.clone.wtTable.holder.contains(element))return void(0,helpers_console.R8)(`The provided element is not a child of the ${this.type} overlay`);const windowScroll=this.mainTableScrollableElement===this.domBindings.rootWindow,fixedColumnStart=columnIndex<this.wtSettings.getSetting("fixedColumnsStart"),fixedRowTop=rowIndex<this.wtSettings.getSetting("fixedRowsTop"),fixedRowBottom=rowIndex>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),spreader=this.clone.wtTable.spreader,spreaderOffset={start:this.getRelativeStartPosition(spreader),top:spreader.offsetTop},elementOffset={start:this.getRelativeStartPosition(element),top:element.offsetTop};let offsetObject=null;return offsetObject=windowScroll?this.getRelativeCellPositionWithinWindow(fixedRowTop,fixedColumnStart,elementOffset,spreaderOffset):this.getRelativeCellPositionWithinHolder(fixedRowTop,fixedRowBottom,fixedColumnStart,elementOffset,spreaderOffset),offsetObject}getRelativeStartPosition(el){return this.isRtl()?el.offsetParent.offsetWidth-el.offsetLeft-el.offsetWidth:el.offsetLeft}getRelativeCellPositionWithinWindow(onFixedRowTop,onFixedColumn,elementOffset,spreaderOffset){const absoluteRootElementPosition=this.wot.wtTable.wtRootElement.getBoundingClientRect();let horizontalOffset=0,verticalOffset=0;if(onFixedColumn){let absoluteRootElementStartPosition=absoluteRootElementPosition.left;this.isRtl()&&(absoluteRootElementStartPosition=this.domBindings.rootWindow.innerWidth-(absoluteRootElementPosition.left+absoluteRootElementPosition.width+(0,dom_element.XJ)())),horizontalOffset=absoluteRootElementStartPosition<=0?-1*absoluteRootElementStartPosition:0}else horizontalOffset=spreaderOffset.start;if(onFixedRowTop){verticalOffset=this.clone.wtTable.TABLE.getBoundingClientRect().top-absoluteRootElementPosition.top}else verticalOffset=spreaderOffset.top;return{start:elementOffset.start+horizontalOffset,top:elementOffset.top+verticalOffset}}getRelativeCellPositionWithinHolder(onFixedRowTop,onFixedRowBottom,onFixedColumn,elementOffset,spreaderOffset){const tableScrollPosition_horizontal=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),tableScrollPosition_vertical=this.wot.wtOverlays.topOverlay.getScrollPosition();let horizontalOffset=0,verticalOffset=0;if(onFixedColumn||(horizontalOffset=tableScrollPosition_horizontal-spreaderOffset.start),onFixedRowBottom){const absoluteRootElementPosition=this.wot.wtTable.wtRootElement.getBoundingClientRect();verticalOffset=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+absoluteRootElementPosition.top}else onFixedRowTop||(verticalOffset=tableScrollPosition_vertical-spreaderOffset.top);return{start:elementOffset.start-horizontalOffset,top:elementOffset.top-verticalOffset}}makeClone(){if(-1===CLONE_TYPES.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable,wtSettings}=this.wot,{rootDocument,rootWindow}=this.domBindings,clone=rootDocument.createElement("div"),clonedTable=rootDocument.createElement("table"),tableParent=wtTable.wtRootElement.parentNode;clone.className=`${CLONE_CLASS_NAMES.get(this.type)} handsontable`,clone.setAttribute("dir",this.isRtl()?"rtl":"ltr"),clone.style.position="absolute",clone.style.top=0,clone.style.overflow="visible",this.isRtl()?clone.style.right=0:clone.style.left=0,wtSettings.getSetting("ariaTags")&&(0,dom_element.Bq)(clone,[(0,a11y.gg)()]),clonedTable.className=wtTable.TABLE.className;wtTable.TABLE.getAttribute("role")&&clonedTable.setAttribute("role",wtTable.TABLE.getAttribute("role")),clone.appendChild(clonedTable),tableParent.appendChild(clone);const preventOverflow=this.wtSettings.getSetting("preventOverflow");return!0===preventOverflow||"horizontal"===preventOverflow&&"top"===this.type||"vertical"===preventOverflow&&"inline_start"===this.type?this.mainTableScrollableElement=rootWindow:"hidden"===rootWindow.getComputedStyle(tableParent).getPropertyValue("overflow")?this.mainTableScrollableElement=wtTable.holder:this.mainTableScrollableElement=(0,dom_element.K7)(wtTable.TABLE),new Clone(clonedTable,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let fastDraw=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){const cloneSource=this.clone.cloneSource;cloneSource.activeOverlayName=this.clone.wtTable.name,this.clone.draw(fastDraw),cloneSource.activeOverlayName="master"}}reset(){const holder=this.clone.wtTable.holder,hider=this.clone.wtTable.hider;[holder.style,hider.style,holder.parentNode.style].forEach((style=>{style.width="",style.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const getCornerStyle=wot=>{const stylesHandler=wot.stylesHandler;if(stylesHandler.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const cornerSizeFromVar=stylesHandler.getCSSVariableValue("cell-autofill-size"),cornerBorderWidthFromVar=stylesHandler.getCSSVariableValue("cell-autofill-border-width"),cornerColorFromVar=stylesHandler.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:cornerSizeFromVar,height:cornerSizeFromVar,borderWidth:cornerBorderWidthFromVar,borderStyle:"solid",borderColor:cornerColorFromVar})};function top_defineProperty(e,r,t){return(r=function top_toPropertyKey(t){var i=function top_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class TopOverlay extends Overlay{constructor(wotInstance,facadeGetter,wtSettings,domBindings){super(wotInstance,facadeGetter,"top",wtSettings,domBindings),top_defineProperty(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return new table_top(...args)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const overlayRoot=this.clone.wtTable.holder.parentNode,{rootWindow}=this.domBindings,preventOverflow=this.wtSettings.getSetting("preventOverflow");let overlayPosition=0,skipInnerBorderAdjusting=!1;if(this.trimmingContainer!==rootWindow||preventOverflow&&"vertical"===preventOverflow)overlayPosition=this.getScrollPosition(),(0,dom_element.ZK)(overlayRoot);else{const{wtTable}=this.wot,hiderRect=wtTable.hider.getBoundingClientRect();skipInnerBorderAdjusting=Math.ceil(hiderRect.bottom)===overlayRoot.offsetHeight,overlayPosition=this.getOverlayOffset(),(0,dom_element.ON)(overlayRoot,"0px",`${overlayPosition}px`)}const positionChanged=this.adjustHeaderBordersPosition(overlayPosition,skipInnerBorderAdjusting);return this.adjustElementsSize(),positionChanged}setScrollPosition(pos){const rootWindow=this.domBindings.rootWindow;let result=!1;return this.mainTableScrollableElement===rootWindow&&rootWindow.scrollY!==pos?(rootWindow.scrollTo((0,dom_element.Vp)(rootWindow),pos),result=!0):this.mainTableScrollableElement.scrollTop!==pos&&(this.mainTableScrollableElement.scrollTop=pos,result=!0),result}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(from,to){const defaultRowHeight=this.wot.stylesHandler.getDefaultRowHeight();let row=from,sum=0;for(;row<to;){const height=this.wot.wtTable.getRowHeight(row);sum+=void 0===height?defaultRowHeight:height,row+=1}return sum}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable,wtViewport}=this.wot,{rootDocument,rootWindow}=this.domBindings,overlayRootStyle=this.clone.wtTable.holder.parentNode.style,preventOverflow=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==rootWindow||"horizontal"===preventOverflow){let width=wtViewport.getWorkspaceWidth();wtViewport.hasVerticalScroll()&&(width-=(0,dom_element.XJ)(rootDocument)),width=Math.min(width,wtTable.wtRootElement.scrollWidth),overlayRootStyle.width=`${width}px`}else overlayRootStyle.width="";this.clone.wtTable.holder.style.width=overlayRootStyle.width;let tableHeight=(0,dom_element.DK)(this.clone.wtTable.TABLE);wtTable.hasDefinedSize()||(tableHeight=0),overlayRootStyle.height=`${tableHeight}px`}adjustRootChildrenSize(){const{holder}=this.clone.wtTable,cornerStyle=getCornerStyle(this.wot),selectionCornerOffset=this.wot.selectionManager.getFocusSelection()?parseInt(cornerStyle.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,holder.style.width=holder.parentNode.style.width,holder.style.height=`${parseInt(holder.parentNode.style.height,10)+selectionCornerOffset}px`}applyToDOM(){const total=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==total)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const styleProperty=this.isRtl()?"right":"left",{spreader}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?spreader.style[styleProperty]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:spreader.style[styleProperty]=""}scrollTo(sourceRow,bottomEdge){const{wot,wtSettings}=this,mainHolder=(wot.cloneSource?wot.cloneSource:wot).wtTable.holder,columnHeaders=wtSettings.getSetting("columnHeaders"),columnHeaderBorderCompensation=0===wtSettings.getSetting("fixedRowsTop")&&columnHeaders.length>0&&!(0,dom_element.nB)(mainHolder.parentNode,"innerBorderTop")?1:0;let newY=this.getTableParentOffset(),scrollbarCompensation=0;if(bottomEdge){this.wot.wtTable.getRowHeight(sourceRow)>this.wot.wtViewport.getViewportHeight()&&(bottomEdge=!1)}if(bottomEdge&&mainHolder.offsetHeight!==mainHolder.clientHeight&&(scrollbarCompensation=(0,dom_element.XJ)(this.domBindings.rootDocument)),bottomEdge){const fixedRowsBottom=wtSettings.getSetting("fixedRowsBottom"),totalRows=wtSettings.getSetting("totalRows");newY+=this.sumCellSizes(0,sourceRow+1),newY-=wot.wtViewport.getViewportHeight()-this.sumCellSizes(totalRows-fixedRowsBottom,totalRows),newY+=1,newY+=columnHeaderBorderCompensation}else newY+=this.sumCellSizes(wtSettings.getSetting("fixedRowsTop"),sourceRow);return newY+=scrollbarCompensation,(0,dom_element.p6)(this.mainTableScrollableElement)===newY-columnHeaderBorderCompensation&&columnHeaderBorderCompensation>0&&this.wot.wtOverlays.expandHiderVerticallyBy(columnHeaderBorderCompensation),this.setScrollPosition(newY)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,dom_element.hY)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow}=this.domBindings,preventOverflow=this.wtSettings.getSetting("preventOverflow");let overlayOffset=0;if(this.trimmingContainer===rootWindow&&(!preventOverflow||"vertical"!==preventOverflow)){const maxOffset=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();overlayOffset=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),overlayOffset>maxOffset&&(overlayOffset=0)}return overlayOffset}adjustHeaderBordersPosition(position){let skipInnerBorderAdjusting=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings}=this,masterParent=this.wot.wtTable.holder.parentNode,totalColumns=wtSettings.getSetting("totalColumns"),preventHorizontalOverflow="horizontal"===wtSettings.getSetting("preventOverflow");totalColumns?(0,dom_element.vy)(masterParent,"emptyColumns"):(0,dom_element.iQ)(masterParent,"emptyColumns");let positionChanged=!1;if(!skipInnerBorderAdjusting&&!preventHorizontalOverflow){const fixedRowsTop=wtSettings.getSetting("fixedRowsTop"),areFixedRowsTopChanged=this.cachedFixedRowsTop!==fixedRowsTop,columnHeaders=wtSettings.getSetting("columnHeaders");if((areFixedRowsTopChanged||0===fixedRowsTop)&&columnHeaders.length>0){const previousState=(0,dom_element.nB)(masterParent,"innerBorderTop");this.cachedFixedRowsTop=wtSettings.getSetting("fixedRowsTop"),position||0===wtSettings.getSetting("totalRows")?((0,dom_element.iQ)(masterParent,"innerBorderTop"),positionChanged=!previousState):((0,dom_element.vy)(masterParent,"innerBorderTop"),positionChanged=previousState)}}return positionChanged}}const stickyRowsBottom={getFirstRenderedRow(){const totalRows=this.wtSettings.getSetting("totalRows"),fixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),index=totalRows-fixedRowsBottom;return 0===totalRows||0===fixedRowsBottom?-1:index<0?0:index},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const totalRows=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),totalRows)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};(0,object.LH)(stickyRowsBottom,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const mixin_stickyRowsBottom=stickyRowsBottom;class BottomOverlayTable extends table{constructor(dataAccessObject,facadeGetter,domBindings,wtSettings){super(dataAccessObject,facadeGetter,domBindings,wtSettings,"bottom")}}(0,object.co)(BottomOverlayTable,mixin_stickyRowsBottom),(0,object.co)(BottomOverlayTable,mixin_calculatedColumns);const bottom=BottomOverlayTable;function bottom_defineProperty(e,r,t){return(r=function bottom_toPropertyKey(t){var i=function bottom_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class BottomOverlay extends Overlay{constructor(wotInstance,facadeGetter,wtSettings,domBindings){super(wotInstance,facadeGetter,"bottom",wtSettings,domBindings),bottom_defineProperty(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return new bottom(...args)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow}=this.domBindings,overlayRoot=this.clone.wtTable.holder.parentNode;overlayRoot.style.top="";let overlayPosition=0;const preventOverflow=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==rootWindow||preventOverflow&&"vertical"===preventOverflow?(overlayPosition=this.getScrollPosition(),this.repositionOverlay()):(overlayPosition=this.getOverlayOffset(),overlayRoot.style.bottom=`${overlayPosition}px`);const positionChanged=this.adjustHeaderBordersPosition(overlayPosition);return this.adjustElementsSize(),positionChanged}repositionOverlay(){const{wtTable,wtViewport}=this.wot,{rootDocument}=this.domBindings,cloneRoot=this.clone.wtTable.holder.parentNode;let bottomOffset=0;wtViewport.hasVerticalScroll()||(bottomOffset+=wtViewport.getWorkspaceHeight()-wtTable.getTotalHeight()),wtViewport.hasVerticalScroll()&&wtViewport.hasHorizontalScroll()&&(bottomOffset+=(0,dom_element.XJ)(rootDocument)),cloneRoot.style.bottom=`${bottomOffset}px`}setScrollPosition(pos){const{rootWindow}=this.domBindings;let result=!1;return this.mainTableScrollableElement===rootWindow?(rootWindow.scrollTo((0,dom_element.Vp)(rootWindow),pos),result=!0):this.mainTableScrollableElement.scrollTop!==pos&&(this.mainTableScrollableElement.scrollTop=pos,result=!0),result}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(from,to){const{wtTable,stylesHandler}=this.wot,defaultRowHeight=stylesHandler.getDefaultRowHeight();let row=from,sum=0;for(;row<to;){const height=wtTable.getRowHeight(row);sum+=void 0===height?defaultRowHeight:height,row+=1}return sum}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable,wtViewport}=this.wot,{rootDocument,rootWindow}=this.domBindings,overlayRootStyle=this.clone.wtTable.holder.parentNode.style,preventOverflow=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==rootWindow||"horizontal"===preventOverflow){let width=wtViewport.getWorkspaceWidth();wtViewport.hasVerticalScroll()&&(width-=(0,dom_element.XJ)(rootDocument)),width=Math.min(width,wtTable.wtRootElement.scrollWidth),overlayRootStyle.width=`${width}px`}else overlayRootStyle.width="";this.clone.wtTable.holder.style.width=overlayRootStyle.width;let tableHeight=(0,dom_element.DK)(this.clone.wtTable.TABLE);wtTable.hasDefinedSize()||(tableHeight=0),overlayRootStyle.height=`${tableHeight}px`}adjustRootChildrenSize(){const{holder}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,holder.style.width=holder.parentNode.style.width,holder.style.height=holder.parentNode.style.height}applyToDOM(){const total=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==total)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const styleProperty=this.isRtl()?"right":"left",{spreader}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?spreader.style[styleProperty]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:spreader.style[styleProperty]=""}scrollTo(sourceRow,bottomEdge){let newY=this.getTableParentOffset();const mainHolder=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let scrollbarCompensation=0;bottomEdge&&mainHolder.offsetHeight!==mainHolder.clientHeight&&(scrollbarCompensation=(0,dom_element.XJ)(this.domBindings.rootDocument)),bottomEdge?(newY+=this.sumCellSizes(0,sourceRow+1),newY-=this.wot.wtViewport.getViewportHeight(),newY+=1):newY+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),sourceRow),newY+=scrollbarCompensation,this.setScrollPosition(newY)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,dom_element.hY)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow}=this.domBindings,preventOverflow=this.wtSettings.getSetting("preventOverflow");let overlayOffset=0;if(this.trimmingContainer===rootWindow&&(!preventOverflow||"vertical"!==preventOverflow)){const rootHeight=this.wot.wtTable.getTotalHeight(),maxOffset=rootHeight-this.clone.wtTable.getTotalHeight(),docClientHeight=this.domBindings.rootDocument.documentElement.clientHeight;overlayOffset=Math.max(this.getTableParentOffset()-this.getScrollPosition()-docClientHeight+rootHeight,0),overlayOffset>maxOffset&&(overlayOffset=0)}return overlayOffset}adjustHeaderBordersPosition(position){const fixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),areFixedRowsBottomChanged=this.cachedFixedRowsBottom!==fixedRowsBottom,columnHeaders=this.wtSettings.getSetting("columnHeaders");let positionChanged=!1;if((areFixedRowsBottomChanged||0===fixedRowsBottom)&&columnHeaders.length>0){const masterParent=this.wot.wtTable.holder.parentNode,previousState=(0,dom_element.nB)(masterParent,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),position||0===this.wtSettings.getSetting("totalRows")?((0,dom_element.iQ)(masterParent,"innerBorderBottom"),positionChanged=!previousState):((0,dom_element.vy)(masterParent,"innerBorderBottom"),positionChanged=previousState)}return positionChanged}}const calculatedRows={getFirstRenderedRow(){const startRow=this.dataAccessObject.startRowRendered;return null===startRow?-1:startRow},getFirstVisibleRow(){const startRow=this.dataAccessObject.startRowVisible;return null===startRow?-1:startRow},getFirstPartiallyVisibleRow(){const startRow=this.dataAccessObject.startRowPartiallyVisible;return null===startRow?-1:startRow},getLastRenderedRow(){const endRow=this.dataAccessObject.endRowRendered;return null===endRow?-1:endRow},getLastVisibleRow(){const endRow=this.dataAccessObject.endRowVisible;return null===endRow?-1:endRow},getLastPartiallyVisibleRow(){const endRow=this.dataAccessObject.endRowPartiallyVisible;return null===endRow?-1:endRow},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,object.LH)(calculatedRows,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const mixin_calculatedRows=calculatedRows,stickyColumnsStart={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const totalColumns=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),totalColumns)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,object.LH)(stickyColumnsStart,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const mixin_stickyColumnsStart=stickyColumnsStart;class InlineStartOverlayTable extends table{constructor(dataAccessObject,facadeGetter,domBindings,wtSettings){super(dataAccessObject,facadeGetter,domBindings,wtSettings,"inline_start")}}(0,object.co)(InlineStartOverlayTable,mixin_calculatedRows),(0,object.co)(InlineStartOverlayTable,mixin_stickyColumnsStart);const inlineStart=InlineStartOverlayTable;class InlineStartOverlay extends Overlay{constructor(wotInstance,facadeGetter,wtSettings,domBindings){super(wotInstance,facadeGetter,"inline_start",wtSettings,domBindings)}createTable(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return new inlineStart(...args)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!wtTable.holder.parentNode)return!1;const{rootWindow}=this.domBindings,overlayRoot=this.clone.wtTable.holder.parentNode,preventOverflow=this.wtSettings.getSetting("preventOverflow");let overlayPosition=0;this.trimmingContainer!==rootWindow||preventOverflow&&"horizontal"===preventOverflow?(overlayPosition=this.getScrollPosition(),(0,dom_element.ZK)(overlayRoot)):(overlayPosition=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,dom_element.ON)(overlayRoot,`${overlayPosition}px`,"0px"));const positionChanged=this.adjustHeaderBordersPosition(overlayPosition);return this.adjustElementsSize(),positionChanged}setScrollPosition(pos){const{rootWindow}=this.domBindings;let result=!1;return this.isRtl()&&(pos=-pos),this.mainTableScrollableElement===rootWindow&&rootWindow.scrollX!==pos?(rootWindow.scrollTo(pos,(0,dom_element.v1)(rootWindow)),result=!0):this.mainTableScrollableElement.scrollLeft!==pos&&(this.mainTableScrollableElement.scrollLeft=pos,result=!0),result}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(from,to){const defaultColumnWidth=this.wtSettings.getSetting("defaultColumnWidth");let column=from,sum=0;for(;column<to;)sum+=this.wot.wtTable.getColumnWidth(column)||defaultColumnWidth,column+=1;return sum}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable,wtViewport}=this.wot,{rootDocument,rootWindow}=this.domBindings,overlayRootStyle=this.clone.wtTable.holder.parentNode.style,preventOverflow=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==rootWindow||"vertical"===preventOverflow){let height=wtViewport.getWorkspaceHeight();wtViewport.hasHorizontalScroll()&&(height-=(0,dom_element.XJ)(rootDocument)),height=Math.min(height,wtTable.wtRootElement.scrollHeight),overlayRootStyle.height=`${height}px`}else overlayRootStyle.height="";this.clone.wtTable.holder.style.height=overlayRootStyle.height;const tableWidth=(0,dom_element.Gq)(this.clone.wtTable.TABLE);overlayRootStyle.width=`${tableWidth}px`}adjustRootChildrenSize(){const{holder}=this.clone.wtTable,cornerStyle=getCornerStyle(this.wot),selectionCornerOffset=this.wot.selectionManager.getFocusSelection()?parseInt(cornerStyle.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,holder.style.height=holder.parentNode.style.height,holder.style.width=`${parseInt(holder.parentNode.style.width,10)+selectionCornerOffset}px`}applyToDOM(){const total=this.wtSettings.getSetting("totalColumns"),styleProperty=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[styleProperty]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==total)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[styleProperty]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(sourceCol,beyondRendered){const{wtSettings}=this,rowHeaders=wtSettings.getSetting("rowHeaders"),fixedColumnsStart=wtSettings.getSetting("fixedColumnsStart"),mainHolder=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,rowHeaderBorderCompensation=0===fixedColumnsStart&&rowHeaders.length>0&&!(0,dom_element.nB)(mainHolder.parentNode,"innerBorderInlineStart")?1:0;let newX=this.getTableParentOffset(),scrollbarCompensation=0;if(beyondRendered){this.wot.wtTable.getColumnWidth(sourceCol)>this.wot.wtViewport.getViewportWidth()&&(beyondRendered=!1)}return beyondRendered&&mainHolder.offsetWidth!==mainHolder.clientWidth&&(scrollbarCompensation=(0,dom_element.XJ)(this.domBindings.rootDocument)),beyondRendered?(newX+=this.sumCellSizes(0,sourceCol+1),newX-=this.wot.wtViewport.getViewportWidth(),newX+=rowHeaderBorderCompensation):newX+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),sourceCol),newX+=scrollbarCompensation,(0,dom_element.h$)(this.mainTableScrollableElement)===newX-rowHeaderBorderCompensation&&rowHeaderBorderCompensation>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(rowHeaderBorderCompensation),this.setScrollPosition(newX)}getTableParentOffset(){let offset=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(offset=this.wot.wtTable.holderOffset.left),offset}getScrollPosition(){return Math.abs((0,dom_element.v_)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow}=this.domBindings,preventOverflow=this.wtSettings.getSetting("preventOverflow");let overlayOffset=0;if(this.trimmingContainer===rootWindow&&(!preventOverflow||"horizontal"!==preventOverflow)){overlayOffset=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);overlayOffset>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(overlayOffset=0)}return overlayOffset}adjustHeaderBordersPosition(position){const{wtSettings}=this,masterParent=this.wot.wtTable.holder.parentNode,rowHeaders=wtSettings.getSetting("rowHeaders"),fixedColumnsStart=wtSettings.getSetting("fixedColumnsStart"),totalRows=wtSettings.getSetting("totalRows"),preventVerticalOverflow="vertical"===wtSettings.getSetting("preventOverflow");totalRows?(0,dom_element.vy)(masterParent,"emptyRows"):(0,dom_element.iQ)(masterParent,"emptyRows");let positionChanged=!1;if(!preventVerticalOverflow)if(fixedColumnsStart&&!rowHeaders.length)(0,dom_element.iQ)(masterParent,"innerBorderLeft innerBorderInlineStart");else if(!fixedColumnsStart&&rowHeaders.length){const previousState=(0,dom_element.nB)(masterParent,"innerBorderInlineStart");position?((0,dom_element.iQ)(masterParent,"innerBorderLeft innerBorderInlineStart"),positionChanged=!previousState):((0,dom_element.vy)(masterParent,"innerBorderLeft innerBorderInlineStart"),positionChanged=previousState)}return positionChanged}}class TopInlineStartCornerOverlayTable extends table{constructor(dataAccessObject,facadeGetter,domBindings,wtSettings){super(dataAccessObject,facadeGetter,domBindings,wtSettings,"top_inline_start_corner")}}(0,object.co)(TopInlineStartCornerOverlayTable,mixin_stickyRowsTop),(0,object.co)(TopInlineStartCornerOverlayTable,mixin_stickyColumnsStart);const topInlineStartCorner=TopInlineStartCornerOverlayTable;function topInlineStartCorner_defineProperty(e,r,t){return(r=function topInlineStartCorner_toPropertyKey(t){var i=function topInlineStartCorner_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class TopInlineStartCornerOverlay extends Overlay{constructor(wotInstance,facadeGetter,wtSettings,domBindings,topOverlay,inlineStartOverlay){super(wotInstance,facadeGetter,"top_inline_start_corner",wtSettings,domBindings),topInlineStartCorner_defineProperty(this,"topOverlay",void 0),topInlineStartCorner_defineProperty(this,"inlineStartOverlay",void 0),this.topOverlay=topOverlay,this.inlineStartOverlay=inlineStartOverlay}createTable(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return new topInlineStartCorner(...args)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const overlayRoot=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const left=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),top=this.topOverlay.getOverlayOffset();(0,dom_element.ON)(overlayRoot,`${left}px`,`${top}px`)}else(0,dom_element.ZK)(overlayRoot);let tableHeight=(0,dom_element.DK)(this.clone.wtTable.TABLE);const tableWidth=(0,dom_element.Gq)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(tableHeight=0),overlayRoot.style.height=`${tableHeight}px`,overlayRoot.style.width=`${tableWidth}px`,!1}}class BottomInlineStartCornerOverlayTable extends table{constructor(dataAccessObject,facadeGetter,domBindings,wtSettings){super(dataAccessObject,facadeGetter,domBindings,wtSettings,"bottom_inline_start_corner")}}(0,object.co)(BottomInlineStartCornerOverlayTable,mixin_stickyRowsBottom),(0,object.co)(BottomInlineStartCornerOverlayTable,mixin_stickyColumnsStart);const bottomInlineStartCorner=BottomInlineStartCornerOverlayTable;class BottomInlineStartCornerOverlay extends Overlay{constructor(wotInstance,facadeGetter,wtSettings,domBindings,bottomOverlay,inlineStartOverlay){super(wotInstance,facadeGetter,"bottom_inline_start_corner",wtSettings,domBindings),this.bottomOverlay=bottomOverlay,this.inlineStartOverlay=inlineStartOverlay}createTable(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return new bottomInlineStartCorner(...args)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot}=this;if(this.updateTrimmingContainer(),!wot.wtTable.holder.parentNode)return!1;const overlayRoot=this.clone.wtTable.holder.parentNode;if(overlayRoot.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const inlineStartOffset=this.inlineStartOverlay.getOverlayOffset(),bottom=this.bottomOverlay.getOverlayOffset();overlayRoot.style[this.isRtl()?"right":"left"]=`${inlineStartOffset}px`,overlayRoot.style.bottom=`${bottom}px`}else(0,dom_element.ZK)(overlayRoot),this.repositionOverlay();let tableHeight=(0,dom_element.DK)(this.clone.wtTable.TABLE);const tableWidth=(0,dom_element.Gq)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(tableHeight=0),overlayRoot.style.height=`${tableHeight}px`,overlayRoot.style.width=`${tableWidth}px`,!1}repositionOverlay(){const{wtTable,wtViewport}=this.wot,{rootDocument}=this.domBindings,cloneRoot=this.clone.wtTable.holder.parentNode;let bottomOffset=0;wtViewport.hasVerticalScroll()||(bottomOffset+=wtViewport.getWorkspaceHeight()-wtTable.getTotalHeight()),wtViewport.hasVerticalScroll()&&wtViewport.hasHorizontalScroll()&&(bottomOffset+=(0,dom_element.XJ)(rootDocument)),cloneRoot.style.bottom=`${bottomOffset}px`}}function overlays_classPrivateFieldInitSpec(e,t,a){(function overlays_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function overlays_defineProperty(e,r,t){return(r=function overlays_toPropertyKey(t){var i=function overlays_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function overlays_classPrivateFieldSet(s,a,r){return s.set(overlays_assertClassBrand(s,a),r),r}function overlays_classPrivateFieldGet(s,a){return s.get(overlays_assertClassBrand(s,a))}function overlays_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _overlays=new WeakMap,_hasRenderingStateChanged=new WeakMap,_containerDomResizeCount=new WeakMap,_containerDomResizeCountTimeout=new WeakMap;const overlays=class Overlays{constructor(wotInstance,facadeGetter,domBindings,wtSettings,eventManager,wtTable){overlays_defineProperty(this,"wot",null),overlays_classPrivateFieldInitSpec(this,_overlays,[]),overlays_defineProperty(this,"topOverlay",null),overlays_defineProperty(this,"bottomOverlay",null),overlays_defineProperty(this,"inlineStartOverlay",null),overlays_defineProperty(this,"topInlineStartCornerOverlay",null),overlays_defineProperty(this,"bottomInlineStartCornerOverlay",null),overlays_defineProperty(this,"browserLineHeight",void 0),overlays_defineProperty(this,"wtSettings",null),overlays_classPrivateFieldInitSpec(this,_hasRenderingStateChanged,!1),overlays_classPrivateFieldInitSpec(this,_containerDomResizeCount,0),overlays_classPrivateFieldInitSpec(this,_containerDomResizeCountTimeout,null),overlays_defineProperty(this,"resizeObserver",new ResizeObserver((entries=>{(0,feature.xi)((()=>{Array.isArray(entries)&&entries.length&&(overlays_classPrivateFieldSet(_containerDomResizeCount,this,overlays_classPrivateFieldGet(_containerDomResizeCount,this)+1),100===overlays_classPrivateFieldGet(_containerDomResizeCount,this)&&((0,helpers_console.R8)("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==overlays_classPrivateFieldGet(_containerDomResizeCountTimeout,this)&&clearTimeout(overlays_classPrivateFieldGet(_containerDomResizeCountTimeout,this)),overlays_classPrivateFieldSet(_containerDomResizeCountTimeout,this,setTimeout((()=>{overlays_classPrivateFieldSet(_containerDomResizeCount,this,0)}),100)),this.wtSettings.getSetting("onContainerElementResize"))}))}))),this.wot=wotInstance,this.wtSettings=wtSettings,this.domBindings=domBindings,this.facadeGetter=facadeGetter,this.wtTable=wtTable;const{rootDocument,rootWindow}=this.domBindings;this.instance=this.wot,this.eventManager=eventManager,this.scrollbarSize=(0,dom_element.XJ)(rootDocument);const isOverflowHidden="hidden"===rootWindow.getComputedStyle(wtTable.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=isOverflowHidden?wtTable.holder:(0,dom_element.K7)(wtTable.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=rootWindow.scrollX,this.lastScrollY=rootWindow.scrollY}getOverlays(){let includeMaster=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const overlays=[...overlays_classPrivateFieldGet(_overlays,this)];return includeMaster&&overlays.push(this.wtTable),overlays}initBrowserLineHeight(){const{rootWindow,rootDocument}=this.domBindings,computedStyle=rootWindow.getComputedStyle(rootDocument.body),lineHeight=parseInt(computedStyle.lineHeight,10),lineHeightFalback=1.2*parseInt(computedStyle.fontSize,10);this.browserLineHeight=lineHeight||lineHeightFalback}initOverlays(){const args=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TopOverlay(...args),this.bottomOverlay=new BottomOverlay(...args),this.inlineStartOverlay=new InlineStartOverlay(...args),this.topInlineStartCornerOverlay=new TopInlineStartCornerOverlay(...args,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BottomInlineStartCornerOverlay(...args,this.bottomOverlay,this.inlineStartOverlay),overlays_classPrivateFieldSet(_overlays,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){overlays_classPrivateFieldSet(_hasRenderingStateChanged,this,overlays_classPrivateFieldGet(_overlays,this).reduce(((acc,overlay)=>overlay.hasRenderingStateChanged()||acc),!1)),overlays_classPrivateFieldGet(_overlays,this).forEach((overlay=>overlay.updateStateOfRendering("before")))}afterDraw(){this.syncScrollWithMaster(),overlays_classPrivateFieldGet(_overlays,this).forEach((overlay=>{const hasRenderingStateChanged=overlay.hasRenderingStateChanged();overlay.updateStateOfRendering("after"),hasRenderingStateChanged&&!overlay.needFullRender&&overlay.reset()}))}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument,rootWindow}=this.domBindings,{mainTableScrollableElement:topOverlayScrollableElement}=this.topOverlay,{mainTableScrollableElement:inlineStartOverlayScrollableElement}=this.inlineStartOverlay;this.eventManager.addEventListener(rootDocument.documentElement,"keydown",(event=>this.onKeyDown(event))),this.eventManager.addEventListener(rootDocument.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(rootDocument,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(topOverlayScrollableElement,"scroll",(event=>this.onTableScroll(event)),{passive:!0}),topOverlayScrollableElement!==inlineStartOverlayScrollableElement&&this.eventManager.addEventListener(inlineStartOverlayScrollableElement,"scroll",(event=>this.onTableScroll(event)),{passive:!0});const isHighPixelRatio=rootWindow.devicePixelRatio&&rootWindow.devicePixelRatio>1,isScrollOnWindow=this.scrollableElement===rootWindow,preventWheel=this.wtSettings.getSetting("preventWheel"),wheelEventOptions={passive:isScrollOnWindow};(preventWheel||isHighPixelRatio||!(0,browser.H8)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(event=>this.onCloneWheel(event,preventWheel)),wheelEventOptions);let resizeTimeout;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((overlay=>{this.eventManager.addEventListener(overlay.clone.wtTable.holder,"wheel",(event=>this.onCloneWheel(event,preventWheel)),wheelEventOptions)})),this.eventManager.addEventListener(rootWindow,"resize",(()=>{(0,feature.xi)((()=>{clearTimeout(resizeTimeout),this.wtSettings.getSetting("onWindowResize"),resizeTimeout=setTimeout((()=>{overlays_classPrivateFieldSet(_containerDomResizeCount,this,0)}),200)}))})),isScrollOnWindow||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(event){const rootWindow=this.domBindings.rootWindow,masterHorizontal=this.inlineStartOverlay.mainTableScrollableElement,masterVertical=this.topOverlay.mainTableScrollableElement,target=event.target;this.keyPressed&&(masterVertical!==rootWindow&&target!==rootWindow&&!event.target.contains(masterVertical)||masterHorizontal!==rootWindow&&target!==rootWindow&&!event.target.contains(masterHorizontal))||this.syncScrollPositions(event)}onCloneWheel(event,preventDefault){const{rootWindow}=this.domBindings,masterHorizontal=this.inlineStartOverlay.mainTableScrollableElement,masterVertical=this.topOverlay.mainTableScrollableElement,target=event.target,shouldNotWheelVertically=masterVertical!==rootWindow&&target!==rootWindow&&!target.contains(masterVertical),shouldNotWheelHorizontally=masterHorizontal!==rootWindow&&target!==rootWindow&&!target.contains(masterHorizontal);if(this.keyPressed&&(shouldNotWheelVertically||shouldNotWheelHorizontally)||this.scrollableElement===rootWindow)return;const isScrollPossible=this.translateMouseWheelToScroll(event);(preventDefault||this.scrollableElement!==rootWindow&&isScrollPossible)&&event.preventDefault()}onKeyDown(event){this.keyPressed=(0,unicode.m0)(event.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(event){let deltaY=isNaN(event.deltaY)?-1*event.wheelDeltaY:event.deltaY,deltaX=isNaN(event.deltaX)?-1*event.wheelDeltaX:event.deltaX;1===event.deltaMode&&(deltaX+=deltaX*this.browserLineHeight,deltaY+=deltaY*this.browserLineHeight);const isScrollVerticallyPossible=this.scrollVertically(deltaY),isScrollHorizontallyPossible=this.scrollHorizontally(deltaX);return isScrollVerticallyPossible||isScrollHorizontallyPossible}scrollVertically(delta){const previousScroll=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=delta,previousScroll!==this.scrollableElement.scrollTop}scrollHorizontally(delta){const previousScroll=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=delta,previousScroll!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow}=this.domBindings,topHolder=this.topOverlay.clone.wtTable.holder,leftHolder=this.inlineStartOverlay.clone.wtTable.holder,[scrollLeft,scrollTop]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=topHolder.scrollLeft!==scrollLeft||this.lastScrollX!==rootWindow.scrollX,this.verticalScrolling=leftHolder.scrollTop!==scrollTop||this.lastScrollY!==rootWindow.scrollY,this.lastScrollX=rootWindow.scrollX,this.lastScrollY=rootWindow.scrollY,this.horizontalScrolling){topHolder.scrollLeft=scrollLeft;const bottomHolder=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;bottomHolder&&(bottomHolder.scrollLeft=scrollLeft)}this.verticalScrolling&&(leftHolder.scrollTop=scrollTop),this.refreshAll()}syncScrollWithMaster(){if(!overlays_classPrivateFieldGet(_hasRenderingStateChanged,this))return;const master=this.topOverlay.mainTableScrollableElement,{scrollLeft,scrollTop}=master;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=scrollLeft),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=scrollLeft),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=scrollTop),overlays_classPrivateFieldSet(_hasRenderingStateChanged,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable}=this,{rootWindow}=this.domBindings;"hidden"===rootWindow.getComputedStyle(wtTable.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=wtTable.holder:this.scrollableElement=(0,dom_element.K7)(wtTable.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let fastDraw=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(fastDraw),this.inlineStartOverlay.refresh(fastDraw),this.topOverlay.refresh(fastDraw),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(fastDraw),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(fastDraw)}updateLastSpreaderSize(){const spreader=this.wtTable.spreader,width=spreader.clientWidth,height=spreader.clientHeight,needsUpdating=width!==this.spreaderLastSize.width||height!==this.spreaderLastSize.height;return needsUpdating&&(this.spreaderLastSize.width=width,this.spreaderLastSize.height=height),needsUpdating}adjustElementsSize(){const{wtViewport}=this.wot,{wtTable}=this,{rootWindow}=this.domBindings,isWindowScrolled=this.scrollableElement===rootWindow,totalColumns=this.wtSettings.getSetting("totalColumns"),totalRows=this.wtSettings.getSetting("totalRows"),headerRowSize=wtViewport.getRowHeaderWidth(),proposedHiderHeight=wtViewport.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,totalRows)+1,proposedHiderWidth=headerRowSize+this.inlineStartOverlay.sumCellSizes(0,totalColumns),hiderStyle=wtTable.hider.style,columnHeaderBorderCompensation=(()=>!isWindowScrolled&&this.scrollableElement.scrollTop>Math.max(0,proposedHiderHeight-wtTable.holder.clientHeight))()?1:0,rowHeaderBorderCompensation=(()=>!isWindowScrolled&&this.scrollableElement.scrollLeft>Math.max(0,proposedHiderWidth-wtTable.holder.clientWidth))()?1:0;hiderStyle.width=`${proposedHiderWidth+rowHeaderBorderCompensation}px`,hiderStyle.height=`${proposedHiderHeight+columnHeaderBorderCompensation}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(heightDelta){const{wtTable}=this;wtTable.hider.style.height=`${parseInt(wtTable.hider.style.height,10)+heightDelta}px`}expandHiderHorizontallyBy(widthDelta){const{wtTable}=this;wtTable.hider.style.width=`${parseInt(wtTable.hider.style.width,10)+widthDelta}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(element){if(!element)return null;const overlays=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let result=null;return(0,array.z0)(overlays,(overlay=>{overlay&&overlay.clone&&overlay.clone.wtTable.TABLE.contains(element)&&(result=overlay.clone)})),result}syncOverlayTableClassNames(){const masterTable=this.wtTable.TABLE,overlays=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,array.z0)(overlays,(elem=>{elem&&(elem.clone.wtTable.TABLE.className=masterTable.className)}))}};function settings_defineProperty(e,r,t){return(r=function settings_toPropertyKey(t){var i=function settings_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class Settings{constructor(settings){settings_defineProperty(this,"settings",{}),settings_defineProperty(this,"defaults",Object.freeze(this.getDefaults())),(0,object.v4)(this.defaults,((value,key)=>{if(void 0!==settings[key])this.settings[key]=settings[key];else{if(void 0===value)throw new Error(`A required setting "${key}" was not provided`);this.settings[key]=value}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(row,column,TD)=>{const cellData=this.getSetting("data",row,column);(0,dom_element.c6)(TD,null==cellData?"":cellData)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:column=>column,onBeforeViewportScrollVertically:row=>row,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:sourceRow=>sourceRow,onBeforeHighlightingColumnHeader:sourceCol=>sourceCol,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(settings,value){return void 0===value?(0,object.v4)(settings,((settingValue,key)=>{this.settings[key]=settingValue})):this.settings[settings]=value,this}getSetting(key,param1,param2,param3,param4){return"function"==typeof this.settings[key]?this.settings[key](param1,param2,param3,param4):void 0!==param1&&Array.isArray(this.settings[key])?this.settings[key][param1]:this.settings[key]}getSettingPure(key){return this.settings[key]}has(key){return!!this.settings[key]}}class MasterTable extends table{constructor(dataAccessObject,facadeGetter,domBindings,wtSettings){super(dataAccessObject,facadeGetter,domBindings,wtSettings,"master")}alignOverlaysWithTrimmingContainer(){const trimmingElement=(0,dom_element.fX)(this.wtRootElement),{rootWindow}=this.domBindings;if(trimmingElement===rootWindow){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const trimmingElementParent=trimmingElement.parentElement,trimmingHeight=(0,dom_element.gd)(trimmingElement,"height",rootWindow),trimmingOverflow=(0,dom_element.gd)(trimmingElement,"overflow",rootWindow),holderStyle=this.holder.style,{scrollWidth,scrollHeight}=trimmingElement;let width=trimmingElement.offsetWidth,height=trimmingElement.offsetHeight;if(trimmingElementParent&&["auto","hidden","scroll"].includes(trimmingOverflow)){const cloneNode=trimmingElement.cloneNode(!1);cloneNode.style.overflow="auto",cloneNode.style.position="absolute",trimmingElement.nextElementSibling?trimmingElementParent.insertBefore(cloneNode,trimmingElement.nextElementSibling):trimmingElementParent.appendChild(cloneNode);const cloneHeight=parseInt(rootWindow.getComputedStyle(cloneNode).height,10);trimmingElementParent.removeChild(cloneNode),0===cloneHeight&&(height=0)}height=Math.min(height,scrollHeight),holderStyle.height="auto"===trimmingHeight?"auto":`${height}px`,width=Math.min(width,scrollWidth),holderStyle.width=`${width}px`,holderStyle.overflow="",this.hasTableHeight="auto"===holderStyle.height||height>0,this.hasTableWidth=width>0}this.isTableVisible=(0,dom_element.zN)(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings}=this,{wtViewport}=this.dataAccessObject,columnHeadersCount=wtSettings.getSetting("columnHeaders").length;if(columnHeadersCount&&!wtViewport.hasOversizedColumnHeadersMarked.master){const rowHeaderCount=wtSettings.getSetting("rowHeaders").length,columnCount=this.getRenderedColumnsCount();for(let i=0;i<columnHeadersCount;i++)for(let renderedColumnIndex=-1*rowHeaderCount;renderedColumnIndex<columnCount;renderedColumnIndex++)this.markIfOversizedColumnHeader(renderedColumnIndex);wtViewport.hasOversizedColumnHeadersMarked.master=!0}}}(0,object.co)(MasterTable,mixin_calculatedRows),(0,object.co)(MasterTable,mixin_calculatedColumns);const master=MasterTable;function renderedAllRows_defineProperty(e,r,t){return(r=function renderedAllRows_toPropertyKey(t){var i=function renderedAllRows_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RenderedAllRowsCalculationType{constructor(){renderedAllRows_defineProperty(this,"count",0),renderedAllRows_defineProperty(this,"startRow",0),renderedAllRows_defineProperty(this,"endRow",0),renderedAllRows_defineProperty(this,"startPosition",0),renderedAllRows_defineProperty(this,"isVisibleInTrimmingContainer",!0)}initialize(_ref){let{totalRows}=_ref;this.count=totalRows,this.endRow=this.count-1}process(){}finalize(){}}__webpack_require__("./node_modules/core-js/modules/es.array.at.js"),__webpack_require__("./node_modules/core-js/modules/es.string.at-alternative.js");function partiallyVisibleRows_defineProperty(e,r,t){return(r=function partiallyVisibleRows_toPropertyKey(t){var i=function partiallyVisibleRows_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class PartiallyVisibleRowsCalculationType{constructor(){partiallyVisibleRows_defineProperty(this,"count",0),partiallyVisibleRows_defineProperty(this,"startRow",null),partiallyVisibleRows_defineProperty(this,"endRow",null),partiallyVisibleRows_defineProperty(this,"startPosition",null),partiallyVisibleRows_defineProperty(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(row,viewportCalculator){const{totalCalculatedHeight,zeroBasedScrollOffset,innerViewportHeight}=viewportCalculator;totalCalculatedHeight<=zeroBasedScrollOffset&&(this.startRow=row),totalCalculatedHeight>=zeroBasedScrollOffset&&totalCalculatedHeight<=innerViewportHeight&&null===this.startRow&&(this.startRow=row),this.endRow=row}finalize(viewportCalculator){var _startPositions$this$;const{scrollOffset,viewportHeight,horizontalScrollbarHeight,totalRows,needReverse,startPositions,rowHeight}=viewportCalculator;if(this.endRow===totalRows-1&&needReverse)for(this.startRow=this.endRow;this.startRow>0;){const calculatedViewportHeight=startPositions[this.endRow]+rowHeight-startPositions[this.startRow-1];if(this.startRow-=1,calculatedViewportHeight>=viewportHeight-horizontalScrollbarHeight)break}this.startPosition=null!==(_startPositions$this$=startPositions[this.startRow])&&void 0!==_startPositions$this$?_startPositions$this$:null;scrollOffset+viewportHeight-horizontalScrollbarHeight<0||scrollOffset>startPositions.at(-1)+rowHeight?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,totalRows<this.endRow&&(this.endRow=totalRows-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function renderedRows_defineProperty(e,r,t){return(r=function renderedRows_toPropertyKey(t){var i=function renderedRows_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RenderedRowsCalculationType extends PartiallyVisibleRowsCalculationType{constructor(){super(...arguments),renderedRows_defineProperty(this,"rowStartOffset",0),renderedRows_defineProperty(this,"rowEndOffset",0)}finalize(viewportCalculator){var _startPositions$this$;super.finalize(viewportCalculator);const{overrideFn,totalRows,startPositions}=viewportCalculator;if(null!==this.startRow&&"function"==typeof overrideFn){const startRow=this.startRow,endRow=this.endRow;overrideFn(this),this.rowStartOffset=startRow-this.startRow,this.rowEndOffset=this.endRow-endRow}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(_startPositions$this$=startPositions[this.startRow])&&void 0!==_startPositions$this$?_startPositions$this$:null,totalRows<this.endRow&&(this.endRow=totalRows-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function fullyVisibleRows_defineProperty(e,r,t){return(r=function fullyVisibleRows_toPropertyKey(t){var i=function fullyVisibleRows_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class FullyVisibleRowsCalculationType{constructor(){fullyVisibleRows_defineProperty(this,"count",0),fullyVisibleRows_defineProperty(this,"startRow",null),fullyVisibleRows_defineProperty(this,"endRow",null),fullyVisibleRows_defineProperty(this,"startPosition",null),fullyVisibleRows_defineProperty(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(row,viewportCalculator){const{totalCalculatedHeight,zeroBasedScrollOffset,innerViewportHeight,rowHeight}=viewportCalculator;totalCalculatedHeight>=zeroBasedScrollOffset&&totalCalculatedHeight+rowHeight<=innerViewportHeight&&(null===this.startRow&&(this.startRow=row),this.endRow=row)}finalize(viewportCalculator){var _startPositions$this$;const{scrollOffset,viewportHeight,horizontalScrollbarHeight,totalRows,needReverse,startPositions,rowHeight}=viewportCalculator;if(this.endRow===totalRows-1&&needReverse)for(this.startRow=this.endRow;this.startRow>0;){const calculatedViewportHeight=startPositions[this.endRow]+rowHeight-startPositions[this.startRow-1];if(calculatedViewportHeight<=viewportHeight-horizontalScrollbarHeight&&(this.startRow-=1),calculatedViewportHeight>=viewportHeight-horizontalScrollbarHeight)break}this.startPosition=null!==(_startPositions$this$=startPositions[this.startRow])&&void 0!==_startPositions$this$?_startPositions$this$:null;scrollOffset+viewportHeight-horizontalScrollbarHeight<(null===this.startRow?0:viewportCalculator.getRowHeight(this.startRow))||scrollOffset>startPositions.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,totalRows<this.endRow&&(this.endRow=totalRows-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function renderedAllColumns_defineProperty(e,r,t){return(r=function renderedAllColumns_toPropertyKey(t){var i=function renderedAllColumns_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RenderedAllColumnsCalculationType{constructor(){renderedAllColumns_defineProperty(this,"count",0),renderedAllColumns_defineProperty(this,"startColumn",0),renderedAllColumns_defineProperty(this,"endColumn",0),renderedAllColumns_defineProperty(this,"startPosition",0),renderedAllColumns_defineProperty(this,"isVisibleInTrimmingContainer",!0)}initialize(_ref){let{totalColumns}=_ref;this.count=totalColumns,this.endColumn=this.count-1}process(){}finalize(){}}function partiallyVisibleColumns_defineProperty(e,r,t){return(r=function partiallyVisibleColumns_toPropertyKey(t){var i=function partiallyVisibleColumns_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class PartiallyVisibleColumnsCalculationType{constructor(){partiallyVisibleColumns_defineProperty(this,"count",0),partiallyVisibleColumns_defineProperty(this,"startColumn",null),partiallyVisibleColumns_defineProperty(this,"endColumn",null),partiallyVisibleColumns_defineProperty(this,"startPosition",null),partiallyVisibleColumns_defineProperty(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(column,viewportCalculator){const{totalCalculatedWidth,zeroBasedScrollOffset,viewportWidth}=viewportCalculator;totalCalculatedWidth<=zeroBasedScrollOffset&&(this.startColumn=column);totalCalculatedWidth>=zeroBasedScrollOffset&&totalCalculatedWidth<=zeroBasedScrollOffset+(zeroBasedScrollOffset>0?viewportWidth+1:viewportWidth)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=column)),this.endColumn=column}finalize(viewportCalculator){var _startPositions$this$;const{scrollOffset,viewportWidth,inlineStartOffset,zeroBasedScrollOffset,totalColumns,needReverse,startPositions,columnWidth}=viewportCalculator;if(this.endColumn===totalColumns-1&&needReverse)for(this.startColumn=this.endColumn;this.startColumn>0;){const calculatedViewportWidth=startPositions[this.endColumn]+columnWidth-startPositions[this.startColumn-1];if(this.startColumn-=1,calculatedViewportWidth>viewportWidth)break}this.startPosition=null!==(_startPositions$this$=startPositions[this.startColumn])&&void 0!==_startPositions$this$?_startPositions$this$:null;scrollOffset+viewportWidth-(zeroBasedScrollOffset>0?viewportWidth+1:viewportWidth)<-1*inlineStartOffset||scrollOffset>startPositions.at(-1)+columnWidth||-1*scrollOffset-viewportWidth>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,totalColumns<this.endColumn&&(this.endColumn=totalColumns-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function renderedColumns_defineProperty(e,r,t){return(r=function renderedColumns_toPropertyKey(t){var i=function renderedColumns_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RenderedColumnsCalculationType extends PartiallyVisibleColumnsCalculationType{constructor(){super(...arguments),renderedColumns_defineProperty(this,"columnStartOffset",0),renderedColumns_defineProperty(this,"columnEndOffset",0)}finalize(viewportCalculator){var _startPositions$this$;super.finalize(viewportCalculator);const{overrideFn,totalColumns,startPositions}=viewportCalculator;if(null!==this.startColumn&&"function"==typeof overrideFn){const startColumn=this.startColumn,endColumn=this.endColumn;overrideFn(this),this.columnStartOffset=startColumn-this.startColumn,this.columnEndOffset=this.endColumn-endColumn}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(_startPositions$this$=startPositions[this.startColumn])&&void 0!==_startPositions$this$?_startPositions$this$:null,totalColumns<this.endColumn&&(this.endColumn=totalColumns-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function fullyVisibleColumns_defineProperty(e,r,t){return(r=function fullyVisibleColumns_toPropertyKey(t){var i=function fullyVisibleColumns_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class FullyVisibleColumnsCalculationType{constructor(){fullyVisibleColumns_defineProperty(this,"count",0),fullyVisibleColumns_defineProperty(this,"startColumn",null),fullyVisibleColumns_defineProperty(this,"endColumn",null),fullyVisibleColumns_defineProperty(this,"startPosition",null),fullyVisibleColumns_defineProperty(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(column,viewportCalculator){const{totalCalculatedWidth,zeroBasedScrollOffset,viewportWidth,columnWidth}=viewportCalculator;totalCalculatedWidth>=zeroBasedScrollOffset&&totalCalculatedWidth+columnWidth<=zeroBasedScrollOffset+(zeroBasedScrollOffset>0?viewportWidth+1:viewportWidth)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=column),this.endColumn=column)}finalize(viewportCalculator){var _startPositions$this$;const{scrollOffset,viewportWidth,inlineStartOffset,zeroBasedScrollOffset,totalColumns,needReverse,startPositions,columnWidth}=viewportCalculator;if(this.endColumn===totalColumns-1&&needReverse)for(this.startColumn=this.endColumn;this.startColumn>0;){const calculatedViewportHeight=startPositions[this.endColumn]+columnWidth-startPositions[this.startColumn-1];if(calculatedViewportHeight<=viewportWidth&&(this.startColumn-=1),calculatedViewportHeight>=viewportWidth)break}this.startPosition=null!==(_startPositions$this$=startPositions[this.startColumn])&&void 0!==_startPositions$this$?_startPositions$this$:null;const mostRightScrollOffset=scrollOffset+viewportWidth-(zeroBasedScrollOffset>0?viewportWidth+1:viewportWidth),inlineStartColumnOffset=null===this.startColumn?0:viewportCalculator.getColumnWidth(this.startColumn);mostRightScrollOffset<-1*inlineStartOffset||scrollOffset>startPositions.at(-1)||-1*scrollOffset-viewportWidth>-1*inlineStartColumnOffset?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,totalColumns<this.endColumn&&(this.endColumn=totalColumns-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}var viewportBase=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/calculator/viewportBase.mjs");function viewportRows_defineProperty(e,r,t){return(r=function viewportRows_toPropertyKey(t){var i=function viewportRows_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ViewportRowsCalculator extends viewportBase.C{constructor(_ref){let{calculationTypes,viewportHeight,scrollOffset,totalRows,defaultRowHeight,rowHeightFn,overrideFn,horizontalScrollbarHeight}=_ref;super(calculationTypes),viewportRows_defineProperty(this,"viewportHeight",0),viewportRows_defineProperty(this,"scrollOffset",0),viewportRows_defineProperty(this,"zeroBasedScrollOffset",0),viewportRows_defineProperty(this,"totalRows",0),viewportRows_defineProperty(this,"rowHeightFn",null),viewportRows_defineProperty(this,"rowHeight",0),viewportRows_defineProperty(this,"overrideFn",null),viewportRows_defineProperty(this,"horizontalScrollbarHeight",0),viewportRows_defineProperty(this,"innerViewportHeight",0),viewportRows_defineProperty(this,"totalCalculatedHeight",0),viewportRows_defineProperty(this,"startPositions",[]),viewportRows_defineProperty(this,"needReverse",!0),this.defaultHeight=defaultRowHeight,this.viewportHeight=viewportHeight,this.scrollOffset=scrollOffset,this.zeroBasedScrollOffset=Math.max(scrollOffset,0),this.totalRows=totalRows,this.rowHeightFn=rowHeightFn,this.overrideFn=overrideFn,this.horizontalScrollbarHeight=null!=horizontalScrollbarHeight?horizontalScrollbarHeight:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let row=0;row<this.totalRows;row++)if(this.rowHeight=this.getRowHeight(row),this._process(row,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(row){const rowHeight=this.rowHeightFn(row);return isNaN(rowHeight)?this.defaultHeight:rowHeight}}var viewportColumns=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/calculator/viewportColumns.mjs");const viewport=class Viewport{constructor(dataAccessObject,domBindings,wtSettings,eventManager,wtTable){this.dataAccessObject=dataAccessObject,this.wot=dataAccessObject.wot,this.instance=this.wot,this.domBindings=domBindings,this.wtSettings=wtSettings,this.wtTable=wtTable,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new RenderedAllRowsCalculationType:new RenderedRowsCalculationType],["fullyVisible",()=>new FullyVisibleRowsCalculationType],["partiallyVisible",()=>new PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RenderedAllColumnsCalculationType:new RenderedColumnsCalculationType],["fullyVisible",()=>new FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new PartiallyVisibleColumnsCalculationType]]),this.eventManager=eventManager,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const currentDocument=this.domBindings.rootDocument,trimmingContainer=this.dataAccessObject.topOverlayTrimmingContainer;let height=0;if(trimmingContainer===this.domBindings.rootWindow)height=currentDocument.documentElement.clientHeight;else{height=(0,dom_element.DK)(trimmingContainer)>0&&trimmingContainer.clientHeight>0?trimmingContainer.clientHeight:1/0}return height}getViewportHeight(){let containerHeight=this.getWorkspaceHeight();if(containerHeight===1/0)return containerHeight;const columnHeaderHeight=this.getColumnHeaderHeight();return columnHeaderHeight>0&&(containerHeight-=columnHeaderHeight),containerHeight}getWorkspaceWidth(){const{rootDocument,rootWindow}=this.domBindings,trimmingContainer=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let width;if(trimmingContainer===rootWindow){const totalColumns=this.wtSettings.getSetting("totalColumns");width=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,totalColumns)>width&&(width=rootDocument.documentElement.clientWidth)}else width=trimmingContainer.clientWidth;return width}getViewportWidth(){const containerWidth=this.getWorkspaceWidth();if(containerWidth===1/0)return containerWidth;const rowHeaderWidth=this.getRowHeaderWidth();return rowHeaderWidth>0?containerWidth-rowHeaderWidth:containerWidth}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const documentElement=this.domBindings.rootDocument.documentElement;return documentElement.scrollHeight>documentElement.clientHeight}const{holder,hider}=this.wtTable,holderHeight=holder.clientHeight,hiderOffsetHeight=hider.offsetHeight;return holderHeight<hiderOffsetHeight||hiderOffsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const documentElement=this.domBindings.rootDocument.documentElement;return documentElement.scrollWidth>documentElement.clientWidth}const{holder,hider}=this.wtTable,holderWidth=holder.clientWidth,hiderOffsetWidth=hider.offsetWidth;return holderWidth<hiderOffsetWidth||hiderOffsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(from,length){let sum=0,column=from;for(;column<length;)sum+=this.wtTable.getColumnWidth(column),column+=1;return sum}getWorkspaceOffset(){return(0,dom_element.cY)(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,dom_element.DK)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const rowHeadersWidthSetting=this.wtSettings.getSetting("rowHeaderWidth"),rowHeaders=this.wtSettings.getSetting("rowHeaders");if(rowHeadersWidthSetting){this.rowHeaderWidth=0;for(let i=0,len=rowHeaders.length;i<len;i++)this.rowHeaderWidth+=rowHeadersWidthSetting[i]||rowHeadersWidthSetting}if(isNaN(this.rowHeaderWidth))if(rowHeaders.length){let TH=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,len=rowHeaders.length;i<len;i++)TH?(this.rowHeaderWidth+=(0,dom_element.Gq)(TH),TH=TH.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let calculatorTypes=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings,wtTable}=this;let scrollbarHeight,fixedRowsHeight,height=this.getViewportHeight();this.rowHeaderWidth=NaN;let pos=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const fixedRowsTop=wtSettings.getSetting("fixedRowsTop"),fixedRowsBottom=wtSettings.getSetting("fixedRowsBottom"),totalRows=wtSettings.getSetting("totalRows");return fixedRowsTop&&pos>=0&&(fixedRowsHeight=this.dataAccessObject.topOverlay.sumCellSizes(0,fixedRowsTop),pos+=fixedRowsHeight,height-=fixedRowsHeight),fixedRowsBottom&&this.dataAccessObject.bottomOverlay.clone&&(fixedRowsHeight=this.dataAccessObject.bottomOverlay.sumCellSizes(totalRows-fixedRowsBottom,totalRows),height-=fixedRowsHeight),scrollbarHeight=wtTable.holder.clientHeight===wtTable.holder.offsetHeight?0:(0,dom_element.XJ)(this.domBindings.rootDocument),new ViewportRowsCalculator({calculationTypes:calculatorTypes.map((type=>[type,this.rowsCalculatorTypes.get(type)()])),viewportHeight:height,scrollOffset:pos,totalRows:wtSettings.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:sourceRow=>wtTable.getRowHeight(sourceRow),overrideFn:wtSettings.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:scrollbarHeight})}createColumnsCalculator(){let calculatorTypes=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings,wtTable}=this;let width=this.getViewportWidth(),pos=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const fixedColumnsStart=wtSettings.getSetting("fixedColumnsStart");if(fixedColumnsStart&&pos>=0){const fixedColumnsWidth=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,fixedColumnsStart);pos+=fixedColumnsWidth,width-=fixedColumnsWidth}return wtTable.holder.clientWidth!==wtTable.holder.offsetWidth&&(width-=(0,dom_element.XJ)(this.domBindings.rootDocument)),new viewportColumns.U({calculationTypes:calculatorTypes.map((type=>[type,this.columnsCalculatorTypes.get(type)()])),viewportWidth:width,scrollOffset:pos,totalColumns:wtSettings.getSetting("totalColumns"),columnWidthFn:sourceCol=>wtTable.getColumnWidth(sourceCol),overrideFn:wtSettings.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let fastDraw=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings}=this,rowsCalculator=this.createRowsCalculator(),columnsCalculator=this.createColumnsCalculator();if(fastDraw&&!wtSettings.getSetting("renderAllRows")){const proposedRowsVisibleCalculator=rowsCalculator.getResultsFor("fullyVisible");fastDraw=this.areAllProposedVisibleRowsAlreadyRendered(proposedRowsVisibleCalculator)}if(fastDraw&&!wtSettings.getSetting("renderAllColumns")){const proposedColumnsVisibleCalculator=columnsCalculator.getResultsFor("fullyVisible");fastDraw=this.areAllProposedVisibleColumnsAlreadyRendered(proposedColumnsVisibleCalculator)}return fastDraw||(this.rowsRenderCalculator=rowsCalculator.getResultsFor("rendered"),this.columnsRenderCalculator=columnsCalculator.getResultsFor("rendered")),this.rowsVisibleCalculator=rowsCalculator.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=columnsCalculator.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=rowsCalculator.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=columnsCalculator.getResultsFor("partiallyVisible"),fastDraw}createVisibleCalculators(){const rowsCalculator=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),columnsCalculator=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=rowsCalculator.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=columnsCalculator.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=rowsCalculator.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=columnsCalculator.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(proposedRowsVisibleCalculator){if(!this.rowsVisibleCalculator)return!1;let{startRow,endRow}=proposedRowsVisibleCalculator;if(null===startRow&&null===endRow){if(!proposedRowsVisibleCalculator.isVisibleInTrimmingContainer)return!0;startRow=this.rowsPartiallyVisibleCalculator.startRow,endRow=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:renderedStartRow,endRow:renderedEndRow,rowStartOffset,rowEndOffset}=this.rowsRenderCalculator,totalRows=this.wtSettings.getSetting("totalRows")-1,renderingThreshold=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(renderingThreshold)&&renderingThreshold>0?(startRow=Math.max(0,startRow-Math.min(rowStartOffset,renderingThreshold)),endRow=Math.min(totalRows,endRow+Math.min(rowEndOffset,renderingThreshold))):"auto"===renderingThreshold&&(startRow=Math.max(0,startRow-Math.ceil(rowStartOffset/2)),endRow=Math.min(totalRows,endRow+Math.ceil(rowEndOffset/2))),!(startRow<renderedStartRow||startRow===renderedStartRow&&startRow>0)&&!(endRow>renderedEndRow||endRow===renderedEndRow&&endRow<totalRows)}areAllProposedVisibleColumnsAlreadyRendered(proposedColumnsVisibleCalculator){if(!this.columnsVisibleCalculator)return!1;let{startColumn,endColumn}=proposedColumnsVisibleCalculator;if(null===startColumn&&null===endColumn){if(!proposedColumnsVisibleCalculator.isVisibleInTrimmingContainer)return!0;startColumn=this.columnsPartiallyVisibleCalculator.startColumn,endColumn=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:renderedStartColumn,endColumn:renderedEndColumn,columnStartOffset,columnEndOffset}=this.columnsRenderCalculator,totalColumns=this.wtSettings.getSetting("totalColumns")-1,renderingThreshold=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(renderingThreshold)&&renderingThreshold>0?(startColumn=Math.max(0,startColumn-Math.min(columnStartOffset,renderingThreshold)),endColumn=Math.min(totalColumns,endColumn+Math.min(columnEndOffset,renderingThreshold))):"auto"===renderingThreshold&&(startColumn=Math.max(0,startColumn-Math.ceil(columnStartOffset/2)),endColumn=Math.min(totalColumns,endColumn+Math.ceil(columnEndOffset/2))),!(startColumn<renderedStartColumn||startColumn===renderedStartColumn&&startColumn>0)&&!(endColumn>renderedEndColumn||endColumn===renderedEndColumn&&endColumn<totalColumns)}resetHasOversizedColumnHeadersMarked(){(0,object.v4)(this.hasOversizedColumnHeadersMarked,((value,key,object)=>{object[key]=void 0}))}};__webpack_require__("./node_modules/core-js/modules/es.array.unscopables.flat.js");function scanner_classPrivateFieldInitSpec(e,t,a){scanner_checkPrivateRedeclaration(e,t),t.set(e,a)}function scanner_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function scanner_classPrivateFieldGet(s,a){return s.get(scanner_assertClassBrand(s,a))}function scanner_classPrivateFieldSet(s,a,r){return s.set(scanner_assertClassBrand(s,a),r),r}function scanner_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _selection=new WeakMap,_activeOverlaysWot=new WeakMap,_SelectionScanner_brand=new WeakSet;class SelectionScanner{constructor(){!function scanner_classPrivateMethodInitSpec(e,a){scanner_checkPrivateRedeclaration(e,a),a.add(e)}(this,_SelectionScanner_brand),scanner_classPrivateFieldInitSpec(this,_selection,void 0),scanner_classPrivateFieldInitSpec(this,_activeOverlaysWot,void 0)}setActiveOverlay(activeOverlaysWot){return scanner_classPrivateFieldSet(_activeOverlaysWot,this,activeOverlaysWot),this}setActiveSelection(selection){return scanner_classPrivateFieldSet(_selection,this,selection),this}scan(){const selectionType=scanner_classPrivateFieldGet(_selection,this).settings.selectionType,elements=new Set;return"active-header"===selectionType?(this.scanColumnsInHeadersRange((element=>elements.add(element))),this.scanRowsInHeadersRange((element=>elements.add(element)))):"area"===selectionType?this.scanCellsRange((element=>elements.add(element))):"focus"===selectionType?(this.scanColumnsInHeadersRange((element=>elements.add(element))),this.scanRowsInHeadersRange((element=>elements.add(element))),this.scanCellsRange((element=>elements.add(element)))):"fill"===selectionType?this.scanCellsRange((element=>elements.add(element))):"header"===selectionType?(this.scanColumnsInHeadersRange((element=>elements.add(element))),this.scanRowsInHeadersRange((element=>elements.add(element)))):"row"===selectionType?(this.scanRowsInHeadersRange((element=>elements.add(element))),this.scanRowsInCellsRange((element=>elements.add(element)))):"column"===selectionType&&(this.scanColumnsInHeadersRange((element=>elements.add(element))),this.scanColumnsInCellsRange((element=>elements.add(element)))),elements}scanColumnsInHeadersRange(callback){const[topRow,topColumn,bottomRow,bottomColumn]=scanner_classPrivateFieldGet(_selection,this).getCorners(),{wtTable}=scanner_classPrivateFieldGet(_activeOverlaysWot,this),renderedColumnsCount=wtTable.getRenderedColumnsCount(),columnHeadersCount=wtTable.getColumnHeadersCount();let cursor=0;for(let column=-wtTable.getRowHeadersCount();column<renderedColumnsCount;column++){const sourceColumn=wtTable.columnFilter.renderedToSource(column);if(!(sourceColumn<topColumn||sourceColumn>bottomColumn)){for(let headerLevel=-columnHeadersCount;headerLevel<0;headerLevel++){if(headerLevel<topRow||headerLevel>bottomRow)continue;const positiveBasedHeaderLevel=headerLevel+columnHeadersCount;let TH=wtTable.getColumnHeader(sourceColumn,positiveBasedHeaderLevel);const newSourceCol=scanner_classPrivateFieldGet(_activeOverlaysWot,this).getSetting("onBeforeHighlightingColumnHeader",sourceColumn,positiveBasedHeaderLevel,{selectionType:scanner_classPrivateFieldGet(_selection,this).settings.selectionType,columnCursor:cursor,selectionWidth:bottomColumn-topColumn+1});null!==newSourceCol&&(newSourceCol!==sourceColumn&&(TH=wtTable.getColumnHeader(newSourceCol,positiveBasedHeaderLevel)),callback(TH))}cursor+=1}}}scanRowsInHeadersRange(callback){const[topRow,topColumn,bottomRow,bottomColumn]=scanner_classPrivateFieldGet(_selection,this).getCorners(),{wtTable}=scanner_classPrivateFieldGet(_activeOverlaysWot,this),renderedRowsCount=wtTable.getRenderedRowsCount(),rowHeadersCount=wtTable.getRowHeadersCount();let cursor=0;for(let row=-wtTable.getColumnHeadersCount();row<renderedRowsCount;row++){const sourceRow=wtTable.rowFilter.renderedToSource(row);if(!(sourceRow<topRow||sourceRow>bottomRow)){for(let headerLevel=-rowHeadersCount;headerLevel<0;headerLevel++){if(headerLevel<topColumn||headerLevel>bottomColumn)continue;const positiveBasedHeaderLevel=headerLevel+rowHeadersCount;let TH=wtTable.getRowHeader(sourceRow,positiveBasedHeaderLevel);const newSourceRow=scanner_classPrivateFieldGet(_activeOverlaysWot,this).getSetting("onBeforeHighlightingRowHeader",sourceRow,positiveBasedHeaderLevel,{selectionType:scanner_classPrivateFieldGet(_selection,this).settings.selectionType,rowCursor:cursor,selectionHeight:bottomRow-topRow+1});null!==newSourceRow&&(newSourceRow!==sourceRow&&(TH=wtTable.getRowHeader(newSourceRow,positiveBasedHeaderLevel)),callback(TH))}cursor+=1}}}scanCellsRange(callback){const{wtTable}=scanner_classPrivateFieldGet(_activeOverlaysWot,this);scanner_assertClassBrand(_SelectionScanner_brand,this,_scanCellsRange).call(this,((sourceRow,sourceColumn)=>{const cell=wtTable.getCell(scanner_classPrivateFieldGet(_activeOverlaysWot,this).createCellCoords(sourceRow,sourceColumn)),additionalSelectionClass=scanner_classPrivateFieldGet(_activeOverlaysWot,this).getSetting("onAfterDrawSelection",sourceRow,sourceColumn,scanner_classPrivateFieldGet(_selection,this).settings.layerLevel);"string"==typeof additionalSelectionClass&&(0,dom_element.iQ)(cell,additionalSelectionClass),callback(cell)}))}scanRowsInCellsRange(callback){const[topRow,,bottomRow]=scanner_classPrivateFieldGet(_selection,this).getCorners(),{wtTable}=scanner_classPrivateFieldGet(_activeOverlaysWot,this);scanner_assertClassBrand(_SelectionScanner_brand,this,_scanViewportRange).call(this,((sourceRow,sourceColumn)=>{if(sourceRow>=topRow&&sourceRow<=bottomRow){const cell=wtTable.getCell(scanner_classPrivateFieldGet(_activeOverlaysWot,this).createCellCoords(sourceRow,sourceColumn));callback(cell)}}))}scanColumnsInCellsRange(callback){const[,topColumn,,bottomColumn]=scanner_classPrivateFieldGet(_selection,this).getCorners(),{wtTable}=scanner_classPrivateFieldGet(_activeOverlaysWot,this);scanner_assertClassBrand(_SelectionScanner_brand,this,_scanViewportRange).call(this,((sourceRow,sourceColumn)=>{if(sourceColumn>=topColumn&&sourceColumn<=bottomColumn){const cell=wtTable.getCell(scanner_classPrivateFieldGet(_activeOverlaysWot,this).createCellCoords(sourceRow,sourceColumn));callback(cell)}}))}}function _scanCellsRange(callback){let[topRow,startColumn,bottomRow,endColumn]=scanner_classPrivateFieldGet(_selection,this).getCorners();if(topRow<0&&bottomRow<0||startColumn<0&&endColumn<0)return;const{wtTable}=scanner_classPrivateFieldGet(_activeOverlaysWot,this),isMultiple=topRow!==bottomRow||startColumn!==endColumn;if(startColumn=Math.max(startColumn,0),endColumn=Math.max(endColumn,0),topRow=Math.max(topRow,0),bottomRow=Math.max(bottomRow,0),isMultiple){if(startColumn=Math.max(startColumn,wtTable.getFirstRenderedColumn()),endColumn=Math.min(endColumn,wtTable.getLastRenderedColumn()),topRow=Math.max(topRow,wtTable.getFirstRenderedRow()),bottomRow=Math.min(bottomRow,wtTable.getLastRenderedRow()),endColumn<startColumn||bottomRow<topRow)return}else{const cell=wtTable.getCell(scanner_classPrivateFieldGet(_activeOverlaysWot,this).createCellCoords(topRow,startColumn));if(!(0,dom_element.sb)(cell))return}for(let row=topRow;row<=bottomRow;row+=1)for(let column=startColumn;column<=endColumn;column+=1)callback(row,column)}function _scanViewportRange(callback){const{wtTable}=scanner_classPrivateFieldGet(_activeOverlaysWot,this),renderedRowsCount=wtTable.getRenderedRowsCount(),renderedColumnsCount=wtTable.getRenderedColumnsCount();for(let row=0;row<renderedRowsCount;row+=1){const sourceRow=wtTable.rowFilter.renderedToSource(row);for(let column=0;column<renderedColumnsCount;column+=1)callback(sourceRow,wtTable.columnFilter.renderedToSource(column))}}const border_border=class Border{constructor(wotInstance,settings){settings&&(this.eventManager=wotInstance.eventManager,this.instance=wotInstance,this.wot=wotInstance,this.settings=settings,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=getCornerStyle(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(settings),this.registerListeners())}registerListeners(){const documentBody=this.wot.rootDocument.body;this.eventManager.addEventListener(documentBody,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(documentBody,"mouseup",(()=>this.onMouseUp()));for(let c=0,len=this.main.childNodes.length;c<len;c++){const element=this.main.childNodes[c];this.eventManager.addEventListener(element,"mouseenter",(event=>this.onMouseEnter(event,this.main.childNodes[c])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(event,parentElement){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;event.preventDefault(),(0,dom_event.CA)(event);const _this=this,documentBody=this.wot.rootDocument.body,bounds=parentElement.getBoundingClientRect();parentElement.style.display="none",this.eventManager.addEventListener(documentBody,"mousemove",(function handler(handlerEvent){(function isOutside(mouseEvent){return mouseEvent.clientY<Math.floor(bounds.top)||mouseEvent.clientY>Math.ceil(bounds.top+bounds.height)||mouseEvent.clientX<Math.floor(bounds.left)||mouseEvent.clientX>Math.ceil(bounds.left+bounds.width)||void 0})(handlerEvent)&&(_this.eventManager.removeEventListener(documentBody,"mousemove",handler),parentElement.style.display="block")}))}createBorders(settings){const{rootDocument}=this.wot;this.main=rootDocument.createElement("div");const borderDivs=["top","start","bottom","end","corner"];let style=this.main.style;style.position="absolute",style.top=0,style.left=0;for(let i=0;i<5;i++){const position=borderDivs[i],div=rootDocument.createElement("div");div.className=`wtBorder ${this.settings.className||""}`,this.settings[position]&&this.settings[position].hide&&(div.className+=" hidden"),style=div.style,style.backgroundColor=this.settings[position]&&this.settings[position].color?this.settings[position].color:settings.border.color,style.height=this.settings[position]&&this.settings[position].width?`${this.settings[position].width}px`:`${settings.border.width}px`,style.width=this.settings[position]&&this.settings[position].width?`${this.settings[position].width}px`:`${settings.border.width}px`,this.main.appendChild(div)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,browser.rr)()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable}=this.wot;let bordersHolder=wtTable.bordersHolder;bordersHolder||(bordersHolder=rootDocument.createElement("div"),bordersHolder.className="htBorders",wtTable.bordersHolder=bordersHolder,wtTable.spreader.appendChild(bordersHolder)),bordersHolder.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument,stylesHandler}=this.wot,cellMobileHandleSize=stylesHandler.getCSSVariableValue("cell-mobile-handle-size"),cellMobileHandleBorderRadius=stylesHandler.getCSSVariableValue("cell-mobile-handle-border-radius"),cellMobileHandleBackgroundColor=stylesHandler.getCSSVariableValue("cell-mobile-handle-background-color"),cellMobileHandleBorderWidth=stylesHandler.getCSSVariableValue("cell-mobile-handle-border-width"),cellMobileHandleBorderColor=stylesHandler.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:rootDocument.createElement("DIV"),topHitArea:rootDocument.createElement("DIV"),bottom:rootDocument.createElement("DIV"),bottomHitArea:rootDocument.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const hitAreaStyle={position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`};(0,object.v4)(hitAreaStyle,((value,key)=>{this.selectionHandles.styles.bottomHitArea[key]=value,this.selectionHandles.styles.topHitArea[key]=value}));const handleStyle=stylesHandler.isClassicTheme()?{position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${cellMobileHandleSize}px`,width:`${cellMobileHandleSize}px`,"border-radius":`${cellMobileHandleBorderRadius}px`,background:`${cellMobileHandleBackgroundColor}`,border:`${cellMobileHandleBorderWidth}px solid ${cellMobileHandleBorderColor}`};(0,object.v4)(handleStyle,((value,key)=>{this.selectionHandles.styles.bottom[key]=value,this.selectionHandles.styles.top[key]=value})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(row,col){const areaSelection=this.wot.selectionManager.getAreaSelection();return!(!areaSelection.cellRange||row===areaSelection.cellRange.to.row&&col===areaSelection.cellRange.to.col)}updateMultipleSelectionHandlesPosition(row,col,top,left,width,height){const inlinePosProperty=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:topStyles,topHitArea:topHitAreaStyles,bottom:bottomStyles,bottomHitArea:bottomHitAreaStyles}=this.selectionHandles.styles,handleBorderSize=parseInt(topStyles.borderWidth,10),handleSize=parseInt(topStyles.width,10),hitAreaSize=parseInt(topHitAreaStyles.width,10),totalTableWidth=this.wot.wtTable.getWidth(),totalTableHeight=this.wot.wtTable.getHeight();topStyles.top=`${parseInt(top-handleSize-1,10)}px`,topStyles[inlinePosProperty]=`${parseInt(left-handleSize-1,10)}px`,topHitAreaStyles.top=`${parseInt(top-hitAreaSize/4*3,10)}px`,topHitAreaStyles[inlinePosProperty]=`${parseInt(left-hitAreaSize/4*3,10)}px`;const bottomHandlerInline=Math.min(parseInt(left+width,10),totalTableWidth-handleSize-2*handleBorderSize),bottomHandlerAreaInline=Math.min(parseInt(left+width-hitAreaSize/4,10),totalTableWidth-hitAreaSize-2*handleBorderSize);bottomStyles[inlinePosProperty]=`${bottomHandlerInline}px`,bottomHitAreaStyles[inlinePosProperty]=`${bottomHandlerAreaInline}px`;const bottomHandlerTop=Math.min(parseInt(top+height,10),totalTableHeight-handleSize-2*handleBorderSize),bottomHandlerAreaTop=Math.min(parseInt(top+height-hitAreaSize/4,10),totalTableHeight-hitAreaSize-2*handleBorderSize);bottomStyles.top=`${bottomHandlerTop}px`,bottomHitAreaStyles.top=`${bottomHandlerAreaTop}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(topStyles.display="block",topHitAreaStyles.display="block",this.isPartRange(row,col)?(bottomStyles.display="none",bottomHitAreaStyles.display="none"):(bottomStyles.display="block",bottomHitAreaStyles.display="block")):(topStyles.display="none",bottomStyles.display="none",topHitAreaStyles.display="none",bottomHitAreaStyles.display="none"),row===this.wot.wtSettings.getSetting("fixedRowsTop")||col===this.wot.wtSettings.getSetting("fixedColumnsStart")?(topStyles.zIndex="9999",topHitAreaStyles.zIndex="9999"):(topStyles.zIndex="",topHitAreaStyles.zIndex="")}appear(corners){if(this.disabled)return;let[fromRow,fromColumn,toRow,toColumn]=corners;if(fromRow<0&&toRow<0||fromColumn<0&&toColumn<0)return void this.disappear();const{wtTable,rootDocument,rootWindow}=this.wot,isMultiple=fromRow!==toRow||fromColumn!==toColumn,firstRenderedRow=wtTable.getFirstRenderedRow(),lastRenderedRow=wtTable.getLastRenderedRow(),firstRenderedColumn=wtTable.getFirstRenderedColumn(),lastRenderedColumn=wtTable.getLastRenderedColumn();let fromTD;if(isMultiple){if(fromColumn=Math.max(fromColumn,firstRenderedColumn),toColumn=Math.min(toColumn,lastRenderedColumn),fromRow=Math.max(fromRow,firstRenderedRow),toRow=Math.min(toRow,lastRenderedRow),toColumn<fromColumn||toRow<fromRow)return void this.disappear();fromTD=wtTable.getCell(this.wot.createCellCoords(fromRow,fromColumn))}else if(fromTD=wtTable.getCell(this.wot.createCellCoords(fromRow,fromColumn)),!(0,dom_element.sb)(fromTD))return void this.disappear();const toTD=isMultiple?wtTable.getCell(this.wot.createCellCoords(toRow,toColumn)):fromTD,fromOffset=(0,dom_element.cY)(fromTD),toOffset=isMultiple?(0,dom_element.cY)(toTD):fromOffset,containerOffset=(0,dom_element.cY)(wtTable.TABLE),minTop=fromOffset.top,minLeft=fromOffset.left,isRtl=this.wot.wtSettings.getSetting("rtlMode");let inlineStartPos=0,width=0;if(isRtl){const containerWidth=(0,dom_element.Gq)(wtTable.TABLE),fromWidth=(0,dom_element.Gq)(fromTD),gridRightPos=rootWindow.innerWidth-containerOffset.left-containerWidth;width=minLeft+fromWidth-toOffset.left,inlineStartPos=rootWindow.innerWidth-minLeft-fromWidth-gridRightPos-1}else width=toOffset.left+(0,dom_element.Gq)(toTD)-minLeft,inlineStartPos=minLeft-containerOffset.left-1;if(this.isEntireColumnSelected(fromRow,toRow)){const rowHeader=fromRow,modifiedValues=this.getDimensionsFromHeader("columns",fromColumn,toColumn,rowHeader,containerOffset);let fromTH=null;modifiedValues&&([fromTH,inlineStartPos,width]=modifiedValues),fromTH&&(fromTD=fromTH)}let top=minTop-containerOffset.top-1,height=toOffset.top+(0,dom_element.DK)(toTD)-minTop;if(this.isEntireRowSelected(fromColumn,toColumn)){const columnHeader=fromColumn,modifiedValues=this.getDimensionsFromHeader("rows",fromRow,toRow,columnHeader,containerOffset);let fromTH=null;modifiedValues&&([fromTH,top,height]=modifiedValues),fromTH&&(fromTD=fromTH)}const style=rootWindow.getComputedStyle(fromTD);parseInt(style.borderTopWidth,10)>0&&(top+=1,height=height>0?height-1:0),parseInt(style[isRtl?"borderRightWidth":"borderLeftWidth"],10)>0&&(inlineStartPos+=1,width=width>0?width-1:0);const inlinePosProperty=isRtl?"right":"left";this.topStyle.top=`${top}px`,this.topStyle[inlinePosProperty]=`${inlineStartPos}px`,this.topStyle.width=`${width}px`,this.topStyle.display="block",this.startStyle.top=`${top}px`,this.startStyle[inlinePosProperty]=`${inlineStartPos}px`,this.startStyle.height=`${height}px`,this.startStyle.display="block";const delta=Math.floor(this.settings.border.width/2);this.bottomStyle.top=top+height-delta+"px",this.bottomStyle[inlinePosProperty]=`${inlineStartPos}px`,this.bottomStyle.width=`${width}px`,this.bottomStyle.display="block",this.endStyle.top=`${top}px`,this.endStyle[inlinePosProperty]=inlineStartPos+width-delta+"px",this.endStyle.height=`${height+1}px`,this.endStyle.display="block";let cornerVisibleSetting=this.settings.border.cornerVisible;cornerVisibleSetting="function"==typeof cornerVisibleSetting?cornerVisibleSetting(this.settings.layerLevel):cornerVisibleSetting;const hookResult=this.wot.getSetting("onModifyGetCellCoords",toRow,toColumn,!1,"render");let[checkRow,checkCol]=[toRow,toColumn];if(hookResult&&Array.isArray(hookResult)&&([,,checkRow,checkCol]=hookResult),(0,browser.rr)()||!cornerVisibleSetting||this.isPartRange(checkRow,checkCol))this.cornerStyle.display="none";else{this.cornerStyle.top=top+height+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle[inlinePosProperty]=inlineStartPos+width+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let trimmingContainer=(0,dom_element.fX)(wtTable.TABLE);const trimToWindow=trimmingContainer===rootWindow;trimToWindow&&(trimmingContainer=rootDocument.documentElement);const cornerBorderCompensation=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,cornerHalfWidth=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),cornerHalfHeight=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(toColumn===this.wot.getSetting("totalColumns")-1){const toTdOffsetLeft=trimToWindow?toTD.getBoundingClientRect().left:toTD.offsetLeft;let cornerOverlappingContainer=!1,cornerEdge=0;isRtl?(cornerEdge=toTdOffsetLeft-parseInt(this.cornerDefaultStyle.width,10)/2,cornerOverlappingContainer=cornerEdge<0):(cornerEdge=toTdOffsetLeft+(0,dom_element.Gq)(toTD)+parseInt(this.cornerDefaultStyle.width,10)/2,cornerOverlappingContainer=cornerEdge>=(0,dom_element.xM)(trimmingContainer)),cornerOverlappingContainer&&(this.cornerStyle[inlinePosProperty]=`${Math.floor(inlineStartPos+width+this.cornerCenterPointOffset-cornerHalfWidth-cornerBorderCompensation)}px`,this.cornerStyle[isRtl?"borderLeftWidth":"borderRightWidth"]=0)}if(toRow===this.wot.getSetting("totalRows")-1){const cornerOverlappingContainer=(trimToWindow?toTD.getBoundingClientRect().top:toTD.offsetTop)+(0,dom_element.DK)(toTD)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,dom_element.eU)(trimmingContainer),isClassicTheme=this.wot.stylesHandler.isClassicTheme();if(cornerOverlappingContainer){const cornerTopPosition=Math.floor(top+height+this.cornerCenterPointOffset-cornerHalfHeight-cornerBorderCompensation);isClassicTheme?(this.cornerStyle.top=`${cornerTopPosition}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=cornerTopPosition-1+"px"}}this.cornerStyle.display="block"}(0,browser.rr)()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(toRow,toColumn,top,inlineStartPos,width,height)}isEntireColumnSelected(startRowIndex,endRowIndex){return startRowIndex===this.wot.wtTable.getFirstRenderedRow()&&endRowIndex===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(startColumnIndex,endColumnIndex){return startColumnIndex===this.wot.wtTable.getFirstRenderedColumn()&&endColumnIndex===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(direction,fromIndex,toIndex,headerIndex,containerOffset){const{wtTable}=this.wot,rootHotElement=wtTable.wtRootElement.parentNode;let getHeaderFn=null,dimensionFn=null,entireSelectionClassname=null,index=null,dimension=null,dimensionProperty=null,startHeader=null,endHeader=null;switch(direction){case"rows":getHeaderFn=function(){return wtTable.getRowHeader(...arguments)},dimensionFn=function(){return(0,dom_element.DK)(...arguments)},entireSelectionClassname="ht__selection--rows",dimensionProperty="top";break;case"columns":getHeaderFn=function(){return wtTable.getColumnHeader(...arguments)},dimensionFn=function(){return(0,dom_element.Gq)(...arguments)},entireSelectionClassname="ht__selection--columns",dimensionProperty="left"}if(rootHotElement.classList.contains(entireSelectionClassname)){const columnHeaderLevelCount=this.wot.getSetting("columnHeaders").length;if(startHeader=getHeaderFn(fromIndex,columnHeaderLevelCount-headerIndex),endHeader=getHeaderFn(toIndex,columnHeaderLevelCount-headerIndex),!startHeader||!endHeader)return!1;const startHeaderOffset=(0,dom_element.cY)(startHeader),endOffset=(0,dom_element.cY)(endHeader);return startHeader&&endHeader&&(index=startHeaderOffset[dimensionProperty]-containerOffset[dimensionProperty]-1,dimension=endOffset[dimensionProperty]+dimensionFn(endHeader)-startHeaderOffset[dimensionProperty]),[startHeader,index,dimension]}return!1}changeBorderStyle(borderElement,border){const style=this[borderElement].style,borderStyle=border[borderElement];!borderStyle||borderStyle.hide?(0,dom_element.iQ)(this[borderElement],"hidden"):((0,dom_element.nB)(this[borderElement],"hidden")&&(0,dom_element.vy)(this[borderElement],"hidden"),style.backgroundColor=borderStyle.color,"top"!==borderElement&&"bottom"!==borderElement||(style.height=`${borderStyle.width}px`),"start"!==borderElement&&"end"!==borderElement||(style.width=`${borderStyle.width}px`))}changeBorderToDefaultStyle(position){const defaultBorder_width=1,defaultBorder_color="#000",style=this[position].style;style.backgroundColor=defaultBorder_color,style.width=`${defaultBorder_width}px`,style.height=`${defaultBorder_width}px`}toggleHiddenClass(borderElement,remove){this.changeBorderToDefaultStyle(borderElement),remove?(0,dom_element.iQ)(this[borderElement],"hidden"):(0,dom_element.vy)(this[borderElement],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,browser.rr)()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function manager_classPrivateFieldInitSpec(e,t,a){manager_checkPrivateRedeclaration(e,t),t.set(e,a)}function manager_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function manager_classPrivateFieldGet(s,a){return s.get(manager_assertClassBrand(s,a))}function manager_classPrivateFieldSet(s,a,r){return s.set(manager_assertClassBrand(s,a),r),r}function manager_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var manager_activeOverlaysWot=new WeakMap,_selections=new WeakMap,_scanner=new WeakMap,_appliedClasses=new WeakMap,_destroyListeners=new WeakMap,_selectionBorders=new WeakMap,_SelectionManager_brand=new WeakSet;class SelectionManager{constructor(selections){!function manager_classPrivateMethodInitSpec(e,a){manager_checkPrivateRedeclaration(e,a),a.add(e)}(this,_SelectionManager_brand),manager_classPrivateFieldInitSpec(this,manager_activeOverlaysWot,void 0),manager_classPrivateFieldInitSpec(this,_selections,void 0),manager_classPrivateFieldInitSpec(this,_scanner,new SelectionScanner),manager_classPrivateFieldInitSpec(this,_appliedClasses,new WeakMap),manager_classPrivateFieldInitSpec(this,_destroyListeners,new WeakSet),manager_classPrivateFieldInitSpec(this,_selectionBorders,new Map),manager_classPrivateFieldSet(_selections,this,selections)}setActiveOverlay(activeWot){return manager_classPrivateFieldSet(manager_activeOverlaysWot,this,activeWot),manager_classPrivateFieldGet(_scanner,this).setActiveOverlay(manager_classPrivateFieldGet(manager_activeOverlaysWot,this)),manager_classPrivateFieldGet(_appliedClasses,this).has(manager_classPrivateFieldGet(manager_activeOverlaysWot,this))||manager_classPrivateFieldGet(_appliedClasses,this).set(manager_classPrivateFieldGet(manager_activeOverlaysWot,this),new Set),this}getFocusSelection(){return null!==manager_classPrivateFieldGet(_selections,this)?manager_classPrivateFieldGet(_selections,this).getFocus():null}getAreaSelection(){return null!==manager_classPrivateFieldGet(_selections,this)?manager_classPrivateFieldGet(_selections,this).createLayeredArea():null}getBorderInstance(selection){if(!selection.settings.border)return null;if(manager_classPrivateFieldGet(_selectionBorders,this).has(selection)){const borders=manager_classPrivateFieldGet(_selectionBorders,this).get(selection);if(borders.has(manager_classPrivateFieldGet(manager_activeOverlaysWot,this)))return borders.get(manager_classPrivateFieldGet(manager_activeOverlaysWot,this));const border=new border_border(manager_classPrivateFieldGet(manager_activeOverlaysWot,this),selection.settings);return borders.set(manager_classPrivateFieldGet(manager_activeOverlaysWot,this),border),border}const border=new border_border(manager_classPrivateFieldGet(manager_activeOverlaysWot,this),selection.settings);return manager_classPrivateFieldGet(_selectionBorders,this).set(selection,new Map([[manager_classPrivateFieldGet(manager_activeOverlaysWot,this),border]])),border}getBorderInstances(selection){var _classPrivateFieldGet2,_classPrivateFieldGet3;return Array.from(null!==(_classPrivateFieldGet2=null===(_classPrivateFieldGet3=manager_classPrivateFieldGet(_selectionBorders,this).get(selection))||void 0===_classPrivateFieldGet3?void 0:_classPrivateFieldGet3.values())&&void 0!==_classPrivateFieldGet2?_classPrivateFieldGet2:[])}destroyBorders(selection){manager_classPrivateFieldGet(_selectionBorders,this).get(selection).forEach((border=>border.destroy())),manager_classPrivateFieldGet(_selectionBorders,this).delete(selection)}render(fastDraw){if(null===manager_classPrivateFieldGet(_selections,this))return;fastDraw&&manager_assertClassBrand(_SelectionManager_brand,this,_resetCells).call(this);const selections=Array.from(manager_classPrivateFieldGet(_selections,this)),classNamesMap=new Map,headerAttributesMap=new Map;for(let i=0;i<selections.length;i++){const selection=selections[i],{className,headerAttributes,createLayers,selectionType}=selection.settings;manager_classPrivateFieldGet(_destroyListeners,this).has(selection)||(manager_classPrivateFieldGet(_destroyListeners,this).add(selection),selection.addLocalHook("destroy",(()=>this.destroyBorders(selection))));const borderInstance=this.getBorderInstance(selection);if(selection.isEmpty()){null==borderInstance||borderInstance.disappear();continue}if(className){manager_classPrivateFieldGet(_scanner,this).setActiveSelection(selection).scan().forEach((element=>{if(classNamesMap.has(element)){const classNamesLayers=classNamesMap.get(element);classNamesLayers.has(className)&&!0===createLayers?classNamesLayers.set(className,classNamesLayers.get(className)+1):classNamesLayers.set(className,1)}else classNamesMap.set(element,new Map([[className,1]]));headerAttributes&&(headerAttributesMap.has(element)||headerAttributesMap.set(element,[]),"TH"===element.nodeName&&headerAttributesMap.get(element).push(...headerAttributes))}))}const corners=selection.getCorners();manager_classPrivateFieldGet(manager_activeOverlaysWot,this).getSetting("onBeforeDrawBorders",corners,selectionType),null==borderInstance||borderInstance.appear(corners)}classNamesMap.forEach(((classNamesLayers,element)=>{var _classPrivateFieldGet4;const classNames=Array.from(classNamesLayers).map((_ref=>{let[className,occurrenceCount]=_ref;return 1===occurrenceCount?className:[className,...Array.from({length:occurrenceCount-1},((_,i)=>`${className}-${i+1}`))]})).flat();classNames.forEach((className=>manager_classPrivateFieldGet(_appliedClasses,this).get(manager_classPrivateFieldGet(manager_activeOverlaysWot,this)).add(className))),(0,dom_element.iQ)(element,classNames),"TD"===element.nodeName&&Array.isArray(null===(_classPrivateFieldGet4=manager_classPrivateFieldGet(_selections,this).options)||void 0===_classPrivateFieldGet4?void 0:_classPrivateFieldGet4.cellAttributes)&&(0,dom_element.Bq)(element,manager_classPrivateFieldGet(_selections,this).options.cellAttributes)})),Array.from(headerAttributesMap.keys()).forEach((element=>{(0,dom_element.Bq)(element,[...headerAttributesMap.get(element)])}))}}function _resetCells(){const appliedOverlaysClasses=manager_classPrivateFieldGet(_appliedClasses,this).get(manager_classPrivateFieldGet(manager_activeOverlaysWot,this)),classesToRemove=manager_classPrivateFieldGet(manager_activeOverlaysWot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(classesToRemove))for(let i=0;i<classesToRemove.length;i++)appliedOverlaysClasses.add(classesToRemove[i]);appliedOverlaysClasses.forEach((className=>{var _classPrivateFieldGet5,_classPrivateFieldGet6;const nodes=manager_classPrivateFieldGet(manager_activeOverlaysWot,this).wtTable.TABLE.querySelectorAll(`.${className}`);let cellAttributes=[];Array.isArray(null===(_classPrivateFieldGet5=manager_classPrivateFieldGet(_selections,this).options)||void 0===_classPrivateFieldGet5?void 0:_classPrivateFieldGet5.cellAttributes)&&(cellAttributes=manager_classPrivateFieldGet(_selections,this).options.cellAttributes.map((el=>el[0]))),Array.isArray(null===(_classPrivateFieldGet6=manager_classPrivateFieldGet(_selections,this).options)||void 0===_classPrivateFieldGet6?void 0:_classPrivateFieldGet6.headerAttributes)&&(cellAttributes=[...cellAttributes,...manager_classPrivateFieldGet(_selections,this).options.headerAttributes.map((el=>el[0]))]);for(let i=0,len=nodes.length;i<len;i++)(0,dom_element.vy)(nodes[i],className),(0,dom_element.De)(nodes[i],cellAttributes)})),appliedOverlaysClasses.clear()}function stylesHandler_classPrivateFieldInitSpec(e,t,a){stylesHandler_checkPrivateRedeclaration(e,t),t.set(e,a)}function stylesHandler_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function stylesHandler_classPrivateFieldGet(s,a){return s.get(stylesHandler_assertClassBrand(s,a))}function stylesHandler_classPrivateFieldSet(s,a,r){return s.set(stylesHandler_assertClassBrand(s,a),r),r}function stylesHandler_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _themeName=new WeakMap,_rootElement=new WeakMap,_rootComputedStyle=new WeakMap,_rootDocument=new WeakMap,_isClassicTheme=new WeakMap,_cssVars=new WeakMap,_computedStyles=new WeakMap,_StylesHandler_brand=new WeakSet;class StylesHandler{constructor(domBindings){!function stylesHandler_classPrivateMethodInitSpec(e,a){stylesHandler_checkPrivateRedeclaration(e,a),a.add(e)}(this,_StylesHandler_brand),stylesHandler_classPrivateFieldInitSpec(this,_themeName,void 0),stylesHandler_classPrivateFieldInitSpec(this,_rootElement,void 0),stylesHandler_classPrivateFieldInitSpec(this,_rootComputedStyle,void 0),stylesHandler_classPrivateFieldInitSpec(this,_rootDocument,void 0),stylesHandler_classPrivateFieldInitSpec(this,_isClassicTheme,!0),stylesHandler_classPrivateFieldInitSpec(this,_cssVars,{}),stylesHandler_classPrivateFieldInitSpec(this,_computedStyles,{}),stylesHandler_classPrivateFieldSet(_rootElement,this,domBindings.rootTable.parentElement.parentElement),stylesHandler_classPrivateFieldSet(_rootDocument,this,domBindings.rootDocument)}isClassicTheme(){return stylesHandler_classPrivateFieldGet(_isClassicTheme,this)}getCSSVariableValue(variableName){var _assertClassBrand$cal;if(stylesHandler_classPrivateFieldGet(_isClassicTheme,this))return null;if(stylesHandler_classPrivateFieldGet(_cssVars,this)[`--ht-${variableName}`])return stylesHandler_classPrivateFieldGet(_cssVars,this)[`--ht-${variableName}`];const acquiredValue=null!==(_assertClassBrand$cal=stylesHandler_assertClassBrand(_StylesHandler_brand,this,_getParsedNumericCSSValue).call(this,`--ht-${variableName}`))&&void 0!==_assertClassBrand$cal?_assertClassBrand$cal:stylesHandler_assertClassBrand(_StylesHandler_brand,this,_getCSSValue).call(this,`--ht-${variableName}`);return null!==acquiredValue?(stylesHandler_classPrivateFieldGet(_cssVars,this)[`--ht-${variableName}`]=acquiredValue,acquiredValue):void 0}getStyleForTD(cssProperty){var _classPrivateFieldGet2;return null===(_classPrivateFieldGet2=stylesHandler_classPrivateFieldGet(_computedStyles,this))||void 0===_classPrivateFieldGet2?void 0:_classPrivateFieldGet2.td[cssProperty]}getDefaultRowHeight(){if(stylesHandler_classPrivateFieldGet(_isClassicTheme,this))return 23;const calculatedRowHeight=stylesHandler_assertClassBrand(_StylesHandler_brand,this,_calculateRowHeight).call(this);return!calculatedRowHeight&&(0,dom_element.nB)(stylesHandler_classPrivateFieldGet(_rootElement,this),"ht-wrapper")?((0,helpers_console.R8)(`The "${stylesHandler_classPrivateFieldGet(_themeName,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),stylesHandler_classPrivateFieldSet(_isClassicTheme,this,!0),this.useTheme(),23):calculatedRowHeight}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(themeName){if(!themeName)return stylesHandler_assertClassBrand(_StylesHandler_brand,this,_cacheStylesheetValues).call(this),stylesHandler_classPrivateFieldSet(_isClassicTheme,this,!0),void stylesHandler_classPrivateFieldSet(_themeName,this,themeName||void 0);themeName&&themeName!==stylesHandler_classPrivateFieldGet(_themeName,this)&&(stylesHandler_classPrivateFieldGet(_themeName,this)&&stylesHandler_assertClassBrand(_StylesHandler_brand,this,_clearCachedValues).call(this),stylesHandler_classPrivateFieldSet(_themeName,this,themeName),stylesHandler_classPrivateFieldSet(_isClassicTheme,this,!1),stylesHandler_assertClassBrand(_StylesHandler_brand,this,_applyClassNames).call(this),stylesHandler_assertClassBrand(_StylesHandler_brand,this,_cacheStylesheetValues).call(this))}getThemeName(){return stylesHandler_classPrivateFieldGet(_themeName,this)}removeClassNames(){(0,dom_element.nB)(stylesHandler_classPrivateFieldGet(_rootElement,this),stylesHandler_classPrivateFieldGet(_themeName,this))&&(0,dom_element.vy)(stylesHandler_classPrivateFieldGet(_rootElement,this),stylesHandler_classPrivateFieldGet(_themeName,this))}}function _calculateRowHeight(){const lineHeightVarValue=this.getCSSVariableValue("line-height"),verticalPaddingVarValue=this.getCSSVariableValue("cell-vertical-padding"),bottomBorderWidth=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===lineHeightVarValue||null===verticalPaddingVarValue||isNaN(bottomBorderWidth)?null:lineHeightVarValue+2*verticalPaddingVarValue+bottomBorderWidth}function _applyClassNames(){(0,dom_element.vy)(stylesHandler_classPrivateFieldGet(_rootElement,this),/ht-theme-.*/g),(0,dom_element.iQ)(stylesHandler_classPrivateFieldGet(_rootElement,this),stylesHandler_classPrivateFieldGet(_themeName,this))}function _cacheStylesheetValues(){this.isClassicTheme()||stylesHandler_classPrivateFieldSet(_rootComputedStyle,this,getComputedStyle(stylesHandler_classPrivateFieldGet(_rootElement,this)));const stylesForTD=stylesHandler_assertClassBrand(_StylesHandler_brand,this,_getStylesForTD).call(this,["box-sizing","border-bottom-width"]);stylesHandler_classPrivateFieldGet(_computedStyles,this).td={...stylesHandler_classPrivateFieldGet(_computedStyles,this).td,"box-sizing":stylesForTD["box-sizing"],"border-bottom-width":stylesForTD["border-bottom-width"]}}function _getStylesForTD(cssProps){const rootDocument=stylesHandler_classPrivateFieldGet(_rootDocument,this),rootElement=stylesHandler_classPrivateFieldGet(_rootElement,this),table=rootDocument.createElement("table"),tbody=rootDocument.createElement("tbody"),tr=rootDocument.createElement("tr"),tr2=rootDocument.createElement("tr"),td=rootDocument.createElement("td");tr2.appendChild(td),tbody.appendChild(tr),tbody.appendChild(tr2),table.appendChild(tbody),rootElement.appendChild(table);const computedStyle=getComputedStyle(td),returnObject={};return cssProps.forEach((prop=>{returnObject[prop]=computedStyle.getPropertyValue(prop)})),rootElement.removeChild(table),returnObject}function _getParsedNumericCSSValue(property){const parsedValue=Math.ceil(parseFloat(stylesHandler_assertClassBrand(_StylesHandler_brand,this,_getCSSValue).call(this,property)));return Number.isNaN(parsedValue)?null:parsedValue}function _getCSSValue(property){const acquiredValue=stylesHandler_classPrivateFieldGet(_rootComputedStyle,this).getPropertyValue(property);return""===acquiredValue?null:acquiredValue}function _clearCachedValues(){stylesHandler_classPrivateFieldSet(_computedStyles,this,{}),stylesHandler_classPrivateFieldSet(_cssVars,this,{}),stylesHandler_classPrivateFieldSet(_isClassicTheme,this,!0)}class Walkontable extends CoreAbstract{constructor(table,settings){super(table,new Settings(settings)),this.stylesHandler=new StylesHandler(this.domBindings);const facadeGetter=this.wtSettings.getSetting("facade",this);this.wtTable=new master(this.getTableDao(),facadeGetter,this.domBindings,this.wtSettings),this.wtViewport=new viewport(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new src_event(facadeGetter,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new overlays(this,facadeGetter,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const allClassNames=[],newClassNames=[];(0,object.v4)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((className,key)=>{this.wtSettings.getSetting(key).length&&newClassNames.push(className),allClassNames.push(className)})),(0,dom_element.vy)(this.wtTable.wtRootElement.parentNode,allClassNames),(0,dom_element.iQ)(this.wtTable.wtRootElement.parentNode,newClassNames)}getOverlayByName(overlayName){var _this$wtOverlays;if(!CLONE_TYPES.includes(overlayName))return null;const camelCaseOverlay=overlayName.replace(/_([a-z])/g,(match=>match[1].toUpperCase()));return null!==(_this$wtOverlays=this.wtOverlays[`${camelCaseOverlay}Overlay`])&&void 0!==_this$wtOverlays?_this$wtOverlays:null}getViewportDao(){const wot=this;return{get wot(){return wot},get topOverlayTrimmingContainer(){return wot.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return wot.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return wot.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return wot.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return wot.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return wot.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return wot.wtOverlays.topOverlay},get inlineStartOverlay(){return wot.wtOverlays.inlineStartOverlay},get bottomOverlay(){return wot.wtOverlays.bottomOverlay}}}}class WalkontableFacade{constructor(settingsOrInstance){settingsOrInstance instanceof CoreAbstract?this._wot=settingsOrInstance:this._initFromSettings(settingsOrInstance)}_initFromSettings(settings){settings.facade=instance=>{const facade=new WalkontableFacade(instance);return()=>facade},this._wot=new Walkontable(settings.table,settings)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(value){this._wot.drawn=value}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(value){this._wot.drawInterrupted=value}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(value){this._wot.lastMouseOver=value}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(value){this._wot.momentumScrolling=value}get touchApplied(){return this._wot.touchApplied}set touchApplied(value){this._wot.touchApplied=value}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(value){this._wot.eventListeners=value}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(row,column){return this._wot.createCellCoords(row,column)}createCellRange(highlight,from,to){return this._wot.createCellRange(highlight,from,to)}draw(){let fastDraw=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(fastDraw),this}getCell(coords){let topmost=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(coords,topmost)}scrollViewport(coords,horizontalSnap,verticalSnap){return this._wot.scrollViewport(coords,horizontalSnap,verticalSnap)}scrollViewportHorizontally(column,snapping){return this._wot.scrollViewportHorizontally(column,snapping)}scrollViewportVertically(row,snapping){return this._wot.scrollViewportVertically(row,snapping)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(overlayName){return this._wot.getOverlayByName(overlayName)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(settings,value){return this._wot.wtSettings.update(settings,value),this}getSetting(key,param1,param2,param3,param4){return this._wot.wtSettings.getSetting(key,param1,param2,param3,param4)}hasSetting(key){return this._wot.wtSettings.hasSetting(key)}destroy(){this._wot.destroy()}}function mouseDown(_ref){let{isShiftKey,isLeftClick,isRightClick,coords,selection,controller,cellCoordsFactory}=_ref;const currentSelection=selection.isSelected()?selection.getSelectedRange().current():null,selectedCorner=selection.isSelectedByCorner(),selectedRow=selection.isSelectedByRowHeader();if(selection.markSource("mouse"),isShiftKey&&currentSelection)coords.row>=0&&coords.col>=0&&!controller.cell?selection.setRangeEnd(coords):(selectedCorner||selectedRow)&&coords.row>=0&&coords.col>=0&&!controller.cell?selection.setRangeEnd(cellCoordsFactory(coords.row,coords.col)):selectedCorner&&coords.row<0&&!controller.column?selection.setRangeEnd(cellCoordsFactory(currentSelection.to.row,coords.col)):selectedRow&&coords.col<0&&!controller.row?selection.setRangeEnd(cellCoordsFactory(coords.row,currentSelection.to.col)):(!selectedCorner&&!selectedRow&&coords.col<0||selectedCorner&&coords.col<0)&&!controller.row?selection.selectRows(Math.max(currentSelection.from.row,0),coords.row,coords.col):(!selectedCorner&&!selectedRow&&coords.row<0||selectedRow&&coords.row<0)&&!controller.column&&selection.selectColumns(Math.max(currentSelection.from.col,0),coords.col,coords.row);else{const allowRightClickSelection=!selection.inInSelection(coords),performSelection=isLeftClick||isRightClick&&allowRightClickSelection;coords.row<0&&coords.col>=0&&!controller.column?performSelection&&selection.selectColumns(coords.col,coords.col,coords.row):coords.col<0&&coords.row>=0&&!controller.row?performSelection&&selection.selectRows(coords.row,coords.row,coords.col):coords.col>=0&&coords.row>=0&&!controller.cell?performSelection&&selection.setRangeStart(coords):coords.col<0&&coords.row<0&&selection.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}selection.markEndSource()}const handlers=new Map([["mousedown",mouseDown],["mouseover",function mouseOver(_ref2){let{isLeftClick,coords,selection,controller,cellCoordsFactory}=_ref2;if(!isLeftClick)return;const selectedRow=selection.isSelectedByRowHeader(),selectedColumn=selection.isSelectedByColumnHeader(),countCols=selection.tableProps.countCols(),countRows=selection.tableProps.countRows();selection.markSource("mouse"),selectedColumn&&!controller.column?selection.setRangeEnd(cellCoordsFactory(countRows-1,coords.col)):selectedRow&&!controller.row?selection.setRangeEnd(cellCoordsFactory(coords.row,countCols-1)):controller.cell||selection.setRangeEnd(coords),selection.markEndSource()}],["touchstart",mouseDown]]);function handleMouseEvent(event,_ref3){let{coords,selection,controller,cellCoordsFactory}=_ref3;handlers.get(event.type)({coords,selection,controller,cellCoordsFactory,isShiftKey:event.shiftKey,isLeftClick:(0,dom_event.Ml)(event)||"touchstart"===event.type,isRightClick:(0,dom_event.nO)(event)})}const holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function hasValidParameter(rootSymbol){return rootSymbol===rootInstanceSymbol}function isRootInstance(object){return holder.has(object)}function tableView_classPrivateFieldInitSpec(e,t,a){tableView_checkPrivateRedeclaration(e,t),t.set(e,a)}function tableView_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tableView_defineProperty(e,r,t){return(r=function tableView_toPropertyKey(t){var i=function tableView_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function tableView_classPrivateFieldGet(s,a){return s.get(tableView_assertClassBrand(s,a))}function tableView_classPrivateFieldSet(s,a,r){return s.set(tableView_assertClassBrand(s,a),r),r}function tableView_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _columnHeadersCount=new WeakMap,_rowHeadersCount=new WeakMap,_selectionMouseDown=new WeakMap,_mouseDown=new WeakMap,_table=new WeakMap,_lastWidth=new WeakMap,_lastHeight=new WeakMap,_mouseDownLastPos=new WeakMap,_TableView_brand=new WeakSet;function _getAriaColcount(){return parseInt(this.hot.rootElement.getAttribute((0,a11y.Nb)()[0]),10)}function _updateAriaColcount(delta){const colCount=tableView_assertClassBrand(_TableView_brand,this,_getAriaColcount).call(this)+delta;(0,dom_element.Bq)(this.hot.rootElement,...(0,a11y.Nb)(colCount))}function _updateScrollbarClassNames(){const rootElement=this.hot.rootElement;this.hasVerticalScroll()?(0,dom_element.iQ)(rootElement,"htHasScrollY"):(0,dom_element.vy)(rootElement,"htHasScrollY"),this.hasHorizontalScroll()?(0,dom_element.iQ)(rootElement,"htHasScrollX"):(0,dom_element.vy)(rootElement,"htHasScrollX")}const tableView=class TableView{constructor(hotInstance){!function tableView_classPrivateMethodInitSpec(e,a){tableView_checkPrivateRedeclaration(e,a),a.add(e)}(this,_TableView_brand),tableView_defineProperty(this,"hot",void 0),tableView_defineProperty(this,"eventManager",void 0),tableView_defineProperty(this,"settings",void 0),tableView_defineProperty(this,"THEAD",void 0),tableView_defineProperty(this,"TBODY",void 0),tableView_defineProperty(this,"_wt",void 0),tableView_defineProperty(this,"activeWt",void 0),tableView_classPrivateFieldInitSpec(this,_columnHeadersCount,0),tableView_classPrivateFieldInitSpec(this,_rowHeadersCount,0),tableView_defineProperty(this,"postponedAdjustElementsSize",!1),tableView_classPrivateFieldInitSpec(this,_selectionMouseDown,!1),tableView_classPrivateFieldInitSpec(this,_mouseDown,void 0),tableView_classPrivateFieldInitSpec(this,_table,void 0),tableView_classPrivateFieldInitSpec(this,_lastWidth,0),tableView_classPrivateFieldInitSpec(this,_lastHeight,0),tableView_classPrivateFieldInitSpec(this,_mouseDownLastPos,null),this.hot=hotInstance,this.eventManager=new handsontable_eventManager.A(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),tableView_assertClassBrand(_TableView_brand,this,_updateScrollbarClassNames).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(coords,topmost){const td=this._wt.getCell(coords,topmost);return td<0?null:td}scrollViewport(coords,horizontalSnap,verticalSnap){return this._wt.scrollViewport(coords,horizontalSnap,verticalSnap)}scrollViewportHorizontally(column,snap){return this._wt.scrollViewportHorizontally(column,snap)}scrollViewportVertically(row,snap){return this._wt.scrollViewportVertically(row,snap)}createElements(){const{rootElement,rootDocument}=this.hot,originalStyle=rootElement.getAttribute("style");originalStyle&&rootElement.setAttribute("data-originalstyle",originalStyle),(0,dom_element.iQ)(rootElement,"handsontable"),tableView_classPrivateFieldSet(_table,this,rootDocument.createElement("TABLE")),(0,dom_element.iQ)(tableView_classPrivateFieldGet(_table,this),"htCore"),this.hot.getSettings().tableClassName&&(0,dom_element.iQ)(tableView_classPrivateFieldGet(_table,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,dom_element.Bq)(tableView_classPrivateFieldGet(_table,this),[(0,a11y.gg)()]),(0,dom_element.Bq)(rootElement,[(0,a11y.ax)(),(0,a11y.DZ)(-1),(0,a11y.Nb)(this.hot.countCols()),(0,a11y.L4)()])),this.THEAD=rootDocument.createElement("THEAD"),tableView_classPrivateFieldGet(_table,this).appendChild(this.THEAD),this.TBODY=rootDocument.createElement("TBODY"),tableView_classPrivateFieldGet(_table,this).appendChild(this.TBODY),this.hot.table=tableView_classPrivateFieldGet(_table,this),this.hot.container.insertBefore(tableView_classPrivateFieldGet(_table,this),this.hot.container.firstChild)}registerEvents(){const{rootElement,rootDocument,selection,rootWindow}=this.hot,documentElement=rootDocument.documentElement;this.eventManager.addEventListener(rootElement,"mousedown",(event=>{tableView_classPrivateFieldSet(_selectionMouseDown,this,!0),this.isTextSelectionAllowed(event.target)||((0,dom_element.LL)(rootWindow),event.preventDefault(),rootWindow.focus())})),this.eventManager.addEventListener(rootElement,"mouseup",(()=>{tableView_classPrivateFieldSet(_selectionMouseDown,this,!1)})),this.eventManager.addEventListener(rootElement,"mousemove",(event=>{tableView_classPrivateFieldGet(_selectionMouseDown,this)&&!this.isTextSelectionAllowed(event.target)&&(this.settings.fragmentSelection&&(0,dom_element.LL)(rootWindow),event.preventDefault())})),this.eventManager.addEventListener(documentElement,"keyup",(event=>{selection.isInProgress()&&!event.shiftKey&&selection.finish()})),this.eventManager.addEventListener(documentElement,"mouseup",(event=>{selection.isInProgress()&&(0,dom_event.Ml)(event)&&selection.finish(),tableView_classPrivateFieldSet(_mouseDown,this,!1);const isOutsideInputElement=(0,dom_element.E3)(rootDocument.activeElement);(0,dom_element.Xy)(rootDocument.activeElement)&&!isOutsideInputElement||!isOutsideInputElement&&(selection.isSelected()||selection.isSelectedByAnyHeader()||rootElement.contains(event.target)||(0,dom_event.nO)(event))||this.hot.unlisten()})),this.eventManager.addEventListener(documentElement,"contextmenu",(event=>{selection.isInProgress()&&(0,dom_event.nO)(event)&&(selection.finish(),tableView_classPrivateFieldSet(_mouseDown,this,!1))})),this.eventManager.addEventListener(documentElement,"touchend",(()=>{selection.isInProgress()&&selection.finish(),tableView_classPrivateFieldSet(_mouseDown,this,!1)})),this.eventManager.addEventListener(documentElement,"mousedown",(event=>{const originalTarget=event.target,eventX=event.x||event.clientX,eventY=event.y||event.clientY;let next=event.target;if(tableView_classPrivateFieldGet(_mouseDown,this)||!rootElement||!this.hot.view)return;const{holder}=this._wt.wtTable;if(next===holder){const scrollbarWidth=(0,dom_element.XJ)(rootDocument);if(rootDocument.elementFromPoint(eventX+scrollbarWidth,eventY)!==holder||rootDocument.elementFromPoint(eventX,eventY+scrollbarWidth)!==holder)return}else for(;next!==documentElement;){if(null===next){if(event.isTargetWebComponent)break;return}if(next===rootElement)return;next=next.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(originalTarget):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let parentWindow=(0,dom_element.Ly)(rootWindow);for(;null!==parentWindow;)this.eventManager.addEventListener(parentWindow.document.documentElement,"click",(()=>{this.hot.unlisten()})),parentWindow=(0,dom_element.Ly)(parentWindow);this.eventManager.addEventListener(tableView_classPrivateFieldGet(_table,this),"selectstart",(event=>{this.settings.fragmentSelection||(0,dom_element.Xy)(event.target)||event.preventDefault()}))}translateFromRenderableToVisualCoords(_ref){let{row,col}=_ref;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(row,col))}translateFromRenderableToVisualIndex(renderableRow,renderableColumn){let visualRow=renderableRow>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(renderableRow):renderableRow,visualColumn=renderableColumn>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(renderableColumn):renderableColumn;return null===visualRow&&(visualRow=renderableRow),null===visualColumn&&(visualColumn=renderableColumn),[visualRow,visualColumn]}countRenderableIndexes(indexMapper,maxElements){const consideredElements=Math.min(indexMapper.getNotTrimmedIndexesLength(),maxElements),firstNotHiddenIndex=indexMapper.getNearestNotHiddenIndex(consideredElements-1,-1);return null===firstNotHiddenIndex?0:indexMapper.getRenderableFromVisualIndex(firstNotHiddenIndex)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(visualIndex,incrementBy){return this.countNotHiddenIndexes(visualIndex,incrementBy,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(visualIndex,incrementBy){return this.countNotHiddenIndexes(visualIndex,incrementBy,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(visualIndex,incrementBy,indexMapper,renderableIndexesCount){if(isNaN(visualIndex)||visualIndex<0)return 0;const firstVisibleIndex=indexMapper.getNearestNotHiddenIndex(visualIndex,incrementBy),renderableIndex=indexMapper.getRenderableFromVisualIndex(firstVisibleIndex);if(!Number.isInteger(renderableIndex))return 0;let notHiddenIndexes=0;return incrementBy<0?notHiddenIndexes=renderableIndex+1:incrementBy>0&&(notHiddenIndexes=renderableIndexesCount-renderableIndex),notHiddenIndexes}countNotHiddenFixedColumnsStart(){const countCols=this.hot.countCols(),visualFixedColumnsStart=Math.min(parseInt(this.settings.fixedColumnsStart,10),countCols)-1;return this.countNotHiddenColumnIndexes(visualFixedColumnsStart,-1)}countNotHiddenFixedRowsTop(){const countRows=this.hot.countRows(),visualFixedRowsTop=Math.min(parseInt(this.settings.fixedRowsTop,10),countRows)-1;return this.countNotHiddenRowIndexes(visualFixedRowsTop,-1)}countNotHiddenFixedRowsBottom(){const countRows=this.hot.countRows(),visualFixedRowsBottom=Math.max(countRows-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(visualFixedRowsBottom,1)}countRenderableColumnsInRange(columnStart,columnEnd){let count=0;for(let column=columnStart;column<=columnEnd;column++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(column)&&(count+=1);return count}countRenderableRowsInRange(rowStart,rowEnd){let count=0;for(let row=rowStart;row<=rowEnd;row++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(row)&&(count+=1);return count}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(className){var _this$hot$rootElement;const licenseInfoElement=null===(_this$hot$rootElement=this.hot.rootElement.parentNode)||void 0===_this$hot$rootElement?void 0:_this$hot$rootElement.querySelector(".hot-display-license-info");licenseInfoElement&&(0,dom_element.iQ)(licenseInfoElement,className)}removeClassNameFromLicenseElement(className){var _this$hot$rootElement2;const licenseInfoElement=null===(_this$hot$rootElement2=this.hot.rootElement.parentNode)||void 0===_this$hot$rootElement2?void 0:_this$hot$rootElement2.querySelector(".hot-display-license-info");licenseInfoElement&&(0,dom_element.vy)(licenseInfoElement,className)}isMainTableNotFullyCoveredByOverlays(){const fixedAllRows=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),fixedAllColumns=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>fixedAllRows&&this.hot.countRenderedCols()>fixedAllColumns}initializeWalkontable(){const walkontableConfig={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:tableView_classPrivateFieldGet(_table,this),isDataViewInstance:()=>isRootInstance(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(renderableRow,renderableColumn)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(renderableRow,renderableColumn)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||walkontableConfig.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||walkontableConfig.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const headerRenderers=[];return this.hot.hasRowHeaders()&&headerRenderers.push(((renderableRowIndex,TH)=>{const visualRowIndex=renderableRowIndex>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(renderableRowIndex):renderableRowIndex;this.appendRowHeader(visualRowIndex,TH)})),this.hot.runHooks("afterGetRowHeaderRenderers",headerRenderers),tableView_classPrivateFieldSet(_rowHeadersCount,this,headerRenderers.length),this.hot.getSettings().ariaTags&&tableView_assertClassBrand(_TableView_brand,this,_getAriaColcount).call(this)===this.hot.countCols()&&tableView_assertClassBrand(_TableView_brand,this,_updateAriaColcount).call(this,tableView_classPrivateFieldGet(_rowHeadersCount,this)),headerRenderers},columnHeaders:()=>{const headerRenderers=[];return this.hot.hasColHeaders()&&headerRenderers.push(((renderedColumnIndex,TH)=>{const visualColumnsIndex=renderedColumnIndex>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(renderedColumnIndex):renderedColumnIndex;this.appendColHeader(visualColumnsIndex,TH)})),this.hot.runHooks("afterGetColumnHeaderRenderers",headerRenderers),tableView_classPrivateFieldSet(_columnHeadersCount,this,headerRenderers.length),headerRenderers},columnWidth:renderedColumnIndex=>{const visualIndex=this.hot.columnIndexMapper.getVisualFromRenderableIndex(renderedColumnIndex);return this.hot.getColWidth(null===visualIndex?renderedColumnIndex:visualIndex)},rowHeight:renderedRowIndex=>{const visualIndex=this.hot.rowIndexMapper.getVisualFromRenderableIndex(renderedRowIndex);return this.hot.getRowHeight(null===visualIndex?renderedRowIndex:visualIndex)},rowHeightByOverlayName:(renderedRowIndex,overlayType)=>{const visualIndex=this.hot.rowIndexMapper.getVisualFromRenderableIndex(renderedRowIndex),visualRowIndex=null===visualIndex?renderedRowIndex:visualIndex;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(visualRowIndex),visualRowIndex,overlayType)},cellRenderer:(renderedRowIndex,renderedColumnIndex,TD)=>{const[visualRowIndex,visualColumnIndex]=this.translateFromRenderableToVisualIndex(renderedRowIndex,renderedColumnIndex),modifiedCellCoords=this.hot.runHooks("modifyGetCellCoords",visualRowIndex,visualColumnIndex,!1,"meta");let visualRowToCheck=visualRowIndex,visualColumnToCheck=visualColumnIndex;Array.isArray(modifiedCellCoords)&&([visualRowToCheck,visualColumnToCheck]=modifiedCellCoords);const cellProperties=this.hot.getCellMeta(visualRowToCheck,visualColumnToCheck),prop=this.hot.colToProp(visualColumnToCheck);let value=this.hot.getDataAtRowProp(visualRowToCheck,prop);this.hot.hasHook("beforeValueRender")&&(value=this.hot.runHooks("beforeValueRender",value,cellProperties)),this.hot.runHooks("beforeRenderer",TD,visualRowIndex,visualColumnIndex,prop,value,cellProperties),this.hot.getCellRenderer(cellProperties)(this.hot,TD,visualRowIndex,visualColumnIndex,prop,value,cellProperties),this.hot.runHooks("afterRenderer",TD,visualRowIndex,visualColumnIndex,prop,value,cellProperties)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,dom_element.zN)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(event,coords,TD,wt)=>{const visualCoords=this.translateFromRenderableToVisualCoords(coords),controller={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=wt,tableView_classPrivateFieldSet(_mouseDown,this,!0),tableView_classPrivateFieldSet(_mouseDownLastPos,this,{x:event.clientX,y:event.clientY}),this.hot.runHooks("beforeOnCellMouseDown",event,visualCoords,TD,controller),(0,dom_event.d)(event)||(handleMouseEvent(event,{coords:visualCoords,selection:this.hot.selection,controller,cellCoordsFactory:(row,column)=>this.hot._createCellCoords(row,column)}),this.hot.runHooks("afterOnCellMouseDown",event,visualCoords,TD),this.activeWt=this._wt)},onCellContextMenu:(event,coords,TD,wt)=>{const visualCoords=this.translateFromRenderableToVisualCoords(coords);this.activeWt=wt,tableView_classPrivateFieldSet(_mouseDown,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",event,visualCoords,TD),(0,dom_event.d)(event)||(this.hot.runHooks("afterOnCellContextMenu",event,visualCoords,TD),this.activeWt=this._wt)},onCellMouseOut:(event,coords,TD,wt)=>{const visualCoords=this.translateFromRenderableToVisualCoords(coords);this.activeWt=wt,this.hot.runHooks("beforeOnCellMouseOut",event,visualCoords,TD),(0,dom_event.d)(event)||(this.hot.runHooks("afterOnCellMouseOut",event,visualCoords,TD),this.activeWt=this._wt)},onCellMouseOver:(event,coords,TD,wt)=>{const visualCoords=this.translateFromRenderableToVisualCoords(coords),controller={row:!1,column:!1,cell:!1};this.activeWt=wt,this.hot.runHooks("beforeOnCellMouseOver",event,visualCoords,TD,controller),(0,dom_event.d)(event)||(!tableView_classPrivateFieldGet(_mouseDown,this)||tableView_classPrivateFieldGet(_mouseDownLastPos,this)&&tableView_classPrivateFieldGet(_mouseDownLastPos,this).x===event.clientX&&tableView_classPrivateFieldGet(_mouseDownLastPos,this).y===event.clientY||handleMouseEvent(event,{coords:visualCoords,selection:this.hot.selection,controller,cellCoordsFactory:(row,column)=>this.hot._createCellCoords(row,column)}),this.hot.runHooks("afterOnCellMouseOver",event,visualCoords,TD),this.activeWt=this._wt,tableView_classPrivateFieldSet(_mouseDownLastPos,this,null))},onCellMouseUp:(event,coords,TD,wt)=>{const visualCoords=this.translateFromRenderableToVisualCoords(coords);this.activeWt=wt,this.hot.runHooks("beforeOnCellMouseUp",event,visualCoords,TD),(0,dom_event.d)(event)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",event,visualCoords,TD),this.activeWt=this._wt)},onCellCornerMouseDown:event=>{event.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",event)},onCellCornerDblClick:event=>{event.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",event)},beforeDraw:(force,skipRender)=>this.beforeRender(force,skipRender),onDraw:force=>this.afterRender(force),onBeforeViewportScrollVertically:(renderableRow,snapping)=>{const rowMapper=this.hot.rowIndexMapper,areColumnHeadersSelected=renderableRow<0;let visualRow=renderableRow;return areColumnHeadersSelected||(visualRow=rowMapper.getVisualFromRenderableIndex(renderableRow),null!==visualRow)?(visualRow=this.hot.runHooks("beforeViewportScrollVertically",visualRow,snapping),this.hot.runHooks("beforeViewportScroll"),areColumnHeadersSelected?visualRow:rowMapper.getRenderableFromVisualIndex(visualRow)):renderableRow},onBeforeViewportScrollHorizontally:(renderableColumn,snapping)=>{const columnMapper=this.hot.columnIndexMapper,areRowHeadersSelected=renderableColumn<0;let visualColumn=renderableColumn;return areRowHeadersSelected||(visualColumn=columnMapper.getVisualFromRenderableIndex(renderableColumn),null!==visualColumn)?(visualColumn=this.hot.runHooks("beforeViewportScrollHorizontally",visualColumn,snapping),this.hot.runHooks("beforeViewportScroll"),areRowHeadersSelected?visualColumn:columnMapper.getRenderableFromVisualIndex(visualColumn)):renderableColumn},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(renderableRow,headerLevel,highlightMeta)=>{const rowMapper=this.hot.rowIndexMapper,areColumnHeadersSelected=renderableRow<0;let visualRow=renderableRow;areColumnHeadersSelected||(visualRow=rowMapper.getVisualFromRenderableIndex(renderableRow));const newVisualRow=this.hot.runHooks("beforeHighlightingRowHeader",visualRow,headerLevel,highlightMeta);return areColumnHeadersSelected?newVisualRow:rowMapper.getRenderableFromVisualIndex(rowMapper.getNearestNotHiddenIndex(newVisualRow,1))},onBeforeHighlightingColumnHeader:(renderableColumn,headerLevel,highlightMeta)=>{const columnMapper=this.hot.columnIndexMapper,areRowHeadersSelected=renderableColumn<0;let visualColumn=renderableColumn;areRowHeadersSelected||(visualColumn=columnMapper.getVisualFromRenderableIndex(renderableColumn));const newVisualColumn=this.hot.runHooks("beforeHighlightingColumnHeader",visualColumn,headerLevel,highlightMeta);return areRowHeadersSelected?newVisualColumn:columnMapper.getRenderableFromVisualIndex(columnMapper.getNearestNotHiddenIndex(newVisualColumn,1))},onAfterDrawSelection:(currentRow,currentColumn,layerLevel)=>{let cornersOfSelection;const[visualRowIndex,visualColumnIndex]=this.translateFromRenderableToVisualIndex(currentRow,currentColumn),selectedRange=this.hot.selection.getSelectedRange();if(selectedRange.size()>0){const selectionForLayer=selectedRange.peekByIndex(null!=layerLevel?layerLevel:0);cornersOfSelection=[selectionForLayer.from.row,selectionForLayer.from.col,selectionForLayer.to.row,selectionForLayer.to.col]}return this.hot.runHooks("afterDrawSelection",visualRowIndex,visualColumnIndex,cornersOfSelection,layerLevel)},onBeforeDrawBorders:(corners,borderClassName)=>{const[startRenderableRow,startRenderableColumn,endRenderableRow,endRenderableColumn]=corners,visualCorners=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(startRenderableRow),this.hot.columnIndexMapper.getVisualFromRenderableIndex(startRenderableColumn),this.hot.rowIndexMapper.getVisualFromRenderableIndex(endRenderableRow),this.hot.columnIndexMapper.getVisualFromRenderableIndex(endRenderableColumn)];return this.hot.runHooks("beforeDrawBorders",visualCorners,borderClassName)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:rowHeaderWidth=>this.hot.runHooks("modifyRowHeaderWidth",rowHeaderWidth),onModifyGetCellCoords:(renderableRowIndex,renderableColumnIndex,topmost,source)=>{const rowMapper=this.hot.rowIndexMapper,columnMapper=this.hot.columnIndexMapper,visualColumnIndex=renderableColumnIndex>=0?columnMapper.getVisualFromRenderableIndex(renderableColumnIndex):renderableColumnIndex,visualRowIndex=renderableRowIndex>=0?rowMapper.getVisualFromRenderableIndex(renderableRowIndex):renderableRowIndex,visualIndexes=this.hot.runHooks("modifyGetCellCoords",visualRowIndex,visualColumnIndex,topmost,source);if(Array.isArray(visualIndexes)){const[visualRowFrom,visualColumnFrom,visualRowTo,visualColumnTo]=visualIndexes;return[visualRowFrom>=0?rowMapper.getRenderableFromVisualIndex(rowMapper.getNearestNotHiddenIndex(visualRowFrom,1)):visualRowFrom,visualColumnFrom>=0?columnMapper.getRenderableFromVisualIndex(columnMapper.getNearestNotHiddenIndex(visualColumnFrom,1)):visualColumnFrom,visualRowTo>=0?rowMapper.getRenderableFromVisualIndex(rowMapper.getNearestNotHiddenIndex(visualRowTo,-1)):visualRowTo,visualColumnTo>=0?columnMapper.getRenderableFromVisualIndex(columnMapper.getNearestNotHiddenIndex(visualColumnTo,-1)):visualColumnTo]}},onModifyGetCoordsElement:(renderableRowIndex,renderableColumnIndex)=>{const rowMapper=this.hot.rowIndexMapper,columnMapper=this.hot.columnIndexMapper,visualColumnIndex=renderableColumnIndex>=0?columnMapper.getVisualFromRenderableIndex(renderableColumnIndex):renderableColumnIndex,visualRowIndex=renderableRowIndex>=0?rowMapper.getVisualFromRenderableIndex(renderableRowIndex):renderableRowIndex,visualIndexes=this.hot.runHooks("modifyGetCoordsElement",visualRowIndex,visualColumnIndex);if(Array.isArray(visualIndexes)){const[visualRow,visualColumn]=visualIndexes;return[visualRow>=0?rowMapper.getRenderableFromVisualIndex(rowMapper.getNearestNotHiddenIndex(visualRow,1)):visualRow,visualColumn>=0?columnMapper.getRenderableFromVisualIndex(columnMapper.getNearestNotHiddenIndex(visualColumn,1)):visualColumn]}},viewportRowCalculatorOverride:calc=>{let viewportOffset=this.settings.viewportRowRenderingOffset;if("auto"===viewportOffset&&this.settings.fixedRowsTop&&(viewportOffset=10),viewportOffset>0||"auto"===viewportOffset){const renderableRows=this.countRenderableRows(),firstRenderedRow=calc.startRow,lastRenderedRow=calc.endRow;if("number"==typeof viewportOffset)calc.startRow=Math.max(firstRenderedRow-viewportOffset,0),calc.endRow=Math.min(lastRenderedRow+viewportOffset,renderableRows-1);else if("auto"===viewportOffset){const offset=Math.max(1,Math.ceil(lastRenderedRow/renderableRows*12));calc.startRow=Math.max(firstRenderedRow-offset,0),calc.endRow=Math.min(lastRenderedRow+offset,renderableRows-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",calc)},viewportColumnCalculatorOverride:calc=>{let viewportOffset=this.settings.viewportColumnRenderingOffset;if("auto"===viewportOffset&&this.settings.fixedColumnsStart&&(viewportOffset=10),viewportOffset>0||"auto"===viewportOffset){const renderableColumns=this.countRenderableColumns(),firstRenderedColumn=calc.startColumn,lastRenderedColumn=calc.endColumn;if("number"==typeof viewportOffset&&(calc.startColumn=Math.max(firstRenderedColumn-viewportOffset,0),calc.endColumn=Math.min(lastRenderedColumn+viewportOffset,renderableColumns-1)),"auto"===viewportOffset){const offset=Math.max(1,Math.ceil(lastRenderedColumn/renderableColumns*6));calc.startColumn=Math.max(firstRenderedColumn-offset,0),calc.endColumn=Math.min(lastRenderedColumn+offset,renderableColumns-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",calc)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const columnHeaderHeight=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||columnHeaderHeight}};this.hot.runHooks("beforeInitWalkontable",walkontableConfig),this._wt=new WalkontableFacade(walkontableConfig),this.activeWt=this._wt;const spreader=this._wt.wtTable.spreader,{width,height}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(width,height),this.eventManager.addEventListener(spreader,"mousedown",(event=>{event.target===spreader&&3===event.which&&event.stopPropagation()})),this.eventManager.addEventListener(spreader,"contextmenu",(event=>{event.target===spreader&&3===event.which&&event.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(el){if((0,dom_element.Xy)(el))return!0;const isChildOfTableBody=(0,dom_element.aO)(el,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!isChildOfTableBody)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!isChildOfTableBody)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return tableView_classPrivateFieldGet(_mouseDown,this)}isSelectedOnlyCell(){var _this$hot$getSelected,_this$hot$getSelected2;return null!==(_this$hot$getSelected=null===(_this$hot$getSelected2=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected2?void 0:_this$hot$getSelected2.isSingleCell())&&void 0!==_this$hot$getSelected&&_this$hot$getSelected}isCellEdited(){const activeEditor=this.hot.getActiveEditor();return activeEditor&&activeEditor.isOpened()}beforeRender(force,skipRender){force&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,skipRender)}afterRender(force){force&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(visualRowIndex,TH){if(TH.firstChild){const container=TH.firstChild;if(!(0,dom_element.nB)(container,"relative"))return(0,dom_element.Ie)(TH),void this.appendRowHeader(visualRowIndex,TH);this.updateCellHeader(container.querySelector(".rowHeader"),visualRowIndex,this.hot.getRowHeader)}else{const{rootDocument,getRowHeader}=this.hot,div=rootDocument.createElement("div"),span=rootDocument.createElement("span");div.className="relative",span.className="rowHeader",this.updateCellHeader(span,visualRowIndex,getRowHeader),div.appendChild(span),TH.appendChild(div)}this.hot.runHooks("afterGetRowHeader",visualRowIndex,TH)}appendColHeader(visualColumnIndex,TH){let label=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,headerLevel=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const getColumnHeaderClassNames=()=>{const metaHeaderClassNames=visualColumnIndex>=0?this.hot.getColumnMeta(visualColumnIndex).headerClassName:null;return metaHeaderClassNames?metaHeaderClassNames.split(" "):[]};if(TH.firstChild){const container=TH.firstChild;(0,dom_element.nB)(container,"relative")?(this.updateCellHeader(container.querySelector(".colHeader"),visualColumnIndex,label,headerLevel),container.className="",(0,dom_element.iQ)(container,["relative",...getColumnHeaderClassNames()])):((0,dom_element.Ie)(TH),this.appendColHeader(visualColumnIndex,TH,label,headerLevel))}else{const{rootDocument}=this.hot,div=rootDocument.createElement("div"),span=rootDocument.createElement("span"),classNames=getColumnHeaderClassNames();div.classList.add("relative",...classNames),span.className="colHeader",this.settings.ariaTags&&((0,dom_element.Bq)(div,...(0,a11y.gg)()),(0,dom_element.Bq)(span,...(0,a11y.gg)())),this.updateCellHeader(span,visualColumnIndex,label,headerLevel),div.appendChild(span),TH.appendChild(div)}this.hot.runHooks("afterGetColHeader",visualColumnIndex,TH,headerLevel)}updateCellHeader(element,index,content){let headerLevel=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,renderedIndex=index;const parentOverlay=this._wt.wtOverlays.getParentOverlay(element)||this._wt;element.parentNode&&((0,dom_element.nB)(element,"colHeader")?renderedIndex=parentOverlay.wtTable.columnFilter.sourceToRendered(index):(0,dom_element.nB)(element,"rowHeader")&&(renderedIndex=parentOverlay.wtTable.rowFilter.sourceToRendered(index))),renderedIndex>-1?(0,dom_element.Mv)(element,content(index,headerLevel)):((0,dom_element.c6)(element,String.fromCharCode(160)),(0,dom_element.iQ)(element,"cornerHeader"))}maximumVisibleElementWidth(inlineOffset){const maxWidth=this._wt.wtViewport.getWorkspaceWidth()-inlineOffset;return maxWidth>0?maxWidth:0}maximumVisibleElementHeight(topOffset){const maxHeight=this._wt.wtViewport.getWorkspaceHeight()-topOffset;return maxHeight>0?maxHeight:0}setLastSize(width,height){tableView_classPrivateFieldSet(_lastWidth,this,width),tableView_classPrivateFieldSet(_lastHeight,this,height)}getLastSize(){return{width:tableView_classPrivateFieldGet(_lastWidth,this),height:tableView_classPrivateFieldGet(_lastHeight,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const indexMapper=this.hot.rowIndexMapper,visualRowIndex=indexMapper.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return indexMapper.getNearestNotHiddenIndex(null!=visualRowIndex?visualRowIndex:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const indexMapper=this.hot.rowIndexMapper,visualRowIndex=indexMapper.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return indexMapper.getNearestNotHiddenIndex(null!=visualRowIndex?visualRowIndex:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const indexMapper=this.hot.columnIndexMapper,visualColumnIndex=indexMapper.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return indexMapper.getNearestNotHiddenIndex(null!=visualColumnIndex?visualColumnIndex:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const indexMapper=this.hot.columnIndexMapper,visualColumnIndex=indexMapper.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return indexMapper.getNearestNotHiddenIndex(null!=visualColumnIndex?visualColumnIndex:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return tableView_classPrivateFieldGet(_columnHeadersCount,this)}getRowHeadersCount(){return tableView_classPrivateFieldGet(_rowHeadersCount,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(element){var _this$_wt$wtOverlays$;return(null!==(_this$_wt$wtOverlays$=this._wt.wtOverlays.getParentOverlay(element))&&void 0!==_this$_wt$wtOverlays$?_this$_wt$wtOverlays$:this._wt).wtTable.name}getOverlayByName(overlayName){return this._wt.getOverlayByName(overlayName)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};var data=__webpack_require__("./node_modules/handsontable/helpers/data.mjs");function dataSource_defineProperty(e,r,t){return(r=function dataSource_toPropertyKey(t){var i=function dataSource_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const dataMap_dataSource=class DataSource{constructor(hotInstance){let dataSource=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];dataSource_defineProperty(this,"hot",void 0),dataSource_defineProperty(this,"data",void 0),dataSource_defineProperty(this,"dataType","array"),dataSource_defineProperty(this,"colToProp",(()=>{})),dataSource_defineProperty(this,"propToCol",(()=>{})),this.hot=hotInstance,this.data=dataSource}modifyRowData(rowIndex){let modifyRowData;return this.hot.hasHook("modifyRowData")&&(modifyRowData=this.hot.runHooks("modifyRowData",rowIndex)),void 0===modifyRowData||Number.isInteger(modifyRowData)?this.data[rowIndex]:modifyRowData}getData(){let toArray=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,toArray):this.data}setData(data){this.data=data}getAtColumn(column){const result=[];return(0,array.z0)(this.data,((row,rowIndex)=>{const value=this.getAtCell(rowIndex,column);result.push(value)})),result}getAtRow(row,startColumn,endColumn){let toArray=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const getAllProps=void 0===startColumn&&void 0===endColumn,{dataDotNotation}=this.hot.getSettings();let dataRow=null,newDataRow=null;if(dataRow=this.modifyRowData(row),Array.isArray(dataRow))newDataRow=[],getAllProps?dataRow.forEach(((cell,column)=>{newDataRow[column]=this.getAtPhysicalCell(row,column,dataRow)})):(0,number.Ti)(startColumn,endColumn,(column=>{newDataRow[column-startColumn]=this.getAtPhysicalCell(row,column,dataRow)}));else if((0,object.Gv)(dataRow)||(0,helpers_function.Tn)(dataRow))if(newDataRow=toArray?[]:{},!getAllProps||toArray){const rangeStart=0,rangeEnd=this.countFirstRowKeys()-1;(0,number.Ti)(rangeStart,rangeEnd,(column=>{const prop=this.colToProp(column);if(column>=(startColumn||rangeStart)&&column<=(endColumn||rangeEnd)&&!Number.isInteger(prop)){const cellValue=this.getAtPhysicalCell(row,prop,dataRow);toArray?newDataRow.push(cellValue):dataDotNotation?(0,object.oq)(newDataRow,prop,cellValue):newDataRow[prop]=cellValue}}))}else(0,object.v4)(dataRow,((value,prop)=>{const cellValue=this.getAtPhysicalCell(row,prop,dataRow);dataDotNotation?(0,object.oq)(newDataRow,prop,cellValue):newDataRow[prop]=cellValue}));return newDataRow}setAtCell(row,column,value){if(!(row>=this.countRows()||column>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const valueHolder=(0,object.nA)(value);this.hot.runHooks("modifySourceData",row,column,valueHolder,"set"),valueHolder.isTouched()&&(value=valueHolder.value)}["__proto__","constructor","prototype"].includes(row)||(Number.isInteger(column)?this.data[row][column]=value:(0,object.oq)(this.data[row],column,value))}}getAtPhysicalCell(row,column,dataRow){let result=null;if(dataRow)if("string"==typeof column){const{dataDotNotation}=this.hot.getSettings();result=dataDotNotation?(0,object.UU)(dataRow,column):dataRow[column]}else result="function"==typeof column?column(dataRow):dataRow[column];if(this.hot.hasHook("modifySourceData")){const valueHolder=(0,object.nA)(result);this.hot.runHooks("modifySourceData",row,column,valueHolder,"get"),valueHolder.isTouched()&&(result=valueHolder.value)}return result}getAtCell(row,columnOrProp){const dataRow=this.modifyRowData(row);return this.getAtPhysicalCell(row,this.colToProp(columnOrProp),dataRow)}getByRange(){let start=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,end=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,toArray=arguments.length>2&&void 0!==arguments[2]&&arguments[2],getAllProps=!1,startRow=null,startCol=null,endRow=null,endCol=null;null===start||null===end?(getAllProps=!0,startRow=0,endRow=this.countRows()-1):(startRow=Math.min(start.row,end.row),startCol=Math.min(start.col,end.col),endRow=Math.max(start.row,end.row),endCol=Math.max(start.col,end.col));const result=[];return(0,number.Ti)(startRow,endRow,(currentRow=>{result.push(getAllProps?this.getAtRow(currentRow,void 0,void 0,toArray):this.getAtRow(currentRow,startCol,endCol,toArray))})),result}countRows(){if(this.hot.hasHook("modifySourceLength")){const modifiedSourceLength=this.hot.runHooks("modifySourceLength");if(Number.isInteger(modifiedSourceLength))return modifiedSourceLength}return this.data.length}countFirstRowKeys(){return(0,data.E)(this.data)}destroy(){this.data=null,this.hot=null}};__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");var indexesSequence=__webpack_require__("./node_modules/handsontable/translations/maps/indexesSequence.mjs"),hidingMap=__webpack_require__("./node_modules/handsontable/translations/maps/hidingMap.mjs"),indexMap=__webpack_require__("./node_modules/handsontable/translations/maps/indexMap.mjs"),linkedPhysicalIndexToValueMap=__webpack_require__("./node_modules/handsontable/translations/maps/linkedPhysicalIndexToValueMap.mjs"),physicalIndexToValueMap=__webpack_require__("./node_modules/handsontable/translations/maps/physicalIndexToValueMap.mjs"),trimmingMap=__webpack_require__("./node_modules/handsontable/translations/maps/trimmingMap.mjs");const availableIndexMapTypes=new Map([["hiding",hidingMap.o],["index",indexMap.n],["linkedPhysicalIndexToValue",linkedPhysicalIndexToValueMap.z],["physicalIndexToValue",physicalIndexToValueMap._],["trimming",trimmingMap.q]]);var utils_indexesSequence=__webpack_require__("./node_modules/handsontable/translations/maps/utils/indexesSequence.mjs"),localHooks=__webpack_require__("./node_modules/handsontable/mixins/localHooks.mjs");function mapCollection_defineProperty(e,r,t){return(r=function mapCollection_toPropertyKey(t){var i=function mapCollection_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}let registeredMaps=0;class MapCollection{constructor(){mapCollection_defineProperty(this,"collection",new Map)}register(uniqueName,indexMap){!1===this.collection.has(uniqueName)&&(this.collection.set(uniqueName,indexMap),indexMap.addLocalHook("change",(()=>this.runLocalHooks("change",indexMap))),registeredMaps+=1)}unregister(name){const indexMap=this.collection.get(name);(0,mixed.O9)(indexMap)&&(indexMap.destroy(),this.collection.delete(name),this.runLocalHooks("change",indexMap),registeredMaps-=1)}unregisterAll(){this.collection.forEach(((indexMap,name)=>this.unregister(name))),this.collection.clear()}get(name){return(0,mixed.b0)(name)?Array.from(this.collection.values()):this.collection.get(name)}getLength(){return this.collection.size}removeFromEvery(removedIndexes){this.collection.forEach((indexMap=>{indexMap.remove(removedIndexes)}))}insertToEvery(insertionIndex,insertedIndexes){this.collection.forEach((indexMap=>{indexMap.insert(insertionIndex,insertedIndexes)}))}initEvery(length){this.collection.forEach((indexMap=>{indexMap.init(length)}))}}function aggregatedCollection_defineProperty(e,r,t){return(r=function aggregatedCollection_toPropertyKey(t){var i=function aggregatedCollection_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}(0,object.co)(MapCollection,localHooks.A);class AggregatedCollection extends MapCollection{constructor(aggregationFunction,fallbackValue){super(),aggregatedCollection_defineProperty(this,"mergedValuesCache",[]),aggregatedCollection_defineProperty(this,"aggregationFunction",void 0),aggregatedCollection_defineProperty(this,"fallbackValue",void 0),this.aggregationFunction=aggregationFunction,this.fallbackValue=fallbackValue}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const mapsValuesMatrix=(0,array.YD)(this.get(),(map=>map.getValues())),indexesValuesMatrix=[],mapsLength=(0,mixed.O9)(mapsValuesMatrix[0])&&mapsValuesMatrix[0].length||0;for(let index=0;index<mapsLength;index+=1){const valuesForIndex=[];for(let mapIndex=0;mapIndex<this.getLength();mapIndex+=1)valuesForIndex.push(mapsValuesMatrix[mapIndex][index]);indexesValuesMatrix.push(valuesForIndex)}return(0,array.YD)(indexesValuesMatrix,this.aggregationFunction)}getMergedValueAtIndex(index,readFromCache){const valueAtIndex=this.getMergedValues(readFromCache)[index];return(0,mixed.O9)(valueAtIndex)?valueAtIndex:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function observer_classPrivateFieldInitSpec(e,t,a){(function observer_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function observer_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _currentInitialChanges=new WeakMap;class ChangesObserver{constructor(){observer_classPrivateFieldInitSpec(this,_currentInitialChanges,[])}subscribe(callback){return this.addLocalHook("change",callback),this._write(function observer_classPrivateFieldGet(s,a){return s.get(observer_assertClassBrand(s,a))}(_currentInitialChanges,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(changes){return changes.length>0&&this.runLocalHooks("change",changes),this}_writeInitialChanges(initialChanges){!function observer_classPrivateFieldSet(s,a,r){return s.set(observer_assertClassBrand(s,a),r),r}(_currentInitialChanges,this,initialChanges)}}function arrayDiff(baseArray,newArray){const changes=[];let i=0,j=0;for(;i<baseArray.length&&j<newArray.length;i++,j++)baseArray[i]!==newArray[j]&&changes.push({op:"replace",index:j,oldValue:baseArray[i],newValue:newArray[j]});for(;i<newArray.length;i++)changes.push({op:"insert",index:i,oldValue:void 0,newValue:newArray[i]});for(;j<baseArray.length;j++)changes.push({op:"remove",index:j,oldValue:baseArray[j],newValue:void 0});return changes}function observable_classPrivateFieldInitSpec(e,t,a){(function observable_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function observable_classPrivateFieldGet(s,a){return s.get(observable_assertClassBrand(s,a))}function observable_classPrivateFieldSet(s,a,r){return s.set(observable_assertClassBrand(s,a),r),r}function observable_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(0,object.co)(ChangesObserver,localHooks.A);var _observers=new WeakMap,_indexMatrix=new WeakMap,_currentIndexState=new WeakMap,_isMatrixIndexesInitialized=new WeakMap,_initialIndexValue=new WeakMap;class ChangesObservable{constructor(){let{initialIndexValue}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};observable_classPrivateFieldInitSpec(this,_observers,new Set),observable_classPrivateFieldInitSpec(this,_indexMatrix,[]),observable_classPrivateFieldInitSpec(this,_currentIndexState,[]),observable_classPrivateFieldInitSpec(this,_isMatrixIndexesInitialized,!1),observable_classPrivateFieldInitSpec(this,_initialIndexValue,!1),observable_classPrivateFieldSet(_initialIndexValue,this,null!=initialIndexValue&&initialIndexValue)}createObserver(){const observer=new ChangesObserver;return observable_classPrivateFieldGet(_observers,this).add(observer),observer.addLocalHook("unsubscribe",(()=>{observable_classPrivateFieldGet(_observers,this).delete(observer)})),observer._writeInitialChanges(arrayDiff(observable_classPrivateFieldGet(_indexMatrix,this),observable_classPrivateFieldGet(_currentIndexState,this))),observer}emit(indexesState){let currentIndexState=observable_classPrivateFieldGet(_currentIndexState,this);observable_classPrivateFieldGet(_isMatrixIndexesInitialized,this)&&observable_classPrivateFieldGet(_indexMatrix,this).length===indexesState.length||(0===indexesState.length?indexesState=new Array(currentIndexState.length).fill(observable_classPrivateFieldGet(_initialIndexValue,this)):observable_classPrivateFieldSet(_indexMatrix,this,new Array(indexesState.length).fill(observable_classPrivateFieldGet(_initialIndexValue,this))),observable_classPrivateFieldGet(_isMatrixIndexesInitialized,this)||(observable_classPrivateFieldSet(_isMatrixIndexesInitialized,this,!0),currentIndexState=observable_classPrivateFieldGet(_indexMatrix,this)));const changes=arrayDiff(currentIndexState,indexesState);observable_classPrivateFieldGet(_observers,this).forEach((observer=>observer._write(changes))),observable_classPrivateFieldSet(_currentIndexState,this,indexesState)}}function indexMapper_defineProperty(e,r,t){return(r=function indexMapper_toPropertyKey(t){var i=function indexMapper_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}new Set;class IndexMapper{constructor(){indexMapper_defineProperty(this,"indexesSequence",new indexesSequence.K),indexMapper_defineProperty(this,"trimmingMapsCollection",new AggregatedCollection((valuesForIndex=>valuesForIndex.some((value=>!0===value))),!1)),indexMapper_defineProperty(this,"hidingMapsCollection",new AggregatedCollection((valuesForIndex=>valuesForIndex.some((value=>!0===value))),!1)),indexMapper_defineProperty(this,"variousMapsCollection",new MapCollection),indexMapper_defineProperty(this,"hidingChangesObservable",new ChangesObservable({initialIndexValue:!1})),indexMapper_defineProperty(this,"notTrimmedIndexesCache",[]),indexMapper_defineProperty(this,"notHiddenIndexesCache",[]),indexMapper_defineProperty(this,"isBatched",!1),indexMapper_defineProperty(this,"indexesSequenceChanged",!1),indexMapper_defineProperty(this,"indexesChangeSource",void 0),indexMapper_defineProperty(this,"trimmedIndexesChanged",!1),indexMapper_defineProperty(this,"hiddenIndexesChanged",!1),indexMapper_defineProperty(this,"renderablePhysicalIndexesCache",[]),indexMapper_defineProperty(this,"fromPhysicalToVisualIndexesCache",new Map),indexMapper_defineProperty(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(changedMap=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",changedMap,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(changedMap=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",changedMap,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(changedMap=>{this.runLocalHooks("change",changedMap,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(indexMapType){if("hiding"!==indexMapType)throw new Error(`Unsupported index map type "${indexMapType}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(indexName,mapType,initValueOrFn){return this.registerMap(indexName,function createIndexMap(mapType){let initValueOrFn=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!availableIndexMapTypes.has(mapType))throw new Error(`The provided map type ("${mapType}") does not exist.`);return new(availableIndexMapTypes.get(mapType))(initValueOrFn)}(mapType,initValueOrFn))}registerMap(uniqueName,indexMap){if(this.trimmingMapsCollection.get(uniqueName)||this.hidingMapsCollection.get(uniqueName)||this.variousMapsCollection.get(uniqueName))throw Error(`Map with name "${uniqueName}" has been already registered.`);indexMap instanceof trimmingMap.q?this.trimmingMapsCollection.register(uniqueName,indexMap):indexMap instanceof hidingMap.o?this.hidingMapsCollection.register(uniqueName,indexMap):this.variousMapsCollection.register(uniqueName,indexMap);const numberOfIndexes=this.getNumberOfIndexes();return numberOfIndexes>0&&indexMap.init(numberOfIndexes),indexMap}unregisterMap(name){this.trimmingMapsCollection.unregister(name),this.hidingMapsCollection.unregister(name),this.variousMapsCollection.unregister(name)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(visualIndex){const physicalIndex=this.notTrimmedIndexesCache[visualIndex];return(0,mixed.O9)(physicalIndex)?physicalIndex:null}getPhysicalFromRenderableIndex(renderableIndex){const physicalIndex=this.renderablePhysicalIndexesCache[renderableIndex];return(0,mixed.O9)(physicalIndex)?physicalIndex:null}getVisualFromPhysicalIndex(physicalIndex){const visualIndex=this.fromPhysicalToVisualIndexesCache.get(physicalIndex);return(0,mixed.O9)(visualIndex)?visualIndex:null}getVisualFromRenderableIndex(renderableIndex){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(renderableIndex))}getRenderableFromVisualIndex(visualIndex){const renderableIndex=this.fromVisualToRenderableIndexesCache.get(visualIndex);return(0,mixed.O9)(renderableIndex)?renderableIndex:null}getNearestNotHiddenIndex(fromVisualIndex,searchDirection){let searchAlsoOtherWayAround=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(fromVisualIndex))return null;if(this.fromVisualToRenderableIndexesCache.has(fromVisualIndex))return fromVisualIndex;const visibleIndexes=Array.from(this.fromVisualToRenderableIndexesCache.keys());let index=-1;return index=searchDirection>0?visibleIndexes.findIndex((visualIndex=>visualIndex>fromVisualIndex)):visibleIndexes.reverse().findIndex((visualIndex=>visualIndex<fromVisualIndex)),-1===index?searchAlsoOtherWayAround?this.getNearestNotHiddenIndex(fromVisualIndex,-searchDirection,!1):null:visibleIndexes[index]}initToLength(){let length=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(length).keys()],this.notHiddenIndexesCache=[...new Array(length).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(length),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(length),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(length),this.variousMapsCollection.initEvery(length),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(length){const currentIndexCount=this.getNumberOfIndexes();if(length<currentIndexCount){const indexesToBeRemoved=[...Array(this.getNumberOfIndexes()-length).keys()].map((i=>i+length));this.removeIndexes(indexesToBeRemoved)}else this.insertIndexes(currentIndexCount,length-currentIndexCount)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(indexes){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(indexes),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((physicalIndex=>!1===this.isTrimmed(physicalIndex)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((physicalIndex=>!1===this.isHidden(physicalIndex)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((physicalIndex=>!1===this.isHidden(physicalIndex)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(movedIndexes,finalIndex){"number"==typeof movedIndexes&&(movedIndexes=[movedIndexes]);const physicalMovedIndexes=(0,array.YD)(movedIndexes,(visualIndex=>this.getPhysicalFromVisualIndex(visualIndex))),notTrimmedIndexesLength=this.getNotTrimmedIndexesLength(),movedIndexesLength=movedIndexes.length,notMovedIndexes=(0,utils_indexesSequence.H)(this.getIndexesSequence(),physicalMovedIndexes),notTrimmedNotMovedItems=notMovedIndexes.filter((index=>!1===this.isTrimmed(index)));let destinationPosition=notMovedIndexes.indexOf(notTrimmedNotMovedItems[notTrimmedNotMovedItems.length-1])+1;if(finalIndex+movedIndexesLength<notTrimmedIndexesLength){const physicalIndex=notTrimmedNotMovedItems[finalIndex];destinationPosition=notMovedIndexes.indexOf(physicalIndex)}this.indexesChangeSource="move",this.setIndexesSequence((0,utils_indexesSequence.N)(notMovedIndexes,destinationPosition,physicalMovedIndexes)),this.indexesChangeSource=void 0}isTrimmed(physicalIndex){return this.trimmingMapsCollection.getMergedValueAtIndex(physicalIndex)}isHidden(physicalIndex){return this.hidingMapsCollection.getMergedValueAtIndex(physicalIndex)}insertIndexes(firstInsertedVisualIndex,amountOfIndexes){const nthVisibleIndex=this.getNotTrimmedIndexes()[firstInsertedVisualIndex],firstInsertedPhysicalIndex=(0,mixed.O9)(nthVisibleIndex)?nthVisibleIndex:this.getNumberOfIndexes(),insertionIndex=this.getIndexesSequence().includes(nthVisibleIndex)?this.getIndexesSequence().indexOf(nthVisibleIndex):this.getNumberOfIndexes(),insertedIndexes=(0,array.YD)(new Array(amountOfIndexes).fill(firstInsertedPhysicalIndex),((nextIndex,stepsFromStart)=>nextIndex+stepsFromStart));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(insertionIndex,insertedIndexes),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(insertionIndex,insertedIndexes),this.hidingMapsCollection.insertToEvery(insertionIndex,insertedIndexes),this.variousMapsCollection.insertToEvery(insertionIndex,insertedIndexes),this.resumeOperations()}removeIndexes(removedIndexes){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(removedIndexes),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(removedIndexes),this.hidingMapsCollection.removeFromEvery(removedIndexes),this.variousMapsCollection.removeFromEvery(removedIndexes),this.resumeOperations()}updateCache(){let force=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const anyCachedIndexChanged=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===force||!1===this.isBatched&&!0===anyCachedIndexChanged)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const nrOfNotTrimmedIndexes=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let visualIndex=0;visualIndex<nrOfNotTrimmedIndexes;visualIndex+=1){const physicalIndex=this.getPhysicalFromVisualIndex(visualIndex);this.fromPhysicalToVisualIndexesCache.set(physicalIndex,visualIndex)}}cacheFromVisualToRenderableIndexes(){const nrOfRenderableIndexes=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let renderableIndex=0;renderableIndex<nrOfRenderableIndexes;renderableIndex+=1){const physicalIndex=this.getPhysicalFromRenderableIndex(renderableIndex),visualIndex=this.getVisualFromPhysicalIndex(physicalIndex);this.fromVisualToRenderableIndexesCache.set(visualIndex,renderableIndex)}}}(0,object.co)(IndexMapper,localHooks.A);var hooks=__webpack_require__("./node_modules/handsontable/core/hooks/index.mjs");function normalizeLanguageCode(languageCode){const partsOfLanguageCode=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(languageCode);return partsOfLanguageCode?`${partsOfLanguageCode[1].toLowerCase()}-${partsOfLanguageCode[2].toUpperCase()}`:languageCode}function warnUserAboutLanguageRegistration(languageCode){(0,mixed.O9)(languageCode)&&(0,helpers_console.z3)(templateLiteralTag.O`Language with code "${languageCode}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}var staticRegister=__webpack_require__("./node_modules/handsontable/utils/staticRegister.mjs");const{register:registerGloballyPhraseFormatter,getValues:getGlobalPhraseFormatters}=(0,staticRegister.A)("phraseFormatters");!function register(name,formatterFn){registerGloballyPhraseFormatter(name,formatterFn)}("pluralize",(function pluralize(phrasePropositions,pluralForm){return Array.isArray(phrasePropositions)&&Number.isInteger(pluralForm)?phrasePropositions[pluralForm]:phrasePropositions}));var constants=__webpack_require__("./node_modules/handsontable/i18n/constants.mjs");const en_US={languageCode:"en-US",[constants.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[constants.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[constants.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[constants.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[constants.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[constants.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[constants.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[constants.CONTEXTMENU_ITEMS_UNDO]:"Undo",[constants.CONTEXTMENU_ITEMS_REDO]:"Redo",[constants.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[constants.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[constants.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[constants.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[constants.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[constants.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[constants.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[constants.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[constants.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[constants.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[constants.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[constants.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[constants.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[constants.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[constants.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[constants.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[constants.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[constants.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[constants.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[constants.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[constants.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[constants.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[constants.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[constants.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[constants.CONTEXTMENU_ITEMS_COPY]:"Copy",[constants.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[constants.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[constants.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[constants.CONTEXTMENU_ITEMS_CUT]:"Cut",[constants.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[constants.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[constants.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[constants.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[constants.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[constants.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[constants.FILTERS_CONDITIONS_NONE]:"None",[constants.FILTERS_CONDITIONS_EMPTY]:"Is empty",[constants.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[constants.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[constants.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[constants.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[constants.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[constants.FILTERS_CONDITIONS_CONTAINS]:"Contains",[constants.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[constants.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[constants.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[constants.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[constants.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[constants.FILTERS_CONDITIONS_BETWEEN]:"Is between",[constants.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[constants.FILTERS_CONDITIONS_AFTER]:"After",[constants.FILTERS_CONDITIONS_BEFORE]:"Before",[constants.FILTERS_CONDITIONS_TODAY]:"Today",[constants.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[constants.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[constants.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[constants.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[constants.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[constants.FILTERS_LABELS_CONJUNCTION]:"And",[constants.FILTERS_LABELS_DISJUNCTION]:"Or",[constants.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[constants.FILTERS_BUTTONS_CLEAR]:"Clear",[constants.FILTERS_BUTTONS_OK]:"OK",[constants.FILTERS_BUTTONS_CANCEL]:"Cancel",[constants.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[constants.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[constants.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[constants.CHECKBOX_CHECKED]:"Checked",[constants.CHECKBOX_UNCHECKED]:"Unchecked"},dictionaryKeys=constants,DEFAULT_LANGUAGE_CODE=en_US.languageCode,{register:registerGloballyLanguageDictionary,getItem:getGlobalLanguageDictionary,hasItem:hasGlobalLanguageDictionary,getValues:getGlobalLanguagesDictionaries}=(0,staticRegister.A)("languagesDictionaries");function registerLanguageDictionary(languageCodeOrDictionary,dictionary){let languageCode=languageCodeOrDictionary,dictionaryObject=dictionary;return(0,object.Gv)(languageCodeOrDictionary)&&(dictionaryObject=languageCodeOrDictionary,languageCode=dictionaryObject.languageCode),function extendLanguageDictionary(languageCode,dictionary){languageCode!==DEFAULT_LANGUAGE_CODE&&function extendNotExistingKeys(target,extension){return(0,object.v4)(extension,((value,key)=>{(0,mixed.b0)(target[key])&&(target[key]=value)})),target}(dictionary,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}(languageCode,dictionaryObject),registerGloballyLanguageDictionary(languageCode,(0,object.Go)(dictionaryObject)),(0,object.Go)(dictionaryObject)}function getLanguageDictionary(languageCode){return hasLanguageDictionary(languageCode)?(0,object.Go)(getGlobalLanguageDictionary(languageCode)):null}function hasLanguageDictionary(languageCode){return hasGlobalLanguageDictionary(languageCode)}function getTranslatedPhrase(languageCode,dictionaryKey,argumentsForFormatters){const languageDictionary=getLanguageDictionary(languageCode);if(null===languageDictionary)return null;const phrasePropositions=languageDictionary[dictionaryKey];if((0,mixed.b0)(phrasePropositions))return null;const formattedPhrase=function getFormattedPhrase(phrasePropositions,argumentsForFormatters){let formattedPhrasePropositions=phrasePropositions;return(0,array.z0)(function getAll(){return getGlobalPhraseFormatters()}(),(formatter=>{formattedPhrasePropositions=formatter(phrasePropositions,argumentsForFormatters)})),formattedPhrasePropositions}(phrasePropositions,argumentsForFormatters);return Array.isArray(formattedPhrase)?formattedPhrase[0]:formattedPhrase}registerLanguageDictionary(en_US);var selection_constants=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/selection/constants.mjs");class Selection{constructor(settings,cellRange){this.settings=settings,this.cellRange=cellRange||null}isEmpty(){return null===this.cellRange}add(coords){return this.isEmpty()?this.cellRange=this.settings.createCellRange(coords):this.cellRange.expand(coords),this}replace(oldCoords,newCoords){if(!this.isEmpty()){if(this.cellRange.from.isEqual(oldCoords))return this.cellRange.from=newCoords,!0;if(this.cellRange.to.isEqual(oldCoords))return this.cellRange.to=newCoords,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const topStart=this.cellRange.getOuterTopStartCorner(),bottomEnd=this.cellRange.getOuterBottomEndCorner();return[topStart.row,topStart.col,bottomEnd.row,bottomEnd.col]}destroy(){this.runLocalHooks("destroy")}}(0,object.co)(Selection,localHooks.A);const selection=Selection;function visualSelection_defineProperty(e,r,t){return(r=function visualSelection_toPropertyKey(t){var i=function visualSelection_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const visualSelection=class VisualSelection extends selection{constructor(settings,visualCellRange){super(settings,null),visualSelection_defineProperty(this,"visualCellRange",null),this.visualCellRange=visualCellRange||null,this.commit()}add(coords){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(coords):this.visualCellRange.expand(coords),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(_ref){let{from,to}=_ref,visibleFromCoords=this.getNearestNotHiddenCoords(from,1),visibleToCoords=this.getNearestNotHiddenCoords(to,-1);return null===visibleFromCoords||null===visibleToCoords?null:((visibleFromCoords.row>visibleToCoords.row||visibleFromCoords.col>visibleToCoords.col)&&(visibleFromCoords=from,visibleToCoords=to),this.settings.createCellRange(visibleFromCoords,visibleFromCoords,visibleToCoords))}getNearestNotHiddenCoords(coords,rowSearchDirection){let columnSearchDirection=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rowSearchDirection;const nextVisibleRow=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,coords.row,rowSearchDirection);if(null===nextVisibleRow)return null;const nextVisibleColumn=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,coords.col,columnSearchDirection);return null===nextVisibleColumn?null:this.settings.createCellCoords(nextVisibleRow,nextVisibleColumn)}getNearestNotHiddenIndex(indexMapper,visualIndex,searchDirection){return visualIndex<0?visualIndex:indexMapper.getNearestNotHiddenIndex(visualIndex,searchDirection)}commit(){if(null===this.visualCellRange)return this;const trimmedCellRange=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===trimmedCellRange?null:this.createRenderableCellRange(trimmedCellRange.from,trimmedCellRange.to),this}syncWith(broaderCellRange){const coordsFrom=broaderCellRange.from.clone().normalize(),rowDirection="N-S"===broaderCellRange.getVerticalDirection()?1:-1,columnDirection="W-E"===broaderCellRange.getHorizontalDirection()?1:-1,renderableHighlight=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let cellCoordsVisual=null;if(null!==renderableHighlight&&null!==renderableHighlight.col&&null!==renderableHighlight.row||(cellCoordsVisual=this.getNearestNotHiddenCoords(coordsFrom,rowDirection,columnDirection)),null!==cellCoordsVisual&&broaderCellRange.overlaps(cellCoordsVisual)){const currentHighlight=broaderCellRange.highlight.clone();if(currentHighlight.row>=0&&(currentHighlight.row=cellCoordsVisual.row),currentHighlight.col>=0&&(currentHighlight.col=cellCoordsVisual.col),null===this.cellRange){const cellCoordsRenderable=this.settings.visualToRenderableCoords(currentHighlight);this.cellRange=this.settings.createCellRange(cellCoordsRenderable)}broaderCellRange.setHighlight(currentHighlight)}return"focus"===this.settings.selectionType&&null!==renderableHighlight&&null===cellCoordsVisual&&broaderCellRange.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from,to}=this.cellRange;return[Math.min(from.row,to.row),Math.min(from.col,to.col),Math.max(from.row,to.row),Math.max(from.col,to.col)]}getVisualCorners(){const topStart=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),bottomEnd=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[topStart.row,topStart.col,bottomEnd.row,bottomEnd.col]}createRenderableCellRange(visualFromCoords,visualToCoords){const renderableFromCoords=this.settings.visualToRenderableCoords(visualFromCoords),renderableToCoords=this.settings.visualToRenderableCoords(visualToCoords);return null===renderableFromCoords.row||null===renderableFromCoords.col||null===renderableToCoords.row||null===renderableToCoords.col?null:this.settings.createCellRange(renderableFromCoords,renderableFromCoords,renderableToCoords)}};function createHighlight(_ref){let{activeHeaderClassName,...restOptions}=_ref;return new visualSelection({className:activeHeaderClassName,...restOptions,selectionType:selection_constants.E6})}function areaLayered_createHighlight(_ref){let{areaCornerVisible,...restOptions}=_ref;return new visualSelection({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:areaCornerVisible},...restOptions,selectionType:selection_constants.LX})}function area_createHighlight(_ref){let{...restOptions}=_ref;return new visualSelection({className:"highlight",...restOptions,selectionType:selection_constants.LX})}function column_createHighlight(_ref){let{columnClassName,...restOptions}=_ref;return new visualSelection({className:columnClassName,...restOptions,selectionType:selection_constants.QP})}function header_createHighlight(_ref){let{headerClassName,...restOptions}=_ref;return new visualSelection({className:headerClassName,...restOptions,selectionType:selection_constants.PP})}function row_createHighlight(_ref){let{rowClassName,...restOptions}=_ref;return new visualSelection({className:rowClassName,...restOptions,selectionType:selection_constants._8})}function highlight_classPrivateMethodInitSpec(e,a){(function highlight_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function highlight_defineProperty(e,r,t){return(r=function highlight_toPropertyKey(t){var i=function highlight_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function highlight_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _Highlight_brand=new WeakSet;class Highlight{constructor(options){highlight_classPrivateMethodInitSpec(this,_Highlight_brand),highlight_defineProperty(this,"options",void 0),highlight_defineProperty(this,"layerLevel",0),highlight_defineProperty(this,"focus",void 0),highlight_defineProperty(this,"fill",void 0),highlight_defineProperty(this,"layeredAreas",new Map),highlight_defineProperty(this,"areas",new Map),highlight_defineProperty(this,"rowHeaders",new Map),highlight_defineProperty(this,"columnHeaders",new Map),highlight_defineProperty(this,"activeRowHeaders",new Map),highlight_defineProperty(this,"activeColumnHeaders",new Map),highlight_defineProperty(this,"activeCornerHeaders",new Map),highlight_defineProperty(this,"rowHighlights",new Map),highlight_defineProperty(this,"columnHighlights",new Map),highlight_defineProperty(this,"customSelections",[]),this.options=options,this.focus=function focus_createHighlight(_ref){let{cellCornerVisible,...restOptions}=_ref;return new visualSelection({className:"current",headerAttributes:[(0,a11y.H0)()],border:{width:2,color:"#4b89ff",cornerVisible:cellCornerVisible},...restOptions,selectionType:selection_constants.Yt})}(options),this.fill=function fill_createHighlight(_ref){let{...restOptions}=_ref;return new visualSelection({className:"fill",border:{width:1,color:"#ff0000"},...restOptions,selectionType:selection_constants.Hb})}(options)}isEnabledFor(highlightType,coords){let type=highlightType;highlightType===selection_constants.Yt&&(type="current");let disableHighlight=this.options.disabledCellSelection(coords.row,coords.col);return"string"==typeof disableHighlight&&(disableHighlight=[disableHighlight]),!1===disableHighlight||Array.isArray(disableHighlight)&&!disableHighlight.includes(type)}useLayerLevel(){let level=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=level,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.layeredAreas,areaLayered_createHighlight)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.areas,area_createHighlight)}getAreas(){return[...this.areas.values()]}createRowHeader(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.rowHeaders,header_createHighlight)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.columnHeaders,header_createHighlight)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.activeRowHeaders,createHighlight)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.activeColumnHeaders,createHighlight)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.activeCornerHeaders,createHighlight)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.rowHighlights,row_createHighlight)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return highlight_assertClassBrand(_Highlight_brand,this,_createHighlight).call(this,this.columnHighlights,column_createHighlight)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(selectionInstance){this.customSelections.push(function customSelection_createHighlight(_ref){let{border,visualCellRange,...restOptions}=_ref;return new visualSelection({...border,...restOptions,selectionType:selection_constants.OS},visualCellRange)}({...this.options,...selectionInstance}))}clear(){this.focus.clear(),this.fill.clear(),(0,array.z0)(this.areas.values(),(highlight=>{highlight.clear()})),(0,array.z0)(this.layeredAreas.values(),(highlight=>{highlight.clear()})),(0,array.z0)(this.rowHeaders.values(),(highlight=>{highlight.clear()})),(0,array.z0)(this.columnHeaders.values(),(highlight=>{highlight.clear()})),(0,array.z0)(this.activeRowHeaders.values(),(highlight=>{highlight.clear()})),(0,array.z0)(this.activeColumnHeaders.values(),(highlight=>{highlight.clear()})),(0,array.z0)(this.activeCornerHeaders.values(),(highlight=>{highlight.clear()})),(0,array.z0)(this.rowHighlights.values(),(highlight=>{highlight.clear()})),(0,array.z0)(this.columnHighlights.values(),(highlight=>{highlight.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function _createHighlight(cacheMap,highlightFactory){const layerLevel=this.layerLevel;if(cacheMap.has(layerLevel))return cacheMap.get(layerLevel);const highlight=highlightFactory({layerLevel,...this.options});return cacheMap.set(layerLevel,highlight),highlight}const highlight=Highlight;function range_defineProperty(e,r,t){return(r=function range_toPropertyKey(t){var i=function range_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class SelectionRange{constructor(createCellRange){range_defineProperty(this,"ranges",[]),range_defineProperty(this,"createCellRange",void 0),this.createCellRange=createCellRange}isEmpty(){return 0===this.size()}set(coords){return this.clear(),this.ranges.push(this.createCellRange(coords)),this}add(coords){return this.ranges.push(this.createCellRange(coords)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(coords){return this.ranges.some((cellRange=>cellRange.includes(coords)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let cellRange,index=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return index>=0&&index<this.size()&&(cellRange=this.ranges[index]),cellRange}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const selection_range=SelectionRange;function transformation_classPrivateFieldInitSpec(e,t,a){transformation_checkPrivateRedeclaration(e,t),t.set(e,a)}function transformation_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function transformation_classPrivateFieldGet(s,a){return s.get(transformation_assertClassBrand(s,a))}function transformation_classPrivateFieldSet(s,a,r){return s.set(transformation_assertClassBrand(s,a),r),r}function transformation_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _range=new WeakMap,_options=new WeakMap,_offset=new WeakMap,_Transformation_brand=new WeakSet;class Transformation{constructor(range,options){!function transformation_classPrivateMethodInitSpec(e,a){transformation_checkPrivateRedeclaration(e,a),a.add(e)}(this,_Transformation_brand),transformation_classPrivateFieldInitSpec(this,_range,void 0),transformation_classPrivateFieldInitSpec(this,_options,void 0),transformation_classPrivateFieldInitSpec(this,_offset,{x:0,y:0}),transformation_classPrivateFieldSet(_range,this,range),transformation_classPrivateFieldSet(_options,this,options)}transformStart(rowDelta,colDelta){let createMissingRecords=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const delta=transformation_classPrivateFieldGet(_options,this).createCellCoords(rowDelta,colDelta);let visualCoords=transformation_classPrivateFieldGet(_range,this).current().highlight;const highlightRenderableCoords=transformation_classPrivateFieldGet(_options,this).visualToRenderableCoords(visualCoords);let rowTransformDir=0,colTransformDir=0;if(this.runLocalHooks("beforeTransformStart",delta),null!==highlightRenderableCoords.row&&null!==highlightRenderableCoords.col){const{width,height}=transformation_assertClassBrand(_Transformation_brand,this,_getTableSize).call(this),{row,col}=transformation_assertClassBrand(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,visualCoords),fixedRowsBottom=transformation_classPrivateFieldGet(_options,this).fixedRowsBottom(),minSpareRows=transformation_classPrivateFieldGet(_options,this).minSpareRows(),minSpareCols=transformation_classPrivateFieldGet(_options,this).minSpareCols(),autoWrapRow=transformation_classPrivateFieldGet(_options,this).autoWrapRow(),autoWrapCol=transformation_classPrivateFieldGet(_options,this).autoWrapCol(),zeroBasedCoords=transformation_classPrivateFieldGet(_options,this).createCellCoords(row+delta.row,col+delta.col);if(zeroBasedCoords.row>=height){const isActionInterrupted=(0,object.nA)(createMissingRecords&&minSpareRows>0&&0===fixedRowsBottom),nextColumn=zeroBasedCoords.col+1,newCoords=transformation_classPrivateFieldGet(_options,this).createCellCoords(zeroBasedCoords.row-height,nextColumn>=width?nextColumn-width:nextColumn);this.runLocalHooks("beforeColumnWrap",isActionInterrupted,transformation_assertClassBrand(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,newCoords),nextColumn>=width),isActionInterrupted.value?this.runLocalHooks("insertRowRequire",transformation_classPrivateFieldGet(_options,this).countRenderableRows()):autoWrapCol&&zeroBasedCoords.assign(newCoords)}else if(zeroBasedCoords.row<0){const isActionInterrupted=(0,object.nA)(autoWrapCol),previousColumn=zeroBasedCoords.col-1,newCoords=transformation_classPrivateFieldGet(_options,this).createCellCoords(height+zeroBasedCoords.row,previousColumn<0?width+previousColumn:previousColumn);this.runLocalHooks("beforeColumnWrap",isActionInterrupted,transformation_assertClassBrand(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,newCoords),previousColumn<0),autoWrapCol&&zeroBasedCoords.assign(newCoords)}if(zeroBasedCoords.col>=width){const isActionInterrupted=(0,object.nA)(createMissingRecords&&minSpareCols>0),nextRow=zeroBasedCoords.row+1,newCoords=transformation_classPrivateFieldGet(_options,this).createCellCoords(nextRow>=height?nextRow-height:nextRow,zeroBasedCoords.col-width);this.runLocalHooks("beforeRowWrap",isActionInterrupted,transformation_assertClassBrand(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,newCoords),nextRow>=height),isActionInterrupted.value?this.runLocalHooks("insertColRequire",transformation_classPrivateFieldGet(_options,this).countRenderableColumns()):autoWrapRow&&zeroBasedCoords.assign(newCoords)}else if(zeroBasedCoords.col<0){const isActionInterrupted=(0,object.nA)(autoWrapRow),previousRow=zeroBasedCoords.row-1,newCoords=transformation_classPrivateFieldGet(_options,this).createCellCoords(previousRow<0?height+previousRow:previousRow,width+zeroBasedCoords.col);this.runLocalHooks("beforeRowWrap",isActionInterrupted,transformation_assertClassBrand(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,newCoords),previousRow<0),autoWrapRow&&zeroBasedCoords.assign(newCoords)}const{rowDir,colDir}=transformation_assertClassBrand(_Transformation_brand,this,_clampCoords).call(this,zeroBasedCoords);rowTransformDir=rowDir,colTransformDir=colDir,visualCoords=transformation_assertClassBrand(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,zeroBasedCoords)}return this.runLocalHooks("afterTransformStart",visualCoords,rowTransformDir,colTransformDir),visualCoords}transformEnd(rowDelta,colDelta){const delta=transformation_classPrivateFieldGet(_options,this).createCellCoords(rowDelta,colDelta),cellRange=transformation_classPrivateFieldGet(_range,this).current(),highlightRenderableCoords=transformation_classPrivateFieldGet(_options,this).visualToRenderableCoords(cellRange.highlight),toRow=transformation_assertClassBrand(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,cellRange.to.row,cellRange.from.row),toColumn=transformation_assertClassBrand(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,cellRange.to.col,cellRange.from.col),visualCoords=cellRange.to.clone();let rowTransformDir=0,colTransformDir=0;if(this.runLocalHooks("beforeTransformEnd",delta),null!==highlightRenderableCoords.row&&null!==highlightRenderableCoords.col&&null!==toRow&&null!==toColumn){const{row:highlightRow,col:highlightColumn}=transformation_assertClassBrand(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,cellRange.highlight),coords=transformation_classPrivateFieldGet(_options,this).createCellCoords(toRow+delta.row,toColumn+delta.col),topStartCorner=cellRange.getTopStartCorner(),topEndCorner=cellRange.getTopEndCorner(),bottomEndCorner=cellRange.getBottomEndCorner();if(delta.col<0&&toColumn>=highlightColumn&&coords.col<highlightColumn){const columnRestDelta=coords.col-highlightColumn;coords.col=transformation_assertClassBrand(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,topStartCorner.col,topEndCorner.col)+columnRestDelta}else if(delta.col>0&&toColumn<=highlightColumn&&coords.col>highlightColumn){const endColumnIndex=transformation_assertClassBrand(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,topEndCorner.col,topStartCorner.col),columnRestDelta=Math.max(coords.col-endColumnIndex,1);coords.col=endColumnIndex+columnRestDelta}if(delta.row<0&&toRow>=highlightRow&&coords.row<highlightRow){const rowRestDelta=coords.row-highlightRow;coords.row=transformation_assertClassBrand(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,topStartCorner.row,bottomEndCorner.row)+rowRestDelta}else if(delta.row>0&&toRow<=highlightRow&&coords.row>highlightRow){const bottomRowIndex=transformation_assertClassBrand(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,bottomEndCorner.row,topStartCorner.row),rowRestDelta=Math.max(coords.row-bottomRowIndex,1);coords.row=bottomRowIndex+rowRestDelta}const{rowDir,colDir}=transformation_assertClassBrand(_Transformation_brand,this,_clampCoords).call(this,coords);rowTransformDir=rowDir,colTransformDir=colDir;const newVisualCoords=transformation_assertClassBrand(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,coords);0===delta.row&&0!==delta.col?visualCoords.col=newVisualCoords.col:0!==delta.row&&0===delta.col?visualCoords.row=newVisualCoords.row:(visualCoords.row=newVisualCoords.row,visualCoords.col=newVisualCoords.col)}return this.runLocalHooks("afterTransformEnd",visualCoords,rowTransformDir,colTransformDir),visualCoords}setOffsetSize(_ref){let{x,y}=_ref;transformation_classPrivateFieldSet(_offset,this,{x,y})}resetOffsetSize(){transformation_classPrivateFieldSet(_offset,this,{x:0,y:0})}}function _clampCoords(zeroBasedCoords){const{width,height}=transformation_assertClassBrand(_Transformation_brand,this,_getTableSize).call(this);let rowDir=0,colDir=0;return zeroBasedCoords.row<0?(rowDir=-1,zeroBasedCoords.row=0):zeroBasedCoords.row>0&&zeroBasedCoords.row>=height&&(rowDir=1,zeroBasedCoords.row=height-1),zeroBasedCoords.col<0?(colDir=-1,zeroBasedCoords.col=0):zeroBasedCoords.col>0&&zeroBasedCoords.col>=width&&(colDir=1,zeroBasedCoords.col=width-1),{rowDir,colDir}}function _getTableSize(){return{width:transformation_classPrivateFieldGet(_offset,this).x+transformation_classPrivateFieldGet(_options,this).countRenderableColumns(),height:transformation_classPrivateFieldGet(_offset,this).y+transformation_classPrivateFieldGet(_options,this).countRenderableRows()}}function _findFirstNonHiddenZeroBasedRow(visualRowFrom,visualRowTo){const row=transformation_classPrivateFieldGet(_options,this).findFirstNonHiddenRenderableRow(visualRowFrom,visualRowTo);return null===row?null:transformation_classPrivateFieldGet(_offset,this).y+row}function _findFirstNonHiddenZeroBasedColumn(visualColumnFrom,visualColumnTo){const column=transformation_classPrivateFieldGet(_options,this).findFirstNonHiddenRenderableColumn(visualColumnFrom,visualColumnTo);return null===column?null:transformation_classPrivateFieldGet(_offset,this).x+column}function _visualToZeroBasedCoords(visualCoords){const{row,col}=transformation_classPrivateFieldGet(_options,this).visualToRenderableCoords(visualCoords);if(null===row||null===col)throw new Error("Renderable coords are not visible.");return transformation_classPrivateFieldGet(_options,this).createCellCoords(transformation_classPrivateFieldGet(_offset,this).y+row,transformation_classPrivateFieldGet(_offset,this).x+col)}function _zeroBasedToVisualCoords(zeroBasedCoords){const coords=zeroBasedCoords.clone();return coords.col=zeroBasedCoords.col-transformation_classPrivateFieldGet(_offset,this).x,coords.row=zeroBasedCoords.row-transformation_classPrivateFieldGet(_offset,this).y,transformation_classPrivateFieldGet(_options,this).renderableToVisualCoords(coords)}(0,object.co)(Transformation,localHooks.A);const transformation=Transformation;var utils=__webpack_require__("./node_modules/handsontable/selection/utils.mjs");function selection_classPrivateFieldInitSpec(e,t,a){(function selection_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function selection_defineProperty(e,r,t){return(r=function selection_toPropertyKey(t){var i=function selection_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function selection_classPrivateFieldGet(s,a){return s.get(selection_assertClassBrand(s,a))}function selection_classPrivateFieldSet(s,a,r){return s.set(selection_assertClassBrand(s,a),r),r}function selection_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _transformation=new WeakMap,_focusTransformation=new WeakMap,_isFocusSelectionChanged=new WeakMap,_disableHeadersHighlight=new WeakMap,_selectionSource=new WeakMap,_expectedLayersCount=new WeakMap;class selection_Selection{constructor(settings,tableProps){var _this=this;selection_defineProperty(this,"settings",void 0),selection_defineProperty(this,"tableProps",void 0),selection_defineProperty(this,"inProgress",!1),selection_defineProperty(this,"selectedRange",new selection_range(((highlight,from,to)=>this.tableProps.createCellRange(highlight,from,to)))),selection_defineProperty(this,"highlight",void 0),selection_classPrivateFieldInitSpec(this,_transformation,void 0),selection_classPrivateFieldInitSpec(this,_focusTransformation,void 0),selection_defineProperty(this,"selectedByRowHeader",new Set),selection_defineProperty(this,"selectedByColumnHeader",new Set),selection_classPrivateFieldInitSpec(this,_isFocusSelectionChanged,!1),selection_classPrivateFieldInitSpec(this,_disableHeadersHighlight,!1),selection_classPrivateFieldInitSpec(this,_selectionSource,"unknown"),selection_classPrivateFieldInitSpec(this,_expectedLayersCount,-1),this.settings=settings,this.tableProps=tableProps,this.highlight=new highlight({headerClassName:settings.currentHeaderClassName,activeHeaderClassName:settings.activeHeaderClassName,rowClassName:settings.currentRowClassName,columnClassName:settings.currentColClassName,cellAttributes:[(0,a11y.H0)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(row,column)=>this.tableProps.isDisabledCellSelection(row,column),cellCornerVisible:function(){return _this.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return _this.isAreaCornerVisible(...arguments)},visualToRenderableCoords:coords=>this.tableProps.visualToRenderableCoords(coords),renderableToVisualCoords:coords=>this.tableProps.renderableToVisualCoords(coords),createCellCoords:(row,column)=>this.tableProps.createCellCoords(row,column),createCellRange:(highlight,from,to)=>this.tableProps.createCellRange(highlight,from,to)}),selection_classPrivateFieldSet(_transformation,this,new transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:coords=>this.tableProps.visualToRenderableCoords(coords),renderableToVisualCoords:coords=>this.tableProps.renderableToVisualCoords(coords),findFirstNonHiddenRenderableRow:function(){return _this.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return _this.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(row,column)=>this.tableProps.createCellCoords(row,column),fixedRowsBottom:()=>settings.fixedRowsBottom,minSpareRows:()=>settings.minSpareRows,minSpareCols:()=>settings.minSpareCols,autoWrapRow:()=>settings.autoWrapRow,autoWrapCol:()=>settings.autoWrapCol})),selection_classPrivateFieldSet(_focusTransformation,this,new transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const range=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,range.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const range=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,range.getOuterBottomEndCorner().col)},visualToRenderableCoords:coords=>this.tableProps.visualToRenderableCoords(coords),renderableToVisualCoords:coords=>this.tableProps.renderableToVisualCoords(coords),findFirstNonHiddenRenderableRow:function(){return _this.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return _this.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(row,column)=>this.tableProps.createCellCoords(row,column),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),selection_classPrivateFieldGet(_transformation,this).addLocalHook("beforeTransformStart",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this.runLocalHooks("beforeModifyTransformStart",...args)})),selection_classPrivateFieldGet(_transformation,this).addLocalHook("afterTransformStart",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return _this.runLocalHooks("afterModifyTransformStart",...args)})),selection_classPrivateFieldGet(_transformation,this).addLocalHook("beforeTransformEnd",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return _this.runLocalHooks("beforeModifyTransformEnd",...args)})),selection_classPrivateFieldGet(_transformation,this).addLocalHook("afterTransformEnd",(function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return _this.runLocalHooks("afterModifyTransformEnd",...args)})),selection_classPrivateFieldGet(_transformation,this).addLocalHook("insertRowRequire",(function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return _this.runLocalHooks("insertRowRequire",...args)})),selection_classPrivateFieldGet(_transformation,this).addLocalHook("insertColRequire",(function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return _this.runLocalHooks("insertColRequire",...args)})),selection_classPrivateFieldGet(_transformation,this).addLocalHook("beforeRowWrap",(function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return _this.runLocalHooks("beforeRowWrap",...args)})),selection_classPrivateFieldGet(_transformation,this).addLocalHook("beforeColumnWrap",(function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return _this.runLocalHooks("beforeColumnWrap",...args)})),selection_classPrivateFieldGet(_focusTransformation,this).addLocalHook("beforeTransformStart",(function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return _this.runLocalHooks("beforeModifyTransformFocus",...args)})),selection_classPrivateFieldGet(_focusTransformation,this).addLocalHook("afterTransformStart",(function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return _this.runLocalHooks("afterModifyTransformFocus",...args)}))}getSelectedRange(){return this.selectedRange}markSource(sourceName){selection_classPrivateFieldSet(_selectionSource,this,sourceName)}markEndSource(){selection_classPrivateFieldSet(_selectionSource,this,"unknown")}getSelectionSource(){return selection_classPrivateFieldGet(_selectionSource,this)}setExpectedLayers(layersCount){selection_classPrivateFieldSet(_expectedLayersCount,this,layersCount)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,selection_classPrivateFieldSet(_expectedLayersCount,this,-1)}isInProgress(){return this.inProgress}setRangeStart(coords,multipleSelection){let fragment=arguments.length>2&&void 0!==arguments[2]&&arguments[2],highlightCoords=arguments.length>3&&void 0!==arguments[3]?arguments[3]:coords;const isMultipleMode="multiple"===this.settings.selectionMode,isMultipleSelection=(0,mixed.b0)(multipleSelection)?this.tableProps.getShortcutManager().isCtrlPressed():multipleSelection,coordsClone=coords.clone();selection_classPrivateFieldSet(_isFocusSelectionChanged,this,!1),this.runLocalHooks("beforeSetRangeStart"+(fragment?"Only":""),coordsClone),(!isMultipleMode||isMultipleMode&&!isMultipleSelection&&(0,mixed.b0)(multipleSelection))&&this.selectedRange.clear(),this.selectedRange.add(coordsClone).current().setHighlight(highlightCoords.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),fragment||this.setRangeEnd(coords)}setRangeStartOnly(coords,multipleSelection){let highlightCoords=arguments.length>2&&void 0!==arguments[2]?arguments[2]:coords;this.setRangeStart(coords,multipleSelection,!0,highlightCoords)}setRangeEnd(coords){if(this.selectedRange.isEmpty())return;const coordsClone=coords.clone(),countRows=this.tableProps.countRows(),countCols=this.tableProps.countCols(),isSingle=this.selectedRange.current().clone().setTo(coords).isSingleHeader();if((countRows>0||countCols>0)&&(0===countRows&&coordsClone.col<0&&!isSingle||0===countCols&&coordsClone.row<0&&!isSingle))return;this.runLocalHooks("beforeSetRangeEnd",coordsClone),this.begin();const cellRange=this.selectedRange.current();if(this.settings.navigableHeaders||cellRange.highlight.normalize(),"single"===this.settings.selectionMode)cellRange.setFrom(cellRange.highlight),cellRange.setTo(cellRange.highlight);else{const horizontalDir=cellRange.getHorizontalDirection(),verticalDir=cellRange.getVerticalDirection(),isMultiple=this.isMultiple();cellRange.setTo(coordsClone),isMultiple&&(horizontalDir!==cellRange.getHorizontalDirection()||1===cellRange.getWidth()&&!cellRange.includes(cellRange.highlight))&&cellRange.from.assign({col:cellRange.highlight.col}),isMultiple&&(verticalDir!==cellRange.getVerticalDirection()||1===cellRange.getHeight()&&!cellRange.includes(cellRange.highlight))&&cellRange.from.assign({row:cellRange.highlight.row})}countRows>0&&countCols>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!cellRange.isSingleHeader())&&cellRange.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const isLastLayer=-1===selection_classPrivateFieldGet(_expectedLayersCount,this)||this.selectedRange.size()===selection_classPrivateFieldGet(_expectedLayersCount,this);this.runLocalHooks("afterSetRangeEnd",coords,isLastLayer)}applyAndCommit(){let cellRange=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),layerLevel=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const countRows=this.tableProps.countRows(),countCols=this.tableProps.countCols();layerLevel<this.highlight.layerLevel&&((0,array.z0)(this.highlight.getAreas(),(highlight=>{highlight.clear()})),(0,array.z0)(this.highlight.getLayeredAreas(),(highlight=>{highlight.clear()})),(0,array.z0)(this.highlight.getRowHeaders(),(highlight=>{highlight.clear()})),(0,array.z0)(this.highlight.getColumnHeaders(),(highlight=>{highlight.clear()})),(0,array.z0)(this.highlight.getActiveRowHeaders(),(highlight=>{highlight.clear()})),(0,array.z0)(this.highlight.getActiveColumnHeaders(),(highlight=>{highlight.clear()})),(0,array.z0)(this.highlight.getActiveCornerHeaders(),(highlight=>{highlight.clear()})),(0,array.z0)(this.highlight.getRowHighlights(),(highlight=>{highlight.clear()})),(0,array.z0)(this.highlight.getColumnHighlights(),(highlight=>{highlight.clear()}))),this.highlight.useLayerLevel(layerLevel);const areaHighlight=this.highlight.createArea(),layeredAreaHighlight=this.highlight.createLayeredArea(),rowHeaderHighlight=this.highlight.createRowHeader(),columnHeaderHighlight=this.highlight.createColumnHeader(),activeRowHeaderHighlight=this.highlight.createActiveRowHeader(),activeColumnHeaderHighlight=this.highlight.createActiveColumnHeader(),activeCornerHeaderHighlight=this.highlight.createActiveCornerHeader(),rowHighlight=this.highlight.createRowHighlight(),columnHighlight=this.highlight.createColumnHighlight();if(areaHighlight.clear(),layeredAreaHighlight.clear(),rowHeaderHighlight.clear(),columnHeaderHighlight.clear(),activeRowHeaderHighlight.clear(),activeColumnHeaderHighlight.clear(),activeCornerHeaderHighlight.clear(),rowHighlight.clear(),columnHighlight.clear(),this.highlight.isEnabledFor(selection_constants.LX,cellRange.highlight)&&(this.isMultiple()||layerLevel>=1)&&(areaHighlight.add(cellRange.from).add(cellRange.to).commit(),layeredAreaHighlight.add(cellRange.from).add(cellRange.to).commit(),1===layerLevel)){const previousRange=this.selectedRange.previous();this.highlight.useLayerLevel(layerLevel-1),this.highlight.createArea().add(previousRange.from).commit().syncWith(previousRange),this.highlight.createLayeredArea().add(previousRange.from).commit().syncWith(previousRange),this.highlight.useLayerLevel(layerLevel)}if(this.highlight.isEnabledFor(selection_constants.PP,cellRange.highlight)){if(!cellRange.isSingleHeader()){const rowCoordsFrom=this.tableProps.createCellCoords(Math.max(cellRange.from.row,0),-1),rowCoordsTo=this.tableProps.createCellCoords(cellRange.to.row,-1),columnCoordsFrom=this.tableProps.createCellCoords(-1,Math.max(cellRange.from.col,0)),columnCoordsTo=this.tableProps.createCellCoords(-1,cellRange.to.col);"single"===this.settings.selectionMode?(rowHeaderHighlight.add(rowCoordsFrom).commit(),columnHeaderHighlight.add(columnCoordsFrom).commit(),rowHighlight.add(rowCoordsFrom).commit(),columnHighlight.add(columnCoordsFrom).commit()):(rowHeaderHighlight.add(rowCoordsFrom).add(rowCoordsTo).commit(),columnHeaderHighlight.add(columnCoordsFrom).add(columnCoordsTo).commit(),rowHighlight.add(rowCoordsFrom).add(rowCoordsTo).commit(),columnHighlight.add(columnCoordsFrom).add(columnCoordsTo).commit())}const highlightRowHeaders=!selection_classPrivateFieldGet(_disableHeadersHighlight,this)&&this.isEntireRowSelected()&&(countCols>0&&countCols===cellRange.getWidth()||0===countCols&&this.isSelectedByRowHeader()),highlightColumnHeaders=!selection_classPrivateFieldGet(_disableHeadersHighlight,this)&&this.isEntireColumnSelected()&&(countRows>0&&countRows===cellRange.getHeight()||0===countRows&&this.isSelectedByColumnHeader());highlightRowHeaders&&activeRowHeaderHighlight.add(this.tableProps.createCellCoords(Math.max(cellRange.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(cellRange.to.row,0),-1)).commit(),highlightColumnHeaders&&activeColumnHeaderHighlight.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(cellRange.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(cellRange.to.col,0))).commit(),highlightRowHeaders&&highlightColumnHeaders&&activeCornerHeaderHighlight.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(coords){if(this.selectedRange.isEmpty())return;const cellRange=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",coords);const focusHighlight=this.highlight.getFocus();focusHighlight.clear(),cellRange.setHighlight(coords),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(selection_constants.Yt,cellRange.highlight)&&focusHighlight.add(cellRange.highlight).commit().syncWith(cellRange),this.inProgress||(selection_classPrivateFieldSet(_isFocusSelectionChanged,this,!0),this.runLocalHooks("afterSetFocus",cellRange.highlight))}transformStart(rowDelta,colDelta){let createMissingRecords=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?selection_classPrivateFieldGet(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):selection_classPrivateFieldGet(_transformation,this).resetOffsetSize(),this.setRangeStart(selection_classPrivateFieldGet(_transformation,this).transformStart(rowDelta,colDelta,createMissingRecords))}transformEnd(rowDelta,colDelta){this.settings.navigableHeaders?selection_classPrivateFieldGet(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):selection_classPrivateFieldGet(_transformation,this).resetOffsetSize(),this.setRangeEnd(selection_classPrivateFieldGet(_transformation,this).transformEnd(rowDelta,colDelta))}transformFocus(rowDelta,colDelta){const range=this.selectedRange.current(),{row,col}=range.getOuterTopStartCorner(),columnsInRange=this.tableProps.countRenderableColumnsInRange(0,col-1),rowsInRange=this.tableProps.countRenderableRowsInRange(0,row-1);range.highlight.isHeader()?selection_classPrivateFieldGet(_focusTransformation,this).setOffsetSize({x:col<0?Math.abs(col):-columnsInRange,y:row<0?Math.abs(row):-rowsInRange}):selection_classPrivateFieldGet(_focusTransformation,this).setOffsetSize({x:col<0?0:-columnsInRange,y:row<0?0:-rowsInRange});const focusCoords=selection_classPrivateFieldGet(_focusTransformation,this).transformStart(rowDelta,colDelta);this.setRangeFocus(focusCoords.normalize())}shiftRows(visualRowIndex,amount){if(!this.isSelected())return;const range=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||range.getOuterTopStartCorner().row>=visualRowIndex){const{from,to,highlight}=range,countRows=this.tableProps.countRows(),isSelectedByRowHeader=this.isSelectedByRowHeader(),isSelectedByColumnHeader=this.isSelectedByColumnHeader(),minRow=isSelectedByColumnHeader?-1:0,coordsStartAmount=isSelectedByColumnHeader?0:amount;this.getSelectedRange().pop();const coordsStart=this.tableProps.createCellCoords((0,number.qE)(from.row+coordsStartAmount,minRow,countRows-1),from.col),coordsEnd=this.tableProps.createCellCoords((0,number.qE)(to.row+amount,minRow,countRows-1),to.col);this.markSource("shift"),highlight.row>=visualRowIndex?this.setRangeStartOnly(coordsStart,!0,this.tableProps.createCellCoords((0,number.qE)(highlight.row+amount,0,countRows-1),highlight.col)):this.setRangeStartOnly(coordsStart,!0),isSelectedByRowHeader&&this.selectedByRowHeader.add(this.getLayerLevel()),isSelectedByColumnHeader&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(coordsEnd),this.markEndSource()}}shiftColumns(visualColumnIndex,amount){if(!this.isSelected())return;const range=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||range.getOuterTopStartCorner().col>=visualColumnIndex){const{from,to,highlight}=range,countCols=this.tableProps.countCols(),isSelectedByRowHeader=this.isSelectedByRowHeader(),isSelectedByColumnHeader=this.isSelectedByColumnHeader(),minColumn=isSelectedByRowHeader?-1:0,coordsStartAmount=isSelectedByRowHeader?0:amount;this.getSelectedRange().pop();const coordsStart=this.tableProps.createCellCoords(from.row,(0,number.qE)(from.col+coordsStartAmount,minColumn,countCols-1)),coordsEnd=this.tableProps.createCellCoords(to.row,(0,number.qE)(to.col+amount,minColumn,countCols-1));this.markSource("shift"),highlight.col>=visualColumnIndex?this.setRangeStartOnly(coordsStart,!0,this.tableProps.createCellCoords(highlight.row,(0,number.qE)(highlight.col+amount,0,countCols-1))):this.setRangeStartOnly(coordsStart,!0),isSelectedByRowHeader&&this.selectedByRowHeader.add(this.getLayerLevel()),isSelectedByColumnHeader&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(coordsEnd),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const isMultipleListener=(0,object.nA)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",isMultipleListener),isMultipleListener.value}isFocusSelectionChanged(){return this.isSelected()&&selection_classPrivateFieldGet(_isFocusSelectionChanged,this)}isSelectedByRowHeader(){let layerLevel=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(layerLevel)&&(-1===layerLevel?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(layerLevel))}isEntireRowSelected(){let layerLevel=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const tester=range=>{const{col}=range.getOuterTopStartCorner(),rowHeaders=this.tableProps.countRowHeaders(),countCols=this.tableProps.countCols();return(rowHeaders>0&&col<0||0===rowHeaders)&&range.getWidth()===countCols};if(-1===layerLevel)return Array.from(this.selectedRange).some((range=>tester(range)));const range=this.selectedRange.peekByIndex(layerLevel);return!!range&&tester(range)}isSelectedByColumnHeader(){let layerLevel=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===layerLevel?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(layerLevel))}isEntireColumnSelected(){let layerLevel=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const tester=range=>{const{row}=range.getOuterTopStartCorner(),colHeaders=this.tableProps.countColHeaders(),countRows=this.tableProps.countRows();return(colHeaders>0&&row<0||0===colHeaders)&&range.getHeight()===countRows};if(-1===layerLevel)return Array.from(this.selectedRange).some((range=>tester(range)));const range=this.selectedRange.peekByIndex(layerLevel);return!!range&&tester(range)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(coords){return this.selectedRange.includes(coords)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(coords){const renderableCoords=this.tableProps.visualToRenderableCoords(coords);return null!==renderableCoords.row&&null!==renderableCoords.col}isAreaCornerVisible(layerLevel){return(!Number.isInteger(layerLevel)||layerLevel===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var _this$getSelectedRang;let includeRowHeaders=arguments.length>0&&void 0!==arguments[0]&&arguments[0],includeColumnHeaders=arguments.length>1&&void 0!==arguments[1]&&arguments[1],options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const nrOfRows=this.tableProps.countRows(),nrOfColumns=this.tableProps.countCols(),countRowHeaders=this.tableProps.countRowHeaders(),countColHeaders=this.tableProps.countColHeaders(),rowFrom=includeColumnHeaders?-countColHeaders:0,columnFrom=includeRowHeaders?-countRowHeaders:0;if(0===rowFrom&&0===columnFrom&&(0===nrOfRows||0===nrOfColumns))return;let highlight=null===(_this$getSelectedRang=this.getSelectedRange().current())||void 0===_this$getSelectedRang?void 0:_this$getSelectedRang.highlight;const{focusPosition,disableHeadersHighlight}=options;selection_classPrivateFieldSet(_disableHeadersHighlight,this,disableHeadersHighlight),focusPosition&&Number.isInteger(null==focusPosition?void 0:focusPosition.row)&&Number.isInteger(null==focusPosition?void 0:focusPosition.col)&&(highlight=this.tableProps.createCellCoords((0,number.qE)(focusPosition.row,rowFrom,nrOfRows-1),(0,number.qE)(focusPosition.col,columnFrom,nrOfColumns-1)));const startCoords=this.tableProps.createCellCoords(rowFrom,columnFrom),endCoords=this.tableProps.createCellCoords(nrOfRows-1,nrOfColumns-1);this.clear(),this.setRangeStartOnly(startCoords,void 0,highlight),columnFrom<0&&this.selectedByRowHeader.add(this.getLayerLevel()),rowFrom<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(endCoords),this.finish(),selection_classPrivateFieldSet(_disableHeadersHighlight,this,!1)}selectCells(selectionRanges){var _this2=this;const selectionType=(0,utils.ML)(selectionRanges);if(selectionType===utils.Qz)return!1;if(selectionType===utils.ay)throw new Error(templateLiteralTag.O`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const selectionSchemaNormalizer=(0,utils._e)(selectionType,{createCellCoords:function(){return _this2.tableProps.createCellCoords(...arguments)},createCellRange:function(){return _this2.tableProps.createCellRange(...arguments)},propToCol:prop=>this.tableProps.propToCol(prop),keepDirection:!0}),navigableHeaders=this.settings.navigableHeaders,tableParams={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:navigableHeaders?this.tableProps.countRowHeaders():0,countColHeaders:navigableHeaders?this.tableProps.countColHeaders():0},isValid=!selectionRanges.some((selection=>{const cellRange=selectionSchemaNormalizer(selection),rangeValidity=cellRange.isValid(tableParams);return!(rangeValidity&&!cellRange.containsHeaders()||rangeValidity&&cellRange.containsHeaders()&&cellRange.isSingleHeader())}));return isValid&&(this.clear(),this.setExpectedLayers(selectionRanges.length),(0,array.z0)(selectionRanges,(selection=>{const{from,to}=selectionSchemaNormalizer(selection);this.setRangeStartOnly(from.clone(),!1),this.setRangeEnd(to.clone())})),this.finish()),isValid}selectColumns(startColumn){let endColumn=arguments.length>1&&void 0!==arguments[1]?arguments[1]:startColumn,focusPosition=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const start="string"==typeof startColumn?this.tableProps.propToCol(startColumn):startColumn,end="string"==typeof endColumn?this.tableProps.propToCol(endColumn):endColumn,countRows=this.tableProps.countRows(),countCols=this.tableProps.countCols(),countColHeaders=this.tableProps.countColHeaders(),columnHeaderLastIndex=0===countColHeaders?0:-countColHeaders,fromCoords=this.tableProps.createCellCoords(columnHeaderLastIndex,start),toCoords=this.tableProps.createCellCoords(countRows-1,end),isValid=this.tableProps.createCellRange(fromCoords,fromCoords,toCoords).isValid({countRows,countCols,countRowHeaders:0,countColHeaders});if(isValid){let highlightRow=0,highlightColumn=0;Number.isInteger(null==focusPosition?void 0:focusPosition.row)&&Number.isInteger(null==focusPosition?void 0:focusPosition.col)?(highlightRow=(0,number.qE)(focusPosition.row,columnHeaderLastIndex,countRows-1),highlightColumn=(0,number.qE)(focusPosition.col,Math.min(start,end),Math.max(start,end))):(highlightRow=(0,number.qE)(focusPosition,columnHeaderLastIndex,countRows-1),highlightColumn=start);const highlight=this.tableProps.createCellCoords(highlightRow,highlightColumn),fromRow=0===countColHeaders?0:(0,number.qE)(highlight.row,columnHeaderLastIndex,-1),toRow=countRows-1,from=this.tableProps.createCellCoords(fromRow,start),to=this.tableProps.createCellCoords(toRow,end);this.runLocalHooks("beforeSelectColumns",from,to,highlight),from.row=fromRow,to.row=toRow,this.setRangeStartOnly(from,void 0,highlight),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(to),this.runLocalHooks("afterSelectColumns",from,to,highlight),this.finish()}return isValid}selectRows(startRow){let endRow=arguments.length>1&&void 0!==arguments[1]?arguments[1]:startRow,focusPosition=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const countRows=this.tableProps.countRows(),countCols=this.tableProps.countCols(),countRowHeaders=this.tableProps.countRowHeaders(),rowHeaderLastIndex=0===countRowHeaders?0:-countRowHeaders,fromCoords=this.tableProps.createCellCoords(startRow,rowHeaderLastIndex),toCoords=this.tableProps.createCellCoords(endRow,countCols-1),isValid=this.tableProps.createCellRange(fromCoords,fromCoords,toCoords).isValid({countRows,countCols,countRowHeaders,countColHeaders:0});if(isValid){let highlightRow=0,highlightColumn=0;Number.isInteger(null==focusPosition?void 0:focusPosition.row)&&Number.isInteger(null==focusPosition?void 0:focusPosition.col)?(highlightRow=(0,number.qE)(focusPosition.row,Math.min(startRow,endRow),Math.max(startRow,endRow)),highlightColumn=(0,number.qE)(focusPosition.col,rowHeaderLastIndex,countCols-1)):(highlightRow=startRow,highlightColumn=(0,number.qE)(focusPosition,rowHeaderLastIndex,countCols-1));const highlight=this.tableProps.createCellCoords(highlightRow,highlightColumn),fromColumn=0===countRowHeaders?0:(0,number.qE)(highlight.col,rowHeaderLastIndex,-1),toColumn=countCols-1,from=this.tableProps.createCellCoords(startRow,fromColumn),to=this.tableProps.createCellCoords(endRow,toColumn);this.runLocalHooks("beforeSelectRows",from,to,highlight),from.col=fromColumn,to.col=toColumn,this.setRangeStartOnly(from,void 0,highlight),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(to),this.runLocalHooks("afterSelectRows",from,to,highlight),this.finish()}return isValid}refresh(){if(!this.isSelected())return;const countRows=this.tableProps.countRows(),countColumns=this.tableProps.countCols();if(0===countRows||0===countColumns)return void this.deselect();const range=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from,to,highlight}=range;this.clear(),highlight.assign({row:(0,number.qE)(highlight.row,-1/0,countRows-1),col:(0,number.qE)(highlight.col,-1/0,countColumns-1)}),from.assign({row:(0,number.qE)(from.row,-1/0,countRows-1),col:(0,number.qE)(from.col,-1/0,countColumns-1)}),to.assign({row:(0,number.qE)(to.row,0,countRows-1),col:(0,number.qE)(to.col,0,countColumns-1)}),this.selectedRange.ranges.push(range),this.highlight.getFocus().add(highlight).commit().syncWith(range),this.applyAndCommit(range)}commit(){if(this.highlight.getCustomSelections().forEach((customSelection=>{customSelection.commit()})),!this.isSelected())return;const currentLayer=this.getLayerLevel(),cellRange=this.selectedRange.current();this.highlight.isEnabledFor(selection_constants.Yt,cellRange.highlight)&&this.highlight.getFocus().commit().syncWith(cellRange);for(let layerLevel=0;layerLevel<this.selectedRange.size();layerLevel+=1){this.highlight.useLayerLevel(layerLevel);const areaHighlight=this.highlight.createArea(),areaLayeredHighlight=this.highlight.createLayeredArea(),rowHeaderHighlight=this.highlight.createRowHeader(),columnHeaderHighlight=this.highlight.createColumnHeader(),activeRowHeaderHighlight=this.highlight.createActiveRowHeader(),activeColumnHeaderHighlight=this.highlight.createActiveColumnHeader(),activeCornerHeaderHighlight=this.highlight.createActiveCornerHeader(),rowHighlight=this.highlight.createRowHighlight(),columnHighlight=this.highlight.createColumnHighlight();areaHighlight.commit(),areaLayeredHighlight.commit(),rowHeaderHighlight.commit(),columnHeaderHighlight.commit(),activeRowHeaderHighlight.commit(),activeColumnHeaderHighlight.commit(),activeCornerHeaderHighlight.commit(),rowHighlight.commit(),columnHighlight.commit()}this.highlight.useLayerLevel(currentLayer)}}(0,object.co)(selection_Selection,localHooks.A);const selection_selection=selection_Selection;var cellTypes_registry=__webpack_require__("./node_modules/handsontable/cellTypes/registry.mjs");function extendByMetaType(metaObject,settings){let settingsToCompareWith=arguments.length>2&&void 0!==arguments[2]?arguments[2]:metaObject;const validType="string"==typeof settings.type?(0,cellTypes_registry.r0)(settings.type):settings.type;if(metaObject._automaticallyAssignedMetaProps&&(0,object.v4)(settings,((value,key)=>{metaObject._automaticallyAssignedMetaProps.delete(key)})),!(0,object.Gv)(validType))return;settingsToCompareWith!==metaObject||metaObject._automaticallyAssignedMetaProps||(metaObject._automaticallyAssignedMetaProps=new Set);const expandedType={};(0,object.v4)(validType,((value,property)=>{var _metaObject$_automati2;(function canBeOverwritten(propertyName,metaObject){var _metaObject$_automati;return"CELL_TYPE"!==propertyName&&((null===(_metaObject$_automati=metaObject._automaticallyAssignedMetaProps)||void 0===_metaObject$_automati?void 0:_metaObject$_automati.has(propertyName))||!(0,object.mQ)(metaObject,propertyName))})(property,settingsToCompareWith)&&(expandedType[property]=value,null===(_metaObject$_automati2=metaObject._automaticallyAssignedMetaProps)||void 0===_metaObject$_automati2||_metaObject$_automati2.add(property))})),(0,object.X$)(metaObject,expandedType)}function isUnsignedNumber(value){return Number.isInteger(value)&&value>=0}function assert(condition,errorMessage){if(!condition())throw new Error(`Assertion failed: ${errorMessage}`)}function isNullish(variable){return null==variable}const metaSchema=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(col){let row,rowLen,value;for(row=0,rowLen=this.countRows();row<rowLen;row++)if(value=this.getDataAtCell(row,col),!1===(0,mixed.Im)(value))return!1;return!0},isEmptyRow(row){let col,colLen,value,meta;for(col=0,colLen=this.countCols();col<colLen;col++)if(value=this.getDataAtCell(row,col),!1===(0,mixed.Im)(value))return"object"==typeof value&&(meta=this.getCellMeta(row,col),(0,object.wU)(this.getSchema()[meta.prop],value));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function globalMeta_defineProperty(e,r,t){return(r=function globalMeta_toPropertyKey(t){var i=function globalMeta_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class GlobalMeta{constructor(hot){globalMeta_defineProperty(this,"metaCtor",class TableMeta{}),globalMeta_defineProperty(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,object.X$)(this.meta,metaSchema()),this.meta.instance=hot}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(settings){var _settings$type;(0,object.X$)(this.meta,settings),extendByMetaType(this.meta,{...settings,type:null!==(_settings$type=settings.type)&&void 0!==_settings$type?_settings$type:this.meta.type},settings)}}function tableMeta_defineProperty(e,r,t){return(r=function tableMeta_toPropertyKey(t){var i=function tableMeta_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class TableMeta{constructor(globalMeta){tableMeta_defineProperty(this,"meta",void 0);const MetaCtor=globalMeta.getMetaConstructor();this.meta=new MetaCtor}getMeta(){return this.meta}updateMeta(settings){(0,object.X$)(this.meta,settings),extendByMetaType(this.meta,settings,settings)}}function lazyFactoryMap_defineProperty(e,r,t){return(r=function lazyFactoryMap_toPropertyKey(t){var i=function lazyFactoryMap_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class LazyFactoryMap{constructor(valueFactory){lazyFactoryMap_defineProperty(this,"valueFactory",void 0),lazyFactoryMap_defineProperty(this,"data",[]),lazyFactoryMap_defineProperty(this,"index",[]),lazyFactoryMap_defineProperty(this,"holes",new Set),this.valueFactory=valueFactory}obtain(key){assert((()=>isUnsignedNumber(key)),"Expecting an unsigned number.");const dataIndex=this._getStorageIndexByKey(key);let result;if(dataIndex>=0)result=this.data[dataIndex],void 0===result&&(result=this.valueFactory(key),this.data[dataIndex]=result);else if(result=this.valueFactory(key),this.holes.size>0){const reuseIndex=this.holes.values().next().value;this.holes.delete(reuseIndex),this.data[reuseIndex]=result,this.index[key]=reuseIndex}else this.data.push(result),this.index[key]=this.data.length-1;return result}insert(key){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;assert((()=>isUnsignedNumber(key)||isNullish(key)),"Expecting an unsigned number or null/undefined argument.");const newIndexes=[],dataLength=this.data.length;for(let i=0;i<amount;i++)newIndexes.push(dataLength+i),this.data.push(void 0);const insertionIndex=isNullish(key)?this.index.length:key;this.index=[...this.index.slice(0,insertionIndex),...newIndexes,...this.index.slice(insertionIndex)]}remove(key){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;assert((()=>isUnsignedNumber(key)||isNullish(key)),"Expecting an unsigned number or null/undefined argument.");const removed=this.index.splice(isNullish(key)?this.index.length-amount:key,amount);for(let i=0;i<removed.length;i++){const removedIndex=removed[i];"number"==typeof removedIndex&&this.holes.add(removedIndex)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter(((meta,index)=>void 0!==meta&&!this.holes.has(index)))[Symbol.iterator]()}entries(){const validEntries=[];for(let i=0;i<this.data.length;i++){const keyIndex=this._getKeyByStorageIndex(i);-1!==keyIndex&&void 0!==this.data[i]&&validEntries.push([keyIndex,this.data[i]])}let dataIndex=0;return{next:()=>{if(dataIndex<validEntries.length){const value=validEntries[dataIndex];return dataIndex+=1,{value,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(key){return this.index.length>key?this.index[key]:-1}_getKeyByStorageIndex(dataIndex){return this.index.indexOf(dataIndex)}[Symbol.iterator](){return this.entries()}}function columnMeta_defineProperty(e,r,t){return(r=function columnMeta_toPropertyKey(t){var i=function columnMeta_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const COLUMNS_PROPS_CONFLICTS=["data","width"];class ColumnMeta{constructor(globalMeta){columnMeta_defineProperty(this,"globalMeta",void 0),columnMeta_defineProperty(this,"metas",new LazyFactoryMap((()=>this._createMeta()))),this.globalMeta=globalMeta,this.metas=new LazyFactoryMap((()=>this._createMeta()))}updateMeta(physicalColumn,settings){const meta=this.getMeta(physicalColumn);(0,object.X$)(meta,settings),extendByMetaType(meta,settings)}createColumn(physicalColumn,amount){this.metas.insert(physicalColumn,amount)}removeColumn(physicalColumn,amount){this.metas.remove(physicalColumn,amount)}getMeta(physicalColumn){return this.metas.obtain(physicalColumn)}getMetaConstructor(physicalColumn){return this.metas.obtain(physicalColumn).constructor}clearCache(){this.metas.clear()}_createMeta(){return function columnFactory(TableMeta){let conflictList=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function ColumnMeta(){}(0,object.IL)(ColumnMeta,TableMeta);for(let i=0;i<conflictList.length;i++)ColumnMeta.prototype[conflictList[i]]=void 0;return ColumnMeta}(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}}function cellMeta_defineProperty(e,r,t){return(r=function cellMeta_toPropertyKey(t){var i=function cellMeta_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class CellMeta{constructor(columnMeta){cellMeta_defineProperty(this,"columnMeta",void 0),cellMeta_defineProperty(this,"metas",new LazyFactoryMap((()=>this._createRow()))),this.columnMeta=columnMeta}updateMeta(physicalRow,physicalColumn,settings){const meta=this.getMeta(physicalRow,physicalColumn);(0,object.X$)(meta,settings),extendByMetaType(meta,settings)}createRow(physicalRow,amount){this.metas.insert(physicalRow,amount)}createColumn(physicalColumn,amount){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(physicalColumn,amount)}removeRow(physicalRow,amount){this.metas.remove(physicalRow,amount)}removeColumn(physicalColumn,amount){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(physicalColumn,amount)}getMeta(physicalRow,physicalColumn,key){const cellMeta=this.metas.obtain(physicalRow).obtain(physicalColumn);return void 0===key?cellMeta:cellMeta[key]}setMeta(physicalRow,physicalColumn,key,value){var _cellMeta$_automatica;const cellMeta=this.metas.obtain(physicalRow).obtain(physicalColumn);null===(_cellMeta$_automatica=cellMeta._automaticallyAssignedMetaProps)||void 0===_cellMeta$_automatica||_cellMeta$_automatica.delete(key),cellMeta[key]=value}removeMeta(physicalRow,physicalColumn,key){delete this.metas.obtain(physicalRow).obtain(physicalColumn)[key]}getMetas(){const metas=[],rows=Array.from(this.metas.values());for(let row=0;row<rows.length;row++)(0,mixed.O9)(rows[row])&&metas.push(...rows[row].values());return metas}getMetasAtRow(physicalRow){assert((()=>isUnsignedNumber(physicalRow)),"Expecting an unsigned number.");const rowsMeta=new Map(this.metas);return rowsMeta.has(physicalRow)?Array.from(rowsMeta.get(physicalRow).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LazyFactoryMap((physicalColumn=>this._createMeta(physicalColumn)))}_createMeta(physicalColumn){return new(this.columnMeta.getMetaConstructor(physicalColumn))}}class MetaManager{constructor(hot){let customSettings=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},metaMods=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=hot,this.globalMeta=new GlobalMeta(hot),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),metaMods.forEach((ModifierClass=>new ModifierClass(this))),this.globalMeta.updateMeta(customSettings)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(settings){this.globalMeta.updateMeta(settings)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(settings){this.tableMeta.updateMeta(settings)}getColumnMeta(physicalColumn){return this.columnMeta.getMeta(physicalColumn)}updateColumnMeta(physicalColumn,settings){this.columnMeta.updateMeta(physicalColumn,settings)}getCellMeta(physicalRow,physicalColumn,_ref){let{visualRow,visualColumn}=_ref;const cellMeta=this.cellMeta.getMeta(physicalRow,physicalColumn);return cellMeta.visualRow=visualRow,cellMeta.visualCol=visualColumn,cellMeta.row=physicalRow,cellMeta.col=physicalColumn,this.runLocalHooks("afterGetCellMeta",cellMeta),cellMeta}getCellMetaKeyValue(physicalRow,physicalColumn,key){if("string"!=typeof key)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(physicalRow,physicalColumn,key)}setCellMeta(physicalRow,physicalColumn,key,value){this.cellMeta.setMeta(physicalRow,physicalColumn,key,value)}updateCellMeta(physicalRow,physicalColumn,settings){this.cellMeta.updateMeta(physicalRow,physicalColumn,settings)}removeCellMeta(physicalRow,physicalColumn,key){this.cellMeta.removeMeta(physicalRow,physicalColumn,key)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(physicalRow){return this.cellMeta.getMetasAtRow(physicalRow)}createRow(physicalRow){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(physicalRow,amount)}removeRow(physicalRow){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(physicalRow,amount)}createColumn(physicalColumn){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(physicalColumn,amount),this.columnMeta.createColumn(physicalColumn,amount)}removeColumn(physicalColumn){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(physicalColumn,amount),this.columnMeta.removeColumn(physicalColumn,amount)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function dynamicCellMeta_defineProperty(e,r,t){return(r=function dynamicCellMeta_toPropertyKey(t){var i=function dynamicCellMeta_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}(0,object.co)(MetaManager,localHooks.A);class DynamicCellMetaMod{constructor(metaManager){dynamicCellMeta_defineProperty(this,"metaManager",void 0),dynamicCellMeta_defineProperty(this,"metaSyncMemo",new Map),this.metaManager=metaManager,metaManager.addLocalHook("afterGetCellMeta",(cellMeta=>this.extendCellMeta(cellMeta))),hooks.R.getSingleton().add("beforeRender",(forceFullRender=>{forceFullRender&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(cellMeta){var _this$metaSyncMemo$ge;const{row:physicalRow,col:physicalColumn}=cellMeta;if(null!==(_this$metaSyncMemo$ge=this.metaSyncMemo.get(physicalRow))&&void 0!==_this$metaSyncMemo$ge&&_this$metaSyncMemo$ge.has(physicalColumn))return;const{visualRow,visualCol}=cellMeta,hot=this.metaManager.hot,prop=hot.colToProp(visualCol);cellMeta.prop=prop,hot.runHooks("beforeGetCellMeta",visualRow,visualCol,cellMeta);const cellType=(0,object.mQ)(cellMeta,"type")?cellMeta.type:null;let cellSettings=(0,helpers_function.Tn)(cellMeta.cells)?cellMeta.cells(physicalRow,physicalColumn,prop):null;var _cellSettings$type;cellType&&(cellSettings?cellSettings.type=null!==(_cellSettings$type=cellSettings.type)&&void 0!==_cellSettings$type?_cellSettings$type:cellType:cellSettings={type:cellType});cellSettings&&this.metaManager.updateCellMeta(physicalRow,physicalColumn,cellSettings),hot.runHooks("afterGetCellMeta",visualRow,visualCol,cellMeta),this.metaSyncMemo.has(physicalRow)||this.metaSyncMemo.set(physicalRow,new Set),this.metaSyncMemo.get(physicalRow).add(physicalColumn)}}function extendMetaProperties_classPrivateFieldInitSpec(e,t,a){(function extendMetaProperties_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function extendMetaProperties_defineProperty(e,r,t){return(r=function extendMetaProperties_toPropertyKey(t){var i=function extendMetaProperties_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function extendMetaProperties_classPrivateFieldGet(s,a){return s.get(function extendMetaProperties_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(s,a))}var _initOnlyCallback=new WeakMap;class ExtendMetaPropertiesMod{constructor(metaManager){extendMetaProperties_defineProperty(this,"metaManager",void 0),extendMetaProperties_defineProperty(this,"usageTracker",new Set),extendMetaProperties_defineProperty(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(propName){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===propName)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),extendMetaProperties_classPrivateFieldInitSpec(this,_initOnlyCallback,((propName,value,isInitialChange)=>{if(!isInitialChange)throw new Error(`The \`${propName}\` option can not be updated after the Handsontable is initialized.`)})),this.metaManager=metaManager,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((descriptor,alias)=>{const{initOnly,target,onChange}=descriptor,hasTarget="string"==typeof target,targetProp=hasTarget?target:alias,origProp=`_${targetProp}`;this.metaManager.globalMeta.meta[origProp]=this.metaManager.globalMeta.meta[targetProp],onChange?(this.installPropWatcher(alias,origProp,onChange),hasTarget&&this.installPropWatcher(target,origProp,onChange)):initOnly&&(this.installPropWatcher(alias,origProp,extendMetaProperties_classPrivateFieldGet(_initOnlyCallback,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(alias))}))}installPropWatcher(propName,origProp,onChange){const self=this;Object.defineProperty(this.metaManager.globalMeta.meta,propName,{get(){return this[origProp]},set(value){const isInitialChange=!self.usageTracker.has(propName);self.usageTracker.add(propName),onChange.call(self,propName,value,isInitialChange),this[origProp]=value},enumerable:!0,configurable:!0})}}var SheetClip=__webpack_require__("./node_modules/handsontable/3rdparty/SheetClip/SheetClip.mjs");function dataMap_defineProperty(e,r,t){return(r=function dataMap_toPropertyKey(t){var i=function dataMap_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class DataMap{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(hotInstance,data,metaManager){dataMap_defineProperty(this,"hot",void 0),dataMap_defineProperty(this,"metaManager",void 0),dataMap_defineProperty(this,"tableMeta",void 0),dataMap_defineProperty(this,"dataSource",void 0),dataMap_defineProperty(this,"duckSchema",void 0),dataMap_defineProperty(this,"colToPropCache",void 0),dataMap_defineProperty(this,"propToColCache",void 0),this.hot=hotInstance,this.metaManager=metaManager,this.tableMeta=metaManager.getTableMeta(),this.dataSource=data,this.refreshDuckSchema(),this.createMap()}createMap(){const schema=this.getSchema();if(void 0===schema)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const columns=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,columns){let columnsLen=0,filteredIndex=0,columnsAsFunc=!1;if("function"==typeof columns){const schemaLen=(0,object.$3)(schema);columnsLen=schemaLen>0?schemaLen:this.countFirstRowKeys(),columnsAsFunc=!0}else{const maxCols=this.tableMeta.maxCols;columnsLen=Math.min(maxCols,columns.length)}for(i=0;i<columnsLen;i++){const column=columnsAsFunc?columns(i):columns[i];if((0,object.Gv)(column)){if(void 0!==column.data){const index=columnsAsFunc?filteredIndex:i;this.colToPropCache[index]=column.data,this.propToColCache.set(column.data,index)}filteredIndex+=1}}}else this.recursiveDuckColumns(schema)}countFirstRowKeys(){return(0,data.E)(this.dataSource)}recursiveDuckColumns(schema,lastCol,parent){let prop,lastColumn=lastCol,propertyParent=parent;return void 0===lastColumn&&(lastColumn=0,propertyParent=""),"object"!=typeof schema||Array.isArray(schema)||(0,object.v4)(schema,((value,key)=>{null===value?(prop=propertyParent+key,this.colToPropCache.push(prop),this.propToColCache.set(prop,lastColumn),lastColumn+=1):lastColumn=this.recursiveDuckColumns(value,lastColumn,`${key}.`)})),lastColumn}colToProp(column){if(!1===Number.isInteger(column))return column;const physicalColumn=this.hot.toPhysicalColumn(column);return null===physicalColumn?column:this.colToPropCache&&(0,mixed.O9)(this.colToPropCache[physicalColumn])?this.colToPropCache[physicalColumn]:physicalColumn}propToCol(prop){const cachedPhysicalIndex=this.propToColCache.get(prop);if((0,mixed.O9)(cachedPhysicalIndex))return this.hot.toVisualColumn(cachedPhysicalIndex);const visualColumn=this.hot.toVisualColumn(prop);return null===visualColumn?prop:visualColumn}getSchema(){const schema=this.tableMeta.dataSchema;return schema?"function"==typeof schema?schema():schema:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,object.Nl)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(index){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source,mode="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const sourceRowsCount=this.hot.countSourceRows();let physicalRowIndex=sourceRowsCount,numberOfCreatedRows=0,rowIndex=index;("number"!=typeof rowIndex||rowIndex>=sourceRowsCount)&&(rowIndex=sourceRowsCount),rowIndex<this.hot.countRows()&&(physicalRowIndex=this.hot.toPhysicalRow(rowIndex));if(!1===this.hot.runHooks("beforeCreateRow",rowIndex,amount,source)||null===physicalRowIndex)return{delta:0};const maxRows=this.tableMeta.maxRows,columnCount=this.getSchema().length,rowsToAdd=[];for(;numberOfCreatedRows<amount&&sourceRowsCount+numberOfCreatedRows<maxRows;){let row=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?row=(0,object.Go)(this.getSchema()):(row=[],(0,number.Ti)(columnCount-1,(()=>row.push(null)))):"function"===this.hot.dataType?row=this.tableMeta.dataSchema(rowIndex+numberOfCreatedRows):(row={},(0,object.zw)(row,this.getSchema())),rowsToAdd.push(row),numberOfCreatedRows+=1}this.hot.rowIndexMapper.insertIndexes(rowIndex,numberOfCreatedRows),"below"===mode&&(physicalRowIndex=Math.min(physicalRowIndex+1,sourceRowsCount)),this.spliceData(physicalRowIndex,0,rowsToAdd);const newVisualRowIndex=this.hot.toVisualRow(physicalRowIndex);return this.hot.countSourceRows()===rowsToAdd.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),numberOfCreatedRows>0&&(null==index?this.metaManager.createRow(null,numberOfCreatedRows):"auto"!==source&&this.metaManager.createRow(physicalRowIndex,amount)),this.hot.runHooks("afterCreateRow",newVisualRowIndex,numberOfCreatedRows,source),this.hot.forceFullRender=!0,{delta:numberOfCreatedRows,startPhysicalIndex:physicalRowIndex}}createCol(index){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source,mode="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const dataSource=this.dataSource,maxCols=this.tableMeta.maxCols,countSourceCols=this.hot.countSourceCols();let columnIndex=index;("number"!=typeof columnIndex||columnIndex>=countSourceCols)&&(columnIndex=countSourceCols);if(!1===this.hot.runHooks("beforeCreateCol",columnIndex,amount,source))return{delta:0};let physicalColumnIndex=countSourceCols;columnIndex<this.hot.countCols()&&(physicalColumnIndex=this.hot.toPhysicalColumn(columnIndex));const numberOfSourceRows=this.hot.countSourceRows();let nrOfColumns=this.hot.countCols(),numberOfCreatedCols=0,currentIndex=physicalColumnIndex;"end"===mode&&(currentIndex=Math.min(currentIndex+1,countSourceCols));const startPhysicalIndex=currentIndex;for(;numberOfCreatedCols<amount&&nrOfColumns<maxCols;){if("number"!=typeof columnIndex||columnIndex>=nrOfColumns)if(numberOfSourceRows>0)for(let row=0;row<numberOfSourceRows;row+=1)void 0===dataSource[row]&&(dataSource[row]=[]),dataSource[row].push(null);else dataSource.push([null]);else for(let row=0;row<numberOfSourceRows;row++)dataSource[row].splice(currentIndex,0,null);numberOfCreatedCols+=1,currentIndex+=1,nrOfColumns+=1}this.hot.columnIndexMapper.insertIndexes(columnIndex,numberOfCreatedCols),numberOfCreatedCols>0&&(null==index?this.metaManager.createColumn(null,numberOfCreatedCols):"auto"!==source&&this.metaManager.createColumn(startPhysicalIndex,amount));const newVisualColumnIndex=this.hot.toVisualColumn(startPhysicalIndex);return this.hot.runHooks("afterCreateCol",newVisualColumnIndex,numberOfCreatedCols,source),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:numberOfCreatedCols,startPhysicalIndex}}removeRow(index){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,rowIndex=Number.isInteger(index)?index:-amount;const removedPhysicalIndexes=this.visualRowsToPhysical(rowIndex,amount),sourceRowsLength=this.hot.countSourceRows();rowIndex=(sourceRowsLength+rowIndex)%sourceRowsLength;if(!1===this.hot.runHooks("beforeRemoveRow",rowIndex,removedPhysicalIndexes.length,removedPhysicalIndexes,source))return!1;const numberOfRemovedIndexes=removedPhysicalIndexes.length;if(this.filterData(rowIndex,numberOfRemovedIndexes,removedPhysicalIndexes),rowIndex<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(removedPhysicalIndexes);const preserveColumns=(0,mixed.O9)(this.tableMeta.columns)||(0,mixed.O9)(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;0!==this.hot.rowIndexMapper.getNotTrimmedIndexesLength()||preserveColumns||this.hot.columnIndexMapper.setIndexesSequence([])}return removedPhysicalIndexes.slice(0).sort(((a,b)=>b-a)).forEach((rowPhysicalIndex=>{this.metaManager.removeRow(rowPhysicalIndex,1)})),this.hot.runHooks("afterRemoveRow",rowIndex,numberOfRemovedIndexes,removedPhysicalIndexes,source),this.hot.forceFullRender=!0,!0}removeCol(index){let amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let columnIndex="number"!=typeof index?-amount:index;columnIndex=(this.hot.countCols()+columnIndex)%this.hot.countCols();const removedPhysicalIndexes=this.visualColumnsToPhysical(columnIndex,amount),descendingPhysicalColumns=removedPhysicalIndexes.slice(0).sort(((a,b)=>b-a));if(!1===this.hot.runHooks("beforeRemoveCol",columnIndex,amount,removedPhysicalIndexes,source))return!1;let isTableUniform=!0;const removedColumnsCount=descendingPhysicalColumns.length,data=this.dataSource;for(let c=0;c<removedColumnsCount;c++)isTableUniform&&removedPhysicalIndexes[0]!==removedPhysicalIndexes[c]-c&&(isTableUniform=!1);if(isTableUniform)for(let r=0,rlen=this.hot.countSourceRows();r<rlen;r++)data[r].splice(removedPhysicalIndexes[0],amount),0===r&&this.metaManager.removeColumn(removedPhysicalIndexes[0],amount);else for(let r=0,rlen=this.hot.countSourceRows();r<rlen;r++)for(let c=0;c<removedColumnsCount;c++)data[r].splice(descendingPhysicalColumns[c],1),0===r&&this.metaManager.removeColumn(descendingPhysicalColumns[c],1);return columnIndex<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(removedPhysicalIndexes),this.tableMeta.rowHeaders||0!==this.hot.columnIndexMapper.getNotTrimmedIndexesLength()||this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",columnIndex,amount,removedPhysicalIndexes,source),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(col,index,amount){const colData=this.hot.getDataAtCol(col),removed=colData.slice(index,index+amount),after=colData.slice(index+amount);for(var _len=arguments.length,elements=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++)elements[_key-3]=arguments[_key];(0,array.Sh)(elements,after);let i=0;for(;i<amount;)elements.push(null),i+=1;return(0,array.Zz)(elements),this.hot.populateFromArray(index,col,elements,null,null,"spliceCol"),removed}spliceRow(row,index,amount){const rowData=this.hot.getSourceDataAtRow(row),removed=rowData.slice(index,index+amount),after=rowData.slice(index+amount);for(var _len2=arguments.length,elements=new Array(_len2>3?_len2-3:0),_key2=3;_key2<_len2;_key2++)elements[_key2-3]=arguments[_key2];(0,array.Sh)(elements,after);let i=0;for(;i<amount;)elements.push(null),i+=1;return this.hot.populateFromArray(row,index,[elements],null,null,"spliceRow"),removed}spliceData(index,deleteCount,elements){if(!1!==this.hot.runHooks("beforeDataSplice",index,deleteCount,elements)){const newData=[...this.dataSource.slice(0,index),...elements,...this.dataSource.slice(index)];this.dataSource.length=0,newData.forEach((row=>this.dataSource.push(row)))}}filterData(index,amount,physicalRows){let data=this.hot.runHooks("filterData",index,amount,physicalRows);!1===Array.isArray(data)&&(data=this.dataSource.filter(((row,rowIndex)=>-1===physicalRows.indexOf(rowIndex)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,data)}get(row,prop){const physicalRow=this.hot.toPhysicalRow(row);let dataRow=this.dataSource[physicalRow];const modifiedRowData=this.hot.runHooks("modifyRowData",physicalRow);dataRow=isNaN(modifiedRowData)?modifiedRowData:dataRow;const{dataDotNotation}=this.hot.getSettings();let value=null;if(dataRow&&dataRow.hasOwnProperty&&(0,object.mQ)(dataRow,prop))value=dataRow[prop];else if(dataDotNotation&&"string"==typeof prop&&prop.indexOf(".")>-1){let out=dataRow;if(!out)return null;const sliced=prop.split(".");for(let i=0,ilen=sliced.length;i<ilen;i++)if(out=out[sliced[i]],void 0===out)return null;value=out}else"function"==typeof prop&&(value=prop(this.dataSource.slice(physicalRow,physicalRow+1)[0]));if(this.hot.hasHook("modifyData")){const valueHolder=(0,object.nA)(value);this.hot.runHooks("modifyData",physicalRow,this.propToCol(prop),valueHolder,"get"),valueHolder.isTouched()&&(value=valueHolder.value)}return value}getCopyable(row,prop){return this.hot.getCellMeta(row,this.propToCol(prop)).copyable?this.get(row,prop):""}set(row,prop,value){const physicalRow=this.hot.toPhysicalRow(row);let newValue=value,dataRow=this.dataSource[physicalRow];const modifiedRowData=this.hot.runHooks("modifyRowData",physicalRow);if(dataRow=isNaN(modifiedRowData)?modifiedRowData:dataRow,this.hot.hasHook("modifyData")){const valueHolder=(0,object.nA)(newValue);this.hot.runHooks("modifyData",physicalRow,this.propToCol(prop),valueHolder,"set"),valueHolder.isTouched()&&(newValue=valueHolder.value)}const{dataDotNotation}=this.hot.getSettings();if(dataRow&&dataRow.hasOwnProperty&&(0,object.mQ)(dataRow,prop))dataRow[prop]=newValue;else if(dataDotNotation&&"string"==typeof prop&&prop.indexOf(".")>-1){let ilen,out=dataRow,i=0;const sliced=prop.split(".");for(i=0,ilen=sliced.length-1;i<ilen;i++){if("__proto__"===sliced[i]||"constructor"===sliced[i]||"prototype"===sliced[i])return;void 0===out[sliced[i]]&&(out[sliced[i]]={}),out=out[sliced[i]]}out[sliced[i]]=newValue}else if("function"==typeof prop)prop(this.dataSource.slice(physicalRow,physicalRow+1)[0],newValue);else{if("__proto__"===prop||"constructor"===prop||"prototype"===prop)return;dataRow[prop]=newValue}}visualRowsToPhysical(index,amount){const totalRows=this.hot.countSourceRows(),logicRows=[];let row,physicRow=(totalRows+index)%totalRows,rowsToRemove=amount;for(;physicRow<totalRows&&rowsToRemove;)row=this.hot.toPhysicalRow(physicRow),logicRows.push(row),rowsToRemove-=1,physicRow+=1;return logicRows}visualColumnsToPhysical(index,amount){const totalCols=this.hot.countCols(),visualCols=[];let physicalCol=(totalCols+index)%totalCols,colsToRemove=amount;for(;physicalCol<totalCols&&colsToRemove;){const col=this.hot.toPhysicalColumn(physicalCol);visualCols.push(col),colsToRemove-=1,physicalCol+=1}return visualCols}clear(){for(let r=0;r<this.hot.countSourceRows();r++)for(let c=0;c<this.hot.countCols();c++)this.set(r,this.colToProp(c),"")}getLength(){const maxRowsFromSettings=this.tableMeta.maxRows;let maxRows;maxRows=maxRowsFromSettings<0||0===maxRowsFromSettings?0:maxRowsFromSettings||1/0;const length=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(length,maxRows)}getAll(){const start={row:0,col:0},end={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return start.row-end.row!=0||this.hot.countSourceRows()?this.getRange(start,end,DataMap.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(start,end,destination){const output=[];let r,c,row;const maxRows=this.tableMeta.maxRows,maxCols=this.tableMeta.maxCols;if(0===maxRows||0===maxCols)return[];const getFn=destination===DataMap.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,rlen=Math.min(Math.max(maxRows-1,0),Math.max(start.row,end.row)),clen=Math.min(Math.max(maxCols-1,0),Math.max(start.col,end.col));for(r=Math.min(start.row,end.row);r<=rlen;r++){row=[];const physicalRow=r>=0?this.hot.toPhysicalRow(r):r;for(c=Math.min(start.col,end.col);c<=clen&&null!==physicalRow;c++)row.push(getFn.call(this,r,this.colToProp(c)));null!==physicalRow&&output.push(row)}return output}getText(start,end){return(0,SheetClip.A)(this.getRange(start,end,DataMap.DESTINATION_RENDERER))}getCopyableText(start,end){return(0,SheetClip.A)(this.getRange(start,end,DataMap.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const dataMap_dataMap=DataMap;function replaceData(data,setDataMapFunction,callbackFunction,config){const{hotInstance,dataMap,dataSource,internalSource,source,metaManager,firstRun}=config,capitalizedInternalSource=(0,string.Ob)(internalSource),tableMeta=hotInstance.getSettings();Array.isArray(tableMeta.dataSchema)?hotInstance.dataType="array":(0,helpers_function.Tn)(tableMeta.dataSchema)?hotInstance.dataType="function":hotInstance.dataType="object",dataMap&&dataMap.destroy(),data=hotInstance.runHooks(`before${capitalizedInternalSource}`,data,firstRun,source);const newDataMap=new dataMap_dataMap(hotInstance,data,metaManager);if(setDataMapFunction(newDataMap),"object"==typeof data&&null!==data)data.push&&data.splice||(data=[data]);else{if(null!==data)throw new Error(`${internalSource} only accepts array of objects or array of arrays (${typeof data} given)`);{const dataSchema=newDataMap.getSchema();let row;data=[];let r=0,rlen=0;for(r=0,rlen=tableMeta.startRows;r<rlen;r++)if("object"!==hotInstance.dataType&&"function"!==hotInstance.dataType||!tableMeta.dataSchema)if("array"===hotInstance.dataType)row=(0,object.Go)(dataSchema[0]),data.push(row);else{row=[];for(let c=0,clen=tableMeta.startCols;c<clen;c++)row.push(null);data.push(row)}else row=(0,object.Go)(dataSchema),data.push(row)}}Array.isArray(data[0])&&(hotInstance.dataType="array"),tableMeta.data=data,newDataMap.dataSource=data,dataSource.data=data,dataSource.dataType=hotInstance.dataType,dataSource.colToProp=newDataMap.colToProp.bind(newDataMap),dataSource.propToCol=newDataMap.propToCol.bind(newDataMap),dataSource.countCachedColumns=newDataMap.countCachedColumns.bind(newDataMap),callbackFunction(newDataMap),hotInstance.runHooks(`after${capitalizedInternalSource}`,data,firstRun,source),firstRun||(hotInstance.runHooks("afterChange",null,internalSource),hotInstance.render()),hotInstance.getSettings().ariaTags&&(0,dom_element.Bq)(hotInstance.rootElement,[(0,a11y.DZ)(-1),(0,a11y.Nb)(hotInstance.countCols()+(hotInstance.view?hotInstance.countRowHeaders():0))])}var shortcutContexts_constants=__webpack_require__("./node_modules/handsontable/shortcutContexts/constants.mjs");function createInputElement(hot){const input=hot.rootDocument.createElement("input");return input.type="text",input.name="__htFocusCatcher",input.classList.add("htFocusCatcher"),hot.getSettings().ariaTags&&(0,dom_element.Bq)(input,[(0,a11y.gg)(),(0,a11y.MG)()]),input}function installFocusCatcher(hot){const clampCoordsIfNeeded=function normalizeCoordsIfNeeded(hot){return coords=>{if(!coords)return null;const mostTopStartCoords=getMostTopStartPosition(hot),mostBottomEndCoords=getMostBottomEndPosition(hot);return coords.col<mostTopStartCoords.col&&(coords.col=mostTopStartCoords.col),coords.col>mostBottomEndCoords.col&&(coords.col=mostBottomEndCoords.col),coords.row<mostTopStartCoords.row&&(coords.row=mostTopStartCoords.row),coords.row>mostBottomEndCoords.row&&(coords.row=mostBottomEndCoords.row),coords}}(hot);let recentlyAddedFocusCoords;const{activate,deactivate}=function installFocusDetector(hot){let hooks=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const rootElement=hot.rootElement,inputTrapTop=createInputElement(hot),inputTrapBottom=createInputElement(hot);return inputTrapTop.addEventListener("focus",(()=>null==hooks?void 0:hooks.onFocusFromTop())),inputTrapBottom.addEventListener("focus",(()=>null==hooks?void 0:hooks.onFocusFromBottom())),rootElement.firstChild.before(inputTrapTop),rootElement.lastChild.after(inputTrapBottom),{activate(){hot._registerTimeout((()=>{inputTrapTop.tabIndex=0,inputTrapBottom.tabIndex=0}),10)},deactivate(){hot._registerTimeout((()=>{inputTrapTop.tabIndex=-1,inputTrapBottom.tabIndex=-1}),10)}}}(hot,{onFocusFromTop(){var _clampCoordsIfNeeded;const mostTopStartCoords=null!==(_clampCoordsIfNeeded=clampCoordsIfNeeded(recentlyAddedFocusCoords))&&void 0!==_clampCoordsIfNeeded?_clampCoordsIfNeeded:getMostTopStartPosition(hot);mostTopStartCoords&&(hot.runHooks("modifyFocusOnTabNavigation","from_above",mostTopStartCoords),hot.selectCell(mostTopStartCoords.row,mostTopStartCoords.col)),hot.listen()},onFocusFromBottom(){var _clampCoordsIfNeeded2;const mostBottomEndCoords=null!==(_clampCoordsIfNeeded2=clampCoordsIfNeeded(recentlyAddedFocusCoords))&&void 0!==_clampCoordsIfNeeded2?_clampCoordsIfNeeded2:getMostBottomEndPosition(hot);mostBottomEndCoords&&(hot.runHooks("modifyFocusOnTabNavigation","from_below",mostBottomEndCoords),hot.selectCell(mostBottomEndCoords.row,mostBottomEndCoords.col)),hot.listen()}}),rowWrapState={wrapped:!1,flipped:!1};let isSavingCoordsEnabled=!0,isTabOrShiftTabPressed=!1,preventViewportScroll=!1;hot.addHook("afterListen",(()=>deactivate())),hot.addHook("afterUnlisten",(()=>activate())),hot.addHook("afterSelection",((row,column,row2,column2,preventScrolling)=>{var _hot$getSelectedRange;(isTabOrShiftTabPressed&&(rowWrapState.wrapped&&rowWrapState.flipped||preventViewportScroll)&&(preventViewportScroll=!1,preventScrolling.value=!0),isSavingCoordsEnabled)&&(recentlyAddedFocusCoords=null===(_hot$getSelectedRange=hot.getSelectedRangeLast())||void 0===_hot$getSelectedRange?void 0:_hot$getSelectedRange.highlight)})),hot.addHook("beforeRowWrap",((interruptedByAutoInsertMode,newCoords,isFlipped)=>{rowWrapState.wrapped=!0,rowWrapState.flipped=isFlipped}));const shortcutOptions={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:shortcutContexts_constants.B,group:"focusCatcher"};hot.getShortcutManager().getContext("grid").addShortcuts([{...shortcutOptions,callback:()=>{const{tabNavigation}=hot.getSettings();isTabOrShiftTabPressed=!0,hot.getSelectedRangeLast()&&!tabNavigation&&(isSavingCoordsEnabled=!1),tabNavigation||(preventViewportScroll=!0)},position:"before"},{...shortcutOptions,callback:event=>{const{tabNavigation,autoWrapRow}=hot.getSettings();if(isTabOrShiftTabPressed=!1,isSavingCoordsEnabled=!0,!tabNavigation||!hot.selection.isSelected()||autoWrapRow&&rowWrapState.wrapped&&rowWrapState.flipped||!autoWrapRow&&rowWrapState.wrapped)return autoWrapRow&&rowWrapState.wrapped&&rowWrapState.flipped&&(recentlyAddedFocusCoords=event.shiftKey?getMostTopStartPosition(hot):getMostBottomEndPosition(hot)),function deactivateTable(){rowWrapState.wrapped=!1,rowWrapState.flipped=!1,hot.deselectCell(),hot.unlisten()}(),!1;event.preventDefault()},position:"after"}])}function getMostTopStartPosition(hot){const{rowIndexMapper,columnIndexMapper}=hot,{navigableHeaders}=hot.getSettings();let topRow=navigableHeaders&&hot.countColHeaders()>0?-hot.countColHeaders():0,startColumn=navigableHeaders&&hot.countRowHeaders()>0?-hot.countRowHeaders():0;return 0===topRow&&(topRow=rowIndexMapper.getVisualFromRenderableIndex(topRow)),0===startColumn&&(startColumn=columnIndexMapper.getVisualFromRenderableIndex(startColumn)),null===topRow||null===startColumn?null:hot._createCellCoords(topRow,startColumn)}function getMostBottomEndPosition(hot){var _rowIndexMapper$getVi,_columnIndexMapper$ge;const{rowIndexMapper,columnIndexMapper}=hot,{navigableHeaders}=hot.getSettings();let bottomRow=rowIndexMapper.getRenderableIndexesLength()-1,endColumn=columnIndexMapper.getRenderableIndexesLength()-1;if(bottomRow<0){if(!navigableHeaders||0===hot.countColHeaders())return null;bottomRow=-1}if(endColumn<0){if(!navigableHeaders||0===hot.countColHeaders())return null;endColumn=-1}return hot._createCellCoords(null!==(_rowIndexMapper$getVi=rowIndexMapper.getVisualFromRenderableIndex(bottomRow))&&void 0!==_rowIndexMapper$getVi?_rowIndexMapper$getVi:bottomRow,null!==(_columnIndexMapper$ge=columnIndexMapper.getVisualFromRenderableIndex(endColumn))&&void 0!==_columnIndexMapper$ge?_columnIndexMapper$ge:endColumn)}var uniqueMap=__webpack_require__("./node_modules/handsontable/utils/dataStructures/uniqueMap.mjs");const mappings=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=keys=>keys.map((key=>{const lowercaseKey=key.toLowerCase();return mappings.has(lowercaseKey)?mappings.get(lowercaseKey):lowercaseKey})).sort().join("+"),specialCharactersSet=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),normalizeEventKey=_ref=>{let{which,key}=_ref;if(specialCharactersSet.has(which))return specialCharactersSet.get(which);const normalizedKey=String.fromCharCode(which).toLowerCase();return/^[a-z0-9]$/.test(normalizedKey)?normalizedKey:key.toLowerCase()},__kindOf=Symbol("shortcut-context");function isContextObject(objectToCheck){return(0,object.Gv)(objectToCheck)&&objectToCheck.__kindOf===__kindOf}const MODIFIER_KEYS=["meta","alt","shift","control"],modifierKeysObserver=function createKeysObserver(){const PRESSED_KEYS=new Set;return{press(key){PRESSED_KEYS.add(key)},release(key){PRESSED_KEYS.delete(key)},releaseAll(){PRESSED_KEYS.clear()},isPressed:key=>PRESSED_KEYS.has(key)}}(),modKeyListeners=[];let instanceCounter=0;const createShortcutManager=_ref=>{let{ownerWindow,handleEvent,beforeKeyDown,afterKeyDown}=_ref;const CONTEXTS=(0,uniqueMap.u)({errorIdExists:keys=>`The "${keys}" context name is already registered.`});let activeContextName="grid";const getActiveContextName=()=>activeContextName,getContext=contextName=>CONTEXTS.getItem(contextName);let isCtrlKeySilenced=!1;const recorderCallback=function(event,keys){let context=arguments.length>2&&void 0!==arguments[2]?arguments[2]:getActiveContextName();const activeContext=isContextObject(context)?context:getContext(context);let isExecutionCancelled=!1;if(!activeContext.hasShortcut(keys))return isExecutionCancelled;const shortcuts=activeContext.getShortcuts(keys);for(let index=0;index<shortcuts.length;index++){const{callback,runOnlyIf,preventDefault,stopPropagation,captureCtrl,forwardToContext}=shortcuts[index];if(!0===runOnlyIf(event)){if(isCtrlKeySilenced=captureCtrl,isExecutionCancelled=!1===callback(event,keys),isCtrlKeySilenced=!1,preventDefault&&event.preventDefault(),stopPropagation&&((0,dom_event.CA)(event),event.stopPropagation()),isExecutionCancelled)break;forwardToContext&&recorderCallback(event,keys,forwardToContext)}}return isExecutionCancelled},keyRecorder=function useRecorder(ownerWindow,handleEvent,beforeKeyDown,afterKeyDown,callback){const isModifierKey=pressedKey=>MODIFIER_KEYS.includes(pressedKey),getPressedModifierKeys=function(event){let mergeMetaKeys=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const pressedModifierKeys=[];return event.altKey&&pressedModifierKeys.push("alt"),mergeMetaKeys&&(event.ctrlKey||event.metaKey)?pressedModifierKeys.push("control/meta"):(event.ctrlKey&&pressedModifierKeys.push("control"),event.metaKey&&pressedModifierKeys.push("meta")),event.shiftKey&&pressedModifierKeys.push("shift"),pressedModifierKeys},onkeydown=event=>{if(!1===handleEvent(event))return;if(!1===beforeKeyDown(event)||229===event.keyCode||"string"!=typeof event.key||(0,dom_event.d)(event))return;const pressedKey=normalizeEventKey(event);let extraModifierKeys=[];isModifierKey(pressedKey)||(extraModifierKeys=getPressedModifierKeys(event));const pressedKeys=[pressedKey].concat(extraModifierKeys);!callback(event,pressedKeys)&&((0,browser.U0)()&&extraModifierKeys.includes("meta")||!(0,browser.U0)()&&extraModifierKeys.includes("control"))&&callback(event,[pressedKey].concat(getPressedModifierKeys(event,!0))),afterKeyDown(event)},onkeydownForModKeys=event=>{if("string"==typeof event.key){const pressedKey=normalizeEventKey(event);isModifierKey(pressedKey)&&modifierKeysObserver.press(pressedKey)}},onkeyupForModKeys=event=>{if("string"==typeof event.key){const pressedKey=normalizeEventKey(event);isModifierKey(pressedKey)&&modifierKeysObserver.release(pressedKey)}},onblur=()=>{modifierKeysObserver.releaseAll()};return{mount:()=>{let eventTarget=ownerWindow;for(instanceCounter+=1;eventTarget;)1===instanceCounter&&(eventTarget.document.documentElement.addEventListener("keydown",onkeydownForModKeys),modKeyListeners.push({event:"keydown",listener:onkeydownForModKeys}),eventTarget.document.documentElement.addEventListener("keyup",onkeyupForModKeys),modKeyListeners.push({event:"keyup",listener:onkeyupForModKeys})),eventTarget.document.documentElement.addEventListener("keydown",onkeydown),eventTarget.document.documentElement.addEventListener("blur",onblur),eventTarget=(0,dom_element.Ly)(eventTarget)},unmount:()=>{let eventTarget=ownerWindow;for(instanceCounter-=1;eventTarget;){if(0===instanceCounter){for(let i=0;i<modKeyListeners.length;i++){const{event,listener}=modKeyListeners[i];eventTarget.document.documentElement.removeEventListener(event,listener)}modKeyListeners.length=0}eventTarget.document.documentElement.removeEventListener("keydown",onkeydown),eventTarget.document.documentElement.removeEventListener("blur",onblur),eventTarget=(0,dom_element.Ly)(eventTarget)}},isPressed:key=>modifierKeysObserver.isPressed(key),releasePressedKeys:()=>modifierKeysObserver.releaseAll()}}(ownerWindow,handleEvent,beforeKeyDown,afterKeyDown,recorderCallback);return keyRecorder.mount(),{addContext:contextName=>{const context=(name=>{const SHORTCUTS=(0,uniqueMap.u)({errorIdExists:keys=>`The "${keys}" shortcut is already registered in the "${name}" context.`}),addShortcut=function(){let{keys,callback,group,runOnlyIf=()=>!0,captureCtrl=!1,preventDefault=!0,stopPropagation=!1,relativeToGroup,position,forwardToContext}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,mixed.b0)(group))throw new Error("You need to define the shortcut's group.");if(!1===(0,helpers_function.Tn)(callback))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(keys))throw new Error(templateLiteralTag.O`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const newShortcut={callback,group,runOnlyIf,captureCtrl,preventDefault,stopPropagation};(0,mixed.O9)(relativeToGroup)&&(newShortcut.relativeToGroup=relativeToGroup,newShortcut.position=position),isContextObject(forwardToContext)&&(newShortcut.forwardToContext=forwardToContext),keys.forEach((keyCombination=>{const normalizedKeys=normalizeKeys(keyCombination);if(SHORTCUTS.hasItem(normalizedKeys)){const shortcuts=SHORTCUTS.getItem(normalizedKeys);let insertionIndex=shortcuts.findIndex((shortcut=>shortcut.group===relativeToGroup));-1!==insertionIndex?"before"===position?insertionIndex-=1:insertionIndex+=1:insertionIndex=shortcuts.length,shortcuts.splice(insertionIndex,0,newShortcut)}else SHORTCUTS.addItem(normalizedKeys,[newShortcut])}))},removeShortcutsByKeys=keys=>{const normalizedKeys=normalizeKeys(keys);SHORTCUTS.removeItem(normalizedKeys)};return{__kindOf,addShortcut,addShortcuts:function(shortcuts){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};shortcuts.forEach((shortcut=>{(0,object.v4)(options,((value,key)=>{!1===Object.prototype.hasOwnProperty.call(shortcut,key)&&(shortcut[key]=options[key])})),addShortcut(shortcut)}))},getShortcuts:keys=>{const normalizedKeys=normalizeKeys(keys),shortcuts=SHORTCUTS.getItem(normalizedKeys);return(0,mixed.O9)(shortcuts)?shortcuts.slice():[]},hasShortcut:keys=>{const normalizedKeys=normalizeKeys(keys);return SHORTCUTS.hasItem(normalizedKeys)},removeShortcutsByKeys,removeShortcutsByGroup:group=>{SHORTCUTS.getItems().forEach((_ref=>{let[normalizedKeys,shortcutOptions]=_ref;const leftOptions=shortcutOptions.filter((option=>option.group!==group));0===leftOptions.length?removeShortcutsByKeys((normalizedKeys=>normalizedKeys.split("+"))(normalizedKeys)):(shortcutOptions.length=0,shortcutOptions.push(...leftOptions))}))}}})(contextName);return CONTEXTS.addItem(contextName,context),context},getActiveContextName,getContext,setActiveContextName:contextName=>{if(!CONTEXTS.hasItem(contextName))throw new Error(templateLiteralTag.O`You've tried to activate the "${contextName}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);activeContextName=contextName},isCtrlPressed:()=>!isCtrlKeySilenced&&(keyRecorder.isPressed("control")||keyRecorder.isPressed("meta")),releasePressedKeys:()=>keyRecorder.releasePressedKeys(),destroy:()=>keyRecorder.unmount()}},command={name:"editorCloseAndSave",callback(hot){hot._getEditorManager().closeEditorAndSaveChanges()}};var baseEditor=__webpack_require__("./node_modules/handsontable/editors/baseEditor/baseEditor.mjs");const closeAndSaveByArrowKeys_command={name:"editorCloseAndSaveByArrowKeys",callback(hot,event,keys){const editorManager=hot._getEditorManager(),activeEditor=editorManager.getActiveEditor();activeEditor.isInFullEditMode()&&activeEditor.state===baseEditor._T.EDITING||(editorManager.closeEditorAndSaveChanges(),hot.getSelected()&&(keys.includes("arrowdown")?hot.selection.transformStart(1,0):keys.includes("arrowup")?hot.selection.transformStart(-1,0):keys.includes("arrowleft")?hot.selection.transformStart(0,-1*hot.getDirectionFactor()):keys.includes("arrowright")&&hot.selection.transformStart(0,hot.getDirectionFactor())),event.preventDefault())}},closeAndSaveByEnter_command={name:"editorCloseAndSaveByEnter",callback(hot,event){const editorManager=hot._getEditorManager();editorManager.closeEditorAndSaveChanges(event.ctrlKey||event.metaKey),editorManager.moveSelectionAfterEnter(event)}},closeWithoutSaving_command={name:"editorCloseWithoutSaving",callback(hot){const editorManager=hot._getEditorManager();editorManager.closeEditorAndRestoreOriginalValue(hot.getShortcutManager().isCtrlPressed()),editorManager.activeEditor.focus()}},fastOpen_command={name:"editorFastOpen",callback(hot,event){const{highlight}=hot.getSelectedRangeLast();highlight.isHeader()||hot._getEditorManager().openEditor(null,event,!0)}},open_command={name:"editorOpen",callback(hot,event,keys){const editorManager=hot._getEditorManager(),selectedRange=hot.getSelectedRangeLast(),{highlight}=selectedRange;if(hot.selection.isMultiple()&&!selectedRange.isHeader()&&hot.countRenderedCols()>0&&hot.countRenderedRows()>0){const settings=hot.getSettings(),enterMoves="function"==typeof settings.enterMoves?settings.enterMoves(event):settings.enterMoves;keys.includes("shift")?hot.selection.transformFocus(-enterMoves.row,-enterMoves.col):hot.selection.transformFocus(enterMoves.row,enterMoves.col)}else highlight.isHeader()||(hot.getSettings().enterBeginsEditing?editorManager.cellProperties.readOnly?editorManager.moveSelectionAfterEnter(event):editorManager.openEditor(null,event,!0):editorManager.moveSelectionAfterEnter(event),(0,dom_event.CA)(event))}};const down_command={name:"extendCellsSelectionDown",callback(hot){const{highlight}=hot.getSelectedRangeLast();hot.selection.isSelectedByColumnHeader()||hot.selection.isSelectedByCorner()||!(highlight.isCell()||highlight.isHeader()&&hot.selection.isSelectedByRowHeader())||hot.selection.transformEnd(1,0)}},downByViewportHeight_command={name:"extendCellsSelectionDownByViewportHeight",callback(hot){const{to}=hot.getSelectedRangeLast(),nextRowIndexToSelect=Math.min(to.row+hot.countVisibleRows(),hot.countRows()-1),row=hot.rowIndexMapper.getNearestNotHiddenIndex(nextRowIndexToSelect,-1);if(null!==row){const coords=hot._createCellCoords(row,to.col),scrollPadding=to.row-hot.getFirstFullyVisibleRow(),nextVerticalScroll=Math.min(coords.row-scrollPadding,hot.countRows()-1);hot.selection.setRangeEnd(coords),hot.scrollViewportTo({row:nextVerticalScroll,verticalSnap:"top",horizontalSnap:"start"})}}},left_command={name:"extendCellsSelectionLeft",callback(hot){const{highlight}=hot.getSelectedRangeLast();hot.selection.isSelectedByRowHeader()||hot.selection.isSelectedByCorner()||!(highlight.isCell()||highlight.isHeader()&&hot.selection.isSelectedByColumnHeader())||hot.selection.transformEnd(0,-1*hot.getDirectionFactor())}},right_command={name:"extendCellsSelectionRight",callback(hot){const{highlight}=hot.getSelectedRangeLast();hot.selection.isSelectedByRowHeader()||hot.selection.isSelectedByCorner()||!(highlight.isCell()||highlight.isHeader()&&hot.selection.isSelectedByColumnHeader())||hot.selection.transformEnd(0,hot.getDirectionFactor())}},toColumns_command={name:"extendCellsSelectionToColumns",callback(hot){const{highlight,from,to}=hot.getSelectedRangeLast();hot.selection.isSelectedByRowHeader()?hot.selection.selectAll(!0,!0):hot.selectColumns(from.col,to.col,highlight)}},toMostBottom_command={name:"extendCellsSelectionToMostBottom",callback(hot){const{selection,rowIndexMapper}=hot,{highlight,from,to}=hot.getSelectedRangeLast(),isFocusHighlightedByHeader=highlight.isHeader()&&hot.selection.isSelectedByRowHeader();if(highlight.isCell()||isFocusHighlightedByHeader){const row=rowIndexMapper.getNearestNotHiddenIndex(hot.countRows()-1,-1),newFrom=from.clone();newFrom.row=highlight.row,selection.setRangeStart(newFrom,void 0,!1,highlight.clone()),isFocusHighlightedByHeader&&selection.selectedByRowHeader.add(selection.getLayerLevel()),selection.setRangeEnd(hot._createCellCoords(row,to.col))}}},toMostInlineEnd_command={name:"extendCellsSelectionToMostInlineEnd",callback(hot){const{selection,columnIndexMapper}=hot,{highlight,from,to}=hot.getSelectedRangeLast();if(!hot.selection.isSelectedByRowHeader()&&!hot.selection.isSelectedByCorner()&&highlight.isCell()){const column=columnIndexMapper.getNearestNotHiddenIndex(hot.countCols()-1,-1),newFrom=from.clone();newFrom.col=highlight.col,selection.setRangeStart(newFrom,void 0,!1,highlight.clone()),selection.setRangeEnd(hot._createCellCoords(to.row,column))}}},toMostInlineStart_command={name:"extendCellsSelectionToMostInlineStart",callback(hot){const{selection,columnIndexMapper}=hot,{highlight,from,to}=hot.getSelectedRangeLast();if(!hot.selection.isSelectedByRowHeader()&&!hot.selection.isSelectedByCorner()&&highlight.isCell()){const fixedColumns=parseInt(hot.getSettings().fixedColumnsStart,10),column=columnIndexMapper.getNearestNotHiddenIndex(fixedColumns,1),newFrom=from.clone();newFrom.col=highlight.col,selection.setRangeStart(newFrom,void 0,!1,highlight.clone()),selection.setRangeEnd(hot._createCellCoords(to.row,column))}}},toMostLeft_command={name:"extendCellsSelectionToMostLeft",callback(hot){const{selection,columnIndexMapper}=hot,{highlight,from,to}=hot.getSelectedRangeLast(),isFocusHighlightedByHeader=highlight.isHeader()&&hot.selection.isSelectedByColumnHeader();if(highlight.isCell()||isFocusHighlightedByHeader){const column=columnIndexMapper.getNearestNotHiddenIndex(...hot.isRtl()?[hot.countCols()-1,-1]:[0,1]),newFrom=from.clone();newFrom.col=highlight.col,selection.setRangeStart(newFrom,void 0,!1,highlight.clone()),isFocusHighlightedByHeader&&selection.selectedByColumnHeader.add(selection.getLayerLevel()),selection.setRangeEnd(hot._createCellCoords(to.row,column))}}},toMostRight_command={name:"extendCellsSelectionToMostRight",callback(hot){const{selection,columnIndexMapper}=hot,{highlight,from,to}=hot.getSelectedRangeLast(),isFocusHighlightedByHeader=highlight.isHeader()&&hot.selection.isSelectedByColumnHeader();if(highlight.isCell()||isFocusHighlightedByHeader){const column=columnIndexMapper.getNearestNotHiddenIndex(...hot.isRtl()?[0,1]:[hot.countCols()-1,-1]),newFrom=from.clone();newFrom.col=highlight.col,selection.setRangeStart(newFrom,void 0,!1,highlight.clone()),isFocusHighlightedByHeader&&selection.selectedByColumnHeader.add(selection.getLayerLevel()),selection.setRangeEnd(hot._createCellCoords(to.row,column))}}},toMostTop_command={name:"extendCellsSelectionToMostTop",callback(hot){const{selection,rowIndexMapper}=hot,{highlight,from,to}=hot.getSelectedRangeLast(),isFocusHighlightedByHeader=highlight.isHeader()&&hot.selection.isSelectedByRowHeader();if(highlight.isCell()||isFocusHighlightedByHeader){const row=rowIndexMapper.getNearestNotHiddenIndex(0,1),newFrom=from.clone();newFrom.row=highlight.row,selection.setRangeStart(newFrom,void 0,!1,highlight.clone()),isFocusHighlightedByHeader&&selection.selectedByRowHeader.add(selection.getLayerLevel()),selection.setRangeEnd(hot._createCellCoords(row,to.col))}}},toRows_command={name:"extendCellsSelectionToRows",callback(hot){const{highlight,from,to}=hot.getSelectedRangeLast();hot.selection.isSelectedByColumnHeader()?hot.selection.selectAll(!0,!0):hot.selectRows(from.row,to.row,highlight)}},up_command={name:"extendCellsSelectionUp",callback(hot){const{highlight}=hot.getSelectedRangeLast();hot.selection.isSelectedByColumnHeader()||hot.selection.isSelectedByCorner()||!(highlight.isCell()||highlight.isHeader()&&hot.selection.isSelectedByRowHeader())||hot.selection.transformEnd(-1,0)}},upByViewportHeight_command={name:"extendCellsSelectionUpByViewportHeight",callback(hot){const{to}=hot.getSelectedRangeLast(),nextRowIndexToSelect=Math.max(to.row-hot.countVisibleRows(),0),row=hot.rowIndexMapper.getNearestNotHiddenIndex(nextRowIndexToSelect,1);if(null!==row){const coords=hot._createCellCoords(row,to.col),scrollPadding=to.row-hot.getFirstFullyVisibleRow(),nextVerticalScroll=Math.max(coords.row-scrollPadding,0);hot.selection.setRangeEnd(coords),hot.scrollViewportTo({row:nextVerticalScroll,verticalSnap:"top",horizontalSnap:"start"})}}};const moveCellSelection_down_command={name:"moveCellSelectionDown",callback(_ref){let{selection}=_ref;selection.transformStart(1,0)}},moveCellSelection_downByViewportHeight_command={name:"moveCellSelectionDownByViewportHeight",callback(hot){const{navigableHeaders}=hot.getSettings(),columnHeadersCount=navigableHeaders?hot.countColHeaders():0,{row}=hot.getSelectedRangeLast().highlight;let rowsStep=hot.countVisibleRows()+columnHeadersCount;rowsStep=0===rowsStep?1:rowsStep,row===hot.countRows()-1?rowsStep=1:row+rowsStep>hot.countRows()&&(rowsStep=hot.countRows()-row-1),hot.selection.transformStart(rowsStep,0),hot.getSelectedRangeLast().highlight.row<0&&hot.scrollViewportTo({row:0})}},inlineEnd_command={name:"moveCellSelectionInlineEnd",callback(hot,event){const settings=hot.getSettings(),selectedRange=hot.getSelectedRangeLast(),tabMoves="function"==typeof settings.tabMoves?settings.tabMoves(event):settings.tabMoves;hot.selection.isMultiple()&&!selectedRange.isHeader()&&hot.countRenderedCols()>0&&hot.countRenderedRows()>0?hot.selection.transformFocus(-tabMoves.row,-tabMoves.col):hot.selection.transformStart(-tabMoves.row,-tabMoves.col)}},inlineStart_command={name:"moveCellSelectionInlineStart",callback(hot,event){const settings=hot.getSettings(),selectedRange=hot.getSelectedRangeLast(),tabMoves="function"==typeof settings.tabMoves?settings.tabMoves(event):settings.tabMoves;hot.selection.isMultiple()&&!selectedRange.isHeader()&&hot.countRenderedCols()>0&&hot.countRenderedRows()>0?hot.selection.transformFocus(tabMoves.row,tabMoves.col):hot.selection.transformStart(tabMoves.row,tabMoves.col)}},moveCellSelection_left_command={name:"moveCellSelectionLeft",callback(hot){hot.selection.transformStart(0,-1*hot.getDirectionFactor())}},moveCellSelection_right_command={name:"moveCellSelectionRight",callback(hot){hot.selection.transformStart(0,hot.getDirectionFactor())}},moveCellSelection_toMostBottom_command={name:"moveCellSelectionToMostBottom",callback(hot){const{col}=hot.getSelectedRangeLast().highlight;let row=hot.rowIndexMapper.getNearestNotHiddenIndex(hot.countRows()-1,-1);null===row&&(row=-1),hot.selection.setRangeStart(hot._createCellCoords(row,col))}},toMostBottomInlineEnd_command={name:"moveCellSelectionToMostBottomInlineEnd",callback(hot){const{selection,rowIndexMapper,columnIndexMapper}=hot,fixedRows=parseInt(hot.getSettings().fixedRowsBottom,10),row=rowIndexMapper.getNearestNotHiddenIndex(hot.countRows()-fixedRows-1,-1),column=columnIndexMapper.getNearestNotHiddenIndex(hot.countCols()-1,-1);selection.setRangeStart(hot._createCellCoords(row,column))}},moveCellSelection_toMostInlineEnd_command={name:"moveCellSelectionToMostInlineEnd",callback(hot){const{selection,columnIndexMapper}=hot;selection.setRangeStart(hot._createCellCoords(hot.getSelectedRangeLast().highlight.row,columnIndexMapper.getNearestNotHiddenIndex(hot.countCols()-1,-1)))}},moveCellSelection_toMostInlineStart_command={name:"moveCellSelectionToMostInlineStart",callback(hot){const{selection,columnIndexMapper}=hot,fixedColumns=parseInt(hot.getSettings().fixedColumnsStart,10),row=hot.getSelectedRangeLast().highlight.row,column=columnIndexMapper.getNearestNotHiddenIndex(fixedColumns,1);selection.setRangeStart(hot._createCellCoords(row,column))}},moveCellSelection_toMostLeft_command={name:"moveCellSelectionToMostLeft",callback(hot){const{selection,columnIndexMapper}=hot,row=hot.getSelectedRangeLast().highlight.row;let column=columnIndexMapper.getNearestNotHiddenIndex(...hot.isRtl()?[hot.countCols()-1,-1]:[0,1]);null===column&&(column=hot.isRtl()?-1:-hot.countRowHeaders()),selection.setRangeStart(hot._createCellCoords(row,column))}},moveCellSelection_toMostRight_command={name:"moveCellSelectionToMostRight",callback(hot){const{selection,columnIndexMapper}=hot,{row}=hot.getSelectedRangeLast().highlight;let column=columnIndexMapper.getNearestNotHiddenIndex(...hot.isRtl()?[0,1]:[hot.countCols()-1,-1]);null===column&&(column=hot.isRtl()?-hot.countRowHeaders():-1),selection.setRangeStart(hot._createCellCoords(row,column))}},moveCellSelection_toMostTop_command={name:"moveCellSelectionToMostTop",callback(hot){const{col}=hot.getSelectedRangeLast().highlight;let row=hot.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===row&&(row=-hot.countColHeaders()),hot.selection.setRangeStart(hot._createCellCoords(row,col))}},toMostTopInlineStart_command={name:"moveCellSelectionToMostTopInlineStart",callback(hot){const{selection,rowIndexMapper,columnIndexMapper}=hot,fixedRows=parseInt(hot.getSettings().fixedRowsTop,10),fixedColumns=parseInt(hot.getSettings().fixedColumnsStart,10),row=rowIndexMapper.getNearestNotHiddenIndex(fixedRows,1),column=columnIndexMapper.getNearestNotHiddenIndex(fixedColumns,1);selection.setRangeStart(hot._createCellCoords(row,column))}},moveCellSelection_up_command={name:"moveCellSelectionUp",callback(_ref){let{selection}=_ref;selection.transformStart(-1,0)}},moveCellSelection_upByViewportHeight_command={name:"moveCellSelectionUpByViewportHight",callback(hot){const{navigableHeaders}=hot.getSettings(),columnHeadersCount=navigableHeaders?hot.countColHeaders():0,{row}=hot.getSelectedRangeLast().highlight;let rowsStep=hot.countVisibleRows()+columnHeadersCount;rowsStep=0===rowsStep?-1:-rowsStep,row===-columnHeadersCount?rowsStep=-1:row+rowsStep<columnHeadersCount&&(rowsStep=-(row+columnHeadersCount)),hot.selection.transformStart(rowsStep,0),hot.getSelectedRangeLast().highlight.row<0&&hot.scrollViewportTo({row:0})}};const emptySelectedCells_command={name:"emptySelectedCells",callback(hot){hot.emptySelectedCells(),hot._getEditorManager().prepareEditor()}},scrollToFocusedCell_command={name:"scrollToFocusedCell",callback(hot){const{highlight}=hot.getSelectedRangeLast(),firstVisibleRow=hot.getFirstFullyVisibleRow()-1,firstVisibleColumn=hot.getFirstFullyVisibleColumn()-1,lastVisibleRow=hot.getLastFullyVisibleRow()+1,lastVisibleColumn=hot.getLastFullyVisibleColumn()+1,visibleCoordsFrom=hot._createCellCoords(firstVisibleRow,firstVisibleColumn),visibleCoordsTo=hot._createCellCoords(lastVisibleRow,lastVisibleColumn);if(!hot._createCellRange(visibleCoordsFrom,visibleCoordsFrom,visibleCoordsTo).includes(highlight)&&(highlight.row>=0||highlight.col>=0)){const scrollCoords={};if(highlight.col>=0){const offsetColumns=Math.floor(hot.countVisibleCols()/2);scrollCoords.col=Math.max(highlight.col-offsetColumns,0)}if(highlight.row>=0){const offsetRows=Math.floor(hot.countVisibleRows()/2);scrollCoords.row=Math.max(highlight.row-offsetRows,0)}hot.scrollViewportTo({...scrollCoords,verticalSnap:"top",horizontalSnap:"start"})}}},selectAllCells_command={name:"selectAllCells",callback(hot){hot.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},selectAllCellsAndHeaders_command={name:"selectAllCellsAndHeaders",callback(hot){hot.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},populateSelectedCellsData_command={name:"populateSelectedCellsData",callback(hot){const selectedRange=hot.getSelectedRange(),{row:highlightRow,col:highlightColumn}=selectedRange[selectedRange.length-1].highlight.normalize(),valueToPopulate=hot.getDataAtCell(highlightRow,highlightColumn),cellValues=new Map;for(let i=0;i<selectedRange.length;i++)selectedRange[i].forAll(((row,column)=>{if(row>=0&&column>=0&&(row!==highlightRow||column!==highlightColumn)){const{readOnly}=hot.getCellMeta(row,column);readOnly||cellValues.set(`${row}x${column}`,[row,column,valueToPopulate])}}));hot.setDataAtCell(Array.from(cellValues.values()))}},allCommands=[...function getAllCommands(){return[command,closeAndSaveByArrowKeys_command,closeAndSaveByEnter_command,closeWithoutSaving_command,fastOpen_command,open_command]}(),...function extendCellsSelection_getAllCommands(){return[down_command,downByViewportHeight_command,left_command,right_command,toColumns_command,toMostBottom_command,toMostInlineEnd_command,toMostInlineStart_command,toMostLeft_command,toMostRight_command,toMostTop_command,toRows_command,up_command,upByViewportHeight_command]}(),...function moveCellSelection_getAllCommands(){return[moveCellSelection_down_command,moveCellSelection_downByViewportHeight_command,inlineEnd_command,inlineStart_command,moveCellSelection_left_command,moveCellSelection_right_command,moveCellSelection_toMostBottom_command,toMostBottomInlineEnd_command,moveCellSelection_toMostInlineEnd_command,moveCellSelection_toMostInlineStart_command,moveCellSelection_toMostLeft_command,moveCellSelection_toMostRight_command,moveCellSelection_toMostTop_command,toMostTopInlineStart_command,moveCellSelection_up_command,moveCellSelection_upByViewportHeight_command]}(),emptySelectedCells_command,scrollToFocusedCell_command,selectAllCells_command,selectAllCellsAndHeaders_command,populateSelectedCellsData_command];function createKeyboardShortcutCommandsPool(hot){const commands={};return allCommands.forEach((_ref=>{let{name,callback}=_ref;commands[name]=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return callback(hot,...args)}})),commands}function shortcutsEditorContext(hot){const context=hot.getShortcutManager().addContext("editor"),commandsPool=createKeyboardShortcutCommandsPool(hot),config={group:shortcutContexts_constants.b};context.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(event,keys)=>commandsPool.editorCloseAndSaveByEnter(event,keys)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(event,keys)=>commandsPool.editorCloseAndSaveByEnter(event,keys)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:hot.getShortcutManager().getContext("grid"),callback:(event,keys)=>commandsPool.editorCloseAndSave(event,keys)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(event,keys)=>commandsPool.editorCloseAndSaveByArrowKeys(event,keys)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>commandsPool.editorCloseWithoutSaving()}],config)}function shortcutsGridContext(hot){const context=hot.getShortcutManager().addContext("grid"),commandsPool=createKeyboardShortcutCommandsPool(hot),config={runOnlyIf:()=>{const{navigableHeaders}=hot.getSettings();return(0,mixed.O9)(hot.getSelected())&&(navigableHeaders||!navigableHeaders&&hot.countRenderedRows()>0&&hot.countRenderedCols()>0)},group:shortcutContexts_constants.B};context.addShortcuts([{keys:[["F2"]],callback:event=>commandsPool.editorFastOpen(event)},{keys:[["Enter"],["Enter","Shift"]],callback:(event,keys)=>commandsPool.editorOpen(event,keys)},{keys:[["Backspace"],["Delete"]],callback:()=>commandsPool.emptySelectedCells()}],{group:shortcutContexts_constants.b,runOnlyIf:()=>(0,mixed.O9)(hot.getSelected())}),context.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>commandsPool.selectAllCells(),runOnlyIf:()=>{var _hot$getSelectedRange;return!(null!==(_hot$getSelectedRange=hot.getSelectedRangeLast())&&void 0!==_hot$getSelectedRange&&_hot$getSelectedRange.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var _hot$getSelectedRange2;return null===(_hot$getSelectedRange2=hot.getSelectedRangeLast())||void 0===_hot$getSelectedRange2?void 0:_hot$getSelectedRange2.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>commandsPool.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>commandsPool.populateSelectedCellsData(),runOnlyIf:()=>{var _hot$getSelectedRange3,_hot$getSelectedRange4;return!(null!==(_hot$getSelectedRange3=hot.getSelectedRangeLast())&&void 0!==_hot$getSelectedRange3&&_hot$getSelectedRange3.highlight.isHeader())&&(null===(_hot$getSelectedRange4=hot.getSelectedRangeLast())||void 0===_hot$getSelectedRange4?void 0:_hot$getSelectedRange4.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>commandsPool.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>commandsPool.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>commandsPool.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>commandsPool.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(hot.selection.isSelectedByCorner()||hot.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>commandsPool.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>commandsPool.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(hot.selection.isSelectedByCorner()||hot.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>commandsPool.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>commandsPool.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(hot.selection.isSelectedByCorner()||hot.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>commandsPool.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>commandsPool.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(hot.selection.isSelectedByCorner()||hot.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>commandsPool.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>hot.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>commandsPool.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>hot.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>commandsPool.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>hot.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>commandsPool.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>commandsPool.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>hot.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>commandsPool.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>commandsPool.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>commandsPool.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>commandsPool.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:event=>commandsPool.moveCellSelectionInlineStart(event)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:event=>commandsPool.moveCellSelectionInlineEnd(event)},{keys:[["Control/Meta","Backspace"]],callback:()=>commandsPool.scrollToFocusedCell()}],config)}function getThemeClassName(rootElement){const{classNames}=(0,dom_element.Oe)(rootElement,/ht-theme-[a-zA-Z0-9_-]+/);return classNames.pop()}let activeGuid=null;const foreignHotInstances=new Map;new Set;function Core(rootElement,userSettings){var _userSettings$layoutD,_this=this;let rootInstanceSymbol=arguments.length>2&&void 0!==arguments[2]&&arguments[2],instance=this;const eventManager=new handsontable_eventManager.A(instance);let datamap,dataSource,grid,editorManager,focusManager,viewportScroller,firstRun=!0;hasValidParameter(rootInstanceSymbol)&&function registerAsRootInstance(object){holder.set(object,!0)}(this),this.rootElement=rootElement,this.rootDocument=rootElement.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const layoutDirection=null!==(_userSettings$layoutD=null==userSettings?void 0:userSettings.layoutDirection)&&void 0!==_userSettings$layoutD?_userSettings$layoutD:"inherit",rootElementDirection=["rtl","ltr"].includes(layoutDirection)?layoutDirection:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",rootElementDirection),this.isRtl=function(){return"rtl"===rootElementDirection},this.isLtr=function(){return!instance.isRtl()},this.getDirectionFactor=function(){return instance.isLtr()?1:-1},userSettings.language=function getValidLanguageCode(languageCode){let normalizedLanguageCode=normalizeLanguageCode(languageCode);return hasLanguageDictionary(normalizedLanguageCode)||(normalizedLanguageCode=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(languageCode)),normalizedLanguageCode}(userSettings.language);const metaManager=new MetaManager(instance,userSettings,[DynamicCellMetaMod,ExtendMetaPropertiesMod]),tableMeta=metaManager.getTableMeta(),globalMeta=metaManager.getGlobalMeta(),pluginsRegistry=(0,uniqueMap.u)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,rootElement.insertBefore(this.container,rootElement.firstChild),isRootInstance(this)&&((0,mixed.k_)(userSettings.licenseKey,rootElement),(0,dom_element.iQ)(rootElement,"ht-wrapper")),this.guid=`ht_${(0,string.DU)()}`,foreignHotInstances.set(this.guid,this),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(source=>{instance.runHooks("afterColumnSequenceChange",source)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(source=>{instance.runHooks("afterRowSequenceChange",source)})),dataSource=new dataMap_dataSource(instance),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let selection=new selection_selection(tableMeta,{rowIndexMapper:instance.rowIndexMapper,columnIndexMapper:instance.columnIndexMapper,countCols:()=>instance.countCols(),countRows:()=>instance.countRows(),propToCol:prop=>datamap.propToCol(prop),isEditorOpened:()=>!!instance.getActiveEditor()&&instance.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return _this.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return _this.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>instance.getShortcutManager(),createCellCoords:(row,column)=>instance._createCellCoords(row,column),createCellRange:(highlight,from,to)=>instance._createCellRange(highlight,from,to),visualToRenderableCoords:coords=>{const{row:visualRow,col:visualColumn}=coords;return instance._createCellCoords(visualRow>=0?instance.rowIndexMapper.getRenderableFromVisualIndex(visualRow):visualRow,visualColumn>=0?instance.columnIndexMapper.getRenderableFromVisualIndex(visualColumn):visualColumn)},renderableToVisualCoords:coords=>{const{row:renderableRow,col:renderableColumn}=coords;return instance._createCellCoords(renderableRow>=0?instance.rowIndexMapper.getVisualFromRenderableIndex(renderableRow):renderableRow,renderableColumn>=0?instance.columnIndexMapper.getVisualFromRenderableIndex(renderableColumn):renderableColumn)},findFirstNonHiddenRenderableRow:(visualRowFrom,visualRowTo)=>{const dir=visualRowTo>visualRowFrom?1:-1,minIndex=Math.min(visualRowFrom,visualRowTo),maxIndex=Math.max(visualRowFrom,visualRowTo),rowIndex=instance.rowIndexMapper.getNearestNotHiddenIndex(visualRowFrom,dir);return null===rowIndex||1===dir&&rowIndex>maxIndex||-1===dir&&rowIndex<minIndex?null:rowIndex>=0?instance.rowIndexMapper.getRenderableFromVisualIndex(rowIndex):rowIndex},findFirstNonHiddenRenderableColumn:(visualColumnFrom,visualColumnTo)=>{const dir=visualColumnTo>visualColumnFrom?1:-1,minIndex=Math.min(visualColumnFrom,visualColumnTo),maxIndex=Math.max(visualColumnFrom,visualColumnTo),columnIndex=instance.columnIndexMapper.getNearestNotHiddenIndex(visualColumnFrom,dir);return null===columnIndex||1===dir&&columnIndex>maxIndex||-1===dir&&columnIndex<minIndex?null:columnIndex>=0?instance.columnIndexMapper.getRenderableFromVisualIndex(columnIndex):columnIndex},isDisabledCellSelection:(visualRow,visualColumn)=>visualRow<0||visualColumn<0?instance.getSettings().disableVisualSelection:instance.getCellMeta(visualRow,visualColumn).disableVisualSelection});this.selection=selection;const onIndexMapperCacheUpdate=_ref=>{let{hiddenIndexesChanged}=_ref;hiddenIndexesChanged&&this.selection.commit()};function setLanguage(languageCode){const normalizedLanguageCode=normalizeLanguageCode(languageCode);hasLanguageDictionary(normalizedLanguageCode)?(instance.runHooks("beforeLanguageChange",normalizedLanguageCode),globalMeta.language=normalizedLanguageCode,instance.runHooks("afterLanguageChange",normalizedLanguageCode)):warnUserAboutLanguageRegistration(languageCode)}function setClassName(className,classSettings){const element="className"===className?instance.rootElement:instance.table;if(firstRun)(0,dom_element.iQ)(element,classSettings);else{let globalMetaSettingsArray=[],settingsArray=[];globalMeta[className]&&(globalMetaSettingsArray=Array.isArray(globalMeta[className])?globalMeta[className]:(0,array.Gn)(globalMeta[className])),classSettings&&(settingsArray=Array.isArray(classSettings)?classSettings:(0,array.Gn)(classSettings));const classNameToRemove=(0,array.fg)(globalMetaSettingsArray,settingsArray),classNameToAdd=(0,array.fg)(settingsArray,globalMetaSettingsArray);classNameToRemove.length&&(0,dom_element.vy)(element,classNameToRemove),classNameToAdd.length&&(0,dom_element.iQ)(element,classNameToAdd)}globalMeta[className]=classSettings}function ValidatorsQueue(){let resolved=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,resolved=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===resolved&&(resolved=!0,this.onQueueEmpty(this.valid))}}}function getParsedNumber(numericData){const unifiedNumericData=numericData.replace(",",".");return!1===isNaN(parseFloat(unifiedNumericData))?parseFloat(unifiedNumericData):numericData}function validateChanges(changes,source,callback){if(!changes.length)return void callback();const activeEditor=instance.getActiveEditor(),waitingForValidator=new ValidatorsQueue;let shouldBeCanceled=!0;waitingForValidator.onQueueEmpty=()=>{activeEditor&&shouldBeCanceled&&activeEditor.cancelChanges(),callback()};for(let i=changes.length-1;i>=0;i--){const[row,prop]=changes[i],visualCol=datamap.propToCol(prop);let cellProperties;cellProperties=Number.isInteger(visualCol)?instance.getCellMeta(row,visualCol):{...Object.getPrototypeOf(tableMeta),...tableMeta},instance.getCellValidator(cellProperties)&&(waitingForValidator.addValidatorToQueue(),instance.validateCell(changes[i][3],cellProperties,function(index,cellPropertiesReference){return function(result){if("boolean"!=typeof result)throw new Error("Validation error: result is not boolean");!1===result&&!1===cellPropertiesReference.allowInvalid&&(shouldBeCanceled=!1,changes.splice(index,1),cellPropertiesReference.valid=!0),waitingForValidator.removeValidatorFormQueue()}}(i,cellProperties),source))}waitingForValidator.checkIfQueueIsEmpty()}function applyChanges(changes,source){for(let i=changes.length-1;i>=0;i--){let skipThisChange=!1;if(null!==changes[i]){if(null!==changes[i][2]&&void 0!==changes[i][2]||null!==changes[i][3]&&void 0!==changes[i][3]){if(tableMeta.allowInsertRow)for(;changes[i][0]>instance.countRows()-1;){const{delta:numberOfCreatedRows}=datamap.createRow(void 0,void 0,{source:"auto"});if(0===numberOfCreatedRows){skipThisChange=!0;break}}if("array"===instance.dataType&&(!tableMeta.columns||0===tableMeta.columns.length)&&tableMeta.allowInsertColumn)for(;datamap.propToCol(changes[i][1])>instance.countCols()-1;){const{delta:numberOfCreatedColumns}=datamap.createCol(void 0,void 0,{source:"auto"});if(0===numberOfCreatedColumns){skipThisChange=!0;break}}skipThisChange||datamap.set(changes[i][0],changes[i][1],changes[i][3])}}else changes.splice(i,1)}const hasChanges=changes.length>0;if(instance.forceFullRender=!0,hasChanges){grid.adjustRowsAndCols(),instance.runHooks("beforeChangeRender",changes,source),editorManager.closeEditor(),instance.view.render(),editorManager.prepareEditor(),instance.view.adjustElementsSize(),instance.runHooks("afterChange",changes,source||"edit");const activeEditor=instance.getActiveEditor();activeEditor&&(0,mixed.O9)(activeEditor.refreshValue)&&activeEditor.refreshValue()}else instance.view.render()}function setDataInputToArray(row,propOrCol,value){return Array.isArray(row)?row:[[row,propOrCol,value]]}function processChanges(changes,source){const beforeChangeResult=instance.runHooks("beforeChange",changes,source||"edit"),filteredChanges=changes.filter((change=>null!==change));var _instance$getActiveEd;if(!1===beforeChangeResult||0===filteredChanges.length)return null===(_instance$getActiveEd=instance.getActiveEditor())||void 0===_instance$getActiveEd||_instance$getActiveEd.cancelChanges(),[];for(let i=filteredChanges.length-1;i>=0;i--){const[row,prop,,newValue]=filteredChanges[i],visualColumn=datamap.propToCol(prop);let cellProperties;cellProperties=Number.isInteger(visualColumn)?instance.getCellMeta(row,visualColumn):{...Object.getPrototypeOf(tableMeta),...tableMeta},"numeric"===cellProperties.type&&"string"==typeof newValue&&(0,number.LA)(newValue)&&(filteredChanges[i][3]=getParsedNumber(newValue))}return filteredChanges}this.columnIndexMapper.addLocalHook("cacheUpdated",onIndexMapperCacheUpdate),this.rowIndexMapper.addLocalHook("cacheUpdated",onIndexMapperCacheUpdate),this.selection.addLocalHook("afterSetRangeEnd",((cellCoords,isLastSelectionLayer)=>{const preventScrolling=(0,object.nA)(!1),selectionRange=this.selection.getSelectedRange(),{from,to}=selectionRange.current(),selectionLayerLevel=selectionRange.size()-1;this.runHooks("afterSelection",from.row,from.col,to.row,to.col,preventScrolling,selectionLayerLevel),this.runHooks("afterSelectionByProp",from.row,instance.colToProp(from.col),to.row,instance.colToProp(to.col),preventScrolling,selectionLayerLevel),isLastSelectionLayer&&(!preventScrolling.isTouched()||preventScrolling.isTouched()&&!preventScrolling.value)&&viewportScroller.scrollTo(cellCoords);const isSelectedByRowHeader=selection.isSelectedByRowHeader(),isSelectedByColumnHeader=selection.isSelectedByColumnHeader();isSelectedByRowHeader&&isSelectedByColumnHeader?(0,dom_element.iQ)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):isSelectedByRowHeader?((0,dom_element.vy)(this.rootElement,"ht__selection--columns"),(0,dom_element.iQ)(this.rootElement,"ht__selection--rows")):isSelectedByColumnHeader?((0,dom_element.vy)(this.rootElement,"ht__selection--rows"),(0,dom_element.iQ)(this.rootElement,"ht__selection--columns")):(0,dom_element.vy)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==selection.getSelectionSource()&&editorManager.closeEditor(null),instance.view.render(),editorManager.prepareEditor()})),this.selection.addLocalHook("beforeSetFocus",(cellCoords=>{this.runHooks("beforeSelectionFocusSet",cellCoords.row,cellCoords.col)})),this.selection.addLocalHook("afterSetFocus",(cellCoords=>{const preventScrolling=(0,object.nA)(!1);this.runHooks("afterSelectionFocusSet",cellCoords.row,cellCoords.col,preventScrolling),(!preventScrolling.isTouched()||preventScrolling.isTouched()&&!preventScrolling.value)&&viewportScroller.scrollTo(cellCoords),editorManager.closeEditor(),instance.view.render(),editorManager.prepareEditor()})),this.selection.addLocalHook("afterSelectionFinished",(cellRanges=>{const selectionLayerLevel=cellRanges.length-1,{from,to}=cellRanges[selectionLayerLevel];this.runHooks("afterSelectionEnd",from.row,from.col,to.row,to.col,selectionLayerLevel),this.runHooks("afterSelectionEndByProp",from.row,instance.colToProp(from.col),to.row,instance.colToProp(to.col),selectionLayerLevel)})),this.selection.addLocalHook("afterIsMultipleSelection",(isMultiple=>{const changedIsMultiple=this.runHooks("afterIsMultipleSelection",isMultiple.value);isMultiple.value&&(isMultiple.value=changedIsMultiple)})),this.selection.addLocalHook("afterDeselect",(()=>{editorManager.closeEditor(),instance.view.render(),(0,dom_element.vy)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this.runHooks("beforeSetRangeStart",...args)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return _this.runHooks("beforeSetRangeStartOnly",...args)})).addLocalHook("beforeSetRangeEnd",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return _this.runHooks("beforeSetRangeEnd",...args)})).addLocalHook("beforeSelectColumns",(function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return _this.runHooks("beforeSelectColumns",...args)})).addLocalHook("afterSelectColumns",(function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return _this.runHooks("afterSelectColumns",...args)})).addLocalHook("beforeSelectRows",(function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return _this.runHooks("beforeSelectRows",...args)})).addLocalHook("afterSelectRows",(function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return _this.runHooks("afterSelectRows",...args)})).addLocalHook("beforeModifyTransformStart",(function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return _this.runHooks("modifyTransformStart",...args)})).addLocalHook("afterModifyTransformStart",(function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return _this.runHooks("afterModifyTransformStart",...args)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return _this.runHooks("modifyTransformFocus",...args)})).addLocalHook("afterModifyTransformFocus",(function(){for(var _len11=arguments.length,args=new Array(_len11),_key11=0;_key11<_len11;_key11++)args[_key11]=arguments[_key11];return _this.runHooks("afterModifyTransformFocus",...args)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var _len12=arguments.length,args=new Array(_len12),_key12=0;_key12<_len12;_key12++)args[_key12]=arguments[_key12];return _this.runHooks("modifyTransformEnd",...args)})).addLocalHook("afterModifyTransformEnd",(function(){for(var _len13=arguments.length,args=new Array(_len13),_key13=0;_key13<_len13;_key13++)args[_key13]=arguments[_key13];return _this.runHooks("afterModifyTransformEnd",...args)})).addLocalHook("beforeRowWrap",(function(){for(var _len14=arguments.length,args=new Array(_len14),_key14=0;_key14<_len14;_key14++)args[_key14]=arguments[_key14];return _this.runHooks("beforeRowWrap",...args)})).addLocalHook("beforeColumnWrap",(function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];return _this.runHooks("beforeColumnWrap",...args)})).addLocalHook("insertRowRequire",(totalRows=>this.alter("insert_row_above",totalRows,1,"auto"))).addLocalHook("insertColRequire",(totalCols=>this.alter("insert_col_start",totalCols,1,"auto"))),grid={alter(action,index){let amount=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,source=arguments.length>3?arguments[3]:void 0,keepEmptyRows=arguments.length>4?arguments[4]:void 0;const normalizeIndexesGroup=indexes=>{if(0===indexes.length)return[];const sortedIndexes=[...indexes];sortedIndexes.sort(((_ref2,_ref3)=>{let[indexA]=_ref2,[indexB]=_ref3;return indexA===indexB?0:indexA>indexB?1:-1}));return(0,array.mu)(sortedIndexes,((acc,_ref4)=>{let[groupIndex,groupAmount]=_ref4;const previousItem=acc[acc.length-1],[prevIndex,prevAmount]=previousItem,prevLastIndex=prevIndex+prevAmount;if(groupIndex<=prevLastIndex){const amountToAdd=Math.max(groupAmount-(prevLastIndex-groupIndex),0);previousItem[1]+=amountToAdd}else acc.push([groupIndex,groupAmount]);return acc}),[sortedIndexes[0]])};switch(action){case"insert_row_below":case"insert_row_above":const numberOfSourceRows=instance.countSourceRows();if(tableMeta.maxRows===numberOfSourceRows)return;const insertRowMode="insert_row_below"===action?"below":"above";index=null!=index?index:"below"===insertRowMode?numberOfSourceRows:0;const{delta:rowDelta,startPhysicalIndex:startRowPhysicalIndex}=datamap.createRow(index,amount,{source,mode:insertRowMode});selection.shiftRows(instance.toVisualRow(startRowPhysicalIndex),rowDelta);break;case"insert_col_start":case"insert_col_end":const insertColumnMode="insert_col_end"===action?"end":"start";index=null!=index?index:"end"===insertColumnMode?instance.countSourceCols():0;const{delta:colDelta,startPhysicalIndex:startColumnPhysicalIndex}=datamap.createCol(index,amount,{source,mode:insertColumnMode});if(colDelta){if(Array.isArray(tableMeta.colHeaders)){const spliceArray=[instance.toVisualColumn(startColumnPhysicalIndex),0];spliceArray.length+=colDelta,Array.prototype.splice.apply(tableMeta.colHeaders,spliceArray)}selection.shiftColumns(instance.toVisualColumn(startColumnPhysicalIndex),colDelta)}break;case"remove_row":const removeRow=indexes=>{let offset=0;(0,array.z0)(indexes,(_ref5=>{let[groupIndex,groupAmount]=_ref5;const calcIndex=(0,mixed.Im)(groupIndex)?instance.countRows()-1:Math.max(groupIndex-offset,0);Number.isInteger(groupIndex)&&(groupIndex=Math.max(groupIndex-offset,0));if(!datamap.removeRow(groupIndex,groupAmount,source))return;if(selection.isSelected()){const{row}=instance.getSelectedRangeLast().highlight;row>=groupIndex&&row<=groupIndex+groupAmount-1&&editorManager.closeEditor(!0)}const totalRows=instance.countRows();0===totalRows?selection.deselect():"ContextMenu.removeRow"===source?selection.refresh():selection.shiftRows(groupIndex,-groupAmount);const fixedRowsTop=tableMeta.fixedRowsTop;fixedRowsTop>=calcIndex+1&&(tableMeta.fixedRowsTop-=Math.min(groupAmount,fixedRowsTop-calcIndex));const fixedRowsBottom=tableMeta.fixedRowsBottom;fixedRowsBottom&&calcIndex>=totalRows-fixedRowsBottom&&(tableMeta.fixedRowsBottom-=Math.min(groupAmount,fixedRowsBottom)),offset+=groupAmount}))};Array.isArray(index)?removeRow(normalizeIndexesGroup(index)):removeRow([[index,amount]]);break;case"remove_col":const removeCol=indexes=>{let offset=0;(0,array.z0)(indexes,(_ref6=>{let[groupIndex,groupAmount]=_ref6;const calcIndex=(0,mixed.Im)(groupIndex)?instance.countCols()-1:Math.max(groupIndex-offset,0);let physicalColumnIndex=instance.toPhysicalColumn(calcIndex);Number.isInteger(groupIndex)&&(groupIndex=Math.max(groupIndex-offset,0));if(!datamap.removeCol(groupIndex,groupAmount,source))return;if(selection.isSelected()){const{col}=instance.getSelectedRangeLast().highlight;col>=groupIndex&&col<=groupIndex+groupAmount-1&&editorManager.closeEditor(!0)}0===instance.countCols()?selection.deselect():"ContextMenu.removeColumn"===source?selection.refresh():selection.shiftColumns(groupIndex,-groupAmount);const fixedColumnsStart=tableMeta.fixedColumnsStart;fixedColumnsStart>=calcIndex+1&&(tableMeta.fixedColumnsStart-=Math.min(groupAmount,fixedColumnsStart-calcIndex)),Array.isArray(tableMeta.colHeaders)&&(void 0===physicalColumnIndex&&(physicalColumnIndex=-1),tableMeta.colHeaders.splice(physicalColumnIndex,groupAmount)),offset+=groupAmount}))};Array.isArray(index)?removeCol(normalizeIndexesGroup(index)):removeCol([[index,amount]]);break;default:throw new Error(`There is no such action "${action}"`)}keepEmptyRows||grid.adjustRowsAndCols(),instance.view.render(),instance.view.adjustElementsSize()},adjustRowsAndCols(){const minRows=tableMeta.minRows,minSpareRows=tableMeta.minSpareRows,minCols=tableMeta.minCols,minSpareCols=tableMeta.minSpareCols;if(minRows){const nrOfRows=instance.countRows();nrOfRows<minRows&&datamap.createRow(nrOfRows,minRows-nrOfRows,{source:"auto"})}if(minSpareRows){const emptyRows=instance.countEmptyRows(!0);if(emptyRows<minSpareRows){const emptyRowsMissing=minSpareRows-emptyRows,rowsToCreate=Math.min(emptyRowsMissing,tableMeta.maxRows-instance.countSourceRows());datamap.createRow(instance.countRows(),rowsToCreate,{source:"auto"})}}{let emptyCols;(minCols||minSpareCols)&&(emptyCols=instance.countEmptyCols(!0));let nrOfColumns=instance.countCols();if(minCols&&!tableMeta.columns&&nrOfColumns<minCols){const colsToCreate=minCols-nrOfColumns;emptyCols+=colsToCreate,datamap.createCol(nrOfColumns,colsToCreate,{source:"auto"})}if(minSpareCols&&!tableMeta.columns&&"array"===instance.dataType&&emptyCols<minSpareCols){nrOfColumns=instance.countCols();const emptyColsMissing=minSpareCols-emptyCols,colsToCreate=Math.min(emptyColsMissing,tableMeta.maxCols-nrOfColumns);datamap.createCol(nrOfColumns,colsToCreate,{source:"auto"})}}},populateFromArray(start,input,end,source,method){let r,rlen,c,clen;const setData=[],current={},newDataByColumns=[],startRow=start.row,startColumn=start.col;if(rlen=input.length,0===rlen)return!1;let columnsPopulationEnd=0,rowsPopulationEnd=0;switch((0,object.Gv)(end)&&(columnsPopulationEnd=end.col-startColumn+1,rowsPopulationEnd=end.row-startRow+1),method){case"shift_down":const populatedDataByColumns=(0,array.h9)(input),numberOfDataColumns=populatedDataByColumns.length,numberOfColumnsToPopulate=Math.max(numberOfDataColumns,columnsPopulationEnd),pushedDownDataByRows=instance.getData().slice(startRow),pushedDownDataByColumns=(0,array.h9)(pushedDownDataByRows).slice(startColumn,startColumn+numberOfColumnsToPopulate);for(c=0;c<numberOfColumnsToPopulate;c+=1)if(c<numberOfDataColumns){for(r=0,rlen=populatedDataByColumns[c].length;r<rowsPopulationEnd-rlen;r+=1)populatedDataByColumns[c].push(populatedDataByColumns[c][r%rlen]);c<pushedDownDataByColumns.length?newDataByColumns.push(populatedDataByColumns[c].concat(pushedDownDataByColumns[c])):newDataByColumns.push(populatedDataByColumns[c].concat(new Array(pushedDownDataByRows.length).fill(null)))}else newDataByColumns.push(populatedDataByColumns[c%numberOfDataColumns].concat(pushedDownDataByColumns[c]));instance.populateFromArray(startRow,startColumn,(0,array.h9)(newDataByColumns));break;case"shift_right":const numberOfDataRows=input.length,numberOfRowsToPopulate=Math.max(numberOfDataRows,rowsPopulationEnd),pushedRightDataByRows=instance.getData().slice(startRow).map((rowData=>rowData.slice(startColumn)));for(r=0;r<numberOfRowsToPopulate;r+=1)if(r<numberOfDataRows){for(c=0,clen=input[r].length;c<columnsPopulationEnd-clen;c+=1)input[r].push(input[r][c%clen]);if(r<pushedRightDataByRows.length)for(let i=0;i<pushedRightDataByRows[r].length;i+=1)input[r].push(pushedRightDataByRows[r][i]);else input[r].push(...new Array(pushedRightDataByRows[0].length).fill(null))}else input.push(input[r%rlen].slice(0,numberOfRowsToPopulate).concat(pushedRightDataByRows[r]));instance.populateFromArray(startRow,startColumn,input);break;default:current.row=start.row,current.col=start.col;let cellMeta,skippedRow=0,skippedColumn=0,pushData=!0;const getInputValue=function getInputValue(row){let col=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const rowValue=input[row%input.length];return null!==col?rowValue[col%rowValue.length]:rowValue},rowInputLength=input.length,rowSelectionLength=end?end.row-start.row+1:0;for(rlen=end?rowSelectionLength:Math.max(rowInputLength,rowSelectionLength),r=0;r<rlen&&!(end&&current.row>end.row&&rowSelectionLength>rowInputLength||!tableMeta.allowInsertRow&&current.row>instance.countRows()-1||current.row>=tableMeta.maxRows);r++){const visualRow=r-skippedRow,colInputLength=getInputValue(visualRow).length,colSelectionLength=end?end.col-start.col+1:0;if(clen=end?colSelectionLength:Math.max(colInputLength,colSelectionLength),current.col=start.col,cellMeta=instance.getCellMeta(current.row,current.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!cellMeta.skipRowOnPaste){for(skippedColumn=0,c=0;c<clen&&!(end&&current.col>end.col&&colSelectionLength>colInputLength||!tableMeta.allowInsertColumn&&current.col>instance.countCols()-1||current.col>=tableMeta.maxCols);c++){if(cellMeta=instance.getCellMeta(current.row,current.col),("CopyPaste.paste"===source||"Autofill.fill"===source)&&cellMeta.skipColumnOnPaste){skippedColumn+=1,current.col+=1,clen+=1;continue}if(cellMeta.readOnly&&"UndoRedo.undo"!==source){current.col+=1;continue}let value=getInputValue(visualRow,c-skippedColumn),orgValue=instance.getDataAtCell(current.row,current.col);if(null!==value&&"object"==typeof value)if(Array.isArray(value)&&null===orgValue&&(orgValue=[]),null===orgValue||"object"!=typeof orgValue)pushData=!1;else{const orgValueSchema=(0,object.Nl)(Array.isArray(orgValue)?orgValue:orgValue[0]||orgValue),valueSchema=(0,object.Nl)(Array.isArray(value)?value:value[0]||value);(0,object.wU)(orgValueSchema,valueSchema)||Array.isArray(orgValueSchema)&&Array.isArray(valueSchema)?value=(0,object.Go)(value):pushData=!1}else null!==orgValue&&"object"==typeof orgValue&&(pushData=!1);pushData&&setData.push([current.row,current.col,value]),pushData=!0,current.col+=1}current.row+=1}else skippedRow+=1,current.row+=1,rlen+=1}instance.setDataAtCell(setData,null,null,source||"populateFromArray")}}},this.init=function(){dataSource.setData(tableMeta.data),instance.runHooks("beforeInit"),((0,browser.rr)()||(0,browser.zG)())&&(0,dom_element.iQ)(instance.rootElement,"mobile"),this.updateSettings(tableMeta,!0),this.view=new tableView(this);const themeName=tableMeta.themeName||getThemeClassName(instance.rootElement);instance.useTheme(themeName),instance.view.addClassNameToLicenseElement(instance.getCurrentThemeName()),editorManager=handsontable_editorManager.getInstance(instance,tableMeta,selection),viewportScroller=function createViewportScroller(hot){const{selection}=hot;let skipNextCall=!1,isSuspended=!1;return{resume(){isSuspended=!1},suspend(){isSuspended=!0},skipNextScrollCycle(){skipNextCall=!0},scrollTo(cellCoords){var _scrollStrategy;if(skipNextCall||isSuspended)return void(skipNextCall=!1);let scrollStrategy;selection.isFocusSelectionChanged()?scrollStrategy=function focusScrollStrategy(hot){return cellCoords=>{hot.scrollViewportTo(cellCoords.toObject())}}(hot):selection.isSelectedByCorner()?scrollStrategy=()=>{}:selection.isSelectedByRowHeader()?scrollStrategy=function rowHeaderScrollStrategy(hot){return _ref=>{let{row}=_ref;hot.scrollViewportTo({row})}}(hot):selection.isSelectedByColumnHeader()?scrollStrategy=function columnHeaderScrollStrategy(hot){return _ref=>{let{col}=_ref;hot.scrollViewportTo({col})}}(hot):1===selection.getSelectedRange().size()&&selection.isMultiple()?scrollStrategy=function multipleScrollStrategy(hot){return cellCoords=>{hot.scrollViewportTo(cellCoords.toObject())}}(hot):1!==selection.getSelectedRange().size()||selection.isMultiple()?selection.getSelectedRange().size()>1&&(scrollStrategy=function noncontiguousScrollStrategy(hot){return cellCoords=>{hot.scrollViewportTo(cellCoords.toObject())}}(hot)):scrollStrategy=function singleScrollStrategy(hot){return cellCoords=>{const selectionSource=hot.selection.getSelectionSource(),{row,col}=cellCoords;if(row<0&&col>=0)hot.scrollViewportTo({col});else if(col<0&&row>=0)hot.scrollViewportTo({row});else{if("mouse"===selectionSource&&(col===hot.view.getLastPartiallyVisibleColumn()||row===hot.view.getLastPartiallyVisibleRow()))return;hot.scrollViewportTo({row,col})}}}(hot),null===(_scrollStrategy=scrollStrategy)||void 0===_scrollStrategy||_scrollStrategy(cellCoords)}}}(instance),focusManager=new FocusManager(instance),isRootInstance(this)&&installFocusCatcher(instance),instance.runHooks("init"),this.forceFullRender=!0,this.view.render(),firstRun&&null===instance.rootElement.offsetParent&&(0,dom_element.I6)(instance.rootElement,(()=>{instance.view._wt.wtOverlays.updateLastSpreaderSize(),instance.render(),instance.view.adjustElementsSize()})),"object"==typeof firstRun&&(instance.runHooks("afterChange",firstRun[0],firstRun[1]),firstRun=!1),instance.runHooks("afterInit")},this._createCellCoords=function(row,column){return instance.view._wt.createCellCoords(row,column)},this._createCellRange=function(highlight,from,to){return instance.view._wt.createCellRange(highlight,from,to)},this.validateCell=function(value,cellProperties,callback,source){let validator=instance.getCellValidator(cellProperties);function done(valid){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===cellProperties.hidden)return void callback(valid);const col=cellProperties.visualCol,row=cellProperties.visualRow,td=instance.getCell(row,col,!0);if(td&&"TH"!==td.nodeName){const renderableRow=instance.rowIndexMapper.getRenderableFromVisualIndex(row),renderableColumn=instance.columnIndexMapper.getRenderableFromVisualIndex(col);instance.view._wt.getSetting("cellRenderer",renderableRow,renderableColumn,td)}callback(valid)}var expression;(0,mixed.gd)(validator)&&(expression=validator,validator=function(cellValue,validatorCallback){validatorCallback(expression.test(cellValue))}),(0,helpers_function.Tn)(validator)?(value=instance.runHooks("beforeValidate",value,cellProperties.visualRow,cellProperties.prop,source),instance._registerImmediate((()=>{validator.call(cellProperties,value,(valid=>{instance&&(valid=instance.runHooks("afterValidate",valid,value,cellProperties.visualRow,cellProperties.prop,source),cellProperties.valid=valid,done(valid),instance.runHooks("postAfterValidate",valid,value,cellProperties.visualRow,cellProperties.prop,source))}))}))):instance._registerImmediate((()=>{cellProperties.valid=!0,done(cellProperties.valid,!1)}))},this.setDataAtCell=function(row,column,value,source){const input=setDataInputToArray(row,column,value),changes=[];let i,ilen,prop,changeSource=source;for(i=0,ilen=input.length;i<ilen;i++){if("object"!=typeof input[i])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof input[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");prop=input[i][1]>=this.countCols()?input[i][1]:datamap.colToProp(input[i][1]),changes.push([input[i][0],prop,dataSource.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]])}changeSource||"object"!=typeof row||(changeSource=column);const processedChanges=processChanges(changes,changeSource);instance.runHooks("afterSetDataAtCell",processedChanges,changeSource),validateChanges(processedChanges,changeSource,(()=>{applyChanges(processedChanges,changeSource)}))},this.setDataAtRowProp=function(row,prop,value,source){const input=setDataInputToArray(row,prop,value),changes=[];let i,ilen,changeSource=source;for(i=0,ilen=input.length;i<ilen;i++)changes.push([input[i][0],input[i][1],dataSource.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]]);changeSource||"object"!=typeof row||(changeSource=prop);const processedChanges=processChanges(changes,source);instance.runHooks("afterSetDataAtRowProp",processedChanges,changeSource),validateChanges(processedChanges,changeSource,(()=>{applyChanges(processedChanges,changeSource)}))},this.listen=function(){instance&&!instance.isListening()&&(foreignHotInstances.forEach((foreignHot=>{instance!==foreignHot&&foreignHot.unlisten()})),activeGuid=instance.guid,instance.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,instance.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===instance.guid},this.destroyEditor=function(){let revertOriginal=arguments.length>0&&void 0!==arguments[0]&&arguments[0],prepareEditorIfNeeded=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];editorManager.closeEditor(revertOriginal),instance.view.render(),prepareEditorIfNeeded&&selection.isSelected()&&editorManager.prepareEditor()},this.populateFromArray=function(row,column,input,endRow,endCol,source,method){if("object"!=typeof input||"object"!=typeof input[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const c="number"==typeof endRow?instance._createCellCoords(endRow,endCol):null;return grid.populateFromArray(instance._createCellCoords(row,column),input,c,source,method)},this.spliceCol=function(column,index,amount){for(var _len16=arguments.length,elements=new Array(_len16>3?_len16-3:0),_key16=3;_key16<_len16;_key16++)elements[_key16-3]=arguments[_key16];return datamap.spliceCol(column,index,amount,...elements)},this.spliceRow=function(row,index,amount){for(var _len17=arguments.length,elements=new Array(_len17>3?_len17-3:0),_key17=3;_key17<_len17;_key17++)elements[_key17-3]=arguments[_key17];return datamap.spliceRow(row,index,amount,...elements)},this.getSelected=function(){if(selection.isSelected())return(0,array.YD)(selection.getSelectedRange(),(_ref7=>{let{from,to}=_ref7;return[from.row,from.col,to.row,to.col]}))},this.getSelectedLast=function(){const selected=this.getSelected();let result;return selected&&selected.length>0&&(result=selected[selected.length-1]),result},this.getSelectedRange=function(){if(selection.isSelected())return Array.from(selection.getSelectedRange())},this.getSelectedRangeLast=function(){const selectedRange=this.getSelectedRange();let result;return selectedRange&&selectedRange.length>0&&(result=selectedRange[selectedRange.length-1]),result},this.emptySelectedCells=function(source){if(!selection.isSelected()||0===this.countRows()||0===this.countCols())return;const changes=[];(0,array.z0)(selection.getSelectedRange(),(cellRange=>{if(cellRange.isSingleHeader())return;const topStart=cellRange.getTopStartCorner(),bottomEnd=cellRange.getBottomEndCorner();(0,number.Ti)(topStart.row,bottomEnd.row,(row=>{(0,number.Ti)(topStart.col,bottomEnd.col,(column=>{this.getCellMeta(row,column).readOnly||changes.push([row,column,null])}))}))})),changes.length>0&&this.setDataAtCell(changes,source)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const nextValue=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(nextValue,0),this.isRenderSuspended()||nextValue!==this.renderSuspendedCounter||(this.renderCall?this.render():instance.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||instance.view.render())},this.batchRender=function(wrappedOperations){this.suspendRender();const result=wrappedOperations();return this.resumeRender(),result},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let forceFlushChanges=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const nextValue=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(nextValue,0),(!this.isExecutionSuspended()&&nextValue===this.executionSuspendedCounter||forceFlushChanges)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(wrappedOperations){let forceFlushChanges=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const result=wrappedOperations();return this.resumeExecution(forceFlushChanges),result},this.batch=function(wrappedOperations){this.suspendRender(),this.suspendExecution();const result=wrappedOperations();return this.resumeExecution(),this.resumeRender(),result},this.refreshDimensions=function(){if(!instance.view)return;const view=instance.view,{width:lastWidth,height:lastHeight}=view.getLastSize(),{width,height}=instance.rootElement.getBoundingClientRect(),isSizeChanged=width!==lastWidth||height!==lastHeight;!1===instance.runHooks("beforeRefreshDimensions",{width:lastWidth,height:lastHeight},{width,height},isSizeChanged)||((isSizeChanged||view._wt.wtOverlays.scrollableElement===instance.rootWindow)&&(view.setLastSize(width,height),instance.render(),view.adjustElementsSize()),instance.runHooks("afterRefreshDimensions",{width:lastWidth,height:lastHeight},{width,height},isSizeChanged))},this.updateData=function(data,source){replaceData(data,(newDataMap=>{datamap=newDataMap}),(newDataMap=>{datamap=newDataMap,instance.columnIndexMapper.fitToLength(this.getInitialColumnCount()),instance.rowIndexMapper.fitToLength(this.countSourceRows()),grid.adjustRowsAndCols(),selection.refresh()}),{hotInstance:instance,dataMap:datamap,dataSource,internalSource:"updateData",source,metaManager,firstRun})},this.loadData=function(data,source){replaceData(data,(newDataMap=>{datamap=newDataMap}),(()=>{metaManager.clearCellsCache(),instance.initIndexMappers(),grid.adjustRowsAndCols(),selection.refresh(),firstRun&&(firstRun=[null,"loadData"])}),{hotInstance:instance,dataMap:datamap,dataSource,internalSource:"loadData",source,metaManager,firstRun})},this.getInitialColumnCount=function(){const columnsSettings=tableMeta.columns;let finalNrOfColumns=0;if(Array.isArray(columnsSettings))finalNrOfColumns=columnsSettings.length;else if((0,helpers_function.Tn)(columnsSettings))if("array"===instance.dataType){const nrOfSourceColumns=this.countSourceCols();for(let columnIndex=0;columnIndex<nrOfSourceColumns;columnIndex+=1)columnsSettings(columnIndex)&&(finalNrOfColumns+=1)}else"object"!==instance.dataType&&"function"!==instance.dataType||(finalNrOfColumns=datamap.colToPropCache.length);else if((0,mixed.O9)(tableMeta.dataSchema)){const schema=datamap.getSchema();finalNrOfColumns=Array.isArray(schema)?schema.length:(0,object.$3)(schema)}else finalNrOfColumns=this.countSourceCols();return finalNrOfColumns},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(row,column,row2,column2){return(0,mixed.b0)(row)?datamap.getAll():datamap.getRange(instance._createCellCoords(row,column),instance._createCellCoords(row2,column2),datamap.DESTINATION_RENDERER)},this.getCopyableText=function(startRow,startCol,endRow,endCol){return datamap.getCopyableText(instance._createCellCoords(startRow,startCol),instance._createCellCoords(endRow,endCol))},this.getCopyableData=function(row,column){return datamap.getCopyable(row,datamap.colToProp(column))},this.getSchema=function(){return datamap.getSchema()},this.updateSettings=function(settings){let init=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const dataUpdateFunction=(firstRun?instance.loadData:instance.updateData).bind(this);let i,j,columnsAsFunc=!1;if((0,mixed.O9)(settings.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,mixed.O9)(settings.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,mixed.O9)(settings.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(i in settings)"data"===i||("language"===i?setLanguage(settings.language):"className"===i?setClassName("className",settings.className):"tableClassName"===i&&instance.table?(setClassName("tableClassName",settings.tableClassName),instance.view._wt.wtOverlays.syncOverlayTableClassNames()):hooks.R.getSingleton().isRegistered(i)||hooks.R.getSingleton().isDeprecated(i)?(0,helpers_function.Tn)(settings[i])?hooks.R.getSingleton().addAsFixed(i,settings[i],instance):Array.isArray(settings[i])&&hooks.R.getSingleton().add(i,settings[i],instance):!init&&(0,object.mQ)(settings,i)&&(globalMeta[i]=settings[i]));void 0===settings.data&&void 0===tableMeta.data?dataUpdateFunction(null,"updateSettings"):void 0!==settings.data?dataUpdateFunction(settings.data,"updateSettings"):void 0!==settings.columns&&(datamap.createMap(),instance.initIndexMappers());const clen=instance.countCols(),columnSetting=tableMeta.columns;if(columnSetting&&(0,helpers_function.Tn)(columnSetting)&&(columnsAsFunc=!0),void 0===settings.cell&&void 0===settings.cells&&void 0===settings.columns||metaManager.clearCache(),clen>0)for(i=0,j=0;i<clen;i++){if(columnSetting){const column=columnsAsFunc?columnSetting(i):columnSetting[j];column&&metaManager.updateColumnMeta(j,column)}j+=1}(0,mixed.O9)(settings.cell)&&(0,object.v4)(settings.cell,(cell=>{instance.setCellMetaObject(cell.row,cell.col,cell)})),instance.runHooks("afterCellMetaReset");let currentHeight=instance.rootElement.style.height;""!==currentHeight&&(currentHeight=parseInt(instance.rootElement.style.height,10));let height=settings.height;if((0,helpers_function.Tn)(height)&&(height=height()),init){instance.rootElement.getAttribute("style")&&instance.rootElement.setAttribute("data-initialstyle",instance.rootElement.getAttribute("style"))}if(null===height){const initialStyle=instance.rootElement.getAttribute("data-initialstyle");initialStyle&&(initialStyle.indexOf("height")>-1||initialStyle.indexOf("overflow")>-1)?instance.rootElement.setAttribute("style",initialStyle):(instance.rootElement.style.height="",instance.rootElement.style.overflow="")}else void 0!==height&&(instance.rootElement.style.height=isNaN(height)?`${height}`:`${height}px`,instance.rootElement.style.overflow="hidden");if(void 0!==settings.width){let width=settings.width;(0,helpers_function.Tn)(width)&&(width=width()),instance.rootElement.style.width=isNaN(width)?`${width}`:`${width}px`}if(!init){if(instance.view){instance.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),instance.view._wt.exportSettingsAsClassNames();const currentThemeName=instance.getCurrentThemeName(),themeNameOptionExists=(0,object.mQ)(settings,"themeName");currentThemeName&&themeNameOptionExists&&currentThemeName!==settings.themeName&&(instance.view.getStylesHandler().removeClassNames(),instance.view.removeClassNameFromLicenseElement(currentThemeName));const themeName=themeNameOptionExists&&settings.themeName||getThemeClassName(instance.rootElement);instance.useTheme(themeName),instance.view.addClassNameToLicenseElement(instance.getCurrentThemeName())}instance.runHooks("afterUpdateSettings",settings)}grid.adjustRowsAndCols(),instance.view&&!firstRun&&(instance.forceFullRender=!0,instance.view.render(),instance.view._wt.wtOverlays.adjustElementsSize()),init||!instance.view||""!==currentHeight&&""!==height&&void 0!==height||currentHeight===height||instance.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const sel=instance.getSelectedLast();if(tableMeta.getValue){if((0,helpers_function.Tn)(tableMeta.getValue))return tableMeta.getValue.call(instance);if(sel)return instance.getData()[sel[0][0]][tableMeta.getValue]}else if(sel)return instance.getDataAtCell(sel[0],sel[1])},this.getSettings=function(){return tableMeta},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(action,index,amount,source,keepEmptyRows){grid.alter(action,index,amount,source,keepEmptyRows)},this.getCell=function(row,column){let topmost=arguments.length>2&&void 0!==arguments[2]&&arguments[2],renderableColumnIndex=column,renderableRowIndex=row;if(column>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(column)))return null;renderableColumnIndex=this.columnIndexMapper.getRenderableFromVisualIndex(column)}if(row>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(row)))return null;renderableRowIndex=this.rowIndexMapper.getRenderableFromVisualIndex(row)}return null===renderableRowIndex||null===renderableColumnIndex||void 0===renderableRowIndex||void 0===renderableColumnIndex?null:instance.view.getCellAtCoords(instance._createCellCoords(renderableRowIndex,renderableColumnIndex),topmost)},this.getCoords=function(element){const renderableCoords=this.view._wt.wtTable.getCoords(element);if(null===renderableCoords)return null;const{row:renderableRow,col:renderableColumn}=renderableCoords;let visualRow=renderableRow,visualColumn=renderableColumn;return renderableRow>=0&&(visualRow=this.rowIndexMapper.getVisualFromRenderableIndex(renderableRow)),renderableColumn>=0&&(visualColumn=this.columnIndexMapper.getVisualFromRenderableIndex(renderableColumn)),instance._createCellCoords(visualRow,visualColumn)},this.colToProp=function(column){return datamap.colToProp(column)},this.propToCol=function(prop){return datamap.propToCol(prop)},this.toVisualRow=row=>this.rowIndexMapper.getVisualFromPhysicalIndex(row),this.toVisualColumn=column=>this.columnIndexMapper.getVisualFromPhysicalIndex(column),this.toPhysicalRow=row=>this.rowIndexMapper.getPhysicalFromVisualIndex(row),this.toPhysicalColumn=column=>this.columnIndexMapper.getPhysicalFromVisualIndex(column),this.getDataAtCell=function(row,column){return datamap.get(row,datamap.colToProp(column))},this.getDataAtRowProp=function(row,prop){return datamap.get(row,prop)},this.getDataAtCol=function(column){const columnData=[],dataByRows=datamap.getRange(instance._createCellCoords(0,column),instance._createCellCoords(tableMeta.data.length-1,column),datamap.DESTINATION_RENDERER);for(let i=0;i<dataByRows.length;i+=1)for(let j=0;j<dataByRows[i].length;j+=1)columnData.push(dataByRows[i][j]);return columnData},this.getDataAtProp=function(prop){const columnData=[],dataByRows=datamap.getRange(instance._createCellCoords(0,datamap.propToCol(prop)),instance._createCellCoords(tableMeta.data.length-1,datamap.propToCol(prop)),datamap.DESTINATION_RENDERER);for(let i=0;i<dataByRows.length;i+=1)for(let j=0;j<dataByRows[i].length;j+=1)columnData.push(dataByRows[i][j]);return columnData},this.getSourceData=function(row,column,row2,column2){let data;return data=void 0===row?dataSource.getData():dataSource.getByRange(instance._createCellCoords(row,column),instance._createCellCoords(row2,column2)),data},this.getSourceDataArray=function(row,column,row2,column2){let data;return data=void 0===row?dataSource.getData(!0):dataSource.getByRange(instance._createCellCoords(row,column),instance._createCellCoords(row2,column2),!0),data},this.getSourceDataAtCol=function(column){return dataSource.getAtColumn(column)},this.setSourceDataAtCell=function(row,column,value,source){const input=setDataInputToArray(row,column,value),isThereAnySetSourceListener=this.hasHook("afterSetSourceDataAtCell"),changesForHook=[];isThereAnySetSourceListener&&(0,array.z0)(input,(_ref8=>{let[changeRow,changeProp,changeValue]=_ref8;changesForHook.push([changeRow,changeProp,dataSource.getAtCell(changeRow,changeProp),changeValue])})),(0,array.z0)(input,(_ref9=>{let[changeRow,changeProp,changeValue]=_ref9;dataSource.setAtCell(changeRow,changeProp,changeValue)})),isThereAnySetSourceListener&&this.runHooks("afterSetSourceDataAtCell",changesForHook,source),this.render();const activeEditor=instance.getActiveEditor();activeEditor&&(0,mixed.O9)(activeEditor.refreshValue)&&activeEditor.refreshValue()},this.getSourceDataAtRow=function(row){return dataSource.getAtRow(row)},this.getSourceDataAtCell=function(row,column){return dataSource.getAtCell(row,column)},this.getDataAtRow=function(row){return datamap.getRange(instance._createCellCoords(row,0),instance._createCellCoords(row,this.countCols()-1),datamap.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(rowFrom,columnFrom,rowTo,columnTo){const coords=void 0===rowFrom?[0,0,this.countRows(),this.countCols()]:[rowFrom,columnFrom,rowTo,columnTo],[rowStart,columnStart]=coords;let[,,rowEnd,columnEnd]=coords,previousType=null,currentType=null;void 0===rowEnd&&(rowEnd=rowStart),void 0===columnEnd&&(columnEnd=columnStart);let type="mixed";return(0,number.Ti)(Math.max(Math.min(rowStart,rowEnd),0),Math.max(rowStart,rowEnd),(row=>{let isTypeEqual=!0;return(0,number.Ti)(Math.max(Math.min(columnStart,columnEnd),0),Math.max(columnStart,columnEnd),(column=>{const cellType=this.getCellMeta(row,column);return currentType=cellType.type,previousType?isTypeEqual=previousType===currentType:previousType=currentType,isTypeEqual})),type=isTypeEqual?currentType:"mixed",isTypeEqual})),type},this.removeCellMeta=function(row,column,key){const[physicalRow,physicalColumn]=[this.toPhysicalRow(row),this.toPhysicalColumn(column)];let cachedValue=metaManager.getCellMetaKeyValue(physicalRow,physicalColumn,key);!1!==instance.runHooks("beforeRemoveCellMeta",row,column,key,cachedValue)&&(metaManager.removeCellMeta(physicalRow,physicalColumn,key),instance.runHooks("afterRemoveCellMeta",row,column,key,cachedValue)),cachedValue=null},this.spliceCellsMeta=function(visualIndex){let deleteAmount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var _len18=arguments.length,cellMetaRows=new Array(_len18>2?_len18-2:0),_key18=2;_key18<_len18;_key18++)cellMetaRows[_key18-2]=arguments[_key18];if(cellMetaRows.length>0&&!Array.isArray(cellMetaRows[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");deleteAmount>0&&metaManager.removeRow(this.toPhysicalRow(visualIndex),deleteAmount),cellMetaRows.length>0&&(0,array.z0)(cellMetaRows.reverse(),(cellMetaRow=>{metaManager.createRow(this.toPhysicalRow(visualIndex)),(0,array.z0)(cellMetaRow,((cellMeta,columnIndex)=>this.setCellMetaObject(visualIndex,columnIndex,cellMeta)))})),instance.render()},this.setCellMetaObject=function(row,column,prop){"object"==typeof prop&&(0,object.v4)(prop,((value,key)=>{this.setCellMeta(row,column,key,value)}))},this.setCellMeta=function(row,column,key,value){if(!1===instance.runHooks("beforeSetCellMeta",row,column,key,value))return;let physicalRow=row,physicalColumn=column;row<this.countRows()&&(physicalRow=this.toPhysicalRow(row)),column<this.countCols()&&(physicalColumn=this.toPhysicalColumn(column)),metaManager.setCellMeta(physicalRow,physicalColumn,key,value),instance.runHooks("afterSetCellMeta",row,column,key,value)},this.getCellsMeta=function(){return metaManager.getCellsMeta()},this.getCellMeta=function(row,column){let physicalRow=this.toPhysicalRow(row),physicalColumn=this.toPhysicalColumn(column);return null===physicalRow&&(physicalRow=row),null===physicalColumn&&(physicalColumn=column),metaManager.getCellMeta(physicalRow,physicalColumn,{visualRow:row,visualColumn:column})},this.getColumnMeta=function(column){return metaManager.getColumnMeta(this.toPhysicalColumn(column))},this.getCellMetaAtRow=function(row){return metaManager.getCellsMetaAtRow(row)},this.isColumnModificationAllowed=function(){return!("object"===instance.dataType||tableMeta.columns)},this.getCellRenderer=function(rowOrMeta,column){const cellRenderer="number"==typeof rowOrMeta?instance.getCellMeta(rowOrMeta,column).renderer:rowOrMeta.renderer;return"string"==typeof cellRenderer?(0,renderers_registry.gB)(cellRenderer):(0,mixed.b0)(cellRenderer)?(0,renderers_registry.gB)("text"):cellRenderer},this.getCellEditor=function(rowOrMeta,column){const cellEditor="number"==typeof rowOrMeta?instance.getCellMeta(rowOrMeta,column).editor:rowOrMeta.editor;return"string"==typeof cellEditor?(0,registry.M8)(cellEditor):(0,mixed.b0)(cellEditor)?(0,registry.M8)("text"):cellEditor},this.getCellValidator=function(rowOrMeta,column){const cellValidator="number"==typeof rowOrMeta?instance.getCellMeta(rowOrMeta,column).validator:rowOrMeta.validator;return"string"==typeof cellValidator?(0,validators_registry.by)(cellValidator):cellValidator},this.validateCells=function(callback){this._validateCells(callback)},this.validateRows=function(rows,callback){if(!Array.isArray(rows))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(callback,rows)},this.validateColumns=function(columns,callback){if(!Array.isArray(columns))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(callback,void 0,columns)},this._validateCells=function(callback,rows,columns){const waitingForValidator=new ValidatorsQueue;callback&&(waitingForValidator.onQueueEmpty=callback);let i=instance.countRows()-1;for(;i>=0;){if(void 0!==rows&&-1===rows.indexOf(i)){i-=1;continue}let j=instance.countCols()-1;for(;j>=0;)void 0===columns||-1!==columns.indexOf(j)?(waitingForValidator.addValidatorToQueue(),instance.validateCell(instance.getDataAtCell(i,j),instance.getCellMeta(i,j),(result=>{if("boolean"!=typeof result)throw new Error("Validation error: result is not boolean");!1===result&&(waitingForValidator.valid=!1),waitingForValidator.removeValidatorFormQueue()}),"validateCells"),j-=1):j-=1;i-=1}waitingForValidator.checkIfQueueIsEmpty()},this.getRowHeader=function(row){let rowHeader=tableMeta.rowHeaders,physicalRow=row;return void 0!==physicalRow&&(physicalRow=instance.runHooks("modifyRowHeader",physicalRow)),void 0===physicalRow?(rowHeader=[],(0,number.Ti)(instance.countRows()-1,(i=>{rowHeader.push(instance.getRowHeader(i))}))):Array.isArray(rowHeader)&&void 0!==rowHeader[physicalRow]?rowHeader=rowHeader[physicalRow]:(0,helpers_function.Tn)(rowHeader)?rowHeader=rowHeader(physicalRow):rowHeader&&"string"!=typeof rowHeader&&"number"!=typeof rowHeader&&(rowHeader=physicalRow+1),rowHeader},this.hasRowHeaders=function(){return!!tableMeta.rowHeaders},this.hasColHeaders=function(){if(void 0!==tableMeta.colHeaders&&null!==tableMeta.colHeaders)return!!tableMeta.colHeaders;for(let i=0,ilen=instance.countCols();i<ilen;i++)if(instance.getColHeader(i))return!0;return!1},this.getColHeader=function(column){let headerLevel=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const columnIndex=instance.runHooks("modifyColHeader",column);if(void 0===columnIndex){const out=[],ilen=instance.countCols();for(let i=0;i<ilen;i++)out.push(instance.getColHeader(i));return out}let result=tableMeta.colHeaders;const physicalColumn=instance.toPhysicalColumn(columnIndex),prop=function(visualColumnIndex){const arr=[],columnsLen=instance.countCols();let index=0;for(;index<columnsLen;index++)(0,helpers_function.Tn)(tableMeta.columns)&&tableMeta.columns(index)&&arr.push(index);return arr[visualColumnIndex]}(physicalColumn);return!1===tableMeta.colHeaders?result=null:tableMeta.columns&&(0,helpers_function.Tn)(tableMeta.columns)&&tableMeta.columns(prop)&&tableMeta.columns(prop).title?result=tableMeta.columns(prop).title:tableMeta.columns&&tableMeta.columns[physicalColumn]&&tableMeta.columns[physicalColumn].title?result=tableMeta.columns[physicalColumn].title:Array.isArray(tableMeta.colHeaders)&&void 0!==tableMeta.colHeaders[physicalColumn]?result=tableMeta.colHeaders[physicalColumn]:(0,helpers_function.Tn)(tableMeta.colHeaders)?result=tableMeta.colHeaders(physicalColumn):tableMeta.colHeaders&&"string"!=typeof tableMeta.colHeaders&&"number"!=typeof tableMeta.colHeaders&&(result=(0,data.$I)(columnIndex)),result=instance.runHooks("modifyColumnHeaderValue",result,column,headerLevel),result},this._getColWidthFromSettings=function(col){let width;if(col>=0){width=instance.getCellMeta(0,col).width}if(void 0!==width&&width!==tableMeta.width||(width=tableMeta.colWidths),null!=width){switch(typeof width){case"object":width=width[col];break;case"function":width=width(col)}"string"==typeof width&&(width=parseInt(width,10))}return width},this.getColWidth=function(column,source){let width=instance._getColWidthFromSettings(column);return width=instance.runHooks("modifyColWidth",width,column,source),void 0===width&&(width=viewportColumns.j),width},this._getRowHeightFromSettings=function(row){const defaultRowHeight=this.view.getDefaultRowHeight();let height=tableMeta.rowHeights;if(null!=height){switch(typeof height){case"object":height=height[row];break;case"function":height=height(row)}"string"==typeof height&&(height=parseInt(height,10))}return null!=height&&height<defaultRowHeight?defaultRowHeight:height},this.getRowHeight=function(row,source){let height=instance._getRowHeightFromSettings(row);return height=instance.runHooks("modifyRowHeight",height,row,source),height},this.countSourceRows=function(){return dataSource.countRows()},this.countSourceCols=function(){return dataSource.countFirstRowKeys()},this.countRows=function(){return datamap.getLength()},this.countCols=function(){const maxCols=tableMeta.maxCols,dataLen=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(maxCols,dataLen)},this.countRenderedRows=function(){return instance.view._wt.drawn?instance.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return instance.view._wt.drawn?instance.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return instance.view._wt.drawn?instance.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return instance.view._wt.drawn?instance.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let ending=arguments.length>0&&void 0!==arguments[0]&&arguments[0],emptyRows=0;return(0,number.fk)(instance.countRows()-1,(visualIndex=>{if(instance.isEmptyRow(visualIndex))emptyRows+=1;else if(!0===ending)return!1})),emptyRows},this.countEmptyCols=function(){let ending=arguments.length>0&&void 0!==arguments[0]&&arguments[0],emptyColumns=0;return(0,number.fk)(instance.countCols()-1,(visualIndex=>{if(instance.isEmptyCol(visualIndex))emptyColumns+=1;else if(!0===ending)return!1})),emptyColumns},this.isEmptyRow=function(row){return tableMeta.isEmptyRow.call(instance,row)},this.isEmptyCol=function(column){return tableMeta.isEmptyCol.call(instance,column)},this.selectCell=function(row,column,endRow,endColumn){let scrollToCell=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],changeListener=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!(0,mixed.b0)(row)&&!(0,mixed.b0)(column)&&this.selectCells([[row,column,endRow,endColumn]],scrollToCell,changeListener)},this.selectCells=function(){let coords=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],changeListener=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&viewportScroller.suspend();const wasSelected=selection.selectCells(coords);return wasSelected&&changeListener&&instance.listen(),viewportScroller.resume(),wasSelected},this.selectColumns=function(startColumn){let endColumn=arguments.length>1&&void 0!==arguments[1]?arguments[1]:startColumn,focusPosition=arguments.length>2?arguments[2]:void 0;return selection.selectColumns(startColumn,endColumn,focusPosition)},this.selectRows=function(startRow){let endRow=arguments.length>1&&void 0!==arguments[1]?arguments[1]:startRow,focusPosition=arguments.length>2?arguments[2]:void 0;return selection.selectRows(startRow,endRow,focusPosition)},this.deselectCell=function(){selection.deselect()},this.selectAll=function(){let includeRowHeaders=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],includeColumnHeaders=arguments.length>1&&void 0!==arguments[1]?arguments[1]:includeRowHeaders,options=arguments.length>2?arguments[2]:void 0;viewportScroller.skipNextScrollCycle(),selection.selectAll(includeRowHeaders,includeColumnHeaders,options)};const getIndexToScroll=(indexMapper,visualIndex)=>indexMapper.getNearestNotHiddenIndex(visualIndex,1,!0);this.scrollViewportTo=function(options){var _arguments$;"number"==typeof options&&(options={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(_arguments$=arguments[4])||void 0===_arguments$||_arguments$});const{row,col,considerHiddenIndexes}=null!=options?options:{};let renderableRow=row,renderableColumn=col;if(void 0===considerHiddenIndexes||considerHiddenIndexes){const isValidRowGrid=Number.isInteger(row)&&row>=0,isValidColumnGrid=Number.isInteger(col)&&col>=0,visualRowToScroll=isValidRowGrid?getIndexToScroll(this.rowIndexMapper,row):void 0,visualColumnToScroll=isValidColumnGrid?getIndexToScroll(this.columnIndexMapper,col):void 0;if(null===visualRowToScroll||null===visualColumnToScroll)return!1;renderableRow=isValidRowGrid?instance.rowIndexMapper.getRenderableFromVisualIndex(visualRowToScroll):row,renderableColumn=isValidColumnGrid?instance.columnIndexMapper.getRenderableFromVisualIndex(visualColumnToScroll):col}const isRowInteger=Number.isInteger(renderableRow),isColumnInteger=Number.isInteger(renderableColumn);return isRowInteger&&renderableRow>=0&&isColumnInteger&&renderableColumn>=0?instance.view.scrollViewport(instance._createCellCoords(renderableRow,renderableColumn),options.horizontalSnap,options.verticalSnap):isRowInteger&&renderableRow>=0&&(isColumnInteger&&renderableColumn<0||!isColumnInteger)?instance.view.scrollViewportVertically(renderableRow,options.verticalSnap):!!(isColumnInteger&&renderableColumn>=0&&(isRowInteger&&renderableRow<0||!isRowInteger))&&instance.view.scrollViewportHorizontally(renderableColumn,options.horizontalSnap)},this.scrollToFocusedCell=function(){let callback=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",callback);const{highlight}=this.getSelectedRangeLast();this.scrollViewportTo(highlight.toObject())?this.view.render():(this.removeHook("afterScroll",callback),this._registerImmediate((()=>callback())))},this.destroy=function(){if(instance._clearTimeouts(),instance._clearImmediates(),instance.view&&instance.view.destroy(),dataSource&&dataSource.destroy(),dataSource=null,this.getShortcutManager().destroy(),metaManager.clearCache(),foreignHotInstances.delete(this.guid),isRootInstance(instance)){const licenseInfo=this.rootDocument.querySelector(".hot-display-license-info");licenseInfo&&licenseInfo.parentNode.removeChild(licenseInfo)}(0,dom_element.Ie)(instance.rootElement),eventManager.destroy(),editorManager&&editorManager.destroy(),instance.batchExecution((()=>{instance.rowIndexMapper.unregisterAll(),instance.columnIndexMapper.unregisterAll(),pluginsRegistry.getItems().forEach((_ref10=>{let[,plugin]=_ref10;plugin.destroy()})),pluginsRegistry.clear(),instance.runHooks("afterDestroy")}),!0),hooks.R.getSingleton().destroy(instance),(0,object.v4)(instance,((property,key,obj)=>{(0,helpers_function.Tn)(property)?obj[key]=function postMortem(method){return()=>{throw new Error(`The "${method}" method cannot be called because this Handsontable instance has been destroyed`)}}(key):"guid"!==key&&(obj[key]=null)})),instance.isDestroyed=!0,datamap&&datamap.destroy(),datamap=null,grid=null,selection=null,editorManager=null,instance=null},this.getActiveEditor=function(){return editorManager.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return instance.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return instance.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return instance.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return instance.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return instance.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return instance.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return instance.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return instance.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return instance.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return instance.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return instance.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return instance.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(pluginName){return pluginsRegistry.getItem((0,string.Ob)(pluginName))},this.getPluginName=function(plugin){return plugin===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:pluginsRegistry.getId(plugin)},this.getInstance=function(){return instance},this.addHook=function(key,callback,orderIndex){hooks.R.getSingleton().add(key,callback,instance,orderIndex)},this.hasHook=function(key){return hooks.R.getSingleton().has(key,instance)||hooks.R.getSingleton().has(key)},this.addHookOnce=function(key,callback,orderIndex){hooks.R.getSingleton().once(key,callback,instance,orderIndex)},this.removeHook=function(key,callback){hooks.R.getSingleton().remove(key,callback,instance)},this.runHooks=function(key,p1,p2,p3,p4,p5,p6){return hooks.R.getSingleton().run(instance,key,p1,p2,p3,p4,p5,p6)},this.getTranslatedPhrase=function(dictionaryKey,extraArguments){return getTranslatedPhrase(tableMeta.language,dictionaryKey,extraArguments)},this.toHTML=()=>(0,parseTable.KN)(this),this.toTableElement=()=>{const tempElement=this.rootDocument.createElement("div");return tempElement.insertAdjacentHTML("afterbegin",(0,parseTable.KN)(this)),tempElement.firstElementChild},this.timeouts=[],this.useTheme=themeName=>{this.view.getStylesHandler().useTheme(themeName),this.runHooks("afterSetTheme",themeName,!!firstRun)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(handle){let handleFunc=handle;"function"==typeof handleFunc&&(handleFunc=setTimeout(handleFunc,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(handleFunc)},this._clearTimeouts=function(){(0,array.z0)(this.timeouts,(handler=>{clearTimeout(handler)}))},this.immediates=[],this._registerImmediate=function(callback){this.immediates.push(setImmediate(callback))},this._clearImmediates=function(){(0,array.z0)(this.immediates,(handler=>{clearImmediate(handler)}))},this._getEditorManager=function(){return editorManager};const shortcutManager=createShortcutManager({handleEvent:()=>instance.isListening(),beforeKeyDown:event=>this.runHooks("beforeKeyDown",event),afterKeyDown:event=>{this.isDestroyed||instance.runHooks("afterDocumentKeyDown",event)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(event=>{!1===event.ctrlKey&&!1===event.metaKey&&shortcutManager.releasePressedKeys()})),this.getShortcutManager=function(){return shortcutManager},this.getFocusManager=function(){return focusManager},(0,plugins_registry.f4)().forEach((pluginName=>{const PluginClass=(0,plugins_registry.sd)(pluginName);pluginsRegistry.addItem(pluginName,new PluginClass(this))})),function registerAllShortcutContexts(hotInstance){[shortcutsGridContext,shortcutsEditorContext].forEach((context=>context(hotInstance)))}(instance),shortcutManager.setActiveContextName("grid"),hooks.R.getSingleton().run(instance,"construct")}var textType=__webpack_require__("./node_modules/handsontable/cellTypes/textType/textType.mjs");function Handsontable(rootElement,userSettings){const instance=new Core(rootElement,userSettings||{},rootInstanceSymbol);return instance.init(),instance}(0,cellTypes_registry.Gk)(textType.Y),Handsontable.editors={BaseEditor:baseEditor.b7},Handsontable.Core=function(rootElement){return new Core(rootElement,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},rootInstanceSymbol)},Handsontable.DefaultSettings=metaSchema(),Handsontable.hooks=hooks.R.getSingleton(),Handsontable.CellCoords=coords.A,Handsontable.CellRange=range.A,Handsontable.packageName="handsontable",Handsontable.buildDate="19/03/2025 09:41:52",Handsontable.version="15.2.0",Handsontable.languages={dictionaryKeys,getLanguageDictionary,getLanguagesDictionaries:function getLanguagesDictionaries(){return getGlobalLanguagesDictionaries()},registerLanguageDictionary,getTranslatedPhrase};const base=Handsontable;function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _callSuper(t,o,e){return o=_getPrototypeOf(o),function _possibleConstructorReturn(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(t,_isNativeReflectConstruct()?Reflect.construct(o,e||[],_getPrototypeOf(t).constructor):o.apply(t,e))}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,react_handsontable_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function react_handsontable_defineProperty(e,r,t){return(r=react_handsontable_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _toConsumableArray(r){return function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function react_handsontable_toPropertyKey(t){var i=function react_handsontable_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==typeof i?i:i+""}var bulkComponentContainer=null;function getChildElementByType(children,type){var childrenArray=react.Children.toArray(children),childrenCount=react.Children.count(children),wantedChild=null;return 0!==childrenCount&&(wantedChild=1===childrenCount&&childrenArray[0].props[type]?childrenArray[0]:childrenArray.find((function(child){return void 0!==child.props[type]}))),wantedChild||null}function getOriginalEditorClass(editorElement){return editorElement?editorElement.type.WrappedComponent?editorElement.type.WrappedComponent:editorElement.type:null}function createEditorPortal(doc,editorElement){if(void 0===doc||null===editorElement)return null;var containerProps=getContainerAttributesProps(editorElement.props,!1);return containerProps.className="".concat("hot-wrapper-editor-container"," ").concat(containerProps.className),react_dom.createPortal(react.createElement("div",Object.assign({},containerProps),editorElement),doc.body)}function getExtendedEditorElement(children,editorCache){var editorColumnScope=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"global",editorElement=getChildElementByType(children,"hot-editor"),editorClass=getOriginalEditorClass(editorElement);return editorElement?react.cloneElement(editorElement,{emitEditorInstance:function emitEditorInstance(editorInstance,editorColumnScope){editorCache.get(editorClass)||editorCache.set(editorClass,new Map),editorCache.get(editorClass).set(null!=editorColumnScope?editorColumnScope:"global",editorInstance)},editorColumnScope,isEditor:!0}):null}function createPortal(rElement,props){var ownerDocument=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,portalKey=arguments.length>3?arguments[3]:void 0,cachedContainer=arguments.length>4?arguments[4]:void 0;ownerDocument||(ownerDocument=document),bulkComponentContainer||(bulkComponentContainer=ownerDocument.createDocumentFragment());var portalContainer=null!=cachedContainer?cachedContainer:ownerDocument.createElement("DIV");bulkComponentContainer.appendChild(portalContainer);var extendedRendererElement=react.cloneElement(rElement,function _objectSpread2(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){react_handsontable_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({key:"".concat(props.row,"-").concat(props.col)},props));return{portal:react_dom.createPortal(extendedRendererElement,portalContainer,portalKey),portalContainer}}function getContainerAttributesProps(props){var randomizeId=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:props.id||(randomizeId?"hot-"+Math.random().toString(36).substring(5):void 0),className:props.className||"",style:props.style||{}}}var SettingsMapper=function(){return _createClass((function SettingsMapper(){_classCallCheck(this,SettingsMapper)}),null,[{key:"getSettings",value:function getSettings(properties){var _ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$prevProps=_ref.prevProps,prevProps=void 0===_ref$prevProps?{}:_ref$prevProps,_ref$isInit=_ref.isInit,isInit=void 0!==_ref$isInit&&_ref$isInit,_ref$initOnlySettingK=_ref.initOnlySettingKeys,initOnlySettingKeys=void 0===_ref$initOnlySettingK?[]:_ref$initOnlySettingK,shouldSkipProp=function shouldSkipProp(key){return!(isInit||!initOnlySettingKeys.includes(key))&&prevProps[key]===properties[key]},newSettings={};if(properties.settings){var settings=properties.settings;for(var key in settings)settings.hasOwnProperty(key)&&!shouldSkipProp(key)&&(newSettings[key]=settings[key])}for(var _key in properties)"settings"!==_key&&"children"!==_key&&!shouldSkipProp(_key)&&properties.hasOwnProperty(_key)&&(newSettings[_key]=properties[_key]);return newSettings}}])}(),HotColumn=function(_React$Component){function HotColumn(){return _classCallCheck(this,HotColumn),_callSuper(this,HotColumn,arguments)}return _inherits(HotColumn,_React$Component),_createClass(HotColumn,[{key:"getSettingsProps",value:function getSettingsProps(){var _this=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter((function(key){return!_this.internalProps.includes(key)})).reduce((function(obj,key){return obj[key]=_this.props[key],obj}),{})}},{key:"getLocalEditorElement",value:function getLocalEditorElement(){return getExtendedEditorElement(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function createColumnSettings(){var rendererElement=this.props._getChildElementByType(this.props.children,"hot-renderer"),editorElement=this.getLocalEditorElement();this.columnSettings=SettingsMapper.getSettings(this.getSettingsProps()),null!==rendererElement&&(this.columnSettings.renderer=this.props._getRendererWrapper(rendererElement),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==editorElement&&(this.columnSettings.editor=this.props._getEditorClass(editorElement,this.props._columnIndex))}},{key:"emitColumnSettings",value:function emitColumnSettings(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function componentDidMount(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function render(){var editorPortal=createEditorPortal(this.props._getOwnerDocument(),this.getLocalEditorElement());return react.createElement(react.Fragment,null,editorPortal)}}])}(react.Component),RenderersPortalManager=function(_React$Component){function RenderersPortalManager(){var _this;return _classCallCheck(this,RenderersPortalManager),(_this=_callSuper(this,RenderersPortalManager,arguments)).state={portals:[]},_this}return _inherits(RenderersPortalManager,_React$Component),_createClass(RenderersPortalManager,[{key:"render",value:function render(){return react.createElement(react.Fragment,null,this.state.portals)}}])}(react.Component);function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var propTypes={exports:{}};var ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret,factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;return ReactPropTypesSecret_1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}propTypes.exports=function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var ReactPropTypesSecret=requireReactPropTypesSecret();function emptyFunction(){}function emptyFunctionWithReset(){}return emptyFunctionWithReset.resetWarningCache=emptyFunction,factoryWithThrowingShims=function factoryWithThrowingShims(){function shim(props,propName,componentName,location,propFullName,secret){if(secret!==ReactPropTypesSecret){var err=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw err.name="Invariant Violation",err}}function getShim(){return shim}shim.isRequired=shim;var ReactPropTypes={array:shim,bigint:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return ReactPropTypes.PropTypes=ReactPropTypes,ReactPropTypes}}()();var PropTypes=getDefaultExportFromCjs(propTypes.exports),HotTableClass=function(_React$Component){function HotTableClass(){var _this;return _classCallCheck(this,HotTableClass),(_this=_callSuper(this,HotTableClass,arguments)).id=null,_this.__hotInstance=null,_this.hotElementRef=null,_this.columnSettings=[],_this.renderersPortalManager=null,_this.portalCache=new Map,_this.portalContainerCache=new Map,_this.renderedCellCache=new Map,_this.editorCache=new Map,_this.componentRendererColumns=new Map,_this}return _inherits(HotTableClass,_React$Component),_createClass(HotTableClass,[{key:"hotInstance",get:function get(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set:function set(hotInstance){this.__hotInstance=hotInstance}},{key:"_isHotInstanceDestroyed",value:function _isHotInstanceDestroyed(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function getPortalContainerCache(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function getRenderedCellCache(){return this.renderedCellCache}},{key:"getEditorCache",value:function getEditorCache(){return this.editorCache}},{key:"clearCache",value:function clearCache(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function getOwnerDocument(){return function isCSR(){return"undefined"!=typeof window}()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function setHotElementRef(element){this.hotElementRef=element}},{key:"getRendererWrapper",value:function getRendererWrapper(rendererElement){var hotTableComponent=this;return function __internalRenderer(instance,TD,row,col,prop,value,cellProperties){var renderedCellCache=hotTableComponent.getRenderedCellCache(),portalContainerCache=hotTableComponent.getPortalContainerCache(),key="".concat(row,"-").concat(col),instanceGuid=instance.guid,portalContainerKey="".concat(instanceGuid,"-").concat(key),portalKey="".concat(key,"-").concat(instanceGuid);if(renderedCellCache.has(key)&&(TD.innerHTML=renderedCellCache.get(key).innerHTML),TD&&!TD.getAttribute("ghost-table")){for(var cachedPortal=hotTableComponent.portalCache.get(portalKey),cachedPortalContainer=portalContainerCache.get(portalContainerKey);TD.firstChild;)TD.removeChild(TD.firstChild);if(cachedPortal&&cachedPortalContainer)TD.appendChild(cachedPortalContainer);else{var _createPortal=createPortal(rendererElement,{TD,row,col,prop,value,cellProperties,isRenderer:!0},TD.ownerDocument,portalKey,cachedPortalContainer),portal=_createPortal.portal,portalContainer=_createPortal.portalContainer;portalContainerCache.set(portalContainerKey,portalContainer),TD.appendChild(portalContainer),hotTableComponent.portalCache.set(portalKey,portal)}}return renderedCellCache.set(key,TD),TD}}},{key:"getEditorClass",value:function getEditorClass(editorElement){var _this$getEditorCache$,editorColumnScope=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global",editorClass=getOriginalEditorClass(editorElement),cachedComponent=null===(_this$getEditorCache$=this.getEditorCache().get(editorClass))||void 0===_this$getEditorCache$?void 0:_this$getEditorCache$.get(editorColumnScope);return this.makeEditorClass(cachedComponent)}},{key:"makeEditorClass",value:function makeEditorClass(editorComponent){var customEditorClass=function(_Handsontable$editors){function CustomEditor(hotInstance){var _this2;return _classCallCheck(this,CustomEditor),_this2=_callSuper(this,CustomEditor,[hotInstance]),editorComponent.hotCustomEditorInstance=_this2,_this2.editorComponent=editorComponent,_this2}return _inherits(CustomEditor,_Handsontable$editors),_createClass(CustomEditor,[{key:"focus",value:function focus(){}},{key:"getValue",value:function getValue(){}},{key:"setValue",value:function setValue(){}},{key:"open",value:function open(){}},{key:"close",value:function close(){}}])}(base.editors.BaseEditor);return Object.getOwnPropertyNames(base.editors.BaseEditor.prototype).forEach((function(propName){"constructor"!==propName&&(customEditorClass.prototype[propName]=function(){for(var _editorComponent$prop,_len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_editorComponent$prop=editorComponent[propName]).call.apply(_editorComponent$prop,[editorComponent].concat(args))})})),customEditorClass}},{key:"getGlobalRendererElement",value:function getGlobalRendererElement(){return getChildElementByType(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function getGlobalEditorElement(){return getExtendedEditorElement(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function createNewGlobalSettings(){var _this$hotInstance,_this$props$settings,_this$props$settings2,init=arguments.length>0&&void 0!==arguments[0]&&arguments[0],prevProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},initOnlySettingKeys=this._isHotInstanceDestroyed()?[]:(null===(_this$hotInstance=this.hotInstance)||void 0===_this$hotInstance||null===(_this$hotInstance=_this$hotInstance.getSettings())||void 0===_this$hotInstance?void 0:_this$hotInstance._initOnlySettings)||[],newSettings=SettingsMapper.getSettings(this.props,{prevProps,isInit:init,initOnlySettingKeys}),globalRendererNode=this.getGlobalRendererElement(),globalEditorNode=this.getGlobalEditorElement();(newSettings.columns=this.columnSettings.length?this.columnSettings:newSettings.columns,globalEditorNode)?newSettings.editor=this.getEditorClass(globalEditorNode,"global"):this.props.editor||null!==(_this$props$settings=this.props.settings)&&void 0!==_this$props$settings&&_this$props$settings.editor?newSettings.editor=this.props.editor||this.props.settings.editor:newSettings.editor=(0,registry.M8)("text");globalRendererNode?(newSettings.renderer=this.getRendererWrapper(globalRendererNode),this.componentRendererColumns.set("global",!0)):this.props.renderer||null!==(_this$props$settings2=this.props.settings)&&void 0!==_this$props$settings2&&_this$props$settings2.renderer?newSettings.renderer=this.props.renderer||this.props.settings.renderer:newSettings.renderer=(0,renderers_registry.gB)("text");return newSettings}},{key:"displayAutoSizeWarning",value:function displayAutoSizeWarning(newGlobalSettings){var _this$hotInstance$get,_this$hotInstance$get2;this.hotInstance&&(null!==(_this$hotInstance$get=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==_this$hotInstance$get&&_this$hotInstance$get.enabled||null!==(_this$hotInstance$get2=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==_this$hotInstance$get2&&_this$hotInstance$get2.enabled)&&this.componentRendererColumns.size>0&&function warn(){var _console;"undefined"!=typeof console&&(_console=console).warn.apply(_console,arguments)}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function setHotColumnSettings(columnSettings,columnIndex){this.columnSettings[columnIndex]=columnSettings}},{key:"handsontableBeforeViewRender",value:function handsontableBeforeViewRender(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function handsontableAfterViewRender(){this.renderersPortalManager.setState({portals:_toConsumableArray(this.portalCache.values())})}},{key:"updateHot",value:function updateHot(newSettings){this.hotInstance&&this.hotInstance.updateSettings(newSettings,!1)}},{key:"setRenderersPortalManagerRef",value:function setRenderersPortalManagerRef(pmComponent){this.renderersPortalManager=pmComponent}},{key:"componentDidMount",value:function componentDidMount(){var _this3=this,newGlobalSettings=this.createNewGlobalSettings(!0);this.hotInstance=new base.Core(this.hotElementRef,newGlobalSettings),this.hotInstance.addHook("beforeViewRender",(function(){return _this3.handsontableBeforeViewRender()})),this.hotInstance.addHook("afterViewRender",(function(){return _this3.handsontableAfterViewRender()})),this.hotInstance.init(),this.displayAutoSizeWarning(newGlobalSettings)}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){this.clearCache();var newGlobalSettings=this.createNewGlobalSettings(!1,prevProps);this.updateHot(newGlobalSettings),this.displayAutoSizeWarning(newGlobalSettings)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function render(){var _this4=this,hotColumnClones=react.Children.toArray(this.props.children).filter((function(childNode){return function isHotColumn(childNode){return childNode.type===HotColumn}(childNode)})).map((function(childNode,columnIndex){return react.cloneElement(childNode,{_componentRendererColumns:_this4.componentRendererColumns,_emitColumnSettings:_this4.setHotColumnSettings.bind(_this4),_columnIndex:columnIndex,_getChildElementByType:getChildElementByType.bind(_this4),_getRendererWrapper:_this4.getRendererWrapper.bind(_this4),_getEditorClass:_this4.getEditorClass.bind(_this4),_getOwnerDocument:_this4.getOwnerDocument.bind(_this4),_getEditorCache:_this4.getEditorCache.bind(_this4),children:childNode.props.children})})),containerProps=getContainerAttributesProps(this.props),editorPortal=createEditorPortal(this.getOwnerDocument(),this.getGlobalEditorElement());return react.createElement(react.Fragment,null,react.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},containerProps),hotColumnClones),react.createElement(RenderersPortalManager,{ref:this.setRenderersPortalManagerRef.bind(this)}),editorPortal)}}],[{key:"version",get:function get(){return"15.2.0"}}])}(react.Component);HotTableClass.propTypes={style:PropTypes.object,id:PropTypes.string,className:PropTypes.string};var _excluded=["children"],HotTable=react.forwardRef((function(_ref,ref){var _props$id,children=_ref.children,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),generatedId="function"==typeof react.useId?react.useId():void 0,componentId=null!==(_props$id=props.id)&&void 0!==_props$id?_props$id:generatedId;return react.createElement(HotTableClass,Object.assign({id:componentId},props,{ref}),children)}));HotTable.version=HotTableClass.version;react.Component},"./node_modules/core-js/internals/a-callable.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),tryToString=__webpack_require__("./node_modules/core-js/internals/try-to-string.js"),$TypeError=TypeError;module.exports=function(argument){if(isCallable(argument))return argument;throw new $TypeError(tryToString(argument)+" is not a function")}},"./node_modules/core-js/internals/a-possible-prototype.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isPossiblePrototype=__webpack_require__("./node_modules/core-js/internals/is-possible-prototype.js"),$String=String,$TypeError=TypeError;module.exports=function(argument){if(isPossiblePrototype(argument))return argument;throw new $TypeError("Can't set "+$String(argument)+" as a prototype")}},"./node_modules/core-js/internals/a-set.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var has=__webpack_require__("./node_modules/core-js/internals/set-helpers.js").has;module.exports=function(it){return has(it),it}},"./node_modules/core-js/internals/add-to-unscopables.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),create=__webpack_require__("./node_modules/core-js/internals/object-create.js"),defineProperty=__webpack_require__("./node_modules/core-js/internals/object-define-property.js").f,UNSCOPABLES=wellKnownSymbol("unscopables"),ArrayPrototype=Array.prototype;void 0===ArrayPrototype[UNSCOPABLES]&&defineProperty(ArrayPrototype,UNSCOPABLES,{configurable:!0,value:create(null)}),module.exports=function(key){ArrayPrototype[UNSCOPABLES][key]=!0}},"./node_modules/core-js/internals/an-instance.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-is-prototype-of.js"),$TypeError=TypeError;module.exports=function(it,Prototype){if(isPrototypeOf(Prototype,it))return it;throw new $TypeError("Incorrect invocation")}},"./node_modules/core-js/internals/an-object.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),$String=String,$TypeError=TypeError;module.exports=function(argument){if(isObject(argument))return argument;throw new $TypeError($String(argument)+" is not an object")}},"./node_modules/core-js/internals/array-from-constructor-and-list.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var lengthOfArrayLike=__webpack_require__("./node_modules/core-js/internals/length-of-array-like.js");module.exports=function(Constructor,list,$length){for(var index=0,length=arguments.length>2?$length:lengthOfArrayLike(list),result=new Constructor(length);length>index;)result[index]=list[index++];return result}},"./node_modules/core-js/internals/array-includes.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var toIndexedObject=__webpack_require__("./node_modules/core-js/internals/to-indexed-object.js"),toAbsoluteIndex=__webpack_require__("./node_modules/core-js/internals/to-absolute-index.js"),lengthOfArrayLike=__webpack_require__("./node_modules/core-js/internals/length-of-array-like.js"),createMethod=function(IS_INCLUDES){return function($this,el,fromIndex){var O=toIndexedObject($this),length=lengthOfArrayLike(O);if(0===length)return!IS_INCLUDES&&-1;var value,index=toAbsoluteIndex(fromIndex,length);if(IS_INCLUDES&&el!=el){for(;length>index;)if((value=O[index++])!=value)return!0}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}};module.exports={includes:createMethod(!0),indexOf:createMethod(!1)}},"./node_modules/core-js/internals/array-set-length.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),isArray=__webpack_require__("./node_modules/core-js/internals/is-array.js"),$TypeError=TypeError,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,SILENT_ON_NON_WRITABLE_LENGTH_SET=DESCRIPTORS&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(error){return error instanceof TypeError}}();module.exports=SILENT_ON_NON_WRITABLE_LENGTH_SET?function(O,length){if(isArray(O)&&!getOwnPropertyDescriptor(O,"length").writable)throw new $TypeError("Cannot set read only .length");return O.length=length}:function(O,length){return O.length=length}},"./node_modules/core-js/internals/array-slice.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js");module.exports=uncurryThis([].slice)},"./node_modules/core-js/internals/call-with-safe-iteration-closing.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js");module.exports=function(iterator,fn,value,ENTRIES){try{return ENTRIES?fn(anObject(value)[0],value[1]):fn(value)}catch(error){iteratorClose(iterator,"throw",error)}}},"./node_modules/core-js/internals/classof-raw.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),toString=uncurryThis({}.toString),stringSlice=uncurryThis("".slice);module.exports=function(it){return stringSlice(toString(it),8,-1)}},"./node_modules/core-js/internals/classof.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var TO_STRING_TAG_SUPPORT=__webpack_require__("./node_modules/core-js/internals/to-string-tag-support.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),classofRaw=__webpack_require__("./node_modules/core-js/internals/classof-raw.js"),TO_STRING_TAG=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js")("toStringTag"),$Object=Object,CORRECT_ARGUMENTS="Arguments"===classofRaw(function(){return arguments}());module.exports=TO_STRING_TAG_SUPPORT?classofRaw:function(it){var O,tag,result;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(tag=function(it,key){try{return it[key]}catch(error){}}(O=$Object(it),TO_STRING_TAG))?tag:CORRECT_ARGUMENTS?classofRaw(O):"Object"===(result=classofRaw(O))&&isCallable(O.callee)?"Arguments":result}},"./node_modules/core-js/internals/copy-constructor-properties.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),ownKeys=__webpack_require__("./node_modules/core-js/internals/own-keys.js"),getOwnPropertyDescriptorModule=__webpack_require__("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),definePropertyModule=__webpack_require__("./node_modules/core-js/internals/object-define-property.js");module.exports=function(target,source,exceptions){for(var keys=ownKeys(source),defineProperty=definePropertyModule.f,getOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f,i=0;i<keys.length;i++){var key=keys[i];hasOwn(target,key)||exceptions&&hasOwn(exceptions,key)||defineProperty(target,key,getOwnPropertyDescriptor(source,key))}}},"./node_modules/core-js/internals/correct-prototype-getter.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var fails=__webpack_require__("./node_modules/core-js/internals/fails.js");module.exports=!fails((function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype}))},"./node_modules/core-js/internals/create-iter-result-object.js":module=>{"use strict";module.exports=function(value,done){return{value,done}}},"./node_modules/core-js/internals/create-non-enumerable-property.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),definePropertyModule=__webpack_require__("./node_modules/core-js/internals/object-define-property.js"),createPropertyDescriptor=__webpack_require__("./node_modules/core-js/internals/create-property-descriptor.js");module.exports=DESCRIPTORS?function(object,key,value){return definePropertyModule.f(object,key,createPropertyDescriptor(1,value))}:function(object,key,value){return object[key]=value,object}},"./node_modules/core-js/internals/create-property-descriptor.js":module=>{"use strict";module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value}}},"./node_modules/core-js/internals/create-property.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),definePropertyModule=__webpack_require__("./node_modules/core-js/internals/object-define-property.js"),createPropertyDescriptor=__webpack_require__("./node_modules/core-js/internals/create-property-descriptor.js");module.exports=function(object,key,value){DESCRIPTORS?definePropertyModule.f(object,key,createPropertyDescriptor(0,value)):object[key]=value}},"./node_modules/core-js/internals/define-built-in-accessor.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var makeBuiltIn=__webpack_require__("./node_modules/core-js/internals/make-built-in.js"),defineProperty=__webpack_require__("./node_modules/core-js/internals/object-define-property.js");module.exports=function(target,name,descriptor){return descriptor.get&&makeBuiltIn(descriptor.get,name,{getter:!0}),descriptor.set&&makeBuiltIn(descriptor.set,name,{setter:!0}),defineProperty.f(target,name,descriptor)}},"./node_modules/core-js/internals/define-built-in.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),definePropertyModule=__webpack_require__("./node_modules/core-js/internals/object-define-property.js"),makeBuiltIn=__webpack_require__("./node_modules/core-js/internals/make-built-in.js"),defineGlobalProperty=__webpack_require__("./node_modules/core-js/internals/define-global-property.js");module.exports=function(O,key,value,options){options||(options={});var simple=options.enumerable,name=void 0!==options.name?options.name:key;if(isCallable(value)&&makeBuiltIn(value,name,options),options.global)simple?O[key]=value:defineGlobalProperty(key,value);else{try{options.unsafe?O[key]&&(simple=!0):delete O[key]}catch(error){}simple?O[key]=value:definePropertyModule.f(O,key,{value,enumerable:!1,configurable:!options.nonConfigurable,writable:!options.nonWritable})}return O}},"./node_modules/core-js/internals/define-built-ins.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var defineBuiltIn=__webpack_require__("./node_modules/core-js/internals/define-built-in.js");module.exports=function(target,src,options){for(var key in src)defineBuiltIn(target,key,src[key],options);return target}},"./node_modules/core-js/internals/define-global-property.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),defineProperty=Object.defineProperty;module.exports=function(key,value){try{defineProperty(globalThis,key,{value,configurable:!0,writable:!0})}catch(error){globalThis[key]=value}return value}},"./node_modules/core-js/internals/delete-property-or-throw.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var tryToString=__webpack_require__("./node_modules/core-js/internals/try-to-string.js"),$TypeError=TypeError;module.exports=function(O,P){if(!delete O[P])throw new $TypeError("Cannot delete property "+tryToString(P)+" of "+tryToString(O))}},"./node_modules/core-js/internals/descriptors.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var fails=__webpack_require__("./node_modules/core-js/internals/fails.js");module.exports=!fails((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"./node_modules/core-js/internals/document-create-element.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),document=globalThis.document,EXISTS=isObject(document)&&isObject(document.createElement);module.exports=function(it){return EXISTS?document.createElement(it):{}}},"./node_modules/core-js/internals/does-not-exceed-safe-integer.js":module=>{"use strict";var $TypeError=TypeError;module.exports=function(it){if(it>9007199254740991)throw $TypeError("Maximum allowed index exceeded");return it}},"./node_modules/core-js/internals/enum-bug-keys.js":module=>{"use strict";module.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"./node_modules/core-js/internals/environment-is-ios.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var userAgent=__webpack_require__("./node_modules/core-js/internals/environment-user-agent.js");module.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent)},"./node_modules/core-js/internals/environment-is-node.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var ENVIRONMENT=__webpack_require__("./node_modules/core-js/internals/environment.js");module.exports="NODE"===ENVIRONMENT},"./node_modules/core-js/internals/environment-user-agent.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var navigator=__webpack_require__("./node_modules/core-js/internals/global-this.js").navigator,userAgent=navigator&&navigator.userAgent;module.exports=userAgent?String(userAgent):""},"./node_modules/core-js/internals/environment-v8-version.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var match,version,globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),userAgent=__webpack_require__("./node_modules/core-js/internals/environment-user-agent.js"),process=globalThis.process,Deno=globalThis.Deno,versions=process&&process.versions||Deno&&Deno.version,v8=versions&&versions.v8;v8&&(version=(match=v8.split("."))[0]>0&&match[0]<4?1:+(match[0]+match[1])),!version&&userAgent&&(!(match=userAgent.match(/Edge\/(\d+)/))||match[1]>=74)&&(match=userAgent.match(/Chrome\/(\d+)/))&&(version=+match[1]),module.exports=version},"./node_modules/core-js/internals/environment.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),userAgent=__webpack_require__("./node_modules/core-js/internals/environment-user-agent.js"),classof=__webpack_require__("./node_modules/core-js/internals/classof-raw.js"),userAgentStartsWith=function(string){return userAgent.slice(0,string.length)===string};module.exports=userAgentStartsWith("Bun/")?"BUN":userAgentStartsWith("Cloudflare-Workers")?"CLOUDFLARE":userAgentStartsWith("Deno/")?"DENO":userAgentStartsWith("Node.js/")?"NODE":globalThis.Bun&&"string"==typeof Bun.version?"BUN":globalThis.Deno&&"object"==typeof Deno.version?"DENO":"process"===classof(globalThis.process)?"NODE":globalThis.window&&globalThis.document?"BROWSER":"REST"},"./node_modules/core-js/internals/error-stack-clear.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),$Error=Error,replace=uncurryThis("".replace),TEST=String(new $Error("zxcasd").stack),V8_OR_CHAKRA_STACK_ENTRY=/\n\s*at [^:]*:[^\n]*/,IS_V8_OR_CHAKRA_STACK=V8_OR_CHAKRA_STACK_ENTRY.test(TEST);module.exports=function(stack,dropEntries){if(IS_V8_OR_CHAKRA_STACK&&"string"==typeof stack&&!$Error.prepareStackTrace)for(;dropEntries--;)stack=replace(stack,V8_OR_CHAKRA_STACK_ENTRY,"");return stack}},"./node_modules/core-js/internals/error-stack-install.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var createNonEnumerableProperty=__webpack_require__("./node_modules/core-js/internals/create-non-enumerable-property.js"),clearErrorStack=__webpack_require__("./node_modules/core-js/internals/error-stack-clear.js"),ERROR_STACK_INSTALLABLE=__webpack_require__("./node_modules/core-js/internals/error-stack-installable.js"),captureStackTrace=Error.captureStackTrace;module.exports=function(error,C,stack,dropEntries){ERROR_STACK_INSTALLABLE&&(captureStackTrace?captureStackTrace(error,C):createNonEnumerableProperty(error,"stack",clearErrorStack(stack,dropEntries)))}},"./node_modules/core-js/internals/error-stack-installable.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),createPropertyDescriptor=__webpack_require__("./node_modules/core-js/internals/create-property-descriptor.js");module.exports=!fails((function(){var error=new Error("a");return!("stack"in error)||(Object.defineProperty(error,"stack",createPropertyDescriptor(1,7)),7!==error.stack)}))},"./node_modules/core-js/internals/export.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),getOwnPropertyDescriptor=__webpack_require__("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,createNonEnumerableProperty=__webpack_require__("./node_modules/core-js/internals/create-non-enumerable-property.js"),defineBuiltIn=__webpack_require__("./node_modules/core-js/internals/define-built-in.js"),defineGlobalProperty=__webpack_require__("./node_modules/core-js/internals/define-global-property.js"),copyConstructorProperties=__webpack_require__("./node_modules/core-js/internals/copy-constructor-properties.js"),isForced=__webpack_require__("./node_modules/core-js/internals/is-forced.js");module.exports=function(options,source){var target,key,targetProperty,sourceProperty,descriptor,TARGET=options.target,GLOBAL=options.global,STATIC=options.stat;if(target=GLOBAL?globalThis:STATIC?globalThis[TARGET]||defineGlobalProperty(TARGET,{}):globalThis[TARGET]&&globalThis[TARGET].prototype)for(key in source){if(sourceProperty=source[key],targetProperty=options.dontCallGetSet?(descriptor=getOwnPropertyDescriptor(target,key))&&descriptor.value:target[key],!isForced(GLOBAL?key:TARGET+(STATIC?".":"#")+key,options.forced)&&void 0!==targetProperty){if(typeof sourceProperty==typeof targetProperty)continue;copyConstructorProperties(sourceProperty,targetProperty)}(options.sham||targetProperty&&targetProperty.sham)&&createNonEnumerableProperty(sourceProperty,"sham",!0),defineBuiltIn(target,key,sourceProperty,options)}}},"./node_modules/core-js/internals/fails.js":module=>{"use strict";module.exports=function(exec){try{return!!exec()}catch(error){return!0}}},"./node_modules/core-js/internals/function-apply.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var NATIVE_BIND=__webpack_require__("./node_modules/core-js/internals/function-bind-native.js"),FunctionPrototype=Function.prototype,apply=FunctionPrototype.apply,call=FunctionPrototype.call;module.exports="object"==typeof Reflect&&Reflect.apply||(NATIVE_BIND?call.bind(apply):function(){return call.apply(apply,arguments)})},"./node_modules/core-js/internals/function-bind-context.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this-clause.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),NATIVE_BIND=__webpack_require__("./node_modules/core-js/internals/function-bind-native.js"),bind=uncurryThis(uncurryThis.bind);module.exports=function(fn,that){return aCallable(fn),void 0===that?fn:NATIVE_BIND?bind(fn,that):function(){return fn.apply(that,arguments)}}},"./node_modules/core-js/internals/function-bind-native.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var fails=__webpack_require__("./node_modules/core-js/internals/fails.js");module.exports=!fails((function(){var test=function(){}.bind();return"function"!=typeof test||test.hasOwnProperty("prototype")}))},"./node_modules/core-js/internals/function-call.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var NATIVE_BIND=__webpack_require__("./node_modules/core-js/internals/function-bind-native.js"),call=Function.prototype.call;module.exports=NATIVE_BIND?call.bind(call):function(){return call.apply(call,arguments)}},"./node_modules/core-js/internals/function-name.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),FunctionPrototype=Function.prototype,getDescriptor=DESCRIPTORS&&Object.getOwnPropertyDescriptor,EXISTS=hasOwn(FunctionPrototype,"name"),PROPER=EXISTS&&"something"===function something(){}.name,CONFIGURABLE=EXISTS&&(!DESCRIPTORS||DESCRIPTORS&&getDescriptor(FunctionPrototype,"name").configurable);module.exports={EXISTS,PROPER,CONFIGURABLE}},"./node_modules/core-js/internals/function-uncurry-this-accessor.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js");module.exports=function(object,key,method){try{return uncurryThis(aCallable(Object.getOwnPropertyDescriptor(object,key)[method]))}catch(error){}}},"./node_modules/core-js/internals/function-uncurry-this-clause.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var classofRaw=__webpack_require__("./node_modules/core-js/internals/classof-raw.js"),uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js");module.exports=function(fn){if("Function"===classofRaw(fn))return uncurryThis(fn)}},"./node_modules/core-js/internals/function-uncurry-this.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var NATIVE_BIND=__webpack_require__("./node_modules/core-js/internals/function-bind-native.js"),FunctionPrototype=Function.prototype,call=FunctionPrototype.call,uncurryThisWithBind=NATIVE_BIND&&FunctionPrototype.bind.bind(call,call);module.exports=NATIVE_BIND?uncurryThisWithBind:function(fn){return function(){return call.apply(fn,arguments)}}},"./node_modules/core-js/internals/get-built-in-prototype-method.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js");module.exports=function(CONSTRUCTOR,METHOD){var Constructor=globalThis[CONSTRUCTOR],Prototype=Constructor&&Constructor.prototype;return Prototype&&Prototype[METHOD]}},"./node_modules/core-js/internals/get-built-in.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js");module.exports=function(namespace,method){return arguments.length<2?(argument=globalThis[namespace],isCallable(argument)?argument:void 0):globalThis[namespace]&&globalThis[namespace][method];var argument}},"./node_modules/core-js/internals/get-iterator-direct.js":module=>{"use strict";module.exports=function(obj){return{iterator:obj,next:obj.next,done:!1}}},"./node_modules/core-js/internals/get-iterator-flattenable.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js"),getIteratorMethod=__webpack_require__("./node_modules/core-js/internals/get-iterator-method.js");module.exports=function(obj,stringHandling){stringHandling&&"string"==typeof obj||anObject(obj);var method=getIteratorMethod(obj);return getIteratorDirect(anObject(void 0!==method?call(method,obj):obj))}},"./node_modules/core-js/internals/get-iterator-method.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var classof=__webpack_require__("./node_modules/core-js/internals/classof.js"),getMethod=__webpack_require__("./node_modules/core-js/internals/get-method.js"),isNullOrUndefined=__webpack_require__("./node_modules/core-js/internals/is-null-or-undefined.js"),Iterators=__webpack_require__("./node_modules/core-js/internals/iterators.js"),ITERATOR=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js")("iterator");module.exports=function(it){if(!isNullOrUndefined(it))return getMethod(it,ITERATOR)||getMethod(it,"@@iterator")||Iterators[classof(it)]}},"./node_modules/core-js/internals/get-iterator.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),tryToString=__webpack_require__("./node_modules/core-js/internals/try-to-string.js"),getIteratorMethod=__webpack_require__("./node_modules/core-js/internals/get-iterator-method.js"),$TypeError=TypeError;module.exports=function(argument,usingIterator){var iteratorMethod=arguments.length<2?getIteratorMethod(argument):usingIterator;if(aCallable(iteratorMethod))return anObject(call(iteratorMethod,argument));throw new $TypeError(tryToString(argument)+" is not iterable")}},"./node_modules/core-js/internals/get-json-replacer-function.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),isArray=__webpack_require__("./node_modules/core-js/internals/is-array.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),classof=__webpack_require__("./node_modules/core-js/internals/classof-raw.js"),toString=__webpack_require__("./node_modules/core-js/internals/to-string.js"),push=uncurryThis([].push);module.exports=function(replacer){if(isCallable(replacer))return replacer;if(isArray(replacer)){for(var rawLength=replacer.length,keys=[],i=0;i<rawLength;i++){var element=replacer[i];"string"==typeof element?push(keys,element):"number"!=typeof element&&"Number"!==classof(element)&&"String"!==classof(element)||push(keys,toString(element))}var keysLength=keys.length,root=!0;return function(key,value){if(root)return root=!1,value;if(isArray(this))return value;for(var j=0;j<keysLength;j++)if(keys[j]===key)return value}}}},"./node_modules/core-js/internals/get-method.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),isNullOrUndefined=__webpack_require__("./node_modules/core-js/internals/is-null-or-undefined.js");module.exports=function(V,P){var func=V[P];return isNullOrUndefined(func)?void 0:aCallable(func)}},"./node_modules/core-js/internals/get-set-record.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),toIntegerOrInfinity=__webpack_require__("./node_modules/core-js/internals/to-integer-or-infinity.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js"),$RangeError=RangeError,$TypeError=TypeError,max=Math.max,SetRecord=function(set,intSize){this.set=set,this.size=max(intSize,0),this.has=aCallable(set.has),this.keys=aCallable(set.keys)};SetRecord.prototype={getIterator:function(){return getIteratorDirect(anObject(call(this.keys,this.set)))},includes:function(it){return call(this.has,this.set,it)}},module.exports=function(obj){anObject(obj);var numSize=+obj.size;if(numSize!=numSize)throw new $TypeError("Invalid size");var intSize=toIntegerOrInfinity(numSize);if(intSize<0)throw new $RangeError("Invalid size");return new SetRecord(obj,intSize)}},"./node_modules/core-js/internals/get-substitution.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),toObject=__webpack_require__("./node_modules/core-js/internals/to-object.js"),floor=Math.floor,charAt=uncurryThis("".charAt),replace=uncurryThis("".replace),stringSlice=uncurryThis("".slice),SUBSTITUTION_SYMBOLS=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&'`]|\d{1,2})/g;module.exports=function(matched,str,position,captures,namedCaptures,replacement){var tailPos=position+matched.length,m=captures.length,symbols=SUBSTITUTION_SYMBOLS_NO_NAMED;return void 0!==namedCaptures&&(namedCaptures=toObject(namedCaptures),symbols=SUBSTITUTION_SYMBOLS),replace(replacement,symbols,(function(match,ch){var capture;switch(charAt(ch,0)){case"$":return"$";case"&":return matched;case"`":return stringSlice(str,0,position);case"'":return stringSlice(str,tailPos);case"<":capture=namedCaptures[stringSlice(ch,1,-1)];break;default:var n=+ch;if(0===n)return match;if(n>m){var f=floor(n/10);return 0===f?match:f<=m?void 0===captures[f-1]?charAt(ch,1):captures[f-1]+charAt(ch,1):match}capture=captures[n-1]}return void 0===capture?"":capture}))}},"./node_modules/core-js/internals/global-this.js":function(module,__unused_webpack_exports,__webpack_require__){"use strict";var check=function(it){return it&&it.Math===Math&&it};module.exports=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof __webpack_require__.g&&__webpack_require__.g)||check("object"==typeof this&&this)||function(){return this}()||Function("return this")()},"./node_modules/core-js/internals/has-own-property.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),toObject=__webpack_require__("./node_modules/core-js/internals/to-object.js"),hasOwnProperty=uncurryThis({}.hasOwnProperty);module.exports=Object.hasOwn||function hasOwn(it,key){return hasOwnProperty(toObject(it),key)}},"./node_modules/core-js/internals/hidden-keys.js":module=>{"use strict";module.exports={}},"./node_modules/core-js/internals/html.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var getBuiltIn=__webpack_require__("./node_modules/core-js/internals/get-built-in.js");module.exports=getBuiltIn("document","documentElement")},"./node_modules/core-js/internals/ie8-dom-define.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),createElement=__webpack_require__("./node_modules/core-js/internals/document-create-element.js");module.exports=!DESCRIPTORS&&!fails((function(){return 7!==Object.defineProperty(createElement("div"),"a",{get:function(){return 7}}).a}))},"./node_modules/core-js/internals/indexed-object.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),classof=__webpack_require__("./node_modules/core-js/internals/classof-raw.js"),$Object=Object,split=uncurryThis("".split);module.exports=fails((function(){return!$Object("z").propertyIsEnumerable(0)}))?function(it){return"String"===classof(it)?split(it,""):$Object(it)}:$Object},"./node_modules/core-js/internals/inherit-if-required.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),setPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-set-prototype-of.js");module.exports=function($this,dummy,Wrapper){var NewTarget,NewTargetPrototype;return setPrototypeOf&&isCallable(NewTarget=dummy.constructor)&&NewTarget!==Wrapper&&isObject(NewTargetPrototype=NewTarget.prototype)&&NewTargetPrototype!==Wrapper.prototype&&setPrototypeOf($this,NewTargetPrototype),$this}},"./node_modules/core-js/internals/inspect-source.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),store=__webpack_require__("./node_modules/core-js/internals/shared-store.js"),functionToString=uncurryThis(Function.toString);isCallable(store.inspectSource)||(store.inspectSource=function(it){return functionToString(it)}),module.exports=store.inspectSource},"./node_modules/core-js/internals/install-error-cause.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),createNonEnumerableProperty=__webpack_require__("./node_modules/core-js/internals/create-non-enumerable-property.js");module.exports=function(O,options){isObject(options)&&"cause"in options&&createNonEnumerableProperty(O,"cause",options.cause)}},"./node_modules/core-js/internals/internal-state.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var set,get,has,NATIVE_WEAK_MAP=__webpack_require__("./node_modules/core-js/internals/weak-map-basic-detection.js"),globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),createNonEnumerableProperty=__webpack_require__("./node_modules/core-js/internals/create-non-enumerable-property.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),shared=__webpack_require__("./node_modules/core-js/internals/shared-store.js"),sharedKey=__webpack_require__("./node_modules/core-js/internals/shared-key.js"),hiddenKeys=__webpack_require__("./node_modules/core-js/internals/hidden-keys.js"),TypeError=globalThis.TypeError,WeakMap=globalThis.WeakMap;if(NATIVE_WEAK_MAP||shared.state){var store=shared.state||(shared.state=new WeakMap);store.get=store.get,store.has=store.has,store.set=store.set,set=function(it,metadata){if(store.has(it))throw new TypeError("Object already initialized");return metadata.facade=it,store.set(it,metadata),metadata},get=function(it){return store.get(it)||{}},has=function(it){return store.has(it)}}else{var STATE=sharedKey("state");hiddenKeys[STATE]=!0,set=function(it,metadata){if(hasOwn(it,STATE))throw new TypeError("Object already initialized");return metadata.facade=it,createNonEnumerableProperty(it,STATE,metadata),metadata},get=function(it){return hasOwn(it,STATE)?it[STATE]:{}},has=function(it){return hasOwn(it,STATE)}}module.exports={set,get,has,enforce:function(it){return has(it)?get(it):set(it,{})},getterFor:function(TYPE){return function(it){var state;if(!isObject(it)||(state=get(it)).type!==TYPE)throw new TypeError("Incompatible receiver, "+TYPE+" required");return state}}}},"./node_modules/core-js/internals/is-array-iterator-method.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),Iterators=__webpack_require__("./node_modules/core-js/internals/iterators.js"),ITERATOR=wellKnownSymbol("iterator"),ArrayPrototype=Array.prototype;module.exports=function(it){return void 0!==it&&(Iterators.Array===it||ArrayPrototype[ITERATOR]===it)}},"./node_modules/core-js/internals/is-array.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var classof=__webpack_require__("./node_modules/core-js/internals/classof-raw.js");module.exports=Array.isArray||function isArray(argument){return"Array"===classof(argument)}},"./node_modules/core-js/internals/is-callable.js":module=>{"use strict";var documentAll="object"==typeof document&&document.all;module.exports=void 0===documentAll&&void 0!==documentAll?function(argument){return"function"==typeof argument||argument===documentAll}:function(argument){return"function"==typeof argument}},"./node_modules/core-js/internals/is-forced.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),replacement=/#|\.prototype\./,isForced=function(feature,detection){var value=data[normalize(feature)];return value===POLYFILL||value!==NATIVE&&(isCallable(detection)?fails(detection):!!detection)},normalize=isForced.normalize=function(string){return String(string).replace(replacement,".").toLowerCase()},data=isForced.data={},NATIVE=isForced.NATIVE="N",POLYFILL=isForced.POLYFILL="P";module.exports=isForced},"./node_modules/core-js/internals/is-null-or-undefined.js":module=>{"use strict";module.exports=function(it){return null==it}},"./node_modules/core-js/internals/is-object.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js");module.exports=function(it){return"object"==typeof it?null!==it:isCallable(it)}},"./node_modules/core-js/internals/is-possible-prototype.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js");module.exports=function(argument){return isObject(argument)||null===argument}},"./node_modules/core-js/internals/is-pure.js":module=>{"use strict";module.exports=!1},"./node_modules/core-js/internals/is-regexp.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),classof=__webpack_require__("./node_modules/core-js/internals/classof-raw.js"),MATCH=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js")("match");module.exports=function(it){var isRegExp;return isObject(it)&&(void 0!==(isRegExp=it[MATCH])?!!isRegExp:"RegExp"===classof(it))}},"./node_modules/core-js/internals/is-symbol.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var getBuiltIn=__webpack_require__("./node_modules/core-js/internals/get-built-in.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),isPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-is-prototype-of.js"),USE_SYMBOL_AS_UID=__webpack_require__("./node_modules/core-js/internals/use-symbol-as-uid.js"),$Object=Object;module.exports=USE_SYMBOL_AS_UID?function(it){return"symbol"==typeof it}:function(it){var $Symbol=getBuiltIn("Symbol");return isCallable($Symbol)&&isPrototypeOf($Symbol.prototype,$Object(it))}},"./node_modules/core-js/internals/iterate-simple.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js");module.exports=function(record,fn,ITERATOR_INSTEAD_OF_RECORD){for(var step,result,iterator=ITERATOR_INSTEAD_OF_RECORD?record:record.iterator,next=record.next;!(step=call(next,iterator)).done;)if(void 0!==(result=fn(step.value)))return result}},"./node_modules/core-js/internals/iterate.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var bind=__webpack_require__("./node_modules/core-js/internals/function-bind-context.js"),call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),tryToString=__webpack_require__("./node_modules/core-js/internals/try-to-string.js"),isArrayIteratorMethod=__webpack_require__("./node_modules/core-js/internals/is-array-iterator-method.js"),lengthOfArrayLike=__webpack_require__("./node_modules/core-js/internals/length-of-array-like.js"),isPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-is-prototype-of.js"),getIterator=__webpack_require__("./node_modules/core-js/internals/get-iterator.js"),getIteratorMethod=__webpack_require__("./node_modules/core-js/internals/get-iterator-method.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js"),$TypeError=TypeError,Result=function(stopped,result){this.stopped=stopped,this.result=result},ResultPrototype=Result.prototype;module.exports=function(iterable,unboundFunction,options){var iterator,iterFn,index,length,result,next,step,that=options&&options.that,AS_ENTRIES=!(!options||!options.AS_ENTRIES),IS_RECORD=!(!options||!options.IS_RECORD),IS_ITERATOR=!(!options||!options.IS_ITERATOR),INTERRUPTED=!(!options||!options.INTERRUPTED),fn=bind(unboundFunction,that),stop=function(condition){return iterator&&iteratorClose(iterator,"normal",condition),new Result(!0,condition)},callFn=function(value){return AS_ENTRIES?(anObject(value),INTERRUPTED?fn(value[0],value[1],stop):fn(value[0],value[1])):INTERRUPTED?fn(value,stop):fn(value)};if(IS_RECORD)iterator=iterable.iterator;else if(IS_ITERATOR)iterator=iterable;else{if(!(iterFn=getIteratorMethod(iterable)))throw new $TypeError(tryToString(iterable)+" is not iterable");if(isArrayIteratorMethod(iterFn)){for(index=0,length=lengthOfArrayLike(iterable);length>index;index++)if((result=callFn(iterable[index]))&&isPrototypeOf(ResultPrototype,result))return result;return new Result(!1)}iterator=getIterator(iterable,iterFn)}for(next=IS_RECORD?iterable.next:iterator.next;!(step=call(next,iterator)).done;){try{result=callFn(step.value)}catch(error){iteratorClose(iterator,"throw",error)}if("object"==typeof result&&result&&isPrototypeOf(ResultPrototype,result))return result}return new Result(!1)}},"./node_modules/core-js/internals/iterator-close.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getMethod=__webpack_require__("./node_modules/core-js/internals/get-method.js");module.exports=function(iterator,kind,value){var innerResult,innerError;anObject(iterator);try{if(!(innerResult=getMethod(iterator,"return"))){if("throw"===kind)throw value;return value}innerResult=call(innerResult,iterator)}catch(error){innerError=!0,innerResult=error}if("throw"===kind)throw value;if(innerError)throw innerResult;return anObject(innerResult),value}},"./node_modules/core-js/internals/iterator-create-proxy.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),create=__webpack_require__("./node_modules/core-js/internals/object-create.js"),createNonEnumerableProperty=__webpack_require__("./node_modules/core-js/internals/create-non-enumerable-property.js"),defineBuiltIns=__webpack_require__("./node_modules/core-js/internals/define-built-ins.js"),wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),InternalStateModule=__webpack_require__("./node_modules/core-js/internals/internal-state.js"),getMethod=__webpack_require__("./node_modules/core-js/internals/get-method.js"),IteratorPrototype=__webpack_require__("./node_modules/core-js/internals/iterators-core.js").IteratorPrototype,createIterResultObject=__webpack_require__("./node_modules/core-js/internals/create-iter-result-object.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js"),TO_STRING_TAG=wellKnownSymbol("toStringTag"),setInternalState=InternalStateModule.set,createIteratorProxyPrototype=function(IS_ITERATOR){var getInternalState=InternalStateModule.getterFor(IS_ITERATOR?"WrapForValidIterator":"IteratorHelper");return defineBuiltIns(create(IteratorPrototype),{next:function next(){var state=getInternalState(this);if(IS_ITERATOR)return state.nextHandler();if(state.done)return createIterResultObject(void 0,!0);try{var result=state.nextHandler();return state.returnHandlerResult?result:createIterResultObject(result,state.done)}catch(error){throw state.done=!0,error}},return:function(){var state=getInternalState(this),iterator=state.iterator;if(state.done=!0,IS_ITERATOR){var returnMethod=getMethod(iterator,"return");return returnMethod?call(returnMethod,iterator):createIterResultObject(void 0,!0)}if(state.inner)try{iteratorClose(state.inner.iterator,"normal")}catch(error){return iteratorClose(iterator,"throw",error)}return iterator&&iteratorClose(iterator,"normal"),createIterResultObject(void 0,!0)}})},WrapForValidIteratorPrototype=createIteratorProxyPrototype(!0),IteratorHelperPrototype=createIteratorProxyPrototype(!1);createNonEnumerableProperty(IteratorHelperPrototype,TO_STRING_TAG,"Iterator Helper"),module.exports=function(nextHandler,IS_ITERATOR,RETURN_HANDLER_RESULT){var IteratorProxy=function Iterator(record,state){state?(state.iterator=record.iterator,state.next=record.next):state=record,state.type=IS_ITERATOR?"WrapForValidIterator":"IteratorHelper",state.returnHandlerResult=!!RETURN_HANDLER_RESULT,state.nextHandler=nextHandler,state.counter=0,state.done=!1,setInternalState(this,state)};return IteratorProxy.prototype=IS_ITERATOR?WrapForValidIteratorPrototype:IteratorHelperPrototype,IteratorProxy}},"./node_modules/core-js/internals/iterator-map.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js"),createIteratorProxy=__webpack_require__("./node_modules/core-js/internals/iterator-create-proxy.js"),callWithSafeIterationClosing=__webpack_require__("./node_modules/core-js/internals/call-with-safe-iteration-closing.js"),IteratorProxy=createIteratorProxy((function(){var iterator=this.iterator,result=anObject(call(this.next,iterator));if(!(this.done=!!result.done))return callWithSafeIterationClosing(iterator,this.mapper,[result.value,this.counter++],!0)}));module.exports=function map(mapper){return anObject(this),aCallable(mapper),new IteratorProxy(getIteratorDirect(this),{mapper})}},"./node_modules/core-js/internals/iterators-core.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator,fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),create=__webpack_require__("./node_modules/core-js/internals/object-create.js"),getPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-get-prototype-of.js"),defineBuiltIn=__webpack_require__("./node_modules/core-js/internals/define-built-in.js"),wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),IS_PURE=__webpack_require__("./node_modules/core-js/internals/is-pure.js"),ITERATOR=wellKnownSymbol("iterator"),BUGGY_SAFARI_ITERATORS=!1;[].keys&&("next"in(arrayIterator=[].keys())?(PrototypeOfArrayIteratorPrototype=getPrototypeOf(getPrototypeOf(arrayIterator)))!==Object.prototype&&(IteratorPrototype=PrototypeOfArrayIteratorPrototype):BUGGY_SAFARI_ITERATORS=!0),!isObject(IteratorPrototype)||fails((function(){var test={};return IteratorPrototype[ITERATOR].call(test)!==test}))?IteratorPrototype={}:IS_PURE&&(IteratorPrototype=create(IteratorPrototype)),isCallable(IteratorPrototype[ITERATOR])||defineBuiltIn(IteratorPrototype,ITERATOR,(function(){return this})),module.exports={IteratorPrototype,BUGGY_SAFARI_ITERATORS}},"./node_modules/core-js/internals/iterators.js":module=>{"use strict";module.exports={}},"./node_modules/core-js/internals/length-of-array-like.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var toLength=__webpack_require__("./node_modules/core-js/internals/to-length.js");module.exports=function(obj){return toLength(obj.length)}},"./node_modules/core-js/internals/make-built-in.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),CONFIGURABLE_FUNCTION_NAME=__webpack_require__("./node_modules/core-js/internals/function-name.js").CONFIGURABLE,inspectSource=__webpack_require__("./node_modules/core-js/internals/inspect-source.js"),InternalStateModule=__webpack_require__("./node_modules/core-js/internals/internal-state.js"),enforceInternalState=InternalStateModule.enforce,getInternalState=InternalStateModule.get,$String=String,defineProperty=Object.defineProperty,stringSlice=uncurryThis("".slice),replace=uncurryThis("".replace),join=uncurryThis([].join),CONFIGURABLE_LENGTH=DESCRIPTORS&&!fails((function(){return 8!==defineProperty((function(){}),"length",{value:8}).length})),TEMPLATE=String(String).split("String"),makeBuiltIn=module.exports=function(value,name,options){"Symbol("===stringSlice($String(name),0,7)&&(name="["+replace($String(name),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),options&&options.getter&&(name="get "+name),options&&options.setter&&(name="set "+name),(!hasOwn(value,"name")||CONFIGURABLE_FUNCTION_NAME&&value.name!==name)&&(DESCRIPTORS?defineProperty(value,"name",{value:name,configurable:!0}):value.name=name),CONFIGURABLE_LENGTH&&options&&hasOwn(options,"arity")&&value.length!==options.arity&&defineProperty(value,"length",{value:options.arity});try{options&&hasOwn(options,"constructor")&&options.constructor?DESCRIPTORS&&defineProperty(value,"prototype",{writable:!1}):value.prototype&&(value.prototype=void 0)}catch(error){}var state=enforceInternalState(value);return hasOwn(state,"source")||(state.source=join(TEMPLATE,"string"==typeof name?name:"")),value};Function.prototype.toString=makeBuiltIn((function toString(){return isCallable(this)&&getInternalState(this).source||inspectSource(this)}),"toString")},"./node_modules/core-js/internals/math-trunc.js":module=>{"use strict";var ceil=Math.ceil,floor=Math.floor;module.exports=Math.trunc||function trunc(x){var n=+x;return(n>0?floor:ceil)(n)}},"./node_modules/core-js/internals/normalize-string-argument.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var toString=__webpack_require__("./node_modules/core-js/internals/to-string.js");module.exports=function(argument,$default){return void 0===argument?arguments.length<2?"":$default:toString(argument)}},"./node_modules/core-js/internals/object-create.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var activeXDocument,anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),definePropertiesModule=__webpack_require__("./node_modules/core-js/internals/object-define-properties.js"),enumBugKeys=__webpack_require__("./node_modules/core-js/internals/enum-bug-keys.js"),hiddenKeys=__webpack_require__("./node_modules/core-js/internals/hidden-keys.js"),html=__webpack_require__("./node_modules/core-js/internals/html.js"),documentCreateElement=__webpack_require__("./node_modules/core-js/internals/document-create-element.js"),sharedKey=__webpack_require__("./node_modules/core-js/internals/shared-key.js"),IE_PROTO=sharedKey("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(content){return"<script>"+content+"<\/script>"},NullProtoObjectViaActiveX=function(activeXDocument){activeXDocument.write(scriptTag("")),activeXDocument.close();var temp=activeXDocument.parentWindow.Object;return activeXDocument=null,temp},NullProtoObject=function(){try{activeXDocument=new ActiveXObject("htmlfile")}catch(error){}var iframeDocument,iframe;NullProtoObject="undefined"!=typeof document?document.domain&&activeXDocument?NullProtoObjectViaActiveX(activeXDocument):((iframe=documentCreateElement("iframe")).style.display="none",html.appendChild(iframe),iframe.src=String("javascript:"),(iframeDocument=iframe.contentWindow.document).open(),iframeDocument.write(scriptTag("document.F=Object")),iframeDocument.close(),iframeDocument.F):NullProtoObjectViaActiveX(activeXDocument);for(var length=enumBugKeys.length;length--;)delete NullProtoObject.prototype[enumBugKeys[length]];return NullProtoObject()};hiddenKeys[IE_PROTO]=!0,module.exports=Object.create||function create(O,Properties){var result;return null!==O?(EmptyConstructor.prototype=anObject(O),result=new EmptyConstructor,EmptyConstructor.prototype=null,result[IE_PROTO]=O):result=NullProtoObject(),void 0===Properties?result:definePropertiesModule.f(result,Properties)}},"./node_modules/core-js/internals/object-define-properties.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),V8_PROTOTYPE_DEFINE_BUG=__webpack_require__("./node_modules/core-js/internals/v8-prototype-define-bug.js"),definePropertyModule=__webpack_require__("./node_modules/core-js/internals/object-define-property.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),toIndexedObject=__webpack_require__("./node_modules/core-js/internals/to-indexed-object.js"),objectKeys=__webpack_require__("./node_modules/core-js/internals/object-keys.js");exports.f=DESCRIPTORS&&!V8_PROTOTYPE_DEFINE_BUG?Object.defineProperties:function defineProperties(O,Properties){anObject(O);for(var key,props=toIndexedObject(Properties),keys=objectKeys(Properties),length=keys.length,index=0;length>index;)definePropertyModule.f(O,key=keys[index++],props[key]);return O}},"./node_modules/core-js/internals/object-define-property.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),IE8_DOM_DEFINE=__webpack_require__("./node_modules/core-js/internals/ie8-dom-define.js"),V8_PROTOTYPE_DEFINE_BUG=__webpack_require__("./node_modules/core-js/internals/v8-prototype-define-bug.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),toPropertyKey=__webpack_require__("./node_modules/core-js/internals/to-property-key.js"),$TypeError=TypeError,$defineProperty=Object.defineProperty,$getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;exports.f=DESCRIPTORS?V8_PROTOTYPE_DEFINE_BUG?function defineProperty(O,P,Attributes){if(anObject(O),P=toPropertyKey(P),anObject(Attributes),"function"==typeof O&&"prototype"===P&&"value"in Attributes&&"writable"in Attributes&&!Attributes.writable){var current=$getOwnPropertyDescriptor(O,P);current&&current.writable&&(O[P]=Attributes.value,Attributes={configurable:"configurable"in Attributes?Attributes.configurable:current.configurable,enumerable:"enumerable"in Attributes?Attributes.enumerable:current.enumerable,writable:!1})}return $defineProperty(O,P,Attributes)}:$defineProperty:function defineProperty(O,P,Attributes){if(anObject(O),P=toPropertyKey(P),anObject(Attributes),IE8_DOM_DEFINE)try{return $defineProperty(O,P,Attributes)}catch(error){}if("get"in Attributes||"set"in Attributes)throw new $TypeError("Accessors not supported");return"value"in Attributes&&(O[P]=Attributes.value),O}},"./node_modules/core-js/internals/object-get-own-property-descriptor.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),propertyIsEnumerableModule=__webpack_require__("./node_modules/core-js/internals/object-property-is-enumerable.js"),createPropertyDescriptor=__webpack_require__("./node_modules/core-js/internals/create-property-descriptor.js"),toIndexedObject=__webpack_require__("./node_modules/core-js/internals/to-indexed-object.js"),toPropertyKey=__webpack_require__("./node_modules/core-js/internals/to-property-key.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),IE8_DOM_DEFINE=__webpack_require__("./node_modules/core-js/internals/ie8-dom-define.js"),$getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;exports.f=DESCRIPTORS?$getOwnPropertyDescriptor:function getOwnPropertyDescriptor(O,P){if(O=toIndexedObject(O),P=toPropertyKey(P),IE8_DOM_DEFINE)try{return $getOwnPropertyDescriptor(O,P)}catch(error){}if(hasOwn(O,P))return createPropertyDescriptor(!call(propertyIsEnumerableModule.f,O,P),O[P])}},"./node_modules/core-js/internals/object-get-own-property-names.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var internalObjectKeys=__webpack_require__("./node_modules/core-js/internals/object-keys-internal.js"),hiddenKeys=__webpack_require__("./node_modules/core-js/internals/enum-bug-keys.js").concat("length","prototype");exports.f=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return internalObjectKeys(O,hiddenKeys)}},"./node_modules/core-js/internals/object-get-own-property-symbols.js":(__unused_webpack_module,exports)=>{"use strict";exports.f=Object.getOwnPropertySymbols},"./node_modules/core-js/internals/object-get-prototype-of.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),toObject=__webpack_require__("./node_modules/core-js/internals/to-object.js"),sharedKey=__webpack_require__("./node_modules/core-js/internals/shared-key.js"),CORRECT_PROTOTYPE_GETTER=__webpack_require__("./node_modules/core-js/internals/correct-prototype-getter.js"),IE_PROTO=sharedKey("IE_PROTO"),$Object=Object,ObjectPrototype=$Object.prototype;module.exports=CORRECT_PROTOTYPE_GETTER?$Object.getPrototypeOf:function(O){var object=toObject(O);if(hasOwn(object,IE_PROTO))return object[IE_PROTO];var constructor=object.constructor;return isCallable(constructor)&&object instanceof constructor?constructor.prototype:object instanceof $Object?ObjectPrototype:null}},"./node_modules/core-js/internals/object-is-prototype-of.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js");module.exports=uncurryThis({}.isPrototypeOf)},"./node_modules/core-js/internals/object-keys-internal.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),toIndexedObject=__webpack_require__("./node_modules/core-js/internals/to-indexed-object.js"),indexOf=__webpack_require__("./node_modules/core-js/internals/array-includes.js").indexOf,hiddenKeys=__webpack_require__("./node_modules/core-js/internals/hidden-keys.js"),push=uncurryThis([].push);module.exports=function(object,names){var key,O=toIndexedObject(object),i=0,result=[];for(key in O)!hasOwn(hiddenKeys,key)&&hasOwn(O,key)&&push(result,key);for(;names.length>i;)hasOwn(O,key=names[i++])&&(~indexOf(result,key)||push(result,key));return result}},"./node_modules/core-js/internals/object-keys.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var internalObjectKeys=__webpack_require__("./node_modules/core-js/internals/object-keys-internal.js"),enumBugKeys=__webpack_require__("./node_modules/core-js/internals/enum-bug-keys.js");module.exports=Object.keys||function keys(O){return internalObjectKeys(O,enumBugKeys)}},"./node_modules/core-js/internals/object-property-is-enumerable.js":(__unused_webpack_module,exports)=>{"use strict";var $propertyIsEnumerable={}.propertyIsEnumerable,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor&&!$propertyIsEnumerable.call({1:2},1);exports.f=NASHORN_BUG?function propertyIsEnumerable(V){var descriptor=getOwnPropertyDescriptor(this,V);return!!descriptor&&descriptor.enumerable}:$propertyIsEnumerable},"./node_modules/core-js/internals/object-set-prototype-of.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThisAccessor=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this-accessor.js"),isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),requireObjectCoercible=__webpack_require__("./node_modules/core-js/internals/require-object-coercible.js"),aPossiblePrototype=__webpack_require__("./node_modules/core-js/internals/a-possible-prototype.js");module.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var setter,CORRECT_SETTER=!1,test={};try{(setter=uncurryThisAccessor(Object.prototype,"__proto__","set"))(test,[]),CORRECT_SETTER=test instanceof Array}catch(error){}return function setPrototypeOf(O,proto){return requireObjectCoercible(O),aPossiblePrototype(proto),isObject(O)?(CORRECT_SETTER?setter(O,proto):O.__proto__=proto,O):O}}():void 0)},"./node_modules/core-js/internals/ordinary-to-primitive.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),$TypeError=TypeError;module.exports=function(input,pref){var fn,val;if("string"===pref&&isCallable(fn=input.toString)&&!isObject(val=call(fn,input)))return val;if(isCallable(fn=input.valueOf)&&!isObject(val=call(fn,input)))return val;if("string"!==pref&&isCallable(fn=input.toString)&&!isObject(val=call(fn,input)))return val;throw new $TypeError("Can't convert object to primitive value")}},"./node_modules/core-js/internals/own-keys.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var getBuiltIn=__webpack_require__("./node_modules/core-js/internals/get-built-in.js"),uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),getOwnPropertyNamesModule=__webpack_require__("./node_modules/core-js/internals/object-get-own-property-names.js"),getOwnPropertySymbolsModule=__webpack_require__("./node_modules/core-js/internals/object-get-own-property-symbols.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),concat=uncurryThis([].concat);module.exports=getBuiltIn("Reflect","ownKeys")||function ownKeys(it){var keys=getOwnPropertyNamesModule.f(anObject(it)),getOwnPropertySymbols=getOwnPropertySymbolsModule.f;return getOwnPropertySymbols?concat(keys,getOwnPropertySymbols(it)):keys}},"./node_modules/core-js/internals/proxy-accessor.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var defineProperty=__webpack_require__("./node_modules/core-js/internals/object-define-property.js").f;module.exports=function(Target,Source,key){key in Target||defineProperty(Target,key,{configurable:!0,get:function(){return Source[key]},set:function(it){Source[key]=it}})}},"./node_modules/core-js/internals/regexp-flags.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js");module.exports=function(){var that=anObject(this),result="";return that.hasIndices&&(result+="d"),that.global&&(result+="g"),that.ignoreCase&&(result+="i"),that.multiline&&(result+="m"),that.dotAll&&(result+="s"),that.unicode&&(result+="u"),that.unicodeSets&&(result+="v"),that.sticky&&(result+="y"),result}},"./node_modules/core-js/internals/regexp-get-flags.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),isPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-is-prototype-of.js"),regExpFlags=__webpack_require__("./node_modules/core-js/internals/regexp-flags.js"),RegExpPrototype=RegExp.prototype;module.exports=function(R){var flags=R.flags;return void 0!==flags||"flags"in RegExpPrototype||hasOwn(R,"flags")||!isPrototypeOf(RegExpPrototype,R)?flags:call(regExpFlags,R)}},"./node_modules/core-js/internals/require-object-coercible.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isNullOrUndefined=__webpack_require__("./node_modules/core-js/internals/is-null-or-undefined.js"),$TypeError=TypeError;module.exports=function(it){if(isNullOrUndefined(it))throw new $TypeError("Can't call method on "+it);return it}},"./node_modules/core-js/internals/schedulers-fix.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var version,globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),apply=__webpack_require__("./node_modules/core-js/internals/function-apply.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),ENVIRONMENT=__webpack_require__("./node_modules/core-js/internals/environment.js"),USER_AGENT=__webpack_require__("./node_modules/core-js/internals/environment-user-agent.js"),arraySlice=__webpack_require__("./node_modules/core-js/internals/array-slice.js"),validateArgumentsLength=__webpack_require__("./node_modules/core-js/internals/validate-arguments-length.js"),Function=globalThis.Function,WRAP=/MSIE .\./.test(USER_AGENT)||"BUN"===ENVIRONMENT&&((version=globalThis.Bun.version.split(".")).length<3||"0"===version[0]&&(version[1]<3||"3"===version[1]&&"0"===version[2]));module.exports=function(scheduler,hasTimeArg){var firstParamIndex=hasTimeArg?2:1;return WRAP?function(handler,timeout){var boundArgs=validateArgumentsLength(arguments.length,1)>firstParamIndex,fn=isCallable(handler)?handler:Function(handler),params=boundArgs?arraySlice(arguments,firstParamIndex):[],callback=boundArgs?function(){apply(fn,this,params)}:fn;return hasTimeArg?scheduler(callback,timeout):scheduler(callback)}:scheduler}},"./node_modules/core-js/internals/set-clone.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var SetHelpers=__webpack_require__("./node_modules/core-js/internals/set-helpers.js"),iterate=__webpack_require__("./node_modules/core-js/internals/set-iterate.js"),Set=SetHelpers.Set,add=SetHelpers.add;module.exports=function(set){var result=new Set;return iterate(set,(function(it){add(result,it)})),result}},"./node_modules/core-js/internals/set-difference.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aSet=__webpack_require__("./node_modules/core-js/internals/a-set.js"),SetHelpers=__webpack_require__("./node_modules/core-js/internals/set-helpers.js"),clone=__webpack_require__("./node_modules/core-js/internals/set-clone.js"),size=__webpack_require__("./node_modules/core-js/internals/set-size.js"),getSetRecord=__webpack_require__("./node_modules/core-js/internals/get-set-record.js"),iterateSet=__webpack_require__("./node_modules/core-js/internals/set-iterate.js"),iterateSimple=__webpack_require__("./node_modules/core-js/internals/iterate-simple.js"),has=SetHelpers.has,remove=SetHelpers.remove;module.exports=function difference(other){var O=aSet(this),otherRec=getSetRecord(other),result=clone(O);return size(O)<=otherRec.size?iterateSet(O,(function(e){otherRec.includes(e)&&remove(result,e)})):iterateSimple(otherRec.getIterator(),(function(e){has(O,e)&&remove(result,e)})),result}},"./node_modules/core-js/internals/set-helpers.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),SetPrototype=Set.prototype;module.exports={Set,add:uncurryThis(SetPrototype.add),has:uncurryThis(SetPrototype.has),remove:uncurryThis(SetPrototype.delete),proto:SetPrototype}},"./node_modules/core-js/internals/set-intersection.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aSet=__webpack_require__("./node_modules/core-js/internals/a-set.js"),SetHelpers=__webpack_require__("./node_modules/core-js/internals/set-helpers.js"),size=__webpack_require__("./node_modules/core-js/internals/set-size.js"),getSetRecord=__webpack_require__("./node_modules/core-js/internals/get-set-record.js"),iterateSet=__webpack_require__("./node_modules/core-js/internals/set-iterate.js"),iterateSimple=__webpack_require__("./node_modules/core-js/internals/iterate-simple.js"),Set=SetHelpers.Set,add=SetHelpers.add,has=SetHelpers.has;module.exports=function intersection(other){var O=aSet(this),otherRec=getSetRecord(other),result=new Set;return size(O)>otherRec.size?iterateSimple(otherRec.getIterator(),(function(e){has(O,e)&&add(result,e)})):iterateSet(O,(function(e){otherRec.includes(e)&&add(result,e)})),result}},"./node_modules/core-js/internals/set-is-disjoint-from.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aSet=__webpack_require__("./node_modules/core-js/internals/a-set.js"),has=__webpack_require__("./node_modules/core-js/internals/set-helpers.js").has,size=__webpack_require__("./node_modules/core-js/internals/set-size.js"),getSetRecord=__webpack_require__("./node_modules/core-js/internals/get-set-record.js"),iterateSet=__webpack_require__("./node_modules/core-js/internals/set-iterate.js"),iterateSimple=__webpack_require__("./node_modules/core-js/internals/iterate-simple.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js");module.exports=function isDisjointFrom(other){var O=aSet(this),otherRec=getSetRecord(other);if(size(O)<=otherRec.size)return!1!==iterateSet(O,(function(e){if(otherRec.includes(e))return!1}),!0);var iterator=otherRec.getIterator();return!1!==iterateSimple(iterator,(function(e){if(has(O,e))return iteratorClose(iterator,"normal",!1)}))}},"./node_modules/core-js/internals/set-is-subset-of.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aSet=__webpack_require__("./node_modules/core-js/internals/a-set.js"),size=__webpack_require__("./node_modules/core-js/internals/set-size.js"),iterate=__webpack_require__("./node_modules/core-js/internals/set-iterate.js"),getSetRecord=__webpack_require__("./node_modules/core-js/internals/get-set-record.js");module.exports=function isSubsetOf(other){var O=aSet(this),otherRec=getSetRecord(other);return!(size(O)>otherRec.size)&&!1!==iterate(O,(function(e){if(!otherRec.includes(e))return!1}),!0)}},"./node_modules/core-js/internals/set-is-superset-of.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aSet=__webpack_require__("./node_modules/core-js/internals/a-set.js"),has=__webpack_require__("./node_modules/core-js/internals/set-helpers.js").has,size=__webpack_require__("./node_modules/core-js/internals/set-size.js"),getSetRecord=__webpack_require__("./node_modules/core-js/internals/get-set-record.js"),iterateSimple=__webpack_require__("./node_modules/core-js/internals/iterate-simple.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js");module.exports=function isSupersetOf(other){var O=aSet(this),otherRec=getSetRecord(other);if(size(O)<otherRec.size)return!1;var iterator=otherRec.getIterator();return!1!==iterateSimple(iterator,(function(e){if(!has(O,e))return iteratorClose(iterator,"normal",!1)}))}},"./node_modules/core-js/internals/set-iterate.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),iterateSimple=__webpack_require__("./node_modules/core-js/internals/iterate-simple.js"),SetHelpers=__webpack_require__("./node_modules/core-js/internals/set-helpers.js"),Set=SetHelpers.Set,SetPrototype=SetHelpers.proto,forEach=uncurryThis(SetPrototype.forEach),keys=uncurryThis(SetPrototype.keys),next=keys(new Set).next;module.exports=function(set,fn,interruptible){return interruptible?iterateSimple({iterator:keys(set),next},fn):forEach(set,fn)}},"./node_modules/core-js/internals/set-method-accept-set-like.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var getBuiltIn=__webpack_require__("./node_modules/core-js/internals/get-built-in.js"),createSetLike=function(size){return{size,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},createSetLikeWithInfinitySize=function(size){return{size,has:function(){return!0},keys:function(){throw new Error("e")}}};module.exports=function(name,callback){var Set=getBuiltIn("Set");try{(new Set)[name](createSetLike(0));try{return(new Set)[name](createSetLike(-1)),!1}catch(error2){if(!callback)return!0;try{return(new Set)[name](createSetLikeWithInfinitySize(-1/0)),!1}catch(error){var set=new Set;return set.add(1),set.add(2),callback(set[name](createSetLikeWithInfinitySize(1/0)))}}}catch(error){return!1}}},"./node_modules/core-js/internals/set-size.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThisAccessor=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this-accessor.js"),SetHelpers=__webpack_require__("./node_modules/core-js/internals/set-helpers.js");module.exports=uncurryThisAccessor(SetHelpers.proto,"size","get")||function(set){return set.size}},"./node_modules/core-js/internals/set-symmetric-difference.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aSet=__webpack_require__("./node_modules/core-js/internals/a-set.js"),SetHelpers=__webpack_require__("./node_modules/core-js/internals/set-helpers.js"),clone=__webpack_require__("./node_modules/core-js/internals/set-clone.js"),getSetRecord=__webpack_require__("./node_modules/core-js/internals/get-set-record.js"),iterateSimple=__webpack_require__("./node_modules/core-js/internals/iterate-simple.js"),add=SetHelpers.add,has=SetHelpers.has,remove=SetHelpers.remove;module.exports=function symmetricDifference(other){var O=aSet(this),keysIter=getSetRecord(other).getIterator(),result=clone(O);return iterateSimple(keysIter,(function(e){has(O,e)?remove(result,e):add(result,e)})),result}},"./node_modules/core-js/internals/set-union.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var aSet=__webpack_require__("./node_modules/core-js/internals/a-set.js"),add=__webpack_require__("./node_modules/core-js/internals/set-helpers.js").add,clone=__webpack_require__("./node_modules/core-js/internals/set-clone.js"),getSetRecord=__webpack_require__("./node_modules/core-js/internals/get-set-record.js"),iterateSimple=__webpack_require__("./node_modules/core-js/internals/iterate-simple.js");module.exports=function union(other){var O=aSet(this),keysIter=getSetRecord(other).getIterator(),result=clone(O);return iterateSimple(keysIter,(function(it){add(result,it)})),result}},"./node_modules/core-js/internals/shared-key.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var shared=__webpack_require__("./node_modules/core-js/internals/shared.js"),uid=__webpack_require__("./node_modules/core-js/internals/uid.js"),keys=shared("keys");module.exports=function(key){return keys[key]||(keys[key]=uid(key))}},"./node_modules/core-js/internals/shared-store.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var IS_PURE=__webpack_require__("./node_modules/core-js/internals/is-pure.js"),globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),defineGlobalProperty=__webpack_require__("./node_modules/core-js/internals/define-global-property.js"),store=module.exports=globalThis["__core-js_shared__"]||defineGlobalProperty("__core-js_shared__",{});(store.versions||(store.versions=[])).push({version:"3.41.0",mode:IS_PURE?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"})},"./node_modules/core-js/internals/shared.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var store=__webpack_require__("./node_modules/core-js/internals/shared-store.js");module.exports=function(key,value){return store[key]||(store[key]=value||{})}},"./node_modules/core-js/internals/symbol-constructor-detection.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var V8_VERSION=__webpack_require__("./node_modules/core-js/internals/environment-v8-version.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),$String=__webpack_require__("./node_modules/core-js/internals/global-this.js").String;module.exports=!!Object.getOwnPropertySymbols&&!fails((function(){var symbol=Symbol("symbol detection");return!$String(symbol)||!(Object(symbol)instanceof Symbol)||!Symbol.sham&&V8_VERSION&&V8_VERSION<41}))},"./node_modules/core-js/internals/task.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $location,defer,channel,port,globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),apply=__webpack_require__("./node_modules/core-js/internals/function-apply.js"),bind=__webpack_require__("./node_modules/core-js/internals/function-bind-context.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),html=__webpack_require__("./node_modules/core-js/internals/html.js"),arraySlice=__webpack_require__("./node_modules/core-js/internals/array-slice.js"),createElement=__webpack_require__("./node_modules/core-js/internals/document-create-element.js"),validateArgumentsLength=__webpack_require__("./node_modules/core-js/internals/validate-arguments-length.js"),IS_IOS=__webpack_require__("./node_modules/core-js/internals/environment-is-ios.js"),IS_NODE=__webpack_require__("./node_modules/core-js/internals/environment-is-node.js"),set=globalThis.setImmediate,clear=globalThis.clearImmediate,process=globalThis.process,Dispatch=globalThis.Dispatch,Function=globalThis.Function,MessageChannel=globalThis.MessageChannel,String=globalThis.String,counter=0,queue={};fails((function(){$location=globalThis.location}));var run=function(id){if(hasOwn(queue,id)){var fn=queue[id];delete queue[id],fn()}},runner=function(id){return function(){run(id)}},eventListener=function(event){run(event.data)},globalPostMessageDefer=function(id){globalThis.postMessage(String(id),$location.protocol+"//"+$location.host)};set&&clear||(set=function setImmediate(handler){validateArgumentsLength(arguments.length,1);var fn=isCallable(handler)?handler:Function(handler),args=arraySlice(arguments,1);return queue[++counter]=function(){apply(fn,void 0,args)},defer(counter),counter},clear=function clearImmediate(id){delete queue[id]},IS_NODE?defer=function(id){process.nextTick(runner(id))}:Dispatch&&Dispatch.now?defer=function(id){Dispatch.now(runner(id))}:MessageChannel&&!IS_IOS?(port=(channel=new MessageChannel).port2,channel.port1.onmessage=eventListener,defer=bind(port.postMessage,port)):globalThis.addEventListener&&isCallable(globalThis.postMessage)&&!globalThis.importScripts&&$location&&"file:"!==$location.protocol&&!fails(globalPostMessageDefer)?(defer=globalPostMessageDefer,globalThis.addEventListener("message",eventListener,!1)):defer="onreadystatechange"in createElement("script")?function(id){html.appendChild(createElement("script")).onreadystatechange=function(){html.removeChild(this),run(id)}}:function(id){setTimeout(runner(id),0)}),module.exports={set,clear}},"./node_modules/core-js/internals/to-absolute-index.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var toIntegerOrInfinity=__webpack_require__("./node_modules/core-js/internals/to-integer-or-infinity.js"),max=Math.max,min=Math.min;module.exports=function(index,length){var integer=toIntegerOrInfinity(index);return integer<0?max(integer+length,0):min(integer,length)}},"./node_modules/core-js/internals/to-indexed-object.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var IndexedObject=__webpack_require__("./node_modules/core-js/internals/indexed-object.js"),requireObjectCoercible=__webpack_require__("./node_modules/core-js/internals/require-object-coercible.js");module.exports=function(it){return IndexedObject(requireObjectCoercible(it))}},"./node_modules/core-js/internals/to-integer-or-infinity.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var trunc=__webpack_require__("./node_modules/core-js/internals/math-trunc.js");module.exports=function(argument){var number=+argument;return number!=number||0===number?0:trunc(number)}},"./node_modules/core-js/internals/to-length.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var toIntegerOrInfinity=__webpack_require__("./node_modules/core-js/internals/to-integer-or-infinity.js"),min=Math.min;module.exports=function(argument){var len=toIntegerOrInfinity(argument);return len>0?min(len,9007199254740991):0}},"./node_modules/core-js/internals/to-object.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var requireObjectCoercible=__webpack_require__("./node_modules/core-js/internals/require-object-coercible.js"),$Object=Object;module.exports=function(argument){return $Object(requireObjectCoercible(argument))}},"./node_modules/core-js/internals/to-primitive.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),isObject=__webpack_require__("./node_modules/core-js/internals/is-object.js"),isSymbol=__webpack_require__("./node_modules/core-js/internals/is-symbol.js"),getMethod=__webpack_require__("./node_modules/core-js/internals/get-method.js"),ordinaryToPrimitive=__webpack_require__("./node_modules/core-js/internals/ordinary-to-primitive.js"),wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),$TypeError=TypeError,TO_PRIMITIVE=wellKnownSymbol("toPrimitive");module.exports=function(input,pref){if(!isObject(input)||isSymbol(input))return input;var result,exoticToPrim=getMethod(input,TO_PRIMITIVE);if(exoticToPrim){if(void 0===pref&&(pref="default"),result=call(exoticToPrim,input,pref),!isObject(result)||isSymbol(result))return result;throw new $TypeError("Can't convert object to primitive value")}return void 0===pref&&(pref="number"),ordinaryToPrimitive(input,pref)}},"./node_modules/core-js/internals/to-property-key.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var toPrimitive=__webpack_require__("./node_modules/core-js/internals/to-primitive.js"),isSymbol=__webpack_require__("./node_modules/core-js/internals/is-symbol.js");module.exports=function(argument){var key=toPrimitive(argument,"string");return isSymbol(key)?key:key+""}},"./node_modules/core-js/internals/to-string-tag-support.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var test={};test[__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js")("toStringTag")]="z",module.exports="[object z]"===String(test)},"./node_modules/core-js/internals/to-string.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var classof=__webpack_require__("./node_modules/core-js/internals/classof.js"),$String=String;module.exports=function(argument){if("Symbol"===classof(argument))throw new TypeError("Cannot convert a Symbol value to a string");return $String(argument)}},"./node_modules/core-js/internals/try-to-string.js":module=>{"use strict";var $String=String;module.exports=function(argument){try{return $String(argument)}catch(error){return"Object"}}},"./node_modules/core-js/internals/uid.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),id=0,postfix=Math.random(),toString=uncurryThis(1..toString);module.exports=function(key){return"Symbol("+(void 0===key?"":key)+")_"+toString(++id+postfix,36)}},"./node_modules/core-js/internals/use-symbol-as-uid.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var NATIVE_SYMBOL=__webpack_require__("./node_modules/core-js/internals/symbol-constructor-detection.js");module.exports=NATIVE_SYMBOL&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},"./node_modules/core-js/internals/v8-prototype-define-bug.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js");module.exports=DESCRIPTORS&&fails((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},"./node_modules/core-js/internals/validate-arguments-length.js":module=>{"use strict";var $TypeError=TypeError;module.exports=function(passed,required){if(passed<required)throw new $TypeError("Not enough arguments");return passed}},"./node_modules/core-js/internals/weak-map-basic-detection.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),WeakMap=globalThis.WeakMap;module.exports=isCallable(WeakMap)&&/native code/.test(String(WeakMap))},"./node_modules/core-js/internals/well-known-symbol.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),shared=__webpack_require__("./node_modules/core-js/internals/shared.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),uid=__webpack_require__("./node_modules/core-js/internals/uid.js"),NATIVE_SYMBOL=__webpack_require__("./node_modules/core-js/internals/symbol-constructor-detection.js"),USE_SYMBOL_AS_UID=__webpack_require__("./node_modules/core-js/internals/use-symbol-as-uid.js"),Symbol=globalThis.Symbol,WellKnownSymbolsStore=shared("wks"),createWellKnownSymbol=USE_SYMBOL_AS_UID?Symbol.for||Symbol:Symbol&&Symbol.withoutSetter||uid;module.exports=function(name){return hasOwn(WellKnownSymbolsStore,name)||(WellKnownSymbolsStore[name]=NATIVE_SYMBOL&&hasOwn(Symbol,name)?Symbol[name]:createWellKnownSymbol("Symbol."+name)),WellKnownSymbolsStore[name]}},"./node_modules/core-js/internals/wrap-error-constructor-with-cause.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var getBuiltIn=__webpack_require__("./node_modules/core-js/internals/get-built-in.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),createNonEnumerableProperty=__webpack_require__("./node_modules/core-js/internals/create-non-enumerable-property.js"),isPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-is-prototype-of.js"),setPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-set-prototype-of.js"),copyConstructorProperties=__webpack_require__("./node_modules/core-js/internals/copy-constructor-properties.js"),proxyAccessor=__webpack_require__("./node_modules/core-js/internals/proxy-accessor.js"),inheritIfRequired=__webpack_require__("./node_modules/core-js/internals/inherit-if-required.js"),normalizeStringArgument=__webpack_require__("./node_modules/core-js/internals/normalize-string-argument.js"),installErrorCause=__webpack_require__("./node_modules/core-js/internals/install-error-cause.js"),installErrorStack=__webpack_require__("./node_modules/core-js/internals/error-stack-install.js"),DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),IS_PURE=__webpack_require__("./node_modules/core-js/internals/is-pure.js");module.exports=function(FULL_NAME,wrapper,FORCED,IS_AGGREGATE_ERROR){var OPTIONS_POSITION=IS_AGGREGATE_ERROR?2:1,path=FULL_NAME.split("."),ERROR_NAME=path[path.length-1],OriginalError=getBuiltIn.apply(null,path);if(OriginalError){var OriginalErrorPrototype=OriginalError.prototype;if(!IS_PURE&&hasOwn(OriginalErrorPrototype,"cause")&&delete OriginalErrorPrototype.cause,!FORCED)return OriginalError;var BaseError=getBuiltIn("Error"),WrappedError=wrapper((function(a,b){var message=normalizeStringArgument(IS_AGGREGATE_ERROR?b:a,void 0),result=IS_AGGREGATE_ERROR?new OriginalError(a):new OriginalError;return void 0!==message&&createNonEnumerableProperty(result,"message",message),installErrorStack(result,WrappedError,result.stack,2),this&&isPrototypeOf(OriginalErrorPrototype,this)&&inheritIfRequired(result,this,WrappedError),arguments.length>OPTIONS_POSITION&&installErrorCause(result,arguments[OPTIONS_POSITION]),result}));if(WrappedError.prototype=OriginalErrorPrototype,"Error"!==ERROR_NAME?setPrototypeOf?setPrototypeOf(WrappedError,BaseError):copyConstructorProperties(WrappedError,BaseError,{name:!0}):DESCRIPTORS&&"stackTraceLimit"in OriginalError&&(proxyAccessor(WrappedError,OriginalError,"stackTraceLimit"),proxyAccessor(WrappedError,OriginalError,"prepareStackTrace")),copyConstructorProperties(WrappedError,OriginalError),!IS_PURE)try{OriginalErrorPrototype.name!==ERROR_NAME&&createNonEnumerableProperty(OriginalErrorPrototype,"name",ERROR_NAME),OriginalErrorPrototype.constructor=WrappedError}catch(error){}return WrappedError}}},"./node_modules/core-js/modules/es.array.at.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),toObject=__webpack_require__("./node_modules/core-js/internals/to-object.js"),lengthOfArrayLike=__webpack_require__("./node_modules/core-js/internals/length-of-array-like.js"),toIntegerOrInfinity=__webpack_require__("./node_modules/core-js/internals/to-integer-or-infinity.js"),addToUnscopables=__webpack_require__("./node_modules/core-js/internals/add-to-unscopables.js");$({target:"Array",proto:!0},{at:function at(index){var O=toObject(this),len=lengthOfArrayLike(O),relativeIndex=toIntegerOrInfinity(index),k=relativeIndex>=0?relativeIndex:len+relativeIndex;return k<0||k>=len?void 0:O[k]}}),addToUnscopables("at")},"./node_modules/core-js/modules/es.array.push.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),toObject=__webpack_require__("./node_modules/core-js/internals/to-object.js"),lengthOfArrayLike=__webpack_require__("./node_modules/core-js/internals/length-of-array-like.js"),setArrayLength=__webpack_require__("./node_modules/core-js/internals/array-set-length.js"),doesNotExceedSafeInteger=__webpack_require__("./node_modules/core-js/internals/does-not-exceed-safe-integer.js");$({target:"Array",proto:!0,arity:1,forced:__webpack_require__("./node_modules/core-js/internals/fails.js")((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(error){return error instanceof TypeError}}()},{push:function push(item){var O=toObject(this),len=lengthOfArrayLike(O),argCount=arguments.length;doesNotExceedSafeInteger(len+argCount);for(var i=0;i<argCount;i++)O[len]=arguments[i],len++;return setArrayLength(O,len),len}})},"./node_modules/core-js/modules/es.array.to-sorted.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),toIndexedObject=__webpack_require__("./node_modules/core-js/internals/to-indexed-object.js"),arrayFromConstructorAndList=__webpack_require__("./node_modules/core-js/internals/array-from-constructor-and-list.js"),getBuiltInPrototypeMethod=__webpack_require__("./node_modules/core-js/internals/get-built-in-prototype-method.js"),addToUnscopables=__webpack_require__("./node_modules/core-js/internals/add-to-unscopables.js"),$Array=Array,sort=uncurryThis(getBuiltInPrototypeMethod("Array","sort"));$({target:"Array",proto:!0},{toSorted:function toSorted(compareFn){void 0!==compareFn&&aCallable(compareFn);var O=toIndexedObject(this),A=arrayFromConstructorAndList($Array,O);return sort(A,compareFn)}}),addToUnscopables("toSorted")},"./node_modules/core-js/modules/es.array.unscopables.flat-map.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/internals/add-to-unscopables.js")("flatMap")},"./node_modules/core-js/modules/es.array.unscopables.flat.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/internals/add-to-unscopables.js")("flat")},"./node_modules/core-js/modules/es.array.unshift.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),toObject=__webpack_require__("./node_modules/core-js/internals/to-object.js"),lengthOfArrayLike=__webpack_require__("./node_modules/core-js/internals/length-of-array-like.js"),setArrayLength=__webpack_require__("./node_modules/core-js/internals/array-set-length.js"),deletePropertyOrThrow=__webpack_require__("./node_modules/core-js/internals/delete-property-or-throw.js"),doesNotExceedSafeInteger=__webpack_require__("./node_modules/core-js/internals/does-not-exceed-safe-integer.js");$({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(error){return error instanceof TypeError}}()},{unshift:function unshift(item){var O=toObject(this),len=lengthOfArrayLike(O),argCount=arguments.length;if(argCount){doesNotExceedSafeInteger(len+argCount);for(var k=len;k--;){var to=k+argCount;k in O?O[to]=O[k]:deletePropertyOrThrow(O,to)}for(var j=0;j<argCount;j++)O[j]=arguments[j]}return setArrayLength(O,len+argCount)}})},"./node_modules/core-js/modules/es.error.cause.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),apply=__webpack_require__("./node_modules/core-js/internals/function-apply.js"),wrapErrorConstructorWithCause=__webpack_require__("./node_modules/core-js/internals/wrap-error-constructor-with-cause.js"),WebAssembly=globalThis.WebAssembly,FORCED=7!==new Error("e",{cause:7}).cause,exportGlobalErrorCauseWrapper=function(ERROR_NAME,wrapper){var O={};O[ERROR_NAME]=wrapErrorConstructorWithCause(ERROR_NAME,wrapper,FORCED),$({global:!0,constructor:!0,arity:1,forced:FORCED},O)},exportWebAssemblyErrorCauseWrapper=function(ERROR_NAME,wrapper){if(WebAssembly&&WebAssembly[ERROR_NAME]){var O={};O[ERROR_NAME]=wrapErrorConstructorWithCause("WebAssembly."+ERROR_NAME,wrapper,FORCED),$({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:FORCED},O)}};exportGlobalErrorCauseWrapper("Error",(function(init){return function Error(message){return apply(init,this,arguments)}})),exportGlobalErrorCauseWrapper("EvalError",(function(init){return function EvalError(message){return apply(init,this,arguments)}})),exportGlobalErrorCauseWrapper("RangeError",(function(init){return function RangeError(message){return apply(init,this,arguments)}})),exportGlobalErrorCauseWrapper("ReferenceError",(function(init){return function ReferenceError(message){return apply(init,this,arguments)}})),exportGlobalErrorCauseWrapper("SyntaxError",(function(init){return function SyntaxError(message){return apply(init,this,arguments)}})),exportGlobalErrorCauseWrapper("TypeError",(function(init){return function TypeError(message){return apply(init,this,arguments)}})),exportGlobalErrorCauseWrapper("URIError",(function(init){return function URIError(message){return apply(init,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("CompileError",(function(init){return function CompileError(message){return apply(init,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("LinkError",(function(init){return function LinkError(message){return apply(init,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("RuntimeError",(function(init){return function RuntimeError(message){return apply(init,this,arguments)}}))},"./node_modules/core-js/modules/es.iterator.constructor.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),anInstance=__webpack_require__("./node_modules/core-js/internals/an-instance.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),getPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-get-prototype-of.js"),defineBuiltInAccessor=__webpack_require__("./node_modules/core-js/internals/define-built-in-accessor.js"),createProperty=__webpack_require__("./node_modules/core-js/internals/create-property.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),hasOwn=__webpack_require__("./node_modules/core-js/internals/has-own-property.js"),wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),IteratorPrototype=__webpack_require__("./node_modules/core-js/internals/iterators-core.js").IteratorPrototype,DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),IS_PURE=__webpack_require__("./node_modules/core-js/internals/is-pure.js"),TO_STRING_TAG=wellKnownSymbol("toStringTag"),$TypeError=TypeError,NativeIterator=globalThis.Iterator,FORCED=IS_PURE||!isCallable(NativeIterator)||NativeIterator.prototype!==IteratorPrototype||!fails((function(){NativeIterator({})})),IteratorConstructor=function Iterator(){if(anInstance(this,IteratorPrototype),getPrototypeOf(this)===IteratorPrototype)throw new $TypeError("Abstract class Iterator not directly constructable")},defineIteratorPrototypeAccessor=function(key,value){DESCRIPTORS?defineBuiltInAccessor(IteratorPrototype,key,{configurable:!0,get:function(){return value},set:function(replacement){if(anObject(this),this===IteratorPrototype)throw new $TypeError("You can't redefine this property");hasOwn(this,key)?this[key]=replacement:createProperty(this,key,replacement)}}):IteratorPrototype[key]=value};hasOwn(IteratorPrototype,TO_STRING_TAG)||defineIteratorPrototypeAccessor(TO_STRING_TAG,"Iterator"),!FORCED&&hasOwn(IteratorPrototype,"constructor")&&IteratorPrototype.constructor!==Object||defineIteratorPrototypeAccessor("constructor",IteratorConstructor),IteratorConstructor.prototype=IteratorPrototype,$({global:!0,constructor:!0,forced:FORCED},{Iterator:IteratorConstructor})},"./node_modules/core-js/modules/es.iterator.every.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),iterate=__webpack_require__("./node_modules/core-js/internals/iterate.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js");$({target:"Iterator",proto:!0,real:!0},{every:function every(predicate){anObject(this),aCallable(predicate);var record=getIteratorDirect(this),counter=0;return!iterate(record,(function(value,stop){if(!predicate(value,counter++))return stop()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},"./node_modules/core-js/modules/es.iterator.filter.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js"),createIteratorProxy=__webpack_require__("./node_modules/core-js/internals/iterator-create-proxy.js"),callWithSafeIterationClosing=__webpack_require__("./node_modules/core-js/internals/call-with-safe-iteration-closing.js"),IS_PURE=__webpack_require__("./node_modules/core-js/internals/is-pure.js"),IteratorProxy=createIteratorProxy((function(){for(var result,value,iterator=this.iterator,predicate=this.predicate,next=this.next;;){if(result=anObject(call(next,iterator)),this.done=!!result.done)return;if(value=result.value,callWithSafeIterationClosing(iterator,predicate,[value,this.counter++],!0))return value}}));$({target:"Iterator",proto:!0,real:!0,forced:IS_PURE},{filter:function filter(predicate){return anObject(this),aCallable(predicate),new IteratorProxy(getIteratorDirect(this),{predicate})}})},"./node_modules/core-js/modules/es.iterator.find.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),iterate=__webpack_require__("./node_modules/core-js/internals/iterate.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js");$({target:"Iterator",proto:!0,real:!0},{find:function find(predicate){anObject(this),aCallable(predicate);var record=getIteratorDirect(this),counter=0;return iterate(record,(function(value,stop){if(predicate(value,counter++))return stop(value)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},"./node_modules/core-js/modules/es.iterator.flat-map.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js"),getIteratorFlattenable=__webpack_require__("./node_modules/core-js/internals/get-iterator-flattenable.js"),createIteratorProxy=__webpack_require__("./node_modules/core-js/internals/iterator-create-proxy.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js"),IS_PURE=__webpack_require__("./node_modules/core-js/internals/is-pure.js"),IteratorProxy=createIteratorProxy((function(){for(var result,inner,iterator=this.iterator,mapper=this.mapper;;){if(inner=this.inner)try{if(!(result=anObject(call(inner.next,inner.iterator))).done)return result.value;this.inner=null}catch(error){iteratorClose(iterator,"throw",error)}if(result=anObject(call(this.next,iterator)),this.done=!!result.done)return;try{this.inner=getIteratorFlattenable(mapper(result.value,this.counter++),!1)}catch(error){iteratorClose(iterator,"throw",error)}}}));$({target:"Iterator",proto:!0,real:!0,forced:IS_PURE},{flatMap:function flatMap(mapper){return anObject(this),aCallable(mapper),new IteratorProxy(getIteratorDirect(this),{mapper,inner:null})}})},"./node_modules/core-js/modules/es.iterator.for-each.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),iterate=__webpack_require__("./node_modules/core-js/internals/iterate.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js");$({target:"Iterator",proto:!0,real:!0},{forEach:function forEach(fn){anObject(this),aCallable(fn);var record=getIteratorDirect(this),counter=0;iterate(record,(function(value){fn(value,counter++)}),{IS_RECORD:!0})}})},"./node_modules/core-js/modules/es.iterator.map.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),map=__webpack_require__("./node_modules/core-js/internals/iterator-map.js");$({target:"Iterator",proto:!0,real:!0,forced:__webpack_require__("./node_modules/core-js/internals/is-pure.js")},{map})},"./node_modules/core-js/modules/es.iterator.reduce.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),iterate=__webpack_require__("./node_modules/core-js/internals/iterate.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js"),$TypeError=TypeError;$({target:"Iterator",proto:!0,real:!0},{reduce:function reduce(reducer){anObject(this),aCallable(reducer);var record=getIteratorDirect(this),noInitial=arguments.length<2,accumulator=noInitial?void 0:arguments[1],counter=0;if(iterate(record,(function(value){noInitial?(noInitial=!1,accumulator=value):accumulator=reducer(accumulator,value,counter),counter++}),{IS_RECORD:!0}),noInitial)throw new $TypeError("Reduce of empty iterator with no initial value");return accumulator}})},"./node_modules/core-js/modules/es.iterator.some.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),iterate=__webpack_require__("./node_modules/core-js/internals/iterate.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js");$({target:"Iterator",proto:!0,real:!0},{some:function some(predicate){anObject(this),aCallable(predicate);var record=getIteratorDirect(this),counter=0;return iterate(record,(function(value,stop){if(predicate(value,counter++))return stop()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},"./node_modules/core-js/modules/es.json.stringify.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),getBuiltIn=__webpack_require__("./node_modules/core-js/internals/get-built-in.js"),apply=__webpack_require__("./node_modules/core-js/internals/function-apply.js"),call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),isSymbol=__webpack_require__("./node_modules/core-js/internals/is-symbol.js"),arraySlice=__webpack_require__("./node_modules/core-js/internals/array-slice.js"),getReplacerFunction=__webpack_require__("./node_modules/core-js/internals/get-json-replacer-function.js"),NATIVE_SYMBOL=__webpack_require__("./node_modules/core-js/internals/symbol-constructor-detection.js"),$String=String,$stringify=getBuiltIn("JSON","stringify"),exec=uncurryThis(/./.exec),charAt=uncurryThis("".charAt),charCodeAt=uncurryThis("".charCodeAt),replace=uncurryThis("".replace),numberToString=uncurryThis(1..toString),tester=/[\uD800-\uDFFF]/g,low=/^[\uD800-\uDBFF]$/,hi=/^[\uDC00-\uDFFF]$/,WRONG_SYMBOLS_CONVERSION=!NATIVE_SYMBOL||fails((function(){var symbol=getBuiltIn("Symbol")("stringify detection");return"[null]"!==$stringify([symbol])||"{}"!==$stringify({a:symbol})||"{}"!==$stringify(Object(symbol))})),ILL_FORMED_UNICODE=fails((function(){return'"\\udf06\\ud834"'!==$stringify("\udf06\ud834")||'"\\udead"'!==$stringify("\udead")})),stringifyWithSymbolsFix=function(it,replacer){var args=arraySlice(arguments),$replacer=getReplacerFunction(replacer);if(isCallable($replacer)||void 0!==it&&!isSymbol(it))return args[1]=function(key,value){if(isCallable($replacer)&&(value=call($replacer,this,$String(key),value)),!isSymbol(value))return value},apply($stringify,null,args)},fixIllFormed=function(match,offset,string){var prev=charAt(string,offset-1),next=charAt(string,offset+1);return exec(low,match)&&!exec(hi,next)||exec(hi,match)&&!exec(low,prev)?"\\u"+numberToString(charCodeAt(match,0),16):match};$stringify&&$({target:"JSON",stat:!0,arity:3,forced:WRONG_SYMBOLS_CONVERSION||ILL_FORMED_UNICODE},{stringify:function stringify(it,replacer,space){var args=arraySlice(arguments),result=apply(WRONG_SYMBOLS_CONVERSION?stringifyWithSymbolsFix:$stringify,null,args);return ILL_FORMED_UNICODE&&"string"==typeof result?replace(result,tester,fixIllFormed):result}})},"./node_modules/core-js/modules/es.object.from-entries.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),iterate=__webpack_require__("./node_modules/core-js/internals/iterate.js"),createProperty=__webpack_require__("./node_modules/core-js/internals/create-property.js");$({target:"Object",stat:!0},{fromEntries:function fromEntries(iterable){var obj={};return iterate(iterable,(function(k,v){createProperty(obj,k,v)}),{AS_ENTRIES:!0}),obj}})},"./node_modules/core-js/modules/es.set.difference.v2.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),difference=__webpack_require__("./node_modules/core-js/internals/set-difference.js");$({target:"Set",proto:!0,real:!0,forced:!__webpack_require__("./node_modules/core-js/internals/set-method-accept-set-like.js")("difference",(function(result){return 0===result.size}))},{difference})},"./node_modules/core-js/modules/es.set.intersection.v2.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),intersection=__webpack_require__("./node_modules/core-js/internals/set-intersection.js");$({target:"Set",proto:!0,real:!0,forced:!__webpack_require__("./node_modules/core-js/internals/set-method-accept-set-like.js")("intersection",(function(result){return 2===result.size&&result.has(1)&&result.has(2)}))||fails((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection})},"./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),isDisjointFrom=__webpack_require__("./node_modules/core-js/internals/set-is-disjoint-from.js");$({target:"Set",proto:!0,real:!0,forced:!__webpack_require__("./node_modules/core-js/internals/set-method-accept-set-like.js")("isDisjointFrom",(function(result){return!result}))},{isDisjointFrom})},"./node_modules/core-js/modules/es.set.is-subset-of.v2.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),isSubsetOf=__webpack_require__("./node_modules/core-js/internals/set-is-subset-of.js");$({target:"Set",proto:!0,real:!0,forced:!__webpack_require__("./node_modules/core-js/internals/set-method-accept-set-like.js")("isSubsetOf",(function(result){return result}))},{isSubsetOf})},"./node_modules/core-js/modules/es.set.is-superset-of.v2.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),isSupersetOf=__webpack_require__("./node_modules/core-js/internals/set-is-superset-of.js");$({target:"Set",proto:!0,real:!0,forced:!__webpack_require__("./node_modules/core-js/internals/set-method-accept-set-like.js")("isSupersetOf",(function(result){return!result}))},{isSupersetOf})},"./node_modules/core-js/modules/es.set.symmetric-difference.v2.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),symmetricDifference=__webpack_require__("./node_modules/core-js/internals/set-symmetric-difference.js");$({target:"Set",proto:!0,real:!0,forced:!__webpack_require__("./node_modules/core-js/internals/set-method-accept-set-like.js")("symmetricDifference")},{symmetricDifference})},"./node_modules/core-js/modules/es.set.union.v2.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),union=__webpack_require__("./node_modules/core-js/internals/set-union.js");$({target:"Set",proto:!0,real:!0,forced:!__webpack_require__("./node_modules/core-js/internals/set-method-accept-set-like.js")("union")},{union})},"./node_modules/core-js/modules/es.string.at-alternative.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),requireObjectCoercible=__webpack_require__("./node_modules/core-js/internals/require-object-coercible.js"),toIntegerOrInfinity=__webpack_require__("./node_modules/core-js/internals/to-integer-or-infinity.js"),toString=__webpack_require__("./node_modules/core-js/internals/to-string.js"),fails=__webpack_require__("./node_modules/core-js/internals/fails.js"),charAt=uncurryThis("".charAt);$({target:"String",proto:!0,forced:fails((function(){return"\ud842"!=="".at(-2)}))},{at:function at(index){var S=toString(requireObjectCoercible(this)),len=S.length,relativeIndex=toIntegerOrInfinity(index),k=relativeIndex>=0?relativeIndex:len+relativeIndex;return k<0||k>=len?void 0:charAt(S,k)}})},"./node_modules/core-js/modules/es.string.replace-all.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),requireObjectCoercible=__webpack_require__("./node_modules/core-js/internals/require-object-coercible.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),isNullOrUndefined=__webpack_require__("./node_modules/core-js/internals/is-null-or-undefined.js"),isRegExp=__webpack_require__("./node_modules/core-js/internals/is-regexp.js"),toString=__webpack_require__("./node_modules/core-js/internals/to-string.js"),getMethod=__webpack_require__("./node_modules/core-js/internals/get-method.js"),getRegExpFlags=__webpack_require__("./node_modules/core-js/internals/regexp-get-flags.js"),getSubstitution=__webpack_require__("./node_modules/core-js/internals/get-substitution.js"),wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),IS_PURE=__webpack_require__("./node_modules/core-js/internals/is-pure.js"),REPLACE=wellKnownSymbol("replace"),$TypeError=TypeError,indexOf=uncurryThis("".indexOf),replace=uncurryThis("".replace),stringSlice=uncurryThis("".slice),max=Math.max;$({target:"String",proto:!0},{replaceAll:function replaceAll(searchValue,replaceValue){var IS_REG_EXP,flags,replacer,string,searchString,functionalReplace,searchLength,advanceBy,position,replacement,O=requireObjectCoercible(this),endOfLastMatch=0,result="";if(!isNullOrUndefined(searchValue)){if((IS_REG_EXP=isRegExp(searchValue))&&(flags=toString(requireObjectCoercible(getRegExpFlags(searchValue))),!~indexOf(flags,"g")))throw new $TypeError("`.replaceAll` does not allow non-global regexes");if(replacer=getMethod(searchValue,REPLACE))return call(replacer,searchValue,O,replaceValue);if(IS_PURE&&IS_REG_EXP)return replace(toString(O),searchValue,replaceValue)}for(string=toString(O),searchString=toString(searchValue),(functionalReplace=isCallable(replaceValue))||(replaceValue=toString(replaceValue)),searchLength=searchString.length,advanceBy=max(1,searchLength),position=indexOf(string,searchString);-1!==position;)replacement=functionalReplace?toString(replaceValue(searchString,position,string)):getSubstitution(searchString,string,position,[],void 0,replaceValue),result+=stringSlice(string,endOfLastMatch,position)+replacement,endOfLastMatch=position+searchLength,position=position+advanceBy>string.length?-1:indexOf(string,searchString,position+advanceBy);return endOfLastMatch<string.length&&(result+=stringSlice(string,endOfLastMatch)),result}})},"./node_modules/core-js/modules/esnext.iterator.constructor.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.constructor.js")},"./node_modules/core-js/modules/esnext.iterator.every.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.every.js")},"./node_modules/core-js/modules/esnext.iterator.filter.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.filter.js")},"./node_modules/core-js/modules/esnext.iterator.find.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.find.js")},"./node_modules/core-js/modules/esnext.iterator.flat-map.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.flat-map.js")},"./node_modules/core-js/modules/esnext.iterator.for-each.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.for-each.js")},"./node_modules/core-js/modules/esnext.iterator.map.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.map.js")},"./node_modules/core-js/modules/esnext.iterator.reduce.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.reduce.js")},"./node_modules/core-js/modules/esnext.iterator.some.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/es.iterator.some.js")},"./node_modules/core-js/modules/web.clear-immediate.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),clearImmediate=__webpack_require__("./node_modules/core-js/internals/task.js").clear;$({global:!0,bind:!0,enumerable:!0,forced:globalThis.clearImmediate!==clearImmediate},{clearImmediate})},"./node_modules/core-js/modules/web.immediate.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/core-js/modules/web.clear-immediate.js"),__webpack_require__("./node_modules/core-js/modules/web.set-immediate.js")},"./node_modules/core-js/modules/web.set-immediate.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),globalThis=__webpack_require__("./node_modules/core-js/internals/global-this.js"),setTask=__webpack_require__("./node_modules/core-js/internals/task.js").set,schedulersFix=__webpack_require__("./node_modules/core-js/internals/schedulers-fix.js"),setImmediate=globalThis.setImmediate?schedulersFix(setTask,!1):setTask;$({global:!0,bind:!0,enumerable:!0,forced:globalThis.setImmediate!==setImmediate},{setImmediate})},"./node_modules/handsontable/3rdparty/SheetClip/SheetClip.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>stringify,q:()=>parse});const regUniversalNewLine=/^(\r\n|\n\r|\r|\n)/,regNextCellNoQuotes=/^[^\t\r\n]+/,regNextEmptyCell=/^\t/;function parse(str){const arr=[[""]];if(0===str.length)return arr;let lastLength,column=0,row=0;for(;str.length>0&&lastLength!==str.length;)if(lastLength=str.length,str.match(regNextEmptyCell))str=str.replace(regNextEmptyCell,""),column+=1,arr[row][column]="";else if(str.match(regUniversalNewLine))str=str.replace(regUniversalNewLine,""),column=0,row+=1,arr[row]=[""];else{let nextCell="";if(str.startsWith('"')){let quoteNo=0,isStillCell=!0;for(;isStillCell;){const nextChar=str.slice(0,1);'"'===nextChar&&(quoteNo+=1),nextCell+=nextChar,(0===(str=str.slice(1)).length||str.match(/^[\t\r\n]/)&&quoteNo%2==0)&&(isStillCell=!1)}nextCell=nextCell.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(match=>new Array(Math.floor(match.length/2)).fill('"').join("")))}else{const matchedText=str.match(regNextCellNoQuotes);nextCell=matchedText?matchedText[0]:"",str=str.slice(nextCell.length)}arr[row][column]=nextCell}return arr}function stringify(arr){let r,rLen,c,cLen,val,str="";for(r=0,rLen=arr.length;r<rLen;r+=1){for(cLen=arr[r].length,c=0;c<cLen;c+=1)c>0&&(str+="\t"),val=arr[r][c],"string"==typeof val?val.indexOf("\n")>-1?str+=`"${val.replace(/"/g,'""')}"`:str+=val:str+=null==val?"":val;r!==rLen-1&&(str+="\n")}return str}},"./node_modules/handsontable/3rdparty/walkontable/src/calculator/viewportBase.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C:()=>ViewportBaseCalculator});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ViewportBaseCalculator{constructor(calculationTypes){_defineProperty(this,"calculationTypes",[]),_defineProperty(this,"calculationResults",new Map),this.calculationTypes=calculationTypes}_initialize(context){this.calculationTypes.forEach((_ref=>{let[id,calculator]=_ref;this.calculationResults.set(id,calculator),calculator.initialize(context)}))}_process(index,context){this.calculationTypes.forEach((_ref2=>{let[,calculator]=_ref2;return calculator.process(index,context)}))}_finalize(context){this.calculationTypes.forEach((_ref3=>{let[,calculator]=_ref3;return calculator.finalize(context)}))}getResultsFor(calculatorId){return this.calculationResults.get(calculatorId)}}},"./node_modules/handsontable/3rdparty/walkontable/src/calculator/viewportColumns.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{U:()=>ViewportColumnsCalculator,j:()=>DEFAULT_WIDTH});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _viewportBase_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/calculator/viewportBase.mjs");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const DEFAULT_WIDTH=50;class ViewportColumnsCalculator extends _viewportBase_mjs__WEBPACK_IMPORTED_MODULE_2__.C{constructor(_ref){let{calculationTypes,viewportWidth,scrollOffset,totalColumns,columnWidthFn,overrideFn,inlineStartOffset}=_ref;super(calculationTypes),_defineProperty(this,"viewportWidth",0),_defineProperty(this,"scrollOffset",0),_defineProperty(this,"zeroBasedScrollOffset",0),_defineProperty(this,"totalColumns",0),_defineProperty(this,"columnWidthFn",null),_defineProperty(this,"columnWidth",0),_defineProperty(this,"overrideFn",null),_defineProperty(this,"inlineStartOffset",0),_defineProperty(this,"totalCalculatedWidth",0),_defineProperty(this,"startPositions",[]),_defineProperty(this,"needReverse",!0),this.viewportWidth=viewportWidth,this.scrollOffset=scrollOffset,this.zeroBasedScrollOffset=Math.max(scrollOffset,0),this.totalColumns=totalColumns,this.columnWidthFn=columnWidthFn,this.overrideFn=overrideFn,this.inlineStartOffset=inlineStartOffset,this.calculate()}calculate(){this._initialize(this);for(let column=0;column<this.totalColumns;column++)if(this.columnWidth=this.getColumnWidth(column),this._process(column,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(column){const width=this.columnWidthFn(column);return isNaN(width)?DEFAULT_WIDTH:width}}},"./node_modules/handsontable/3rdparty/walkontable/src/cell/coords.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js");function _classPrivateFieldInitSpec(e,t,a){(function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _classPrivateFieldGet(s,a){return s.get(_assertClassBrand(s,a))}function _classPrivateFieldSet(s,a,r){return s.set(_assertClassBrand(s,a),r),r}function _assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _isRtl=new WeakMap;class CellCoords{constructor(row,column){let isRtl=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_defineProperty(this,"row",null),_defineProperty(this,"col",null),_classPrivateFieldInitSpec(this,_isRtl,!1),_classPrivateFieldSet(_isRtl,this,isRtl),void 0!==row&&void 0!==column&&(this.row=row,this.col=column)}isValid(tableParams){const{countRows,countCols,countRowHeaders,countColHeaders}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...tableParams};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-countColHeaders||this.col<-countRowHeaders)&&!(this.row>=countRows||this.col>=countCols))}isEqual(coords){return coords===this||this.row===coords.row&&this.col===coords.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _classPrivateFieldGet(_isRtl,this)}isSouthEastOf(testedCoords){return this.row>=testedCoords.row&&(_classPrivateFieldGet(_isRtl,this)?this.col<=testedCoords.col:this.col>=testedCoords.col)}isNorthWestOf(testedCoords){return this.row<=testedCoords.row&&(_classPrivateFieldGet(_isRtl,this)?this.col>=testedCoords.col:this.col<=testedCoords.col)}isSouthWestOf(testedCoords){return this.row>=testedCoords.row&&(_classPrivateFieldGet(_isRtl,this)?this.col>=testedCoords.col:this.col<=testedCoords.col)}isNorthEastOf(testedCoords){return this.row<=testedCoords.row&&(_classPrivateFieldGet(_isRtl,this)?this.col<=testedCoords.col:this.col>=testedCoords.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(coords){return Number.isInteger(null==coords?void 0:coords.row)&&(this.row=coords.row),Number.isInteger(null==coords?void 0:coords.col)&&(this.col=coords.col),coords instanceof CellCoords&&_classPrivateFieldSet(_isRtl,this,coords.isRtl()),this}clone(){return new CellCoords(this.row,this.col,_classPrivateFieldGet(_isRtl,this))}toObject(){return{row:this.row,col:this.col}}}const __WEBPACK_DEFAULT_EXPORT__=CellCoords},"./node_modules/handsontable/3rdparty/walkontable/src/cell/range.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _cell_coords_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/cell/coords.mjs");function _classPrivateFieldInitSpec(e,t,a){(function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _classPrivateFieldGet(s,a){return s.get(_assertClassBrand(s,a))}function _assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _isRtl=new WeakMap;class CellRange{constructor(highlight){let from=arguments.length>1&&void 0!==arguments[1]?arguments[1]:highlight,to=arguments.length>2&&void 0!==arguments[2]?arguments[2]:highlight,isRtl=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_defineProperty(this,"highlight",null),_defineProperty(this,"from",null),_defineProperty(this,"to",null),_classPrivateFieldInitSpec(this,_isRtl,!1),this.highlight=highlight.clone(),this.from=from.clone(),this.to=to.clone(),function _classPrivateFieldSet(s,a,r){return s.set(_assertClassBrand(s,a),r),r}(_isRtl,this,isRtl)}setHighlight(coords){return this.highlight=coords.clone(),this}setFrom(coords){return this.from=coords.clone(),this}setTo(coords){return this.to=coords.clone(),this}isValid(tableParams){return this.from.isValid(tableParams)&&this.to.isValid(tableParams)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const fromRow=Math.max(this.from.row,0),toRow=Math.max(this.to.row,0);return Math.max(fromRow,toRow)-Math.min(fromRow,toRow)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const fromCol=Math.max(this.from.col,0),toCol=Math.max(this.to.col,0);return Math.max(fromCol,toCol)-Math.min(fromCol,toCol)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(cellCoords){const{row,col}=cellCoords,topStart=this.getOuterTopStartCorner(),bottomEnd=this.getOuterBottomEndCorner();return topStart.row<=row&&bottomEnd.row>=row&&topStart.col<=col&&bottomEnd.col>=col}includesRange(cellRange){return this.includes(cellRange.getOuterTopStartCorner())&&this.includes(cellRange.getOuterBottomEndCorner())}isEqual(cellRange){return Math.min(this.from.row,this.to.row)===Math.min(cellRange.from.row,cellRange.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(cellRange.from.row,cellRange.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(cellRange.from.col,cellRange.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(cellRange.from.col,cellRange.to.col)}overlaps(cellRange){return cellRange.isSouthEastOf(this.getOuterTopLeftCorner())&&cellRange.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(cellCoords){return this.getOuterTopLeftCorner().isSouthEastOf(cellCoords)||this.getOuterBottomRightCorner().isSouthEastOf(cellCoords)}isNorthWestOf(cellCoords){return this.getOuterTopLeftCorner().isNorthWestOf(cellCoords)||this.getOuterBottomRightCorner().isNorthWestOf(cellCoords)}isOverlappingHorizontally(cellRange){return this.getOuterTopEndCorner().col>=cellRange.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=cellRange.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=cellRange.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=cellRange.getOuterTopStartCorner().col}isOverlappingVertically(cellRange){return this.getOuterBottomStartCorner().row>=cellRange.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=cellRange.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=cellRange.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=cellRange.getOuterTopRightCorner().row}expand(cellCoords){const topStart=this.getOuterTopStartCorner(),bottomEnd=this.getOuterBottomEndCorner();return(cellCoords.row<topStart.row||cellCoords.col<topStart.col||cellCoords.row>bottomEnd.row||cellCoords.col>bottomEnd.col)&&(this.from=this._createCellCoords(Math.min(topStart.row,cellCoords.row),Math.min(topStart.col,cellCoords.col)),this.to=this._createCellCoords(Math.max(bottomEnd.row,cellCoords.row),Math.max(bottomEnd.col,cellCoords.col)),!0)}expandByRange(expandingRange){let changeDirection=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(expandingRange)||!this.overlaps(expandingRange))return!1;const topStart=this.getOuterTopStartCorner(),bottomEnd=this.getOuterBottomEndCorner(),initialDirection=this.getDirection(),expandingTopStart=expandingRange.getOuterTopStartCorner(),expandingBottomEnd=expandingRange.getOuterBottomEndCorner(),resultTopRow=Math.min(topStart.row,expandingTopStart.row),resultTopCol=Math.min(topStart.col,expandingTopStart.col),resultBottomRow=Math.max(bottomEnd.row,expandingBottomEnd.row),resultBottomCol=Math.max(bottomEnd.col,expandingBottomEnd.col),finalFrom=this._createCellCoords(resultTopRow,resultTopCol),finalTo=this._createCellCoords(resultBottomRow,resultBottomCol);return this.from=finalFrom,this.to=finalTo,this.setDirection(initialDirection),changeDirection&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(direction){switch(direction){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _classPrivateFieldGet(_isRtl,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _classPrivateFieldGet(_isRtl,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _classPrivateFieldGet(_isRtl,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _classPrivateFieldGet(_isRtl,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _classPrivateFieldGet(_isRtl,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _classPrivateFieldGet(_isRtl,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _classPrivateFieldGet(_isRtl,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _classPrivateFieldGet(_isRtl,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(coords){return coords.isEqual(this.getOuterTopLeftCorner())||coords.isEqual(this.getOuterTopRightCorner())||coords.isEqual(this.getOuterBottomLeftCorner())||coords.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(coords){return coords instanceof _cell_coords_mjs__WEBPACK_IMPORTED_MODULE_2__.A&&(coords.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():coords.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():coords.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():coords.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(range){if(!this.includesRange(range))return[];const thisBorders_top=Math.min(this.from.row,this.to.row),thisBorders_bottom=Math.max(this.from.row,this.to.row),thisBorders_left=Math.min(this.from.col,this.to.col),thisBorders_right=Math.max(this.from.col,this.to.col),rangeBorders_top=Math.min(range.from.row,range.to.row),rangeBorders_bottom=Math.max(range.from.row,range.to.row),rangeBorders_left=Math.min(range.from.col,range.to.col),rangeBorders_right=Math.max(range.from.col,range.to.col),result=[];return thisBorders_top===rangeBorders_top&&result.push("top"),thisBorders_right===rangeBorders_right&&result.push(_classPrivateFieldGet(_isRtl,this)?"left":"right"),thisBorders_bottom===rangeBorders_bottom&&result.push("bottom"),thisBorders_left===rangeBorders_left&&result.push(_classPrivateFieldGet(_isRtl,this)?"right":"left"),result}getInner(){const topStart=this.getOuterTopStartCorner(),bottomEnd=this.getOuterBottomEndCorner(),out=[];for(let r=topStart.row;r<=bottomEnd.row;r++)for(let c=topStart.col;c<=bottomEnd.col;c++)this.from.row===r&&this.from.col===c||this.to.row===r&&this.to.col===c||out.push(this._createCellCoords(r,c));return out}getAll(){const topStart=this.getOuterTopStartCorner(),bottomEnd=this.getOuterBottomEndCorner(),out=[];for(let r=topStart.row;r<=bottomEnd.row;r++)for(let c=topStart.col;c<=bottomEnd.col;c++)topStart.row===r&&topStart.col===c?out.push(topStart):bottomEnd.row===r&&bottomEnd.col===c?out.push(bottomEnd):out.push(this._createCellCoords(r,c));return out}forAll(callback){const topStart=this.getOuterTopStartCorner(),bottomEnd=this.getOuterBottomEndCorner();for(let r=topStart.row;r<=bottomEnd.row;r++)for(let c=topStart.col;c<=bottomEnd.col;c++){if(!1===callback(r,c))return}}clone(){return new CellRange(this.highlight,this.from,this.to,_classPrivateFieldGet(_isRtl,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(row,column){return new _cell_coords_mjs__WEBPACK_IMPORTED_MODULE_2__.A(row,column,_classPrivateFieldGet(_isRtl,this))}}const __WEBPACK_DEFAULT_EXPORT__=CellRange},"./node_modules/handsontable/3rdparty/walkontable/src/selection/constants.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{E6:()=>ACTIVE_HEADER_TYPE,Hb:()=>FILL_TYPE,LX:()=>AREA_TYPE,OS:()=>CUSTOM_SELECTION_TYPE,PP:()=>HEADER_TYPE,QP:()=>COLUMN_TYPE,Yt:()=>FOCUS_TYPE,_8:()=>ROW_TYPE});const ACTIVE_HEADER_TYPE="active-header",HEADER_TYPE="header",AREA_TYPE="area",FOCUS_TYPE="focus",FILL_TYPE="fill",ROW_TYPE="row",COLUMN_TYPE="column",CUSTOM_SELECTION_TYPE="custom-selection"},"./node_modules/handsontable/cellTypes/registry.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Gk:()=>_register,L4:()=>hasItem,r0:()=>_getItem});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js");var _utils_staticRegister_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/utils/staticRegister.mjs"),_editors_registry_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/editors/registry.mjs"),_renderers_registry_mjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/handsontable/renderers/registry.mjs"),_validators_registry_mjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/handsontable/validators/registry.mjs");const{register,getItem,hasItem,getNames,getValues}=(0,_utils_staticRegister_mjs__WEBPACK_IMPORTED_MODULE_1__.A)("cellTypes");function _getItem(name){if(!hasItem(name))throw Error(`You declared cell type "${name}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return getItem(name)}function _register(name,type){"string"!=typeof name&&(name=(type=name).CELL_TYPE);const{editor,renderer,validator}=type;editor&&(0,_editors_registry_mjs__WEBPACK_IMPORTED_MODULE_2__.VA)(name,editor),renderer&&(0,_renderers_registry_mjs__WEBPACK_IMPORTED_MODULE_3__.TS)(name,renderer),validator&&(0,_validators_registry_mjs__WEBPACK_IMPORTED_MODULE_4__.qV)(name,validator),register(name,type)}},"./node_modules/handsontable/cellTypes/textType/textType.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Y:()=>TextCellType});var _editors_textEditor_index_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/editors/textEditor/textEditor.mjs"),_renderers_textRenderer_index_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/renderers/textRenderer/textRenderer.mjs");const TextCellType={CELL_TYPE:"text",editor:_editors_textEditor_index_mjs__WEBPACK_IMPORTED_MODULE_0__.t,renderer:_renderers_textRenderer_index_mjs__WEBPACK_IMPORTED_MODULE_1__.F}},"./node_modules/handsontable/core/hooks/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{R:()=>Hooks});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var array=__webpack_require__("./node_modules/handsontable/helpers/array.mjs"),string=__webpack_require__("./node_modules/handsontable/helpers/string.mjs"),console=__webpack_require__("./node_modules/handsontable/helpers/console.mjs"),templateLiteralTag=__webpack_require__("./node_modules/handsontable/helpers/templateLiteralTag.mjs"),helpers_function=__webpack_require__("./node_modules/handsontable/helpers/function.mjs");const REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([[]]);__webpack_require__("./node_modules/core-js/modules/es.array.to-sorted.js"),__webpack_require__("./node_modules/core-js/modules/es.set.difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.intersection.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-subset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-superset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.symmetric-difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.union.v2.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js");function _classPrivateFieldInitSpec(e,t,a){_checkPrivateRedeclaration(e,t),t.set(e,a)}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet(s,a,r){return s.set(_assertClassBrand(s,a),r),r}function _classPrivateFieldGet(s,a){return s.get(_assertClassBrand(s,a))}function _assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _hooks=new WeakMap,_skippedHooksCount=new WeakMap,_needsSort=new WeakMap,_HooksBucket_brand=new WeakSet;class HooksBucket{constructor(){!function _classPrivateMethodInitSpec(e,a){_checkPrivateRedeclaration(e,a),a.add(e)}(this,_HooksBucket_brand),_classPrivateFieldInitSpec(this,_hooks,new Map),_classPrivateFieldInitSpec(this,_skippedHooksCount,new Map),_classPrivateFieldInitSpec(this,_needsSort,new Set),REGISTERED_HOOKS.forEach((hookName=>_assertClassBrand(_HooksBucket_brand,this,_createHooksCollection).call(this,hookName)))}getHooks(hookName){var _classPrivateFieldGet2;return null!==(_classPrivateFieldGet2=_classPrivateFieldGet(_hooks,this).get(hookName))&&void 0!==_classPrivateFieldGet2?_classPrivateFieldGet2:[]}add(hookName,callback){let options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classPrivateFieldGet(_hooks,this).has(hookName)||(_assertClassBrand(_HooksBucket_brand,this,_createHooksCollection).call(this,hookName),REGISTERED_HOOKS.push(hookName));const hooks=_classPrivateFieldGet(_hooks,this).get(hookName);if(hooks.find((hook=>hook.callback===callback)))return;const orderIndex=Number.isInteger(options.orderIndex)?options.orderIndex:0,runOnce=!!options.runOnce,initialHook=!!options.initialHook;let foundInitialHook=!1;if(initialHook){const initialHookEntry=hooks.find((hook=>hook.initialHook));initialHookEntry&&(initialHookEntry.callback=callback,foundInitialHook=!0)}if(!foundInitialHook){hooks.push({callback,orderIndex,runOnce,initialHook,skip:!1});let needsSort=_classPrivateFieldGet(_needsSort,this).has(hookName);needsSort||0===orderIndex||(needsSort=!0,_classPrivateFieldGet(_needsSort,this).add(hookName)),needsSort&&hooks.length>1&&_classPrivateFieldGet(_hooks,this).set(hookName,hooks.toSorted(((a,b)=>a.orderIndex-b.orderIndex)))}}has(hookName){return _classPrivateFieldGet(_hooks,this).has(hookName)&&_classPrivateFieldGet(_hooks,this).get(hookName).length>0}remove(hookName,callback){if(!_classPrivateFieldGet(_hooks,this).has(hookName))return!1;const hooks=_classPrivateFieldGet(_hooks,this).get(hookName),hookEntry=hooks.find((hook=>hook.callback===callback));if(hookEntry){let skippedHooksCount=_classPrivateFieldGet(_skippedHooksCount,this).get(hookName);return hookEntry.skip=!0,skippedHooksCount+=1,skippedHooksCount>100&&(_classPrivateFieldGet(_hooks,this).set(hookName,hooks.filter((hook=>!hook.skip))),skippedHooksCount=0),_classPrivateFieldGet(_skippedHooksCount,this).set(hookName,skippedHooksCount),!0}return!1}destroy(){_classPrivateFieldGet(_hooks,this).clear(),_classPrivateFieldGet(_skippedHooksCount,this).clear(),_classPrivateFieldSet(_hooks,this,null),_classPrivateFieldSet(_skippedHooksCount,this,null)}}function _createHooksCollection(hookName){_classPrivateFieldGet(_hooks,this).set(hookName,[]),_classPrivateFieldGet(_skippedHooksCount,this).set(hookName,0)}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const REMOVED_MESSAGE=templateLiteralTag.O`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Hooks{constructor(){_defineProperty(this,"globalBucket",new HooksBucket)}static getSingleton(){return function getGlobalSingleton(){return globalSingleton}()}getBucket(){let context=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return context?(context.pluginHookBucket||(context.pluginHookBucket=new HooksBucket),context.pluginHookBucket):this.globalBucket}add(key,callback){let context=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,orderIndex=arguments.length>3?arguments[3]:void 0;return Array.isArray(callback)?(0,array.z0)(callback,(c=>this.add(key,c,context))):(REMOVED_HOOKS.has(key)&&(0,console.R8)((0,string.V2)(REMOVED_MESSAGE,{hookName:key,removedInVersion:REMOVED_HOOKS.get(key)})),DEPRECATED_HOOKS.has(key)&&(0,console.R8)(DEPRECATED_HOOKS.get(key)),this.getBucket(context).add(key,callback,{orderIndex,runOnce:!1})),this}once(key,callback){let context=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,orderIndex=arguments.length>3?arguments[3]:void 0;return Array.isArray(callback)?(0,array.z0)(callback,(c=>this.once(key,c,context))):this.getBucket(context).add(key,callback,{orderIndex,runOnce:!0}),this}addAsFixed(key,callback){let context=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(callback)?(0,array.z0)(callback,(c=>this.addAsFixed(key,c,context))):this.getBucket(context).add(key,callback,{initialHook:!0}),this}remove(key,callback){let context=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(context).remove(key,callback)}has(key){let context=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(context).has(key)}run(context,key,p1,p2,p3,p4,p5,p6){{const globalHandlers=this.getBucket().getHooks(key),length=globalHandlers?globalHandlers.length:0;let index=0;if(length)for(;index<length;){if(!globalHandlers[index]||globalHandlers[index].skip){index+=1;continue}const res=(0,helpers_function.Ty)(globalHandlers[index].callback,context,p1,p2,p3,p4,p5,p6);void 0!==res&&(p1=res),globalHandlers[index]&&globalHandlers[index].runOnce&&this.remove(key,globalHandlers[index].callback),index+=1}}{const localHandlers=this.getBucket(context).getHooks(key),length=localHandlers?localHandlers.length:0;let index=0;if(length)for(;index<length;){if(!localHandlers[index]||localHandlers[index].skip){index+=1;continue}const res=(0,helpers_function.Ty)(localHandlers[index].callback,context,p1,p2,p3,p4,p5,p6);void 0!==res&&(p1=res),localHandlers[index]&&localHandlers[index].runOnce&&this.remove(key,localHandlers[index].callback,context),index+=1}}return p1}destroy(){let context=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(context).destroy()}register(key){this.isRegistered(key)||REGISTERED_HOOKS.push(key)}deregister(key){this.isRegistered(key)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(key),1)}isDeprecated(hookName){return DEPRECATED_HOOKS.has(hookName)||REMOVED_HOOKS.has(hookName)}isRegistered(hookName){return REGISTERED_HOOKS.indexOf(hookName)>=0}getRegistered(){return REGISTERED_HOOKS}}const globalSingleton=new Hooks},"./node_modules/handsontable/editors/baseEditor/baseEditor.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{b7:()=>BaseEditor,_T:()=>EDITOR_STATE});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js");var mixed=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs"),object=__webpack_require__("./node_modules/handsontable/helpers/object.mjs"),array=(__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/handsontable/helpers/array.mjs"));const hooksRefRegisterer={_hooksStorage:Object.create(null),addHook(key,callback){return this._hooksStorage[key]||(this._hooksStorage[key]=[]),this.hot.addHook(key,callback),this._hooksStorage[key].push(callback),this},removeHooksByKey(key){(0,array.z0)(this._hooksStorage[key]||[],(callback=>{this.hot.removeHook(key,callback)}))},clearHooks(){(0,object.v4)(this._hooksStorage,((callbacks,name)=>this.removeHooksByKey(name))),this._hooksStorage={}}};(0,object.LH)(hooksRefRegisterer,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const mixins_hooksRefRegisterer=hooksRefRegisterer;var dom_element=__webpack_require__("./node_modules/handsontable/helpers/dom/element.mjs");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class BaseEditor{static get EDITOR_TYPE(){return"base"}constructor(hotInstance){_defineProperty(this,"hot",void 0),_defineProperty(this,"state",EDITOR_STATE.VIRGIN),_defineProperty(this,"_opened",!1),_defineProperty(this,"_fullEditMode",!1),_defineProperty(this,"_closeCallback",null),_defineProperty(this,"TD",null),_defineProperty(this,"row",null),_defineProperty(this,"col",null),_defineProperty(this,"prop",null),_defineProperty(this,"originalValue",null),_defineProperty(this,"cellProperties",null),this.hot=hotInstance,this.init()}_fireCallbacks(result){this._closeCallback&&(this._closeCallback(result),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(row,col,prop,td,value,cellProperties){this.TD=td,this.row=row,this.col=col,this.prop=prop,this.originalValue=value,this.cellProperties=cellProperties,this.state=this.isOpened()?this.state:EDITOR_STATE.VIRGIN}extend(){return class Editor extends this.constructor{}}saveValue(value,ctrlDown){let visualRowFrom,visualColumnFrom,visualRowTo,visualColumnTo;if(ctrlDown){const selectedLast=this.hot.getSelectedLast();visualRowFrom=Math.max(Math.min(selectedLast[0],selectedLast[2]),0),visualColumnFrom=Math.max(Math.min(selectedLast[1],selectedLast[3]),0),visualRowTo=Math.max(selectedLast[0],selectedLast[2]),visualColumnTo=Math.max(selectedLast[1],selectedLast[3])}else[visualRowFrom,visualColumnFrom,visualRowTo,visualColumnTo]=[this.row,this.col,null,null];const modifiedCellCoords=this.hot.runHooks("modifyGetCellCoords",visualRowFrom,visualColumnFrom,!1,"meta");Array.isArray(modifiedCellCoords)&&([visualRowFrom,visualColumnFrom]=modifiedCellCoords),this.hot.populateFromArray(visualRowFrom,visualColumnFrom,value,visualRowTo,visualColumnTo,"edit")}beginEditing(newInitialValue,event){if(this.state!==EDITOR_STATE.VIRGIN)return;const hotInstance=this.hot,renderableRowIndex=hotInstance.rowIndexMapper.getRenderableFromVisualIndex(this.row),renderableColumnIndex=hotInstance.columnIndexMapper.getRenderableFromVisualIndex(this.col),openEditor=()=>{if(this.state=EDITOR_STATE.EDITING,this.isInFullEditMode()){const stringifiedInitialValue="string"==typeof newInitialValue?newInitialValue:(0,mixed.As)(this.originalValue);this.setValue(stringifiedInitialValue)}this.open(event),this._opened=!0,this.focus(),hotInstance.view.render(),hotInstance.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",openEditor);hotInstance.view.scrollViewport(hotInstance._createCellCoords(renderableRowIndex,renderableColumnIndex))||(this.hot.removeHook("afterScroll",openEditor),openEditor())}finishEditing(restoreOriginalValue,ctrlDown,callback){let val;if(callback){const previousCloseCallback=this._closeCallback;this._closeCallback=result=>{previousCloseCallback&&previousCloseCallback(result),callback(result),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==EDITOR_STATE.VIRGIN){if(this.state===EDITOR_STATE.EDITING){if(restoreOriginalValue)return this.cancelChanges(),void this.hot.view.render();const value=this.getValue();val=this.cellProperties.trimWhitespace?[["string"==typeof value?String.prototype.trim.call(value||""):value]]:[[value]],this.state=EDITOR_STATE.WAITING,this.saveValue(val,ctrlDown),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(result=>{this.state=EDITOR_STATE.FINISHED,this.discardEditor(result)})):(this.state=EDITOR_STATE.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=EDITOR_STATE.FINISHED,this.discardEditor()}discardEditor(result){if(this.state===EDITOR_STATE.FINISHED)if(!1===result&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=EDITOR_STATE.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EDITOR_STATE.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===EDITOR_STATE.WAITING}getEditedCellRect(){var _wtOverlays$getParent;const TD=this.getEditedCell();if(!TD)return;const{wtOverlays,wtViewport}=this.hot.view._wt,rootWindow=this.hot.rootWindow,currentOffset=(0,dom_element.cY)(TD),cellWidth=(0,dom_element.Gq)(TD),containerOffset=(0,dom_element.cY)(this.hot.rootElement),containerWidth=(0,dom_element.Gq)(this.hot.rootElement),scrollableContainerTop=wtOverlays.topOverlay.holder,scrollableContainerLeft=wtOverlays.inlineStartOverlay.holder,containerScrollTop=scrollableContainerTop!==rootWindow?scrollableContainerTop.scrollTop:0,containerScrollLeft=scrollableContainerLeft!==rootWindow?scrollableContainerLeft.scrollLeft:0,gridMostRightPos=rootWindow.innerWidth-containerOffset.left-containerWidth,{wtTable:overlayTable}=null!==(_wtOverlays$getParent=wtOverlays.getParentOverlay(TD))&&void 0!==_wtOverlays$getParent?_wtOverlays$getParent:this.hot.view._wt,overlayName=overlayTable.name,scrollTop=["master","inline_start"].includes(overlayName)?containerScrollTop:0,scrollLeft=["master","top","bottom"].includes(overlayName)?containerScrollLeft:0,editTopModifier=currentOffset.top===containerOffset.top?0:1;let topPos=currentOffset.top-containerOffset.top-editTopModifier-scrollTop,inlineStartPos=0;inlineStartPos=this.hot.isRtl()?rootWindow.innerWidth-currentOffset.left-cellWidth-gridMostRightPos-1+scrollLeft:currentOffset.left-containerOffset.left-1-scrollLeft,["top","top_inline_start_corner"].includes(overlayName)&&(topPos+=wtOverlays.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(overlayName)&&(inlineStartPos+=Math.abs(wtOverlays.inlineStartOverlay.getOverlayOffset()));const hasColumnHeaders=this.hot.hasColHeaders(),renderableRow=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),renderableColumn=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),firstRowIndexOfTheBottomOverlay=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(hasColumnHeaders&&renderableRow<=0||renderableRow===firstRowIndexOfTheBottomOverlay)&&(topPos+=1),renderableColumn<=0&&(inlineStartPos+=1);const firstRowOffset=wtViewport.rowsRenderCalculator.startPosition,firstColumnOffset=wtViewport.columnsRenderCalculator.startPosition,horizontalScrollPosition=Math.abs(wtOverlays.inlineStartOverlay.getScrollPosition()),verticalScrollPosition=wtOverlays.topOverlay.getScrollPosition(),scrollbarWidth=(0,dom_element.XJ)(this.hot.rootDocument);let cellTopOffset=TD.offsetTop;if(["inline_start","master"].includes(overlayName)&&(cellTopOffset+=firstRowOffset-verticalScrollPosition),["bottom","bottom_inline_start_corner"].includes(overlayName)){const{wtViewport:bottomWtViewport,wtTable:bottomWtTable}=wtOverlays.bottomOverlay.clone;cellTopOffset+=bottomWtViewport.getWorkspaceHeight()-bottomWtTable.getHeight()-scrollbarWidth}let cellStartOffset=TD.offsetLeft;this.hot.isRtl()?(cellStartOffset=cellStartOffset>=0?overlayTable.getWidth()-TD.offsetLeft:Math.abs(cellStartOffset),cellStartOffset+=firstColumnOffset-horizontalScrollPosition-cellWidth):["top","master","bottom"].includes(overlayName)&&(cellStartOffset+=firstColumnOffset-horizontalScrollPosition);const cellComputedStyle=rootWindow.getComputedStyle(this.TD),borderPhysicalWidthProp=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",inlineStartBorderCompensation=parseInt(cellComputedStyle[borderPhysicalWidthProp],10)>0?0:1,topBorderCompensation=parseInt(cellComputedStyle.borderTopWidth,10)>0?0:1,width=(0,dom_element.Gq)(TD)+inlineStartBorderCompensation,height=(0,dom_element.DK)(TD)+topBorderCompensation,actualVerticalScrollbarWidth=(0,dom_element.D1)(scrollableContainerTop)?scrollbarWidth:0,actualHorizontalScrollbarWidth=(0,dom_element.zO)(scrollableContainerLeft)?scrollbarWidth:0,maxWidth=this.hot.view.maximumVisibleElementWidth(cellStartOffset)-actualVerticalScrollbarWidth+inlineStartBorderCompensation;return{top:topPos,start:inlineStartPos,height,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(cellTopOffset)-actualHorizontalScrollbarWidth+topBorderCompensation,this.hot.view.getDefaultRowHeight()),width,maxWidth}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const totalRows=this.hot.countRows();let section="";return this.row<this.hot.getSettings().fixedRowsTop?section=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=totalRows-this.hot.getSettings().fixedRowsBottom?section=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(section="inline-start"),section}}(0,object.co)(BaseEditor,mixins_hooksRefRegisterer)},"./node_modules/handsontable/editors/registry.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{L3:()=>_getEditorInstance,M8:()=>_getItem,VA:()=>_register,aZ:()=>hasItem});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js");var _core_hooks_index_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/core/hooks/index.mjs"),_utils_staticRegister_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/utils/staticRegister.mjs");const registeredEditorClasses=new WeakMap,{register,getItem,hasItem,getNames,getValues}=(0,_utils_staticRegister_mjs__WEBPACK_IMPORTED_MODULE_1__.A)("editors");function RegisteredEditor(editorClass){const instances={},Clazz=editorClass;this.getConstructor=function(){return editorClass},this.getInstance=function(hotInstance){return hotInstance.guid in instances||(instances[hotInstance.guid]=new Clazz(hotInstance)),instances[hotInstance.guid]},_core_hooks_index_mjs__WEBPACK_IMPORTED_MODULE_2__.R.getSingleton().add("afterDestroy",(function(){instances[this.guid]=null}))}function _getEditorInstance(name,hotInstance){let editor;if("function"==typeof name)registeredEditorClasses.get(name)||_register(null,name),editor=registeredEditorClasses.get(name);else{if("string"!=typeof name)throw Error('Only strings and functions can be passed as "editor" parameter');editor=getItem(name)}if(!editor)throw Error(`No editor registered under name "${name}"`);return editor.getInstance(hotInstance)}function _getItem(name){if("function"==typeof name)return name;if(!hasItem(name))throw Error(`No registered editor found under "${name}" name`);return getItem(name).getConstructor()}function _register(name,editorClass){name&&"string"!=typeof name&&(name=(editorClass=name).EDITOR_TYPE);const editorWrapper=new RegisteredEditor(editorClass);"string"==typeof name&&register(name,editorWrapper),registeredEditorClasses.set(editorClass,editorWrapper)}},"./node_modules/handsontable/editors/textEditor/textEditor.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{t:()=>TextEditor});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js");var baseEditor=__webpack_require__("./node_modules/handsontable/editors/baseEditor/baseEditor.mjs"),eventManager=__webpack_require__("./node_modules/handsontable/eventManager.mjs"),browser=__webpack_require__("./node_modules/handsontable/helpers/browser.mjs"),dom_element=__webpack_require__("./node_modules/handsontable/helpers/dom/element.mjs"),number=__webpack_require__("./node_modules/handsontable/helpers/number.mjs"),autoResize=__webpack_require__("./node_modules/handsontable/utils/autoResize.mjs"),mixed=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs");function updateCaretPosition(actionName,textareaElement){const caretPosition=(0,dom_element.JC)(textareaElement),textLines=textareaElement.value.split("\n");let newCaretPosition=caretPosition,lineStartIndex=0;for(let i=0;i<textLines.length;i++){const textLine=textLines[i];0!==i&&(lineStartIndex+=textLines[i-1].length+1);const lineEndIndex=lineStartIndex+textLine.length;if("home"===actionName?newCaretPosition=lineStartIndex:"end"===actionName&&(newCaretPosition=lineEndIndex),caretPosition<=lineEndIndex)break}(0,dom_element.vZ)(textareaElement,newCaretPosition)}var a11y=__webpack_require__("./node_modules/handsontable/helpers/a11y.mjs");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class TextEditor extends baseEditor.b7{static get EDITOR_TYPE(){return"text"}constructor(hotInstance){super(hotInstance),_defineProperty(this,"eventManager",new eventManager.A(this)),_defineProperty(this,"autoResize",(0,autoResize.j)(this.hot.rootDocument)),_defineProperty(this,"TEXTAREA",void 0),_defineProperty(this,"textareaStyle",void 0),_defineProperty(this,"TEXTAREA_PARENT",void 0),_defineProperty(this,"textareaParentStyle",void 0),_defineProperty(this,"layerClass",void 0),this.eventManager=new eventManager.A(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(newValue){this.TEXTAREA.value=newValue}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,dom_element.yq)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(row,col,prop,td,value,cellProperties){const previousState=this.state;if(super.prepare(row,col,prop,td,value,cellProperties),!cellProperties.readOnly){this.refreshDimensions(!0);const{allowInvalid}=cellProperties;allowInvalid&&!this.isOpened()&&(this.TEXTAREA.value=""),previousState===baseEditor._T.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(newInitialValue,event){this.state===baseEditor._T.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(newInitialValue,event))}focus(){this.TEXTAREA.select(),(0,dom_element.vZ)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument}=this.hot;this.TEXTAREA=rootDocument.createElement("TEXTAREA"),(0,dom_element.Bq)(this.TEXTAREA,[["data-hot-input",""],(0,a11y.vC)(-1)]),(0,dom_element.iQ)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=rootDocument.createElement("DIV"),(0,dom_element.iQ)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,dom_element.nB)(this.TEXTAREA_PARENT,this.layerClass)&&(0,dom_element.vy)(this.TEXTAREA_PARENT,this.layerClass),(0,dom_element.iQ)(this.TEXTAREA_PARENT,"ht_editor_hidden"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,browser.UP)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,dom_element.vy)(this.TEXTAREA_PARENT,this.layerClass),(0,dom_element.iQ)(this.TEXTAREA_PARENT,"ht_editor_hidden")}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const childNodes=this.TEXTAREA_PARENT.childNodes;let hasClassHandsontableEditor=!1;(0,number.Ti)(childNodes.length-1,(index=>{const childNode=childNodes[index];if((0,dom_element.nB)(childNode,"handsontableEditor"))return hasClassHandsontableEditor=!0,!1})),(0,dom_element.nB)(this.TEXTAREA_PARENT,"ht_editor_hidden")&&(0,dom_element.vy)(this.TEXTAREA_PARENT,"ht_editor_hidden"),hasClassHandsontableEditor?(this.layerClass="ht_editor_visible",(0,dom_element.iQ)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),(0,dom_element.iQ)(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const physicalRow=this.hot.toPhysicalRow(this.row),sourceData=this.hot.getSourceDataAtCell(physicalRow,this.col);this.originalValue=sourceData,this.setValue(sourceData),this.refreshDimensions()}refreshDimensions(){let force=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==baseEditor._T.EDITING&&!force)return;if(this.TD=this.getEditedCell(),!this.TD)return void(force||this.close());const{top,start,width,maxWidth,height,maxHeight}=this.getEditedCellRect();this.textareaParentStyle.top=`${top}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${start}px`,this.showEditableElement();const cellComputedStyle=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=cellComputedStyle.fontSize,this.TEXTAREA.style.fontFamily=cellComputedStyle.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(width,maxWidth),minHeight:Math.min(height,maxHeight),maxWidth,maxHeight},!0)}bindEvents(){(0,browser.un)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===baseEditor._T.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===baseEditor._T.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const editorContext=this.hot.getShortcutManager().getContext("editor"),contextConfig={runOnlyIf:()=>(0,mixed.O9)(this.hot.getSelected()),group:"textEditor"},insertNewLine=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};editorContext.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(insertNewLine(),!1),runOnlyIf:event=>!this.hot.selection.isMultiple()&&!event.altKey},{keys:[["Meta","Enter"]],callback:()=>(insertNewLine(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(insertNewLine(),!1)},{keys:[["Home"]],callback:(event,_ref)=>{let[keyName]=_ref;updateCaretPosition(keyName,this.TEXTAREA)}},{keys:[["End"]],callback:(event,_ref2)=>{let[keyName]=_ref2;updateCaretPosition(keyName,this.TEXTAREA)}}],contextConfig)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup("textEditor")}}},"./node_modules/handsontable/eventManager.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _helpers_dom_event_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/dom/event.mjs");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}let listenersCounter=0;const __WEBPACK_DEFAULT_EXPORT__=class EventManager{constructor(){let context=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_defineProperty(this,"context",void 0),this.context=context||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(element,eventName,callback){let options=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function callbackProxy(event){callback.call(this,function extendEvent(event){const nativeStopImmediatePropagation=event.stopImmediatePropagation;return event.stopImmediatePropagation=function(){nativeStopImmediatePropagation.apply(this),(0,_helpers_dom_event_mjs__WEBPACK_IMPORTED_MODULE_2__.CA)(this)},event}(event))}return this.context.eventListeners.push({element,event:eventName,callback,callbackProxy,options,eventManager:this}),element.addEventListener(eventName,callbackProxy,options),listenersCounter+=1,()=>{this.removeEventListener(element,eventName,callback)}}removeEventListener(element,eventName,callback){let tmpEvent,onlyOwnEvents=arguments.length>3&&void 0!==arguments[3]&&arguments[3],len=this.context.eventListeners.length;for(;len;)if(len-=1,tmpEvent=this.context.eventListeners[len],tmpEvent.event===eventName&&tmpEvent.element===element){if(callback&&callback!==tmpEvent.callback)continue;if(onlyOwnEvents&&tmpEvent.eventManager!==this)continue;this.context.eventListeners.splice(len,1),tmpEvent.element.removeEventListener(tmpEvent.event,tmpEvent.callbackProxy,tmpEvent.options),listenersCounter-=1}}clearEvents(){let onlyOwnEvents=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let len=this.context.eventListeners.length;for(;len;){len-=1;const event=this.context.eventListeners[len];onlyOwnEvents&&event.eventManager!==this||(this.context.eventListeners.splice(len,1),event.element.removeEventListener(event.event,event.callbackProxy,event.options),listenersCounter-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(element,eventName){let rootDocument=element.document,rootWindow=element;rootDocument||(rootDocument=element.ownerDocument?element.ownerDocument:element,rootWindow=rootDocument.defaultView);const options={bubbles:!0,cancelable:"mousemove"!==eventName,view:rootWindow,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let event;rootDocument.createEvent?(event=rootDocument.createEvent("MouseEvents"),event.initMouseEvent(eventName,options.bubbles,options.cancelable,options.view,options.detail,options.screenX,options.screenY,options.clientX,options.clientY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,options.relatedTarget||rootDocument.body.parentNode)):event=rootDocument.createEventObject(),element.dispatchEvent?element.dispatchEvent(event):element.fireEvent(`on${eventName}`,event)}}},"./node_modules/handsontable/helpers/a11y.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$o:()=>A11Y_LISTBOX,B6:()=>A11Y_COMBOBOX,D9:()=>A11Y_SCOPE_ROW,DY:()=>A11Y_SETSIZE,DZ:()=>A11Y_ROWCOUNT,H0:()=>A11Y_SELECTED,Jg:()=>A11Y_COLUMNHEADER,Ku:()=>A11Y_CONTROLS,L2:()=>A11Y_SCOPE_COL,L4:()=>A11Y_MULTISELECTABLE,MG:()=>A11Y_HIDDEN,Nb:()=>A11Y_COLCOUNT,Nf:()=>A11Y_ROWHEADER,PF:()=>A11Y_INVALID,Pk:()=>A11Y_CHECKBOX,Qg:()=>A11Y_ROWINDEX,S2:()=>A11Y_LIVE,SM:()=>A11Y_LABEL,Sb:()=>A11Y_ROW,VN:()=>A11Y_ACTIVEDESCENDANT,Vy:()=>A11Y_POSINSET,Xq:()=>A11Y_CHECKED,ZA:()=>A11Y_MENU_ITEM,ZW:()=>A11Y_TEXT,_R:()=>A11Y_DISABLED,_h:()=>A11Y_SORT,ax:()=>A11Y_TREEGRID,dV:()=>A11Y_EXPANDED,g:()=>A11Y_GRIDCELL,gg:()=>A11Y_PRESENTATION,gq:()=>A11Y_AUTOCOMPLETE,n:()=>A11Y_OPTION,nF:()=>A11Y_MENU,pt:()=>A11Y_MENU_ITEM_CHECKBOX,rE:()=>A11Y_RELEVANT,t0:()=>A11Y_ROWGROUP,u8:()=>A11Y_READONLY,vC:()=>A11Y_TABINDEX,wD:()=>A11Y_COLINDEX,wP:()=>A11Y_HASPOPUP});const A11Y_TABINDEX=val=>["tabindex",val],A11Y_TREEGRID=()=>["role","treegrid"],A11Y_PRESENTATION=()=>["role","presentation"],A11Y_GRIDCELL=()=>["role","gridcell"],A11Y_ROWHEADER=()=>["role","rowheader"],A11Y_ROWGROUP=()=>["role","rowgroup"],A11Y_COLUMNHEADER=()=>["role","columnheader"],A11Y_ROW=()=>["role","row"],A11Y_MENU=()=>["role","menu"],A11Y_MENU_ITEM=()=>["role","menuitem"],A11Y_MENU_ITEM_CHECKBOX=()=>["role","menuitemcheckbox"],A11Y_COMBOBOX=()=>["role","combobox"],A11Y_LISTBOX=()=>["role","listbox"],A11Y_OPTION=()=>["role","option"],A11Y_CHECKBOX=()=>["role","checkbox"],A11Y_SCOPE_COL=()=>["scope","col"],A11Y_SCOPE_ROW=()=>["scope","row"],A11Y_TEXT=()=>["type","text"],A11Y_LABEL=val=>["aria-label",val],A11Y_HIDDEN=()=>["aria-hidden","true"],A11Y_DISABLED=()=>["aria-disabled","true"],A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],A11Y_HASPOPUP=val=>["aria-haspopup",val],A11Y_ROWCOUNT=val=>["aria-rowcount",val],A11Y_COLCOUNT=val=>["aria-colcount",val],A11Y_ROWINDEX=val=>["aria-rowindex",val],A11Y_COLINDEX=val=>["aria-colindex",val],A11Y_EXPANDED=val=>["aria-expanded",val],A11Y_SORT=val=>["aria-sort",val],A11Y_READONLY=()=>["aria-readonly","true"],A11Y_INVALID=()=>["aria-invalid","true"],A11Y_CHECKED=val=>["aria-checked",val],A11Y_SELECTED=()=>["aria-selected","true"],A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],A11Y_CONTROLS=val=>["aria-controls",val],A11Y_ACTIVEDESCENDANT=val=>["aria-activedescendant",val],A11Y_LIVE=val=>["aria-live",val],A11Y_RELEVANT=val=>["aria-relevant",val],A11Y_SETSIZE=val=>["aria-setsize",val],A11Y_POSINSET=val=>["aria-posinset",val]},"./node_modules/handsontable/helpers/array.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Gn:()=>stringToArray,Sh:()=>extendArray,YD:()=>arrayMap,Zz:()=>to2dArray,fg:()=>getDifferenceOfArrays,h9:()=>pivot,jF:()=>arrayUnique,mu:()=>arrayReduce,y0:()=>arrayFilter,z0:()=>arrayEach});__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/es.set.difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.intersection.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-subset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-superset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.symmetric-difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.union.v2.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js");function to2dArray(arr){const ilen=arr.length;let i=0;for(;i<ilen;)arr[i]=[arr[i]],i+=1}function extendArray(arr,extension){const ilen=extension.length;let i=0;for(;i<ilen;)arr.push(extension[i]),i+=1}function pivot(arr){const pivotedArr=[];if(!arr||0===arr.length||!arr[0]||0===arr[0].length)return pivotedArr;const rowCount=arr.length,colCount=arr[0].length;for(let i=0;i<rowCount;i++)for(let j=0;j<colCount;j++)pivotedArr[j]||(pivotedArr[j]=[]),pivotedArr[j][i]=arr[i][j];return pivotedArr}function arrayReduce(array,iteratee,accumulator,initFromArray){let index=-1,iterable=array,result=accumulator;Array.isArray(array)||(iterable=Array.from(array));const length=iterable.length;for(initFromArray&&length&&(index+=1,result=iterable[index]),index+=1;index<length;)result=iteratee(result,iterable[index],index,iterable),index+=1;return result}function arrayFilter(array,predicate){let index=0,iterable=array;Array.isArray(array)||(iterable=Array.from(array));const length=iterable.length,result=[];let resIndex=-1;for(;index<length;){const value=iterable[index];predicate(value,index,iterable)&&(resIndex+=1,result[resIndex]=value),index+=1}return result}function arrayMap(array,iteratee){let index=0,iterable=array;Array.isArray(array)||(iterable=Array.from(array));const length=iterable.length,result=[];let resIndex=-1;for(;index<length;){const value=iterable[index];resIndex+=1,result[resIndex]=iteratee(value,index,iterable),index+=1}return result}function arrayEach(array,iteratee){let index=0,iterable=array;Array.isArray(array)||(iterable=Array.from(array));const length=iterable.length;for(;index<length&&!1!==iteratee(iterable[index],index,iterable);)index+=1;return array}function arrayUnique(array){const unique=[];return arrayEach(array,(value=>{-1===unique.indexOf(value)&&unique.push(value)})),unique}function getDifferenceOfArrays(){for(var _len=arguments.length,arrays=new Array(_len),_key=0;_key<_len;_key++)arrays[_key]=arguments[_key];const[first,...rest]=[...arrays];let filteredFirstArray=first;return arrayEach(rest,(array=>{filteredFirstArray=filteredFirstArray.filter((value=>!array.includes(value)))})),filteredFirstArray}function stringToArray(value){let delimiter=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return value.split(delimiter)}},"./node_modules/handsontable/helpers/browser.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{B6:()=>isChromeWebKit,H8:()=>isChrome,U0:()=>isMacOS,UP:()=>isEdge,Yh:()=>isWindowsOS,gm:()=>isFirefox,nr:()=>isSafari,rr:()=>isMobileBrowser,un:()=>isIOS,wF:()=>isFirefoxWebKit,zG:()=>isIpadOS});var _object_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/helpers/object.mjs"),_feature_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/helpers/feature.mjs");const tester=testerFunc=>{const result={value:!1,test:(ua,vendor)=>{result.value=testerFunc(ua,vendor)}};return result},browsers={chrome:tester(((ua,vendor)=>/Chrome/.test(ua)&&/Google/.test(vendor))),chromeWebKit:tester((ua=>/CriOS/.test(ua))),edge:tester((ua=>/Edge/.test(ua))),edgeWebKit:tester((ua=>/EdgiOS/.test(ua))),firefox:tester((ua=>/Firefox/.test(ua))),firefoxWebKit:tester((ua=>/FxiOS/.test(ua))),mobile:tester((ua=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua))),safari:tester(((ua,vendor)=>/Safari/.test(ua)&&/Apple Computer/.test(vendor)))},platforms={mac:tester((platform=>/^Mac/.test(platform))),win:tester((platform=>/^Win/.test(platform))),linux:tester((platform=>/^Linux/.test(platform))),ios:tester((ua=>/iPhone|iPad|iPod/i.test(ua)))};function isChrome(){return browsers.chrome.value}function isChromeWebKit(){return browsers.chromeWebKit.value}function isFirefox(){return browsers.firefox.value}function isFirefoxWebKit(){return browsers.firefoxWebKit.value}function isSafari(){return browsers.safari.value}function isEdge(){return browsers.edge.value}function isMobileBrowser(){return browsers.mobile.value}function isIOS(){return platforms.ios.value}function isIpadOS(){let{maxTouchPoints}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return maxTouchPoints>2&&platforms.mac.value}function isWindowsOS(){return platforms.win.value}function isMacOS(){return platforms.mac.value}(0,_feature_mjs__WEBPACK_IMPORTED_MODULE_1__.Nt)()&&(!function setBrowserMeta(){let{userAgent=navigator.userAgent,vendor=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,_object_mjs__WEBPACK_IMPORTED_MODULE_0__.v4)(browsers,(_ref=>{let{test}=_ref;test(userAgent,vendor)}))}(),function setPlatformMeta(){let{platform=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,_object_mjs__WEBPACK_IMPORTED_MODULE_0__.v4)(platforms,(_ref2=>{let{test}=_ref2;test(platform)}))}())},"./node_modules/handsontable/helpers/console.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{R8:()=>warn,z3:()=>error});var _mixed_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs");function warn(){(0,_mixed_mjs__WEBPACK_IMPORTED_MODULE_0__.O9)(console)&&console.warn(...arguments)}function error(){(0,_mixed_mjs__WEBPACK_IMPORTED_MODULE_0__.O9)(console)&&console.error(...arguments)}},"./node_modules/handsontable/helpers/data.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$I:()=>spreadsheetColumnLabel,DJ:()=>isArrayOfObjects,E:()=>countFirstRowKeys,Wm:()=>dataRowToChangesArray,ZI:()=>isArrayOfArrays});__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.every.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js");var _object_mjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/handsontable/helpers/object.mjs");const COLUMN_LABEL_BASE_LENGTH=26;function spreadsheetColumnLabel(index){let modulo,dividend=index+1,columnLabel="";for(;dividend>0;)modulo=(dividend-1)%COLUMN_LABEL_BASE_LENGTH,columnLabel=String.fromCharCode(65+modulo)+columnLabel,dividend=parseInt((dividend-modulo)/COLUMN_LABEL_BASE_LENGTH,10);return columnLabel}function dataRowToChangesArray(dataRow){let rowOffset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,dataRows=dataRow;const changesArray=[];return Array.isArray(dataRow)&&Array.isArray(dataRow[0])||(dataRows=[dataRow]),dataRows.forEach(((row,rowIndex)=>{Array.isArray(row)?row.forEach(((value,column)=>{changesArray.push([rowIndex+rowOffset,column,value])})):Object.keys(row).forEach((propName=>{changesArray.push([rowIndex+rowOffset,propName,row[propName]])}))})),changesArray}function countFirstRowKeys(data){let result=0;return Array.isArray(data)&&(data[0]&&Array.isArray(data[0])?result=data[0].length:data[0]&&(0,_object_mjs__WEBPACK_IMPORTED_MODULE_4__.Gv)(data[0])&&(result=(0,_object_mjs__WEBPACK_IMPORTED_MODULE_4__.$3)(data[0]))),result}function isArrayOfArrays(data){return!!(Array.isArray(data)&&data.length&&data.every((el=>Array.isArray(el))))}function isArrayOfObjects(data){return!!(Array.isArray(data)&&data.length&&data.every((el=>"object"==typeof el&&!Array.isArray(el)&&null!==el)))}},"./node_modules/handsontable/helpers/dom/element.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$w:()=>isDetached,Bq:()=>setAttribute,C0:()=>runWithSelectedContendEditableElement,D1:()=>hasVerticalScrollbar,DK:()=>outerHeight,De:()=>removeAttribute,E3:()=>isOutsideInput,Gq:()=>outerWidth,I6:()=>observeVisibilityChangeOnce,Ie:()=>empty,JC:()=>getCaretPosition,K7:()=>getScrollableElement,LL:()=>clearTextSelection,Ly:()=>getParentWindow,Mv:()=>fastInnerHTML,ON:()=>setOverlayPosition,Oe:()=>findFirstParentWithClass,PA:()=>getParent,Pe:()=>index,Vp:()=>getWindowScrollLeft,XJ:()=>getScrollbarWidth,Xu:()=>getSelectionEndPosition,Xy:()=>isInput,ZK:()=>resetCssTransform,aM:()=>makeElementContentEditableAndSelectItsContent,aO:()=>isChildOf,c6:()=>fastInnerText,cY:()=>offset,cr:()=>closestDown,eU:()=>innerHeight,fX:()=>getTrimmingContainer,gd:()=>getStyle,gj:()=>removeContentEditableFromElementAndDeselect,h$:()=>getMaximumScrollLeft,hY:()=>getScrollTop,iQ:()=>addClass,kp:()=>closest,nB:()=>hasClass,p6:()=>getMaximumScrollTop,sb:()=>isHTMLElement,v1:()=>getWindowScrollTop,vZ:()=>setCaretPosition,v_:()=>getScrollLeft,vg:()=>removeTextNodes,vy:()=>removeClass,xM:()=>innerWidth,yn:()=>overlayContainsElement,yq:()=>isInternalElement,zN:()=>isVisible,zO:()=>hasHorizontalScrollbar});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js");var _string_mjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/handsontable/helpers/string.mjs"),_a11y_mjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/handsontable/helpers/a11y.mjs");function getParent(element){let level=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,iteration=-1,parent=null,elementToCheck=element;for(;null!==elementToCheck;){if(iteration===level){parent=elementToCheck;break}elementToCheck.host&&elementToCheck.nodeType===Node.DOCUMENT_FRAGMENT_NODE?elementToCheck=elementToCheck.host:(iteration+=1,elementToCheck=elementToCheck.parentNode)}return parent}function isInternalElement(element,thisHotContainer){const closestHandsontableContainer=element.closest(".handsontable");return!!closestHandsontableContainer&&(closestHandsontableContainer.parentNode===thisHotContainer||closestHandsontableContainer===thisHotContainer)}function getParentWindow(frame){return function getFrameElement(frame){return Object.getPrototypeOf(frame.parent)&&frame.frameElement}(frame)&&frame.parent}function closest(element){let nodes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],until=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE,DOCUMENT_FRAGMENT_NODE}=Node;let elementToCheck=element;for(;null!=elementToCheck&&elementToCheck!==until;){const{nodeType,nodeName}=elementToCheck;if(nodeType===ELEMENT_NODE&&(nodes.includes(nodeName)||nodes.includes(elementToCheck)))return elementToCheck;const{host}=elementToCheck;elementToCheck=host&&nodeType===DOCUMENT_FRAGMENT_NODE?host:elementToCheck.parentNode}return null}function closestDown(element,nodes,until){const matched=[];let elementToCheck=element;for(;elementToCheck&&(elementToCheck=closest(elementToCheck,nodes,until),elementToCheck&&(!until||until.contains(elementToCheck)));)matched.push(elementToCheck),elementToCheck=elementToCheck.host&&elementToCheck.nodeType===Node.DOCUMENT_FRAGMENT_NODE?elementToCheck.host:elementToCheck.parentNode;const length=matched.length;return length?matched[length-1]:null}function findFirstParentWithClass(element,className){const matched={element:void 0,classNames:[]};let elementToCheck=element;for(;null!==elementToCheck&&elementToCheck!==element.ownerDocument.documentElement&&!matched.element;){if("string"==typeof className&&elementToCheck.classList.contains(className))matched.element=elementToCheck,matched.classNames.push(className);else if(className instanceof RegExp){const matchingClasses=Array.from(elementToCheck.classList).filter((cls=>className.test(cls)));matchingClasses.length&&(matched.element=elementToCheck,matched.classNames.push(...matchingClasses))}elementToCheck=elementToCheck.parentElement}return matched}function isChildOf(child,parent){let node=child.parentNode,queriedParents=[];for("string"==typeof parent?queriedParents=child.defaultView?Array.prototype.slice.call(child.querySelectorAll(parent),0):Array.prototype.slice.call(child.ownerDocument.querySelectorAll(parent),0):queriedParents.push(parent);null!==node;){if(queriedParents.indexOf(node)>-1)return!0;node=node.parentNode}return!1}function index(element){let i=0,elementToCheck=element;if(elementToCheck.previousSibling)for(;elementToCheck=elementToCheck.previousSibling;)i+=1;return i}function overlayContainsElement(overlayType,element,root){const overlayElement=root.parentElement.querySelector(`.ht_clone_${overlayType}`);return overlayElement?overlayElement.contains(element):null}function filterEmptyClassNames(classNames){return classNames&&classNames.length?classNames.filter((x=>!!x)):[]}function filterRegexes(list,returnBoth){if(!list||!list.length)return returnBoth?{regexFree:[],regexes:[]}:[];const regexes=[],regexFree=[];return regexFree.push(...list.filter((entry=>{const isRegex=entry instanceof RegExp;return isRegex&&returnBoth&&regexes.push(entry),!isRegex}))),returnBoth?{regexFree,regexes}:regexFree}function hasClass(element,className){return void 0!==element.classList&&"string"==typeof className&&""!==className&&element.classList.contains(className)}function addClass(element,className){"string"==typeof className&&(className=className.split(" ")),(className=filterEmptyClassNames(className)).length>0&&element.classList.add(...className)}function removeClass(element,className){"string"==typeof className?className=className.split(" "):className instanceof RegExp&&(className=[className]);let{regexFree:stringClasses,regexes:regexClasses}=filterRegexes(className,!0);stringClasses=filterEmptyClassNames(stringClasses),stringClasses.length>0&&element.classList.remove(...stringClasses),regexClasses.forEach((regexClassName=>{element.classList.forEach((currentClassName=>{regexClassName.test(currentClassName)&&element.classList.remove(currentClassName)}))}))}function setAttribute(domElement){let attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],attributeValue=arguments.length>2?arguments[2]:void 0;Array.isArray(attributes)||(attributes=[[attributes,attributeValue]]),attributes.forEach((attributeInfo=>{Array.isArray(attributeInfo)&&""!==attributeInfo[0]&&domElement.setAttribute(...attributeInfo)}))}function removeAttribute(domElement){let attributesToRemove=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof attributesToRemove?attributesToRemove=attributesToRemove.split(" "):attributesToRemove instanceof RegExp&&(attributesToRemove=[attributesToRemove]);const{regexFree:stringAttributes,regexes:regexAttributes}=filterRegexes(attributesToRemove,!0);stringAttributes.forEach((attributeNameToRemove=>{""!==attributeNameToRemove&&domElement.removeAttribute(attributeNameToRemove)})),regexAttributes.forEach((attributeRegex=>{domElement.getAttributeNames().forEach((attributeName=>{attributeRegex.test(attributeName)&&domElement.removeAttribute(attributeName)}))}))}function removeTextNodes(element){if(3===element.nodeType)element.parentNode.removeChild(element);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(element.nodeName)>-1){const childs=element.childNodes;for(let i=childs.length-1;i>=0;i--)removeTextNodes(childs[i])}}function empty(element){let child;for(;child=element.lastChild;)element.removeChild(child)}const HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(element,content){let sanitizeContent=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];HTML_CHARACTERS.test(content)?element.innerHTML=sanitizeContent?(0,_string_mjs__WEBPACK_IMPORTED_MODULE_5__.aj)(content):content:fastInnerText(element,content)}function fastInnerText(element,content){const child=element.firstChild;child&&3===child.nodeType&&null===child.nextSibling?child.textContent=content:(empty(element),element.appendChild(element.ownerDocument.createTextNode(content)))}function isVisible(element){const documentElement=element.ownerDocument.documentElement,windowElement=element.ownerDocument.defaultView;let next=element;for(;next!==documentElement;){if(null===next)return!1;if(next.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(next.host){if(next.host.impl)return isVisible(next.host.impl);if(next.host)return isVisible(next.host);throw new Error("Lost in Web Components world")}return!1}if("none"===windowElement.getComputedStyle(next).display)return!1;next=next.parentNode}return!0}function offset(element){const rootDocument=element.ownerDocument,rootWindow=rootDocument.defaultView,documentElement=rootDocument.documentElement;let offsetLeft,offsetTop,lastElem,elementToCheck=element;for(offsetLeft=elementToCheck.offsetLeft,offsetTop=elementToCheck.offsetTop,lastElem=elementToCheck;(elementToCheck=elementToCheck.offsetParent)&&elementToCheck!==rootDocument.body&&"offsetLeft"in elementToCheck;)offsetLeft+=elementToCheck.offsetLeft,offsetTop+=elementToCheck.offsetTop,lastElem=elementToCheck;return lastElem&&"fixed"===lastElem.style.position&&(offsetLeft+=rootWindow.pageXOffset||documentElement.scrollLeft,offsetTop+=rootWindow.pageYOffset||documentElement.scrollTop),{left:offsetLeft,top:offsetTop}}function getWindowScrollTop(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function getWindowScrollLeft(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function getScrollTop(element){let rootWindow=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===rootWindow?getWindowScrollTop(rootWindow):element.scrollTop}function getScrollLeft(element){let rootWindow=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===rootWindow?getWindowScrollLeft(rootWindow):element.scrollLeft}function getScrollableElement(element){let rootDocument=element.ownerDocument,rootWindow=rootDocument?rootDocument.defaultView:void 0;rootDocument||(rootDocument=element.document?element.document:element,rootWindow=rootDocument.defaultView);const props=["auto","scroll"];let el=element.parentNode;for(;el&&el.style&&rootDocument.body!==el;){let{overflow,overflowX,overflowY}=el.style;if([overflow,overflowX,overflowY].includes("scroll"))return el;if(({overflow,overflowX,overflowY}=rootWindow.getComputedStyle(el)),props.includes(overflow)||props.includes(overflowX)||props.includes(overflowY))return el;if(el.clientHeight<=el.scrollHeight+1&&(props.includes(overflowY)||props.includes(overflow)))return el;if(el.clientWidth<=el.scrollWidth+1&&(props.includes(overflowX)||props.includes(overflow)))return el;el=el.parentNode}return rootWindow}function getMaximumScrollTop(element){return element.scrollHeight-element.clientHeight}function getMaximumScrollLeft(element){return element.scrollWidth-element.clientWidth}function getTrimmingContainer(base){const rootDocument=base.ownerDocument,rootWindow=rootDocument.defaultView;let el=base.parentNode;for(;el&&el.style&&rootDocument.body!==el;){if("visible"!==el.style.overflow&&""!==el.style.overflow)return el;const computedStyle=rootWindow.getComputedStyle(el),allowedProperties=["scroll","hidden","auto"],property=computedStyle.getPropertyValue("overflow"),propertyY=computedStyle.getPropertyValue("overflow-y"),propertyX=computedStyle.getPropertyValue("overflow-x");if(allowedProperties.includes(property)||allowedProperties.includes(propertyY)||allowedProperties.includes(propertyX))return el;el=el.parentNode}return rootWindow}function getStyle(element,prop){let rootWindow=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!element)return;if(element===rootWindow)return"width"===prop?`${rootWindow.innerWidth}px`:"height"===prop?`${rootWindow.innerHeight}px`:void 0;const styleProp=element.style[prop];if(""!==styleProp&&void 0!==styleProp)return styleProp;const computedStyle=rootWindow.getComputedStyle(element);return""!==computedStyle[prop]&&void 0!==computedStyle[prop]?computedStyle[prop]:void 0}function outerWidth(element){return element.offsetWidth}function outerHeight(element){return element.offsetHeight}function innerHeight(element){return element.clientHeight||element.innerHeight}function innerWidth(element){return element.clientWidth||element.innerWidth}function getCaretPosition(el){return el.selectionStart?el.selectionStart:0}function getSelectionEndPosition(el){return el.selectionEnd?el.selectionEnd:0}function clearTextSelection(){let rootWindow=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;rootWindow.getSelection&&(rootWindow.getSelection().empty?rootWindow.getSelection().empty():rootWindow.getSelection().removeAllRanges&&rootWindow.getSelection().removeAllRanges())}function setCaretPosition(element,pos,endPos){if(void 0===endPos&&(endPos=pos),element.setSelectionRange){element.focus();try{element.setSelectionRange(pos,endPos)}catch(err){const elementParent=element.parentNode,parentDisplayValue=elementParent.style.display;elementParent.style.display="block",element.setSelectionRange(pos,endPos),elementParent.style.display=parentDisplayValue}}}let cachedScrollbarWidth;function getScrollbarWidth(){let rootDocument=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===cachedScrollbarWidth&&(cachedScrollbarWidth=function walkontableCalculateScrollbarWidth(){let rootDocument=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const inner=rootDocument.createElement("div");inner.style.height="200px",inner.style.width="100%";const outer=rootDocument.createElement("div");outer.style.boxSizing="content-box",outer.style.height="150px",outer.style.left="0px",outer.style.overflow="hidden",outer.style.position="absolute",outer.style.top="0px",outer.style.width="200px",outer.style.visibility="hidden",outer.appendChild(inner),(rootDocument.body||rootDocument.documentElement).appendChild(outer);const w1=inner.offsetWidth;outer.style.overflow="scroll";let w2=inner.offsetWidth;return w1===w2&&(w2=outer.clientWidth),(rootDocument.body||rootDocument.documentElement).removeChild(outer),w1-w2}(rootDocument)),cachedScrollbarWidth}function hasVerticalScrollbar(element){return element instanceof Window?element.document.body.scrollHeight>element.innerHeight:element.offsetWidth!==element.clientWidth}function hasHorizontalScrollbar(element){return element instanceof Window?element.document.body.scrollWidth>element.innerWidth:element.offsetHeight!==element.clientHeight}function setOverlayPosition(overlayElem,left,top){overlayElem.style.transform=`translate3d(${left},${top},0)`}function resetCssTransform(element){element.style.transform&&""!==element.style.transform&&(element.style.transform="")}function isInput(element){return element&&(["INPUT","SELECT","TEXTAREA"].indexOf(element.nodeName)>-1||"true"===element.contentEditable)}function isOutsideInput(element){return isInput(element)&&!1===element.hasAttribute("data-hot-input")}function isDetached(element){return!element.parentNode}function observeVisibilityChangeOnce(elementToBeObserved,callback){new IntersectionObserver(((entries,observer)=>{entries.forEach((entry=>{entry.isIntersecting&&null!==elementToBeObserved.offsetParent&&(callback(),observer.unobserve(elementToBeObserved))}))}),{root:elementToBeObserved.ownerDocument.body}).observe(elementToBeObserved)}function makeElementContentEditableAndSelectItsContent(element){let invisibleSelection=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],ariaHidden=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const ownerDocument=element.ownerDocument,range=ownerDocument.createRange(),sel=ownerDocument.defaultView.getSelection();setAttribute(element,"contenteditable",!0),ariaHidden&&setAttribute(element,...(0,_a11y_mjs__WEBPACK_IMPORTED_MODULE_6__.MG)()),invisibleSelection&&addClass(element,"invisibleSelection"),range.selectNodeContents(element),sel.removeAllRanges(),sel.addRange(range)}function removeContentEditableFromElementAndDeselect(selectedElement){let removeInvisibleSelectionClass=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const sel=selectedElement.ownerDocument.defaultView.getSelection();selectedElement.hasAttribute("aria-hidden")&&selectedElement.removeAttribute("aria-hidden"),sel.removeAllRanges(),removeInvisibleSelectionClass&&removeClass(selectedElement,"invisibleSelection"),selectedElement.removeAttribute("contenteditable")}function runWithSelectedContendEditableElement(element,callback){let invisibleSelection=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];makeElementContentEditableAndSelectItsContent(element,invisibleSelection),callback(),removeContentEditableFromElementAndDeselect(element,invisibleSelection)}function isHTMLElement(element){var _element$ownerDocumen;const OwnElement=null==element||null===(_element$ownerDocumen=element.ownerDocument)||void 0===_element$ownerDocumen?void 0:_element$ownerDocumen.defaultView.Element;return!!(OwnElement&&null!==OwnElement&&element instanceof OwnElement)}},"./node_modules/handsontable/helpers/dom/event.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{CA:()=>stopImmediatePropagation,Ml:()=>isLeftClick,d:()=>isImmediatePropagationStopped,kH:()=>isTouchEvent,nO:()=>isRightClick,zg:()=>offsetRelativeTo});var _element_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/helpers/dom/element.mjs");function stopImmediatePropagation(event){event.isImmediatePropagationEnabled=!1,event.cancelBubble=!0}function isImmediatePropagationStopped(event){return!1===event.isImmediatePropagationEnabled}function isRightClick(event){return 2===event.button}function isLeftClick(event){return 0===event.button}function isTouchEvent(event){return event instanceof TouchEvent}function offsetRelativeTo(event,untilElement){const offset={x:event.offsetX,y:event.offsetY};let element=event.target;if(!(0,_element_mjs__WEBPACK_IMPORTED_MODULE_0__.sb)(untilElement)||element!==untilElement&&element.contains(untilElement))return offset;for(;element!==untilElement;)offset.x+=element.offsetLeft,offset.y+=element.offsetTop,element=element.offsetParent;return offset}},"./node_modules/handsontable/helpers/feature.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function requestAnimationFrame(callback){return window.requestAnimationFrame(callback)}function cancelAnimationFrame(id){window.cancelAnimationFrame(id)}function isTouchSupported(){return"ontouchstart"in window}function isCSR(){return"undefined"!=typeof window}let comparisonFunction;function getComparisonFunction(language){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return comparisonFunction||(comparisonFunction="object"==typeof Intl?new Intl.Collator(language,options).compare:"function"==typeof String.prototype.localeCompare?(a,b)=>`${a}`.localeCompare(b):(a,b)=>a===b?0:a>b?-1:1,comparisonFunction)}__webpack_require__.d(__webpack_exports__,{II:()=>getComparisonFunction,Nt:()=>isCSR,uU:()=>cancelAnimationFrame,xi:()=>requestAnimationFrame,yd:()=>isTouchSupported})},"./node_modules/handsontable/helpers/function.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{OH:()=>partial,Tn:()=>isFunction,Ty:()=>fastCall,cF:()=>curry,sg:()=>debounce});var _mixed_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs");function isFunction(func){return"function"==typeof func}function debounce(func){let result,wait=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,lastTimer=null;return function _debounce(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return lastTimer&&clearTimeout(lastTimer),lastTimer=setTimeout((()=>{result=func.apply(this,args)}),wait),result}}function partial(func){for(var _len6=arguments.length,params=new Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++)params[_key6-1]=arguments[_key6];return function _partial(){for(var _len7=arguments.length,restParams=new Array(_len7),_key7=0;_key7<_len7;_key7++)restParams[_key7]=arguments[_key7];return func.apply(this,params.concat(restParams))}}function curry(func){const argsLength=func.length;return function given(argsSoFar){return function _curry(){for(var _len8=arguments.length,params=new Array(_len8),_key8=0;_key8<_len8;_key8++)params[_key8]=arguments[_key8];const passedArgsSoFar=argsSoFar.concat(params);let result;return result=passedArgsSoFar.length>=argsLength?func.apply(this,passedArgsSoFar):given(passedArgsSoFar),result}}([])}function fastCall(func,context,arg1,arg2,arg3,arg4,arg5,arg6){return(0,_mixed_mjs__WEBPACK_IMPORTED_MODULE_0__.O9)(arg6)?func.call(context,arg1,arg2,arg3,arg4,arg5,arg6):(0,_mixed_mjs__WEBPACK_IMPORTED_MODULE_0__.O9)(arg5)?func.call(context,arg1,arg2,arg3,arg4,arg5):(0,_mixed_mjs__WEBPACK_IMPORTED_MODULE_0__.O9)(arg4)?func.call(context,arg1,arg2,arg3,arg4):(0,_mixed_mjs__WEBPACK_IMPORTED_MODULE_0__.O9)(arg3)?func.call(context,arg1,arg2,arg3):(0,_mixed_mjs__WEBPACK_IMPORTED_MODULE_0__.O9)(arg2)?func.call(context,arg1,arg2):(0,_mixed_mjs__WEBPACK_IMPORTED_MODULE_0__.O9)(arg1)?func.call(context,arg1):func.call(context)}},"./node_modules/handsontable/helpers/mixed.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{As:()=>stringify,Im:()=>isEmpty,O9:()=>isDefined,b0:()=>isUndefined,gd:()=>isRegExp,k_:()=>_injectProductInfo});var moment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/moment/moment.js"),moment__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__),_templateLiteralTag_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/helpers/templateLiteralTag.mjs");function stringify(value){let result;switch(typeof value){case"string":case"number":result=`${value}`;break;case"object":result=null===value?"":value.toString();break;case"undefined":result="";break;default:result=value.toString()}return result}function isDefined(variable){return void 0!==variable}function isUndefined(variable){return void 0===variable}function isEmpty(variable){return null===variable||""===variable||isUndefined(variable)}function isRegExp(variable){return"[object RegExp]"===Object.prototype.toString.call(variable)}const _m="length",_hd=v=>parseInt(v,16),_pi=v=>parseInt(v,10),_ss=(v,s,l)=>v.substr(s,l),_cp=v=>v.codePointAt(0)-65,_norm=v=>`${v}`.replace(/\-/g,""),_extractTime=v=>_hd(_ss(_norm(v),_hd("12"),_cp("F")))/(_hd(_ss(_norm(v),_cp("B"),~~![][_m]))||9),_ignored=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _notified=!1;const consoleMessages={invalid:()=>_templateLiteralTag_mjs__WEBPACK_IMPORTED_MODULE_1__.O`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:_ref=>{let{keyValidityDate,hotVersion}=_ref;return _templateLiteralTag_mjs__WEBPACK_IMPORTED_MODULE_1__.O`
    The license key for Handsontable expired on ${keyValidityDate}, and is not valid for the installed\x20
    version ${hotVersion}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${keyValidityDate}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>_templateLiteralTag_mjs__WEBPACK_IMPORTED_MODULE_1__.O`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},domMessages={invalid:()=>_templateLiteralTag_mjs__WEBPACK_IMPORTED_MODULE_1__.O`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:_ref2=>{let{keyValidityDate,hotVersion}=_ref2;return _templateLiteralTag_mjs__WEBPACK_IMPORTED_MODULE_1__.O`
    The license key for Handsontable expired on ${keyValidityDate}, and is not valid for the installed\x20
    version ${hotVersion}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${keyValidityDate}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>_templateLiteralTag_mjs__WEBPACK_IMPORTED_MODULE_1__.O`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _injectProductInfo(key,element){const hasValidType=!isEmpty(key),isNonCommercial="string"==typeof key&&"non-commercial-and-evaluation"===key.toLowerCase();let keyValidityDate,consoleMessageState="invalid",domMessageState="invalid";const schemaValidity=function _checkKeySchema(v){let z=[][_m],p=z;if(v[_m]!==_cp("Z"))return!1;for(let c="",i="B<H4P+".split(""),j=_cp(i.shift());j;j=_cp(i.shift()||"A"))--j<""[_m]?p|=(_pi(`${_pi(_hd(c)+(_hd(_ss(v,Math.abs(j),2))+[]).padStart(2,"0"))}`)%97||2)>>1:c=_ss(v,j,j?1===i[_m]?9:8:6);return p===z}(key=_norm(key||""));if(hasValidType||isNonCommercial||schemaValidity)if(schemaValidity){const releaseDate=moment__WEBPACK_IMPORTED_MODULE_0___default()("19/03/2025","DD/MM/YYYY"),releaseDays=Math.floor(releaseDate.toDate().getTime()/864e5),keyValidityDays=_extractTime(key);keyValidityDate=moment__WEBPACK_IMPORTED_MODULE_0___default()(864e5*(keyValidityDays+1),"x").format("MMMM DD, YYYY"),releaseDays>keyValidityDays?(consoleMessageState="expired",domMessageState="expired"):(consoleMessageState="valid",domMessageState="valid")}else isNonCommercial?(consoleMessageState="non_commercial",domMessageState="valid"):(consoleMessageState="invalid",domMessageState="invalid");else consoleMessageState="missing",domMessageState="missing";if(_ignored()&&(consoleMessageState="valid",domMessageState="valid"),!_notified&&"valid"!==consoleMessageState){consoleMessages[consoleMessageState]({keyValidityDate,hotVersion:"15.2.0"})&&console["non_commercial"===consoleMessageState?"info":"warn"](consoleMessages[consoleMessageState]({keyValidityDate,hotVersion:"15.2.0"})),_notified=!0}if("valid"!==domMessageState&&element.parentNode){if(domMessages[domMessageState]({keyValidityDate,hotVersion:"15.2.0"})){const messageNode=document.createElement("div");messageNode.className="handsontable hot-display-license-info",messageNode.innerHTML=domMessages[domMessageState]({keyValidityDate,hotVersion:"15.2.0"}),element.parentNode.insertBefore(messageNode,element.nextSibling)}}}},"./node_modules/handsontable/helpers/number.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{B5:()=>valueAccordingPercent,LA:()=>isNumericLike,Ti:()=>rangeEach,fk:()=>rangeEachReverse,kf:()=>isNumeric,qE:()=>clamp});__webpack_require__("./node_modules/core-js/modules/es.set.difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.intersection.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-subset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-superset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.symmetric-difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.union.v2.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");function isNumeric(value){let additionalDelimiters=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const type=typeof value;if("number"===type)return!isNaN(value)&&isFinite(value);if("string"===type){if(0===value.length)return!1;if(1===value.length)return/\d/.test(value);const delimiter=Array.from(new Set([".",...additionalDelimiters])).map((d=>`\\${d}`)).join("|");return new RegExp(`^[+-]?(((${delimiter})?\\d+((${delimiter})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(value.trim())}return"object"===type&&!(!value||"number"!=typeof value.valueOf()||value instanceof Date)}function isNumericLike(value){return isNumeric(value,[","])}function rangeEach(rangeFrom,rangeTo,iteratee){let index=-1;for("function"==typeof rangeTo?(iteratee=rangeTo,rangeTo=rangeFrom):index=rangeFrom-1;++index<=rangeTo&&!1!==iteratee(index););}function rangeEachReverse(rangeFrom,rangeTo,iteratee){let index=rangeFrom+1;for("function"==typeof rangeTo&&(iteratee=rangeTo,rangeTo=0);--index>=rangeTo&&!1!==iteratee(index););}function valueAccordingPercent(value,percent){return percent=parseInt(percent.toString().replace("%",""),10),percent=isNaN(percent)?0:percent,parseInt(value*percent/100,10)}function clamp(value,minValue,maxValue){return Math.min(value,minValue)===value?minValue:Math.max(value,maxValue)===value?maxValue:value}},"./node_modules/handsontable/helpers/object.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$3:()=>deepObjectSize,Go:()=>deepClone,Gv:()=>isObject,IL:()=>inherit,LH:()=>defineGetter,Nl:()=>duckSchema,UU:()=>getProperty,X$:()=>extend,co:()=>mixin,mQ:()=>hasOwnProperty,nA:()=>createObjectPropListener,o8:()=>clone,oq:()=>setProperty,v4:()=>objectEach,wU:()=>isObjectEqual,zw:()=>deepExtend});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/es.json.stringify.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js");var _array_mjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs");function duckSchema(object){let schema;return Array.isArray(object)?schema=object.length?new Array(object.length).fill(null):[]:(schema={},objectEach(object,((value,key)=>{"__children"!==key&&(value&&"object"==typeof value&&!Array.isArray(value)?schema[key]=duckSchema(value):Array.isArray(value)?value.length&&"object"==typeof value[0]&&!Array.isArray(value[0])?schema[key]=[duckSchema(value[0])]:schema[key]=[]:schema[key]=null)}))),schema}function inherit(Child,Parent){return Parent.prototype.constructor=Parent,Child.prototype=new Parent,Child.prototype.constructor=Child,Child}function extend(target,extension,writableKeys){const hasWritableKeys=Array.isArray(writableKeys);return objectEach(extension,((value,key)=>{(!1===hasWritableKeys||writableKeys.includes(key))&&(target[key]=value)})),target}function deepExtend(target,extension){objectEach(extension,((value,key)=>{extension[key]&&"object"==typeof extension[key]?(target[key]||(Array.isArray(extension[key])?target[key]=[]:"[object Date]"===Object.prototype.toString.call(extension[key])?target[key]=extension[key]:target[key]={}),deepExtend(target[key],extension[key])):target[key]=extension[key]}))}function deepClone(obj){return"object"==typeof obj?JSON.parse(JSON.stringify(obj)):obj}function clone(object){const result={};return objectEach(object,((value,key)=>{result[key]=value})),result}function mixin(Base){Base.MIXINS||(Base.MIXINS=[]);for(var _len=arguments.length,mixins=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)mixins[_key-1]=arguments[_key];return(0,_array_mjs__WEBPACK_IMPORTED_MODULE_5__.z0)(mixins,(mixinItem=>{Base.MIXINS.push(mixinItem.MIXIN_NAME),objectEach(mixinItem,((value,key)=>{if(void 0!==Base.prototype[key])throw new Error(`Mixin conflict. Property '${key}' already exist and cannot be overwritten.`);if("function"==typeof value)Base.prototype[key]=value;else{const getter=function _getter(property,initialValue){const propertyName=`_${property}`;return function(){return void 0===this[propertyName]&&(this[propertyName]=(newValue=>{let result=newValue;return(Array.isArray(result)||isObject(result))&&(result=deepClone(result)),result})(initialValue)),this[propertyName]}},setter=function _setter(property){const propertyName=`_${property}`;return function(newValue){this[propertyName]=newValue}};Object.defineProperty(Base.prototype,key,{get:getter(key,value),set:setter(key),configurable:!0})}}))})),Base}function isObjectEqual(object1,object2){return JSON.stringify(object1)===JSON.stringify(object2)}function isObject(object){return"[object Object]"===Object.prototype.toString.call(object)}function defineGetter(object,property,value,options){options.value=value,options.writable=!1!==options.writable,options.enumerable=!1!==options.enumerable,options.configurable=!1!==options.configurable,Object.defineProperty(object,property,options)}function objectEach(object,iteratee){for(const key in object)if((!object.hasOwnProperty||object.hasOwnProperty&&Object.prototype.hasOwnProperty.call(object,key))&&!1===iteratee(object[key],key,object))break;return object}function getProperty(object,name){const names=name.split(".");let result=object;return objectEach(names,(nameItem=>{if(result=result[nameItem],void 0===result)return result=void 0,!1})),result}function setProperty(object,name,value){const names=name.split(".");let workingObject=object;names.forEach(((propName,index)=>{"__proto__"!==propName&&"constructor"!==propName&&"prototype"!==propName&&(index!==names.length-1?(hasOwnProperty(workingObject,propName)||(workingObject[propName]={}),workingObject=workingObject[propName]):workingObject[propName]=value)}))}function deepObjectSize(object){if(!isObject(object))return 0;const recursObjLen=function(obj){let result=0;return isObject(obj)?objectEach(obj,((value,key)=>{"__children"!==key&&(result+=recursObjLen(value))})):result+=1,result};return recursObjLen(object)}function createObjectPropListener(defaultValue){let propertyToListen=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const privateProperty=`_${propertyToListen}`,holder={_touched:!1,[privateProperty]:defaultValue,isTouched(){return this._touched}};return Object.defineProperty(holder,propertyToListen,{get(){return this[privateProperty]},set(value){this._touched=!0,this[privateProperty]=value},enumerable:!0,configurable:!0}),holder}function hasOwnProperty(object,key){return Object.prototype.hasOwnProperty.call(object,key)}},"./node_modules/handsontable/helpers/string.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Pi:()=>isPercentValue,DU:()=>randomString,aj:()=>sanitize,Kq:()=>stripTags,V2:()=>substitute,Ob:()=>toUpperCaseFirst});__webpack_require__("./node_modules/core-js/modules/es.array.push.js");const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze,seal,create}=Object,{apply,construct}="undefined"!=typeof Reflect&&Reflect;freeze||(freeze=function freeze(x){return x}),seal||(seal=function seal(x){return x}),apply||(apply=function apply(fun,thisValue,args){return fun.apply(thisValue,args)}),construct||(construct=function construct(Func,args){return new Func(...args)});const arrayForEach=unapply(Array.prototype.forEach),arrayLastIndexOf=unapply(Array.prototype.lastIndexOf),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),arraySplice=unapply(Array.prototype.splice),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=function unconstruct(func){return function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return construct(func,args)}}(TypeError);function unapply(func){return function(thisArg){thisArg instanceof RegExp&&(thisArg.lastIndex=0);for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return apply(func,thisArg,args)}}function addToSet(set,array){let transformCaseFunc=arguments.length>2&&void 0!==arguments[2]?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(set,null);let l=array.length;for(;l--;){let element=array[l];if("string"==typeof element){const lcElement=transformCaseFunc(element);lcElement!==element&&(isFrozen(array)||(array[l]=lcElement),element=lcElement)}set[element]=!0}return set}function cleanArray(array){for(let index=0;index<array.length;index++){objectHasOwnProperty(array,index)||(array[index]=null)}return array}function clone(object){const newObject=create(null);for(const[property,value]of entries(object)){objectHasOwnProperty(object,property)&&(Array.isArray(value)?newObject[property]=cleanArray(value):value&&"object"==typeof value&&value.constructor===Object?newObject[property]=clone(value):newObject[property]=value)}return newObject}function lookupGetter(object,prop){for(;null!==object;){const desc=getOwnPropertyDescriptor(object,prop);if(desc){if(desc.get)return unapply(desc.get);if("function"==typeof desc.value)return unapply(desc.value)}object=getPrototypeOf(object)}return function fallbackValue(){return null}}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),purify_es_text=freeze(["#text"]),html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\$\{[\w\W]*/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR,ATTR_WHITESPACE,CUSTOM_ELEMENT,DATA_ATTR,DOCTYPE_NAME,ERB_EXPR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,MUSTACHE_EXPR,TMPLIT_EXPR});const NODE_TYPE_element=1,NODE_TYPE_text=3,NODE_TYPE_progressingInstruction=7,NODE_TYPE_comment=8,NODE_TYPE_document=9,getGlobal=function getGlobal(){return"undefined"==typeof window?null:window};var purify=function createDOMPurify(){let window=arguments.length>0&&void 0!==arguments[0]?arguments[0]:getGlobal();const DOMPurify=root=>createDOMPurify(root);if(DOMPurify.version="3.2.5",DOMPurify.removed=[],!window||!window.document||window.document.nodeType!==NODE_TYPE_document||!window.Element)return DOMPurify.isSupported=!1,DOMPurify;let{document}=window;const originalDocument=document,currentScript=originalDocument.currentScript,{DocumentFragment,HTMLTemplateElement,Node,Element,NodeFilter,NamedNodeMap=window.NamedNodeMap||window.MozNamedAttrMap,HTMLFormElement,DOMParser,trustedTypes}=window,ElementPrototype=Element.prototype,cloneNode=lookupGetter(ElementPrototype,"cloneNode"),remove=lookupGetter(ElementPrototype,"remove"),getNextSibling=lookupGetter(ElementPrototype,"nextSibling"),getChildNodes=lookupGetter(ElementPrototype,"childNodes"),getParentNode=lookupGetter(ElementPrototype,"parentNode");if("function"==typeof HTMLTemplateElement){const template=document.createElement("template");template.content&&template.content.ownerDocument&&(document=template.content.ownerDocument)}let trustedTypesPolicy,emptyHTML="";const{implementation,createNodeIterator,createDocumentFragment,getElementsByTagName}=document,{importNode}=originalDocument;let hooks={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};DOMPurify.isSupported="function"==typeof entries&&"function"==typeof getParentNode&&implementation&&void 0!==implementation.createHTMLDocument;const{MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR,DATA_ATTR,ARIA_ATTR,IS_SCRIPT_OR_DATA,ATTR_WHITESPACE,CUSTOM_ELEMENT}=EXPRESSIONS;let{IS_ALLOWED_URI:IS_ALLOWED_URI$1}=EXPRESSIONS,ALLOWED_TAGS=null;const DEFAULT_ALLOWED_TAGS=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...purify_es_text]);let ALLOWED_ATTR=null;const DEFAULT_ALLOWED_ATTR=addToSet({},[...html,...svg,...mathMl,...xml]);let CUSTOM_ELEMENT_HANDLING=Object.seal(create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),FORBID_TAGS=null,FORBID_ATTR=null,ALLOW_ARIA_ATTR=!0,ALLOW_DATA_ATTR=!0,ALLOW_UNKNOWN_PROTOCOLS=!1,ALLOW_SELF_CLOSE_IN_ATTR=!0,SAFE_FOR_TEMPLATES=!1,SAFE_FOR_XML=!0,WHOLE_DOCUMENT=!1,SET_CONFIG=!1,FORCE_BODY=!1,RETURN_DOM=!1,RETURN_DOM_FRAGMENT=!1,RETURN_TRUSTED_TYPE=!1,SANITIZE_DOM=!0,SANITIZE_NAMED_PROPS=!1,KEEP_CONTENT=!0,IN_PLACE=!1,USE_PROFILES={},FORBID_CONTENTS=null;const DEFAULT_FORBID_CONTENTS=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let DATA_URI_TAGS=null;const DEFAULT_DATA_URI_TAGS=addToSet({},["audio","video","img","source","image","track"]);let URI_SAFE_ATTRIBUTES=null;const DEFAULT_URI_SAFE_ATTRIBUTES=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),MATHML_NAMESPACE="http://www.w3.org/1998/Math/MathML",SVG_NAMESPACE="http://www.w3.org/2000/svg",HTML_NAMESPACE="http://www.w3.org/1999/xhtml";let NAMESPACE=HTML_NAMESPACE,IS_EMPTY_INPUT=!1,ALLOWED_NAMESPACES=null;const DEFAULT_ALLOWED_NAMESPACES=addToSet({},[MATHML_NAMESPACE,SVG_NAMESPACE,HTML_NAMESPACE],stringToString);let MATHML_TEXT_INTEGRATION_POINTS=addToSet({},["mi","mo","mn","ms","mtext"]),HTML_INTEGRATION_POINTS=addToSet({},["annotation-xml"]);const COMMON_SVG_AND_HTML_ELEMENTS=addToSet({},["title","style","font","a","script"]);let PARSER_MEDIA_TYPE=null;const SUPPORTED_PARSER_MEDIA_TYPES=["application/xhtml+xml","text/html"];let transformCaseFunc=null,CONFIG=null;const formElement=document.createElement("form"),isRegexOrFunction=function isRegexOrFunction(testValue){return testValue instanceof RegExp||testValue instanceof Function},_parseConfig=function _parseConfig(){let cfg=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!CONFIG||CONFIG!==cfg){if(cfg&&"object"==typeof cfg||(cfg={}),cfg=clone(cfg),PARSER_MEDIA_TYPE=-1===SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE)?"text/html":cfg.PARSER_MEDIA_TYPE,transformCaseFunc="application/xhtml+xml"===PARSER_MEDIA_TYPE?stringToString:stringToLowerCase,ALLOWED_TAGS=objectHasOwnProperty(cfg,"ALLOWED_TAGS")?addToSet({},cfg.ALLOWED_TAGS,transformCaseFunc):DEFAULT_ALLOWED_TAGS,ALLOWED_ATTR=objectHasOwnProperty(cfg,"ALLOWED_ATTR")?addToSet({},cfg.ALLOWED_ATTR,transformCaseFunc):DEFAULT_ALLOWED_ATTR,ALLOWED_NAMESPACES=objectHasOwnProperty(cfg,"ALLOWED_NAMESPACES")?addToSet({},cfg.ALLOWED_NAMESPACES,stringToString):DEFAULT_ALLOWED_NAMESPACES,URI_SAFE_ATTRIBUTES=objectHasOwnProperty(cfg,"ADD_URI_SAFE_ATTR")?addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES),cfg.ADD_URI_SAFE_ATTR,transformCaseFunc):DEFAULT_URI_SAFE_ATTRIBUTES,DATA_URI_TAGS=objectHasOwnProperty(cfg,"ADD_DATA_URI_TAGS")?addToSet(clone(DEFAULT_DATA_URI_TAGS),cfg.ADD_DATA_URI_TAGS,transformCaseFunc):DEFAULT_DATA_URI_TAGS,FORBID_CONTENTS=objectHasOwnProperty(cfg,"FORBID_CONTENTS")?addToSet({},cfg.FORBID_CONTENTS,transformCaseFunc):DEFAULT_FORBID_CONTENTS,FORBID_TAGS=objectHasOwnProperty(cfg,"FORBID_TAGS")?addToSet({},cfg.FORBID_TAGS,transformCaseFunc):{},FORBID_ATTR=objectHasOwnProperty(cfg,"FORBID_ATTR")?addToSet({},cfg.FORBID_ATTR,transformCaseFunc):{},USE_PROFILES=!!objectHasOwnProperty(cfg,"USE_PROFILES")&&cfg.USE_PROFILES,ALLOW_ARIA_ATTR=!1!==cfg.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR=!1!==cfg.ALLOW_DATA_ATTR,ALLOW_UNKNOWN_PROTOCOLS=cfg.ALLOW_UNKNOWN_PROTOCOLS||!1,ALLOW_SELF_CLOSE_IN_ATTR=!1!==cfg.ALLOW_SELF_CLOSE_IN_ATTR,SAFE_FOR_TEMPLATES=cfg.SAFE_FOR_TEMPLATES||!1,SAFE_FOR_XML=!1!==cfg.SAFE_FOR_XML,WHOLE_DOCUMENT=cfg.WHOLE_DOCUMENT||!1,RETURN_DOM=cfg.RETURN_DOM||!1,RETURN_DOM_FRAGMENT=cfg.RETURN_DOM_FRAGMENT||!1,RETURN_TRUSTED_TYPE=cfg.RETURN_TRUSTED_TYPE||!1,FORCE_BODY=cfg.FORCE_BODY||!1,SANITIZE_DOM=!1!==cfg.SANITIZE_DOM,SANITIZE_NAMED_PROPS=cfg.SANITIZE_NAMED_PROPS||!1,KEEP_CONTENT=!1!==cfg.KEEP_CONTENT,IN_PLACE=cfg.IN_PLACE||!1,IS_ALLOWED_URI$1=cfg.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,NAMESPACE=cfg.NAMESPACE||HTML_NAMESPACE,MATHML_TEXT_INTEGRATION_POINTS=cfg.MATHML_TEXT_INTEGRATION_POINTS||MATHML_TEXT_INTEGRATION_POINTS,HTML_INTEGRATION_POINTS=cfg.HTML_INTEGRATION_POINTS||HTML_INTEGRATION_POINTS,CUSTOM_ELEMENT_HANDLING=cfg.CUSTOM_ELEMENT_HANDLING||{},cfg.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck=cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck),cfg.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(CUSTOM_ELEMENT_HANDLING.attributeNameCheck=cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),cfg.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),SAFE_FOR_TEMPLATES&&(ALLOW_DATA_ATTR=!1),RETURN_DOM_FRAGMENT&&(RETURN_DOM=!0),USE_PROFILES&&(ALLOWED_TAGS=addToSet({},purify_es_text),ALLOWED_ATTR=[],!0===USE_PROFILES.html&&(addToSet(ALLOWED_TAGS,html$1),addToSet(ALLOWED_ATTR,html)),!0===USE_PROFILES.svg&&(addToSet(ALLOWED_TAGS,svg$1),addToSet(ALLOWED_ATTR,svg),addToSet(ALLOWED_ATTR,xml)),!0===USE_PROFILES.svgFilters&&(addToSet(ALLOWED_TAGS,svgFilters),addToSet(ALLOWED_ATTR,svg),addToSet(ALLOWED_ATTR,xml)),!0===USE_PROFILES.mathMl&&(addToSet(ALLOWED_TAGS,mathMl$1),addToSet(ALLOWED_ATTR,mathMl),addToSet(ALLOWED_ATTR,xml))),cfg.ADD_TAGS&&(ALLOWED_TAGS===DEFAULT_ALLOWED_TAGS&&(ALLOWED_TAGS=clone(ALLOWED_TAGS)),addToSet(ALLOWED_TAGS,cfg.ADD_TAGS,transformCaseFunc)),cfg.ADD_ATTR&&(ALLOWED_ATTR===DEFAULT_ALLOWED_ATTR&&(ALLOWED_ATTR=clone(ALLOWED_ATTR)),addToSet(ALLOWED_ATTR,cfg.ADD_ATTR,transformCaseFunc)),cfg.ADD_URI_SAFE_ATTR&&addToSet(URI_SAFE_ATTRIBUTES,cfg.ADD_URI_SAFE_ATTR,transformCaseFunc),cfg.FORBID_CONTENTS&&(FORBID_CONTENTS===DEFAULT_FORBID_CONTENTS&&(FORBID_CONTENTS=clone(FORBID_CONTENTS)),addToSet(FORBID_CONTENTS,cfg.FORBID_CONTENTS,transformCaseFunc)),KEEP_CONTENT&&(ALLOWED_TAGS["#text"]=!0),WHOLE_DOCUMENT&&addToSet(ALLOWED_TAGS,["html","head","body"]),ALLOWED_TAGS.table&&(addToSet(ALLOWED_TAGS,["tbody"]),delete FORBID_TAGS.tbody),cfg.TRUSTED_TYPES_POLICY){if("function"!=typeof cfg.TRUSTED_TYPES_POLICY.createHTML)throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL)throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');trustedTypesPolicy=cfg.TRUSTED_TYPES_POLICY,emptyHTML=trustedTypesPolicy.createHTML("")}else void 0===trustedTypesPolicy&&(trustedTypesPolicy=function _createTrustedTypesPolicy(trustedTypes,purifyHostElement){if("object"!=typeof trustedTypes||"function"!=typeof trustedTypes.createPolicy)return null;let suffix=null;purifyHostElement&&purifyHostElement.hasAttribute("data-tt-policy-suffix")&&(suffix=purifyHostElement.getAttribute("data-tt-policy-suffix"));const policyName="dompurify"+(suffix?"#"+suffix:"");try{return trustedTypes.createPolicy(policyName,{createHTML:html=>html,createScriptURL:scriptUrl=>scriptUrl})}catch(_){return console.warn("TrustedTypes policy "+policyName+" could not be created."),null}}(trustedTypes,currentScript)),null!==trustedTypesPolicy&&"string"==typeof emptyHTML&&(emptyHTML=trustedTypesPolicy.createHTML(""));freeze&&freeze(cfg),CONFIG=cfg}},ALL_SVG_TAGS=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),ALL_MATHML_TAGS=addToSet({},[...mathMl$1,...mathMlDisallowed]),_forceRemove=function _forceRemove(node){arrayPush(DOMPurify.removed,{element:node});try{getParentNode(node).removeChild(node)}catch(_){remove(node)}},_removeAttribute=function _removeAttribute(name,element){try{arrayPush(DOMPurify.removed,{attribute:element.getAttributeNode(name),from:element})}catch(_){arrayPush(DOMPurify.removed,{attribute:null,from:element})}if(element.removeAttribute(name),"is"===name)if(RETURN_DOM||RETURN_DOM_FRAGMENT)try{_forceRemove(element)}catch(_){}else try{element.setAttribute(name,"")}catch(_){}},_initDocument=function _initDocument(dirty){let doc=null,leadingWhitespace=null;if(FORCE_BODY)dirty="<remove></remove>"+dirty;else{const matches=stringMatch(dirty,/^[\r\n\t ]+/);leadingWhitespace=matches&&matches[0]}"application/xhtml+xml"===PARSER_MEDIA_TYPE&&NAMESPACE===HTML_NAMESPACE&&(dirty='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+dirty+"</body></html>");const dirtyPayload=trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;if(NAMESPACE===HTML_NAMESPACE)try{doc=(new DOMParser).parseFromString(dirtyPayload,PARSER_MEDIA_TYPE)}catch(_){}if(!doc||!doc.documentElement){doc=implementation.createDocument(NAMESPACE,"template",null);try{doc.documentElement.innerHTML=IS_EMPTY_INPUT?emptyHTML:dirtyPayload}catch(_){}}const body=doc.body||doc.documentElement;return dirty&&leadingWhitespace&&body.insertBefore(document.createTextNode(leadingWhitespace),body.childNodes[0]||null),NAMESPACE===HTML_NAMESPACE?getElementsByTagName.call(doc,WHOLE_DOCUMENT?"html":"body")[0]:WHOLE_DOCUMENT?doc.documentElement:body},_createNodeIterator=function _createNodeIterator(root){return createNodeIterator.call(root.ownerDocument||root,root,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT|NodeFilter.SHOW_PROCESSING_INSTRUCTION|NodeFilter.SHOW_CDATA_SECTION,null)},_isClobbered=function _isClobbered(element){return element instanceof HTMLFormElement&&("string"!=typeof element.nodeName||"string"!=typeof element.textContent||"function"!=typeof element.removeChild||!(element.attributes instanceof NamedNodeMap)||"function"!=typeof element.removeAttribute||"function"!=typeof element.setAttribute||"string"!=typeof element.namespaceURI||"function"!=typeof element.insertBefore||"function"!=typeof element.hasChildNodes)},_isNode=function _isNode(value){return"function"==typeof Node&&value instanceof Node};function _executeHooks(hooks,currentNode,data){arrayForEach(hooks,(hook=>{hook.call(DOMPurify,currentNode,data,CONFIG)}))}const _sanitizeElements=function _sanitizeElements(currentNode){let content=null;if(_executeHooks(hooks.beforeSanitizeElements,currentNode,null),_isClobbered(currentNode))return _forceRemove(currentNode),!0;const tagName=transformCaseFunc(currentNode.nodeName);if(_executeHooks(hooks.uponSanitizeElement,currentNode,{tagName,allowedTags:ALLOWED_TAGS}),currentNode.hasChildNodes()&&!_isNode(currentNode.firstElementChild)&&regExpTest(/<[/\w!]/g,currentNode.innerHTML)&&regExpTest(/<[/\w!]/g,currentNode.textContent))return _forceRemove(currentNode),!0;if(currentNode.nodeType===NODE_TYPE_progressingInstruction)return _forceRemove(currentNode),!0;if(SAFE_FOR_XML&&currentNode.nodeType===NODE_TYPE_comment&&regExpTest(/<[/\w]/g,currentNode.data))return _forceRemove(currentNode),!0;if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){if(!FORBID_TAGS[tagName]&&_isBasicCustomElement(tagName)){if(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,tagName))return!1;if(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName))return!1}if(KEEP_CONTENT&&!FORBID_CONTENTS[tagName]){const parentNode=getParentNode(currentNode)||currentNode.parentNode,childNodes=getChildNodes(currentNode)||currentNode.childNodes;if(childNodes&&parentNode){for(let i=childNodes.length-1;i>=0;--i){const childClone=cloneNode(childNodes[i],!0);childClone.__removalCount=(currentNode.__removalCount||0)+1,parentNode.insertBefore(childClone,getNextSibling(currentNode))}}}return _forceRemove(currentNode),!0}return currentNode instanceof Element&&!function _checkValidNamespace(element){let parent=getParentNode(element);parent&&parent.tagName||(parent={namespaceURI:NAMESPACE,tagName:"template"});const tagName=stringToLowerCase(element.tagName),parentTagName=stringToLowerCase(parent.tagName);return!!ALLOWED_NAMESPACES[element.namespaceURI]&&(element.namespaceURI===SVG_NAMESPACE?parent.namespaceURI===HTML_NAMESPACE?"svg"===tagName:parent.namespaceURI===MATHML_NAMESPACE?"svg"===tagName&&("annotation-xml"===parentTagName||MATHML_TEXT_INTEGRATION_POINTS[parentTagName]):Boolean(ALL_SVG_TAGS[tagName]):element.namespaceURI===MATHML_NAMESPACE?parent.namespaceURI===HTML_NAMESPACE?"math"===tagName:parent.namespaceURI===SVG_NAMESPACE?"math"===tagName&&HTML_INTEGRATION_POINTS[parentTagName]:Boolean(ALL_MATHML_TAGS[tagName]):element.namespaceURI===HTML_NAMESPACE?!(parent.namespaceURI===SVG_NAMESPACE&&!HTML_INTEGRATION_POINTS[parentTagName])&&!(parent.namespaceURI===MATHML_NAMESPACE&&!MATHML_TEXT_INTEGRATION_POINTS[parentTagName])&&!ALL_MATHML_TAGS[tagName]&&(COMMON_SVG_AND_HTML_ELEMENTS[tagName]||!ALL_SVG_TAGS[tagName]):!("application/xhtml+xml"!==PARSER_MEDIA_TYPE||!ALLOWED_NAMESPACES[element.namespaceURI]))}(currentNode)?(_forceRemove(currentNode),!0):"noscript"!==tagName&&"noembed"!==tagName&&"noframes"!==tagName||!regExpTest(/<\/no(script|embed|frames)/i,currentNode.innerHTML)?(SAFE_FOR_TEMPLATES&&currentNode.nodeType===NODE_TYPE_text&&(content=currentNode.textContent,arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],(expr=>{content=stringReplace(content,expr," ")})),currentNode.textContent!==content&&(arrayPush(DOMPurify.removed,{element:currentNode.cloneNode()}),currentNode.textContent=content)),_executeHooks(hooks.afterSanitizeElements,currentNode,null),!1):(_forceRemove(currentNode),!0)},_isValidAttribute=function _isValidAttribute(lcTag,lcName,value){if(SANITIZE_DOM&&("id"===lcName||"name"===lcName)&&(value in document||value in formElement))return!1;if(ALLOW_DATA_ATTR&&!FORBID_ATTR[lcName]&&regExpTest(DATA_ATTR,lcName));else if(ALLOW_ARIA_ATTR&&regExpTest(ARIA_ATTR,lcName));else if(!ALLOWED_ATTR[lcName]||FORBID_ATTR[lcName]){if(!(_isBasicCustomElement(lcTag)&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,lcTag)||CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag))&&(CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck,lcName)||CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName))||"is"===lcName&&CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,value)||CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))))return!1}else if(URI_SAFE_ATTRIBUTES[lcName]);else if(regExpTest(IS_ALLOWED_URI$1,stringReplace(value,ATTR_WHITESPACE,"")));else if("src"!==lcName&&"xlink:href"!==lcName&&"href"!==lcName||"script"===lcTag||0!==stringIndexOf(value,"data:")||!DATA_URI_TAGS[lcTag]){if(ALLOW_UNKNOWN_PROTOCOLS&&!regExpTest(IS_SCRIPT_OR_DATA,stringReplace(value,ATTR_WHITESPACE,"")));else if(value)return!1}else;return!0},_isBasicCustomElement=function _isBasicCustomElement(tagName){return"annotation-xml"!==tagName&&stringMatch(tagName,CUSTOM_ELEMENT)},_sanitizeAttributes=function _sanitizeAttributes(currentNode){_executeHooks(hooks.beforeSanitizeAttributes,currentNode,null);const{attributes}=currentNode;if(!attributes||_isClobbered(currentNode))return;const hookEvent={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ALLOWED_ATTR,forceKeepAttr:void 0};let l=attributes.length;for(;l--;){const attr=attributes[l],{name,namespaceURI,value:attrValue}=attr,lcName=transformCaseFunc(name);let value="value"===name?attrValue:stringTrim(attrValue);if(hookEvent.attrName=lcName,hookEvent.attrValue=value,hookEvent.keepAttr=!0,hookEvent.forceKeepAttr=void 0,_executeHooks(hooks.uponSanitizeAttribute,currentNode,hookEvent),value=hookEvent.attrValue,!SANITIZE_NAMED_PROPS||"id"!==lcName&&"name"!==lcName||(_removeAttribute(name,currentNode),value="user-content-"+value),SAFE_FOR_XML&&regExpTest(/((--!?|])>)|<\/(style|title)/i,value)){_removeAttribute(name,currentNode);continue}if(hookEvent.forceKeepAttr)continue;if(_removeAttribute(name,currentNode),!hookEvent.keepAttr)continue;if(!ALLOW_SELF_CLOSE_IN_ATTR&&regExpTest(/\/>/i,value)){_removeAttribute(name,currentNode);continue}SAFE_FOR_TEMPLATES&&arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],(expr=>{value=stringReplace(value,expr," ")}));const lcTag=transformCaseFunc(currentNode.nodeName);if(_isValidAttribute(lcTag,lcName,value)){if(trustedTypesPolicy&&"object"==typeof trustedTypes&&"function"==typeof trustedTypes.getAttributeType)if(namespaceURI);else switch(trustedTypes.getAttributeType(lcTag,lcName)){case"TrustedHTML":value=trustedTypesPolicy.createHTML(value);break;case"TrustedScriptURL":value=trustedTypesPolicy.createScriptURL(value)}try{namespaceURI?currentNode.setAttributeNS(namespaceURI,name,value):currentNode.setAttribute(name,value),_isClobbered(currentNode)?_forceRemove(currentNode):arrayPop(DOMPurify.removed)}catch(_){}}}_executeHooks(hooks.afterSanitizeAttributes,currentNode,null)},_sanitizeShadowDOM=function _sanitizeShadowDOM(fragment){let shadowNode=null;const shadowIterator=_createNodeIterator(fragment);for(_executeHooks(hooks.beforeSanitizeShadowDOM,fragment,null);shadowNode=shadowIterator.nextNode();)_executeHooks(hooks.uponSanitizeShadowNode,shadowNode,null),_sanitizeElements(shadowNode),_sanitizeAttributes(shadowNode),shadowNode.content instanceof DocumentFragment&&_sanitizeShadowDOM(shadowNode.content);_executeHooks(hooks.afterSanitizeShadowDOM,fragment,null)};return DOMPurify.sanitize=function(dirty){let cfg=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},body=null,importedNode=null,currentNode=null,returnNode=null;if(IS_EMPTY_INPUT=!dirty,IS_EMPTY_INPUT&&(dirty="\x3c!--\x3e"),"string"!=typeof dirty&&!_isNode(dirty)){if("function"!=typeof dirty.toString)throw typeErrorCreate("toString is not a function");if("string"!=typeof(dirty=dirty.toString()))throw typeErrorCreate("dirty is not a string, aborting")}if(!DOMPurify.isSupported)return dirty;if(SET_CONFIG||_parseConfig(cfg),DOMPurify.removed=[],"string"==typeof dirty&&(IN_PLACE=!1),IN_PLACE){if(dirty.nodeName){const tagName=transformCaseFunc(dirty.nodeName);if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(dirty instanceof Node)body=_initDocument("\x3c!----\x3e"),importedNode=body.ownerDocument.importNode(dirty,!0),importedNode.nodeType===NODE_TYPE_element&&"BODY"===importedNode.nodeName||"HTML"===importedNode.nodeName?body=importedNode:body.appendChild(importedNode);else{if(!RETURN_DOM&&!SAFE_FOR_TEMPLATES&&!WHOLE_DOCUMENT&&-1===dirty.indexOf("<"))return trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(dirty):dirty;if(body=_initDocument(dirty),!body)return RETURN_DOM?null:RETURN_TRUSTED_TYPE?emptyHTML:""}body&&FORCE_BODY&&_forceRemove(body.firstChild);const nodeIterator=_createNodeIterator(IN_PLACE?dirty:body);for(;currentNode=nodeIterator.nextNode();)_sanitizeElements(currentNode),_sanitizeAttributes(currentNode),currentNode.content instanceof DocumentFragment&&_sanitizeShadowDOM(currentNode.content);if(IN_PLACE)return dirty;if(RETURN_DOM){if(RETURN_DOM_FRAGMENT)for(returnNode=createDocumentFragment.call(body.ownerDocument);body.firstChild;)returnNode.appendChild(body.firstChild);else returnNode=body;return(ALLOWED_ATTR.shadowroot||ALLOWED_ATTR.shadowrootmode)&&(returnNode=importNode.call(originalDocument,returnNode,!0)),returnNode}let serializedHTML=WHOLE_DOCUMENT?body.outerHTML:body.innerHTML;return WHOLE_DOCUMENT&&ALLOWED_TAGS["!doctype"]&&body.ownerDocument&&body.ownerDocument.doctype&&body.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,body.ownerDocument.doctype.name)&&(serializedHTML="<!DOCTYPE "+body.ownerDocument.doctype.name+">\n"+serializedHTML),SAFE_FOR_TEMPLATES&&arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],(expr=>{serializedHTML=stringReplace(serializedHTML,expr," ")})),trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(serializedHTML):serializedHTML},DOMPurify.setConfig=function(){_parseConfig(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),SET_CONFIG=!0},DOMPurify.clearConfig=function(){CONFIG=null,SET_CONFIG=!1},DOMPurify.isValidAttribute=function(tag,attr,value){CONFIG||_parseConfig({});const lcTag=transformCaseFunc(tag),lcName=transformCaseFunc(attr);return _isValidAttribute(lcTag,lcName,value)},DOMPurify.addHook=function(entryPoint,hookFunction){"function"==typeof hookFunction&&arrayPush(hooks[entryPoint],hookFunction)},DOMPurify.removeHook=function(entryPoint,hookFunction){if(void 0!==hookFunction){const index=arrayLastIndexOf(hooks[entryPoint],hookFunction);return-1===index?void 0:arraySplice(hooks[entryPoint],index,1)[0]}return arrayPop(hooks[entryPoint])},DOMPurify.removeHooks=function(entryPoint){hooks[entryPoint]=[]},DOMPurify.removeAllHooks=function(){hooks={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},DOMPurify}();function toUpperCaseFirst(string){return string[0].toUpperCase()+string.substr(1)}function randomString(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()+s4()+s4()}function isPercentValue(value){return/^([0-9][0-9]?%$)|(^100%$)/.test(value)}function substitute(template){let variables=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${template}`.replace(/(?:\\)?\[([^[\]]+)]/g,((match,name)=>"\\"===match.charAt(0)?match.substr(1,match.length-1):void 0===variables[name]?"":variables[name]))}function stripTags(string){return sanitize(`${string}`,{ALLOWED_TAGS:[]})}function sanitize(string,options){return purify.sanitize(string,options)}},"./node_modules/handsontable/helpers/templateLiteralTag.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{O:()=>toSingleLine});var _helpers_array_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs");function toSingleLine(strings){for(var _len=arguments.length,expressions=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)expressions[_key-1]=arguments[_key];return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_0__.mu)(strings,((previousValue,currentValue,index)=>previousValue+currentValue.replace(/\r?\n\s*/g,"")+(expressions[index]?expressions[index]:"")),"").trim()}},"./node_modules/handsontable/helpers/unicode.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Lb:()=>KEY_CODES,SI:()=>isCtrlMetaKey,Yf:()=>isFunctionKey,aE:()=>isPrintableChar,m0:()=>isKey});__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _array_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs"),_browser_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/helpers/browser.mjs");const KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,_browser_mjs__WEBPACK_IMPORTED_MODULE_1__.gm)()?182:174,AUDIO_MUTE:(0,_browser_mjs__WEBPACK_IMPORTED_MODULE_1__.gm)()?181:173,AUDIO_UP:(0,_browser_mjs__WEBPACK_IMPORTED_MODULE_1__.gm)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FUNCTION_KEYS=[KEY_CODES.ALT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_UP,KEY_CODES.AUDIO_DOWN,KEY_CODES.AUDIO_MUTE,KEY_CODES.AUDIO_UP,KEY_CODES.BACKSPACE,KEY_CODES.CAPS_LOCK,KEY_CODES.DELETE,KEY_CODES.END,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.F13,KEY_CODES.F14,KEY_CODES.F15,KEY_CODES.F16,KEY_CODES.F17,KEY_CODES.F18,KEY_CODES.F19,KEY_CODES.HOME,KEY_CODES.INSERT,KEY_CODES.MEDIA_NEXT,KEY_CODES.MEDIA_PLAY_PAUSE,KEY_CODES.MEDIA_PREV,KEY_CODES.MEDIA_STOP,KEY_CODES.NULL,KEY_CODES.NUM_LOCK,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.PAUSE,KEY_CODES.SCROLL_LOCK,KEY_CODES.SHIFT,KEY_CODES.TAB];function isPrintableChar(keyCode){return 32===keyCode||keyCode>=48&&keyCode<=57||keyCode>=96&&keyCode<=111||keyCode>=186&&keyCode<=192||keyCode>=219&&keyCode<=222||keyCode>=226||keyCode>=65&&keyCode<=90}function isFunctionKey(keyCode){return FUNCTION_KEYS.includes(keyCode)}function isCtrlMetaKey(keyCode){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(keyCode)}function isKey(keyCode,baseCode){const keys=baseCode.split("|");let result=!1;return(0,_array_mjs__WEBPACK_IMPORTED_MODULE_2__.z0)(keys,(key=>{if(keyCode===KEY_CODES[key])return result=!0,!1})),result}},"./node_modules/handsontable/i18n/constants.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CHECKBOX_CHECKED:()=>CHECKBOX_CHECKED,CHECKBOX_RENDERER_NAMESPACE:()=>CHECKBOX_RENDERER_NAMESPACE,CHECKBOX_UNCHECKED:()=>CHECKBOX_UNCHECKED,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT:()=>CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_BORDERS:()=>CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY:()=>CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,CONTEXTMENU_ITEMS_CUT:()=>CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW:()=>CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NO_ITEMS:()=>CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_READ_ONLY:()=>CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_REDO:()=>CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW:()=>CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_SHOW_ROW:()=>CONTEXTMENU_ITEMS_SHOW_ROW,CONTEXTMENU_ITEMS_UNDO:()=>CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXT_MENU_ITEMS_NAMESPACE:()=>CONTEXT_MENU_ITEMS_NAMESPACE,FILTERS_BUTTONS_CANCEL:()=>FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_CLEAR:()=>FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK:()=>FILTERS_BUTTONS_OK,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_SELECT_ALL:()=>FILTERS_BUTTONS_SELECT_ALL,FILTERS_CONDITIONS_AFTER:()=>FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE:()=>FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_BEGINS_WITH:()=>FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_BETWEEN:()=>FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_BY_VALUE:()=>FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_CONTAINS:()=>FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_EMPTY:()=>FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_ENDS_WITH:()=>FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_EQUAL:()=>FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_GREATER_THAN:()=>FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN:()=>FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_NAMESPACE:()=>FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE:()=>FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_NOT_BETWEEN:()=>FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_NOT_CONTAIN:()=>FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_NOT_EMPTY:()=>FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_NOT_EQUAL:()=>FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_TODAY:()=>FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW:()=>FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY:()=>FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION:()=>FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE:()=>FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION:()=>FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION:()=>FILTERS_LABELS_DISJUNCTION,FILTERS_NAMESPACE:()=>FILTERS_NAMESPACE,FILTERS_VALUES_BLANK_CELLS:()=>FILTERS_VALUES_BLANK_CELLS});const CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CONTEXTMENU_ITEMS_NO_ITEMS=`${CONTEXT_MENU_ITEMS_NAMESPACE}.noItems`,CONTEXTMENU_ITEMS_ROW_ABOVE=`${CONTEXT_MENU_ITEMS_NAMESPACE}.insertRowAbove`,CONTEXTMENU_ITEMS_ROW_BELOW=`${CONTEXT_MENU_ITEMS_NAMESPACE}.insertRowBelow`,CONTEXTMENU_ITEMS_INSERT_LEFT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.insertColumnOnTheLeft`,CONTEXTMENU_ITEMS_INSERT_RIGHT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.insertColumnOnTheRight`,CONTEXTMENU_ITEMS_REMOVE_ROW=`${CONTEXT_MENU_ITEMS_NAMESPACE}.removeRow`,CONTEXTMENU_ITEMS_REMOVE_COLUMN=`${CONTEXT_MENU_ITEMS_NAMESPACE}.removeColumn`,CONTEXTMENU_ITEMS_UNDO=`${CONTEXT_MENU_ITEMS_NAMESPACE}.undo`,CONTEXTMENU_ITEMS_REDO=`${CONTEXT_MENU_ITEMS_NAMESPACE}.redo`,CONTEXTMENU_ITEMS_READ_ONLY=`${CONTEXT_MENU_ITEMS_NAMESPACE}.readOnly`,CONTEXTMENU_ITEMS_CLEAR_COLUMN=`${CONTEXT_MENU_ITEMS_NAMESPACE}.clearColumn`,CONTEXTMENU_ITEMS_COPY=`${CONTEXT_MENU_ITEMS_NAMESPACE}.copy`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS=`${CONTEXT_MENU_ITEMS_NAMESPACE}.copyWithHeaders`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS=`${CONTEXT_MENU_ITEMS_NAMESPACE}.copyWithGroupHeaders`,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY=`${CONTEXT_MENU_ITEMS_NAMESPACE}.copyHeadersOnly`,CONTEXTMENU_ITEMS_CUT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.cut`,CONTEXTMENU_ITEMS_FREEZE_COLUMN=`${CONTEXT_MENU_ITEMS_NAMESPACE}.freezeColumn`,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=`${CONTEXT_MENU_ITEMS_NAMESPACE}.unfreezeColumn`,CONTEXTMENU_ITEMS_MERGE_CELLS=`${CONTEXT_MENU_ITEMS_NAMESPACE}.mergeCells`,CONTEXTMENU_ITEMS_UNMERGE_CELLS=`${CONTEXT_MENU_ITEMS_NAMESPACE}.unmergeCells`,CONTEXTMENU_ITEMS_ADD_COMMENT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.addComment`,CONTEXTMENU_ITEMS_EDIT_COMMENT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.editComment`,CONTEXTMENU_ITEMS_REMOVE_COMMENT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.removeComment`,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.readOnlyComment`,CONTEXTMENU_ITEMS_ALIGNMENT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.align`,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.align.left`,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=`${CONTEXT_MENU_ITEMS_NAMESPACE}.align.center`,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.align.right`,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=`${CONTEXT_MENU_ITEMS_NAMESPACE}.align.justify`,CONTEXTMENU_ITEMS_ALIGNMENT_TOP=`${CONTEXT_MENU_ITEMS_NAMESPACE}.align.top`,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=`${CONTEXT_MENU_ITEMS_NAMESPACE}.align.middle`,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=`${CONTEXT_MENU_ITEMS_NAMESPACE}.align.bottom`,CONTEXTMENU_ITEMS_BORDERS=`${CONTEXT_MENU_ITEMS_NAMESPACE}.borders`,CONTEXTMENU_ITEMS_BORDERS_TOP=`${CONTEXT_MENU_ITEMS_NAMESPACE}.borders.top`,CONTEXTMENU_ITEMS_BORDERS_RIGHT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.borders.right`,CONTEXTMENU_ITEMS_BORDERS_BOTTOM=`${CONTEXT_MENU_ITEMS_NAMESPACE}.borders.bottom`,CONTEXTMENU_ITEMS_BORDERS_LEFT=`${CONTEXT_MENU_ITEMS_NAMESPACE}.borders.left`,CONTEXTMENU_ITEMS_REMOVE_BORDERS=`${CONTEXT_MENU_ITEMS_NAMESPACE}.borders.remove`,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=`${CONTEXT_MENU_ITEMS_NAMESPACE}.nestedHeaders.insertChildRow`,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=`${CONTEXT_MENU_ITEMS_NAMESPACE}.nestedHeaders.detachFromParent`,CONTEXTMENU_ITEMS_HIDE_COLUMN=`${CONTEXT_MENU_ITEMS_NAMESPACE}.hideColumn`,CONTEXTMENU_ITEMS_SHOW_COLUMN=`${CONTEXT_MENU_ITEMS_NAMESPACE}.showColumn`,CONTEXTMENU_ITEMS_HIDE_ROW=`${CONTEXT_MENU_ITEMS_NAMESPACE}.hideRow`,CONTEXTMENU_ITEMS_SHOW_ROW=`${CONTEXT_MENU_ITEMS_NAMESPACE}.showRow`,FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE=`${FILTERS_NAMESPACE}conditions`,FILTERS_CONDITIONS_NONE=`${FILTERS_CONDITIONS_NAMESPACE}.none`,FILTERS_CONDITIONS_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isEmpty`,FILTERS_CONDITIONS_NOT_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEmpty`,FILTERS_CONDITIONS_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isEqualTo`,FILTERS_CONDITIONS_NOT_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEqualTo`,FILTERS_CONDITIONS_BEGINS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.beginsWith`,FILTERS_CONDITIONS_ENDS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.endsWith`,FILTERS_CONDITIONS_CONTAINS=`${FILTERS_CONDITIONS_NAMESPACE}.contains`,FILTERS_CONDITIONS_NOT_CONTAIN=`${FILTERS_CONDITIONS_NAMESPACE}.doesNotContain`,FILTERS_CONDITIONS_BY_VALUE=`${FILTERS_CONDITIONS_NAMESPACE}.byValue`,FILTERS_CONDITIONS_GREATER_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThan`,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThanOrEqualTo`,FILTERS_CONDITIONS_LESS_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.lessThan`,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.lessThanOrEqualTo`,FILTERS_CONDITIONS_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isBetween`,FILTERS_CONDITIONS_NOT_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isNotBetween`,FILTERS_CONDITIONS_AFTER=`${FILTERS_CONDITIONS_NAMESPACE}.after`,FILTERS_CONDITIONS_BEFORE=`${FILTERS_CONDITIONS_NAMESPACE}.before`,FILTERS_CONDITIONS_TODAY=`${FILTERS_CONDITIONS_NAMESPACE}.today`,FILTERS_CONDITIONS_TOMORROW=`${FILTERS_CONDITIONS_NAMESPACE}.tomorrow`,FILTERS_CONDITIONS_YESTERDAY=`${FILTERS_CONDITIONS_NAMESPACE}.yesterday`,FILTERS_DIVS_FILTER_BY_CONDITION=`${FILTERS_NAMESPACE}labels.filterByCondition`,FILTERS_DIVS_FILTER_BY_VALUE=`${FILTERS_NAMESPACE}labels.filterByValue`,FILTERS_LABELS_CONJUNCTION=`${FILTERS_NAMESPACE}labels.conjunction`,FILTERS_LABELS_DISJUNCTION=`${FILTERS_NAMESPACE}labels.disjunction`,FILTERS_VALUES_BLANK_CELLS=`${FILTERS_NAMESPACE}values.blankCells`,FILTERS_BUTTONS_SELECT_ALL=`${FILTERS_NAMESPACE}buttons.selectAll`,FILTERS_BUTTONS_CLEAR=`${FILTERS_NAMESPACE}buttons.clear`,FILTERS_BUTTONS_OK=`${FILTERS_NAMESPACE}buttons.ok`,FILTERS_BUTTONS_CANCEL=`${FILTERS_NAMESPACE}buttons.cancel`,FILTERS_BUTTONS_PLACEHOLDER_SEARCH=`${FILTERS_NAMESPACE}buttons.placeholder.search`,FILTERS_BUTTONS_PLACEHOLDER_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.value`,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.secondValue`,CHECKBOX_RENDERER_NAMESPACE="CheckboxRenderer:",CHECKBOX_CHECKED=`${CHECKBOX_RENDERER_NAMESPACE}checked`,CHECKBOX_UNCHECKED=`${CHECKBOX_RENDERER_NAMESPACE}unchecked`},"./node_modules/handsontable/mixins/localHooks.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _helpers_object_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/object.mjs"),_helpers_function_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/helpers/function.mjs");const localHooks={_localHooks:Object.create(null),addLocalHook(key,callback){return this._localHooks[key]||(this._localHooks[key]=[]),this._localHooks[key].push(callback),this},runLocalHooks(key,arg1,arg2,arg3,arg4,arg5,arg6){if(this._localHooks[key]){const length=this._localHooks[key].length;for(let i=0;i<length;i++)(0,_helpers_function_mjs__WEBPACK_IMPORTED_MODULE_1__.Ty)(this._localHooks[key][i],this,arg1,arg2,arg3,arg4,arg5,arg6)}},clearLocalHooks(){return this._localHooks={},this}};(0,_helpers_object_mjs__WEBPACK_IMPORTED_MODULE_2__.LH)(localHooks,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const __WEBPACK_DEFAULT_EXPORT__=localHooks},"./node_modules/handsontable/plugins/registry.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{sd:()=>getPlugin,f4:()=>getPluginsNames,Mt:()=>hasPlugin,F3:()=>registerPlugin});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js");var string=__webpack_require__("./node_modules/handsontable/helpers/string.mjs"),number=(__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./node_modules/handsontable/helpers/number.mjs")),helpers_function=__webpack_require__("./node_modules/handsontable/helpers/function.mjs");const ORDER_MAP=new Map([["asc",[-1,1]],["desc",[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=priority=>`The priority '${priority}' is already declared in a map.`,DEFAULT_ERROR_PRIORITY_NAN=priority=>`The priority '${priority}' is not a number.`;var uniqueMap=__webpack_require__("./node_modules/handsontable/utils/dataStructures/uniqueMap.mjs");__webpack_require__("./node_modules/core-js/modules/es.set.difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.intersection.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-subset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-superset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.symmetric-difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.union.v2.js");const DEFAULT_ERROR_ITEM_EXISTS=item=>`'${item}' value is already declared in a unique set.`;const ERROR_PLUGIN_REGISTERED=pluginName=>`There is already registered "${pluginName}" plugin.`,priorityPluginsQueue=function createPriorityMap(){let{errorPriorityExists,errorPriorityNaN}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const priorityMap=new Map;return errorPriorityExists=(0,helpers_function.Tn)(errorPriorityExists)?errorPriorityExists:DEFAULT_ERROR_PRIORITY_EXISTS,errorPriorityNaN=(0,helpers_function.Tn)(errorPriorityNaN)?errorPriorityNaN:DEFAULT_ERROR_PRIORITY_NAN,{addItem:function addItem(priority,item){if(!(0,number.kf)(priority))throw new Error(errorPriorityNaN(priority));if(priorityMap.has(priority))throw new Error(errorPriorityExists(priority));priorityMap.set(priority,item)},getItems:function getItems(){let order=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc";const[left,right]=ORDER_MAP.get(order)||ORDER_MAP.get("asc");return[...priorityMap].sort(((a,b)=>a[0]<b[0]?left:right)).map((item=>item[1]))}}}({errorPriorityExists:priority=>`There is already registered plugin on priority "${priority}".`,errorPriorityNaN:priority=>`The priority "${priority}" is not a number.`}),uniquePluginsQueue=function createUniqueSet(){let{errorItemExists}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const uniqueSet=new Set;return errorItemExists=(0,helpers_function.Tn)(errorItemExists)?errorItemExists:DEFAULT_ERROR_ITEM_EXISTS,{addItem:function addItem(item){if(uniqueSet.has(item))throw new Error(errorItemExists(item));uniqueSet.add(item)},clear:function clear(){uniqueSet.clear()},getItems:function getItems(){return[...uniqueSet]}}}({errorItemExists:ERROR_PLUGIN_REGISTERED}),uniquePluginsList=(0,uniqueMap.u)({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[...priorityPluginsQueue.getItems(),...uniquePluginsQueue.getItems()]}function getPlugin(pluginName){const unifiedPluginName=(0,string.Ob)(pluginName);return uniquePluginsList.getItem(unifiedPluginName)}function hasPlugin(pluginName){return!!getPlugin(pluginName)}function registerPlugin(pluginName,pluginClass,priority){[pluginName,pluginClass,priority]=function unifyPluginArguments(pluginName,pluginClass,priority){"function"==typeof pluginName&&(pluginName=(pluginClass=pluginName).PLUGIN_KEY,priority=pluginClass.PLUGIN_PRIORITY);return[pluginName,pluginClass,priority]}(pluginName,pluginClass,priority),void 0===getPlugin(pluginName)&&function _registerPlugin(pluginName,pluginClass,priority){const unifiedPluginName=(0,string.Ob)(pluginName);if(uniquePluginsList.hasItem(unifiedPluginName))throw new Error(ERROR_PLUGIN_REGISTERED(unifiedPluginName));void 0===priority?uniquePluginsQueue.addItem(unifiedPluginName):priorityPluginsQueue.addItem(priority,unifiedPluginName);uniquePluginsList.addItem(unifiedPluginName,pluginClass)}(pluginName,pluginClass,priority)}},"./node_modules/handsontable/registry.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{um:()=>registerAllModules});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js");var textEditor=__webpack_require__("./node_modules/handsontable/editors/textEditor/textEditor.mjs"),dom_element=__webpack_require__("./node_modules/handsontable/helpers/dom/element.mjs"),dom_event=__webpack_require__("./node_modules/handsontable/helpers/dom/event.mjs"),object=__webpack_require__("./node_modules/handsontable/helpers/object.mjs"),constants=__webpack_require__("./node_modules/handsontable/shortcutContexts/constants.mjs");class HandsontableEditor extends textEditor.t{static get EDITOR_TYPE(){return"handsontable"}open(){super.open();const containerStyle=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),containerStyle.width="",containerStyle.height="",containerStyle.overflow=""),"none"===containerStyle.display&&(containerStyle.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,dom_element.vZ)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(row,col,prop,td,value,cellProperties){super.prepare(row,col,prop,td,value,cellProperties);const parent=this,options={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(_,coords){const sourceValue=this.getSourceData(coords.row,coords.col);void 0!==sourceValue&&parent.setValue(sourceValue),parent.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,object.X$)(options,cellProperties.handsontable),this.htOptions=options}beginEditing(newInitialValue,event){const onBeginEditing=this.hot.getSettings().onBeginEditing;onBeginEditing&&!1===onBeginEditing()||super.beginEditing(newInitialValue,event)}createElements(){super.createElements();const DIV=this.hot.rootDocument.createElement("DIV");DIV.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(DIV),this.htContainer=DIV,this.assignHooks()}finishEditing(restoreOriginalValue,ctrlDown,callback){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const value=this.htEditor.getValue();void 0!==value&&this.setValue(value)}super.finishEditing(restoreOriginalValue,ctrlDown,callback)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",(()=>{var _this$htEditor;null===(_this$htEditor=this.htEditor)||void 0===_this$htEditor||_this$htEditor.destroy()})),this.hot.addHook("afterSetTheme",((themeName,firstRun)=>{var _this$htEditor2;firstRun||(null===(_this$htEditor2=this.htEditor)||void 0===_this$htEditor2||_this$htEditor2.useTheme(themeName))}))}registerShortcuts(){const editorContext=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const contextConfig={group:"handsontableEditor",relativeToGroup:constants.b,position:"before"},action=(rowToSelect,event)=>{const innerHOT=this.htEditor;if(void 0!==rowToSelect&&(rowToSelect<0||innerHOT.flipped&&rowToSelect>innerHOT.countRows()-1?innerHOT.deselectCell():innerHOT.selectCell(rowToSelect,0),innerHOT.getData().length))return event.preventDefault(),(0,dom_event.CA)(event),this.hot.listen(),this.TEXTAREA.focus(),!1};editorContext.addShortcuts([{keys:[["ArrowUp"]],callback:event=>{const innerHOT=this.htEditor;let rowToSelect,selectedRow;return!innerHOT.getSelectedLast()&&innerHOT.flipped?rowToSelect=innerHOT.countRows()-1:innerHOT.getSelectedLast()&&(innerHOT.flipped?(selectedRow=innerHOT.getSelectedLast()[0],rowToSelect=Math.max(0,selectedRow-1)):(selectedRow=innerHOT.getSelectedLast()[0],rowToSelect=selectedRow-1)),action(rowToSelect,event)},preventDefault:!1},{keys:[["ArrowDown"]],callback:event=>{const innerHOT=this.htEditor;let rowToSelect,selectedRow;if(innerHOT.getSelectedLast()||innerHOT.flipped){if(innerHOT.getSelectedLast())if(innerHOT.flipped)rowToSelect=innerHOT.getSelectedLast()[0]+1;else if(!innerHOT.flipped){const lastRow=innerHOT.countRows()-1;selectedRow=innerHOT.getSelectedLast()[0],rowToSelect=Math.min(lastRow,selectedRow+1)}}else rowToSelect=0;return action(rowToSelect,event)},preventDefault:!1}],contextConfig)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup("handsontableEditor")}}var array=__webpack_require__("./node_modules/handsontable/helpers/array.mjs"),mixed=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs"),string=__webpack_require__("./node_modules/handsontable/helpers/string.mjs"),unicode=__webpack_require__("./node_modules/handsontable/helpers/unicode.mjs"),textRenderer=__webpack_require__("./node_modules/handsontable/renderers/textRenderer/textRenderer.mjs"),a11y=__webpack_require__("./node_modules/handsontable/helpers/a11y.mjs");function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _classPrivateFieldGet(s,a){return s.get(_assertClassBrand(s,a))}function _assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _idPrefix=new WeakMap,_AutocompleteEditor_brand=new WeakSet;class AutocompleteEditor extends HandsontableEditor{constructor(){super(...arguments),function _classPrivateMethodInitSpec(e,a){_checkPrivateRedeclaration(e,a),a.add(e)}(this,_AutocompleteEditor_brand),_defineProperty(this,"query",null),_defineProperty(this,"strippedChoices",[]),_defineProperty(this,"rawChoices",[]),function _classPrivateFieldInitSpec(e,t,a){_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_idPrefix,this.hot.guid.slice(0,9)),_defineProperty(this,"sortByRelevance",(function(value,choices,caseSensitive){const choicesRelevance=[],result=[],valueLength=value.length;let charsLeft,currentItem,i,valueIndex,choicesCount=choices.length;if(0===valueLength){for(i=0;i<choicesCount;i++)result.push(i);return result}for(i=0;i<choicesCount;i++){if(currentItem=(0,string.Kq)((0,mixed.As)(choices[i])),caseSensitive)valueIndex=currentItem.indexOf(value);else{const locale=this.cellProperties.locale;valueIndex=currentItem.toLocaleLowerCase(locale).indexOf(value.toLocaleLowerCase(locale))}-1!==valueIndex&&(charsLeft=currentItem.length-valueIndex-valueLength,choicesRelevance.push({baseIndex:i,index:valueIndex,charsLeft,value:currentItem}))}for(choicesRelevance.sort(((a,b)=>{if(-1===b.index)return-1;if(-1===a.index)return 1;if(a.index<b.index)return-1;if(b.index<a.index)return 1;if(a.index===b.index){if(a.charsLeft<b.charsLeft)return-1;if(a.charsLeft>b.charsLeft)return 1}return 0})),i=0,choicesCount=choicesRelevance.length;i<choicesCount;i++)result.push(choicesRelevance[i].baseIndex);return result}))}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const selectedValue=this.rawChoices.find((value=>this.stripValueIfNeeded(value)===this.TEXTAREA.value));return(0,mixed.O9)(selectedValue)?selectedValue:this.TEXTAREA.value}createElements(){super.createElements(),(0,dom_element.iQ)(this.htContainer,"autocompleteEditor"),(0,dom_element.iQ)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&(0,dom_element.Bq)(this.TEXTAREA,[(0,a11y.ZW)(),(0,a11y.B6)(),(0,a11y.wP)("listbox"),(0,a11y.gq)()])}prepare(row,col,prop,td,value,cellProperties){super.prepare(row,col,prop,td,value,cellProperties),this.hot.getSettings().ariaTags&&(0,dom_element.Bq)(this.TEXTAREA,[(0,a11y.dV)("false"),(0,a11y.Ku)(`${_classPrivateFieldGet(_idPrefix,this)}-listbox-${row}-${col}`)])}open(){super.open();const trimDropdown=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,rootInstanceAriaTagsEnabled=this.hot.getSettings().ariaTags,sourceArray=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,sourceSize=null==sourceArray?void 0:sourceArray.length,{row:rowIndex,col:colIndex}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",(event=>this.onBeforeKeyDown(event))),this.htEditor.updateSettings({colWidths:trimDropdown?[(0,dom_element.Gq)(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(hotInstance,TD,row,col,prop,value,cellProperties)=>{(0,textRenderer.F)(hotInstance,TD,row,col,prop,value,cellProperties);const{filteringCaseSensitive,allowHtml,locale}=this.cellProperties,query=this.query;let indexOfMatch,match,cellValue=(0,mixed.As)(value);cellValue&&!allowHtml&&(indexOfMatch=!0===filteringCaseSensitive?cellValue.indexOf(query):cellValue.toLocaleLowerCase(locale).indexOf(query.toLocaleLowerCase(locale)),-1!==indexOfMatch&&(match=cellValue.substr(indexOfMatch,query.length),cellValue=cellValue.replace(match,`<strong>${match}</strong>`))),rootInstanceAriaTagsEnabled&&(0,dom_element.Bq)(TD,[(0,a11y.n)(),...sourceArray?[(0,a11y.DY)(sourceSize)]:[],...sourceArray?[(0,a11y.Vy)(sourceArray.indexOf(value)+1)]:[],["id",`${this.htEditor.rootElement.id}_${row}-${col}`]]),TD.innerHTML=cellValue},afterSelectionEnd:(startRow,startCol)=>{if(rootInstanceAriaTagsEnabled){const TD=this.htEditor.getCell(startRow,startCol,!0);(0,dom_element.Bq)(TD,[(0,a11y.H0)()]),(0,dom_element.Bq)(this.TEXTAREA,...(0,a11y.VN)(TD.id))}}}),rootInstanceAriaTagsEnabled&&((0,dom_element.Bq)(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...(0,a11y.gg)()),(0,dom_element.Bq)(this.htEditor.rootElement,[(0,a11y.$o)(),(0,a11y.S2)("polite"),(0,a11y.rE)("text"),["id",`${_classPrivateFieldGet(_idPrefix,this)}-listbox-${rowIndex}-${colIndex}`]]),(0,dom_element.Bq)(this.TEXTAREA,...(0,a11y.dV)("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&(0,dom_element.Bq)(this.TEXTAREA,[(0,a11y.dV)("false")])}discardEditor(result){super.discardEditor(result),this.hot.view.render()}queryChoices(query){const source=this.cellProperties.source;this.query=query,"function"==typeof source?source.call(this.cellProperties,query,(choices=>{this.rawChoices=choices,this.updateChoicesList(this.stripValuesIfNeeded(choices))})):Array.isArray(source)?(this.rawChoices=source,this.updateChoicesList(this.stripValuesIfNeeded(source))):this.updateChoicesList([])}updateChoicesList(choicesList){const pos=(0,dom_element.JC)(this.TEXTAREA),endPos=(0,dom_element.Xu)(this.TEXTAREA),sortByRelevanceSetting=this.cellProperties.sortByRelevance,filterSetting=this.cellProperties.filter;let orderByRelevance=null,highlightIndex=null,choices=choicesList;sortByRelevanceSetting&&(orderByRelevance=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),choices,this.cellProperties.filteringCaseSensitive));const orderByRelevanceLength=Array.isArray(orderByRelevance)?orderByRelevance.length:0;if(!1===filterSetting)highlightIndex=orderByRelevanceLength>0?orderByRelevance[0]:0;else{const sorted=[];for(let i=0,choicesCount=choices.length;i<choicesCount&&!(sortByRelevanceSetting&&orderByRelevanceLength<=i);i++)orderByRelevanceLength?sorted.push(choices[orderByRelevance[i]]):sorted.push(choices[i]);highlightIndex=0,choices=sorted}this.strippedChoices=choices,0===choices.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData((0,array.h9)([choices])),choices.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(highlightIndex)),this.hot.listen(),(0,dom_element.vZ)(this.TEXTAREA,pos,pos===endPos?void 0:endPos)}flipDropdownIfNeeded(){const editorRect=this.getEditedCellRect(),editorHeight=editorRect.height;let spaceAbove=editorRect.top;if(this.hot.view.isVerticallyScrollableByWindow()){const topOffset=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;spaceAbove=Math.max(spaceAbove+topOffset,0)}const dropdownHeight=this.getHeight(),spaceBelow=this.hot.view.getWorkspaceHeight()-spaceAbove-editorHeight,flipNeeded=dropdownHeight>spaceBelow&&spaceAbove>spaceBelow+editorHeight;return flipNeeded?this.flipDropdown(dropdownHeight):this.unflipDropdown(),this.limitDropdownIfNeeded(flipNeeded?spaceAbove:spaceBelow,dropdownHeight),flipNeeded}limitDropdownIfNeeded(spaceAvailable,dropdownHeight){if(dropdownHeight>spaceAvailable){let tempHeight=0,i=0,lastRowHeight=0,height=null;do{lastRowHeight=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),tempHeight+=lastRowHeight,i+=1}while(tempHeight<spaceAvailable);height=tempHeight-lastRowHeight,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+dropdownHeight-height+"px"),this.setDropdownHeight(tempHeight-lastRowHeight)}}flipDropdown(dropdownHeight){const dropdownStyle=this.htEditor.rootElement.style;dropdownStyle.position="absolute",dropdownStyle.top=-dropdownHeight+"px",this.htEditor.flipped=!0}unflipDropdown(){const dropdownStyle=this.htEditor.rootElement.style;dropdownStyle.position="absolute",dropdownStyle.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),_assertClassBrand(_AutocompleteEditor_brand,this,_fixDropdownWidth).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(height){this.htEditor.updateSettings({height}),_assertClassBrand(_AutocompleteEditor_brand,this,_fixDropdownWidth).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(index){"number"==typeof index?this.htEditor.selectCell(index,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const containerStyle=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),borderVerticalCompensation=parseInt(containerStyle.borderTopWidth,10)+parseInt(containerStyle.borderBottomWidth,10),maxItems=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:maxItems},((_,i)=>i)).reduce(((h,index)=>h+this.htEditor.getRowHeight(index)),0)+borderVerticalCompensation+1}getWidth(){const containerStyle=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),borderHorizontalCompensation=parseInt(containerStyle.borderInlineStartWidth,10)+parseInt(containerStyle.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+borderHorizontalCompensation}stripValueIfNeeded(value){return this.stripValuesIfNeeded([value])[0]}stripValuesIfNeeded(values){const{allowHtml}=this.cellProperties,stringifiedValues=(0,array.YD)(values,(value=>(0,mixed.As)(value)));return(0,array.YD)(stringifiedValues,(value=>allowHtml?value:(0,string.Kq)(value)))}allowKeyEventPropagation(keyCode){const selectedRange=this.htEditor.getSelectedRangeLast(),selected_row=selectedRange?selectedRange.from.row:-1;let allowed=!1;return keyCode===unicode.Lb.ARROW_DOWN&&selected_row>0&&selected_row<this.htEditor.countRows()-1&&(allowed=!0),keyCode===unicode.Lb.ARROW_UP&&selected_row>-1&&(allowed=!0),allowed}onBeforeKeyDown(event){if((0,unicode.aE)(event.keyCode)||event.keyCode===unicode.Lb.BACKSPACE||event.keyCode===unicode.Lb.DELETE||event.keyCode===unicode.Lb.INSERT){let timeOffset=10;if(event.keyCode===unicode.Lb.C&&(event.ctrlKey||event.metaKey))return;this.isOpened()||(timeOffset+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),timeOffset)}}}function _fixDropdownWidth(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+(0,dom_element.XJ)(this.hot.rootDocument)})}var baseEditor=__webpack_require__("./node_modules/handsontable/editors/baseEditor/baseEditor.mjs");class CheckboxEditor extends baseEditor.b7{static get EDITOR_TYPE(){return"checkbox"}beginEditing(initialValue,event){if(event&&"mouseup"===event.type&&"TD"===event.target.nodeName){const checkbox=this.TD.querySelector('input[type="checkbox"]');(0,dom_element.nB)(checkbox,"htBadValue")||checkbox.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var moment=__webpack_require__("./node_modules/moment/moment.js"),moment_default=__webpack_require__.n(moment);const getWindow=()=>window,getDocument=()=>window.document,sto=(fn,delay)=>window.setTimeout(fn,delay),addEvent=function(el,e,callback,capture){el.addEventListener(e,callback,!!capture)},removeEvent=function(el,e,callback,capture){el.removeEventListener(e,callback,!!capture)},hasClass=function(el,cn){return-1!==(" "+el.className+" ").indexOf(" "+cn+" ")},addClass=function(el,cn){hasClass(el,cn)||(el.className=""===el.className?cn:el.className+" "+cn)},removeClass=function(el,cn){var str;el.className=(str=(" "+el.className+" ").replace(" "+cn+" "," ")).trim?str.trim():str.replace(/^\s+|\s+$/g,"")},isArray=function(obj){return/Array/.test(Object.prototype.toString.call(obj))},isDate=function(obj){return/Date/.test(Object.prototype.toString.call(obj))&&!isNaN(obj.getTime())},isWeekend=function(date){let day=date.getDay();return 0===day||6===day},isLeapYear=function(year){return year%4==0&&year%100!=0||year%400==0},getDaysInMonth=function(year,month){return[31,isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month]},setToStartOfDay=function(date){isDate(date)&&date.setHours(0,0,0,0)},compareDates=function(a,b){return a.getTime()===b.getTime()},extend=function(to,from,overwrite){let prop,hasProp;for(prop in from)hasProp=void 0!==to[prop],hasProp&&"object"==typeof from[prop]&&null!==from[prop]&&void 0===from[prop].nodeName?isDate(from[prop])?overwrite&&(to[prop]=new Date(from[prop].getTime())):isArray(from[prop])?overwrite&&(to[prop]=from[prop].slice(0)):to[prop]=extend({},from[prop],overwrite):!overwrite&&hasProp||(to[prop]=from[prop]);return to},fireEvent=function(el,eventName,data){let ev=getDocument().createEvent("HTMLEvents");ev.initEvent(eventName,!0,!1),ev=extend(ev,data),el.dispatchEvent(ev)},adjustCalendar=function(calendar){return calendar.month<0&&(calendar.year-=Math.ceil(Math.abs(calendar.month)/12),calendar.month+=12),calendar.month>11&&(calendar.year+=Math.floor(Math.abs(calendar.month)/12),calendar.month-=12),calendar},defaults={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},renderDayName=function(opts,day,abbr){for(day+=opts.firstDay;day>=7;)day-=7;return abbr?opts.i18n.weekdaysShort[day]:opts.i18n.weekdays[day]},renderDay=function(opts){let arr=[],ariaSelected="false";if(opts.isEmpty){if(!opts.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';arr.push("is-outside-current-month"),opts.enableSelectionDaysInNextAndPreviousMonths||arr.push("is-selection-disabled")}return opts.isDisabled&&arr.push("is-disabled"),opts.isToday&&arr.push("is-today"),opts.isSelected&&(arr.push("is-selected"),ariaSelected="true"),opts.hasEvent&&arr.push("has-event"),opts.isInRange&&arr.push("is-inrange"),opts.isStartRange&&arr.push("is-startrange"),opts.isEndRange&&arr.push("is-endrange"),'<td data-day="'+opts.day+'" class="'+arr.join(" ")+'" aria-selected="'+ariaSelected+'"><button class="pika-button pika-day" type="button" data-pika-year="'+opts.year+'" data-pika-month="'+opts.month+'" data-pika-day="'+opts.day+'">'+opts.day+"</button></td>"},renderWeek=function(pikaday,d,m,y,firstWeekOfYearMinDays){let date=new Date(y,m,d),week=pikaday.hasMoment?pikaday.moment(date).isoWeek():function(date,firstWeekOfYearMinDays){date.setHours(0,0,0,0);let yearDay=date.getDate(),weekDay=date.getDay(),dayInFirstWeek=firstWeekOfYearMinDays,dayShift=dayInFirstWeek-1,prevWeekDay=function(day){return(day+7-1)%7};date.setDate(yearDay+dayShift-prevWeekDay(weekDay));let jan4th=new Date(date.getFullYear(),0,dayInFirstWeek),daysBetween=(date.getTime()-jan4th.getTime())/864e5;return 1+Math.round((daysBetween-dayShift+prevWeekDay(jan4th.getDay()))/7)}(date,firstWeekOfYearMinDays);return'<td class="pika-week">'+week+"</td>"},renderRow=function(days,isRTL,pickWholeWeek,isRowSelected){return'<tr class="pika-row'+(pickWholeWeek?" pick-whole-week":"")+(isRowSelected?" is-selected":"")+'">'+(isRTL?days.reverse():days).join("")+"</tr>"},renderTitle=function(instance,c,year,month,refYear,randId){let i,j,arr,monthHtml,yearHtml,opts=instance._o,isMinYear=year===opts.minYear,isMaxYear=year===opts.maxYear,html='<div id="'+randId+'" class="pika-title" role="heading" aria-live="polite">',prev=!0,next=!0;for(arr=[],i=0;i<12;i++)arr.push('<option value="'+(year===refYear?i-c:12+i-c)+'"'+(i===month?' selected="selected"':"")+(isMinYear&&i<opts.minMonth||isMaxYear&&i>opts.maxMonth?' disabled="disabled"':"")+">"+opts.i18n.months[i]+"</option>");for(monthHtml='<div class="pika-label">'+opts.i18n.months[month]+'<select class="pika-select pika-select-month" tabindex="-1">'+arr.join("")+"</select></div>",isArray(opts.yearRange)?(i=opts.yearRange[0],j=opts.yearRange[1]+1):(i=year-opts.yearRange,j=1+year+opts.yearRange),arr=[];i<j&&i<=opts.maxYear;i++)i>=opts.minYear&&arr.push('<option value="'+i+'"'+(i===year?' selected="selected"':"")+">"+i+"</option>");return yearHtml='<div class="pika-label">'+year+opts.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+arr.join("")+"</select></div>",opts.showMonthAfterYear?html+=yearHtml+monthHtml:html+=monthHtml+yearHtml,isMinYear&&(0===month||opts.minMonth>=month)&&(prev=!1),isMaxYear&&(11===month||opts.maxMonth<=month)&&(next=!1),0===c&&(html+='<button class="pika-prev'+(prev?"":" is-disabled")+'" type="button">'+opts.i18n.previousMonth+"</button>"),c===instance._o.numberOfMonths-1&&(html+='<button class="pika-next'+(next?"":" is-disabled")+'" type="button">'+opts.i18n.nextMonth+"</button>"),html+"</div>"},renderTable=function(opts,data,randId){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+randId+'">'+function(opts){let i,arr=[];for(opts.showWeekNumber&&arr.push("<th></th>"),i=0;i<7;i++)arr.push('<th scope="col"><abbr title="'+renderDayName(opts,i)+'">'+renderDayName(opts,i,!0)+"</abbr></th>");return"<thead><tr>"+(opts.isRTL?arr.reverse():arr).join("")+"</tr></thead>"}(opts)+("<tbody>"+data.join("")+"</tbody></table>")};function Pikaday(options){let self=this,opts=self.config(options);self._onMouseDown=function(e){if(!self._v)return;let target=(e=e||getWindow().event).target||e.srcElement;if(target)if(hasClass(target,"is-disabled")||(!hasClass(target,"pika-button")||hasClass(target,"is-empty")||hasClass(target.parentNode,"is-disabled")?hasClass(target,"pika-prev")?self.prevMonth():hasClass(target,"pika-next")&&self.nextMonth():(self.setDate(new Date(target.getAttribute("data-pika-year"),target.getAttribute("data-pika-month"),target.getAttribute("data-pika-day"))),opts.bound&&sto((function(){self.hide(),opts.blurFieldOnSelect&&opts.field&&opts.field.blur()}),100))),hasClass(target,"pika-select"))self._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},self._onChange=function(e){let target=(e=e||getWindow().event).target||e.srcElement;target&&(hasClass(target,"pika-select-month")?self.gotoMonth(target.value):hasClass(target,"pika-select-year")&&self.gotoYear(target.value))},self._onKeyChange=function(e){if(e=e||getWindow().event,self.isVisible())switch(e.keyCode){case 13:case 27:opts.field&&opts.field.blur();break;case 37:self.adjustDate("subtract",1);break;case 38:self.adjustDate("subtract",7);break;case 39:self.adjustDate("add",1);break;case 40:self.adjustDate("add",7);break;case 8:case 46:self.setDate(null)}},self._parseFieldValue=function(){if(opts.parse)return opts.parse(opts.field.value,opts.format);if(this.hasMoment){let date=this.moment(opts.field.value,opts.format,opts.formatStrict);return date&&date.isValid()?date.toDate():null}return new Date(Date.parse(opts.field.value))},self._onInputChange=function(e){let date;e.firedBy!==self&&(date=self._parseFieldValue(),isDate(date)&&self.setDate(date),self._v||self.show())},self._onInputFocus=function(){self.show()},self._onInputClick=function(){self.show()},self._onInputBlur=function(){let pEl=getDocument().activeElement;do{if(hasClass(pEl,"pika-single"))return}while(pEl=pEl.parentNode);self._c||(self._b=sto((function(){self.hide()}),50)),self._c=!1},self._onClick=function(e){let target=(e=e||getWindow().event).target||e.srcElement,pEl=target;if(target){!hasEventListeners&&hasClass(target,"pika-select")&&(target.onchange||(target.setAttribute("onchange","return;"),addEvent(target,"change",self._onChange)));do{if(hasClass(pEl,"pika-single")||pEl===opts.trigger)return}while(pEl=pEl.parentNode);self._v&&target!==opts.trigger&&pEl!==opts.trigger&&self.hide()}},self.el=getDocument().createElement("div"),self.el.className="pika-single"+(opts.isRTL?" is-rtl":"")+(opts.theme?" "+opts.theme:""),addEvent(self.el,"mousedown",self._onMouseDown,!0),addEvent(self.el,"touchend",self._onMouseDown,!0),addEvent(self.el,"change",self._onChange),opts.keyboardInput&&addEvent(getDocument(),"keydown",self._onKeyChange),opts.field&&(opts.container?opts.container.appendChild(self.el):opts.bound?getDocument().body.appendChild(self.el):opts.field.parentNode.insertBefore(self.el,opts.field.nextSibling),addEvent(opts.field,"change",self._onInputChange),opts.defaultDate||(opts.defaultDate=self._parseFieldValue(),opts.setDefaultDate=!0));let defDate=opts.defaultDate;isDate(defDate)?opts.setDefaultDate?self.setDate(defDate,!0):self.gotoDate(defDate):self.gotoDate(new Date),opts.bound?(this.hide(),self.el.className+=" is-bound",addEvent(opts.trigger,"click",self._onInputClick),addEvent(opts.trigger,"focus",self._onInputFocus),addEvent(opts.trigger,"blur",self._onInputBlur)):this.show()}Pikaday.prototype={config:function(options){this._o||(this._o=extend({},defaults,!0));let opts=extend(this._o,options,!0);opts.isRTL=!!opts.isRTL,opts.field=opts.field&&opts.field.nodeName?opts.field:null,opts.theme="string"==typeof opts.theme&&opts.theme?opts.theme:null,opts.bound=!!(void 0!==opts.bound?opts.field&&opts.bound:opts.field),opts.trigger=opts.trigger&&opts.trigger.nodeName?opts.trigger:opts.field,opts.disableWeekends=!!opts.disableWeekends,opts.disableDayFn="function"==typeof opts.disableDayFn?opts.disableDayFn:null;let nom=parseInt(opts.numberOfMonths,10)||1;if(opts.numberOfMonths=nom>4?4:nom,isDate(opts.minDate)||(opts.minDate=!1),isDate(opts.maxDate)||(opts.maxDate=!1),opts.minDate&&opts.maxDate&&opts.maxDate<opts.minDate&&(opts.maxDate=opts.minDate=!1),opts.minDate&&this.setMinDate(opts.minDate),opts.maxDate&&this.setMaxDate(opts.maxDate),isArray(opts.yearRange)){let fallback=(new Date).getFullYear()-10;opts.yearRange[0]=parseInt(opts.yearRange[0],10)||fallback,opts.yearRange[1]=parseInt(opts.yearRange[1],10)||fallback}else opts.yearRange=Math.abs(parseInt(opts.yearRange,10))||defaults.yearRange,opts.yearRange>100&&(opts.yearRange=100);return opts},toString:function(format){return format=format||this._o.format,isDate(this._d)?this._o.toString?this._o.toString(this._d,format):this.hasMoment?this.moment(this._d).format(format):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(date,preventOnSelect){this.hasMoment&&this.moment.isMoment(date)&&this.setDate(date.toDate(),preventOnSelect)},useMoment:function(momentFunction){this.hasMoment=!0,this.moment=momentFunction},getDate:function(){return isDate(this._d)?new Date(this._d.getTime()):null},setDate:function(date,preventOnSelect){if(!date)return this._d=null,this._o.field&&(this._o.field.value="",fireEvent(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof date&&(date=new Date(Date.parse(date))),!isDate(date))return;let min=this._o.minDate,max=this._o.maxDate;isDate(min)&&date<min?date=min:isDate(max)&&date>max&&(date=max),this._d=new Date(date.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),preventOnSelect||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(date){let newCalendar=!0;if(isDate(date)){if(this.calendars){let firstVisibleDate=new Date(this.calendars[0].year,this.calendars[0].month,1),lastVisibleDate=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),visibleDate=date.getTime();lastVisibleDate.setMonth(lastVisibleDate.getMonth()+1),lastVisibleDate.setDate(lastVisibleDate.getDate()-1),newCalendar=visibleDate<firstVisibleDate.getTime()||lastVisibleDate.getTime()<visibleDate}newCalendar&&(this.calendars=[{month:date.getMonth(),year:date.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(sign,days){let newDay,day=this.getDate()||new Date,difference=24*parseInt(days)*60*60*1e3;"add"===sign?newDay=new Date(day.valueOf()+difference):"subtract"===sign&&(newDay=new Date(day.valueOf()-difference)),this.setDate(newDay)},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let c=1;c<this._o.numberOfMonths;c++)this.calendars[c]=adjustCalendar({month:this.calendars[0].month+c,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(month){isNaN(month)||(this.calendars[0].month=parseInt(month,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(year){isNaN(year)||(this.calendars[0].year=parseInt(year,10),this.adjustCalendars())},setMinDate:function(value){value instanceof Date?(setToStartOfDay(value),this._o.minDate=value,this._o.minYear=value.getFullYear(),this._o.minMonth=value.getMonth()):(this._o.minDate=defaults.minDate,this._o.minYear=defaults.minYear,this._o.minMonth=defaults.minMonth,this._o.startRange=defaults.startRange),this.draw()},setMaxDate:function(value){value instanceof Date?(setToStartOfDay(value),this._o.maxDate=value,this._o.maxYear=value.getFullYear(),this._o.maxMonth=value.getMonth()):(this._o.maxDate=defaults.maxDate,this._o.maxYear=defaults.maxYear,this._o.maxMonth=defaults.maxMonth,this._o.endRange=defaults.endRange),this.draw()},setStartRange:function(value){this._o.startRange=value},setEndRange:function(value){this._o.endRange=value},draw:function(force){if(!this._v&&!force)return;let randId,opts=this._o,minYear=opts.minYear,maxYear=opts.maxYear,minMonth=opts.minMonth,maxMonth=opts.maxMonth,html="";this._y<=minYear&&(this._y=minYear,!isNaN(minMonth)&&this._m<minMonth&&(this._m=minMonth)),this._y>=maxYear&&(this._y=maxYear,!isNaN(maxMonth)&&this._m>maxMonth&&(this._m=maxMonth));for(let c=0;c<opts.numberOfMonths;c++)randId="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),html+='<div class="pika-lendar">'+renderTitle(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year,randId)+this.render(this.calendars[c].year,this.calendars[c].month,randId)+"</div>";this.el.innerHTML=html,opts.bound&&"hidden"!==opts.field.type&&sto((function(){opts.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),opts.bound&&opts.field.setAttribute("aria-label",opts.ariaLabel)},adjustPosition:function(){let field,width,height,viewportWidth,viewportHeight,scrollTop,left,top,clientRect,leftAligned,bottomAligned;this._o.container||(this.el.style.position="absolute",field=this._o.trigger,width=this.el.offsetWidth,height=this.el.offsetHeight,viewportWidth=getWindow().innerWidth||getDocument().documentElement.clientWidth,viewportHeight=getWindow().innerHeight||getDocument().documentElement.clientHeight,scrollTop=getDocument().body.scrollTop||getDocument().documentElement.scrollTop,leftAligned=!0,bottomAligned=!0,clientRect=field.getBoundingClientRect(),left=clientRect.left+getWindow().pageXOffset,top=clientRect.bottom+getWindow().pageYOffset,(this._o.reposition&&left+width>viewportWidth||this._o.position.indexOf("right")>-1&&left-width+field.offsetWidth>0)&&(left=left-width+field.offsetWidth,leftAligned=!1),(this._o.reposition&&top+height>viewportHeight+scrollTop||this._o.position.indexOf("top")>-1&&top-height-field.offsetHeight>0)&&(top=top-height-field.offsetHeight,bottomAligned=!1),left<0&&(left=0),top<0&&(top=0),this.el.style.left=left+"px",this.el.style.top=top+"px",addClass(this.el,leftAligned?"left-aligned":"right-aligned"),addClass(this.el,bottomAligned?"bottom-aligned":"top-aligned"),removeClass(this.el,leftAligned?"right-aligned":"left-aligned"),removeClass(this.el,bottomAligned?"top-aligned":"bottom-aligned"))},render:function(year,month,randId){let opts=this._o,now=new Date,days=getDaysInMonth(year,month),before=new Date(year,month,1).getDay(),data=[],row=[];setToStartOfDay(now),opts.firstDay>0&&(before-=opts.firstDay,before<0&&(before+=7));let previousMonth=0===month?11:month-1,nextMonth=11===month?0:month+1,yearOfPreviousMonth=0===month?year-1:year,yearOfNextMonth=11===month?year+1:year,daysInPreviousMonth=getDaysInMonth(yearOfPreviousMonth,previousMonth),cells=days+before,after=cells;for(;after>7;)after-=7;cells+=7-after;let isWeekSelected=!1;for(let i=0,r=0;i<cells;i++){let day=new Date(year,month,i-before+1),isSelected=!!isDate(this._d)&&compareDates(day,this._d),isToday=compareDates(day,now),hasEvent=-1!==opts.events.indexOf(day.toDateString()),isEmpty=i<before||i>=days+before,dayNumber=i-before+1,monthNumber=month,yearNumber=year,isStartRange=opts.startRange&&compareDates(opts.startRange,day),isEndRange=opts.endRange&&compareDates(opts.endRange,day),isInRange=opts.startRange&&opts.endRange&&opts.startRange<day&&day<opts.endRange;isEmpty&&(i<before?(dayNumber=daysInPreviousMonth+dayNumber,monthNumber=previousMonth,yearNumber=yearOfPreviousMonth):(dayNumber-=days,monthNumber=nextMonth,yearNumber=yearOfNextMonth));let dayConfig={day:dayNumber,month:monthNumber,year:yearNumber,hasEvent,isSelected,isToday,isDisabled:opts.minDate&&day<opts.minDate||opts.maxDate&&day>opts.maxDate||opts.disableWeekends&&isWeekend(day)||opts.disableDayFn&&opts.disableDayFn(day),isEmpty,isStartRange,isEndRange,isInRange,showDaysInNextAndPreviousMonths:opts.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:opts.enableSelectionDaysInNextAndPreviousMonths};opts.pickWholeWeek&&isSelected&&(isWeekSelected=!0),row.push(renderDay(dayConfig)),7==++r&&(opts.showWeekNumber&&row.unshift(renderWeek(this,i-before,month,year,opts.firstWeekOfYearMinDays)),data.push(renderRow(row,opts.isRTL,opts.pickWholeWeek,isWeekSelected)),row=[],r=0,isWeekSelected=!1)}return renderTable(opts,data,randId)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),removeClass(this.el,"is-hidden"),this._o.bound&&(addEvent(getDocument(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let v=this._v;!1!==v&&(this._o.bound&&removeEvent(getDocument(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),addClass(this.el,"is-hidden"),this._v=!1,void 0!==v&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let opts=this._o;this.hide(),removeEvent(this.el,"mousedown",this._onMouseDown,!0),removeEvent(this.el,"touchend",this._onMouseDown,!0),removeEvent(this.el,"change",this._onChange),opts.keyboardInput&&removeEvent(getDocument(),"keydown",this._onKeyChange),opts.field&&(removeEvent(opts.field,"change",this._onInputChange),opts.bound&&(removeEvent(opts.trigger,"click",this._onInputClick),removeEvent(opts.trigger,"focus",this._onInputFocus),removeEvent(opts.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};var browser=__webpack_require__("./node_modules/handsontable/helpers/browser.mjs");function dateEditor_classPrivateMethodInitSpec(e,a){(function dateEditor_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function dateEditor_defineProperty(e,r,t){return(r=function dateEditor_toPropertyKey(t){var i=function dateEditor_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function dateEditor_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const dateEditor_EDITOR_TYPE="date";var _DateEditor_brand=new WeakSet;class DateEditor extends textEditor.t{constructor(){super(...arguments),dateEditor_classPrivateMethodInitSpec(this,_DateEditor_brand),dateEditor_defineProperty(this,"parentDestroyed",!1),dateEditor_defineProperty(this,"$datePicker",null)}static get EDITOR_TYPE(){return dateEditor_EDITOR_TYPE}init(){if("function"!=typeof moment_default())throw new Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()})),this.hot.addHook("afterSetTheme",((themeName,firstRun)=>{firstRun||((0,dom_element.vy)(this.datePicker,/ht-theme-.*/g),(0,dom_element.iQ)(this.datePicker,themeName))}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,dom_element.iQ)(this.datePicker,"htDatepickerHolder");const themeClassName=this.hot.getCurrentThemeName();(0,dom_element.vy)(this.datePicker,/ht-theme-.*/g),(0,dom_element.iQ)(this.datePicker,themeClassName),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",(event=>{(0,dom_element.nB)(event.target,"pika-day")&&this.hideDatepicker(),event.stopPropagation()}))}destroyElements(){const datePickerParentElement=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),datePickerParentElement&&datePickerParentElement.removeChild(this.datePicker)}prepare(row,col,prop,td,value,cellProperties){super.prepare(row,col,prop,td,value,cellProperties)}open(){let event=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const editorContext=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(event),super.open(),editorContext.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:"dateEditor"})}close(){var _this$$datePicker;this._opened=!1,null!==(_this$$datePicker=this.$datePicker)&&void 0!==_this$$datePicker&&_this$$datePicker.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{const editorManager=this.hot._getEditorManager();editorManager.closeEditor(),this.hot.view.render(),editorManager.prepareEditor()}));this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup("dateEditor"),super.close()}finishEditing(){let restoreOriginalValue=arguments.length>0&&void 0!==arguments[0]&&arguments[0],ctrlDown=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(restoreOriginalValue,ctrlDown)}showDatepicker(event){const dateFormat=dateEditor_assertClassBrand(_DateEditor_brand,this,_getDateFormat).call(this),isMouseDown=this.hot.view.isMouseDown(),isMeta=!!event&&(0,unicode.Yf)(event.keyCode);let dateStr;this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(moment_default()),this.$datePicker._onInputFocus=function(){},this.originalValue?(dateStr=this.originalValue,moment_default()(dateStr,dateFormat,!0).isValid()&&this.$datePicker.setMoment(moment_default()(dateStr,dateFormat),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),isMeta||isMouseDown||this.setValue("")):this.cellProperties.defaultDate?(dateStr=this.cellProperties.defaultDate,moment_default()(dateStr,dateFormat,!0).isValid()&&this.$datePicker.setMoment(moment_default()(dateStr,dateFormat),!0),isMeta||isMouseDown||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var _options$format;const htInput=this.TEXTAREA,options={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,object.zw)(options,this.cellProperties.datePickerConfig);const origOnSelect=options.onSelect,origOnClose=options.onClose;return options.field=htInput,options.trigger=htInput,options.container=this.datePicker,options.bound=!1,options.keyboardInput=!1,options.format=null!==(_options$format=options.format)&&void 0!==_options$format?_options$format:dateEditor_assertClassBrand(_DateEditor_brand,this,_getDateFormat).call(this),options.reposition=options.reposition||!1,options.isRTL=!1,options.onSelect=value=>{let dateStr=value;isNaN(dateStr.getTime())||(dateStr=moment_default()(dateStr).format(dateEditor_assertClassBrand(_DateEditor_brand,this,_getDateFormat).call(this))),this.setValue(dateStr),origOnSelect&&origOnSelect(),(0,browser.rr)()&&this.hideDatepicker()},options.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),origOnClose&&origOnClose()},options}refreshDimensions(force){var _wtOverlays$getParent;if(super.refreshDimensions(force),this.state!==baseEditor._T.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper,columnIndexMapper}=this.hot,{wtOverlays}=this.hot.view._wt,{wtTable}=null!==(_wtOverlays$getParent=wtOverlays.getParentOverlay(this.TD))&&void 0!==_wtOverlays$getParent?_wtOverlays$getParent:this.hot.view._wt,firstVisibleRow=rowIndexMapper.getVisualFromRenderableIndex(wtTable.getFirstPartiallyVisibleRow()),lastVisibleRow=rowIndexMapper.getVisualFromRenderableIndex(wtTable.getLastPartiallyVisibleRow()),firstVisibleColumn=columnIndexMapper.getVisualFromRenderableIndex(wtTable.getFirstPartiallyVisibleColumn()),lastVisibleColumn=columnIndexMapper.getVisualFromRenderableIndex(wtTable.getLastPartiallyVisibleColumn());if(this.row>=firstVisibleRow&&this.row<=lastVisibleRow&&this.col>=firstVisibleColumn&&this.col<=lastVisibleColumn){const offset=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+offset.top+(0,dom_element.DK)(this.TD)}px`;let pickerLeftPosition=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?pickerLeftPosition+=offset.right-(0,dom_element.Gq)(this.datePicker):pickerLeftPosition+=offset.left,this.datePickerStyle.left=`${pickerLeftPosition}px`}else this.hideDatepicker()}}function _getDateFormat(){var _this$cellProperties$;return null!==(_this$cellProperties$=this.cellProperties.dateFormat)&&void 0!==_this$cellProperties$?_this$cellProperties$:"DD/MM/YYYY"}class DropdownEditor extends AutocompleteEditor{static get EDITOR_TYPE(){return"dropdown"}prepare(row,col,prop,td,value,cellProperties){cellProperties.filter=!1,cellProperties.strict=!0,super.prepare(row,col,prop,td,value,cellProperties)}}class NumericEditor extends textEditor.t{static get EDITOR_TYPE(){return"numeric"}}var autoResize=__webpack_require__("./node_modules/handsontable/utils/autoResize.mjs");function passwordEditor_defineProperty(e,r,t){return(r=function passwordEditor_toPropertyKey(t){var i=function passwordEditor_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class PasswordEditor extends textEditor.t{constructor(){super(...arguments),passwordEditor_defineProperty(this,"autoResize",(0,autoResize.j)(this.hot.rootDocument,{textContent:element=>"".repeat(element.value.length)}))}static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,(0,dom_element.Ie)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}class SelectEditor extends baseEditor.b7{static get EDITOR_TYPE(){return"select"}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const ARROW=this.hot.rootDocument.createElement("DIV"),isAriaEnabled=this.hot.getSettings().ariaTags;ARROW.className="htAutocompleteArrow",isAriaEnabled&&ARROW.setAttribute(...(0,a11y.MG)()),ARROW.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),(0,dom_element.iQ)(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(ARROW,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(value){this.select.value=value}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",(0,dom_element.nB)(this.selectWrapper,"ht_editor_visible")&&(0,dom_element.vy)(this.selectWrapper,"ht_editor_visible"),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(row,col,prop,td,value,cellProperties){super.prepare(row,col,prop,td,value,cellProperties);const selectOptions=this.cellProperties.selectOptions;let options;options="function"==typeof selectOptions?this.prepareOptions(selectOptions(this.row,this.col,this.prop)):this.prepareOptions(selectOptions),(0,dom_element.Ie)(this.select),(0,object.v4)(options,((optionValue,key)=>{const optionElement=this.hot.rootDocument.createElement("OPTION");optionElement.value=key,(0,dom_element.Mv)(optionElement,optionValue),this.select.appendChild(optionElement)}))}prepareOptions(optionsToPrepare){let preparedOptions={};if(Array.isArray(optionsToPrepare))for(let i=0,len=optionsToPrepare.length;i<len;i++)preparedOptions[optionsToPrepare[i]]=optionsToPrepare[i];else"object"==typeof optionsToPrepare&&(preparedOptions=optionsToPrepare);return preparedOptions}refreshValue(){const sourceData=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=sourceData,this.setValue(sourceData),this.refreshDimensions()}refreshDimensions(){if(this.state!==baseEditor._T.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top,start,width,height}=this.getEditedCellRect(),selectStyle=this.selectWrapper.style;selectStyle.height=`${height}px`,selectStyle.width=`${width}px`,selectStyle.top=`${top}px`,selectStyle[this.hot.isRtl()?"right":"left"]=`${start}px`,selectStyle.margin="0px",(0,dom_element.iQ)(this.selectWrapper,"ht_editor_visible")}registerShortcuts(){const editorContext=this.hot.getShortcutManager().getContext("editor"),contextConfig={group:"selectEditor"};this.isInFullEditMode()&&editorContext.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const previousOptionIndex=this.select.selectedIndex-1;previousOptionIndex>=0&&(this.select[previousOptionIndex].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const nextOptionIndex=this.select.selectedIndex+1;nextOptionIndex<=this.select.length-1&&(this.select[nextOptionIndex].selected=!0)}}],contextConfig)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup("selectEditor")}}class TimeEditor extends textEditor.t{static get EDITOR_TYPE(){return"time"}prepare(row,col,prop,td,value,cellProperties){super.prepare(row,col,prop,td,value,cellProperties),this.TEXTAREA.dir="ltr"}}var registry=__webpack_require__("./node_modules/handsontable/editors/registry.mjs");var baseRenderer=__webpack_require__("./node_modules/handsontable/renderers/baseRenderer/baseRenderer.mjs");function htmlRenderer(hotInstance,TD,row,col,prop,value,cellProperties){baseRenderer.j.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties]),(0,dom_element.Mv)(TD,null==value?"":value,!1)}htmlRenderer.RENDERER_TYPE="html";var handsontable_eventManager=__webpack_require__("./node_modules/handsontable/eventManager.mjs");function autocompleteRenderer(hotInstance,TD,row,col,prop,value,cellProperties){const{rootDocument}=hotInstance,rendererFunc=cellProperties.allowHtml?htmlRenderer:textRenderer.F,ARROW=rootDocument.createElement("DIV"),isAriaEnabled=hotInstance.getSettings().ariaTags;if(ARROW.className="htAutocompleteArrow",isAriaEnabled&&ARROW.setAttribute(...(0,a11y.MG)()),ARROW.appendChild(rootDocument.createTextNode(String.fromCharCode(9660))),rendererFunc.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties]),TD.firstChild||TD.appendChild(rootDocument.createTextNode(String.fromCharCode(160))),TD.insertBefore(ARROW,TD.firstChild),(0,dom_element.iQ)(TD,"htAutocomplete"),!hotInstance.acArrowListener){const eventManager=new handsontable_eventManager.A(hotInstance);hotInstance.acArrowListener=function(event){(0,dom_element.nB)(event.target,"htAutocompleteArrow")&&hotInstance.view._wt.getSetting("onCellDblClick",null,hotInstance._createCellCoords(row,col),TD)},eventManager.addEventListener(hotInstance.rootElement,"mousedown",hotInstance.acArrowListener),hotInstance.addHookOnce("afterDestroy",(()=>{eventManager.destroy()}))}}autocompleteRenderer.RENDERER_TYPE="autocomplete";function dropdownRenderer(hotInstance,TD,row,col,prop,value,cellProperties){autocompleteRenderer.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties])}dropdownRenderer.RENDERER_TYPE="dropdown";__webpack_require__("./node_modules/core-js/modules/esnext.iterator.every.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var hooks=__webpack_require__("./node_modules/handsontable/core/hooks/index.mjs"),i18n_constants=__webpack_require__("./node_modules/handsontable/i18n/constants.mjs");const isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue",ATTR_ROW="data-row",ATTR_COLUMN="data-col",checkboxRenderer_SHORTCUTS_GROUP="checkboxRenderer";function checkboxRenderer(hotInstance,TD,row,col,prop,value,cellProperties){const{rootDocument}=hotInstance,ariaEnabled=hotInstance.getSettings().ariaTags;baseRenderer.j.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties]),function registerEvents(instance){let eventManager=isCheckboxListenerAdded.get(instance);if(!eventManager){const{rootElement}=instance;eventManager=new handsontable_eventManager.A(instance),eventManager.addEventListener(rootElement,"click",(event=>function onClick(event,instance){const{target}=event;if(!isCheckboxInput(target))return;if(!target.hasAttribute(ATTR_ROW)||!target.hasAttribute(ATTR_COLUMN))return;const row=parseInt(target.getAttribute(ATTR_ROW),10),col=parseInt(target.getAttribute(ATTR_COLUMN),10),cellProperties=instance.getCellMeta(row,col);cellProperties.readOnly&&event.preventDefault()}(event,instance))),eventManager.addEventListener(rootElement,"mouseup",(event=>function onMouseUp(event,instance){const{target}=event;if(!isCheckboxInput(target))return;if(!target.hasAttribute(ATTR_ROW)||!target.hasAttribute(ATTR_COLUMN))return;setTimeout(instance.listen,10)}(event,instance))),eventManager.addEventListener(rootElement,"change",(event=>function onChange(event,instance){const{target}=event;if(!isCheckboxInput(target))return;if(!target.hasAttribute(ATTR_ROW)||!target.hasAttribute(ATTR_COLUMN))return;const row=parseInt(target.getAttribute(ATTR_ROW),10),col=parseInt(target.getAttribute(ATTR_COLUMN),10),cellProperties=instance.getCellMeta(row,col);if(!cellProperties.readOnly){let newCheckboxValue=null;newCheckboxValue=event.target.checked?void 0===cellProperties.uncheckedTemplate||cellProperties.checkedTemplate:void 0!==cellProperties.uncheckedTemplate&&cellProperties.uncheckedTemplate,instance.setDataAtCell(row,col,newCheckboxValue)}}(event,instance))),isCheckboxListenerAdded.set(instance,eventManager)}return eventManager}(hotInstance);let input=function createInput(rootDocument){const input=rootDocument.createElement("input");return input.className="htCheckboxRendererInput",input.type="checkbox",input.setAttribute("tabindex","-1"),input.cloneNode(!1)}(rootDocument);const labelOptions=cellProperties.label;let badValue=!1;if(void 0===cellProperties.checkedTemplate&&(cellProperties.checkedTemplate=!0),void 0===cellProperties.uncheckedTemplate&&(cellProperties.uncheckedTemplate=!1),(0,dom_element.Ie)(TD),value===cellProperties.checkedTemplate||(0,mixed.As)(value).toLocaleLowerCase(cellProperties.locale)===(0,mixed.As)(cellProperties.checkedTemplate).toLocaleLowerCase(cellProperties.locale)?input.checked=!0:value===cellProperties.uncheckedTemplate||(0,mixed.As)(value).toLocaleLowerCase(cellProperties.locale)===(0,mixed.As)(cellProperties.uncheckedTemplate).toLocaleLowerCase(cellProperties.locale)?input.checked=!1:(0,mixed.Im)(value)?(0,dom_element.iQ)(input,"noValue"):(input.style.display="none",(0,dom_element.iQ)(input,BAD_VALUE_CLASS),badValue=!0),(0,dom_element.Bq)(input,[[ATTR_ROW,row],[ATTR_COLUMN,col]]),ariaEnabled&&(0,dom_element.Bq)(input,[(0,a11y.SM)(input.checked?hotInstance.getTranslatedPhrase(i18n_constants.CHECKBOX_CHECKED):hotInstance.getTranslatedPhrase(i18n_constants.CHECKBOX_UNCHECKED)),(0,a11y.Xq)(input.checked),(0,a11y.Pk)()]),!badValue&&labelOptions){let labelText="";if(labelOptions.value)labelText="function"==typeof labelOptions.value?labelOptions.value.call(this,row,col,prop,value):labelOptions.value;else if(labelOptions.property){const labelValue=hotInstance.getDataAtRowProp(row,labelOptions.property);labelText=null!==labelValue?labelValue:""}const label=function createLabel(rootDocument,text,fullWidth){const label=rootDocument.createElement("label");label.className="htCheckboxRendererLabel "+(fullWidth?"fullWidth":"");const textNode=rootDocument.createTextNode(text);if(fullWidth){const span=rootDocument.createElement("span");span.appendChild(textNode),label.appendChild(span)}else label.appendChild(textNode);return label.cloneNode(!0)}(rootDocument,labelText,!0!==labelOptions.separated);"before"===labelOptions.position?labelOptions.separated?(TD.appendChild(label),TD.appendChild(input)):(label.appendChild(input),input=label):labelOptions.position&&"after"!==labelOptions.position||(labelOptions.separated?(TD.appendChild(input),TD.appendChild(label)):(label.insertBefore(input,label.firstChild),input=label))}function changeSelectedCheckboxesState(){let uncheckCheckbox=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const selRange=hotInstance.getSelectedRange(),changesPerSubSelection=[],nonCheckboxChanges=new Map;let changes=[],changeCounter=0;if(selRange){for(let key=0;key<selRange.length;key++){const{row:startRow,col:startColumn}=selRange[key].getTopStartCorner(),{row:endRow,col:endColumn}=selRange[key].getBottomEndCorner();for(let visualRow=startRow;visualRow<=endRow;visualRow+=1)for(let visualColumn=startColumn;visualColumn<=endColumn;visualColumn+=1){const cachedCellProperties=hotInstance.getCellMeta(visualRow,visualColumn);if(cachedCellProperties.hidden)continue;const templates={checkedTemplate:cachedCellProperties.checkedTemplate,uncheckedTemplate:cachedCellProperties.uncheckedTemplate};if("checkbox"!==cachedCellProperties.type){!0!==uncheckCheckbox||cachedCellProperties.readOnly||(nonCheckboxChanges.has(changesPerSubSelection.length)?nonCheckboxChanges.set(changesPerSubSelection.length,[...nonCheckboxChanges.get(changesPerSubSelection.length),[visualRow,visualColumn,null]]):nonCheckboxChanges.set(changesPerSubSelection.length,[[visualRow,visualColumn,null]]));continue}if(!0===cachedCellProperties.readOnly)continue;void 0===cachedCellProperties.checkedTemplate&&(cachedCellProperties.checkedTemplate=!0),void 0===cachedCellProperties.uncheckedTemplate&&(cachedCellProperties.uncheckedTemplate=!1);const dataAtCell=hotInstance.getDataAtCell(visualRow,visualColumn);!1===uncheckCheckbox?[cachedCellProperties.checkedTemplate,cachedCellProperties.checkedTemplate.toString()].includes(dataAtCell)?changes.push([visualRow,visualColumn,cachedCellProperties.uncheckedTemplate,templates]):[cachedCellProperties.uncheckedTemplate,cachedCellProperties.uncheckedTemplate.toString(),null,void 0].includes(dataAtCell)&&changes.push([visualRow,visualColumn,cachedCellProperties.checkedTemplate,templates]):changes.push([visualRow,visualColumn,cachedCellProperties.uncheckedTemplate,templates]),changeCounter+=1}changesPerSubSelection.push(changeCounter),changeCounter=0}changes=changes.every((_ref=>{let[,,cellValue]=_ref;return cellValue===changes[0][2]}))?changes.map((_ref3=>{let[visualRow,visualColumn,cellValue]=_ref3;return[visualRow,visualColumn,cellValue]})):changes.map((_ref2=>{let[visualRow,visualColumn,,templates]=_ref2;return[visualRow,visualColumn,templates.checkedTemplate]})),changes.length>0&&changesPerSubSelection.forEach(((changesCount,sectionCount)=>{let changesChunk=changes.splice(0,changesCount);nonCheckboxChanges.size&&nonCheckboxChanges.has(sectionCount)&&(changesChunk=[...changesChunk,...nonCheckboxChanges.get(sectionCount)]),hotInstance.setDataAtCell(changesChunk)}))}}function areSelectedCheckboxCells(){const selRange=hotInstance.getSelectedRange();if(selRange){for(let key=0;key<selRange.length;key++){const topLeft=selRange[key].getTopStartCorner(),bottomRight=selRange[key].getBottomEndCorner();for(let visualRow=topLeft.row;visualRow<=bottomRight.row;visualRow++)for(let visualColumn=topLeft.col;visualColumn<=bottomRight.col;visualColumn++){if(hotInstance.getCellMeta(visualRow,visualColumn).readOnly)continue;const cell=hotInstance.getCell(visualRow,visualColumn);if((0,dom_element.sb)(cell)){if(cell.querySelectorAll("input[type=checkbox]").length>0)return!0}}}return!1}}(!labelOptions||labelOptions&&!labelOptions.separated)&&TD.appendChild(input),badValue&&TD.appendChild(rootDocument.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(hotInstance)||(isListeningKeyDownEvent.set(hotInstance,!0),function registerShortcuts(){const gridContext=hotInstance.getShortcutManager().getContext("grid"),config={group:checkboxRenderer_SHORTCUTS_GROUP,relativeToGroup:constants.b,position:"before"};gridContext.addShortcuts([{keys:[["space"]],callback:()=>(changeSelectedCheckboxesState(),!areSelectedCheckboxCells()),runOnlyIf:()=>{var _hotInstance$getSelec;return null===(_hotInstance$getSelec=hotInstance.getSelectedRangeLast())||void 0===_hotInstance$getSelec?void 0:_hotInstance$getSelec.highlight.isCell()}},{keys:[["enter"]],callback:()=>(changeSelectedCheckboxesState(),!areSelectedCheckboxCells()),runOnlyIf:()=>{const range=hotInstance.getSelectedRangeLast();return hotInstance.getSettings().enterBeginsEditing&&(null==range?void 0:range.highlight.isCell())&&!hotInstance.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(changeSelectedCheckboxesState(!0),!areSelectedCheckboxCells()),runOnlyIf:()=>{var _hotInstance$getSelec2;return null===(_hotInstance$getSelec2=hotInstance.getSelectedRangeLast())||void 0===_hotInstance$getSelec2?void 0:_hotInstance$getSelec2.highlight.isCell()}}],config)}())}function isCheckboxInput(element){return"INPUT"===element.tagName&&"checkbox"===element.getAttribute("type")}hooks.R.getSingleton().add("modifyAutoColumnSizeSeed",(function(bundleSeed,cellMeta,cellValue){const{label,type,row,column,prop}=cellMeta;if("checkbox"===type){if(label){const{value:labelValue,property:labelProperty}=label;let labelText=cellValue;if(labelValue)labelText="function"==typeof labelValue?labelValue(row,column,prop,cellValue):labelValue;else if(labelProperty){const labelData=this.getDataAtRowProp(row,labelProperty);labelText=null!==labelData?labelData:cellValue}bundleSeed=labelText}return bundleSeed}})),checkboxRenderer.RENDERER_TYPE="checkbox";function handsontableRenderer(hotInstance,TD,row,col,prop,value,cellProperties){autocompleteRenderer.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties])}handsontableRenderer.RENDERER_TYPE="handsontable";var enUS,hasRequiredEnUS,unformatting,hasRequiredUnformatting,validating$1,hasRequiredValidating,commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function requireEnUS(){return hasRequiredEnUS||(hasRequiredEnUS=1,enUS={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(number){let b=number%10;return 1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),enUS}function requireUnformatting(){if(hasRequiredUnformatting)return unformatting;hasRequiredUnformatting=1;const allSuffixes=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function escapeRegExp(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function computeUnformattedValue(inputString,delimiters,currencySymbol,ordinal,zeroFormat,abbreviations,format){if(!isNaN(+inputString))return+inputString;let stripped="",newInput=inputString.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(newInput!==inputString)return-1*computeUnformattedValue(newInput,delimiters,currencySymbol,ordinal,zeroFormat,abbreviations);for(let i=0;i<allSuffixes.length;i++){let suffix=allSuffixes[i];if(stripped=inputString.replace(RegExp(`([0-9 ])(${suffix.key})$`),"$1"),stripped!==inputString)return computeUnformattedValue(stripped,delimiters,currencySymbol,ordinal,zeroFormat,abbreviations)*suffix.factor}if(stripped=inputString.replace("%",""),stripped!==inputString)return computeUnformattedValue(stripped,delimiters,currencySymbol,ordinal,zeroFormat,abbreviations)/100;let possibleOrdinalValue=parseFloat(inputString);if(isNaN(possibleOrdinalValue))return;let ordinalString=ordinal(possibleOrdinalValue);if(ordinalString&&"."!==ordinalString&&(stripped=inputString.replace(new RegExp(`${escapeRegExp(ordinalString)}$`),""),stripped!==inputString))return computeUnformattedValue(stripped,delimiters,currencySymbol,ordinal,zeroFormat,abbreviations);let inversedAbbreviations={};Object.keys(abbreviations).forEach((key=>{inversedAbbreviations[abbreviations[key]]=key}));let abbreviationValues=Object.keys(inversedAbbreviations).sort().reverse(),numberOfAbbreviations=abbreviationValues.length;for(let i=0;i<numberOfAbbreviations;i++){let value=abbreviationValues[i],key=inversedAbbreviations[value];if(stripped=inputString.replace(value,""),stripped!==inputString){let factor;switch(key){case"thousand":factor=Math.pow(10,3);break;case"million":factor=Math.pow(10,6);break;case"billion":factor=Math.pow(10,9);break;case"trillion":factor=Math.pow(10,12)}return computeUnformattedValue(stripped,delimiters,currencySymbol,ordinal,zeroFormat,abbreviations)*factor}}}function unformatValue(inputString,delimiters,currencySymbol="",ordinal,zeroFormat,abbreviations,format){if(""===inputString)return;if(inputString===zeroFormat)return 0;let value=function removeFormattingSymbols(inputString,delimiters,currencySymbol){let stripped=inputString.replace(currencySymbol,"");return stripped=stripped.replace(new RegExp(`([0-9])${escapeRegExp(delimiters.thousands)}([0-9])`,"g"),"$1$2"),stripped=stripped.replace(delimiters.decimal,"."),stripped}(inputString,delimiters,currencySymbol);return computeUnformattedValue(value,delimiters,currencySymbol,ordinal,zeroFormat,abbreviations)}return unformatting={unformat:function unformat(inputString,format){const globalState=requireGlobalState();let value,delimiters=globalState.currentDelimiters(),currencySymbol=globalState.currentCurrency().symbol,ordinal=globalState.currentOrdinal(),zeroFormat=globalState.getZeroFormat(),abbreviations=globalState.currentAbbreviations();if("string"==typeof inputString)value=function matchesTime(inputString,delimiters){if(!inputString.indexOf(":")||":"===delimiters.thousands)return!1;let segments=inputString.split(":");if(3!==segments.length)return!1;let hours=+segments[0],minutes=+segments[1],seconds=+segments[2];return!isNaN(hours)&&!isNaN(minutes)&&!isNaN(seconds)}(inputString,delimiters)?function unformatTime(inputString){let segments=inputString.split(":"),hours=+segments[0],minutes=+segments[1];return+segments[2]+60*minutes+3600*hours}(inputString):unformatValue(inputString,delimiters,currencySymbol,ordinal,zeroFormat,abbreviations);else{if("number"!=typeof inputString)return;value=inputString}if(void 0!==value)return value}},unformatting}function requireValidating(){if(hasRequiredValidating)return validating$1;hasRequiredValidating=1;let unformatter=requireUnformatting();const bcp47RegExp=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,validFormat={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:(number,format)=>"byte"===format.output,message:"`base` must be provided only when the output is `byte`",mandatory:format=>"byte"===format.output},characteristic:{type:"number",restriction:number=>number>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",lowPrecision:{type:"boolean",restriction:(number,format)=>!0===format.average,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:number=>number>=0,message:"value must be positive"},{restriction:(number,format)=>!format.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:number=>number>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(number,format)=>"percent"===format.output,message:"`prefixSymbol` can be provided only when the output is `percent`"}},validLanguage={languageTag:{type:"string",mandatory:!0,restriction:tag=>tag.match(bcp47RegExp),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function validateInput(input){return void 0!==unformatter.unformat(input)}function validateSpec(toValidate,spec,prefix,skipMandatoryCheck=!1){let results=Object.keys(toValidate).map((key=>{if(!spec[key])return console.error(`${prefix} Invalid key: ${key}`),!1;let value=toValidate[key],data=spec[key];if("string"==typeof data&&(data={type:data}),"format"===data.type){if(!validateSpec(value,validFormat,`[Validate ${key}]`,!0))return!1}else if(typeof value!==data.type)return console.error(`${prefix} ${key} type mismatched: "${data.type}" expected, "${typeof value}" provided`),!1;if(data.restrictions&&data.restrictions.length){let length=data.restrictions.length;for(let i=0;i<length;i++){let{restriction,message}=data.restrictions[i];if(!restriction(value,toValidate))return console.error(`${prefix} ${key} invalid value: ${message}`),!1}}if(data.restriction&&!data.restriction(value,toValidate))return console.error(`${prefix} ${key} invalid value: ${data.message}`),!1;if(data.validValues&&-1===data.validValues.indexOf(value))return console.error(`${prefix} ${key} invalid value: must be among ${JSON.stringify(data.validValues)}, "${value}" provided`),!1;if(data.children){if(!validateSpec(value,data.children,`[Validate ${key}]`))return!1}return!0}));return skipMandatoryCheck||results.push(...Object.keys(spec).map((key=>{let data=spec[key];if("string"==typeof data&&(data={type:data}),data.mandatory){let mandatory=data.mandatory;if("function"==typeof mandatory&&(mandatory=mandatory(toValidate)),mandatory&&void 0===toValidate[key])return console.error(`${prefix} Missing mandatory key "${key}"`),!1}return!0}))),results.reduce(((acc,current)=>acc&&current),!0)}function validateFormat(format){return validateSpec(format,validFormat,"[Validate format]")}return validating$1={validate:function validate(input,format){let validInput=validateInput(input),isFormatValid=validateFormat(format);return validInput&&isFormatValid},validateFormat,validateInput,validateLanguage:function validateLanguage(language){return validateSpec(language,validLanguage,"[Validate language]")}},validating$1}var globalState$2,hasRequiredGlobalState,parsing$2={parseFormat:function parseFormat(string,result={}){return"string"!=typeof string?string:(string=function parsePrefix(string,result){let match=string.match(/^{([^}]*)}/);return match?(result.prefix=match[1],string.slice(match[0].length)):string}(string,result),string=function parsePostfix(string,result){let match=string.match(/{([^}]*)}$/);return match?(result.postfix=match[1],string.slice(0,-match[0].length)):string}(string,result),function parseOutput(string,result){if(-1===string.indexOf("$")){if(-1===string.indexOf("%"))return-1!==string.indexOf("bd")?(result.output="byte",void(result.base="general")):-1!==string.indexOf("b")?(result.output="byte",void(result.base="binary")):-1!==string.indexOf("d")?(result.output="byte",void(result.base="decimal")):void(-1===string.indexOf(":")?-1!==string.indexOf("o")&&(result.output="ordinal"):result.output="time");result.output="percent"}else result.output="currency"}(string,result),function parseTotalLength(string,result){let match=string.match(/[1-9]+[0-9]*/);match&&(result.totalLength=+match[0])}(string,result),function parseCharacteristic(string,result){let match=string.split(".")[0].match(/0+/);match&&(result.characteristic=match[0].length)}(string,result),function parseOptionalCharacteristic(string,result){if(-1!==string.indexOf(".")){let characteristic=string.split(".")[0];result.optionalCharacteristic=-1===characteristic.indexOf("0")}}(string,result),function parseAverage(string,result){-1!==string.indexOf("a")&&(result.average=!0)}(string,result),function parseForceAverage(string,result){-1!==string.indexOf("K")?result.forceAverage="thousand":-1!==string.indexOf("M")?result.forceAverage="million":-1!==string.indexOf("B")?result.forceAverage="billion":-1!==string.indexOf("T")&&(result.forceAverage="trillion")}(string,result),function parseMantissa(string,result){let mantissa=string.split(".")[1];if(mantissa){let match=mantissa.match(/0+/);match&&(result.mantissa=match[0].length)}}(string,result),function parseOptionalMantissa(string,result){string.match(/\[\.]/)?result.optionalMantissa=!0:string.match(/\./)&&(result.optionalMantissa=!1)}(string,result),function parseTrimMantissa(string,result){const mantissa=string.split(".")[1];mantissa&&(result.trimMantissa=-1!==mantissa.indexOf("["))}(string,result),function parseThousandSeparated(string,result){-1!==string.indexOf(",")&&(result.thousandSeparated=!0)}(string,result),function parseSpaceSeparated(string,result){-1!==string.indexOf(" ")&&(result.spaceSeparated=!0,result.spaceSeparatedCurrency=!0,(result.average||result.forceAverage)&&(result.spaceSeparatedAbbreviation=!0))}(string,result),function parseNegative(string,result){string.match(/^\+?\([^)]*\)$/)&&(result.negative="parenthesis"),string.match(/^\+?-/)&&(result.negative="sign")}(string,result),function parseForceSign(string,result){string.match(/^\+/)&&(result.forceSign=!0)}(string,result),result)}};function requireGlobalState(){if(hasRequiredGlobalState)return globalState$2;hasRequiredGlobalState=1;const enUS=requireEnUS(),validating=requireValidating(),parsing=parsing$2;let currentLanguageTag,state={},languages={},zeroFormat=null,globalDefaults={};function chooseLanguage(tag){currentLanguageTag=tag}function currentLanguageData(){return languages[currentLanguageTag]}return state.languages=()=>Object.assign({},languages),state.currentLanguage=()=>currentLanguageTag,state.currentBytes=()=>currentLanguageData().bytes||{},state.currentCurrency=()=>currentLanguageData().currency,state.currentAbbreviations=()=>currentLanguageData().abbreviations,state.currentDelimiters=()=>currentLanguageData().delimiters,state.currentOrdinal=()=>currentLanguageData().ordinal,state.currentDefaults=()=>Object.assign({},currentLanguageData().defaults,globalDefaults),state.currentOrdinalDefaultFormat=()=>Object.assign({},state.currentDefaults(),currentLanguageData().ordinalFormat),state.currentByteDefaultFormat=()=>Object.assign({},state.currentDefaults(),currentLanguageData().byteFormat),state.currentPercentageDefaultFormat=()=>Object.assign({},state.currentDefaults(),currentLanguageData().percentageFormat),state.currentCurrencyDefaultFormat=()=>Object.assign({},state.currentDefaults(),currentLanguageData().currencyFormat),state.currentTimeDefaultFormat=()=>Object.assign({},state.currentDefaults(),currentLanguageData().timeFormat),state.setDefaults=format=>{format=parsing.parseFormat(format),validating.validateFormat(format)&&(globalDefaults=format)},state.getZeroFormat=()=>zeroFormat,state.setZeroFormat=string=>zeroFormat="string"==typeof string?string:null,state.hasZeroFormat=()=>null!==zeroFormat,state.languageData=tag=>{if(tag){if(languages[tag])return languages[tag];throw new Error(`Unknown tag "${tag}"`)}return currentLanguageData()},state.registerLanguage=(data,useLanguage=!1)=>{if(!validating.validateLanguage(data))throw new Error("Invalid language data");languages[data.languageTag]=data,useLanguage&&chooseLanguage(data.languageTag)},state.setLanguage=(tag,fallbackTag=enUS.languageTag)=>{if(!languages[tag]){let suffix=tag.split("-")[0],matchingLanguageTag=Object.keys(languages).find((each=>each.split("-")[0]===suffix));return languages[matchingLanguageTag]?void chooseLanguage(matchingLanguageTag):void chooseLanguage(fallbackTag)}chooseLanguage(tag)},state.registerLanguage(enUS),currentLanguageTag=enUS.languageTag,globalState$2=state}function loadLanguagesInNode(tags,numbro){tags.forEach((tag=>{let data;try{data=function commonjsRequire(path){throw new Error('Could not dynamically require "'+path+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(`../languages/${tag}`)}catch(e){console.error(`Unable to load "${tag}". No matching language file found.`)}data&&numbro.registerLanguage(data)}))}var module,bignumber={exports:{}};module=bignumber,function(globalObject){var BigNumber,isNumeric=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,mathceil=Math.ceil,mathfloor=Math.floor,bignumberError="[BigNumber Error] ",tooManyDigits=bignumberError+"Number primitive has more than 15 significant digits: ",BASE=1e14,POWS_TEN=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],MAX=1e9;function bitFloor(n){var i=0|n;return n>0||n===i?i:i-1}function coeffToString(a){for(var s,z,i=1,j=a.length,r=a[0]+"";i<j;){for(z=14-(s=a[i++]+"").length;z--;s="0"+s);r+=s}for(j=r.length;48===r.charCodeAt(--j););return r.slice(0,j+1||1)}function compare(x,y){var a,b,xc=x.c,yc=y.c,i=x.s,j=y.s,k=x.e,l=y.e;if(!i||!j)return null;if(a=xc&&!xc[0],b=yc&&!yc[0],a||b)return a?b?0:-j:i;if(i!=j)return i;if(a=i<0,b=k==l,!xc||!yc)return b?0:!xc^a?1:-1;if(!b)return k>l^a?1:-1;for(j=(k=xc.length)<(l=yc.length)?k:l,i=0;i<j;i++)if(xc[i]!=yc[i])return xc[i]>yc[i]^a?1:-1;return k==l?0:k>l^a?1:-1}function intCheck(n,min,max,name){if(n<min||n>max||n!==mathfloor(n))throw Error(bignumberError+(name||"Argument")+("number"==typeof n?n<min||n>max?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n))}function isOdd(n){var k=n.c.length-1;return bitFloor(n.e/14)==k&&n.c[k]%2!=0}function toExponential(str,e){return(str.length>1?str.charAt(0)+"."+str.slice(1):str)+(e<0?"e":"e+")+e}function toFixedPoint(str,e,z){var len,zs;if(e<0){for(zs=z+".";++e;zs+=z);str=zs+str}else if(++e>(len=str.length)){for(zs=z,e-=len;--e;zs+=z);str+=zs}else e<len&&(str=str.slice(0,e)+"."+str.slice(e));return str}BigNumber=function clone(configObject){var div,convertBase,parseNumeric,random53bitInt,basePrefix,dotAfter,dotBefore,isInfinityOrNaN,whitespaceOrPlus,P=BigNumber.prototype={constructor:BigNumber,toString:null,valueOf:null},ONE=new BigNumber(1),DECIMAL_PLACES=20,ROUNDING_MODE=4,TO_EXP_NEG=-7,TO_EXP_POS=21,MIN_EXP=-1e7,MAX_EXP=1e7,CRYPTO=!1,MODULO_MODE=1,POW_PRECISION=0,FORMAT={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},ALPHABET="0123456789abcdefghijklmnopqrstuvwxyz",alphabetHasNormalDecimalDigits=!0;function BigNumber(v,b){var alphabet,c,caseChanged,e,i,isNum,len,str,x=this;if(!(x instanceof BigNumber))return new BigNumber(v,b);if(null==b){if(v&&!0===v._isBigNumber)return x.s=v.s,void(!v.c||v.e>MAX_EXP?x.c=x.e=null:v.e<MIN_EXP?x.c=[x.e=0]:(x.e=v.e,x.c=v.c.slice()));if((isNum="number"==typeof v)&&0*v==0){if(x.s=1/v<0?(v=-v,-1):1,v===~~v){for(e=0,i=v;i>=10;i/=10,e++);return void(e>MAX_EXP?x.c=x.e=null:(x.e=e,x.c=[v]))}str=String(v)}else{if(!isNumeric.test(str=String(v)))return parseNumeric(x,str,isNum);x.s=45==str.charCodeAt(0)?(str=str.slice(1),-1):1}(e=str.indexOf("."))>-1&&(str=str.replace(".","")),(i=str.search(/e/i))>0?(e<0&&(e=i),e+=+str.slice(i+1),str=str.substring(0,i)):e<0&&(e=str.length)}else{if(intCheck(b,2,ALPHABET.length,"Base"),10==b&&alphabetHasNormalDecimalDigits)return round(x=new BigNumber(v),DECIMAL_PLACES+x.e+1,ROUNDING_MODE);if(str=String(v),isNum="number"==typeof v){if(0*v!=0)return parseNumeric(x,str,isNum,b);if(x.s=1/v<0?(str=str.slice(1),-1):1,BigNumber.DEBUG&&str.replace(/^0\.0*|\./,"").length>15)throw Error(tooManyDigits+v)}else x.s=45===str.charCodeAt(0)?(str=str.slice(1),-1):1;for(alphabet=ALPHABET.slice(0,b),e=i=0,len=str.length;i<len;i++)if(alphabet.indexOf(c=str.charAt(i))<0){if("."==c){if(i>e){e=len;continue}}else if(!caseChanged&&(str==str.toUpperCase()&&(str=str.toLowerCase())||str==str.toLowerCase()&&(str=str.toUpperCase()))){caseChanged=!0,i=-1,e=0;continue}return parseNumeric(x,String(v),isNum,b)}isNum=!1,(e=(str=convertBase(str,b,10,x.s)).indexOf("."))>-1?str=str.replace(".",""):e=str.length}for(i=0;48===str.charCodeAt(i);i++);for(len=str.length;48===str.charCodeAt(--len););if(str=str.slice(i,++len)){if(len-=i,isNum&&BigNumber.DEBUG&&len>15&&(v>9007199254740991||v!==mathfloor(v)))throw Error(tooManyDigits+x.s*v);if((e=e-i-1)>MAX_EXP)x.c=x.e=null;else if(e<MIN_EXP)x.c=[x.e=0];else{if(x.e=e,x.c=[],i=(e+1)%14,e<0&&(i+=14),i<len){for(i&&x.c.push(+str.slice(0,i)),len-=14;i<len;)x.c.push(+str.slice(i,i+=14));i=14-(str=str.slice(i)).length}else i-=len;for(;i--;str+="0");x.c.push(+str)}}else x.c=[x.e=0]}function format(n,i,rm,id){var c0,e,ne,len,str;if(null==rm?rm=ROUNDING_MODE:intCheck(rm,0,8),!n.c)return n.toString();if(c0=n.c[0],ne=n.e,null==i)str=coeffToString(n.c),str=1==id||2==id&&(ne<=TO_EXP_NEG||ne>=TO_EXP_POS)?toExponential(str,ne):toFixedPoint(str,ne,"0");else if(e=(n=round(new BigNumber(n),i,rm)).e,len=(str=coeffToString(n.c)).length,1==id||2==id&&(i<=e||e<=TO_EXP_NEG)){for(;len<i;str+="0",len++);str=toExponential(str,e)}else if(i-=ne,str=toFixedPoint(str,e,"0"),e+1>len){if(--i>0)for(str+=".";i--;str+="0");}else if((i+=e-len)>0)for(e+1==len&&(str+=".");i--;str+="0");return n.s<0&&c0?"-"+str:str}function maxOrMin(args,n){for(var k,y,i=1,x=new BigNumber(args[0]);i<args.length;i++)(!(y=new BigNumber(args[i])).s||(k=compare(x,y))===n||0===k&&x.s===n)&&(x=y);return x}function normalise(n,c,e){for(var i=1,j=c.length;!c[--j];c.pop());for(j=c[0];j>=10;j/=10,i++);return(e=i+14*e-1)>MAX_EXP?n.c=n.e=null:e<MIN_EXP?n.c=[n.e=0]:(n.e=e,n.c=c),n}function round(x,sd,rm,r){var d,i,j,k,n,ni,rd,xc=x.c,pows10=POWS_TEN;if(xc){out:{for(d=1,k=xc[0];k>=10;k/=10,d++);if((i=sd-d)<0)i+=14,j=sd,n=xc[ni=0],rd=mathfloor(n/pows10[d-j-1]%10);else if((ni=mathceil((i+1)/14))>=xc.length){if(!r)break out;for(;xc.length<=ni;xc.push(0));n=rd=0,d=1,j=(i%=14)-14+1}else{for(n=k=xc[ni],d=1;k>=10;k/=10,d++);rd=(j=(i%=14)-14+d)<0?0:mathfloor(n/pows10[d-j-1]%10)}if(r=r||sd<0||null!=xc[ni+1]||(j<0?n:n%pows10[d-j-1]),r=rm<4?(rd||r)&&(0==rm||rm==(x.s<0?3:2)):rd>5||5==rd&&(4==rm||r||6==rm&&(i>0?j>0?n/pows10[d-j]:0:xc[ni-1])%10&1||rm==(x.s<0?8:7)),sd<1||!xc[0])return xc.length=0,r?(sd-=x.e+1,xc[0]=pows10[(14-sd%14)%14],x.e=-sd||0):xc[0]=x.e=0,x;if(0==i?(xc.length=ni,k=1,ni--):(xc.length=ni+1,k=pows10[14-i],xc[ni]=j>0?mathfloor(n/pows10[d-j]%pows10[j])*k:0),r)for(;;){if(0==ni){for(i=1,j=xc[0];j>=10;j/=10,i++);for(j=xc[0]+=k,k=1;j>=10;j/=10,k++);i!=k&&(x.e++,xc[0]==BASE&&(xc[0]=1));break}if(xc[ni]+=k,xc[ni]!=BASE)break;xc[ni--]=0,k=1}for(i=xc.length;0===xc[--i];xc.pop());}x.e>MAX_EXP?x.c=x.e=null:x.e<MIN_EXP&&(x.c=[x.e=0])}return x}function valueOf(n){var str,e=n.e;return null===e?n.toString():(str=coeffToString(n.c),str=e<=TO_EXP_NEG||e>=TO_EXP_POS?toExponential(str,e):toFixedPoint(str,e,"0"),n.s<0?"-"+str:str)}return BigNumber.clone=clone,BigNumber.ROUND_UP=0,BigNumber.ROUND_DOWN=1,BigNumber.ROUND_CEIL=2,BigNumber.ROUND_FLOOR=3,BigNumber.ROUND_HALF_UP=4,BigNumber.ROUND_HALF_DOWN=5,BigNumber.ROUND_HALF_EVEN=6,BigNumber.ROUND_HALF_CEIL=7,BigNumber.ROUND_HALF_FLOOR=8,BigNumber.EUCLID=9,BigNumber.config=BigNumber.set=function(obj){var p,v;if(null!=obj){if("object"!=typeof obj)throw Error(bignumberError+"Object expected: "+obj);if(obj.hasOwnProperty(p="DECIMAL_PLACES")&&(intCheck(v=obj[p],0,MAX,p),DECIMAL_PLACES=v),obj.hasOwnProperty(p="ROUNDING_MODE")&&(intCheck(v=obj[p],0,8,p),ROUNDING_MODE=v),obj.hasOwnProperty(p="EXPONENTIAL_AT")&&((v=obj[p])&&v.pop?(intCheck(v[0],-MAX,0,p),intCheck(v[1],0,MAX,p),TO_EXP_NEG=v[0],TO_EXP_POS=v[1]):(intCheck(v,-MAX,MAX,p),TO_EXP_NEG=-(TO_EXP_POS=v<0?-v:v))),obj.hasOwnProperty(p="RANGE"))if((v=obj[p])&&v.pop)intCheck(v[0],-MAX,-1,p),intCheck(v[1],1,MAX,p),MIN_EXP=v[0],MAX_EXP=v[1];else{if(intCheck(v,-MAX,MAX,p),!v)throw Error(bignumberError+p+" cannot be zero: "+v);MIN_EXP=-(MAX_EXP=v<0?-v:v)}if(obj.hasOwnProperty(p="CRYPTO")){if((v=obj[p])!==!!v)throw Error(bignumberError+p+" not true or false: "+v);if(v){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw CRYPTO=!v,Error(bignumberError+"crypto unavailable");CRYPTO=v}else CRYPTO=v}if(obj.hasOwnProperty(p="MODULO_MODE")&&(intCheck(v=obj[p],0,9,p),MODULO_MODE=v),obj.hasOwnProperty(p="POW_PRECISION")&&(intCheck(v=obj[p],0,MAX,p),POW_PRECISION=v),obj.hasOwnProperty(p="FORMAT")){if("object"!=typeof(v=obj[p]))throw Error(bignumberError+p+" not an object: "+v);FORMAT=v}if(obj.hasOwnProperty(p="ALPHABET")){if("string"!=typeof(v=obj[p])||/^.?$|[+\-.\s]|(.).*\1/.test(v))throw Error(bignumberError+p+" invalid: "+v);alphabetHasNormalDecimalDigits="0123456789"==v.slice(0,10),ALPHABET=v}}return{DECIMAL_PLACES,ROUNDING_MODE,EXPONENTIAL_AT:[TO_EXP_NEG,TO_EXP_POS],RANGE:[MIN_EXP,MAX_EXP],CRYPTO,MODULO_MODE,POW_PRECISION,FORMAT,ALPHABET}},BigNumber.isBigNumber=function(v){if(!v||!0!==v._isBigNumber)return!1;if(!BigNumber.DEBUG)return!0;var i,n,c=v.c,e=v.e,s=v.s;out:if("[object Array]"=={}.toString.call(c)){if((1===s||-1===s)&&e>=-MAX&&e<=MAX&&e===mathfloor(e)){if(0===c[0]){if(0===e&&1===c.length)return!0;break out}if((i=(e+1)%14)<1&&(i+=14),String(c[0]).length==i){for(i=0;i<c.length;i++)if((n=c[i])<0||n>=BASE||n!==mathfloor(n))break out;if(0!==n)return!0}}}else if(null===c&&null===e&&(null===s||1===s||-1===s))return!0;throw Error(bignumberError+"Invalid BigNumber: "+v)},BigNumber.maximum=BigNumber.max=function(){return maxOrMin(arguments,-1)},BigNumber.minimum=BigNumber.min=function(){return maxOrMin(arguments,1)},BigNumber.random=(random53bitInt=9007199254740992*Math.random()&2097151?function(){return mathfloor(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(dp){var a,b,e,k,v,i=0,c=[],rand=new BigNumber(ONE);if(null==dp?dp=DECIMAL_PLACES:intCheck(dp,0,MAX),k=mathceil(dp/14),CRYPTO)if(crypto.getRandomValues){for(a=crypto.getRandomValues(new Uint32Array(k*=2));i<k;)(v=131072*a[i]+(a[i+1]>>>11))>=9e15?(b=crypto.getRandomValues(new Uint32Array(2)),a[i]=b[0],a[i+1]=b[1]):(c.push(v%1e14),i+=2);i=k/2}else{if(!crypto.randomBytes)throw CRYPTO=!1,Error(bignumberError+"crypto unavailable");for(a=crypto.randomBytes(k*=7);i<k;)(v=281474976710656*(31&a[i])+1099511627776*a[i+1]+4294967296*a[i+2]+16777216*a[i+3]+(a[i+4]<<16)+(a[i+5]<<8)+a[i+6])>=9e15?crypto.randomBytes(7).copy(a,i):(c.push(v%1e14),i+=7);i=k/7}if(!CRYPTO)for(;i<k;)(v=random53bitInt())<9e15&&(c[i++]=v%1e14);for(dp%=14,(k=c[--i])&&dp&&(v=POWS_TEN[14-dp],c[i]=mathfloor(k/v)*v);0===c[i];c.pop(),i--);if(i<0)c=[e=0];else{for(e=-1;0===c[0];c.splice(0,1),e-=14);for(i=1,v=c[0];v>=10;v/=10,i++);i<14&&(e-=14-i)}return rand.e=e,rand.c=c,rand}),BigNumber.sum=function(){for(var i=1,args=arguments,sum=new BigNumber(args[0]);i<args.length;)sum=sum.plus(args[i++]);return sum},convertBase=function(){function toBaseOut(str,baseIn,baseOut,alphabet){for(var j,arrL,arr=[0],i=0,len=str.length;i<len;){for(arrL=arr.length;arrL--;arr[arrL]*=baseIn);for(arr[0]+=alphabet.indexOf(str.charAt(i++)),j=0;j<arr.length;j++)arr[j]>baseOut-1&&(null==arr[j+1]&&(arr[j+1]=0),arr[j+1]+=arr[j]/baseOut|0,arr[j]%=baseOut)}return arr.reverse()}return function(str,baseIn,baseOut,sign,callerIsToString){var alphabet,d,e,k,r,x,xc,y,i=str.indexOf("."),dp=DECIMAL_PLACES,rm=ROUNDING_MODE;for(i>=0&&(k=POW_PRECISION,POW_PRECISION=0,str=str.replace(".",""),x=(y=new BigNumber(baseIn)).pow(str.length-i),POW_PRECISION=k,y.c=toBaseOut(toFixedPoint(coeffToString(x.c),x.e,"0"),10,baseOut,"0123456789"),y.e=y.c.length),e=k=(xc=toBaseOut(str,baseIn,baseOut,callerIsToString?(alphabet=ALPHABET,"0123456789"):(alphabet="0123456789",ALPHABET))).length;0==xc[--k];xc.pop());if(!xc[0])return alphabet.charAt(0);if(i<0?--e:(x.c=xc,x.e=e,x.s=sign,xc=(x=div(x,y,dp,rm,baseOut)).c,r=x.r,e=x.e),i=xc[d=e+dp+1],k=baseOut/2,r=r||d<0||null!=xc[d+1],r=rm<4?(null!=i||r)&&(0==rm||rm==(x.s<0?3:2)):i>k||i==k&&(4==rm||r||6==rm&&1&xc[d-1]||rm==(x.s<0?8:7)),d<1||!xc[0])str=r?toFixedPoint(alphabet.charAt(1),-dp,alphabet.charAt(0)):alphabet.charAt(0);else{if(xc.length=d,r)for(--baseOut;++xc[--d]>baseOut;)xc[d]=0,d||(++e,xc=[1].concat(xc));for(k=xc.length;!xc[--k];);for(i=0,str="";i<=k;str+=alphabet.charAt(xc[i++]));str=toFixedPoint(str,e,alphabet.charAt(0))}return str}}(),div=function(){function multiply(x,k,base){var m,temp,xlo,xhi,carry=0,i=x.length,klo=k%1e7,khi=k/1e7|0;for(x=x.slice();i--;)carry=((temp=klo*(xlo=x[i]%1e7)+(m=khi*xlo+(xhi=x[i]/1e7|0)*klo)%1e7*1e7+carry)/base|0)+(m/1e7|0)+khi*xhi,x[i]=temp%base;return carry&&(x=[carry].concat(x)),x}function compare(a,b,aL,bL){var i,cmp;if(aL!=bL)cmp=aL>bL?1:-1;else for(i=cmp=0;i<aL;i++)if(a[i]!=b[i]){cmp=a[i]>b[i]?1:-1;break}return cmp}function subtract(a,b,aL,base){for(var i=0;aL--;)a[aL]-=i,i=a[aL]<b[aL]?1:0,a[aL]=i*base+a[aL]-b[aL];for(;!a[0]&&a.length>1;a.splice(0,1));}return function(x,y,dp,rm,base){var cmp,e,i,more,n,prod,prodL,q,qc,rem,remL,rem0,xi,xL,yc0,yL,yz,s=x.s==y.s?1:-1,xc=x.c,yc=y.c;if(!(xc&&xc[0]&&yc&&yc[0]))return new BigNumber(x.s&&y.s&&(xc?!yc||xc[0]!=yc[0]:yc)?xc&&0==xc[0]||!yc?0*s:s/0:NaN);for(qc=(q=new BigNumber(s)).c=[],s=dp+(e=x.e-y.e)+1,base||(base=BASE,e=bitFloor(x.e/14)-bitFloor(y.e/14),s=s/14|0),i=0;yc[i]==(xc[i]||0);i++);if(yc[i]>(xc[i]||0)&&e--,s<0)qc.push(1),more=!0;else{for(xL=xc.length,yL=yc.length,i=0,s+=2,(n=mathfloor(base/(yc[0]+1)))>1&&(yc=multiply(yc,n,base),xc=multiply(xc,n,base),yL=yc.length,xL=xc.length),xi=yL,remL=(rem=xc.slice(0,yL)).length;remL<yL;rem[remL++]=0);yz=yc.slice(),yz=[0].concat(yz),yc0=yc[0],yc[1]>=base/2&&yc0++;do{if(n=0,(cmp=compare(yc,rem,yL,remL))<0){if(rem0=rem[0],yL!=remL&&(rem0=rem0*base+(rem[1]||0)),(n=mathfloor(rem0/yc0))>1)for(n>=base&&(n=base-1),prodL=(prod=multiply(yc,n,base)).length,remL=rem.length;1==compare(prod,rem,prodL,remL);)n--,subtract(prod,yL<prodL?yz:yc,prodL,base),prodL=prod.length,cmp=1;else 0==n&&(cmp=n=1),prodL=(prod=yc.slice()).length;if(prodL<remL&&(prod=[0].concat(prod)),subtract(rem,prod,remL,base),remL=rem.length,-1==cmp)for(;compare(yc,rem,yL,remL)<1;)n++,subtract(rem,yL<remL?yz:yc,remL,base),remL=rem.length}else 0===cmp&&(n++,rem=[0]);qc[i++]=n,rem[0]?rem[remL++]=xc[xi]||0:(rem=[xc[xi]],remL=1)}while((xi++<xL||null!=rem[0])&&s--);more=null!=rem[0],qc[0]||qc.splice(0,1)}if(base==BASE){for(i=1,s=qc[0];s>=10;s/=10,i++);round(q,dp+(q.e=i+14*e-1)+1,rm,more)}else q.e=e,q.r=+more;return q}}(),basePrefix=/^(-?)0([xbo])(?=\w[\w.]*$)/i,dotAfter=/^([^.]+)\.$/,dotBefore=/^\.([^.]+)$/,isInfinityOrNaN=/^-?(Infinity|NaN)$/,whitespaceOrPlus=/^\s*\+(?=[\w.])|^\s+|\s+$/g,parseNumeric=function(x,str,isNum,b){var base,s=isNum?str:str.replace(whitespaceOrPlus,"");if(isInfinityOrNaN.test(s))x.s=isNaN(s)?null:s<0?-1:1;else{if(!isNum&&(s=s.replace(basePrefix,(function(m,p1,p2){return base="x"==(p2=p2.toLowerCase())?16:"b"==p2?2:8,b&&b!=base?m:p1})),b&&(base=b,s=s.replace(dotAfter,"$1").replace(dotBefore,"0.$1")),str!=s))return new BigNumber(s,base);if(BigNumber.DEBUG)throw Error(bignumberError+"Not a"+(b?" base "+b:"")+" number: "+str);x.s=null}x.c=x.e=null},P.absoluteValue=P.abs=function(){var x=new BigNumber(this);return x.s<0&&(x.s=1),x},P.comparedTo=function(y,b){return compare(this,new BigNumber(y,b))},P.decimalPlaces=P.dp=function(dp,rm){var c,n,v,x=this;if(null!=dp)return intCheck(dp,0,MAX),null==rm?rm=ROUNDING_MODE:intCheck(rm,0,8),round(new BigNumber(x),dp+x.e+1,rm);if(!(c=x.c))return null;if(n=14*((v=c.length-1)-bitFloor(this.e/14)),v=c[v])for(;v%10==0;v/=10,n--);return n<0&&(n=0),n},P.dividedBy=P.div=function(y,b){return div(this,new BigNumber(y,b),DECIMAL_PLACES,ROUNDING_MODE)},P.dividedToIntegerBy=P.idiv=function(y,b){return div(this,new BigNumber(y,b),0,1)},P.exponentiatedBy=P.pow=function(n,m){var half,isModExp,i,k,nIsBig,nIsNeg,nIsOdd,y,x=this;if((n=new BigNumber(n)).c&&!n.isInteger())throw Error(bignumberError+"Exponent not an integer: "+valueOf(n));if(null!=m&&(m=new BigNumber(m)),nIsBig=n.e>14,!x.c||!x.c[0]||1==x.c[0]&&!x.e&&1==x.c.length||!n.c||!n.c[0])return y=new BigNumber(Math.pow(+valueOf(x),nIsBig?n.s*(2-isOdd(n)):+valueOf(n))),m?y.mod(m):y;if(nIsNeg=n.s<0,m){if(m.c?!m.c[0]:!m.s)return new BigNumber(NaN);(isModExp=!nIsNeg&&x.isInteger()&&m.isInteger())&&(x=x.mod(m))}else{if(n.e>9&&(x.e>0||x.e<-1||(0==x.e?x.c[0]>1||nIsBig&&x.c[1]>=24e7:x.c[0]<8e13||nIsBig&&x.c[0]<=9999975e7)))return k=x.s<0&&isOdd(n)?-0:0,x.e>-1&&(k=1/k),new BigNumber(nIsNeg?1/k:k);POW_PRECISION&&(k=mathceil(POW_PRECISION/14+2))}for(nIsBig?(half=new BigNumber(.5),nIsNeg&&(n.s=1),nIsOdd=isOdd(n)):nIsOdd=(i=Math.abs(+valueOf(n)))%2,y=new BigNumber(ONE);;){if(nIsOdd){if(!(y=y.times(x)).c)break;k?y.c.length>k&&(y.c.length=k):isModExp&&(y=y.mod(m))}if(i){if(0===(i=mathfloor(i/2)))break;nIsOdd=i%2}else if(round(n=n.times(half),n.e+1,1),n.e>14)nIsOdd=isOdd(n);else{if(0==(i=+valueOf(n)))break;nIsOdd=i%2}x=x.times(x),k?x.c&&x.c.length>k&&(x.c.length=k):isModExp&&(x=x.mod(m))}return isModExp?y:(nIsNeg&&(y=ONE.div(y)),m?y.mod(m):k?round(y,POW_PRECISION,ROUNDING_MODE,void 0):y)},P.integerValue=function(rm){var n=new BigNumber(this);return null==rm?rm=ROUNDING_MODE:intCheck(rm,0,8),round(n,n.e+1,rm)},P.isEqualTo=P.eq=function(y,b){return 0===compare(this,new BigNumber(y,b))},P.isFinite=function(){return!!this.c},P.isGreaterThan=P.gt=function(y,b){return compare(this,new BigNumber(y,b))>0},P.isGreaterThanOrEqualTo=P.gte=function(y,b){return 1===(b=compare(this,new BigNumber(y,b)))||0===b},P.isInteger=function(){return!!this.c&&bitFloor(this.e/14)>this.c.length-2},P.isLessThan=P.lt=function(y,b){return compare(this,new BigNumber(y,b))<0},P.isLessThanOrEqualTo=P.lte=function(y,b){return-1===(b=compare(this,new BigNumber(y,b)))||0===b},P.isNaN=function(){return!this.s},P.isNegative=function(){return this.s<0},P.isPositive=function(){return this.s>0},P.isZero=function(){return!!this.c&&0==this.c[0]},P.minus=function(y,b){var i,j,t,xLTy,x=this,a=x.s;if(b=(y=new BigNumber(y,b)).s,!a||!b)return new BigNumber(NaN);if(a!=b)return y.s=-b,x.plus(y);var xe=x.e/14,ye=y.e/14,xc=x.c,yc=y.c;if(!xe||!ye){if(!xc||!yc)return xc?(y.s=-b,y):new BigNumber(yc?x:NaN);if(!xc[0]||!yc[0])return yc[0]?(y.s=-b,y):new BigNumber(xc[0]?x:3==ROUNDING_MODE?-0:0)}if(xe=bitFloor(xe),ye=bitFloor(ye),xc=xc.slice(),a=xe-ye){for((xLTy=a<0)?(a=-a,t=xc):(ye=xe,t=yc),t.reverse(),b=a;b--;t.push(0));t.reverse()}else for(j=(xLTy=(a=xc.length)<(b=yc.length))?a:b,a=b=0;b<j;b++)if(xc[b]!=yc[b]){xLTy=xc[b]<yc[b];break}if(xLTy&&(t=xc,xc=yc,yc=t,y.s=-y.s),(b=(j=yc.length)-(i=xc.length))>0)for(;b--;xc[i++]=0);for(b=BASE-1;j>a;){if(xc[--j]<yc[j]){for(i=j;i&&!xc[--i];xc[i]=b);--xc[i],xc[j]+=BASE}xc[j]-=yc[j]}for(;0==xc[0];xc.splice(0,1),--ye);return xc[0]?normalise(y,xc,ye):(y.s=3==ROUNDING_MODE?-1:1,y.c=[y.e=0],y)},P.modulo=P.mod=function(y,b){var q,s,x=this;return y=new BigNumber(y,b),!x.c||!y.s||y.c&&!y.c[0]?new BigNumber(NaN):!y.c||x.c&&!x.c[0]?new BigNumber(x):(9==MODULO_MODE?(s=y.s,y.s=1,q=div(x,y,0,3),y.s=s,q.s*=s):q=div(x,y,0,MODULO_MODE),(y=x.minus(q.times(y))).c[0]||1!=MODULO_MODE||(y.s=x.s),y)},P.multipliedBy=P.times=function(y,b){var c,e,i,j,k,m,xcL,xlo,xhi,ycL,ylo,yhi,zc,base,x=this,xc=x.c,yc=(y=new BigNumber(y,b)).c;if(!(xc&&yc&&xc[0]&&yc[0]))return!x.s||!y.s||xc&&!xc[0]&&!yc||yc&&!yc[0]&&!xc?y.c=y.e=y.s=null:(y.s*=x.s,xc&&yc?(y.c=[0],y.e=0):y.c=y.e=null),y;for(e=bitFloor(x.e/14)+bitFloor(y.e/14),y.s*=x.s,(xcL=xc.length)<(ycL=yc.length)&&(zc=xc,xc=yc,yc=zc,i=xcL,xcL=ycL,ycL=i),i=xcL+ycL,zc=[];i--;zc.push(0));for(base=BASE,i=ycL;--i>=0;){for(c=0,ylo=yc[i]%1e7,yhi=yc[i]/1e7|0,j=i+(k=xcL);j>i;)c=((xlo=ylo*(xlo=xc[--k]%1e7)+(m=yhi*xlo+(xhi=xc[k]/1e7|0)*ylo)%1e7*1e7+zc[j]+c)/base|0)+(m/1e7|0)+yhi*xhi,zc[j--]=xlo%base;zc[j]=c}return c?++e:zc.splice(0,1),normalise(y,zc,e)},P.negated=function(){var x=new BigNumber(this);return x.s=-x.s||null,x},P.plus=function(y,b){var t,x=this,a=x.s;if(b=(y=new BigNumber(y,b)).s,!a||!b)return new BigNumber(NaN);if(a!=b)return y.s=-b,x.minus(y);var xe=x.e/14,ye=y.e/14,xc=x.c,yc=y.c;if(!xe||!ye){if(!xc||!yc)return new BigNumber(a/0);if(!xc[0]||!yc[0])return yc[0]?y:new BigNumber(xc[0]?x:0*a)}if(xe=bitFloor(xe),ye=bitFloor(ye),xc=xc.slice(),a=xe-ye){for(a>0?(ye=xe,t=yc):(a=-a,t=xc),t.reverse();a--;t.push(0));t.reverse()}for((a=xc.length)-(b=yc.length)<0&&(t=yc,yc=xc,xc=t,b=a),a=0;b;)a=(xc[--b]=xc[b]+yc[b]+a)/BASE|0,xc[b]=BASE===xc[b]?0:xc[b]%BASE;return a&&(xc=[a].concat(xc),++ye),normalise(y,xc,ye)},P.precision=P.sd=function(sd,rm){var c,n,v,x=this;if(null!=sd&&sd!==!!sd)return intCheck(sd,1,MAX),null==rm?rm=ROUNDING_MODE:intCheck(rm,0,8),round(new BigNumber(x),sd,rm);if(!(c=x.c))return null;if(n=14*(v=c.length-1)+1,v=c[v]){for(;v%10==0;v/=10,n--);for(v=c[0];v>=10;v/=10,n++);}return sd&&x.e+1>n&&(n=x.e+1),n},P.shiftedBy=function(k){return intCheck(k,-9007199254740991,9007199254740991),this.times("1e"+k)},P.squareRoot=P.sqrt=function(){var m,n,r,rep,t,x=this,c=x.c,s=x.s,e=x.e,dp=DECIMAL_PLACES+4,half=new BigNumber("0.5");if(1!==s||!c||!c[0])return new BigNumber(!s||s<0&&(!c||c[0])?NaN:c?x:1/0);if(0==(s=Math.sqrt(+valueOf(x)))||s==1/0?(((n=coeffToString(c)).length+e)%2==0&&(n+="0"),s=Math.sqrt(+n),e=bitFloor((e+1)/2)-(e<0||e%2),r=new BigNumber(n=s==1/0?"5e"+e:(n=s.toExponential()).slice(0,n.indexOf("e")+1)+e)):r=new BigNumber(s+""),r.c[0])for((s=(e=r.e)+dp)<3&&(s=0);;)if(t=r,r=half.times(t.plus(div(x,t,dp,1))),coeffToString(t.c).slice(0,s)===(n=coeffToString(r.c)).slice(0,s)){if(r.e<e&&--s,"9999"!=(n=n.slice(s-3,s+1))&&(rep||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(round(r,r.e+DECIMAL_PLACES+2,1),m=!r.times(r).eq(x));break}if(!rep&&(round(t,t.e+DECIMAL_PLACES+2,0),t.times(t).eq(x))){r=t;break}dp+=4,s+=4,rep=1}return round(r,r.e+DECIMAL_PLACES+1,ROUNDING_MODE,m)},P.toExponential=function(dp,rm){return null!=dp&&(intCheck(dp,0,MAX),dp++),format(this,dp,rm,1)},P.toFixed=function(dp,rm){return null!=dp&&(intCheck(dp,0,MAX),dp=dp+this.e+1),format(this,dp,rm)},P.toFormat=function(dp,rm,format){var str,x=this;if(null==format)null!=dp&&rm&&"object"==typeof rm?(format=rm,rm=null):dp&&"object"==typeof dp?(format=dp,dp=rm=null):format=FORMAT;else if("object"!=typeof format)throw Error(bignumberError+"Argument not an object: "+format);if(str=x.toFixed(dp,rm),x.c){var i,arr=str.split("."),g1=+format.groupSize,g2=+format.secondaryGroupSize,groupSeparator=format.groupSeparator||"",intPart=arr[0],fractionPart=arr[1],isNeg=x.s<0,intDigits=isNeg?intPart.slice(1):intPart,len=intDigits.length;if(g2&&(i=g1,g1=g2,g2=i,len-=i),g1>0&&len>0){for(i=len%g1||g1,intPart=intDigits.substr(0,i);i<len;i+=g1)intPart+=groupSeparator+intDigits.substr(i,g1);g2>0&&(intPart+=groupSeparator+intDigits.slice(i)),isNeg&&(intPart="-"+intPart)}str=fractionPart?intPart+(format.decimalSeparator||"")+((g2=+format.fractionGroupSize)?fractionPart.replace(new RegExp("\\d{"+g2+"}\\B","g"),"$&"+(format.fractionGroupSeparator||"")):fractionPart):intPart}return(format.prefix||"")+str+(format.suffix||"")},P.toFraction=function(md){var d,d0,d1,d2,e,exp,n,n0,n1,q,r,s,x=this,xc=x.c;if(null!=md&&(!(n=new BigNumber(md)).isInteger()&&(n.c||1!==n.s)||n.lt(ONE)))throw Error(bignumberError+"Argument "+(n.isInteger()?"out of range: ":"not an integer: ")+valueOf(n));if(!xc)return new BigNumber(x);for(d=new BigNumber(ONE),n1=d0=new BigNumber(ONE),d1=n0=new BigNumber(ONE),s=coeffToString(xc),e=d.e=s.length-x.e-1,d.c[0]=POWS_TEN[(exp=e%14)<0?14+exp:exp],md=!md||n.comparedTo(d)>0?e>0?d:n1:n,exp=MAX_EXP,MAX_EXP=1/0,n=new BigNumber(s),n0.c[0]=0;q=div(n,d,0,1),1!=(d2=d0.plus(q.times(d1))).comparedTo(md);)d0=d1,d1=d2,n1=n0.plus(q.times(d2=n1)),n0=d2,d=n.minus(q.times(d2=d)),n=d2;return d2=div(md.minus(d0),d1,0,1),n0=n0.plus(d2.times(n1)),d0=d0.plus(d2.times(d1)),n0.s=n1.s=x.s,r=div(n1,d1,e*=2,ROUNDING_MODE).minus(x).abs().comparedTo(div(n0,d0,e,ROUNDING_MODE).minus(x).abs())<1?[n1,d1]:[n0,d0],MAX_EXP=exp,r},P.toNumber=function(){return+valueOf(this)},P.toPrecision=function(sd,rm){return null!=sd&&intCheck(sd,1,MAX),format(this,sd,rm,2)},P.toString=function(b){var str,n=this,s=n.s,e=n.e;return null===e?s?(str="Infinity",s<0&&(str="-"+str)):str="NaN":(null==b?str=e<=TO_EXP_NEG||e>=TO_EXP_POS?toExponential(coeffToString(n.c),e):toFixedPoint(coeffToString(n.c),e,"0"):10===b&&alphabetHasNormalDecimalDigits?str=toFixedPoint(coeffToString((n=round(new BigNumber(n),DECIMAL_PLACES+e+1,ROUNDING_MODE)).c),n.e,"0"):(intCheck(b,2,ALPHABET.length,"Base"),str=convertBase(toFixedPoint(coeffToString(n.c),e,"0"),10,b,s,!0)),s<0&&n.c[0]&&(str="-"+str)),str},P.valueOf=P.toJSON=function(){return valueOf(this)},P._isBigNumber=!0,null!=configObject&&BigNumber.set(configObject),BigNumber}(),BigNumber.default=BigNumber.BigNumber=BigNumber,module.exports?module.exports=BigNumber:(globalObject||(globalObject="undefined"!=typeof self&&self?self:window),globalObject.BigNumber=BigNumber)}(commonjsGlobal);var bignumberExports=bignumber.exports;const globalState$1=requireGlobalState(),validating=requireValidating(),parsing$1=parsing$2,BigNumber$1=bignumberExports,powers={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},defaultOptions={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes,decimalSuffixes}=globalState$1.currentBytes(),bytes={general:{scale:1024,suffixes:decimalSuffixes,marker:"bd"},binary:{scale:1024,suffixes:binarySuffixes,marker:"b"},decimal:{scale:1e3,suffixes:decimalSuffixes,marker:"d"}};function format(instance,providedFormat={},numbro){if("string"==typeof providedFormat&&(providedFormat=parsing$1.parseFormat(providedFormat)),!validating.validateFormat(providedFormat))return"ERROR: invalid format";let prefix=providedFormat.prefix||"",postfix=providedFormat.postfix||"",output=function formatNumbro(instance,providedFormat,numbro){switch(providedFormat.output){case"currency":return function formatCurrency(instance,providedFormat,state){const currentCurrency=state.currentCurrency();let decimalSeparator,clonedFormat=Object.assign({},providedFormat),options=Object.assign({},defaultOptions,clonedFormat),space="",average=!!options.totalLength||!!options.forceAverage||options.average,position=clonedFormat.currencyPosition||currentCurrency.position,symbol=clonedFormat.currencySymbol||currentCurrency.symbol;const spaceSeparatedCurrency=void 0!==options.spaceSeparatedCurrency?options.spaceSeparatedCurrency:options.spaceSeparated;void 0===clonedFormat.lowPrecision&&(clonedFormat.lowPrecision=!1);spaceSeparatedCurrency&&(space=" ");"infix"===position&&(decimalSeparator=space+symbol+space);let output=formatNumber({instance,providedFormat:clonedFormat,state,decimalSeparator});"prefix"===position&&(output=instance._value<0&&"sign"===options.negative?`-${space}${symbol}${output.slice(1)}`:instance._value>0&&options.forceSign?`+${space}${symbol}${output.slice(1)}`:symbol+space+output);position&&"postfix"!==position||(space=!options.spaceSeparatedAbbreviation&&average?"":space,output=output+space+symbol);return output}(instance,providedFormat=formatOrDefault(providedFormat,globalState$1.currentCurrencyDefaultFormat()),globalState$1);case"percent":return function formatPercentage(instance,providedFormat,state,numbro){let prefixSymbol=providedFormat.prefixSymbol,output=formatNumber({instance:numbro(100*instance._value),providedFormat,state}),options=Object.assign({},defaultOptions,providedFormat);if(prefixSymbol)return`%${options.spaceSeparated?" ":""}${output}`;return`${output}${options.spaceSeparated?" ":""}%`}(instance,providedFormat=formatOrDefault(providedFormat,globalState$1.currentPercentageDefaultFormat()),globalState$1,numbro);case"byte":return function formatByte(instance,providedFormat,state,numbro){let base=providedFormat.base||"binary",options=Object.assign({},defaultOptions,providedFormat);const{binarySuffixes:localBinarySuffixes,decimalSuffixes:localDecimalSuffixes}=state.currentBytes();let baseInfo={general:{scale:1024,suffixes:localDecimalSuffixes||decimalSuffixes,marker:"bd"},binary:{scale:1024,suffixes:localBinarySuffixes||binarySuffixes,marker:"b"},decimal:{scale:1e3,suffixes:localDecimalSuffixes||decimalSuffixes,marker:"d"}}[base],{value,suffix}=getFormatByteUnits(instance._value,baseInfo.suffixes,baseInfo.scale),output=formatNumber({instance:numbro(value),providedFormat,state,defaults:state.currentByteDefaultFormat()});return`${output}${options.spaceSeparated?" ":""}${suffix}`}(instance,providedFormat=formatOrDefault(providedFormat,globalState$1.currentByteDefaultFormat()),globalState$1,numbro);case"time":return providedFormat=formatOrDefault(providedFormat,globalState$1.currentTimeDefaultFormat()),function formatTime(instance){let hours=Math.floor(instance._value/60/60),minutes=Math.floor((instance._value-60*hours*60)/60),seconds=Math.round(instance._value-60*hours*60-60*minutes);return`${hours}:${minutes<10?"0":""}${minutes}:${seconds<10?"0":""}${seconds}`}(instance);case"ordinal":return function formatOrdinal(instance,providedFormat,state){let ordinalFn=state.currentOrdinal(),options=Object.assign({},defaultOptions,providedFormat),output=formatNumber({instance,providedFormat,state}),ordinal=ordinalFn(instance._value);return`${output}${options.spaceSeparated?" ":""}${ordinal}`}(instance,providedFormat=formatOrDefault(providedFormat,globalState$1.currentOrdinalDefaultFormat()),globalState$1);default:return formatNumber({instance,providedFormat,numbro})}}(instance,providedFormat,numbro);return output=function insertPrefix(output,prefix){return prefix+output}(output,prefix),output=function insertPostfix(output,postfix){return output+postfix}(output,postfix),output}function getFormatByteUnits(value,suffixes,scale){let suffix=suffixes[0],abs=Math.abs(value);if(abs>=scale){for(let power=1;power<suffixes.length;++power){let min=Math.pow(scale,power),max=Math.pow(scale,power+1);if(abs>=min&&abs<max){suffix=suffixes[power],value/=min;break}}suffix===suffixes[0]&&(value/=Math.pow(scale,suffixes.length-1),suffix=suffixes[suffixes.length-1])}return{value,suffix}}function zeroes(number){let result="";for(let i=0;i<number;i++)result+="0";return result}function toFixed(value,precision,roundingFunction=Math.round){if(-1!==value.toString().indexOf("e"))return function toFixedLarge(value,precision){let result=value.toString(),[base,exp]=result.split("e"),[characteristic,mantissa=""]=base.split(".");if(+exp>0)result=characteristic+mantissa+zeroes(exp-mantissa.length);else{let prefix=".";prefix=+characteristic<0?`-0${prefix}`:`0${prefix}`;let suffix=(zeroes(-exp-1)+Math.abs(characteristic)+mantissa).substr(0,precision);suffix.length<precision&&(suffix+=zeroes(precision-suffix.length)),result=prefix+suffix}return+exp>0&&precision>0&&(result+=`.${zeroes(precision)}`),result}(value,precision);return new BigNumber$1(roundingFunction(+`${value}e+${precision}`)/Math.pow(10,precision)).toFixed(precision)}function formatNumber({instance,providedFormat,state=globalState$1,decimalSeparator,defaults=state.currentDefaults()}){let value=instance._value;if(0===value&&state.hasZeroFormat())return state.getZeroFormat();if(!isFinite(value))return value.toString();let options=Object.assign({},defaultOptions,defaults,providedFormat),totalLength=options.totalLength,characteristicPrecision=totalLength?0:options.characteristic,optionalCharacteristic=options.optionalCharacteristic,forceAverage=options.forceAverage,lowPrecision=options.lowPrecision,average=!!totalLength||!!forceAverage||options.average,mantissaPrecision=totalLength?-1:average&&void 0===providedFormat.mantissa?0:options.mantissa,optionalMantissa=!totalLength&&(void 0===providedFormat.optionalMantissa?-1===mantissaPrecision:options.optionalMantissa),trimMantissa=options.trimMantissa,thousandSeparated=options.thousandSeparated,spaceSeparated=options.spaceSeparated,negative=options.negative,forceSign=options.forceSign,exponential=options.exponential,roundingFunction=options.roundingFunction,abbreviation="";if(average){let data=function computeAverage({value,forceAverage,lowPrecision=!0,abbreviations,spaceSeparated=!1,totalLength=0,roundingFunction=Math.round}){let abbreviation="",abs=Math.abs(value),mantissaPrecision=-1;if(forceAverage&&abbreviations[forceAverage]&&powers[forceAverage]?(abbreviation=abbreviations[forceAverage],value/=powers[forceAverage]):abs>=powers.trillion||lowPrecision&&1===roundingFunction(abs/powers.trillion)?(abbreviation=abbreviations.trillion,value/=powers.trillion):abs<powers.trillion&&abs>=powers.billion||lowPrecision&&1===roundingFunction(abs/powers.billion)?(abbreviation=abbreviations.billion,value/=powers.billion):abs<powers.billion&&abs>=powers.million||lowPrecision&&1===roundingFunction(abs/powers.million)?(abbreviation=abbreviations.million,value/=powers.million):(abs<powers.million&&abs>=powers.thousand||lowPrecision&&1===roundingFunction(abs/powers.thousand))&&(abbreviation=abbreviations.thousand,value/=powers.thousand),abbreviation&&(abbreviation=(spaceSeparated?" ":"")+abbreviation),totalLength){let isNegative=value<0,characteristic=value.toString().split(".")[0],characteristicLength=isNegative?characteristic.length-1:characteristic.length;mantissaPrecision=Math.max(totalLength-characteristicLength,0)}return{value,abbreviation,mantissaPrecision}}({value,forceAverage,lowPrecision,abbreviations:state.currentAbbreviations(),spaceSeparated,roundingFunction,totalLength});value=data.value,abbreviation+=data.abbreviation,totalLength&&(mantissaPrecision=data.mantissaPrecision)}if(exponential){let data=function computeExponential({value,characteristicPrecision}){let[numberString,exponential]=value.toExponential().split("e"),number=+numberString;return characteristicPrecision?(1<characteristicPrecision&&(number*=Math.pow(10,characteristicPrecision-1),exponential=+exponential-(characteristicPrecision-1),exponential=exponential>=0?`+${exponential}`:exponential),{value:number,abbreviation:`e${exponential}`}):{value:number,abbreviation:`e${exponential}`}}({value,characteristicPrecision});value=data.value,abbreviation=data.abbreviation+abbreviation}let output=function setMantissaPrecision(output,value,optionalMantissa,precision,trim,roundingFunction){if(-1===precision)return output;let result=toFixed(value,precision,roundingFunction),[currentCharacteristic,currentMantissa=""]=result.toString().split(".");if(currentMantissa.match(/^0+$/)&&(optionalMantissa||trim))return currentCharacteristic;let hasTrailingZeroes=currentMantissa.match(/0+$/);return trim&&hasTrailingZeroes?`${currentCharacteristic}.${currentMantissa.toString().slice(0,hasTrailingZeroes.index)}`:result.toString()}(value.toString(),value,optionalMantissa,mantissaPrecision,trimMantissa,roundingFunction);return output=function setCharacteristicPrecision(output,value,optionalCharacteristic,precision){let result=output,[currentCharacteristic,currentMantissa]=result.toString().split(".");if(currentCharacteristic.match(/^-?0$/)&&optionalCharacteristic)return currentMantissa?`${currentCharacteristic.replace("0","")}.${currentMantissa}`:currentCharacteristic.replace("0","");const hasNegativeSign=value<0&&0===currentCharacteristic.indexOf("-");if(hasNegativeSign&&(currentCharacteristic=currentCharacteristic.slice(1),result=result.slice(1)),currentCharacteristic.length<precision){let missingZeros=precision-currentCharacteristic.length;for(let i=0;i<missingZeros;i++)result=`0${result}`}return hasNegativeSign&&(result=`-${result}`),result.toString()}(output,value,optionalCharacteristic,characteristicPrecision),output=function replaceDelimiters(output,value,thousandSeparated,state,decimalSeparator){let delimiters=state.currentDelimiters(),thousandSeparator=delimiters.thousands;decimalSeparator=decimalSeparator||delimiters.decimal;let thousandsSize=delimiters.thousandsSize||3,result=output.toString(),characteristic=result.split(".")[0],mantissa=result.split(".")[1];const hasNegativeSign=value<0&&0===characteristic.indexOf("-");if(thousandSeparated){hasNegativeSign&&(characteristic=characteristic.slice(1));let indexesToInsertThousandDelimiters=function indexesOfGroupSpaces(totalLength,groupSize){let result=[],counter=0;for(let i=totalLength;i>0;i--)counter===groupSize&&(result.unshift(i),counter=0),counter++;return result}(characteristic.length,thousandsSize);indexesToInsertThousandDelimiters.forEach(((position,index)=>{characteristic=characteristic.slice(0,position+index)+thousandSeparator+characteristic.slice(position+index)})),hasNegativeSign&&(characteristic=`-${characteristic}`)}return result=mantissa?characteristic+decimalSeparator+mantissa:characteristic,result}(output,value,thousandSeparated,state,decimalSeparator),(average||exponential)&&(output=function insertAbbreviation(output,abbreviation){return output+abbreviation}(output,abbreviation)),(forceSign||value<0)&&(output=function insertSign(output,value,negative){return 0===value?output:0==+output?output.replace("-",""):value>0?`+${output}`:"sign"===negative?output:`(${output.replace("-","")})`}(output,value,negative)),output}function formatOrDefault(providedFormat,defaultFormat){if(!providedFormat)return defaultFormat;let keys=Object.keys(providedFormat);return 1===keys.length&&"output"===keys[0]?defaultFormat:providedFormat}const BigNumber=bignumberExports;function subtract(n,other,numbro){let value=new BigNumber(n._value),otherValue=other;return numbro.isNumbro(other)&&(otherValue=other._value),otherValue=new BigNumber(otherValue),n._value=value.minus(otherValue).toNumber(),n}const globalState=requireGlobalState(),validator=requireValidating(),loader=(numbro=>({loadLanguagesInNode:tags=>loadLanguagesInNode(tags,numbro)}))(numbro),unformatter=requireUnformatting();let formatter=(numbro=>({format:(...args)=>format(...args,numbro),getByteUnit:(...args)=>function getByteUnit(instance){let data=bytes.general;return getFormatByteUnits(instance._value,data.suffixes,data.scale).suffix}(...args,numbro),getBinaryByteUnit:(...args)=>function getBinaryByteUnit(instance){let data=bytes.binary;return getFormatByteUnits(instance._value,data.suffixes,data.scale).suffix}(...args,numbro),getDecimalByteUnit:(...args)=>function getDecimalByteUnit(instance){let data=bytes.decimal;return getFormatByteUnits(instance._value,data.suffixes,data.scale).suffix}(...args,numbro),formatOrDefault}))(numbro),manipulate=(numbro=>({add:(n,other)=>function add(n,other,numbro){let value=new BigNumber(n._value),otherValue=other;return numbro.isNumbro(other)&&(otherValue=other._value),otherValue=new BigNumber(otherValue),n._value=value.plus(otherValue).toNumber(),n}(n,other,numbro),subtract:(n,other)=>subtract(n,other,numbro),multiply:(n,other)=>function multiply(n,other,numbro){let value=new BigNumber(n._value),otherValue=other;return numbro.isNumbro(other)&&(otherValue=other._value),otherValue=new BigNumber(otherValue),n._value=value.times(otherValue).toNumber(),n}(n,other,numbro),divide:(n,other)=>function divide(n,other,numbro){let value=new BigNumber(n._value),otherValue=other;return numbro.isNumbro(other)&&(otherValue=other._value),otherValue=new BigNumber(otherValue),n._value=value.dividedBy(otherValue).toNumber(),n}(n,other,numbro),set:(n,other)=>function set(n,other,numbro){let value=other;return numbro.isNumbro(other)&&(value=other._value),n._value=value,n}(n,other,numbro),difference:(n,other)=>function difference(n,other,numbro){let clone=numbro(n._value);return subtract(clone,other,numbro),Math.abs(clone._value)}(n,other,numbro),BigNumber}))(numbro);const parsing=parsing$2;class Numbro{constructor(number){this._value=number}clone(){return numbro(this._value)}format(format={}){return formatter.format(this,format)}formatCurrency(format){return"string"==typeof format&&(format=parsing.parseFormat(format)),(format=formatter.formatOrDefault(format,globalState.currentCurrencyDefaultFormat())).output="currency",formatter.format(this,format)}formatTime(format={}){return format.output="time",formatter.format(this,format)}binaryByteUnits(){return formatter.getBinaryByteUnit(this)}decimalByteUnits(){return formatter.getDecimalByteUnit(this)}byteUnits(){return formatter.getByteUnit(this)}difference(other){return manipulate.difference(this,other)}add(other){return manipulate.add(this,other)}subtract(other){return manipulate.subtract(this,other)}multiply(other){return manipulate.multiply(this,other)}divide(other){return manipulate.divide(this,other)}set(input){return manipulate.set(this,normalizeInput(input))}value(){return this._value}valueOf(){return this._value}}function normalizeInput(input){let result=input;return numbro.isNumbro(input)?result=input._value:"string"==typeof input?result=numbro.unformat(input):isNaN(input)&&(result=NaN),result}function numbro(input){return new Numbro(normalizeInput(input))}numbro.version="2.5.0",numbro.isNumbro=function(object){return object instanceof Numbro},numbro.language=globalState.currentLanguage,numbro.registerLanguage=globalState.registerLanguage,numbro.setLanguage=globalState.setLanguage,numbro.languages=globalState.languages,numbro.languageData=globalState.languageData,numbro.zeroFormat=globalState.setZeroFormat,numbro.defaultFormat=globalState.currentDefaults,numbro.setDefaults=globalState.setDefaults,numbro.defaultCurrencyFormat=globalState.currentCurrencyDefaultFormat,numbro.validate=validator.validate,numbro.loadLanguagesInNode=loader.loadLanguagesInNode,numbro.unformat=unformatter.unformat,numbro.BigNumber=manipulate.BigNumber;var numbro$1=getDefaultExportFromCjs(numbro),number=__webpack_require__("./node_modules/handsontable/helpers/number.mjs");function getRenderedValue(value,cellProperties){if((0,number.kf)(value)){const numericFormat=cellProperties.numericFormat,cellCulture=numericFormat&&numericFormat.culture||"-",cellFormatPattern=numericFormat&&numericFormat.pattern;if(void 0!==cellCulture&&!numbro$1.languages()[cellCulture]){const shortTag=cellCulture.replace("-",""),langData=numbro$1.allLanguages?numbro$1.allLanguages[cellCulture]:numbro$1[shortTag];langData&&numbro$1.registerLanguage(langData)}numbro$1.setLanguage(cellCulture),value=numbro$1(value).format(cellFormatPattern||"0")}return value}function numericRenderer(hotInstance,TD,row,col,prop,value,cellProperties){let newValue=value;if((0,number.kf)(newValue)){let classArr=[];if(Array.isArray(cellProperties.className))classArr=cellProperties.className;else{var _cellProperties$class;const className=null!==(_cellProperties$class=cellProperties.className)&&void 0!==_cellProperties$class?_cellProperties$class:"";className.length&&(classArr=className.split(" "))}newValue=getRenderedValue(newValue,cellProperties),classArr.indexOf("htLeft")<0&&classArr.indexOf("htCenter")<0&&classArr.indexOf("htRight")<0&&classArr.indexOf("htJustify")<0&&classArr.push("htRight"),classArr.indexOf("htNumeric")<0&&classArr.push("htNumeric"),cellProperties.className=classArr.join(" "),TD.dir="ltr"}(0,textRenderer.F)(hotInstance,TD,row,col,prop,newValue,cellProperties)}numericRenderer.RENDERER_TYPE="numeric";function passwordRenderer(hotInstance,TD,row,col,prop,value,cellProperties){textRenderer.F.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties]);const hashLength=cellProperties.hashLength||TD.innerHTML.length,hashSymbol=cellProperties.hashSymbol||"*";let hash="";(0,number.Ti)(hashLength-1,(()=>{hash+=hashSymbol})),(0,dom_element.Mv)(TD,hash)}passwordRenderer.RENDERER_TYPE="password";function selectRenderer(hotInstance,TD,row,col,prop,value,cellProperties){textRenderer.F.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties])}selectRenderer.RENDERER_TYPE="select";function timeRenderer(hotInstance,TD,row,col,prop,value,cellProperties){textRenderer.F.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties]),TD.dir="ltr"}timeRenderer.RENDERER_TYPE="time";var renderers_registry=__webpack_require__("./node_modules/handsontable/renderers/registry.mjs");function autocompleteValidator(value,callback){let valueToValidate=value;null==valueToValidate&&(valueToValidate=""),this.allowEmpty&&""===valueToValidate?callback(!0):this.strict&&this.source?"function"==typeof this.source?this.source(valueToValidate,process(valueToValidate,callback)):process(valueToValidate,callback)(this.source):callback(!0)}function process(value,callback){const originalVal=value;return function(source){let found=!1;for(let s=0,slen=source.length;s<slen;s++)if(originalVal===source[s]){found=!0;break}callback(found)}}autocompleteValidator.VALIDATOR_TYPE="autocomplete";function dateValidator(value,callback){const dateEditor=(0,registry.L3)(dateEditor_EDITOR_TYPE,this.instance);let valueToValidate=value,valid=!0;null==valueToValidate&&(valueToValidate="");let isValidFormat=moment_default()(valueToValidate,this.dateFormat||dateEditor.defaultDateFormat,!0).isValid(),isValidDate=moment_default()(new Date(valueToValidate)).isValid()||isValidFormat;if(this.allowEmpty&&""===valueToValidate&&(isValidDate=!0,isValidFormat=!0),isValidDate||(valid=!1),!isValidDate&&isValidFormat&&(valid=!0),isValidDate&&!isValidFormat)if(!0===this.correctFormat){const correctedValue=function correctFormat(value,dateFormat){const dateFromDate=moment_default()(function getNormalizedDate(dateString){const nativeDate=new Date(dateString);return isNaN(new Date(`${dateString}T00:00`).getDate())?nativeDate:new Date(nativeDate.getTime()+6e4*nativeDate.getTimezoneOffset())}(value)),dateFromMoment=moment_default()(value,dateFormat),isAlphanumeric=value.search(/[A-Za-z]/g)>-1;let date;date=dateFromDate.isValid()&&dateFromDate.format("x")===dateFromMoment.format("x")||!dateFromMoment.isValid()||isAlphanumeric?dateFromDate:dateFromMoment;return date.format(dateFormat)}(valueToValidate,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,correctedValue,"dateValidator"),valid=!0}else valid=!1;callback(valid)}dateValidator.VALIDATOR_TYPE="date";function dropdownValidator(value,callback){autocompleteValidator.apply(this,[value,callback])}dropdownValidator.VALIDATOR_TYPE="dropdown";function numericValidator(value,callback){let valueToValidate=value;null==valueToValidate&&(valueToValidate=""),this.allowEmpty&&""===valueToValidate?callback(!0):callback(""!==valueToValidate&&(0,number.kf)(value))}numericValidator.VALIDATOR_TYPE="numeric";const STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function timeValidator(value,callback){const timeFormat=this.timeFormat||"h:mm:ss a";let valid=!0,valueToValidate=value;null===valueToValidate&&(valueToValidate=""),valueToValidate=/^\d{3,}$/.test(valueToValidate)?parseInt(valueToValidate,10):valueToValidate;const twoDigitValue=/^\d{1,2}$/.test(valueToValidate);twoDigitValue&&(valueToValidate+=":00");const date=moment_default()(valueToValidate,STRICT_FORMATS,!0).isValid()?moment_default()(valueToValidate):moment_default()(valueToValidate,timeFormat);let isValidTime=date.isValid(),isValidFormat=moment_default()(valueToValidate,timeFormat,!0).isValid()&&!twoDigitValue;if(this.allowEmpty&&""===valueToValidate&&(isValidTime=!0,isValidFormat=!0),isValidTime||(valid=!1),!isValidTime&&isValidFormat&&(valid=!0),isValidTime&&!isValidFormat)if(!0===this.correctFormat){const correctedValue=date.format(timeFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,correctedValue,"timeValidator"),valid=!0}else valid=!1;callback(valid)}timeValidator.VALIDATOR_TYPE="time";var validators_registry=__webpack_require__("./node_modules/handsontable/validators/registry.mjs");const AutocompleteCellType={CELL_TYPE:"autocomplete",editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},CheckboxCellType={CELL_TYPE:"checkbox",editor:CheckboxEditor,renderer:checkboxRenderer};function dateRenderer(hotInstance,TD,row,col,prop,value,cellProperties){autocompleteRenderer.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties])}dateRenderer.RENDERER_TYPE="date";const DateCellType={CELL_TYPE:"date",editor:DateEditor,renderer:dateRenderer,validator:dateValidator},DropdownCellType={CELL_TYPE:"dropdown",editor:DropdownEditor,renderer:dropdownRenderer,validator:dropdownValidator,filter:!1,strict:!0},HandsontableCellType={CELL_TYPE:"handsontable",editor:HandsontableEditor,renderer:handsontableRenderer},NumericCellType={CELL_TYPE:"numeric",editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number"},PasswordCellType={CELL_TYPE:"password",editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},SelectCellType={CELL_TYPE:"select",editor:SelectEditor,renderer:selectRenderer};var textType=__webpack_require__("./node_modules/handsontable/cellTypes/textType/textType.mjs");const TimeCellType={CELL_TYPE:"time",editor:TimeEditor,renderer:timeRenderer,validator:timeValidator};var cellTypes_registry=__webpack_require__("./node_modules/handsontable/cellTypes/registry.mjs");__webpack_require__("./node_modules/core-js/modules/esnext.iterator.for-each.js");var plugins_registry=__webpack_require__("./node_modules/handsontable/plugins/registry.mjs");function base_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function base_defineProperty(e,r,t){return(r=function base_toPropertyKey(t){var i=function base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function base_classPrivateFieldGet(s,a){return s.get(base_assertClassBrand(s,a))}function base_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const DEPS_TYPE_CHECKERS=new Map([["plugin",plugins_registry.Mt],["cell-type",cellTypes_registry.L4],["editor",registry.aZ],["renderer",renderers_registry.sl],["validator",validators_registry.tR]]),defaultMainSettingSymbol=Symbol("mainSetting"),missingDepsMsgs=[];let initializedPlugins=null;var _hooks=new WeakMap,_BasePlugin_brand=new WeakSet;class BasePlugin{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(hotInstance){!function base_classPrivateMethodInitSpec(e,a){base_checkPrivateRedeclaration(e,a),a.add(e)}(this,_BasePlugin_brand),base_defineProperty(this,"eventManager",new handsontable_eventManager.A(this)),base_defineProperty(this,"pluginName",null),base_defineProperty(this,"pluginsInitializedCallbacks",[]),base_defineProperty(this,"isPluginsReady",!1),base_defineProperty(this,"enabled",!1),base_defineProperty(this,"initialized",!1),function base_classPrivateFieldInitSpec(e,t,a){base_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_hooks,{}),(0,object.LH)(this,"hot",hotInstance,{writable:!1}),initializedPlugins=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(newSettings=>this.onUpdateSettings(newSettings))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const pluginDeps=this.constructor.PLUGIN_DEPS,deps=Array.isArray(pluginDeps)?pluginDeps:[];if(deps.length>0){const missingDependencies=[];if(deps.forEach((dependency=>{const[type,moduleName]=dependency.split(":");if(!DEPS_TYPE_CHECKERS.has(type))throw new Error(`Unknown plugin dependency type "${type}" was found.`);DEPS_TYPE_CHECKERS.get(type)(moduleName)||missingDependencies.push(` - ${moduleName} (${type})`)})),missingDependencies.length>0){const errorMsg=[`The ${this.pluginName} plugin requires the following modules:\n`,`${missingDependencies.join("\n")}\n`].join("");missingDepsMsgs.push(errorMsg)}}initializedPlugins||(initializedPlugins=(0,plugins_registry.f4)()),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));if(0===initializedPlugins.length){if(missingDepsMsgs.length>0){const errorMsg=[`${missingDepsMsgs.join("\n")}\n`,"You have to import and register them manually."].join("");throw missingDepsMsgs.length=0,new Error(errorMsg)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var _this$eventManager;null===(_this$eventManager=this.eventManager)||void 0===_this$eventManager||_this$eventManager.clear(),this.clearHooks(),this.enabled=!1}getSetting(settingName){const pluginSettings=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(void 0===settingName)return pluginSettings;const defaultSettings=this.constructor.DEFAULT_SETTINGS;var _pluginSettings$setti,_pluginSettings$setti2;return(Array.isArray(pluginSettings)||(0,object.Gv)(pluginSettings))&&defaultSettings[defaultMainSettingSymbol]===settingName?Array.isArray(pluginSettings)?pluginSettings:null!==(_pluginSettings$setti=pluginSettings[settingName])&&void 0!==_pluginSettings$setti?_pluginSettings$setti:defaultSettings[settingName]:(0,object.Gv)(pluginSettings)&&null!==(_pluginSettings$setti2=pluginSettings[settingName])&&void 0!==_pluginSettings$setti2?_pluginSettings$setti2:defaultSettings[settingName]}addHook(name,callback,orderIndex){base_classPrivateFieldGet(_hooks,this)[name]=base_classPrivateFieldGet(_hooks,this)[name]||[];const hooks=base_classPrivateFieldGet(_hooks,this)[name];this.hot.addHook(name,callback,orderIndex),hooks.push(callback),base_classPrivateFieldGet(_hooks,this)[name]=hooks}removeHooks(name){(0,array.z0)(base_classPrivateFieldGet(_hooks,this)[name]||[],(callback=>{this.hot.removeHook(name,callback)}))}clearHooks(){const hooks=base_classPrivateFieldGet(_hooks,this);(0,object.v4)(hooks,((callbacks,name)=>this.removeHooks(name))),hooks.length=0}callOnPluginsReady(callback){this.isPluginsReady?callback():this.pluginsInitializedCallbacks.push(callback)}onAfterPluginsInitialized(){(0,array.z0)(this.pluginsInitializedCallbacks,(callback=>callback())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(newSettings){const relevantToSettings=base_assertClassBrand(_BasePlugin_brand,this,_isRelevantToSettings).call(this,newSettings);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&relevantToSettings&&this.updatePlugin(newSettings))}updatePlugin(){}destroy(){var _this$eventManager2;null===(_this$eventManager2=this.eventManager)||void 0===_this$eventManager2||_this$eventManager2.destroy(),this.clearHooks(),(0,object.v4)(this,((value,property)=>{"hot"!==property&&(this[property]=null)})),delete this.t,delete this.hot}}function _isRelevantToSettings(settings){if(!settings)return!1;const settingKeys=this.constructor.SETTING_KEYS;if("boolean"==typeof settingKeys)return settingKeys;for(let i=0;i<settingKeys.length;i++)if(void 0!==settings[settingKeys[i]])return!0;return!1}var feature=__webpack_require__("./node_modules/handsontable/helpers/feature.mjs");function ghostTable_defineProperty(e,r,t){return(r=function ghostTable_toPropertyKey(t){var i=function ghostTable_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const ghostTable=class GhostTable{constructor(hotInstance){ghostTable_defineProperty(this,"hot",null),ghostTable_defineProperty(this,"container",null),ghostTable_defineProperty(this,"injected",!1),ghostTable_defineProperty(this,"rows",[]),ghostTable_defineProperty(this,"columns",[]),ghostTable_defineProperty(this,"samples",null),ghostTable_defineProperty(this,"settings",{useHeaders:!0}),this.hot=hotInstance}addRow(row,samples){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const rowObject={row};this.rows.push(rowObject),this.samples=samples,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(row)),this.table.tr.appendChild(this.createRow(row)),this.container.container.appendChild(this.table.fragment),rowObject.table=this.table.table}addColumnHeadersRow(samples){const colHeader=this.hot.getColHeader(0);if(null!=colHeader){const rowObject={row:-1};this.rows.push(rowObject),this.container=this.createContainer(this.hot.rootElement.className),this.samples=samples,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),rowObject.table=this.table.table}}addColumn(column,samples){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const columnObject={col:column};this.columns.push(columnObject),this.samples=samples,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(column)&&this.hot.view.appendColHeader(column,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(column)),this.container.container.appendChild(this.table.fragment),columnObject.table=this.table.table}getHeights(callback){this.injected||this.injectTable(),(0,array.z0)(this.rows,(row=>{const{height}=row.table.getBoundingClientRect();callback(row.row,Math.ceil(height))}))}getWidths(callback){this.injected||this.injectTable(),(0,array.z0)(this.columns,(column=>{const{width}=column.table.getBoundingClientRect();callback(column.col,Math.ceil(width))}))}setSettings(settings){this.settings=settings}setSetting(name,value){this.settings||(this.settings={}),this.settings[name]=value}getSettings(){return this.settings}getSetting(name){return this.settings?this.settings[name]:null}createColGroupsCol(row){const fragment=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&fragment.appendChild(this.createColElement(-1,-1)),this.samples.forEach((sample=>{(0,array.z0)(sample.strings,(string=>{fragment.appendChild(this.createColElement(string.col,row))}))})),fragment}createRow(row){const{rootDocument}=this.hot,fragment=rootDocument.createDocumentFragment(),th=rootDocument.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(row,th),fragment.appendChild(th)),this.samples.forEach((sample=>{(0,array.z0)(sample.strings,(string=>{const column=string.col,cellProperties=this.hot.getCellMeta(row,column),renderer=this.hot.getCellRenderer(cellProperties),td=rootDocument.createElement("td");td.setAttribute("ghost-table",1),renderer(this.hot,td,row,column,this.hot.colToProp(column),string.value,cellProperties),fragment.appendChild(td)}))})),fragment}appendColumnHeadersRow(){const{rootDocument}=this.hot,domFragment=rootDocument.createDocumentFragment(),columnHeaders=[];if(this.hot.hasRowHeaders()){const th=rootDocument.createElement("th");columnHeaders.push([-1,th]),domFragment.appendChild(th)}this.samples.forEach((sample=>{(0,array.z0)(sample.strings,(string=>{const column=string.col,th=rootDocument.createElement("th");columnHeaders.push([column,th]),domFragment.appendChild(th)}))})),this.table.tHead.appendChild(domFragment),(0,array.z0)(columnHeaders,(columnHeader=>{const[column,th]=columnHeader;this.hot.view.appendColHeader(column,th)}))}createCol(column){const{rootDocument}=this.hot,fragment=rootDocument.createDocumentFragment();return this.samples.forEach((sample=>{(0,array.z0)(sample.strings,(string=>{const row=string.row,cellProperties=this.hot.getCellMeta(row,column),renderer=this.hot.getCellRenderer(cellProperties),td=rootDocument.createElement("td"),tr=rootDocument.createElement("tr");td.setAttribute("ghost-table",1),renderer(this.hot,td,row,column,this.hot.colToProp(column),string.value,cellProperties),tr.appendChild(td),fragment.appendChild(tr)}))})),fragment}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let parent=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((parent||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(column,row){const col=this.hot.rootDocument.createElement("col");let colspan=0;row>=0&&column>=0&&(colspan=this.hot.getCellMeta(row,column).colspan);let width=this.hot.getColWidth(column);if(colspan>1)for(let nextColumn=column+1;nextColumn<column+colspan;nextColumn++)width+=this.hot.getColWidth(nextColumn);return col.style.width=`${width}px`,col}createTable(){let className=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument}=this.hot,fragment=rootDocument.createDocumentFragment(),table=rootDocument.createElement("table"),tHead=rootDocument.createElement("thead"),tBody=rootDocument.createElement("tbody"),colGroup=rootDocument.createElement("colgroup"),tr=rootDocument.createElement("tr"),th=rootDocument.createElement("th");return this.isVertical()&&table.appendChild(colGroup),this.isHorizontal()&&(tr.appendChild(th),tHead.appendChild(tr),table.style.tableLayout="auto",table.style.width="auto"),table.appendChild(tHead),this.isVertical()&&tBody.appendChild(tr),table.appendChild(tBody),(0,dom_element.iQ)(table,className),fragment.appendChild(table),{fragment,table,tHead,tBody,colGroup,tr,th}}createContainer(){let className=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument}=this.hot,fragment=rootDocument.createDocumentFragment(),container=rootDocument.createElement("div"),containerClassName=`htGhostTable htAutoSize ${className.trim()}`;return(0,dom_element.iQ)(container,containerClassName),fragment.appendChild(container),{fragment,container}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function samplesGenerator_defineProperty(e,r,t){return(r=function samplesGenerator_toPropertyKey(t){var i=function samplesGenerator_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class SamplesGenerator{static get SAMPLE_COUNT(){return 3}constructor(dataFactory){samplesGenerator_defineProperty(this,"samples",null),samplesGenerator_defineProperty(this,"dataFactory",null),samplesGenerator_defineProperty(this,"customSampleCount",null),samplesGenerator_defineProperty(this,"allowDuplicates",!1),this.dataFactory=dataFactory}getSampleCount(){return this.customSampleCount?this.customSampleCount:SamplesGenerator.SAMPLE_COUNT}setSampleCount(sampleCount){this.customSampleCount=sampleCount}setAllowDuplicates(allowDuplicates){this.allowDuplicates=allowDuplicates}generateRowSamples(rowRange,colRange){return this.generateSamples("row",colRange,rowRange)}generateColumnSamples(colRange,rowRange){return this.generateSamples("col",rowRange,colRange)}generateSamples(type,range,specifierRange){const samples=new Map,{from,to}="number"==typeof specifierRange?{from:specifierRange,to:specifierRange}:specifierRange;return(0,number.Ti)(from,to,(index=>{const sample=this.generateSample(type,range,index);samples.set(index,sample)})),samples}generateSample(type,range,specifierValue){if("row"!==type&&"col"!==type)throw new Error("Unsupported sample type");const samples=new Map,computedKey="row"===type?"col":"row",sampledValues=[];return(0,number.Ti)(range.from,range.to,(index=>{const data="row"===type?this.dataFactory(specifierValue,index):this.dataFactory(index,specifierValue);if(!1===data)return;const{value,bundleSeed}=data,hasCustomBundleSeed="string"==typeof bundleSeed&&bundleSeed.length>0;let seed;seed=hasCustomBundleSeed?bundleSeed:(0,object.Gv)(value)?`${Object.keys(value).length}`:Array.isArray(value)?`${value.length}`:`${(0,mixed.As)(value).length}`,samples.has(seed)||samples.set(seed,{needed:this.getSampleCount(),strings:[]});const sample=samples.get(seed);if(sample.needed){(!(sampledValues.indexOf(value)>-1)||this.allowDuplicates||hasCustomBundleSeed)&&(sample.strings.push({value,[computedKey]:index}),sampledValues.push(value),sample.needed-=1)}})),samples}}const samplesGenerator=SamplesGenerator;var viewportColumns=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/calculator/viewportColumns.mjs"),physicalIndexToValueMap=__webpack_require__("./node_modules/handsontable/translations/maps/physicalIndexToValueMap.mjs");function autoColumnSize_classPrivateFieldInitSpec(e,t,a){autoColumnSize_checkPrivateRedeclaration(e,t),t.set(e,a)}function autoColumnSize_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function autoColumnSize_defineProperty(e,r,t){return(r=function autoColumnSize_toPropertyKey(t){var i=function autoColumnSize_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function autoColumnSize_classPrivateFieldGet(s,a){return s.get(autoColumnSize_assertClassBrand(s,a))}function _classPrivateFieldSet(s,a,r){return s.set(autoColumnSize_assertClassBrand(s,a),r),r}function autoColumnSize_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("modifyAutoColumnSizeSeed");var _cachedColumnHeaders=new WeakMap,_visualColumnsToRefresh=new WeakMap,_AutoColumnSize_brand=new WeakSet;class AutoColumnSize extends BasePlugin{static get PLUGIN_KEY(){return"autoColumnSize"}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(hotInstance){super(hotInstance),function autoColumnSize_classPrivateMethodInitSpec(e,a){autoColumnSize_checkPrivateRedeclaration(e,a),a.add(e)}(this,_AutoColumnSize_brand),autoColumnSize_defineProperty(this,"ghostTable",new ghostTable(this.hot)),autoColumnSize_defineProperty(this,"samplesGenerator",new samplesGenerator(((row,column)=>{const physicalRow=this.hot.toPhysicalRow(row),physicalColumn=this.hot.toPhysicalColumn(column);if(this.hot.rowIndexMapper.isHidden(physicalRow)||this.hot.columnIndexMapper.isHidden(physicalColumn))return!1;const cellMeta=this.hot.getCellMeta(row,column);let cellValue="";cellMeta.spanned||(cellValue=this.hot.getDataAtCell(row,column));let bundleSeed="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(bundleSeed=this.hot.runHooks("modifyAutoColumnSizeSeed",bundleSeed,cellMeta,cellValue)),{value:cellValue,bundleSeed}}))),autoColumnSize_defineProperty(this,"inProgress",!1),autoColumnSize_defineProperty(this,"measuredColumns",0),autoColumnSize_defineProperty(this,"columnWidthsMap",new physicalIndexToValueMap._),autoColumnSize_classPrivateFieldInitSpec(this,_cachedColumnHeaders,[]),autoColumnSize_classPrivateFieldInitSpec(this,_visualColumnsToRefresh,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",((size,column,isDblClick)=>autoColumnSize_assertClassBrand(_AutoColumnSize_brand,this,_onBeforeColumnResize).call(this,size,column,isDblClick)))}isEnabled(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}enablePlugin(){var _this=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const samplingRatio=this.getSetting("samplingRatio");samplingRatio&&!isNaN(samplingRatio)&&this.samplesGenerator.setSampleCount(parseInt(samplingRatio,10)),this.addHook("afterLoadData",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return autoColumnSize_assertClassBrand(_AutoColumnSize_brand,_this,_onAfterLoadData).call(_this,...args)})),this.addHook("beforeChangeRender",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return autoColumnSize_assertClassBrand(_AutoColumnSize_brand,_this,_onBeforeChange).call(_this,...args)})),this.addHook("afterFormulasValuesUpdate",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return autoColumnSize_assertClassBrand(_AutoColumnSize_brand,_this,_onAfterFormulasValuesUpdate).call(_this,...args)})),this.addHook("beforeRender",(()=>autoColumnSize_assertClassBrand(_AutoColumnSize_brand,this,_onBeforeRender).call(this))),this.addHook("modifyColWidth",((width,col)=>this.getColumnWidth(col,width))),this.addHook("init",(()=>autoColumnSize_assertClassBrand(_AutoColumnSize_brand,this,_onInit).call(this))),super.enablePlugin()}updatePlugin(){_classPrivateFieldSet(_visualColumnsToRefresh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((size,column,isDblClick)=>autoColumnSize_assertClassBrand(_AutoColumnSize_brand,this,_onBeforeColumnResize).call(this,size,column,isDblClick)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const firstVisibleColumn=this.getFirstVisibleColumn(),lastVisibleColumn=this.getLastVisibleColumn();if(-1===firstVisibleColumn||-1===lastVisibleColumn)return;const overwriteCache=this.hot.renderCall;this.calculateColumnsWidth({from:firstVisibleColumn,to:lastVisibleColumn},void 0,overwriteCache)}calculateColumnsWidth(){let colRange=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},rowRange=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},overwriteCache=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const columnsRange="number"==typeof colRange?{from:colRange,to:colRange}:colRange,rowsRange="number"==typeof rowRange?{from:rowRange,to:rowRange}:rowRange;(0,number.Ti)(columnsRange.from,columnsRange.to,(visualColumn=>{let physicalColumn=this.hot.toPhysicalColumn(visualColumn);if(null===physicalColumn&&(physicalColumn=visualColumn),overwriteCache||null===this.columnWidthsMap.getValueAtIndex(physicalColumn)&&!this.hot._getColWidthFromSettings(physicalColumn)){this.samplesGenerator.generateColumnSamples(visualColumn,rowsRange).forEach(((sample,column)=>this.ghostTable.addColumn(column,sample)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((visualColumn,width)=>{const physicalColumn=this.hot.toPhysicalColumn(visualColumn);this.columnWidthsMap.setValueAtIndex(physicalColumn,width)}))}),!0),this.measuredColumns=columnsRange.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let rowRange=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},overwriteCache=arguments.length>1&&void 0!==arguments[1]&&arguments[1],current=0;const length=this.hot.countCols()-1;let timer=null;this.inProgress=!0;const loop=()=>{if(!this.hot)return(0,feature.uU)(timer),void(this.inProgress=!1);this.calculateColumnsWidth({from:current,to:Math.min(current+AutoColumnSize.CALCULATION_STEP,length)},rowRange,overwriteCache),current=current+AutoColumnSize.CALCULATION_STEP+1,current<length?timer=(0,feature.xi)(loop):((0,feature.uU)(timer),this.inProgress=!1,this.hot.view.adjustElementsSize())},syncLimit=this.getSyncCalculationLimit();syncLimit>=0&&(this.calculateColumnsWidth({from:0,to:syncLimit},rowRange,overwriteCache),current=syncLimit+1),current<length?loop():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const settings=this.hot.getSettings().autoColumnSize;let limit=AutoColumnSize.SYNC_CALCULATION_LIMIT;const colsLimit=this.hot.countCols()-1;return(0,object.Gv)(settings)&&(limit=settings.syncLimit,(0,string.Pi)(limit)?limit=(0,number.B5)(colsLimit,limit):limit>>=0),Math.min(limit,colsLimit)}getColumnWidth(column,defaultWidth){let keepMinimum=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],width=defaultWidth;return void 0===width&&(width=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(column)),keepMinimum&&"number"==typeof width&&(width=Math.max(width,viewportColumns.j))),width}getFirstVisibleColumn(){var _this$hot$getFirstRen;return null!==(_this$hot$getFirstRen=this.hot.getFirstRenderedVisibleColumn())&&void 0!==_this$hot$getFirstRen?_this$hot$getFirstRen:-1}getLastVisibleColumn(){var _this$hot$getLastRend;return null!==(_this$hot$getLastRend=this.hot.getLastRenderedVisibleColumn())&&void 0!==_this$hot$getLastRend?_this$hot$getLastRend:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce(((acc,columnTitle,physicalColumn)=>{const cachedColumnsLength=autoColumnSize_classPrivateFieldGet(_cachedColumnHeaders,this).length;return(cachedColumnsLength-1<physicalColumn||autoColumnSize_classPrivateFieldGet(_cachedColumnHeaders,this)[physicalColumn]!==columnTitle)&&acc.push(this.hot.toVisualColumn(physicalColumn)),cachedColumnsLength-1<physicalColumn?autoColumnSize_classPrivateFieldGet(_cachedColumnHeaders,this).push(columnTitle):autoColumnSize_classPrivateFieldGet(_cachedColumnHeaders,this)[physicalColumn]=columnTitle,acc}),[])}clearCache(physicalColumns){Array.isArray(physicalColumns)?this.hot.batchExecution((()=>{physicalColumns.forEach((physicalIndex=>{this.columnWidthsMap.setValueAtIndex(physicalIndex,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter((item=>null===item)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificColumnsWidth(visualColumns){const rowsRange={from:0,to:this.hot.countRows()-1};visualColumns.forEach((visualColumn=>{const physicalColumn=this.hot.toPhysicalColumn(visualColumn);if(null!==physicalColumn&&!this.hot._getColWidthFromSettings(physicalColumn)){this.samplesGenerator.generateColumnSamples(visualColumn,rowsRange).forEach(((sample,column)=>this.ghostTable.addColumn(column,sample)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((visualColumn,width)=>{const physicalColumn=this.hot.toPhysicalColumn(visualColumn);this.columnWidthsMap.setValueAtIndex(physicalColumn,width)}))}),!0),this.ghostTable.clean())}function _onBeforeRender(){this.calculateVisibleColumnsWidth(),this.inProgress||(autoColumnSize_assertClassBrand(_AutoColumnSize_brand,this,_calculateSpecificColumnsWidth).call(this,autoColumnSize_classPrivateFieldGet(_visualColumnsToRefresh,this)),_classPrivateFieldSet(_visualColumnsToRefresh,this,[]))}function _onAfterLoadData(sourceData,isFirstLoad){isFirstLoad||this.recalculateAllColumnsWidth()}function _onBeforeChange(changes){const changedColumns=changes.reduce(((acc,_ref)=>{let[,columnProperty]=_ref;const visualColumn=this.hot.propToCol(columnProperty);return Number.isInteger(visualColumn)&&-1===acc.indexOf(visualColumn)&&acc.push(visualColumn),acc}),[]);autoColumnSize_classPrivateFieldGet(_visualColumnsToRefresh,this).push(...changedColumns)}function _onBeforeColumnResize(size,column,isDblClick){let newSize=size;return isDblClick&&(this.calculateColumnsWidth(column,void 0,!0),newSize=this.getColumnWidth(column,void 0,!1)),newSize}function _onInit(){_classPrivateFieldSet(_cachedColumnHeaders,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function _onAfterFormulasValuesUpdate(changes){const changedColumns=changes.reduce(((acc,change)=>{var _change$address;const physicalColumn=null===(_change$address=change.address)||void 0===_change$address?void 0:_change$address.col;if(Number.isInteger(physicalColumn)){const visualColumn=this.hot.toVisualColumn(physicalColumn);-1===acc.indexOf(visualColumn)&&acc.push(visualColumn)}return acc}),[]);autoColumnSize_classPrivateFieldGet(_visualColumnsToRefresh,this).push(...changedColumns)}const DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function autofill_classPrivateMethodInitSpec(e,a){(function autofill_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function autofill_defineProperty(e,r,t){return(r=function autofill_toPropertyKey(t){var i=function autofill_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function autofill_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("modifyAutofillRange"),hooks.R.getSingleton().register("beforeAutofill"),hooks.R.getSingleton().register("afterAutofill");const SETTING_KEYS=["fillHandle"];var _Autofill_brand=new WeakSet;class Autofill extends BasePlugin{constructor(){super(...arguments),autofill_classPrivateMethodInitSpec(this,_Autofill_brand),autofill_defineProperty(this,"addingStarted",!1),autofill_defineProperty(this,"mouseDownOnCellCorner",!1),autofill_defineProperty(this,"mouseDragOutside",!1),autofill_defineProperty(this,"handleDraggedCells",0),autofill_defineProperty(this,"directions",[]),autofill_defineProperty(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return"autofill"}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return["autofill",...SETTING_KEYS]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(event=>autofill_assertClassBrand(_Autofill_brand,this,_onAfterCellCornerMouseDown).call(this,event))),this.addHook("afterOnCellCornerDblClick",(event=>autofill_assertClassBrand(_Autofill_brand,this,_onCellCornerDblClick).call(this,event))),this.addHook("beforeOnCellMouseOver",((_,coords)=>autofill_assertClassBrand(_Autofill_brand,this,_onBeforeCellMouseOver).call(this,coords))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const selection=this.hot.getSelectedRangeLast(),{row:startRow,col:startCol}=selection.getTopStartCorner(),{row:endRow,col:endCol}=selection.getBottomEndCorner(),copyableRanges=this.hot.runHooks("modifyCopyableRange",[{startRow,startCol,endRow,endCol}]),copyableRows=[],copyableColumns=[],data=[];return(0,array.z0)(copyableRanges,(range=>{for(let visualRow=range.startRow;visualRow<=range.endRow;visualRow+=1)-1===copyableRows.indexOf(visualRow)&&copyableRows.push(visualRow);for(let visualColumn=range.startCol;visualColumn<=range.endCol;visualColumn+=1)-1===copyableColumns.indexOf(visualColumn)&&copyableColumns.push(visualColumn)})),(0,array.z0)(copyableRows,(row=>{const rowSet=[];(0,array.z0)(copyableColumns,(column=>{rowSet.push(this.hot.getCopyableData(row,column))})),data.push(rowSet)})),data}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[fillStartRow,fillStartColumn,fillEndRow,fillEndColumn]=this.hot.selection.highlight.getFill().getVisualCorners(),selectionRangeLast=this.hot.getSelectedRangeLast(),topStartCorner=selectionRangeLast.getTopStartCorner(),bottomEndCorner=selectionRangeLast.getBottomEndCorner();this.resetSelectionOfDraggedArea();const cornersOfSelectedCells=[topStartCorner.row,topStartCorner.col,bottomEndCorner.row,bottomEndCorner.col],cornersOfSelectionAndDragAreas=this.hot.runHooks("modifyAutofillRange",[Math.min(topStartCorner.row,fillStartRow),Math.min(topStartCorner.col,fillStartColumn),Math.max(bottomEndCorner.row,fillEndRow),Math.max(bottomEndCorner.col,fillEndColumn)],cornersOfSelectedCells),{directionOfDrag,startOfDragCoords,endOfDragCoords}=function getDragDirectionAndRange(startSelection,endSelection,cellCoordsFactory){let startOfDragCoords,endOfDragCoords,directionOfDrag;return endSelection[0]===startSelection[0]&&endSelection[1]<startSelection[1]?(directionOfDrag="left",startOfDragCoords=cellCoordsFactory(endSelection[0],endSelection[1]),endOfDragCoords=cellCoordsFactory(endSelection[2],startSelection[1]-1)):endSelection[2]===startSelection[2]&&endSelection[0]===startSelection[0]&&endSelection[3]>startSelection[3]?(directionOfDrag="right",startOfDragCoords=cellCoordsFactory(endSelection[0],startSelection[3]+1),endOfDragCoords=cellCoordsFactory(endSelection[2],endSelection[3])):endSelection[0]<startSelection[0]&&endSelection[1]===startSelection[1]?(directionOfDrag="up",startOfDragCoords=cellCoordsFactory(endSelection[0],endSelection[1]),endOfDragCoords=cellCoordsFactory(startSelection[0]-1,endSelection[3])):endSelection[2]>startSelection[2]&&endSelection[1]===startSelection[1]&&(directionOfDrag="down",startOfDragCoords=cellCoordsFactory(startSelection[2]+1,endSelection[1]),endOfDragCoords=cellCoordsFactory(endSelection[2],endSelection[3])),startOfDragCoords&&startOfDragCoords.normalize(),endOfDragCoords&&endOfDragCoords.normalize(),{directionOfDrag,startOfDragCoords,endOfDragCoords}}(cornersOfSelectedCells,cornersOfSelectionAndDragAreas,((row,column)=>this.hot._createCellCoords(row,column)));if(startOfDragCoords&&startOfDragCoords.row>-1&&startOfDragCoords.col>-1){const selectionData=this.getSelectionData(),sourceRange=selectionRangeLast.clone(),targetRange=this.hot._createCellRange(startOfDragCoords,startOfDragCoords,endOfDragCoords),beforeAutofillHookResult=this.hot.runHooks("beforeAutofill",selectionData,sourceRange,targetRange,directionOfDrag);if(!1===beforeAutofillHookResult)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let fillData=beforeAutofillHookResult;const res=beforeAutofillHookResult;if(["up","left"].indexOf(directionOfDrag)>-1&&(1!==res.length||0!==res[0].length))if(fillData=[],"up"===directionOfDrag){const dragLength=endOfDragCoords.row-startOfDragCoords.row+1,fillOffset=dragLength%res.length;for(let i=0;i<dragLength;i++)fillData.push(res[(i+(res.length-fillOffset))%res.length])}else{const dragLength=endOfDragCoords.col-startOfDragCoords.col+1,fillOffset=dragLength%res[0].length;for(let i=0;i<res.length;i++){fillData.push([]);for(let j=0;j<dragLength;j++)fillData[i].push(res[i][(j+(res[i].length-fillOffset))%res[i].length])}}this.hot.populateFromArray(startOfDragCoords.row,startOfDragCoords.col,fillData,endOfDragCoords.row,endOfDragCoords.col,`${this.pluginName}.fill`,null),this.setSelection(cornersOfSelectionAndDragAreas),this.hot.runHooks("afterAutofill",fillData,sourceRange,targetRange,directionOfDrag),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(coords){return coords.row<0&&(coords.row=0),coords.col<0&&(coords.col=0),coords}getCoordsOfDragAndDropBorders(coordsOfSelection){const currentSelection=this.hot.getSelectedRangeLast(),bottomRightCorner=currentSelection.getBottomEndCorner();let coords=coordsOfSelection;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){const topStartCorner=currentSelection.getTopStartCorner();(bottomRightCorner.col<=coordsOfSelection.col||topStartCorner.col>=coordsOfSelection.col)&&(coords=this.hot._createCellCoords(bottomRightCorner.row,coordsOfSelection.col)),(bottomRightCorner.row<coordsOfSelection.row||topStartCorner.row>coordsOfSelection.row)&&(coords=this.hot._createCellCoords(coordsOfSelection.row,bottomRightCorner.col))}else if(this.directions.includes(DIRECTIONS.vertical))coords=this.hot._createCellCoords(coordsOfSelection.row,bottomRightCorner.col);else{if(!this.directions.includes(DIRECTIONS.horizontal))return;coords=this.hot._createCellCoords(bottomRightCorner.row,coordsOfSelection.col)}return this.reduceSelectionAreaIfNeeded(coords)}showBorder(coordsOfSelection){const coordsOfDragAndDropBorders=this.getCoordsOfDragAndDropBorders(coordsOfSelection);coordsOfDragAndDropBorders&&this.redrawBorders(coordsOfDragAndDropBorders)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const cornersOfSelectedCells=this.hot.getSelectedLast(),cornersOfSelectedDragArea=this.hot.selection.highlight.getFill().getVisualCorners(),nrOfTableRows=this.hot.countRows();cornersOfSelectedCells[2]<nrOfTableRows-1&&cornersOfSelectedDragArea[2]===nrOfTableRows-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(cornersOfSelectedCells){const data=this.hot.getData(),nrOfTableRows=this.hot.countRows();let lastFilledInRowIndex;for(let rowIndex=cornersOfSelectedCells[2]+1;rowIndex<nrOfTableRows;rowIndex++){for(let columnIndex=cornersOfSelectedCells[1];columnIndex<=cornersOfSelectedCells[3];columnIndex++){const dataInCell=data[rowIndex][columnIndex];if(!(0,mixed.Im)(dataInCell))return-1}const dataInNextLeftCell=data[rowIndex][cornersOfSelectedCells[1]-1],dataInNextRightCell=data[rowIndex][cornersOfSelectedCells[3]+1];(0,mixed.Im)(dataInNextLeftCell)&&(0,mixed.Im)(dataInNextRightCell)||(lastFilledInRowIndex=rowIndex)}return lastFilledInRowIndex}addSelectionFromStartAreaToSpecificRowIndex(selectStartArea,rowIndex){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(selectStartArea[0],selectStartArea[1])).add(this.hot._createCellCoords(rowIndex,selectStartArea[3])).commit()}setSelection(cornersOfArea){this.hot.selectCell(...(0,array.YD)(cornersOfArea,(index=>Math.max(index,0))),!1,!1)}selectAdjacent(){const cornersOfSelectedCells=this.hot.getSelectedLast(),lastFilledInRowIndex=this.getIndexOfLastAdjacentFilledInRow(cornersOfSelectedCells);return-1!==lastFilledInRowIndex&&void 0!==lastFilledInRowIndex&&(this.addSelectionFromStartAreaToSpecificRowIndex(cornersOfSelectedCells,lastFilledInRowIndex),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(coords){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(coords).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(event){const{documentElement}=this.hot.rootDocument,tableBottom=(0,dom_element.cY)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||documentElement.scrollTop)+(0,dom_element.DK)(this.hot.table),tableRight=(0,dom_element.cY)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||documentElement.scrollLeft)+(0,dom_element.Gq)(this.hot.table);return event.clientY>tableBottom&&event.clientX<=tableRight}registerEvents(){const{documentElement}=this.hot.rootDocument;this.eventManager.addEventListener(documentElement,"mouseup",(()=>autofill_assertClassBrand(_Autofill_brand,this,_onMouseUp).call(this))),this.eventManager.addEventListener(documentElement,"mousemove",(event=>autofill_assertClassBrand(_Autofill_brand,this,_onMouseMove).call(this,event)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const mappedSettings=function getMappedFillHandleSetting(fillHandle){const mappedSettings={};return!0===fillHandle?(mappedSettings.directions=Object.keys(DIRECTIONS),mappedSettings.autoInsertRow=!0):(0,object.Gv)(fillHandle)?((0,mixed.O9)(fillHandle.autoInsertRow)?fillHandle.direction===DIRECTIONS.horizontal?mappedSettings.autoInsertRow=!1:mappedSettings.autoInsertRow=fillHandle.autoInsertRow:mappedSettings.autoInsertRow=!1,(0,mixed.O9)(fillHandle.direction)?mappedSettings.directions=[fillHandle.direction]:mappedSettings.directions=Object.keys(DIRECTIONS)):"string"==typeof fillHandle?(mappedSettings.directions=[fillHandle],mappedSettings.autoInsertRow=!0):(mappedSettings.directions=[],mappedSettings.autoInsertRow=!1),mappedSettings}(this.hot.getSettings().fillHandle);this.directions=mappedSettings.directions,this.autoInsertRow=mappedSettings.autoInsertRow}destroy(){super.destroy()}}function _onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}function _onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _onBeforeCellMouseOver(coords){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(coords),this.addNewRowIfNeeded())}function _onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function _onMouseMove(event){const mouseWasDraggedOutside=this.getIfMouseWasDraggedOutside(event);!1===this.addingStarted&&this.handleDraggedCells>0&&mouseWasDraggedOutside?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function autoRowSize_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function autoRowSize_defineProperty(e,r,t){return(r=function autoRowSize_toPropertyKey(t){var i=function autoRowSize_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function autoRowSize_classPrivateFieldGet(s,a){return s.get(autoRowSize_assertClassBrand(s,a))}function autoRowSize_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _visualRowsToRefresh=new WeakMap,_AutoRowSize_brand=new WeakSet;class AutoRowSize extends BasePlugin{static get PLUGIN_KEY(){return"autoRowSize"}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(hotInstance){super(hotInstance),function autoRowSize_classPrivateMethodInitSpec(e,a){autoRowSize_checkPrivateRedeclaration(e,a),a.add(e)}(this,_AutoRowSize_brand),autoRowSize_defineProperty(this,"headerHeight",null),autoRowSize_defineProperty(this,"ghostTable",new ghostTable(this.hot)),autoRowSize_defineProperty(this,"samplesGenerator",new samplesGenerator(((row,column)=>{const physicalRow=this.hot.toPhysicalRow(row),physicalColumn=this.hot.toPhysicalColumn(column);if(this.hot.rowIndexMapper.isHidden(physicalRow)||this.hot.columnIndexMapper.isHidden(physicalColumn))return!1;if(row>=0&&column>=0){if(this.hot.getCellMeta(row,column).hidden)return!1}let cellValue;return row>=0?cellValue=this.hot.getDataAtCell(row,column):-1===row&&(cellValue=this.hot.getColHeader(column)),{value:cellValue}}))),autoRowSize_defineProperty(this,"inProgress",!1),autoRowSize_defineProperty(this,"measuredRows",0),autoRowSize_defineProperty(this,"rowHeightsMap",new physicalIndexToValueMap._),function autoRowSize_classPrivateFieldInitSpec(e,t,a){autoRowSize_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_visualRowsToRefresh,[]),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",((size,row,isDblClick)=>autoRowSize_assertClassBrand(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,size,row,isDblClick)))}isEnabled(){const settings=this.hot.getSettings().autoRowSize;return!0===settings||(0,object.Gv)(settings)}enablePlugin(){var _this=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const samplingRatio=this.getSetting("samplingRatio");samplingRatio&&!isNaN(samplingRatio)&&this.samplesGenerator.setSampleCount(parseInt(samplingRatio,10)),this.addHook("afterLoadData",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return autoRowSize_assertClassBrand(_AutoRowSize_brand,_this,autoRowSize_onAfterLoadData).call(_this,...args)})),this.addHook("beforeChangeRender",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return autoRowSize_assertClassBrand(_AutoRowSize_brand,_this,autoRowSize_onBeforeChange).call(_this,...args)})),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("afterFormulasValuesUpdate",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return autoRowSize_assertClassBrand(_AutoRowSize_brand,_this,autoRowSize_onAfterFormulasValuesUpdate).call(_this,...args)})),this.addHook("beforeRender",(()=>autoRowSize_assertClassBrand(_AutoRowSize_brand,this,autoRowSize_onBeforeRender).call(this))),this.addHook("modifyRowHeight",((height,row)=>this.getRowHeight(row,height))),this.addHook("init",(()=>autoRowSize_assertClassBrand(_AutoRowSize_brand,this,autoRowSize_onInit).call(this))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((size,row,isDblClick)=>autoRowSize_assertClassBrand(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,size,row,isDblClick)))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const firstVisibleRow=this.getFirstVisibleRow(),lastVisibleRow=this.getLastVisibleRow();if(-1===firstVisibleRow||-1===lastVisibleRow)return;const overwriteCache=this.hot.renderCall;this.calculateRowsHeight({from:firstVisibleRow,to:lastVisibleRow},void 0,overwriteCache)}calculateRowsHeight(){let rowRange=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},colRange=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},overwriteCache=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const rowsRange="number"==typeof rowRange?{from:rowRange,to:rowRange}:rowRange,columnsRange="number"==typeof colRange?{from:colRange,to:colRange}:colRange;if(null!==this.hot.getColHeader(0)){const samples=this.samplesGenerator.generateRowSamples(-1,columnsRange);this.ghostTable.addColumnHeadersRow(samples.get(-1))}(0,number.Ti)(rowsRange.from,rowsRange.to,(visualRow=>{let physicalRow=this.hot.toPhysicalRow(visualRow);if(null===physicalRow&&(physicalRow=visualRow),overwriteCache||null===this.rowHeightsMap.getValueAtIndex(physicalRow)){this.samplesGenerator.generateRowSamples(visualRow,columnsRange).forEach(((sample,row)=>this.ghostTable.addRow(row,sample)))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((row,height)=>{row<0?this.headerHeight=height:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(row),height)}))}),!0),this.measuredRows=rowsRange.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let colRange=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},overwriteCache=arguments.length>1&&void 0!==arguments[1]&&arguments[1],current=0;const length=this.hot.countRows()-1;let timer=null;this.inProgress=!0;const loop=()=>{if(!this.hot)return(0,feature.uU)(timer),void(this.inProgress=!1);this.calculateRowsHeight({from:current,to:Math.min(current+AutoRowSize.CALCULATION_STEP,length)},colRange,overwriteCache),current=current+AutoRowSize.CALCULATION_STEP+1,current<length?timer=(0,feature.xi)(loop):((0,feature.uU)(timer),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},syncLimit=this.getSyncCalculationLimit();syncLimit>=0&&(this.calculateRowsHeight({from:0,to:syncLimit},colRange,overwriteCache),current=syncLimit+1),current<length?loop():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const settings=this.hot.getSettings().autoRowSize;let limit=AutoRowSize.SYNC_CALCULATION_LIMIT;const rowsLimit=this.hot.countRows()-1;return(0,object.Gv)(settings)&&(limit=settings.syncLimit,(0,string.Pi)(limit)?limit=(0,number.B5)(rowsLimit,limit):limit>>=0),Math.min(limit,rowsLimit)}getRowHeight(row,defaultHeight){const cachedHeight=row<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(row));let height=defaultHeight;return null!==cachedHeight&&cachedHeight>(defaultHeight||0)&&(height=cachedHeight),height}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var _this$hot$getFirstRen;return null!==(_this$hot$getFirstRen=this.hot.getFirstRenderedVisibleRow())&&void 0!==_this$hot$getFirstRen?_this$hot$getFirstRen:-1}getLastVisibleRow(){var _this$hot$getLastRend;return null!==(_this$hot$getLastRend=this.hot.getLastRenderedVisibleRow())&&void 0!==_this$hot$getLastRend?_this$hot$getLastRend:-1}clearCache(physicalRows){this.headerHeight=null,Array.isArray(physicalRows)?this.hot.batchExecution((()=>{physicalRows.forEach((physicalIndex=>{this.rowHeightsMap.setValueAtIndex(physicalIndex,null)}))}),!0):this.rowHeightsMap.clear()}clearCacheByRange(range){const{from,to}="number"==typeof range?{from:range,to:range}:range;this.hot.batchExecution((()=>{(0,number.Ti)(Math.min(from,to),Math.max(from,to),(row=>{this.rowHeightsMap.setValueAtIndex(row,null)}))}),!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter((item=>null===item)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificRowsHeight(visualRows){const columnsRange={from:0,to:this.hot.countCols()-1};visualRows.forEach((visualRow=>{this.samplesGenerator.generateRowSamples(visualRow,columnsRange).forEach(((sample,row)=>this.ghostTable.addRow(row,sample)))})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((visualRow,height)=>{const physicalRow=this.hot.toPhysicalRow(visualRow);this.rowHeightsMap.setValueAtIndex(physicalRow,height)}))}),!0),this.ghostTable.clean())}function autoRowSize_onBeforeRender(){this.calculateVisibleRowsHeight(),this.inProgress||(autoRowSize_assertClassBrand(_AutoRowSize_brand,this,_calculateSpecificRowsHeight).call(this,autoRowSize_classPrivateFieldGet(_visualRowsToRefresh,this)),function autoRowSize_classPrivateFieldSet(s,a,r){return s.set(autoRowSize_assertClassBrand(s,a),r),r}(_visualRowsToRefresh,this,[]))}function _onBeforeRowResize(size,row,isDblClick){let newSize=size;return isDblClick&&(this.calculateRowsHeight(row,void 0,!0),newSize=this.getRowHeight(row)),newSize}function autoRowSize_onAfterLoadData(sourceData,isFirstLoad){isFirstLoad||this.recalculateAllRowsHeight()}function autoRowSize_onBeforeChange(changes){const changedRows=changes.reduce(((acc,_ref)=>{let[row]=_ref;return-1===acc.indexOf(row)&&acc.push(row),acc}),[]);autoRowSize_classPrivateFieldGet(_visualRowsToRefresh,this).push(...changedRows)}function autoRowSize_onInit(){this.recalculateAllRowsHeight()}function autoRowSize_onAfterFormulasValuesUpdate(changes){const changedRows=changes.reduce(((acc,change)=>{var _change$address;const physicalRow=null===(_change$address=change.address)||void 0===_change$address?void 0:_change$address.row;if(Number.isInteger(physicalRow)){const visualRow=this.hot.toVisualRow(physicalRow);-1===acc.indexOf(visualRow)&&acc.push(visualRow)}return acc}),[]);autoRowSize_classPrivateFieldGet(_visualRowsToRefresh,this).push(...changedRows)}var indexesSequence=__webpack_require__("./node_modules/handsontable/translations/maps/utils/indexesSequence.mjs"),physicallyIndexed=__webpack_require__("./node_modules/handsontable/translations/maps/utils/physicallyIndexed.mjs");const alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:indexesSequence.N,getListWithRemovedItems:indexesSequence.H}],["physicallyIndexed",{getListWithInsertedItems:physicallyIndexed.N,getListWithRemovedItems:physicallyIndexed.H}]]),alterUtilsFactory=indexationStrategy=>{if(!1===alterStrategies.has(indexationStrategy))throw new Error(`Alter strategy with ID '${indexationStrategy}' does not exist.`);return alterStrategies.get(indexationStrategy)};var indexMap=__webpack_require__("./node_modules/handsontable/translations/maps/indexMap.mjs"),actionsOnIndexes=__webpack_require__("./node_modules/handsontable/translations/maps/utils/actionsOnIndexes.mjs");const{getListWithInsertedItems,getListWithRemovedItems}=alterUtilsFactory("physicallyIndexed");class LooseBindsMap extends indexMap.n{constructor(){super((index=>index))}insert(insertionIndex,insertedIndexes){const listAfterUpdate=(0,actionsOnIndexes.z)(this.indexedValues,insertedIndexes);this.indexedValues=getListWithInsertedItems(listAfterUpdate,insertionIndex,insertedIndexes,this.initValueOrFn),super.insert(insertionIndex,insertedIndexes)}remove(removedIndexes){const listAfterUpdate=getListWithRemovedItems(this.indexedValues,removedIndexes);this.indexedValues=(0,actionsOnIndexes.v)(listAfterUpdate,removedIndexes),super.remove(removedIndexes)}}const looseBindsMap=LooseBindsMap,{getListWithInsertedItems:strictBindsMap_getListWithInsertedItems,getListWithRemovedItems:strictBindsMap_getListWithRemovedItems}=alterUtilsFactory("physicallyIndexed");class StrictBindsMap extends indexMap.n{constructor(){super((index=>index))}insert(insertionIndex,insertedIndexes){this.indexedValues=strictBindsMap_getListWithInsertedItems(this.indexedValues,insertionIndex,insertedIndexes,((_,ordinalNumber)=>this.getNextValue(ordinalNumber))),super.insert(insertionIndex,insertedIndexes)}remove(removedIndexes){this.indexedValues=strictBindsMap_getListWithRemovedItems(this.indexedValues,removedIndexes),super.remove(removedIndexes)}getNextValue(ordinalNumber){return Math.max(...this.getValues())+1+ordinalNumber}}function bindRowsWithHeaders_classPrivateMethodInitSpec(e,a){(function bindRowsWithHeaders_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function bindRowsWithHeaders_defineProperty(e,r,t){return(r=function bindRowsWithHeaders_toPropertyKey(t){var i=function bindRowsWithHeaders_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const bindTypeToMapStrategy=new Map([["loose",looseBindsMap],["strict",StrictBindsMap]]);var _BindRowsWithHeaders_brand=new WeakSet;class BindRowsWithHeaders extends BasePlugin{constructor(){super(...arguments),bindRowsWithHeaders_classPrivateMethodInitSpec(this,_BindRowsWithHeaders_brand),bindRowsWithHeaders_defineProperty(this,"headerIndexes",null)}static get PLUGIN_KEY(){return"bindRowsWithHeaders"}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings().bindRowsWithHeaders}enablePlugin(){var _bindTypeToMapStrateg;if(this.enabled)return;const MapStrategy=null!==(_bindTypeToMapStrateg=bindTypeToMapStrategy.get(this.getSetting()))&&void 0!==_bindTypeToMapStrateg?_bindTypeToMapStrateg:bindTypeToMapStrategy.get("loose");this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new MapStrategy),this.addHook("modifyRowHeader",(row=>function bindRowsWithHeaders_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(_BindRowsWithHeaders_brand,this,_onModifyRowHeader).call(this,row))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function _onModifyRowHeader(row){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(row))}var helpers_console=__webpack_require__("./node_modules/handsontable/helpers/console.mjs");function collapsibleColumns_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function collapsibleColumns_defineProperty(e,r,t){return(r=function collapsibleColumns_toPropertyKey(t){var i=function collapsibleColumns_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function collapsibleColumns_classPrivateFieldGet(s,a){return s.get(collapsibleColumns_assertClassBrand(s,a))}function collapsibleColumns_classPrivateFieldSet(s,a,r){return s.set(collapsibleColumns_assertClassBrand(s,a),r),r}function collapsibleColumns_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const collapsibleColumns_SETTING_KEYS=["nestedHeaders"],actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var _collapsedColumnsMap=new WeakMap,_CollapsibleColumns_brand=new WeakSet;class CollapsibleColumns extends BasePlugin{constructor(){super(...arguments),function collapsibleColumns_classPrivateMethodInitSpec(e,a){collapsibleColumns_checkPrivateRedeclaration(e,a),a.add(e)}(this,_CollapsibleColumns_brand),collapsibleColumns_defineProperty(this,"nestedHeadersPlugin",null),collapsibleColumns_defineProperty(this,"headerStateManager",null),function collapsibleColumns_classPrivateFieldInitSpec(e,t,a){collapsibleColumns_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_collapsedColumnsMap,null)}static get PLUGIN_KEY(){return"collapsibleColumns"}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return["collapsibleColumns",...collapsibleColumns_SETTING_KEYS]}isEnabled(){return!!this.hot.getSettings().collapsibleColumns}enablePlugin(){var _this=this;if(this.enabled)return;const{nestedHeaders}=this.hot.getSettings();nestedHeaders||(0,helpers_console.R8)("You need to configure the Nested Headers plugin in order to use collapsible headers."),collapsibleColumns_classPrivateFieldSet(_collapsedColumnsMap,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>collapsibleColumns_assertClassBrand(_CollapsibleColumns_brand,this,collapsibleColumns_onInit).call(this))),this.addHook("afterLoadData",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return collapsibleColumns_assertClassBrand(_CollapsibleColumns_brand,_this,collapsibleColumns_onAfterLoadData).call(_this,...args)})),this.addHook("afterGetColHeader",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return collapsibleColumns_assertClassBrand(_CollapsibleColumns_brand,_this,_onAfterGetColHeader).call(_this,...args)})),this.addHook("beforeOnCellMouseDown",((event,coords,TD)=>collapsibleColumns_assertClassBrand(_CollapsibleColumns_brand,this,_onBeforeOnCellMouseDown).call(this,event,coords,TD))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns}=this.hot.getSettings();"boolean"==typeof collapsibleColumns?this.headerStateManager.mapState((headerSettings=>({collapsible:headerSettings.origColspan>1}))):Array.isArray(collapsibleColumns)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(collapsibleColumns))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),collapsibleColumns_classPrivateFieldSet(_collapsedColumnsMap,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var _this$headerStateMana;const{row,col}=this.hot.getSelectedRangeLast().highlight,{collapsible,isCollapsed,columnIndex}=null!==(_this$headerStateMana=this.headerStateManager.getHeaderTreeNodeData(row,col))&&void 0!==_this$headerStateMana?_this$headerStateMana:{};if(collapsible)return isCollapsed?this.expandSection({row,col:columnIndex}):this.collapseSection({row,col:columnIndex}),!1},runOnlyIf:()=>{var _this$hot$getSelected,_this$hot$getSelected2;return(null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.isSingle())&&(null===(_this$hot$getSelected2=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected2?void 0:_this$hot$getSelected2.highlight.isHeader())},group:"collapsibleColumns",relativeToGroup:constants.b,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("collapsibleColumns")}clearButtons(){if(!this.hot.view)return;const headerLevels=this.hot.view._wt.getSetting("columnHeaders").length,mainHeaders=this.hot.view._wt.wtTable.THEAD,topHeaders=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,topLeftCornerHeaders=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,removeButton=function(button){button&&button.parentNode.removeChild(button)};(0,number.Ti)(0,headerLevels-1,(i=>{const masterLevel=mainHeaders.childNodes[i],topLevel=topHeaders.childNodes[i],topLeftCornerLevel=topLeftCornerHeaders?topLeftCornerHeaders.childNodes[i]:null;(0,number.Ti)(0,masterLevel.childNodes.length-1,(j=>{let button=masterLevel.childNodes[j].querySelector(".collapsibleIndicator");removeButton(button),topLevel&&topLevel.childNodes[j]&&(button=topLevel.childNodes[j].querySelector(".collapsibleIndicator"),removeButton(button)),topLeftCornerHeaders&&topLeftCornerLevel&&topLeftCornerLevel.childNodes[j]&&(button=topLeftCornerLevel.childNodes[j].querySelector(".collapsibleIndicator"),removeButton(button))}))}),!0)}expandSection(coords){this.toggleCollapsibleSection([coords],"expand")}collapseSection(coords){this.toggleCollapsibleSection([coords],"collapse")}toggleAllCollapsibleSections(action){const coords=this.headerStateManager.mapNodes((headerSettings=>{const{collapsible,origColspan,headerLevel,columnIndex,isCollapsed}=headerSettings;if(!0===collapsible&&origColspan>1&&(isCollapsed&&"expand"===action||!isCollapsed&&"collapse"===action))return{row:this.headerStateManager.levelToRowCoords(headerLevel),col:columnIndex}}));this.toggleCollapsibleSection(coords,action)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(coords,action){if(!actionDictionary.has(action))throw new Error(`Unsupported action is passed (${action}).`);if(!Array.isArray(coords))return;const filteredCoords=(0,array.y0)(coords,(_ref=>{let{row}=_ref;return row<0}));let isActionPossible=filteredCoords.length>0;(0,array.z0)(filteredCoords,(_ref2=>{var _this$headerStateMana2;let{row,col:column}=_ref2;const{collapsible,isCollapsed}=null!==(_this$headerStateMana2=this.headerStateManager.getHeaderSettings(row,column))&&void 0!==_this$headerStateMana2?_this$headerStateMana2:{};if(!collapsible||isCollapsed&&"collapse"===action||!isCollapsed&&"expand"===action)return isActionPossible=!1,!1}));const nodeModRollbacks=[],affectedColumnsIndexes=[];isActionPossible&&(0,array.z0)(filteredCoords,(_ref3=>{let{row,col:column}=_ref3;const{colspanCompensation,affectedColumns,rollbackModification}=this.headerStateManager.triggerNodeModification(action,row,column);colspanCompensation>0&&(affectedColumnsIndexes.push(...affectedColumns),nodeModRollbacks.push(rollbackModification))}));const currentCollapsedColumns=this.getCollapsedColumns();let destinationCollapsedColumns=[];"collapse"===action?destinationCollapsedColumns=(0,array.jF)([...currentCollapsedColumns,...affectedColumnsIndexes]):"expand"===action&&(destinationCollapsedColumns=(0,array.y0)(currentCollapsedColumns,(index=>!affectedColumnsIndexes.includes(index))));const actionTranslator=actionDictionary.get(action);if(!1===this.hot.runHooks(actionTranslator.beforeHook,currentCollapsedColumns,destinationCollapsedColumns,isActionPossible))return void(0,array.z0)(nodeModRollbacks,(nodeModRollback=>{nodeModRollback()}));this.hot.batchExecution((()=>{(0,array.z0)(affectedColumnsIndexes,(visualColumn=>{collapsibleColumns_classPrivateFieldGet(_collapsedColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(visualColumn),actionTranslator.hideColumn)}))}),!0);const isActionPerformed=this.getCollapsedColumns().length!==currentCollapsedColumns.length,selectionRange=this.hot.getSelectedRangeLast();if("collapse"===action&&isActionPerformed&&selectionRange){const{row,col}=selectionRange.highlight;if((this.hot.rowIndexMapper.isHidden(row)||this.hot.columnIndexMapper.isHidden(col))&&affectedColumnsIndexes.includes(col)){const nextRow=row>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(row,1,!0):row,nextColumn=col>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(col,1,!0):col;null!==nextRow&&null!==nextColumn&&this.hot.selectCell(nextRow,nextColumn)}}this.hot.runHooks(actionTranslator.afterHook,currentCollapsedColumns,destinationCollapsedColumns,isActionPossible,isActionPerformed),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return collapsibleColumns_classPrivateFieldGet(_collapsedColumnsMap,this).getHiddenIndexes()}destroy(){collapsibleColumns_classPrivateFieldSet(_collapsedColumnsMap,this,null),super.destroy()}}function _onAfterGetColHeader(column,TH,headerLevel){var _this$headerStateMana3;const{collapsible,origColspan,isCollapsed}=null!==(_this$headerStateMana3=this.headerStateManager.getHeaderSettings(headerLevel,column))&&void 0!==_this$headerStateMana3?_this$headerStateMana3:{},isNodeCollapsible=collapsible&&origColspan>1&&column>=this.hot.getSettings().fixedColumnsStart,isAriaTagsEnabled=this.hot.getSettings().ariaTags;let collapsibleElement=TH.querySelector(".collapsibleIndicator");var _collapsibleElement;((0,dom_element.De)(TH,[(0,a11y.dV)("")[0]]),isNodeCollapsible)?(collapsibleElement||(collapsibleElement=this.hot.rootDocument.createElement("div"),(0,dom_element.iQ)(collapsibleElement,"collapsibleIndicator"),TH.querySelector("div:first-child").appendChild(collapsibleElement)),(0,dom_element.vy)(collapsibleElement,["collapsed","expanded"]),isCollapsed?((0,dom_element.iQ)(collapsibleElement,"collapsed"),(0,dom_element.c6)(collapsibleElement,"+"),isAriaTagsEnabled&&(0,dom_element.Bq)(TH,...(0,a11y.dV)(!1))):((0,dom_element.iQ)(collapsibleElement,"expanded"),(0,dom_element.c6)(collapsibleElement,"-"),isAriaTagsEnabled&&(0,dom_element.Bq)(TH,...(0,a11y.dV)(!0))),isAriaTagsEnabled&&(0,dom_element.Bq)(collapsibleElement,...(0,a11y.MG)())):null===(_collapsibleElement=collapsibleElement)||void 0===_collapsibleElement||_collapsibleElement.remove()}function _onBeforeOnCellMouseDown(event,coords){(0,dom_element.nB)(event.target,"collapsibleIndicator")&&((0,dom_element.nB)(event.target,"expanded")?(this.eventManager.fireEvent(event.target,"mouseup"),this.toggleCollapsibleSection([coords],"collapse")):(0,dom_element.nB)(event.target,"collapsed")&&(this.eventManager.fireEvent(event.target,"mouseup"),this.toggleCollapsibleSection([coords],"expand")),(0,dom_event.CA)(event))}function collapsibleColumns_onInit(){this.updatePlugin()}function collapsibleColumns_onAfterLoadData(sourceData,initialLoad){initialLoad||this.updatePlugin()}var helpers_function=__webpack_require__("./node_modules/handsontable/helpers/function.mjs"),maps_indexesSequence=__webpack_require__("./node_modules/handsontable/translations/maps/indexesSequence.mjs"),linkedPhysicalIndexToValueMap=__webpack_require__("./node_modules/handsontable/translations/maps/linkedPhysicalIndexToValueMap.mjs");function columnStatesManager_defineProperty(e,r,t){return(r=function columnStatesManager_toPropertyKey(t){var i=function columnStatesManager_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class ColumnStatesManager{constructor(hot,mapName){columnStatesManager_defineProperty(this,"hot",void 0),columnStatesManager_defineProperty(this,"sortingStates",new linkedPhysicalIndexToValueMap.z),columnStatesManager_defineProperty(this,"sortEmptyCells",false),columnStatesManager_defineProperty(this,"indicator",true),columnStatesManager_defineProperty(this,"headerAction",true),columnStatesManager_defineProperty(this,"compareFunctionFactory",void 0),columnStatesManager_defineProperty(this,"mapName",void 0),this.hot=hot,this.mapName=mapName,this.hot.columnIndexMapper.registerMap(mapName,this.sortingStates)}updateAllColumnsProperties(allSortSettings){(0,object.Gv)(allSortSettings)&&(0,object.v4)(allSortSettings,((newValue,propertyName)=>{inheritedColumnProperties.includes(propertyName)&&(this[propertyName]=newValue)}))}getAllColumnsProperties(){const columnProperties={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(columnProperties.compareFunctionFactory=this.compareFunctionFactory),columnProperties}getSortOrderOfColumn(searchedColumn){var _this$sortingStates$g;return null===(_this$sortingStates$g=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(searchedColumn)))||void 0===_this$sortingStates$g?void 0:_this$sortingStates$g.sortOrder}getIndexOfColumnInSortQueue(column){return column=this.hot.toPhysicalColumn(column),this.sortingStates.getEntries().findIndex((_ref=>{let[physicalColumn]=_ref;return physicalColumn===column}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(column){return(0,object.Gv)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(column)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map((_ref2=>{let[physicalColumn,value]=_ref2;return{column:this.hot.toVisualColumn(physicalColumn),...value}}))}getColumnSortState(column){const sortOrder=this.getSortOrderOfColumn(column);if((0,mixed.O9)(sortOrder))return{column,sortOrder}}setSortStates(sortStates){this.sortingStates.clear();for(let i=0;i<sortStates.length;i+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(sortStates[i].column),{sortOrder:sortStates[i].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}__webpack_require__("./node_modules/core-js/modules/es.set.difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.intersection.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-subset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-superset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.symmetric-difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.union.v2.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");function compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings){const locale=columnMeta.locale;return function(value,nextValue){const{sortEmptyCells}=columnPluginSettings;return"string"==typeof value&&(value=value.toLocaleLowerCase(locale)),"string"==typeof nextValue&&(nextValue=nextValue.toLocaleLowerCase(locale)),value===nextValue?DO_NOT_SWAP:(0,mixed.Im)(value)?(0,mixed.Im)(nextValue)?DO_NOT_SWAP:sortEmptyCells&&"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:(0,mixed.Im)(nextValue)?sortEmptyCells&&"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(value)&&!isNaN(nextValue)?"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(value)&&isNaN(nextValue)?"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:(isNaN(value)||isNaN(nextValue)||(value=parseFloat(value),nextValue=parseFloat(nextValue)),value<nextValue?"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:value>nextValue?"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP)}}var staticRegister=__webpack_require__("./node_modules/handsontable/utils/staticRegister.mjs");const{register:registerCompareFunctionFactory,getItem:getGloballyCompareFunctionFactory,hasItem:hasGloballyCompareFunctionFactory}=(0,staticRegister.A)("sorting.compareFunctionFactory"),{register:registerRootComparator,getItem:getRootComparator}=(0,staticRegister.A)("sorting.mainSortComparator");function getCompareFunctionFactory(type){return hasGloballyCompareFunctionFactory(type)?getGloballyCompareFunctionFactory(type):getGloballyCompareFunctionFactory("default")}registerCompareFunctionFactory("checkbox",(function checkbox_compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings){const checkedTemplate=columnMeta.checkedTemplate,uncheckedTemplate=columnMeta.uncheckedTemplate,{sortEmptyCells}=columnPluginSettings;return function(value,nextValue){const isEmptyValue=(0,mixed.Im)(value),isEmptyNextValue=(0,mixed.Im)(nextValue),unifiedValue=isEmptyValue?uncheckedTemplate:value,unifiedNextValue=isEmptyNextValue?uncheckedTemplate:nextValue,isValueFromTemplate=unifiedValue===uncheckedTemplate||unifiedValue===checkedTemplate,isNextValueFromTemplate=unifiedNextValue===uncheckedTemplate||unifiedNextValue===checkedTemplate;if(!1===sortEmptyCells){if(isEmptyValue&&!1===isEmptyNextValue)return FIRST_AFTER_SECOND;if(!1===isEmptyValue&&isEmptyNextValue)return FIRST_BEFORE_SECOND}return!1===isValueFromTemplate&&isNextValueFromTemplate?"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isValueFromTemplate&&!1===isNextValueFromTemplate?"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!1===isValueFromTemplate&&!1===isNextValueFromTemplate?compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings)(value,nextValue):unifiedValue===uncheckedTemplate&&unifiedNextValue===checkedTemplate?"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:unifiedValue===checkedTemplate&&unifiedNextValue===uncheckedTemplate?"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}})),registerCompareFunctionFactory("date",(function date_compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings){return createDateTimeCompareFunction(sortOrder,columnMeta.dateFormat,columnPluginSettings)})),registerCompareFunctionFactory("default",compareFunctionFactory),registerCompareFunctionFactory("numeric",(function numeric_compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings){return function(value,nextValue){const parsedFirstValue=parseFloat(value),parsedSecondValue=parseFloat(nextValue),{sortEmptyCells}=columnPluginSettings;if(parsedFirstValue===parsedSecondValue||isNaN(parsedFirstValue)&&isNaN(parsedSecondValue))return DO_NOT_SWAP;if(sortEmptyCells){if((0,mixed.Im)(value))return"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if((0,mixed.Im)(nextValue))return"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(parsedFirstValue)?FIRST_AFTER_SECOND:isNaN(parsedSecondValue)?FIRST_BEFORE_SECOND:parsedFirstValue<parsedSecondValue?"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:parsedFirstValue>parsedSecondValue?"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}})),registerCompareFunctionFactory("time",(function time_compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings){return createDateTimeCompareFunction(sortOrder,columnMeta.timeFormat,columnPluginSettings)}));const DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;var templateLiteralTag=__webpack_require__("./node_modules/handsontable/helpers/templateLiteralTag.mjs");const ASC_SORT_STATE="asc",DESC_SORT_STATE="desc";function areValidSortStates(sortStates){if(sortStates.some((columnState=>!1===function isValidColumnState(columnState){if(!1===(0,object.Gv)(columnState))return!1;const{column,sortOrder}=columnState;return Number.isInteger(column)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(sortOrder)}(columnState))))return!1;const sortedColumns=sortStates.map((_ref=>{let{column}=_ref;return column}));return new Set(sortedColumns).size===sortedColumns.length}function getNextSortOrder(sortOrder){if(sortOrder!==DESC_SORT_STATE)return sortOrder===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(TH){return TH.querySelector(".colHeader")}function isFirstLevelColumnHeader(column,TH){if(column<0||!TH.parentNode)return!1;const TRs=TH.parentNode.parentNode.childNodes;return-1===Array.from(TRs).indexOf(TH.parentNode)-TRs.length}function wasHeaderClickedProperly(row,column,clickEvent){return-1===row&&column>=0&&!1===(0,dom_event.nO)(clickEvent)}function createDateTimeCompareFunction(sortOrder,format,columnPluginSettings){return function(value,nextValue){const{sortEmptyCells}=columnPluginSettings;if(value===nextValue)return DO_NOT_SWAP;if((0,mixed.Im)(value))return(0,mixed.Im)(nextValue)?DO_NOT_SWAP:sortEmptyCells&&"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if((0,mixed.Im)(nextValue))return sortEmptyCells&&"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;const firstDate=moment_default()(value,format),nextDate=moment_default()(nextValue,format);return firstDate.isValid()?nextDate.isValid()?nextDate.isAfter(firstDate)?"asc"===sortOrder?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:nextDate.isBefore(firstDate)?"asc"===sortOrder?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}const orderToCssClass=new Map([[ASC_SORT_STATE,"ascending"],[DESC_SORT_STATE,"descending"]]);function columnSorting_classPrivateMethodInitSpec(e,a){(function columnSorting_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function columnSorting_defineProperty(e,r,t){return(r=function columnSorting_toPropertyKey(t){var i=function columnSorting_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function columnSorting_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}registerRootComparator("columnSorting",(function rootComparator(sortingOrders,columnMetas){return function(rowIndexWithValues,nextRowIndexWithValues){const[,...values]=rowIndexWithValues,[,...nextValues]=nextRowIndexWithValues;return function getCompareResult(column){const sortingOrder=sortingOrders[column],columnMeta=columnMetas[column],value=values[column],nextValue=nextValues[column],pluginSettings=columnMeta.columnSorting;return(pluginSettings.compareFunctionFactory?pluginSettings.compareFunctionFactory:getCompareFunctionFactory(columnMeta.type))(sortingOrder,columnMeta,pluginSettings)(value,nextValue)}(0)}})),hooks.R.getSingleton().register("beforeColumnSort"),hooks.R.getSingleton().register("afterColumnSort");const pluginConflictsState=new WeakMap;var _ColumnSorting_brand=new WeakSet;class ColumnSorting extends BasePlugin{constructor(){super(...arguments),columnSorting_classPrivateMethodInitSpec(this,_ColumnSorting_brand),columnSorting_defineProperty(this,"columnStatesManager",null),columnSorting_defineProperty(this,"columnMetaCache",null),columnSorting_defineProperty(this,"pluginKey","columnSorting"),columnSorting_defineProperty(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return"columnSorting"}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var _this=this;if(pluginConflictsState.has(this.hot)&&pluginConflictsState.get(this.hot)!==this.pluginKey)return this.hot.updateSettings({[this.pluginKey]:!1}),void function warnAboutPluginsConflict(workingPlugin,disabledPlugin){(0,helpers_console.R8)(templateLiteralTag.O`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${workingPlugin}\` will work. The \`${disabledPlugin}\` plugin will remain disabled.`)}(pluginConflictsState.get(this.hot),this.pluginKey);this.enabled||(pluginConflictsState.set(this.hot,this.pluginKey),this.columnStatesManager=new ColumnStatesManager(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new physicalIndexToValueMap._((physicalIndex=>{let visualIndex=this.hot.toVisualColumn(physicalIndex);return null===visualIndex&&(visualIndex=physicalIndex),this.getMergedPluginSettings(visualIndex)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((column,TH)=>columnSorting_assertClassBrand(_ColumnSorting_brand,this,columnSorting_onAfterGetColHeader).call(this,column,TH))),this.addHook("beforeOnCellMouseDown",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return columnSorting_assertClassBrand(_ColumnSorting_brand,_this,columnSorting_onBeforeOnCellMouseDown).call(_this,...args)})),this.addHook("afterOnCellMouseDown",((event,target)=>this.onAfterOnCellMouseDown(event,target))),this.addHook("afterInit",(()=>columnSorting_assertClassBrand(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this))),this.addHook("afterLoadData",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return columnSorting_assertClassBrand(_ColumnSorting_brand,_this,columnSorting_onAfterLoadData).call(_this,...args)})),this.hot.view&&columnSorting_assertClassBrand(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const clearColHeader=(column,TH)=>{const headerSpanElement=getHeaderSpanElement(TH);!1!==isFirstLevelColumnHeader(column,TH)&&null!==headerSpanElement&&this.updateHeaderClasses(headerSpanElement)};pluginConflictsState.delete(this.hot),this.hot.addHook("afterGetColHeader",clearColHeader),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",clearColHeader)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(highlight.col)),!1},runOnlyIf:()=>{var _this$hot$getSelected,_this$hot$getSelected2;const highlight=null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.highlight;return highlight&&(null===(_this$hot$getSelected2=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected2?void 0:_this$hot$getSelected2.isSingle())&&this.hot.selection.isCellVisible(highlight)&&-1===highlight.row&&highlight.col>=0},relativeToGroup:constants.b,position:"before",group:"columnSorting"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("columnSorting")}sort(sortConfig){const currentSortConfig=this.getSortConfig(),destinationSortConfigs=this.getNormalizedSortConfigs(sortConfig),sortPossible=this.areValidSortConfigs(destinationSortConfigs);!1!==this.hot.runHooks("beforeColumnSort",currentSortConfig,destinationSortConfigs,sortPossible)&&(0===currentSortConfig.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new maps_indexesSequence.K),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),sortPossible&&(this.columnStatesManager.setSortStates(destinationSortConfigs),this.sortByPresetSortStates(destinationSortConfigs),this.saveAllSortSettings(destinationSortConfigs)),this.hot.runHooks("afterColumnSort",currentSortConfig,sortPossible?destinationSortConfigs:currentSortConfig,sortPossible),sortPossible&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(column){return(0,mixed.O9)(column)?this.columnStatesManager.getColumnSortState(column):this.columnStatesManager.getSortStates()}setSortConfig(sortConfig){const destinationSortConfigs=this.getNormalizedSortConfigs(sortConfig);this.areValidSortConfigs(destinationSortConfigs)&&this.columnStatesManager.setSortStates(destinationSortConfigs)}getNormalizedSortConfigs(){let sortConfig=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(sortConfig)?sortConfig.slice(0,1):[sortConfig]}areValidSortConfigs(sortConfigs){const numberOfColumns=this.hot.countCols();return areValidSortStates(sortConfigs)&&sortConfigs.every((_ref=>{let{column}=_ref;return column<=numberOfColumns&&column>=0}))}saveAllSortSettings(sortConfigs){const allSortSettings=this.columnStatesManager.getAllColumnsProperties();allSortSettings.initialConfig=(0,array.YD)(sortConfigs,(_ref2=>{let{column:visualColumn,...restOfProperties}=_ref2;return{column:this.hot.toPhysicalColumn(visualColumn),...restOfProperties}})),this.hot.runHooks("persistentStateSave","columnSorting",allSortSettings)}getAllSavedSortSettings(){const storedAllSortSettings={};this.hot.runHooks("persistentStateLoad","columnSorting",storedAllSortSettings);const allSortSettings=storedAllSortSettings.value,translateColumnToVisual=_ref3=>{let{column:physicalColumn,...restOfProperties}=_ref3;return{column:this.hot.toVisualColumn(physicalColumn),...restOfProperties}};return(0,mixed.O9)(allSortSettings)&&Array.isArray(allSortSettings.initialConfig)&&(allSortSettings.initialConfig=(0,array.YD)(allSortSettings.initialConfig,translateColumnToVisual)),allSortSettings}getColumnNextConfig(column){const sortOrder=this.columnStatesManager.getSortOrderOfColumn(column);if((0,mixed.O9)(sortOrder)){const nextSortOrder=getNextSortOrder(sortOrder);return(0,mixed.O9)(nextSortOrder)?{column,sortOrder:nextSortOrder}:void 0}const nrOfColumns=this.hot.countCols();if(Number.isInteger(column)&&column>=0&&column<nrOfColumns)return{column,sortOrder:getNextSortOrder()}}getNextSortConfig(columnToChange){let strategyId=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";const indexOfColumnToChange=this.columnStatesManager.getIndexOfColumnInSortQueue(columnToChange),isColumnSorted=-1!==indexOfColumnToChange,currentSortConfig=this.getSortConfig(),nextColumnConfig=this.getColumnNextConfig(columnToChange);if(isColumnSorted){if((0,mixed.b0)(nextColumnConfig))return[...currentSortConfig.slice(0,indexOfColumnToChange),...currentSortConfig.slice(indexOfColumnToChange+1)];if("append"===strategyId)return[...currentSortConfig.slice(0,indexOfColumnToChange),...currentSortConfig.slice(indexOfColumnToChange+1),nextColumnConfig];if("replace"===strategyId)return[...currentSortConfig.slice(0,indexOfColumnToChange),nextColumnConfig,...currentSortConfig.slice(indexOfColumnToChange+1)]}return(0,mixed.O9)(nextColumnConfig)?currentSortConfig.concat(nextColumnConfig):currentSortConfig}getPluginColumnConfig(columnConfig){if((0,object.Gv)(columnConfig)){const pluginColumnConfig=columnConfig[this.pluginKey];if((0,object.Gv)(pluginColumnConfig))return pluginColumnConfig}return{}}getMergedPluginSettings(column){const pluginMainSettings=this.hot.getSettings()[this.pluginKey],storedColumnProperties=this.columnStatesManager.getAllColumnsProperties(),cellMeta=this.hot.getCellMeta(0,column),columnMeta=Object.getPrototypeOf(cellMeta);return Array.isArray(columnMeta.columns)?Object.assign(storedColumnProperties,pluginMainSettings,this.getPluginColumnConfig(columnMeta.columns[column])):(0,helpers_function.Tn)(columnMeta.columns)?Object.assign(storedColumnProperties,pluginMainSettings,this.getPluginColumnConfig(columnMeta.columns(column))):Object.assign(storedColumnProperties,pluginMainSettings)}getFirstCellSettings(column){const cellMeta=this.hot.getCellMeta(0,column),cellMetaCopy=Object.create(cellMeta);return cellMetaCopy[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(column)),cellMetaCopy}getNumberOfRowsToSort(numberOfRows){const settings=this.hot.getSettings();return settings.maxRows<=numberOfRows?settings.maxRows:numberOfRows-settings.minSpareRows}sortByPresetSortStates(sortConfigs){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===sortConfigs.length)return;const indexesWithData=[],numberOfRows=this.hot.countRows(),getDataForSortedColumns=visualRowIndex=>(0,array.YD)(sortConfigs,(sortConfig=>this.hot.getDataAtCell(visualRowIndex,sortConfig.column)));for(let visualRowIndex=0;visualRowIndex<this.getNumberOfRowsToSort(numberOfRows);visualRowIndex+=1)indexesWithData.push([this.hot.toPhysicalRow(visualRowIndex)].concat(getDataForSortedColumns(visualRowIndex)));const indexesBefore=(0,array.YD)(indexesWithData,(indexWithData=>indexWithData[0]));!function sort(indexesWithData,rootComparatorId){const rootComparator=getRootComparator(rootComparatorId);for(var _len=arguments.length,argsForRootComparator=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)argsForRootComparator[_key-2]=arguments[_key];indexesWithData.sort(rootComparator(...argsForRootComparator))}(indexesWithData,this.pluginKey,(0,array.YD)(sortConfigs,(sortConfig=>sortConfig.sortOrder)),(0,array.YD)(sortConfigs,(sortConfig=>this.getFirstCellSettings(sortConfig.column))));for(let visualRowIndex=indexesWithData.length;visualRowIndex<numberOfRows;visualRowIndex+=1)indexesWithData.push([visualRowIndex].concat(getDataForSortedColumns(visualRowIndex)));const indexesAfter=(0,array.YD)(indexesWithData,(indexWithData=>indexWithData[0])),indexMapping=new Map((0,array.YD)(indexesBefore,((indexBefore,indexInsideArray)=>[indexBefore,indexesAfter[indexInsideArray]]))),newIndexesSequence=(0,array.YD)(this.hot.rowIndexMapper.getIndexesSequence(),(physicalIndex=>indexMapping.has(physicalIndex)?indexMapping.get(physicalIndex):physicalIndex));this.hot.rowIndexMapper.setIndexesSequence(newIndexesSequence)}sortBySettings(allSortSettings){if((0,object.Gv)(allSortSettings)){this.columnStatesManager.updateAllColumnsProperties(allSortSettings);const initialConfig=allSortSettings.initialConfig;(Array.isArray(initialConfig)||(0,object.Gv)(initialConfig))&&this.sort(initialConfig)}else this.hot.render()}updateHeaderClasses(headerSpanElement){if((0,dom_element.vy)(headerSpanElement,function getClassesToRemove(){return Array.from(orderToCssClass.values()).concat("sortAction","indicatorDisabled","columnSorting")}()),!1!==this.enabled){for(var _len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)args[_key3-1]=arguments[_key3];(0,dom_element.iQ)(headerSpanElement,function getClassesToAdd(columnStatesManager,column,showSortIndicator,headerAction){const cssClasses=["columnSorting"];if(headerAction&&cssClasses.push("sortAction"),!1===showSortIndicator)return cssClasses.push("indicatorDisabled"),cssClasses;const columnOrder=columnStatesManager.getSortOrderOfColumn(column);return(0,mixed.O9)(columnOrder)&&cssClasses.push(orderToCssClass.get(columnOrder)),cssClasses}(...args))}}onUpdateSettings(newSettings){super.onUpdateSettings(newSettings),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,mixed.O9)(newSettings[this.pluginKey])&&this.sortBySettings(newSettings[this.pluginKey])}wasClickableHeaderClicked(event,column){return this.getFirstCellSettings(column)[this.pluginKey].headerAction&&(0,dom_element.nB)(event.target,"colHeader")}onAfterOnCellMouseDown(event,coords){if(!1!==wasHeaderClickedProperly(coords.row,coords.col,event)&&this.wasClickableHeaderClicked(event,coords.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(coords.col));const activeEditor=this.hot.getActiveEditor(),nextConfig=this.getColumnNextConfig(coords.col);null!=activeEditor&&activeEditor.isOpened()&&this.hot.getCellValidator(activeEditor.row,activeEditor.col)?this.hot.addHookOnce("postAfterValidate",(()=>{this.sort(nextConfig)})):this.sort(nextConfig)}}destroy(){var _this$columnStatesMan;null===(_this$columnStatesMan=this.columnStatesManager)||void 0===_this$columnStatesMan||_this$columnStatesMan.destroy(),super.destroy()}}function _loadOrSortBySettings(){const storedAllSortSettings=this.getAllSavedSortSettings();if((0,object.Gv)(storedAllSortSettings))this.sortBySettings(storedAllSortSettings);else{const allSortSettings=this.hot.getSettings()[this.pluginKey];this.sortBySettings(allSortSettings)}}function columnSorting_onAfterGetColHeader(column,TH){const headerSpanElement=getHeaderSpanElement(TH);if(!1===isFirstLevelColumnHeader(column,TH)||null===headerSpanElement)return;const pluginSettingsForColumn=this.getFirstCellSettings(column)[this.pluginKey],showSortIndicator=pluginSettingsForColumn.indicator,headerActionEnabled=pluginSettingsForColumn.headerAction;if(this.updateHeaderClasses(headerSpanElement,this.columnStatesManager,column,showSortIndicator,headerActionEnabled),this.hot.getSettings().ariaTags){const currentSortState=this.columnStatesManager.getSortOrderOfColumn(column);(0,dom_element.Bq)(TH,...(0,a11y._h)(currentSortState?`${currentSortState}ending`:"none"))}}function columnSorting_onAfterLoadData(initialLoad){!0===initialLoad&&this.hot.view&&columnSorting_assertClassBrand(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)}function columnSorting_onBeforeOnCellMouseDown(event,coords,TD,controller){!1!==wasHeaderClickedProperly(coords.row,coords.col,event)&&this.wasClickableHeaderClicked(event,coords.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(controller.column=!0)}function endpoints_defineProperty(e,r,t){return(r=function endpoints_toPropertyKey(t){var i=function endpoints_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const endpoints=class Endpoints{constructor(plugin,settings){endpoints_defineProperty(this,"plugin",void 0),endpoints_defineProperty(this,"hot",void 0),endpoints_defineProperty(this,"endpoints",[]),endpoints_defineProperty(this,"settings",void 0),endpoints_defineProperty(this,"settingsType","array"),endpoints_defineProperty(this,"currentEndpoint",null),endpoints_defineProperty(this,"cellsToSetCache",[]),this.plugin=plugin,this.hot=this.plugin.hot,this.settings=settings}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(index){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[index]:this.endpoints[index]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(func){return this.parseSettings(func.call(this))}parseSettings(settings){const endpointsArray=[];let settingsArray=settings;if(settingsArray||"function"!=typeof this.settings)return settingsArray||(settingsArray=this.settings),(0,array.z0)(settingsArray,(val=>{const newEndpoint={};this.assignSetting(val,newEndpoint,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(val,newEndpoint,"reversedRowCoords",!1),this.assignSetting(val,newEndpoint,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(val,newEndpoint,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(val,newEndpoint,"sourceColumn",val.destinationColumn),this.assignSetting(val,newEndpoint,"type","sum"),this.assignSetting(val,newEndpoint,"forceNumeric",!1),this.assignSetting(val,newEndpoint,"suppressDataTypeErrors",!0),this.assignSetting(val,newEndpoint,"customFunction",null),this.assignSetting(val,newEndpoint,"readOnly",!0),this.assignSetting(val,newEndpoint,"roundFloat",!1),endpointsArray.push(newEndpoint)})),endpointsArray;this.settingsType="function"}assignSetting(settings,endpoint,name,defaultValue){if("ranges"!==name||void 0!==settings[name]){if("ranges"!==name||0!==settings[name].length)if(void 0===settings[name]){if(defaultValue instanceof Error)throw defaultValue;endpoint[name]=defaultValue}else"destinationRow"===name&&endpoint.reversedRowCoords?endpoint[name]=this.hot.countRows()-settings[name]-1:endpoint[name]=settings[name]}else endpoint[name]=defaultValue}resetSetupBeforeStructureAlteration(action,index,number){if("function"!==this.settingsType)return;const type=action.indexOf("row")>-1?"row":"col",endpoints=this.getAllEndpoints();(0,array.z0)(endpoints,(val=>{"row"===type&&val.destinationRow>=index&&("insert_row"===action?val.alterRowOffset=number:"remove_row"===action&&(val.alterRowOffset=-1*number)),"col"===type&&val.destinationColumn>=index&&("insert_col"===action?val.alterColumnOffset=number:"remove_col"===action&&(val.alterColumnOffset=-1*number))})),this.resetAllEndpoints(endpoints,!1)}resetSetupAfterStructureAlteration(action,index,number,logicRows,source){let forceRefresh=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const beforeViewRenderCallback=()=>(this.hot.removeHook("beforeViewRender",beforeViewRenderCallback),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",beforeViewRenderCallback)}const type=action.indexOf("row")>-1?"row":"col",multiplier=action.indexOf("remove")>-1?-1:1,endpoints=this.getAllEndpoints(),rowMoving=0===action.indexOf("move_row"),placeOfAlteration=index;(0,array.z0)(endpoints,(val=>{"row"===type&&val.destinationRow>=placeOfAlteration&&(val.alterRowOffset=multiplier*number),"col"===type&&val.destinationColumn>=placeOfAlteration&&(val.alterColumnOffset=multiplier*number)})),this.resetAllEndpoints(endpoints,!rowMoving),rowMoving?(0,array.z0)(endpoints,(endpoint=>{this.extendEndpointRanges(endpoint,placeOfAlteration,logicRows[0],logicRows.length),this.recreatePhysicalRanges(endpoint),this.clearOffsetInformation(endpoint)})):(0,array.z0)(endpoints,(endpoint=>{this.shiftEndpointCoordinates(endpoint,placeOfAlteration)})),forceRefresh&&this.refreshAllEndpoints()}clearOffsetInformation(endpoint){endpoint.alterRowOffset=void 0,endpoint.alterColumnOffset=void 0}extendEndpointRanges(endpoint,placeOfAlteration,previousPosition,offset){(0,array.z0)(endpoint.ranges,(range=>{range[1]&&(placeOfAlteration>=range[0]&&placeOfAlteration<=range[1]?previousPosition>range[1]?range[1]+=offset:previousPosition<range[0]&&(range[0]-=offset):previousPosition>=range[0]&&previousPosition<=range[1]&&(range[1]-=offset,placeOfAlteration<=range[0]&&(range[0]+=1,range[1]+=1)))}))}recreatePhysicalRanges(endpoint){const ranges=endpoint.ranges,newRanges=[],allIndexes=[];(0,array.z0)(ranges,(range=>{const newRange=[];if(range[1])for(let i=range[0];i<=range[1];i++)newRange.push(this.hot.toPhysicalRow(i));else newRange.push(this.hot.toPhysicalRow(range[0]));allIndexes.push(newRange)})),(0,array.z0)(allIndexes,(range=>{let newRange=[];(0,array.z0)(range,((coord,index)=>{0===index?newRange.push(coord):range[index]!==range[index-1]+1&&(newRange.push(range[index-1]),newRanges.push(newRange),newRange=[],newRange.push(coord)),index===range.length-1&&(newRange.push(coord),newRanges.push(newRange))}))})),endpoint.ranges=newRanges}shiftEndpointCoordinates(endpoint,offsetStartIndex){endpoint.alterRowOffset&&0!==endpoint.alterRowOffset?(endpoint.destinationRow+=endpoint.alterRowOffset||0,(0,array.z0)(endpoint.ranges,(element=>{(0,array.z0)(element,((subElement,j)=>{subElement>=offsetStartIndex&&(element[j]+=endpoint.alterRowOffset||0)}))}))):endpoint.alterColumnOffset&&0!==endpoint.alterColumnOffset&&(endpoint.destinationColumn+=endpoint.alterColumnOffset||0,endpoint.sourceColumn+=endpoint.alterColumnOffset||0)}resetAllEndpoints(){let endpoints=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),useOffset=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];endpoints.some((endpoint=>{const alterRowOffset=endpoint.alterRowOffset||0,alterColOffset=endpoint.alterColumnOffset||0;return endpoint.destinationRow+alterRowOffset>=this.hot.countRows()||endpoint.destinationColumn+alterColOffset>=this.hot.countCols()}))||(this.cellsToSetCache=[],(0,array.z0)(endpoints,(endpoint=>{this.resetEndpointValue(endpoint,useOffset)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,array.z0)(this.getAllEndpoints(),(value=>{this.currentEndpoint=value,this.plugin.calculate(value),this.setEndpointValue(value,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(changes){const needToRefresh=[];this.cellsToSetCache=[],(0,array.z0)(changes,((value,key,changesObj)=>{`${value[2]||""}`!=`${value[3]}`&&(0,array.z0)(this.getAllEndpoints(),((endpoint,j)=>{this.hot.propToCol(changesObj[key][1])===endpoint.sourceColumn&&-1===needToRefresh.indexOf(j)&&needToRefresh.push(j)}))})),(0,array.z0)(needToRefresh,(value=>{this.refreshEndpoint(this.getEndpoint(value))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach((endpoint=>{const destinationVisualRow=this.hot.toVisualRow(endpoint.destinationRow);if(null!==destinationVisualRow){const cellMeta=this.hot.getCellMeta(destinationVisualRow,endpoint.destinationColumn);cellMeta.readOnly=endpoint.readOnly,cellMeta.className="columnSummaryResult"}}))}refreshEndpoint(endpoint){this.currentEndpoint=endpoint,this.plugin.calculate(endpoint),this.setEndpointValue(endpoint),this.currentEndpoint=null}resetEndpointValue(endpoint){let useOffset=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const alterRowOffset=endpoint.alterRowOffset||0,alterColOffset=endpoint.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(endpoint.destinationRow+(useOffset?alterRowOffset:0)),this.hot.toVisualColumn(endpoint.destinationColumn+(useOffset?alterColOffset:0)),""])}setEndpointValue(endpoint,source){let render=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const visualEndpointRowIndex=this.hot.toVisualRow(endpoint.destinationRow);if(endpoint.destinationRow>=this.hot.countRows()||endpoint.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const destinationVisualRow=this.hot.toVisualRow(endpoint.destinationRow);if(null!==destinationVisualRow){const cellMeta=this.hot.getCellMeta(destinationVisualRow,endpoint.destinationColumn);"init"!==source&&cellMeta.readOnly===endpoint.readOnly||(cellMeta.readOnly=endpoint.readOnly,cellMeta.className="columnSummaryResult")}if((!0===endpoint.roundFloat||Number.isInteger(endpoint.roundFloat))&&!isNaN(endpoint.result)){const roundFloatValue=endpoint.roundFloat;let decimalPlacesCount=0;Number.isInteger(roundFloatValue)&&(decimalPlacesCount=Math.min(Math.max(0,roundFloatValue),100)),endpoint.result=endpoint.result.toFixed(decimalPlacesCount)}render?this.hot.setDataAtCell(visualEndpointRowIndex,endpoint.destinationColumn,endpoint.result,"ColumnSummary.set"):this.cellsToSetCache.push([visualEndpointRowIndex,endpoint.destinationColumn,endpoint.result]),endpoint.alterRowOffset=void 0,endpoint.alterColumnOffset=void 0}throwOutOfBoundsWarning(){(0,helpers_console.R8)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function isNullishOrNaN(value){return null==value||isNaN(value)}function columnSummary_classPrivateMethodInitSpec(e,a){(function columnSummary_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function columnSummary_defineProperty(e,r,t){return(r=function columnSummary_toPropertyKey(t){var i=function columnSummary_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function columnSummary_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _ColumnSummary_brand=new WeakSet;class ColumnSummary extends BasePlugin{constructor(){super(...arguments),columnSummary_classPrivateMethodInitSpec(this,_ColumnSummary_brand),columnSummary_defineProperty(this,"endpoints",null)}static get PLUGIN_KEY(){return"columnSummary"}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings().columnSummary}enablePlugin(){var _this=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new endpoints(this,this.settings),this.addHook("afterInit",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return columnSummary_assertClassBrand(_ColumnSummary_brand,_this,_onAfterInit).call(_this,...args)})),this.addHook("afterChange",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return columnSummary_assertClassBrand(_ColumnSummary_brand,_this,_onAfterChange).call(_this,...args)})),this.addHook("afterUpdateSettings",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return columnSummary_assertClassBrand(_ColumnSummary_brand,_this,_onAfterUpdateSettings).call(_this,...args)})),this.addHook("beforeCreateRow",((index,amount,source)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",index,amount,null,source))),this.addHook("beforeCreateCol",((index,amount,source)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",index,amount,null,source))),this.addHook("beforeRemoveRow",(function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return _this.endpoints.resetSetupBeforeStructureAlteration("remove_row",...args)})),this.addHook("beforeRemoveCol",(function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return _this.endpoints.resetSetupBeforeStructureAlteration("remove_col",...args)})),this.addHook("afterCreateRow",((index,amount,source)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",index,amount,null,source))),this.addHook("afterCreateCol",((index,amount,source)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",index,amount,null,source))),this.addHook("afterRemoveRow",(function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return _this.endpoints.resetSetupAfterStructureAlteration("remove_row",...args)})),this.addHook("afterRemoveCol",(function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return _this.endpoints.resetSetupAfterStructureAlteration("remove_col",...args)})),this.addHook("afterRowMove",(function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return columnSummary_assertClassBrand(_ColumnSummary_brand,_this,_onAfterRowMove).call(_this,...args)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(endpoint){switch(endpoint.type.toLowerCase()){case"sum":endpoint.result=this.calculateSum(endpoint);break;case"min":case"max":endpoint.result=this.calculateMinMax(endpoint,endpoint.type);break;case"count":endpoint.result=this.countEntries(endpoint);break;case"average":endpoint.result=this.calculateAverage(endpoint);break;case"custom":endpoint.result=endpoint.customFunction.call(this,endpoint)}}calculateSum(endpoint){let sum=0;return(0,object.v4)(endpoint.ranges,(range=>{sum+=this.getPartialSum(range,endpoint.sourceColumn)})),sum}getPartialSum(rowRange,col){let sum=0,i=rowRange[1]||rowRange[0],cellValue=null,biggestDecimalPlacesCount=0;do{if(cellValue=this.getCellValue(i,col),cellValue=isNullishOrNaN(cellValue)?null:cellValue,null!==cellValue){const decimalPlaces=(`${cellValue}`.split(".")[1]||[]).length||1;decimalPlaces>biggestDecimalPlacesCount&&(biggestDecimalPlacesCount=decimalPlaces)}sum+=cellValue||0,i-=1}while(i>=rowRange[0]);return Math.round(sum*10**biggestDecimalPlacesCount)/10**biggestDecimalPlacesCount}calculateMinMax(endpoint,type){let result=null;return(0,object.v4)(endpoint.ranges,(range=>{const partialResult=this.getPartialMinMax(range,endpoint.sourceColumn,type);if(null===result&&null!==partialResult&&(result=partialResult),null!==partialResult)switch(type){case"min":result=Math.min(result,partialResult);break;case"max":result=Math.max(result,partialResult)}})),null===result?"Not enough data":result}getPartialMinMax(rowRange,col,type){let cellValue,result=null,i=rowRange[1]||rowRange[0];do{if(cellValue=this.getCellValue(i,col),cellValue=isNullishOrNaN(cellValue)?null:cellValue,null===result)result=cellValue;else if(null!==cellValue)switch(type){case"min":result=Math.min(result,cellValue);break;case"max":result=Math.max(result,cellValue)}i-=1}while(i>=rowRange[0]);return result}countEmpty(rowRange,col){let cellValue,counter=0,i=rowRange[1]||rowRange[0];do{cellValue=this.getCellValue(i,col),cellValue=isNullishOrNaN(cellValue)?null:cellValue,null===cellValue&&(counter+=1),i-=1}while(i>=rowRange[0]);return counter}countEntries(endpoint){let result=0;const ranges=endpoint.ranges;return(0,object.v4)(ranges,(range=>{const partial=void 0===range[1]?1:range[1]-range[0]+1,emptyCount=this.countEmpty(range,endpoint.sourceColumn);result+=partial,result-=emptyCount})),result}calculateAverage(endpoint){return this.calculateSum(endpoint)/this.countEntries(endpoint)}getCellValue(row,col){const visualRowIndex=this.hot.toVisualRow(row),visualColumnIndex=this.hot.toVisualColumn(col);let cellValue=this.hot.getSourceDataAtCell(row,col),cellClassName="";if(null!==visualRowIndex&&null!==visualColumnIndex&&(cellClassName=this.hot.getCellMeta(visualRowIndex,visualColumnIndex).className||""),cellClassName.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof cellValue&&(cellValue=cellValue.replace(/,/,".")),cellValue=parseFloat(cellValue)),isNaN(cellValue)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(templateLiteralTag.O`ColumnSummary plugin: cell at (${row}, ${col}) is not in a\x20
          numeric format. Cannot do the calculation.`);return cellValue}}function _onAfterInit(){this.endpoints.initEndpoints()}function _onAfterUpdateSettings(settings){void 0!==settings.columns&&this.endpoints.refreshCellMetas()}function _onAfterChange(changes,source){changes&&"ColumnSummary.reset"!==source&&"ColumnSummary.set"!==source&&"loadData"!==source&&this.endpoints.refreshChangedEndpoints(changes)}function _onAfterRowMove(rows,finalIndex){this.endpoints.resetSetupBeforeStructureAlteration("move_row",rows[0],rows.length,rows,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",finalIndex,rows.length,rows,this.pluginName)}var localHooks=__webpack_require__("./node_modules/handsontable/mixins/localHooks.mjs");function editorResizeObserver_classPrivateFieldInitSpec(e,t,a){editorResizeObserver_checkPrivateRedeclaration(e,t),t.set(e,a)}function editorResizeObserver_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function editorResizeObserver_classPrivateFieldGet(s,a){return s.get(editorResizeObserver_assertClassBrand(s,a))}function editorResizeObserver_classPrivateFieldSet(s,a,r){return s.set(editorResizeObserver_assertClassBrand(s,a),r),r}function editorResizeObserver_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _ignoreInitialCall=new WeakMap,_observedElement=new WeakMap,_observer=new WeakMap,_EditorResizeObserver_brand=new WeakSet;class EditorResizeObserver{constructor(){!function editorResizeObserver_classPrivateMethodInitSpec(e,a){editorResizeObserver_checkPrivateRedeclaration(e,a),a.add(e)}(this,_EditorResizeObserver_brand),editorResizeObserver_classPrivateFieldInitSpec(this,_ignoreInitialCall,!0),editorResizeObserver_classPrivateFieldInitSpec(this,_observedElement,null),editorResizeObserver_classPrivateFieldInitSpec(this,_observer,new ResizeObserver((entries=>editorResizeObserver_assertClassBrand(_EditorResizeObserver_brand,this,_onResize).call(this,entries))))}setObservedElement(element){editorResizeObserver_classPrivateFieldSet(_observedElement,this,element)}unobserve(){editorResizeObserver_classPrivateFieldGet(_observer,this).unobserve(editorResizeObserver_classPrivateFieldGet(_observedElement,this))}observe(){editorResizeObserver_classPrivateFieldSet(_ignoreInitialCall,this,!0),editorResizeObserver_classPrivateFieldGet(_observer,this).observe(editorResizeObserver_classPrivateFieldGet(_observedElement,this))}destroy(){editorResizeObserver_classPrivateFieldGet(_observer,this).disconnect()}}function _onResize(entries){!editorResizeObserver_classPrivateFieldGet(_ignoreInitialCall,this)&&Array.isArray(entries)&&entries.length?entries.forEach((_ref=>{let{borderBoxSize}=_ref;const{inlineSize,blockSize}=borderBoxSize[0];this.runLocalHooks("resize",inlineSize,blockSize)})):editorResizeObserver_classPrivateFieldSet(_ignoreInitialCall,this,!1)}function commentEditor_classPrivateFieldInitSpec(e,t,a){(function commentEditor_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function commentEditor_classPrivateFieldGet(s,a){return s.get(commentEditor_assertClassBrand(s,a))}function commentEditor_classPrivateFieldSet(s,a,r){return s.set(commentEditor_assertClassBrand(s,a),r),r}function commentEditor_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(0,object.co)(EditorResizeObserver,localHooks.A);var _rootDocument=new WeakMap,_isRtl=new WeakMap,_container=new WeakMap,_editor=new WeakMap,_editorStyle=new WeakMap,_hidden=new WeakMap,_resizeObserver=new WeakMap;class CommentEditor{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(rootDocument,isRtl){var _this=this;commentEditor_classPrivateFieldInitSpec(this,_rootDocument,void 0),commentEditor_classPrivateFieldInitSpec(this,_isRtl,!1),commentEditor_classPrivateFieldInitSpec(this,_container,null),commentEditor_classPrivateFieldInitSpec(this,_editor,void 0),commentEditor_classPrivateFieldInitSpec(this,_editorStyle,void 0),commentEditor_classPrivateFieldInitSpec(this,_hidden,!0),commentEditor_classPrivateFieldInitSpec(this,_resizeObserver,new EditorResizeObserver),commentEditor_classPrivateFieldSet(_rootDocument,this,rootDocument),commentEditor_classPrivateFieldSet(_isRtl,this,isRtl),commentEditor_classPrivateFieldSet(_editor,this,this.createEditor()),commentEditor_classPrivateFieldSet(_editorStyle,this,commentEditor_classPrivateFieldGet(_editor,this).style),commentEditor_classPrivateFieldGet(_resizeObserver,this).setObservedElement(this.getInputElement()),commentEditor_classPrivateFieldGet(_resizeObserver,this).addLocalHook("resize",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this.runLocalHooks("resize",...args)})),this.hide()}setPosition(x,y){commentEditor_classPrivateFieldGet(_editorStyle,this).left=`${x}px`,commentEditor_classPrivateFieldGet(_editorStyle,this).top=`${y}px`}setSize(width,height){if(width&&height){const input=this.getInputElement();input.style.width=`${width}px`,input.style.height=`${height}px`}}getSize(){return{width:(0,dom_element.Gq)(this.getInputElement()),height:(0,dom_element.DK)(this.getInputElement())}}observeSize(){commentEditor_classPrivateFieldGet(_resizeObserver,this).observe()}resetSize(){const input=this.getInputElement();input.style.width="",input.style.height=""}setReadOnlyState(state){this.getInputElement().readOnly=state}show(){commentEditor_classPrivateFieldGet(_editorStyle,this).display="block",commentEditor_classPrivateFieldSet(_hidden,this,!1)}hide(){commentEditor_classPrivateFieldGet(_resizeObserver,this).unobserve(),commentEditor_classPrivateFieldGet(_hidden,this)||(commentEditor_classPrivateFieldGet(_editorStyle,this).display="none"),commentEditor_classPrivateFieldSet(_hidden,this,!0)}isVisible(){return"block"===commentEditor_classPrivateFieldGet(_editorStyle,this).display}setValue(){const comment=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=comment}getValue(){return this.getInputElement().value}isFocused(){return commentEditor_classPrivateFieldGet(_rootDocument,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const editor=commentEditor_classPrivateFieldGet(_rootDocument,this).createElement("div"),textarea=commentEditor_classPrivateFieldGet(_rootDocument,this).createElement("textarea");return editor.style.display="none",commentEditor_classPrivateFieldSet(_container,this,commentEditor_classPrivateFieldGet(_rootDocument,this).createElement("div")),commentEditor_classPrivateFieldGet(_container,this).setAttribute("dir",commentEditor_classPrivateFieldGet(_isRtl,this)?"rtl":"ltr"),(0,dom_element.iQ)(commentEditor_classPrivateFieldGet(_container,this),CommentEditor.CLASS_EDITOR_CONTAINER),commentEditor_classPrivateFieldGet(_rootDocument,this).body.appendChild(commentEditor_classPrivateFieldGet(_container,this)),(0,dom_element.iQ)(editor,CommentEditor.CLASS_EDITOR),(0,dom_element.iQ)(textarea,CommentEditor.CLASS_INPUT),textarea.setAttribute("data-hot-input",!0),editor.appendChild(textarea),commentEditor_classPrivateFieldGet(_container,this).appendChild(editor),editor}getInputElement(){return commentEditor_classPrivateFieldGet(_editor,this).querySelector(`.${CommentEditor.CLASS_INPUT}`)}getEditorElement(){return commentEditor_classPrivateFieldGet(_editor,this)}destroy(){const containerParentElement=commentEditor_classPrivateFieldGet(_container,this)?commentEditor_classPrivateFieldGet(_container,this).parentNode:null;commentEditor_classPrivateFieldGet(_editor,this).parentNode.removeChild(commentEditor_classPrivateFieldGet(_editor,this)),commentEditor_classPrivateFieldSet(_editor,this,null),commentEditor_classPrivateFieldSet(_editorStyle,this,null),commentEditor_classPrivateFieldGet(_resizeObserver,this).destroy(),containerParentElement&&containerParentElement.removeChild(commentEditor_classPrivateFieldGet(_container,this))}}(0,object.co)(CommentEditor,localHooks.A);const commentEditor=CommentEditor;function displaySwitch_defineProperty(e,r,t){return(r=function displaySwitch_toPropertyKey(t){var i=function displaySwitch_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class DisplaySwitch{constructor(displayDelay){displaySwitch_defineProperty(this,"wasLastActionShow",!0),displaySwitch_defineProperty(this,"showDebounced",null),displaySwitch_defineProperty(this,"hidingTimer",null),this.updateDelay(displayDelay)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),250)}show(range){this.wasLastActionShow=!0,this.showDebounced(range)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let displayDelay=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=(0,helpers_function.sg)((range=>{this.wasLastActionShow&&this.runLocalHooks("show",range.from.row,range.from.col)}),displayDelay)}destroy(){this.clearLocalHooks()}}(0,object.co)(DisplaySwitch,localHooks.A);const displaySwitch=DisplaySwitch,KEY="---------";function getAlignmentClasses(ranges,callback){const classes={};return(0,array.z0)(ranges,(range=>{range.forAll(((row,col)=>{row>=0&&col>=0&&(classes[row]||(classes[row]=[]),classes[row][col]=callback(row,col))}))})),classes}function align(ranges,type,alignment,cellDescriptor,propertySetter){(0,array.z0)(ranges,(range=>{range.forAll(((row,col)=>{row>=0&&col>=0&&function applyAlignClassName(row,col,type,alignment,cellDescriptor,propertySetter){const cellMeta=cellDescriptor(row,col);let className=alignment;cellMeta.className&&(className="vertical"===type?function prepareVerticalAlignClass(className,alignment){return-1!==className.indexOf(alignment)?className:`${className.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${alignment}`}(cellMeta.className,alignment):function prepareHorizontalAlignClass(className,alignment){return-1!==className.indexOf(alignment)?className:`${className.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${alignment}`}(cellMeta.className,alignment));propertySetter(row,col,"className",className)}(row,col,type,alignment,cellDescriptor,propertySetter)}))}))}function markLabelAsSelected(label){return`<span class="selected">${String.fromCharCode(10003)}</span>${label}`}function checkSelectionConsistency(ranges,comparator){let result=!1;return Array.isArray(ranges)&&(0,array.z0)(ranges,(range=>(range.forAll(((row,col)=>{if(row>=0&&col>=0&&comparator(row,col))return result=!0,!1})),result))),result}function getDocumentOffsetByElement(elementToCheck,baseDocument){const offset={top:0,left:0};if(baseDocument!==elementToCheck.ownerDocument){const{frameElement}=baseDocument.defaultView,{top,left}=frameElement.getBoundingClientRect();offset.top=top,offset.left=left}return offset}function comments_classPrivateFieldInitSpec(e,t,a){comments_checkPrivateRedeclaration(e,t),t.set(e,a)}function comments_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function comments_defineProperty(e,r,t){return(r=function comments_toPropertyKey(t){var i=function comments_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function comments_classPrivateFieldSet(s,a,r){return s.set(comments_assertClassBrand(s,a),r),r}function comments_classPrivateFieldGet(s,a){return s.get(comments_assertClassBrand(s,a))}function comments_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly";var comments_editor=new WeakMap,_displaySwitch=new WeakMap,_preventEditorAutoSwitch=new WeakMap,_preventEditorHiding=new WeakMap,_cellBelowCursor=new WeakMap,_commentValueBeforeSave=new WeakMap,_Comments_brand=new WeakSet;class Comments extends BasePlugin{constructor(){super(...arguments),function comments_classPrivateMethodInitSpec(e,a){comments_checkPrivateRedeclaration(e,a),a.add(e)}(this,_Comments_brand),comments_defineProperty(this,"range",{}),comments_classPrivateFieldInitSpec(this,comments_editor,null),comments_classPrivateFieldInitSpec(this,_displaySwitch,null),comments_classPrivateFieldInitSpec(this,_preventEditorAutoSwitch,!1),comments_classPrivateFieldInitSpec(this,_preventEditorHiding,!1),comments_classPrivateFieldInitSpec(this,_cellBelowCursor,null),comments_classPrivateFieldInitSpec(this,_commentValueBeforeSave,"")}static get PLUGIN_KEY(){return"comments"}static get PLUGIN_PRIORITY(){return 60}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings().comments}enablePlugin(){var _this=this;this.enabled||(comments_classPrivateFieldGet(comments_editor,this)||(comments_classPrivateFieldSet(comments_editor,this,new commentEditor(this.hot.rootDocument,this.hot.isRtl())),comments_classPrivateFieldGet(comments_editor,this).addLocalHook("resize",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return comments_assertClassBrand(_Comments_brand,_this,_onEditorResize).call(_this,...args)}))),comments_classPrivateFieldGet(_displaySwitch,this)||comments_classPrivateFieldSet(_displaySwitch,this,new displaySwitch(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",(options=>this.addToContextMenu(options))),this.addHook("afterRenderer",((TD,row,col,prop,value,cellProperties)=>comments_assertClassBrand(_Comments_brand,this,_onAfterRenderer).call(this,TD,cellProperties))),this.addHook("afterScroll",(()=>comments_assertClassBrand(_Comments_brand,this,_onAfterScroll).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(event=>comments_assertClassBrand(_Comments_brand,this,_onAfterDocumentKeyDown).call(this,event))),this.addHook("afterSetTheme",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return comments_assertClassBrand(_Comments_brand,_this,_updateEditorThemeClassName).call(_this,...args)})),comments_classPrivateFieldGet(_displaySwitch,this).addLocalHook("hide",(()=>this.hide())),comments_classPrivateFieldGet(_displaySwitch,this).addLocalHook("show",((row,col)=>this.showAtCell(row,col))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){comments_classPrivateFieldGet(_displaySwitch,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const manager=this.hot.getShortcutManager(),gridContext=manager.getContext("grid"),pluginContext=manager.addContext("plugin:comments");gridContext.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const range=this.hot.getSelectedRangeLast();comments_classPrivateFieldSet(_preventEditorHiding,this,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(range),this.show(),this.focusEditor(),manager.setActiveContextName("plugin:comments"),this.hot._registerTimeout((()=>{comments_classPrivateFieldSet(_preventEditorHiding,this,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var _this$hot$getSelected;return null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.highlight.isCell()},group:"comments"}),pluginContext.addShortcut({keys:[["Escape"]],callback:()=>{comments_classPrivateFieldGet(comments_editor,this).setValue(comments_classPrivateFieldGet(_commentValueBeforeSave,this)),this.hide(),manager.setActiveContextName("grid")},runOnlyIf:()=>comments_classPrivateFieldGet(comments_editor,this).isVisible()&&comments_classPrivateFieldGet(comments_editor,this).isFocused(),group:"comments"}),pluginContext.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),manager.setActiveContextName("grid")},runOnlyIf:()=>comments_classPrivateFieldGet(comments_editor,this).isVisible()&&comments_classPrivateFieldGet(comments_editor,this).isFocused(),group:"comments"}),pluginContext.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:manager.getContext("grid"),callback:()=>{comments_classPrivateFieldGet(comments_editor,this).setValue(comments_classPrivateFieldGet(comments_editor,this).getValue()),this.hide(),manager.setActiveContextName("grid")},group:"comments"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("comments")}registerListeners(){const{rootDocument}=this.hot,editorElement=this.getEditorInputElement();this.eventManager.addEventListener(rootDocument,"mouseover",(event=>comments_assertClassBrand(_Comments_brand,this,_onMouseOver).call(this,event))),this.eventManager.addEventListener(rootDocument,"mousedown",(event=>comments_assertClassBrand(_Comments_brand,this,_onMouseDown).call(this,event))),this.eventManager.addEventListener(rootDocument,"mouseup",(()=>comments_assertClassBrand(_Comments_brand,this,comments_onMouseUp).call(this))),this.eventManager.addEventListener(editorElement,"focus",(()=>comments_assertClassBrand(_Comments_brand,this,_onEditorFocus).call(this))),this.eventManager.addEventListener(editorElement,"blur",(()=>comments_assertClassBrand(_Comments_brand,this,_onEditorBlur).call(this))),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",(event=>comments_assertClassBrand(_Comments_brand,this,_onInputElementMouseDown).call(this,event)))}setRange(range){this.range=range}clearRange(){this.range={}}targetIsCellWithComment(event){const closestCell=(0,dom_element.kp)(event.target,"TD","TBODY");return!!(closestCell&&(0,dom_element.nB)(closestCell,"htCommentCell")&&(0,dom_element.kp)(closestCell,[this.hot.rootElement]))}targetIsCommentTextArea(event){return this.getEditorInputElement()===event.target}setComment(value){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const editorValue=comments_classPrivateFieldGet(comments_editor,this).getValue();let comment="";null!=value?comment=value:null!=editorValue&&(comment=editorValue);const row=this.range.from.row,col=this.range.from.col;this.updateCommentMeta(row,col,{[META_COMMENT_VALUE]:comment}),this.hot.render()}setCommentAtCell(row,column,value){this.setRange({from:this.hot._createCellCoords(row,column)}),this.setComment(value)}removeComment(){let forceRender=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment"),forceRender&&this.hot.render(),this.hide()}removeCommentAtCell(row,column){let forceRender=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(row,column)}),this.removeComment(forceRender)}getComment(){const row=this.range.from.row,column=this.range.from.col;return this.getCommentMeta(row,column,"value")}getCommentAtCell(row,column){return this.getCommentMeta(row,column,"value")}show(){var _ref;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row,col}}=this.range;if(row<0||row>this.hot.countSourceRows()-1||col<0||col>this.hot.countSourceCols()-1)return!1;const meta=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return comments_classPrivateFieldGet(_displaySwitch,this).cancelHiding(),comments_classPrivateFieldGet(comments_editor,this).setValue(null!==(_ref=meta.comment?meta.comment.value:null)&&void 0!==_ref?_ref:""),comments_classPrivateFieldGet(comments_editor,this).show(),this.refreshEditor(!0),!0}showAtCell(row,column){return this.setRange({from:this.hot._createCellCoords(row,column)}),this.show()}hide(){comments_classPrivateFieldGet(comments_editor,this).hide()}refreshEditor(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&comments_classPrivateFieldGet(comments_editor,this).isVisible()))return;const{rowIndexMapper,columnIndexMapper}=this.hot,{row:visualRow,col:visualColumn}=this.range.from;let renderableRow=rowIndexMapper.getRenderableFromVisualIndex(visualRow),renderableColumn=columnIndexMapper.getRenderableFromVisualIndex(visualColumn);const targetingPreviousRow=null===renderableRow;comments_classPrivateFieldGet(comments_editor,this).setPosition(0,0),null===renderableRow&&(renderableRow=rowIndexMapper.getRenderableFromVisualIndex(rowIndexMapper.getNearestNotHiddenIndex(visualRow,-1))),null===renderableColumn&&(renderableColumn=columnIndexMapper.getRenderableFromVisualIndex(columnIndexMapper.getNearestNotHiddenIndex(visualColumn,-1)));const isBeforeRenderedRows=null===renderableRow,isBeforeRenderedColumns=null===renderableColumn;renderableRow=null!=renderableRow?renderableRow:0,renderableColumn=null!=renderableColumn?renderableColumn:0;const{rootWindow,view:{_wt:wt}}=this.hot,{wtTable}=wt,TD=wt.getCell({row:renderableRow,col:renderableColumn},!0),commentStyle=this.getCommentMeta(visualRow,visualColumn,"style");commentStyle?comments_classPrivateFieldGet(comments_editor,this).setSize(commentStyle.width,commentStyle.height):comments_classPrivateFieldGet(comments_editor,this).resetSize();const lastColWidth=isBeforeRenderedColumns?0:wtTable.getColumnWidth(renderableColumn),lastRowHeight=targetingPreviousRow&&!isBeforeRenderedRows?(0,dom_element.DK)(TD):0,{left,top,width:cellWidth,height:cellHeight}=TD.getBoundingClientRect(),{width:editorWidth,height:editorHeight}=comments_classPrivateFieldGet(comments_editor,this).getSize(),{innerWidth,innerHeight}=this.hot.rootWindow,documentElement=this.hot.rootDocument.documentElement,scrollbarWidth=(0,dom_element.XJ)(this.hot.rootDocument),verticalScrollbarWidth=(0,dom_element.D1)(this.hot.rootWindow)?scrollbarWidth:0,horizontalScrollbarWidth=(0,dom_element.zO)(this.hot.rootWindow)?scrollbarWidth:0;let x=left+rootWindow.scrollX+lastColWidth,y=top+rootWindow.scrollY+lastRowHeight;this.hot.isRtl()&&(x-=editorWidth+lastColWidth),this.hot.isLtr()&&left+cellWidth+editorWidth>innerWidth-verticalScrollbarWidth?x=left+rootWindow.scrollX-editorWidth-1:this.hot.isRtl()&&x<-(documentElement.scrollWidth-documentElement.clientWidth)&&(x=left+rootWindow.scrollX+lastColWidth+1),top+editorHeight>innerHeight-horizontalScrollbarWidth&&(y-=editorHeight-cellHeight+1),comments_classPrivateFieldGet(comments_editor,this).setPosition(x,y),comments_classPrivateFieldGet(comments_editor,this).setReadOnlyState(this.getCommentMeta(visualRow,visualColumn,META_READONLY)),comments_classPrivateFieldGet(comments_editor,this).observeSize()}focusEditor(){comments_classPrivateFieldGet(comments_editor,this).focus()}updateCommentMeta(row,column,metaObject){const oldComment=this.hot.getCellMeta(row,column).comment;let newComment;oldComment?(newComment=(0,object.Go)(oldComment),(0,object.zw)(newComment,metaObject)):newComment=metaObject,this.hot.setCellMeta(row,column,"comment",newComment)}getCommentMeta(row,column,property){const cellMeta=this.hot.getCellMeta(row,column);if(cellMeta.comment)return cellMeta.comment[property]}addToContextMenu(options){options.items.push({name:KEY},function addEditCommentItem(plugin){return{key:"commentsAddEdit",name(){var _this$getSelectedRang;const highlight=null===(_this$getSelectedRang=this.getSelectedRangeLast())||void 0===_this$getSelectedRang?void 0:_this$getSelectedRang.highlight;return null!=highlight&&highlight.isCell()&&plugin.getCommentAtCell(highlight.row,highlight.col)?this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){const range=this.getSelectedRangeLast();plugin.setRange(range),plugin.show(),plugin.focusEditor()},disabled(){const range=this.getSelectedRangeLast();return!!(!range||range.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function removeCommentItem(plugin){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll(((row,column)=>{row>=0&&column>=0&&plugin.removeCommentAtCell(row,column,!1)})),this.render()},disabled(){const range=this.getSelectedRangeLast();return!!(!range||range.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function readOnlyCommentItem(plugin){return{key:"commentsReadOnly",name(){const label=this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return checkSelectionConsistency(this.getSelectedRange(),((row,col)=>plugin.getCommentMeta(row,col,META_READONLY)))?markLabelAsSelected(label):label},callback(){this.getSelectedRangeLast().forAll(((row,column)=>{if(row>=0&&column>=0){const currentState=!!plugin.getCommentMeta(row,column,META_READONLY);plugin.updateCommentMeta(row,column,{[META_READONLY]:!currentState})}}))},disabled(){const range=this.getSelectedRangeLast();return!!(!range||range.highlight.isHeader()||!plugin.getCommentAtCell(range.highlight.row,range.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getEditorInputElement(){return comments_classPrivateFieldGet(comments_editor,this).getInputElement()}destroy(){var _classPrivateFieldGet2,_classPrivateFieldGet3;null===(_classPrivateFieldGet2=comments_classPrivateFieldGet(comments_editor,this))||void 0===_classPrivateFieldGet2||_classPrivateFieldGet2.destroy(),null===(_classPrivateFieldGet3=comments_classPrivateFieldGet(_displaySwitch,this))||void 0===_classPrivateFieldGet3||_classPrivateFieldGet3.destroy(),super.destroy()}}function _onMouseDown(event){if(this.hot.view&&this.hot.view._wt&&!comments_classPrivateFieldGet(_preventEditorAutoSwitch,this)&&!this.targetIsCommentTextArea(event)){const eventCell=(0,dom_element.kp)(event.target,"TD","TBODY");let coordinates=null;eventCell&&(coordinates=this.hot.getCoords(eventCell)),(!eventCell||this.range.from&&coordinates&&(this.range.from.row!==coordinates.row||this.range.from.col!==coordinates.col))&&this.hide()}}function _onInputElementMouseDown(event){event.stopPropagation()}function _onMouseOver(event){const{rootDocument}=this.hot;if(!(comments_classPrivateFieldGet(_preventEditorAutoSwitch,this)||comments_classPrivateFieldGet(comments_editor,this).isFocused()||(0,dom_element.nB)(event.target,"wtBorder")||comments_classPrivateFieldGet(_cellBelowCursor,this)===event.target)&&comments_classPrivateFieldGet(comments_editor,this))if(comments_classPrivateFieldSet(_cellBelowCursor,this,rootDocument.elementFromPoint(event.clientX,event.clientY)),this.targetIsCellWithComment(event)){const range=this.hot._createCellRange(this.hot.getCoords(event.target));comments_classPrivateFieldGet(_displaySwitch,this).show(range)}else(0,dom_element.aO)(event.target,rootDocument)&&!this.targetIsCommentTextArea(event)&&comments_classPrivateFieldGet(_displaySwitch,this).hide()}function comments_onMouseUp(){comments_classPrivateFieldSet(_preventEditorAutoSwitch,this,!1)}function _onAfterRenderer(TD,cellProperties){cellProperties.comment&&cellProperties.comment.value&&(0,dom_element.iQ)(TD,cellProperties.commentedCellClassName)}function _onEditorBlur(){comments_classPrivateFieldSet(_commentValueBeforeSave,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _onEditorFocus(){comments_classPrivateFieldSet(_commentValueBeforeSave,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName("plugin:comments")}function _onEditorResize(width,height){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[META_STYLE]:{width,height}})}function _onAfterDocumentKeyDown(event){comments_classPrivateFieldGet(comments_editor,this).isFocused()&&(0,dom_event.CA)(event)}function _onAfterScroll(){comments_classPrivateFieldGet(_preventEditorHiding,this)||this.hide()}function _updateEditorThemeClassName(){const editorElement=comments_classPrivateFieldGet(comments_editor,this).getEditorElement();(0,dom_element.vy)(editorElement,/ht-theme-.*/g),(0,dom_element.iQ)(editorElement,this.hot.getCurrentThemeName())}__webpack_require__("./node_modules/core-js/modules/es.array.unshift.js");function commandExecutor_defineProperty(e,r,t){return(r=function commandExecutor_toPropertyKey(t){var i=function commandExecutor_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class CommandExecutor{constructor(hotInstance){commandExecutor_defineProperty(this,"hot",void 0),commandExecutor_defineProperty(this,"commands",{}),commandExecutor_defineProperty(this,"commonCallback",null),this.hot=hotInstance}registerCommand(name,commandDescriptor){this.commands[name]=commandDescriptor}setCommonCallback(callback){this.commonCallback=callback}execute(commandName){for(var _len=arguments.length,params=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)params[_key-1]=arguments[_key];const commandSplit=commandName.split(":"),commandNamePrimary=commandSplit[0],subCommandName=2===commandSplit.length?commandSplit[1]:null;let command=this.commands[commandNamePrimary];if(!command)throw new Error(`Menu command '${commandNamePrimary}' not exists.`);if(subCommandName&&command.submenu&&(command=function findSubCommand(subCommandName,subCommands){let command;return(0,array.z0)(subCommands,(cmd=>{const cmds=cmd.key?cmd.key.split(":"):null;if(Array.isArray(cmds)&&cmds[1]===subCommandName)return command=cmd,!1})),command}(subCommandName,command.submenu.items)),!0===command.disabled)return;if("function"==typeof command.disabled&&!0===command.disabled.call(this.hot))return;if((0,object.mQ)(command,"submenu"))return;const callbacks=[];"function"==typeof command.callback&&callbacks.push(command.callback),"function"==typeof this.commonCallback&&callbacks.push(this.commonCallback),params.unshift(commandSplit.join(":")),(0,array.z0)(callbacks,(callback=>callback.apply(this.hot,params)))}}const alignment_KEY="alignment";const clearColumn_KEY="clear_column";const columnLeft_KEY="col_left";const columnRight_KEY="col_right";const readOnly_KEY="make_read_only";const redo_KEY="redo";var utils=__webpack_require__("./node_modules/handsontable/selection/utils.mjs");const removeColumn_KEY="remove_col";const removeRow_KEY="remove_row";const rowAbove_KEY="row_above";const rowBelow_KEY="row_below";const noItems_KEY="no_items";const undo_KEY="undo";const ITEMS=["row_above","row_below","col_left","col_right","clear_column","remove_row","remove_col","undo","redo","make_read_only","alignment",KEY,"no_items"],_predefinedItems={[KEY]:function separatorItem(){return{name:KEY}},[noItems_KEY]:function noItemsItem(){return{key:"no_items",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}},[rowAbove_KEY]:function rowAboveItem(){return{key:"row_above",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){const latestSelection=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",latestSelection.row,1,"ContextMenu.rowAbove")},disabled(){const range=this.getSelectedRangeLast();return!!(!range||this.selection.isSelectedByColumnHeader()||range.isSingleHeader()&&range.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)||!!this.selection.isSelectedByCorner()&&0===this.countRows()},hidden(){return!this.getSettings().allowInsertRow}}},[rowBelow_KEY]:function rowBelowItem(){return{key:"row_below",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){const latestSelection=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",latestSelection.row,1,"ContextMenu.rowBelow")},disabled(){const range=this.getSelectedRangeLast();return!!(!range||this.selection.isSelectedByColumnHeader()||range.isSingleHeader()&&range.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[columnLeft_KEY]:function columnLeftItem(){return{key:"col_left",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){const latestSelection=this.getSelectedRangeLast().getTopLeftCorner(),alterAction=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(alterAction,latestSelection.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const range=this.getSelectedRangeLast();return!!(!range||this.selection.isSelectedByRowHeader()||range.isSingleHeader()&&range.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)||!!this.selection.isSelectedByCorner()&&0===this.countCols()},hidden(){return!this.getSettings().allowInsertColumn}}},[columnRight_KEY]:function columnRightItem(){return{key:"col_right",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){const latestSelection=this.getSelectedRangeLast().getTopRightCorner(),alterAction=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(alterAction,latestSelection.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const range=this.getSelectedRangeLast();return!!(!range||this.selection.isSelectedByRowHeader()||range.isSingleHeader()&&range.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[clearColumn_KEY]:function clearColumnItem(){return{key:"clear_column",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(key,selection){const startColumn=selection[0].start.col,endColumn=selection[0].end.col;this.countRows()&&this.populateFromArray(0,startColumn,[[null]],Math.max(selection[0].start.row,selection[0].end.row),endColumn,"ContextMenu.clearColumn")},disabled(){const range=this.getSelectedRangeLast();if(!range||range.isSingleHeader()&&range.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let atLeastOneNonReadOnly=!1;return range.forAll(((row,col)=>{if(row<0||col<0)return!0;const{readOnly}=this.getCellMeta(row,col);return!!readOnly||(atLeastOneNonReadOnly=!0,!1)})),!atLeastOneNonReadOnly}}},[removeRow_KEY]:function removeRowItem(){return{key:"remove_row",name(){const selection=this.getSelected();let pluralForm=0;if(selection)if(selection.length>1)pluralForm=1;else{const[fromRow,,toRow]=selection[0];fromRow-toRow!=0&&(pluralForm=1)}return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_REMOVE_ROW,pluralForm)},callback(){this.alter("remove_row",(0,utils.f7)(this),1,"ContextMenu.removeRow")},disabled(){const range=this.getSelectedRangeLast();if(!range)return!0;if(range.isSingleHeader()&&range.highlight.row<0)return!0;const totalRows=this.countRows();return this.selection.isSelectedByCorner()?0===totalRows:this.selection.isSelectedByColumnHeader()||0===totalRows},hidden(){return!this.getSettings().allowRemoveRow}}},[removeColumn_KEY]:function removeColumnItem(){return{key:"remove_col",name(){const selection=this.getSelected();let pluralForm=0;if(selection)if(selection.length>1)pluralForm=1;else{const[,fromColumn,,toColumn]=selection[0];fromColumn-toColumn!=0&&(pluralForm=1)}return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_REMOVE_COLUMN,pluralForm)},callback(){this.alter("remove_col",(0,utils.NB)(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const range=this.getSelectedRangeLast();if(!range)return!0;if(range.isSingleHeader()&&range.highlight.col<0)return!0;const totalColumns=this.countCols();return this.selection.isSelectedByCorner()?0===totalColumns:this.selection.isSelectedByRowHeader()||0===totalColumns},hidden(){return!this.getSettings().allowRemoveColumn}}},[undo_KEY]:function undoItem(){return{key:"undo",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){const undoRedo=this.getPlugin("undoRedo");return!undoRedo||!undoRedo.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[redo_KEY]:function redoItem(){return{key:"redo",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){const undoRedo=this.getPlugin("undoRedo");return!undoRedo||!undoRedo.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[readOnly_KEY]:function readOnlyItem(){return{key:"make_read_only",checkable:!0,ariaChecked(){return checkSelectionConsistency(this.getSelectedRange(),((row,col)=>this.getCellMeta(row,col).readOnly))},ariaLabel(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_READ_ONLY)},name(){let label=this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_READ_ONLY);return checkSelectionConsistency(this.getSelectedRange(),((row,col)=>this.getCellMeta(row,col).readOnly))&&(label=markLabelAsSelected(label)),label},callback(){const ranges=this.getSelectedRange(),atLeastOneReadOnly=checkSelectionConsistency(ranges,((row,col)=>this.getCellMeta(row,col).readOnly));(0,array.z0)(ranges,(range=>{range.forAll(((row,col)=>{row>=0&&col>=0&&this.setCellMeta(row,col,"readOnly",!atLeastOneReadOnly)}))})),this.render()},disabled(){const range=this.getSelectedRangeLast();return!range||(!!range.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}},[alignment_KEY]:function alignmentItem(){return{key:"alignment",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const range=this.getSelectedRangeLast();return!range||(!!range.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:"alignment:left",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},callback(){const selectedRange=this.getSelectedRange(),stateBefore=getAlignmentClasses(selectedRange,((row,col)=>this.getCellMeta(row,col).className));this.runHooks("beforeCellAlignment",stateBefore,selectedRange,"horizontal","htLeft"),align(selectedRange,"horizontal","htLeft",((row,col)=>this.getCellMeta(row,col)),((row,col,key,value)=>this.setCellMeta(row,col,key,value))),this.render()},disabled:!1},{key:"alignment:center",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},callback(){const selectedRange=this.getSelectedRange(),stateBefore=getAlignmentClasses(selectedRange,((row,col)=>this.getCellMeta(row,col).className));this.runHooks("beforeCellAlignment",stateBefore,selectedRange,"horizontal","htCenter"),align(selectedRange,"horizontal","htCenter",((row,col)=>this.getCellMeta(row,col)),((row,col,key,value)=>this.setCellMeta(row,col,key,value))),this.render()},disabled:!1},{key:"alignment:right",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},callback(){const selectedRange=this.getSelectedRange(),stateBefore=getAlignmentClasses(selectedRange,((row,col)=>this.getCellMeta(row,col).className));this.runHooks("beforeCellAlignment",stateBefore,selectedRange,"horizontal","htRight"),align(selectedRange,"horizontal","htRight",((row,col)=>this.getCellMeta(row,col)),((row,col,key,value)=>this.setCellMeta(row,col,key,value))),this.render()},disabled:!1},{key:"alignment:justify",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},callback(){const selectedRange=this.getSelectedRange(),stateBefore=getAlignmentClasses(selectedRange,((row,col)=>this.getCellMeta(row,col).className));this.runHooks("beforeCellAlignment",stateBefore,selectedRange,"horizontal","htJustify"),align(selectedRange,"horizontal","htJustify",((row,col)=>this.getCellMeta(row,col)),((row,col,key,value)=>this.setCellMeta(row,col,key,value))),this.render()},disabled:!1},{name:KEY},{key:"alignment:top",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},callback(){const selectedRange=this.getSelectedRange(),stateBefore=getAlignmentClasses(selectedRange,((row,col)=>this.getCellMeta(row,col).className));this.runHooks("beforeCellAlignment",stateBefore,selectedRange,"vertical","htTop"),align(selectedRange,"vertical","htTop",((row,col)=>this.getCellMeta(row,col)),((row,col,key,value)=>this.setCellMeta(row,col,key,value))),this.render()},disabled:!1},{key:"alignment:middle",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},callback(){const selectedRange=this.getSelectedRange(),stateBefore=getAlignmentClasses(selectedRange,((row,col)=>this.getCellMeta(row,col).className));this.runHooks("beforeCellAlignment",stateBefore,selectedRange,"vertical","htMiddle"),align(selectedRange,"vertical","htMiddle",((row,col)=>this.getCellMeta(row,col)),((row,col,key,value)=>this.setCellMeta(row,col,key,value))),this.render()},disabled:!1},{key:"alignment:bottom",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},callback(){const selectedRange=this.getSelectedRange(),stateBefore=getAlignmentClasses(selectedRange,((row,col)=>this.getCellMeta(row,col).className));this.runHooks("beforeCellAlignment",stateBefore,selectedRange,"vertical","htBottom"),align(selectedRange,"vertical","htBottom",((row,col)=>this.getCellMeta(row,col)),((row,col,key,value)=>this.setCellMeta(row,col,key,value))),this.render()},disabled:!1}]}}}};function predefinedItems(){const items={};return(0,object.v4)(_predefinedItems,((itemFactory,key)=>{items[key]=itemFactory()})),items}function itemsFactory_defineProperty(e,r,t){return(r=function itemsFactory_toPropertyKey(t){var i=function itemsFactory_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ItemsFactory{constructor(hotInstance){let orderPattern=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;itemsFactory_defineProperty(this,"hot",void 0),itemsFactory_defineProperty(this,"predefinedItems",predefinedItems()),itemsFactory_defineProperty(this,"defaultOrderPattern",void 0),this.hot=hotInstance,this.defaultOrderPattern=orderPattern}setPredefinedItems(predefinedItemsCollection){const items={};this.defaultOrderPattern.length=0,(0,object.v4)(predefinedItemsCollection,((value,key)=>{let menuItemKey="";value.name===KEY?(items[KEY]=value,menuItemKey=KEY):isNaN(parseInt(key,10))?(value.key=void 0===value.key?key:value.key,items[key]=value,menuItemKey=value.key):(items[value.key]=value,menuItemKey=value.key),this.defaultOrderPattern.push(menuItemKey)})),this.predefinedItems=items}getItems(){return function getItems(){let itemsPattern=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,defaultPattern=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],items=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const result=[];let pattern=itemsPattern;pattern&&pattern.items?pattern=pattern.items:Array.isArray(pattern)||(pattern=defaultPattern);(0,object.Gv)(pattern)?(0,object.v4)(pattern,((value,key)=>{let item=items["string"==typeof value?value:key];item||(item=value),(0,object.Gv)(value)?(0,object.X$)(item,value):"string"==typeof item&&(item={name:item}),void 0===item.key&&(item.key=key),result.push(item)})):(0,array.z0)(pattern,((name,key)=>{let item=items[name];!item&&ITEMS.indexOf(name)>=0||(item||(item={name,key:`${key}`}),(0,object.Gv)(name)&&(0,object.X$)(item,name),void 0===item.key&&(item.key=key),result.push(item))}));return result}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function cursor_defineProperty(e,r,t){return(r=function cursor_toPropertyKey(t){var i=function cursor_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class Cursor{constructor(object,rootWindow){cursor_defineProperty(this,"top",void 0),cursor_defineProperty(this,"topRelative",void 0),cursor_defineProperty(this,"left",void 0),cursor_defineProperty(this,"leftRelative",void 0),cursor_defineProperty(this,"scrollTop",void 0),cursor_defineProperty(this,"scrollLeft",void 0),cursor_defineProperty(this,"cellHeight",void 0),cursor_defineProperty(this,"cellWidth",void 0);const windowScrollTop=rootWindow.scrollY,windowScrollLeft=rootWindow.scrollX;let top,topRelative,left,leftRelative,cellHeight,cellWidth;this.rootWindow=rootWindow,this.type=this.getSourceType(object),"literal"===this.type?(top=parseInt(object.top,10),left=parseInt(object.left,10),cellHeight=object.height||0,cellWidth=object.width||0,topRelative=top,leftRelative=left,top+=windowScrollTop,left+=windowScrollLeft):"event"===this.type&&(top=parseInt(object.pageY,10),left=parseInt(object.pageX,10),cellHeight=object.target.clientHeight,cellWidth=object.target.clientWidth,topRelative=top-windowScrollTop,leftRelative=left-windowScrollLeft),this.top=top,this.topRelative=topRelative,this.left=left,this.leftRelative=leftRelative,this.scrollTop=windowScrollTop,this.scrollLeft=windowScrollLeft,this.cellHeight=cellHeight,this.cellWidth=cellWidth}getSourceType(object){let type="literal";return object instanceof Event&&(type="event"),type}fitsAbove(element){return this.topRelative>=element.offsetHeight}fitsBelow(element){let viewportHeight=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+element.offsetHeight<=viewportHeight}fitsOnRight(element){let viewportWidth=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+element.offsetWidth<=viewportWidth}fitsOnLeft(element){return this.leftRelative>=element.offsetWidth}}function positioner_classPrivateFieldInitSpec(e,t,a){(function positioner_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function positioner_classPrivateFieldGet(s,a){return s.get(positioner_assertClassBrand(s,a))}function positioner_classPrivateFieldSet(s,a,r){return s.set(positioner_assertClassBrand(s,a),r),r}function positioner_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var positioner_container=new WeakMap,_parentContainer=new WeakMap,_cursor=new WeakMap,_keepInViewport=new WeakMap,_offset=new WeakMap;class Positioner{constructor(keepInViewport){positioner_classPrivateFieldInitSpec(this,positioner_container,void 0),positioner_classPrivateFieldInitSpec(this,_parentContainer,void 0),positioner_classPrivateFieldInitSpec(this,_cursor,void 0),positioner_classPrivateFieldInitSpec(this,_keepInViewport,!1),positioner_classPrivateFieldInitSpec(this,_offset,{above:0,below:0,left:0,right:0}),positioner_classPrivateFieldSet(_keepInViewport,this,keepInViewport)}setOffset(direction){let offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return positioner_classPrivateFieldGet(_offset,this)[direction]=offset,this}setElement(container){return positioner_classPrivateFieldSet(positioner_container,this,container),this}setParentElement(container){return positioner_classPrivateFieldSet(_parentContainer,this,container),this}updatePosition(coords){positioner_classPrivateFieldSet(_cursor,this,new Cursor(coords,positioner_classPrivateFieldGet(positioner_container,this).ownerDocument.defaultView)),positioner_classPrivateFieldGet(_keepInViewport,this)?(positioner_classPrivateFieldGet(_cursor,this).fitsBelow(positioner_classPrivateFieldGet(positioner_container,this))?this.setPositionBelowCursor():positioner_classPrivateFieldGet(_cursor,this).fitsAbove(positioner_classPrivateFieldGet(positioner_container,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===positioner_classPrivateFieldGet(positioner_container,this).dir?positioner_classPrivateFieldGet(_cursor,this).fitsOnLeft(positioner_classPrivateFieldGet(positioner_container,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():positioner_classPrivateFieldGet(_cursor,this).fitsOnRight(positioner_classPrivateFieldGet(positioner_container,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let top=positioner_classPrivateFieldGet(_offset,this).above+positioner_classPrivateFieldGet(_cursor,this).top-positioner_classPrivateFieldGet(positioner_container,this).offsetHeight;positioner_classPrivateFieldGet(_parentContainer,this)&&(top=positioner_classPrivateFieldGet(_cursor,this).top+positioner_classPrivateFieldGet(_cursor,this).cellHeight-positioner_classPrivateFieldGet(positioner_container,this).offsetHeight+3),positioner_classPrivateFieldGet(positioner_container,this).style.top=`${top}px`}setPositionBelowCursor(){let top=positioner_classPrivateFieldGet(_offset,this).below+positioner_classPrivateFieldGet(_cursor,this).top+1;positioner_classPrivateFieldGet(_parentContainer,this)&&(top=positioner_classPrivateFieldGet(_cursor,this).top-1),positioner_classPrivateFieldGet(positioner_container,this).style.top=`${top}px`}setPositionOnRightOfCursor(){let left=positioner_classPrivateFieldGet(_cursor,this).left;if(positioner_classPrivateFieldGet(_parentContainer,this)){const rootWindow=positioner_classPrivateFieldGet(_parentContainer,this).ownerDocument.defaultView,borderRightWidth=Number.parseInt(rootWindow.getComputedStyle(positioner_classPrivateFieldGet(_parentContainer,this).querySelector(".htCore")).borderRightWidth,10);left+=positioner_classPrivateFieldGet(_cursor,this).cellWidth+borderRightWidth}else left+=positioner_classPrivateFieldGet(_offset,this).right;positioner_classPrivateFieldGet(positioner_container,this).style.left=`${left}px`}setPositionOnLeftOfCursor(){let left=positioner_classPrivateFieldGet(_offset,this).left+positioner_classPrivateFieldGet(_cursor,this).left-positioner_classPrivateFieldGet(positioner_container,this).offsetWidth;if(positioner_classPrivateFieldGet(_parentContainer,this)){const rootWindow=positioner_classPrivateFieldGet(_parentContainer,this).ownerDocument.defaultView;left-=Number.parseInt(rootWindow.getComputedStyle(positioner_classPrivateFieldGet(_parentContainer,this).querySelector(".htCore")).borderLeftWidth,10)}positioner_classPrivateFieldGet(positioner_container,this).style.left=`${left}px`}}function createPaginator(_ref){let{initialPage=-1,size=()=>0,onItemSelect=()=>{},onClear=()=>{}}=_ref;const visitedPages=new Set;let currentIndex=(0,number.qE)(initialPage,-1,getSize()-1);function _updateState(newIndex,direction){const lastIndex=getSize()-1;if(newIndex<0&&(newIndex=lastIndex),newIndex>lastIndex&&(newIndex=0),visitedPages.has(newIndex))return-1;visitedPages.add(newIndex);return!1===onItemSelect(newIndex,!1)&&(newIndex=_updateState(1===direction?++newIndex:--newIndex,direction)),newIndex}function getSize(){return Math.max(size(),0)}return{setCurrentPage:function setCurrentPage(index){index>-1&&index<getSize()&&!1!==onItemSelect(index,!0)&&(currentIndex=index)},getCurrentPage:function getCurrentPage(){return currentIndex},toFirstItem:function toFirstItem(){getSize()>0&&(visitedPages.clear(),currentIndex=_updateState(0,1))},toLastItem:function toLastItem(){getSize()>0&&(visitedPages.clear(),currentIndex=_updateState(getSize()-1,-1))},toNextItem:function toNextItem(){getSize()>0&&(visitedPages.clear(),currentIndex=_updateState(++currentIndex,1))},toPreviousItem:function toPreviousItem(){getSize()>0&&(visitedPages.clear(),currentIndex=_updateState(--currentIndex,-1))},getSize,clear:function clear(){visitedPages.clear(),currentIndex=initialPage,onClear()}}}function isItemSubMenu(itemToTest){return(0,object.mQ)(itemToTest,"submenu")}function isItemSeparator(itemToTest){return new RegExp(KEY,"i").test(itemToTest.name)}function isItemDisabled(itemToTest,hot){return!0===itemToTest.disabled||"function"==typeof itemToTest.disabled&&!0===itemToTest.disabled.call(hot)}function isItemSelectionDisabled(itemToTest){return(0,object.mQ)(itemToTest,"disableSelection")}function shiftSeparators(items,separator){const result=items.slice(0);for(let i=0;i<result.length&&result[i].name===separator;)result.shift();return result}function filterSeparators(items){let separator=arguments.length>1&&void 0!==arguments[1]?arguments[1]:KEY,result=items.slice(0);return result=shiftSeparators(result,separator),result=function popSeparators(items,separator){let result=items.slice(0);return result.reverse(),result=shiftSeparators(result,separator),result.reverse(),result}(result,separator),result=function removeDuplicatedSeparators(items){const result=[];return(0,array.z0)(items,((value,index)=>{index>0?result[result.length-1].name!==value.name&&result.push(value):result.push(value)})),result}(result),result}function createMenuNavigator(hotMenu){return createPaginator({size:()=>hotMenu.countRows(),onItemSelect(currentItem,directItemChange){const cell=hotMenu.getCell(currentItem,0);if(!cell||function isSeparator(cell){return(0,dom_element.nB)(cell,"htSeparator")}(cell)||function isDisabled(cell){return(0,dom_element.nB)(cell,"htDisabled")}(cell)||function isSelectionDisabled(cell){return(0,dom_element.nB)(cell,"htSelectionDisabled")}(cell))return!1;hotMenu.selectCell(currentItem,0,...directItemChange?[currentItem,0,!1,!1]:[])},onClear(){hotMenu.deselectCell()}})}function menu_classPrivateFieldInitSpec(e,t,a){(function menu_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function menu_defineProperty(e,r,t){return(r=function menu_toPropertyKey(t){var i=function menu_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function menu_classPrivateFieldSet(s,a,r){return s.set(menu_assertClassBrand(s,a),r),r}function menu_classPrivateFieldGet(s,a){return s.get(menu_assertClassBrand(s,a))}function menu_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _navigator=new WeakMap,_shortcutsCtrl=new WeakMap,_tableBorderWidth=new WeakMap;class Menu{get tableBorderWidth(){return void 0===menu_classPrivateFieldGet(_tableBorderWidth,this)&&this.hotMenu&&menu_classPrivateFieldSet(_tableBorderWidth,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),menu_classPrivateFieldGet(_tableBorderWidth,this)}constructor(hotInstance,options){var _this=this;menu_defineProperty(this,"hot",void 0),menu_defineProperty(this,"options",void 0),menu_defineProperty(this,"eventManager",new handsontable_eventManager.A(this)),menu_defineProperty(this,"container",void 0),menu_defineProperty(this,"positioner",void 0),menu_defineProperty(this,"hotMenu",null),menu_defineProperty(this,"hotSubMenus",{}),menu_defineProperty(this,"parentMenu",void 0),menu_defineProperty(this,"menuItems",null),menu_defineProperty(this,"origOutsideClickDeselects",null),menu_classPrivateFieldInitSpec(this,_navigator,void 0),menu_classPrivateFieldInitSpec(this,_shortcutsCtrl,void 0),menu_classPrivateFieldInitSpec(this,_tableBorderWidth,void 0),this.hot=hotInstance,this.options=options||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this.parentMenu.runLocalHooks("afterSelectionChange",...args)})),this.hot.addHook("afterSetTheme",((themeName,firstRun)=>{var _this$hotMenu;firstRun||(null===(_this$hotMenu=this.hotMenu)||void 0===_this$hotMenu||_this$hotMenu.useTheme(themeName))}))}registerEvents(){let frame=this.hot.rootWindow;for(;frame;)this.eventManager.addEventListener(frame.document,"mousedown",(event=>this.onDocumentMouseDown(event))),this.eventManager.addEventListener(frame.document,"touchstart",(event=>this.onDocumentMouseDown(event))),this.eventManager.addEventListener(frame.document,"contextmenu",(event=>this.onDocumentContextMenu(event))),frame=(0,dom_element.Ly)(frame)}setMenuItems(menuItems){this.menuItems=menuItems}getNavigator(){return menu_classPrivateFieldGet(_navigator,this)}getKeyboardShortcutsCtrl(){return menu_classPrivateFieldGet(_shortcutsCtrl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const delayedOpenSubMenu=(0,helpers_function.sg)((row=>this.openSubMenu(row)),300),minWidthOfMenu=this.options.minWidth||215;let noItemsDefined=!1,filteredItems=(0,array.y0)(this.menuItems,(item=>("no_items"===item.key&&(noItemsDefined=!0),function isItemHidden(item,instance){return!item.hidden||!("function"==typeof item.hidden&&item.hidden.call(instance))}(item,this.hot))));if(filteredItems.length<1&&!noItemsDefined)filteredItems.push(predefinedItems().no_items);else if(0===filteredItems.length)return;filteredItems=filterSeparators(filteredItems,KEY);let shouldAutoCloseMenu=!1;const settings={data:filteredItems,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:width=>(0,mixed.O9)(width)&&width<minWidthOfMenu?minWidthOfMenu:width,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(mainTableHot=this.hot,(menuHot,TD,row,col,prop,value)=>{const item=menuHot.getSourceDataAtRow(row),wrapper=mainTableHot.rootDocument.createElement("div"),itemValue="function"==typeof value?value.call(mainTableHot):value,ariaLabel="function"==typeof item.ariaLabel?item.ariaLabel.call(mainTableHot):item.ariaLabel,ariaChecked="function"==typeof item.ariaChecked?item.ariaChecked.call(mainTableHot):item.ariaChecked;if((0,dom_element.Ie)(TD),(0,dom_element.iQ)(wrapper,"htItemWrapper"),mainTableHot.getSettings().ariaTags){const isFocusable=!isItemDisabled(item,mainTableHot)&&!isItemSelectionDisabled(item)&&!isItemSeparator(item);(0,dom_element.Bq)(TD,[...(itemToTest=item,!0===itemToTest.checkable?[(0,a11y.pt)(),(0,a11y.SM)(ariaLabel),(0,a11y.Xq)(ariaChecked)]:[(0,a11y.ZA)(),(0,a11y.SM)(itemValue)]),...isFocusable?[(0,a11y.vC)(-1)]:[],...isItemDisabled(item,mainTableHot)?[(0,a11y._R)()]:[],...isItemSubMenu(item)?[(0,a11y.dV)(!1)]:[]])}var itemToTest;TD.className="",TD.appendChild(wrapper),isItemSeparator(item)?(0,dom_element.iQ)(TD,"htSeparator"):"function"==typeof item.renderer?((0,dom_element.iQ)(TD,"htCustomMenuRenderer"),TD.appendChild(item.renderer(menuHot,wrapper,row,col,prop,itemValue))):(0,dom_element.Mv)(wrapper,itemValue),isItemDisabled(item,mainTableHot)?(0,dom_element.iQ)(TD,"htDisabled"):isItemSelectionDisabled(item)?(0,dom_element.iQ)(TD,"htSelectionDisabled"):isItemSubMenu(item)&&(0,dom_element.iQ)(TD,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(event,coords)=>{menu_classPrivateFieldGet(_navigator,this).setCurrentPage(coords.row)},afterOnCellMouseOver:(event,coords)=>{this.isAllSubMenusClosed()?delayedOpenSubMenu(coords.row):this.openSubMenu(coords.row)},afterOnCellContextMenu:event=>{event.preventDefault(),(0,browser.Yh)()&&shouldAutoCloseMenu&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(row,column,row2,column2,preventScrolling)=>{this.hotMenu.view.isMouseDown()&&(preventScrolling.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:event=>{this.hasSelectedItem()&&(shouldAutoCloseMenu=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(event))},afterOnCellMouseUp:event=>{(0,browser.Yh)()&&(0,dom_event.nO)(event)||!shouldAutoCloseMenu||!this.hasSelectedItem()||((0,browser.rr)()||(0,browser.zG)()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var mainTableHot;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,settings),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),menu_classPrivateFieldSet(_navigator,this,createMenuNavigator(this.hotMenu)),menu_classPrivateFieldSet(_shortcutsCtrl,this,function createKeyboardShortcutsCtrl(menu){let customKeyboardShortcuts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const customShortcuts=[];function _addShortcuts(shortcuts,contextName){getContext(contextName).addShortcuts(shortcuts,{group:"menu"})}function addCustomShortcuts(shortcuts,contextName){const context=getContext(contextName);shortcuts.forEach((_ref2=>{let{keys}=_ref2;keys.forEach((k=>context.removeShortcutsByKeys(k)))})),customShortcuts.push({shortcuts,contextName}),_addShortcuts(shortcuts,contextName)}function _getContextName(contextName){return contextName?`menu:${contextName}`:"menu"}function getContext(contextName){var _manager$getContext;const manager=menu.hotMenu.getShortcutManager(),name=_getContextName(contextName);return null!==(_manager$getContext=manager.getContext(name))&&void 0!==_manager$getContext?_manager$getContext:manager.addContext(name)}return _addShortcuts(function createDefaultShortcutsList(menu){const{hot,hotMenu}=menu;return[{keys:[["Control/Meta","A"]],forwardToContext:hot.getShortcutManager().getContext("grid"),callback:()=>menu.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(event,keys)=>{const settings=hot.getSettings(),tabMoves="function"==typeof settings.tabMoves?settings.tabMoves(event):settings.tabMoves;keys.includes("shift")?hot.selection.transformStart(-tabMoves.row,-tabMoves.col):hot.selection.transformStart(tabMoves.row,tabMoves.col),menu.close(!0)}},{keys:[["Escape"]],callback:()=>menu.close()},{keys:[["ArrowDown"]],callback:()=>menu.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>menu.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const selection=hotMenu.getSelectedLast();if(selection){const subMenu=menu.openSubMenu(selection[0]);subMenu&&subMenu.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{hotMenu.getSelectedLast()&&menu.isSubMenu()&&(menu.close(),menu.isSubMenu()&&menu.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>menu.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>menu.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:event=>{const selection=hotMenu.getSelectedLast();selection&&(hotMenu.getSourceDataAtRow(selection[0]).submenu?menu.openSubMenu(selection[0]).getNavigator().toFirstItem():(menu.executeCommand(event),menu.close(!0)))}},{keys:[["PageUp"]],callback:()=>{hotMenu.getSelectedLast()?hotMenu.selection.transformStart(-hotMenu.countVisibleRows(),0):menu.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{hotMenu.getSelectedLast()?hotMenu.selection.transformStart(hotMenu.countVisibleRows(),0):menu.getNavigator().toLastItem()}}]}(menu)),customKeyboardShortcuts.forEach((_ref=>{let{shortcuts,contextName}=_ref;addCustomShortcuts(shortcuts,contextName)})),{addCustomShortcuts,getCustomShortcuts:function getCustomShortcuts(){return[...customShortcuts]},getContext,listen:function listen(contextName){menu.hotMenu.getShortcutManager().setActiveContextName(_getContextName(contextName))}}}(this)),menu_classPrivateFieldGet(_shortcutsCtrl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let closeParent=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(closeParent&&this.isSubMenu())this.parentMenu.close();else if(menu_classPrivateFieldGet(_navigator,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const selection=this.parentMenu.hotMenu.getSelectedLast();if(selection){const cell=this.parentMenu.hotMenu.getCell(selection[0],0);(0,dom_element.Bq)(cell,[(0,a11y.dV)(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(row){if(!this.hotMenu)return!1;const cell=this.hotMenu.getCell(row,0);if(this.closeAllSubMenus(),!cell||!function hasSubMenu(cell){return(0,dom_element.nB)(cell,"htSubmenu")}(cell))return!1;const dataItem=this.hotMenu.getSourceDataAtRow(row),subMenu=new Menu(this.hot,{parent:this,name:dataItem.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return subMenu.setMenuItems(dataItem.submenu.items),subMenu.open(),subMenu.setPosition(cell.getBoundingClientRect()),this.hotSubMenus[dataItem.key]=subMenu,this.hot.getSettings().ariaTags&&(0,dom_element.Bq)(cell,[(0,a11y.dV)(!0)]),subMenu}closeSubMenu(row){const dataItem=this.hotMenu.getSourceDataAtRow(row),menus=this.hotSubMenus[dataItem.key];if(menus){menus.destroy(),delete this.hotSubMenus[dataItem.key];const cell=this.hotMenu.getCell(row,0);this.hot.getSettings().ariaTags&&(0,dom_element.Bq)(cell,[(0,a11y.dV)(!1)])}}closeAllSubMenus(){(0,array.z0)(this.hotMenu.getData(),((value,row)=>this.closeSubMenu(row)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const menuContainerParentElement=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),menuContainerParentElement&&menuContainerParentElement.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(event){if(!this.isOpened()||!this.hasSelectedItem())return;const selectedItem=this.getSelectedItem();if(this.runLocalHooks("select",selectedItem,event),this.isCommandPassive(selectedItem))return;const selRanges=this.hot.getSelectedRange(),normalizedSelection=selRanges?function normalizeSelection(selRanges){return(0,array.YD)(selRanges,(range=>({start:range.getTopStartCorner(),end:range.getBottomEndCorner()})))}(selRanges):[];this.runLocalHooks("executeCommand",selectedItem.key,normalizedSelection,event),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",selectedItem.key,normalizedSelection,event)}isCommandPassive(commandDescriptor){return!1===commandDescriptor.isCommand||isItemSeparator(commandDescriptor)||isItemDisabled(commandDescriptor,this.hot)||isItemSubMenu(commandDescriptor)}setOffset(area){let offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(area,offset)}setPosition(coords){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(coords)}updateMenuDimensions(){const stylesHandler=this.hotMenu.view.getStylesHandler(),{wtTable}=this.hotMenu.view._wt,data=this.hotMenu.getSettings().data,hiderStyle=wtTable.hider.style,holderStyle=wtTable.holder.style,currentHiderWidth=parseInt(hiderStyle.width,10),realHeight=(0,array.mu)(data,((accumulator,value,index)=>{const currentRowHeight=this.hotMenu.getCell(index,0)?(0,dom_element.DK)(this.hotMenu.getCell(index,0)):0;return accumulator+(value.name===KEY?1:currentRowHeight)}),0);stylesHandler.isClassicTheme()?(holderStyle.width=`${currentHiderWidth+3}px`,holderStyle.height=`${realHeight+3}px`):(holderStyle.width=`${currentHiderWidth}px`,holderStyle.height=`${realHeight}px`),hiderStyle.height=holderStyle.height}createContainer(){let name=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const doc=this.options.container.ownerDocument;let container,className=name;return className&&((0,helpers_function.Tn)(className)&&(className=className.call(this.hot),className=null===className||(0,mixed.b0)(className)?"":className.toString()),className=className.replace(/[^A-Za-z0-9]/g,"_"),className=`${this.options.className}Sub_${className}`,container=doc.querySelector(`.${this.options.className}.${className}`)),container||(container=doc.createElement("div"),(0,dom_element.iQ)(container,`htMenu handsontable ${this.options.className}`),className&&(0,dom_element.iQ)(container,className),this.options.container.appendChild(container)),container}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&(0,dom_element.Bq)(this.hotMenu.rootElement,[(0,a11y.nF)(),(0,a11y.vC)(-1)])}onDocumentMouseDown(event){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,dom_element.aO)(event.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||(0,dom_element.aO)(event.target,".htMenu")||this.close(!0))}onDocumentContextMenu(event){this.isOpened()&&(0,dom_element.nB)(event.target,"htCore")&&(0,dom_element.aO)(event.target,this.hotMenu.rootElement)&&event.preventDefault()}}function contextMenu_classPrivateMethodInitSpec(e,a){(function contextMenu_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function contextMenu_defineProperty(e,r,t){return(r=function contextMenu_toPropertyKey(t){var i=function contextMenu_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function contextMenu_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(0,object.co)(Menu,localHooks.A);hooks.R.getSingleton().register("afterContextMenuDefaultOptions"),hooks.R.getSingleton().register("beforeContextMenuShow"),hooks.R.getSingleton().register("afterContextMenuShow"),hooks.R.getSingleton().register("afterContextMenuHide"),hooks.R.getSingleton().register("afterContextMenuExecute");var _ContextMenu_brand=new WeakSet;class ContextMenu extends BasePlugin{constructor(){super(...arguments),contextMenu_classPrivateMethodInitSpec(this,_ContextMenu_brand),contextMenu_defineProperty(this,"commandExecutor",new CommandExecutor(this.hot)),contextMenu_defineProperty(this,"itemsFactory",null),contextMenu_defineProperty(this,"menu",null)}static get PLUGIN_KEY(){return"contextMenu"}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return["row_above","row_below",KEY,"col_left","col_right",KEY,"remove_row","remove_col",KEY,"undo","redo",KEY,"make_read_only",KEY,"alignment"]}isEnabled(){return!!this.hot.getSettings().contextMenu}enablePlugin(){var _this=this;if(this.enabled)return;const settings=this.hot.getSettings().contextMenu;"function"==typeof settings.callback&&this.commandExecutor.setCommonCallback(settings.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:settings.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>contextMenu_assertClassBrand(_ContextMenu_brand,this,_onMenuBeforeOpen).call(this))),this.menu.addLocalHook("afterOpen",(()=>contextMenu_assertClassBrand(_ContextMenu_brand,this,_onMenuAfterOpen).call(this))),this.menu.addLocalHook("afterClose",(()=>contextMenu_assertClassBrand(_ContextMenu_brand,this,_onMenuAfterClose).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return _this.executeCommand.call(_this,...params)})),this.addHook("afterOnCellContextMenu",(event=>contextMenu_assertClassBrand(_ContextMenu_brand,this,_onAfterOnCellContextMenu).call(this,event))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const rect=this.hot.getCell(highlight.row,highlight.col,!0).getBoundingClientRect(),offset=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({left:rect.left+offset.left,top:rect.top+offset.top-1+rect.height},{left:rect.width,above:-rect.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var _this$hot$getSelected;const highlight=null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.highlight;return highlight&&this.hot.selection.isCellVisible(highlight)&&!this.menu.isOpened()},group:"contextMenu"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("contextMenu")}open(position){var _this$menu;let offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(_this$menu=this.menu)&&void 0!==_this$menu&&_this$menu.isOpened())return;this.prepareMenuItems(),this.menu.open();const themeHasTableBorder=this.menu.tableBorderWidth>0;(0,object.v4)(offset,((value,key)=>{const valueWithoutBorder=["below","right"].includes(key)?value+1:value-1;this.menu.setOffset(key,themeHasTableBorder?value:valueWithoutBorder)})),this.menu.setPosition(position)}close(){var _this$menu2;null===(_this$menu2=this.menu)||void 0===_this$menu2||_this$menu2.close(),this.itemsFactory=null}executeCommand(commandName){null===this.itemsFactory&&this.prepareMenuItems();for(var _len2=arguments.length,params=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)params[_key2-1]=arguments[_key2];this.commandExecutor.execute(commandName,...params)}prepareMenuItems(){this.itemsFactory=new ItemsFactory(this.hot,ContextMenu.DEFAULT_ITEMS);const settings=this.hot.getSettings().contextMenu,predefinedItems={items:this.itemsFactory.getItems(settings)};this.hot.runHooks("afterContextMenuDefaultOptions",predefinedItems),this.itemsFactory.setPredefinedItems(predefinedItems.items);const menuItems=this.itemsFactory.getItems(settings);this.hot.runHooks("beforeContextMenuSetItems",menuItems),this.menu.setMenuItems(menuItems),(0,array.z0)(menuItems,(command=>this.commandExecutor.registerCommand(command.key,command)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _onAfterOnCellContextMenu(event){const settings=this.hot.getSettings(),showRowHeaders=settings.rowHeaders,showColHeaders=settings.colHeaders;const element=event.target;if(this.close(),(0,dom_element.nB)(element,"handsontableInput"))return;if(event.preventDefault(),event.stopPropagation(),!showRowHeaders&&!showColHeaders&&!(function isValidElement(element){return"TD"===element.nodeName||"TD"===element.parentNode.nodeName}(element)||(0,dom_element.nB)(element,"current")&&(0,dom_element.nB)(element,"wtBorder")))return;const offset=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({top:event.clientY+offset.top,left:event.clientX+offset.left})}function _onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}function _onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}function _onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ContextMenu.SEPARATOR={name:KEY};var SheetClip=__webpack_require__("./node_modules/handsontable/3rdparty/SheetClip/SheetClip.mjs");class ClipboardData{constructor(){this.data={}}setData(type,value){this.data[type]=value}getData(type){return this.data[type]||void 0}}class PasteEvent{constructor(){this.clipboardData=new ClipboardData}preventDefault(){}}function copyableRanges_classPrivateFieldInitSpec(e,t,a){copyableRanges_checkPrivateRedeclaration(e,t),t.set(e,a)}function copyableRanges_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function copyableRanges_classPrivateFieldGet(s,a){return s.get(copyableRanges_assertClassBrand(s,a))}function copyableRanges_classPrivateFieldSet(s,a,r){return s.set(copyableRanges_assertClassBrand(s,a),r),r}function copyableRanges_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _selectedRange=new WeakMap,_countRows=new WeakMap,_countColumns=new WeakMap,_rowsLimit=new WeakMap,_columnsLimit=new WeakMap,_countColumnHeaders=new WeakMap,_CopyableRangesFactory_brand=new WeakSet;class CopyableRangesFactory{constructor(_ref){let{countRows,countColumns,rowsLimit,columnsLimit,countColumnHeaders}=_ref;!function copyableRanges_classPrivateMethodInitSpec(e,a){copyableRanges_checkPrivateRedeclaration(e,a),a.add(e)}(this,_CopyableRangesFactory_brand),copyableRanges_classPrivateFieldInitSpec(this,_selectedRange,void 0),copyableRanges_classPrivateFieldInitSpec(this,_countRows,void 0),copyableRanges_classPrivateFieldInitSpec(this,_countColumns,void 0),copyableRanges_classPrivateFieldInitSpec(this,_rowsLimit,void 0),copyableRanges_classPrivateFieldInitSpec(this,_columnsLimit,void 0),copyableRanges_classPrivateFieldInitSpec(this,_countColumnHeaders,void 0),copyableRanges_classPrivateFieldSet(_countRows,this,countRows),copyableRanges_classPrivateFieldSet(_countColumns,this,countColumns),copyableRanges_classPrivateFieldSet(_rowsLimit,this,rowsLimit),copyableRanges_classPrivateFieldSet(_columnsLimit,this,columnsLimit),copyableRanges_classPrivateFieldSet(_countColumnHeaders,this,countColumnHeaders)}setSelectedRange(selectedRange){copyableRanges_classPrivateFieldSet(_selectedRange,this,selectedRange)}getCellsRange(){if(0===copyableRanges_classPrivateFieldGet(_countRows,this).call(this)||0===copyableRanges_classPrivateFieldGet(_countColumns,this).call(this))return null;const{row:startRow,col:startCol}=copyableRanges_classPrivateFieldGet(_selectedRange,this).getTopStartCorner(),{row:endRow,col:endCol}=copyableRanges_classPrivateFieldGet(_selectedRange,this).getBottomEndCorner(),finalEndRow=copyableRanges_assertClassBrand(_CopyableRangesFactory_brand,this,_trimRowsRange).call(this,startRow,endRow),finalEndCol=copyableRanges_assertClassBrand(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,startCol,endCol);return{isRangeTrimmed:endRow!==finalEndRow||endCol!==finalEndCol,startRow,startCol,endRow:finalEndRow,endCol:finalEndCol}}getMostBottomColumnHeadersRange(){if(0===copyableRanges_classPrivateFieldGet(_countColumns,this).call(this)||0===copyableRanges_classPrivateFieldGet(_countColumnHeaders,this).call(this))return null;const{col:startCol}=copyableRanges_classPrivateFieldGet(_selectedRange,this).getTopStartCorner(),{col:endCol}=copyableRanges_classPrivateFieldGet(_selectedRange,this).getBottomEndCorner(),finalEndCol=copyableRanges_assertClassBrand(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,startCol,endCol);return{isRangeTrimmed:endCol!==finalEndCol,startRow:-1,startCol,endRow:-1,endCol:finalEndCol}}getAllColumnHeadersRange(){if(0===copyableRanges_classPrivateFieldGet(_countColumns,this).call(this)||0===copyableRanges_classPrivateFieldGet(_countColumnHeaders,this).call(this))return null;const{col:startCol}=copyableRanges_classPrivateFieldGet(_selectedRange,this).getTopStartCorner(),{col:endCol}=copyableRanges_classPrivateFieldGet(_selectedRange,this).getBottomEndCorner(),finalEndCol=copyableRanges_assertClassBrand(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,startCol,endCol);return{isRangeTrimmed:endCol!==finalEndCol,startRow:-copyableRanges_classPrivateFieldGet(_countColumnHeaders,this).call(this),startCol,endRow:-1,endCol:finalEndCol}}}function _trimColumnsRange(startColumn,endColumn){return Math.min(endColumn,Math.max(startColumn+copyableRanges_classPrivateFieldGet(_columnsLimit,this).call(this)-1,startColumn))}function _trimRowsRange(startRow,endRow){return Math.min(endRow,Math.max(startRow+copyableRanges_classPrivateFieldGet(_rowsLimit,this).call(this)-1,startRow))}function normalizeRanges(ranges){const rows=[],columns=[];return(0,array.z0)(ranges,(range=>{const minRow=Math.min(range.startRow,range.endRow),maxRow=Math.max(range.startRow,range.endRow);(0,number.Ti)(minRow,maxRow,(row=>{-1===rows.indexOf(row)&&rows.push(row)}));const minColumn=Math.min(range.startCol,range.endCol),maxColumn=Math.max(range.startCol,range.endCol);(0,number.Ti)(minColumn,maxColumn,(column=>{-1===columns.indexOf(column)&&columns.push(column)}))})),{rows,columns}}var parseTable=__webpack_require__("./node_modules/handsontable/utils/parseTable.mjs");function copyPaste_classPrivateFieldInitSpec(e,t,a){copyPaste_checkPrivateRedeclaration(e,t),t.set(e,a)}function copyPaste_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function copyPaste_defineProperty(e,r,t){return(r=function copyPaste_toPropertyKey(t){var i=function copyPaste_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function copyPaste_classPrivateFieldGet(s,a){return s.get(copyPaste_assertClassBrand(s,a))}function copyPaste_classPrivateFieldSet(s,a,r){return s.set(copyPaste_assertClassBrand(s,a),r),r}function copyPaste_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("afterCopyLimit"),hooks.R.getSingleton().register("modifyCopyableRange"),hooks.R.getSingleton().register("beforeCut"),hooks.R.getSingleton().register("afterCut"),hooks.R.getSingleton().register("beforePaste"),hooks.R.getSingleton().register("afterPaste"),hooks.R.getSingleton().register("beforeCopy"),hooks.R.getSingleton().register("afterCopy");const copyPaste_SETTING_KEYS=["fragmentSelection"],META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var _enableCopyColumnHeaders=new WeakMap,_enableCopyColumnGroupHeaders=new WeakMap,_enableCopyColumnHeadersOnly=new WeakMap,_copyMode=new WeakMap,_isTriggeredByCopy=new WeakMap,_isTriggeredByCut=new WeakMap,_copyableRangesFactory=new WeakMap,_preventViewportScrollOnPaste=new WeakMap,_CopyPaste_brand=new WeakSet;class CopyPaste extends BasePlugin{constructor(){super(...arguments),function copyPaste_classPrivateMethodInitSpec(e,a){copyPaste_checkPrivateRedeclaration(e,a),a.add(e)}(this,_CopyPaste_brand),copyPaste_defineProperty(this,"columnsLimit",1/0),copyPaste_defineProperty(this,"rowsLimit",1/0),copyPaste_defineProperty(this,"pasteMode","overwrite"),copyPaste_defineProperty(this,"uiContainer",this.hot.rootDocument.body),copyPaste_classPrivateFieldInitSpec(this,_enableCopyColumnHeaders,!1),copyPaste_classPrivateFieldInitSpec(this,_enableCopyColumnGroupHeaders,!1),copyPaste_classPrivateFieldInitSpec(this,_enableCopyColumnHeadersOnly,!1),copyPaste_classPrivateFieldInitSpec(this,_copyMode,"cells-only"),copyPaste_classPrivateFieldInitSpec(this,_isTriggeredByCopy,!1),copyPaste_classPrivateFieldInitSpec(this,_isTriggeredByCut,!1),copyPaste_classPrivateFieldInitSpec(this,_copyableRangesFactory,new CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),copyPaste_classPrivateFieldInitSpec(this,_preventViewportScrollOnPaste,!1),copyPaste_defineProperty(this,"copyableRanges",[])}static get PLUGIN_KEY(){return"copyPaste"}static get SETTING_KEYS(){return["copyPaste",...copyPaste_SETTING_KEYS]}static get PLUGIN_PRIORITY(){return 80}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings().copyPaste}enablePlugin(){var _this$getSetting,_this$getSetting2,_this=this;this.enabled||(this.pasteMode=null!==(_this$getSetting=this.getSetting("pasteMode"))&&void 0!==_this$getSetting?_this$getSetting:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),copyPaste_classPrivateFieldSet(_enableCopyColumnHeaders,this,this.getSetting("copyColumnHeaders")),copyPaste_classPrivateFieldSet(_enableCopyColumnGroupHeaders,this,this.getSetting("copyColumnGroupHeaders")),copyPaste_classPrivateFieldSet(_enableCopyColumnHeadersOnly,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=null!==(_this$getSetting2=this.getSetting("uiContainer"))&&void 0!==_this$getSetting2?_this$getSetting2:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",(options=>copyPaste_assertClassBrand(_CopyPaste_brand,this,_onAfterContextMenuDefaultOptions).call(this,options))),this.addHook("afterSelection",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return copyPaste_assertClassBrand(_CopyPaste_brand,_this,_onAfterSelection).call(_this,...args)})),this.addHook("afterSelectionEnd",(()=>copyPaste_assertClassBrand(_CopyPaste_brand,this,_onAfterSelectionEnd).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return _this.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return _this.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return _this.onPaste(...arguments)})),(0,browser.nr)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return copyPaste_assertClassBrand(_CopyPaste_brand,_this,_onSafariMouseEnter).call(_this,...args)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return copyPaste_assertClassBrand(_CopyPaste_brand,_this,_onSafariMouseLeave).call(_this,...args)})),this.addHook("afterSelection",(()=>copyPaste_assertClassBrand(_CopyPaste_brand,this,_onSafariAfterSelection).call(this)))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){copyPaste_classPrivateFieldSet(_copyMode,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),copyPaste_classPrivateFieldSet(_isTriggeredByCopy,this,!0),copyPaste_assertClassBrand(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){copyPaste_classPrivateFieldSet(_isTriggeredByCut,this,!0),copyPaste_assertClassBrand(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"cut")}getRangedCopyableData(ranges){return(0,SheetClip.A)(this.getRangedData(ranges))}getRangedData(ranges){const data=[],{rows,columns}=normalizeRanges(ranges);return(0,array.z0)(rows,(row=>{const rowSet=[];(0,array.z0)(columns,(column=>{row<0?rowSet.push(this.hot.getColHeader(column,row)):rowSet.push(this.hot.getCopyableData(row,column))})),data.push(rowSet)})),data}paste(){let pastableText=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",pastableHtml=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pastableText;if(!pastableText&&!pastableHtml)return;const pasteData=new PasteEvent;pastableText&&pasteData.clipboardData.setData("text/plain",pastableText),pastableHtml&&pasteData.clipboardData.setData("text/html",pastableHtml),this.onPaste(pasteData)}setCopyableText(){const selectionRange=this.hot.getSelectedRangeLast();if(!selectionRange)return;if(selectionRange.isSingleHeader())return void(this.copyableRanges=[]);copyPaste_classPrivateFieldGet(_copyableRangesFactory,this).setSelectedRange(selectionRange);const groupedRanges=new Map([["headers",null],["cells",null]]);"column-headers-only"===copyPaste_classPrivateFieldGet(_copyMode,this)?groupedRanges.set("headers",copyPaste_classPrivateFieldGet(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):("with-column-headers"===copyPaste_classPrivateFieldGet(_copyMode,this)?groupedRanges.set("headers",copyPaste_classPrivateFieldGet(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===copyPaste_classPrivateFieldGet(_copyMode,this)&&groupedRanges.set("headers",copyPaste_classPrivateFieldGet(_copyableRangesFactory,this).getAllColumnHeadersRange()),groupedRanges.set("cells",copyPaste_classPrivateFieldGet(_copyableRangesFactory,this).getCellsRange())),this.copyableRanges=Array.from(groupedRanges.values()).filter((range=>null!==range)).map((_ref=>{let{startRow,startCol,endRow,endCol}=_ref;return{startRow,startCol,endRow,endCol}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const cellsRange=groupedRanges.get("cells");if(null!==cellsRange&&cellsRange.isRangeTrimmed){const{startRow,startCol,endRow,endCol}=cellsRange;this.hot.runHooks("afterCopyLimit",endRow-startRow+1,endCol-startCol+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var _this$hot$getActiveEd;return null===(_this$hot$getActiveEd=this.hot.getActiveEditor())||void 0===_this$hot$getActiveEd?void 0:_this$hot$getActiveEd.isOpened()}populateValues(inputArray){let selection=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!inputArray.length)return;const populatedRowsLength=inputArray.length,populatedColumnsLength=inputArray[0].length,newRows=[],{row:startRow,col:startColumn}=selection.getTopStartCorner(),{row:endRowFromSelection,col:endColumnFromSelection}=selection.getBottomEndCorner();let visualRowForPopulatedData=startRow,visualColumnForPopulatedData=startColumn,lastVisualRow=startRow,lastVisualColumn=startColumn;for(;newRows.length<populatedRowsLength||visualRowForPopulatedData<=endRowFromSelection;){const{skipRowOnPaste,visualRow}=this.hot.getCellMeta(visualRowForPopulatedData,startColumn);if(visualRowForPopulatedData=visualRow+1,!0===skipRowOnPaste)continue;lastVisualRow=visualRow,visualColumnForPopulatedData=startColumn;const newRow=[],insertedRow=newRows.length%populatedRowsLength;for(;newRow.length<populatedColumnsLength||visualColumnForPopulatedData<=endColumnFromSelection;){const{skipColumnOnPaste,visualCol}=this.hot.getCellMeta(startRow,visualColumnForPopulatedData);if(visualColumnForPopulatedData=visualCol+1,!0===skipColumnOnPaste)continue;lastVisualColumn=visualCol;const insertedColumn=newRow.length%populatedColumnsLength;newRow.push(inputArray[insertedRow][insertedColumn])}newRows.push(newRow)}return copyPaste_classPrivateFieldSet(_preventViewportScrollOnPaste,this,!0),this.hot.populateFromArray(startRow,startColumn,newRows,void 0,void 0,"CopyPaste.paste",this.pasteMode),[startRow,startColumn,lastVisualRow,lastVisualColumn]}onCopy(event){var _event$target;const focusedElement=this.hot.getFocusManager().getRefocusElement(),isHotInput=null===(_event$target=event.target)||void 0===_event$target?void 0:_event$target.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!copyPaste_classPrivateFieldGet(_isTriggeredByCopy,this)||this.isEditorOpened()||(0,dom_element.sb)(event.target)&&(isHotInput&&event.target!==focusedElement||!isHotInput&&event.target!==this.hot.rootDocument.body&&!(0,dom_element.yq)(event.target,this.hot.rootElement)))return;event.preventDefault(),this.setCopyableText(),copyPaste_classPrivateFieldSet(_isTriggeredByCopy,this,!1);const data=this.getRangedData(this.copyableRanges),copiedHeadersCount=copyPaste_assertClassBrand(_CopyPaste_brand,this,_countCopiedHeaders).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",data,this.copyableRanges,copiedHeadersCount)){const textPlain=(0,SheetClip.A)(data);if(event&&event.clipboardData){const textHTML=(0,parseTable.ub)(data,this.hot.rootDocument);event.clipboardData.setData("text/plain",textPlain),event.clipboardData.setData("text/html",[META_HEAD,textHTML].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",textPlain);this.hot.runHooks("afterCopy",data,this.copyableRanges,copiedHeadersCount)}copyPaste_classPrivateFieldSet(_copyMode,this,"cells-only")}onCut(event){var _event$target2;const focusedElement=this.hot.getFocusManager().getRefocusElement(),isHotInput=null===(_event$target2=event.target)||void 0===_event$target2?void 0:_event$target2.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!copyPaste_classPrivateFieldGet(_isTriggeredByCut,this)||this.isEditorOpened()||(0,dom_element.sb)(event.target)&&(isHotInput&&event.target!==focusedElement||!isHotInput&&event.target!==this.hot.rootDocument.body&&!(0,dom_element.yq)(event.target,this.hot.rootElement)))return;event.preventDefault(),this.setCopyableText(),copyPaste_classPrivateFieldSet(_isTriggeredByCut,this,!1);const rangedData=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",rangedData,this.copyableRanges)){const textPlain=(0,SheetClip.A)(rangedData);if(event&&event.clipboardData){const textHTML=(0,parseTable.ub)(rangedData,this.hot.rootDocument);event.clipboardData.setData("text/plain",textPlain),event.clipboardData.setData("text/html",[META_HEAD,textHTML].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",textPlain);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",rangedData,this.copyableRanges)}}onPaste(event){var _event$target3;const focusedElement=this.hot.getFocusManager().getRefocusElement(),isHotInput=null===(_event$target3=event.target)||void 0===_event$target3?void 0:_event$target3.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||(0,dom_element.sb)(event.target)&&(isHotInput&&event.target!==focusedElement||!isHotInput&&event.target!==this.hot.rootDocument.body&&!(0,dom_element.yq)(event.target,this.hot.rootElement)))return;let pastedData;if(event.preventDefault(),event&&void 0!==event.clipboardData){const textHTML=(0,string.aj)(event.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(textHTML&&/(<table)|(<TABLE)/g.test(textHTML)){pastedData=(0,parseTable.oh)(textHTML,this.hot.rootDocument).data}else pastedData=event.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(pastedData=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof pastedData&&(pastedData=(0,SheetClip.q)(pastedData)),void 0===pastedData||pastedData&&0===pastedData.length)return;if(!1===this.hot.runHooks("beforePaste",pastedData,this.copyableRanges))return;const[startRow,startColumn,endRow,endColumn]=this.populateValues(pastedData);this.hot.selectCell(startRow,startColumn,Math.min(this.hot.countRows()-1,endRow),Math.min(this.hot.countCols()-1,endColumn)),this.hot.runHooks("afterPaste",pastedData,this.copyableRanges)}destroy(){super.destroy()}}function _ensureClipboardEventsGetTriggered(eventName){if((0,browser.nr)()){const lastSelectedRange=this.hot.getSelectedRangeLast();if(lastSelectedRange){const{row:highlightRow,col:highlightColumn}=lastSelectedRange.highlight,currentlySelectedCell=this.hot.getCell(highlightRow,highlightColumn,!0);currentlySelectedCell&&(0,dom_element.C0)(currentlySelectedCell,(()=>{this.hot.rootDocument.execCommand(eventName)}))}}else this.hot.rootDocument.execCommand(eventName)}function _countCopiedHeaders(ranges){const{rows}=normalizeRanges(ranges);let columnHeadersCount=0;for(let row=0;row<rows.length&&!(rows[row]>=0);row++)columnHeadersCount+=1;return{columnHeadersCount}}function _addContentEditableToHighlightedCell(){if(this.hot.isListening()){const lastSelectedRange=this.hot.getSelectedRangeLast();if(lastSelectedRange){const{row:highlightRow,col:highlightColumn}=lastSelectedRange.highlight,currentlySelectedCell=this.hot.getCell(highlightRow,highlightColumn,!0);currentlySelectedCell&&(0,dom_element.aM)(currentlySelectedCell)}}}function _removeContentEditableFromHighlightedCell(){if(this.hot.isListening()){const lastSelectedRange=this.hot.getSelectedRangeLast();if(lastSelectedRange){const{row:highlightRow,col:highlightColumn}=lastSelectedRange.highlight,currentlySelectedCell=this.hot.getCell(highlightRow,highlightColumn,!0);null!=currentlySelectedCell&&currentlySelectedCell.hasAttribute("contenteditable")&&(0,dom_element.gj)(currentlySelectedCell)}}}function _onAfterContextMenuDefaultOptions(options){options.items.push({name:"---------"},function copyItem(copyPastePlugin){return{key:"copy",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_COPY)},callback(){copyPastePlugin.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const range=this.getSelectedRangeLast();if(!range)return!0;if(range.isSingleHeader())return!0;const selected=this.getSelected();return!selected||selected.length>1},hidden:!1}}(this)),copyPaste_classPrivateFieldGet(_enableCopyColumnHeaders,this)&&options.items.push(function copyWithColumnHeadersItem(copyPastePlugin){return{key:"copy_with_column_headers",name(){const selectedRange=this.getSelectedRangeLast(),nounForm=selectedRange?(0,number.qE)(selectedRange.getWidth()-1,0,1):0;return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,nounForm)},callback(){copyPastePlugin.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const range=this.getSelectedRangeLast();if(!range)return!0;if(range.isSingleHeader())return!0;const selected=this.getSelected();return!selected||selected.length>1},hidden:!1}}(this)),copyPaste_classPrivateFieldGet(_enableCopyColumnGroupHeaders,this)&&options.items.push(function copyWithColumnGroupHeadersItem(copyPastePlugin){return{key:"copy_with_column_group_headers",name(){const selectedRange=this.getSelectedRangeLast(),nounForm=selectedRange?(0,number.qE)(selectedRange.getWidth()-1,0,1):0;return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,nounForm)},callback(){copyPastePlugin.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const range=this.getSelectedRangeLast();if(!range)return!0;if(range.isSingleHeader())return!0;const selected=this.getSelected();return!selected||selected.length>1},hidden:!1}}(this)),copyPaste_classPrivateFieldGet(_enableCopyColumnHeadersOnly,this)&&options.items.push(function copyColumnHeadersOnlyItem(copyPastePlugin){return{key:"copy_column_headers_only",name(){const selectedRange=this.getSelectedRangeLast(),nounForm=selectedRange?(0,number.qE)(selectedRange.getWidth()-1,0,1):0;return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,nounForm)},callback(){copyPastePlugin.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const range=this.getSelectedRangeLast();if(!range)return!0;if(range.isSingleHeader())return!0;const selected=this.getSelected();return!selected||selected.length>1},hidden:!1}}(this)),options.items.push(function cutItem(copyPastePlugin){return{key:"cut",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_CUT)},callback(){copyPastePlugin.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const range=this.getSelectedRangeLast();if(!range)return!0;if(range.isSingleHeader())return!0;const selected=this.getSelected();return!selected||selected.length>1},hidden:!1}}(this))}function _onAfterSelection(fromRow,fromColumn,toRow,toColumn,preventScrolling){copyPaste_classPrivateFieldGet(_preventViewportScrollOnPaste,this)&&(preventScrolling.value=!0),copyPaste_classPrivateFieldSet(_preventViewportScrollOnPaste,this,!1)}function _onAfterSelectionEnd(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _onSafariMouseEnter(){copyPaste_assertClassBrand(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function _onSafariMouseLeave(){copyPaste_assertClassBrand(_CopyPaste_brand,this,_addContentEditableToHighlightedCell).call(this)}function _onSafariAfterSelection(){copyPaste_assertClassBrand(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function createId(row,col){return`border_row${row}col${col}`}function normalizeBorder(border){var _border$start,_border$end;((0,mixed.O9)(border.start)||(0,mixed.O9)(border.left))&&(border.start=null!==(_border$start=border.start)&&void 0!==_border$start?_border$start:border.left);((0,mixed.O9)(border.end)||(0,mixed.O9)(border.right))&&(border.end=null!==(_border$end=border.end)&&void 0!==_border$end?_border$end:border.right);return delete border.left,delete border.right,border}function denormalizeBorder(border){return(0,mixed.O9)(border.start)&&(border.left=border.start),(0,mixed.O9)(border.end)&&(border.right=border.end),border}function createEmptyBorders(row,col){return{id:createId(row,col),border:{width:1,color:"#000",cornerVisible:!1},row,col,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function checkSelectionBorders(hot,direction){let atLeastOneHasBorder=!1;return(0,array.z0)(hot.getSelectedRange(),(range=>{range.forAll(((r,c)=>{if(r<0||c<0)return;const metaBorders=hot.getCellMeta(r,c).borders;if(metaBorders){if(!direction)return atLeastOneHasBorder=!0,!1;if(!(0,object.mQ)(metaBorders[direction],"hide")||!1===metaBorders[direction].hide)return atLeastOneHasBorder=!0,!1}}))})),atLeastOneHasBorder}function markSelected(label){return`<span class="selected">${String.fromCharCode(10003)}</span>${label}`}const physicalToInlinePropNames=new Map([["left","start"],["right","end"]]);function right(customBordersPlugin){const borderDirection=customBordersPlugin.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let label=this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return checkSelectionBorders(this,borderDirection)&&(label=markSelected(label)),label},callback(key,selected){const hasBorder=checkSelectionBorders(this,borderDirection);customBordersPlugin.prepareBorder(selected,borderDirection,hasBorder)}}}function bottom(customBordersPlugin){return{key:"borders:bottom",name(){let label=this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return checkSelectionBorders(this,"bottom")&&(label=markSelected(label)),label},callback(key,selected){const hasBorder=checkSelectionBorders(this,"bottom");customBordersPlugin.prepareBorder(selected,"bottom",hasBorder)}}}function left(customBordersPlugin){const borderDirection=customBordersPlugin.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let label=this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_BORDERS_LEFT);return checkSelectionBorders(this,borderDirection)&&(label=markSelected(label)),label},callback(key,selected){const hasBorder=checkSelectionBorders(this,borderDirection);customBordersPlugin.prepareBorder(selected,borderDirection,hasBorder)}}}function noBorders(customBordersPlugin){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(key,selected){customBordersPlugin.prepareBorder(selected,"noBorders")},disabled(){return!checkSelectionBorders(this)}}}function customBorders_classPrivateMethodInitSpec(e,a){(function customBorders_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function customBorders_defineProperty(e,r,t){return(r=function customBorders_toPropertyKey(t){var i=function customBorders_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function customBorders_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _CustomBorders_brand=new WeakSet;class CustomBorders extends BasePlugin{constructor(){super(...arguments),customBorders_classPrivateMethodInitSpec(this,_CustomBorders_brand),customBorders_defineProperty(this,"savedBorders",[])}static get PLUGIN_KEY(){return"customBorders"}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings().customBorders}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(options=>customBorders_assertClassBrand(_CustomBorders_brand,this,customBorders_onAfterContextMenuDefaultOptions).call(this,options))),this.addHook("init",(()=>customBorders_assertClassBrand(_CustomBorders_brand,this,customBorders_onAfterInit).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(selectionRanges,borderObject){let borderKeys=["top","bottom","start","end"],normBorder=null;borderObject&&(this.checkSettingsCohesion([borderObject]),borderKeys=Object.keys(borderObject),normBorder=normalizeBorder(borderObject));const selectionType=(0,utils.ML)(selectionRanges),selectionSchemaNormalizer=(0,utils._e)(selectionType,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});(0,array.z0)(selectionRanges,(selection=>{selectionSchemaNormalizer(selection).forAll(((row,col)=>{(0,array.z0)(borderKeys,(borderKey=>{this.prepareBorderFromCustomAdded(row,col,normBorder,function toInlinePropName(propName){var _physicalToInlineProp;return null!==(_physicalToInlineProp=physicalToInlinePropNames.get(propName))&&void 0!==_physicalToInlineProp?_physicalToInlineProp:propName}(borderKey))}))}))})),this.hot.view.render()}getBorders(selectionRanges){if(!Array.isArray(selectionRanges))return this.savedBorders;const selectionType=(0,utils.ML)(selectionRanges),selectionSchemaNormalizer=(0,utils._e)(selectionType,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),selectedBorders=[];return(0,array.z0)(selectionRanges,(selection=>{selectionSchemaNormalizer(selection).forAll(((row,col)=>{(0,array.z0)(this.savedBorders,(border=>{border.row===row&&border.col===col&&selectedBorders.push(denormalizeBorder(border))}))}))})),selectedBorders}clearBorders(selectionRanges){selectionRanges?this.setBorders(selectionRanges):((0,array.z0)(this.savedBorders,(border=>{this.clearBordersFromSelectionSettings(border.id),this.clearNullCellRange(),this.hot.removeCellMeta(border.row,border.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(border,place){this.checkSavedBorders(border)||this.savedBorders.push(border);const visualCellRange=this.hot._createCellRange(this.hot._createCellCoords(border.row,border.col));this.checkCustomSelections(border,visualCellRange,place)||this.hot.selection.highlight.addCustomSelection({border,visualCellRange})}prepareBorderFromCustomAdded(row,column,borderDescriptor,place){const nrOfRows=this.hot.countRows(),nrOfColumns=this.hot.countCols();if(row>=nrOfRows||column>=nrOfColumns)return;let border=createEmptyBorders(row,column);borderDescriptor&&(border=function extendDefaultBorder(defaultBorder,customBorder){return(0,object.mQ)(customBorder,"border")&&customBorder.border&&(defaultBorder.border=customBorder.border),(0,object.mQ)(customBorder,"top")&&(0,mixed.O9)(customBorder.top)&&(customBorder.top?((0,object.Gv)(customBorder.top)||(customBorder.top={width:1,color:"#000"}),defaultBorder.top=customBorder.top):(customBorder.top={hide:!0},defaultBorder.top=customBorder.top)),(0,object.mQ)(customBorder,"bottom")&&(0,mixed.O9)(customBorder.bottom)&&(customBorder.bottom?((0,object.Gv)(customBorder.bottom)||(customBorder.bottom={width:1,color:"#000"}),defaultBorder.bottom=customBorder.bottom):(customBorder.bottom={hide:!0},defaultBorder.bottom=customBorder.bottom)),(0,object.mQ)(customBorder,"start")&&(0,mixed.O9)(customBorder.start)&&(customBorder.start?((0,object.Gv)(customBorder.start)||(customBorder.start={width:1,color:"#000"}),defaultBorder.start=customBorder.start):(customBorder.start={hide:!0},defaultBorder.start=customBorder.start)),(0,object.mQ)(customBorder,"end")&&(0,mixed.O9)(customBorder.end)&&(customBorder.end?((0,object.Gv)(customBorder.end)||(customBorder.end={width:1,color:"#000"}),defaultBorder.end=customBorder.end):(customBorder.end={hide:!0},defaultBorder.end=customBorder.end)),defaultBorder}(border,borderDescriptor),(0,array.z0)(this.hot.selection.highlight.customSelections,(customSelection=>{if(border.id===customSelection.settings.id)return Object.assign(customSelection.settings,borderDescriptor),border.id=customSelection.settings.id,border.top=customSelection.settings.top,border.bottom=customSelection.settings.bottom,border.start=customSelection.settings.start,border.end=customSelection.settings.end,!1}))),this.hot.setCellMeta(row,column,"borders",denormalizeBorder(border)),this.insertBorderIntoSettings(border,place)}prepareBorderFromCustomAddedRange(range,customBorder){const lastRowIndex=Math.min(range.to.row,this.hot.countRows()-1),lastColumnIndex=Math.min(range.to.col,this.hot.countCols()-1);(0,number.Ti)(range.from.row,lastRowIndex,(rowIndex=>{(0,number.Ti)(range.from.col,lastColumnIndex,(colIndex=>{const border=createEmptyBorders(rowIndex,colIndex);let add=0;rowIndex===range.from.row&&(0,object.mQ)(customBorder,"top")&&(add+=1,border.top=customBorder.top),rowIndex===range.to.row&&(0,object.mQ)(customBorder,"bottom")&&(add+=1,border.bottom=customBorder.bottom),colIndex===range.from.col&&(0,object.mQ)(customBorder,"start")&&(add+=1,border.start=customBorder.start),colIndex===range.to.col&&(0,object.mQ)(customBorder,"end")&&(add+=1,border.end=customBorder.end),add>0&&(this.hot.setCellMeta(rowIndex,colIndex,"borders",denormalizeBorder(border)),this.insertBorderIntoSettings(border))}))}))}removeAllBorders(row,column){const borderId=createId(row,column);this.spliceBorder(borderId),this.clearBordersFromSelectionSettings(borderId),this.clearNullCellRange(),this.hot.removeCellMeta(row,column,"borders")}setBorder(row,column,place,remove){let bordersMeta=this.hot.getCellMeta(row,column).borders;if(bordersMeta=bordersMeta&&void 0!==bordersMeta.border?normalizeBorder(bordersMeta):createEmptyBorders(row,column),remove){bordersMeta[place]={hide:!0};if(4===this.countHide(bordersMeta))this.removeAllBorders(row,column);else{this.checkCustomSelectionsFromContextMenu(bordersMeta,place,remove)||this.insertBorderIntoSettings(bordersMeta),this.hot.setCellMeta(row,column,"borders",denormalizeBorder(bordersMeta))}}else{bordersMeta[place]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(bordersMeta,place,remove)||this.insertBorderIntoSettings(bordersMeta),this.hot.setCellMeta(row,column,"borders",denormalizeBorder(bordersMeta))}}prepareBorder(selected,place,remove){(0,array.z0)(selected,(_ref=>{let{start,end}=_ref;if(start.row===end.row&&start.col===end.col)"noBorders"===place?this.removeAllBorders(start.row,start.col):this.setBorder(start.row,start.col,place,remove);else switch(place){case"noBorders":(0,number.Ti)(start.col,end.col,(colIndex=>{(0,number.Ti)(start.row,end.row,(rowIndex=>{this.removeAllBorders(rowIndex,colIndex)}))}));break;case"top":(0,number.Ti)(start.col,end.col,(topCol=>{this.setBorder(start.row,topCol,place,remove)}));break;case"bottom":(0,number.Ti)(start.col,end.col,(bottomCol=>{this.setBorder(end.row,bottomCol,place,remove)}));break;case"start":(0,number.Ti)(start.row,end.row,(rowStart=>{this.setBorder(rowStart,start.col,place,remove)}));break;case"end":(0,number.Ti)(start.row,end.row,(rowEnd=>{this.setBorder(rowEnd,end.col,place,remove)}))}}))}createCustomBorders(customBorders){(0,array.z0)(customBorders,(customBorder=>{const normCustomBorder=normalizeBorder(customBorder);customBorder.range?this.prepareBorderFromCustomAddedRange(customBorder.range,normCustomBorder):this.prepareBorderFromCustomAdded(customBorder.row,customBorder.col,normCustomBorder)}))}countHide(border){const{top,bottom,start,end}=border,values=[top,bottom,start,end];return(0,array.mu)(values,((accumulator,value)=>{let result=accumulator;return value&&value.hide&&(result+=1),result}),0)}clearBordersFromSelectionSettings(borderId){const index=(0,array.YD)(this.hot.selection.highlight.customSelections,(customSelection=>customSelection.settings.id)).indexOf(borderId);index>-1&&this.hot.selection.highlight.customSelections[index].clear()}clearNullCellRange(){(0,array.z0)(this.hot.selection.highlight.customSelections,((customSelection,index)=>{if(null===customSelection.cellRange)return this.hot.selection.highlight.customSelections[index].destroy(),this.hot.selection.highlight.customSelections.splice(index,1),!1}))}hideBorders(){(0,array.z0)(this.savedBorders,(border=>{this.clearBordersFromSelectionSettings(border.id),this.clearNullCellRange()}))}spliceBorder(borderId){const index=(0,array.YD)(this.savedBorders,(border=>border.id)).indexOf(borderId);index>-1&&this.savedBorders.splice(index,1)}checkSavedBorders(border){let check=!1;return 4===this.countHide(border)?(this.spliceBorder(border.id),check=!0):(0,array.z0)(this.savedBorders,((savedBorder,index)=>{if(border.id===savedBorder.id)return this.savedBorders[index]=border,check=!0,!1})),check}checkCustomSelectionsFromContextMenu(border,place,remove){let check=!1;return(0,array.z0)(this.hot.selection.highlight.customSelections,(customSelection=>{if(border.id===customSelection.settings.id){const borders=this.hot.view._wt.selectionManager.getBorderInstances(customSelection);return(0,array.z0)(borders,(borderObject=>{borderObject.toggleHiddenClass(place,remove)})),check=!0,!1}})),check}checkCustomSelections(border,cellRange,place){const hideCount=this.countHide(border);let check=!1;return 4===hideCount?(this.removeAllBorders(border.row,border.col),check=!0):(0,array.z0)(this.hot.selection.highlight.customSelections,(customSelection=>{if(border.id===customSelection.settings.id){if(customSelection.visualCellRange=cellRange,customSelection.commit(),place){const borders=this.hot.view._wt.selectionManager.getBorderInstances(customSelection);(0,array.z0)(borders,(borderObject=>{borderObject.changeBorderStyle(place,border)}))}return check=!0,!1}})),check}changeBorderSettings(){const customBorders=this.hot.getSettings().customBorders;if(Array.isArray(customBorders)){const bordersClone=(0,object.Go)(customBorders);this.checkSettingsCohesion(bordersClone),bordersClone.length||(this.savedBorders=bordersClone),this.createCustomBorders(bordersClone)}else void 0!==customBorders&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(customBorders){const hasLeftOrRight=function hasLeftRightTypeOptions(borders){return borders.some((border=>(0,mixed.O9)(border.left)||(0,mixed.O9)(border.right)))}(customBorders),hasStartOrEnd=function hasStartEndTypeOptions(borders){return borders.some((border=>(0,mixed.O9)(border.start)||(0,mixed.O9)(border.end)))}(customBorders);if(hasLeftOrRight&&hasStartOrEnd)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&hasLeftOrRight)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function customBorders_onAfterContextMenuDefaultOptions(defaultOptions){var customBordersPlugin;this.hot.getSettings().customBorders&&defaultOptions.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_BORDERS)},disabled(){const range=this.getSelectedRangeLast();return!range||(!!range.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[(customBordersPlugin=this,{key:"borders:top",name(){let label=this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_BORDERS_TOP);return checkSelectionBorders(this,"top")&&(label=markSelected(label)),label},callback(key,selected){const hasBorder=checkSelectionBorders(this,"top");customBordersPlugin.prepareBorder(selected,"top",hasBorder)}}),right(this),bottom(this),left(this),noBorders(this)]}})}function customBorders_onAfterInit(){this.changeBorderSettings()}function dragToScroll_classPrivateMethodInitSpec(e,a){(function dragToScroll_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function dragToScroll_defineProperty(e,r,t){return(r=function dragToScroll_toPropertyKey(t){var i=function dragToScroll_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function dragToScroll_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _DragToScroll_brand=new WeakSet;class DragToScroll extends BasePlugin{constructor(){super(...arguments),dragToScroll_classPrivateMethodInitSpec(this,_DragToScroll_brand),dragToScroll_defineProperty(this,"boundaries",null),dragToScroll_defineProperty(this,"callback",null),dragToScroll_defineProperty(this,"listening",!1)}static get PLUGIN_KEY(){return"dragToScroll"}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings().dragToScroll}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(event=>dragToScroll_assertClassBrand(_DragToScroll_brand,this,_setupListening).call(this,event))),this.addHook("afterOnCellCornerMouseDown",(event=>dragToScroll_assertClassBrand(_DragToScroll_brand,this,_setupListening).call(this,event))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let boundaries=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=boundaries}setCallback(callback){this.callback=callback}check(x,y){let diffX=0,diffY=0;y<this.boundaries.top?diffY=y-this.boundaries.top:y>this.boundaries.bottom&&(diffY=y-this.boundaries.bottom),x<this.boundaries.left?diffX=x-this.boundaries.left:x>this.boundaries.right&&(diffX=x-this.boundaries.right),this.callback(diffX,diffY)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow}=this.hot;let frame=rootWindow;for(;frame;)this.eventManager.addEventListener(frame.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(frame.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(frame.document,"mousemove",(event=>this.onMouseMove(event))),frame=(0,dom_element.Ly)(frame)}unregisterEvents(){this.eventManager.clear()}onMouseMove(event){this.isListening()&&this.check(event.clientX,event.clientY)}destroy(){super.destroy()}}function _setupListening(event){if((0,dom_event.nO)(event))return;const scrollHandler=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(scrollHandler!==this.hot.rootWindow?scrollHandler.getBoundingClientRect():void 0),this.setCallback(((scrollX,scrollY)=>{var _scrollHandler$scroll,_scrollHandler$scroll2;const horizontalScrollValue=null!==(_scrollHandler$scroll=scrollHandler.scrollLeft)&&void 0!==_scrollHandler$scroll?_scrollHandler$scroll:scrollHandler.scrollX,verticalScrollValue=null!==(_scrollHandler$scroll2=scrollHandler.scrollTop)&&void 0!==_scrollHandler$scroll2?_scrollHandler$scroll2:scrollHandler.scrollY;scrollHandler.scroll(horizontalScrollValue+50*Math.sign(scrollX),verticalScrollValue+20*Math.sign(scrollY))})),this.listen()}function dropdownMenu_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dropdownMenu_defineProperty(e,r,t){return(r=function dropdownMenu_toPropertyKey(t){var i=function dropdownMenu_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function dropdownMenu_classPrivateFieldSet(s,a,r){return s.set(dropdownMenu_assertClassBrand(s,a),r),r}function dropdownMenu_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("afterDropdownMenuDefaultOptions"),hooks.R.getSingleton().register("beforeDropdownMenuShow"),hooks.R.getSingleton().register("afterDropdownMenuShow"),hooks.R.getSingleton().register("afterDropdownMenuHide"),hooks.R.getSingleton().register("afterDropdownMenuExecute");var _isButtonClicked=new WeakMap,_DropdownMenu_brand=new WeakSet;class DropdownMenu extends BasePlugin{static get PLUGIN_KEY(){return"dropdownMenu"}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return["col_left","col_right",KEY,"remove_col",KEY,"clear_column",KEY,"make_read_only",KEY,"alignment"]}constructor(hotInstance){super(hotInstance),function dropdownMenu_classPrivateMethodInitSpec(e,a){dropdownMenu_checkPrivateRedeclaration(e,a),a.add(e)}(this,_DropdownMenu_brand),dropdownMenu_defineProperty(this,"commandExecutor",new CommandExecutor(this.hot)),dropdownMenu_defineProperty(this,"itemsFactory",null),dropdownMenu_defineProperty(this,"menu",null),function dropdownMenu_classPrivateFieldInitSpec(e,t,a){dropdownMenu_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_isButtonClicked,!1),this.hot.addHook("afterGetColHeader",((col,TH)=>dropdownMenu_assertClassBrand(_DropdownMenu_brand,this,dropdownMenu_onAfterGetColHeader).call(this,col,TH)))}isEnabled(){return this.hot.getSettings().dropdownMenu}enablePlugin(){var _this=this;if(this.enabled)return;this.itemsFactory=new ItemsFactory(this.hot,DropdownMenu.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return dropdownMenu_assertClassBrand(_DropdownMenu_brand,_this,dropdownMenu_onBeforeOnCellMouseDown).call(_this,...args)})),this.addHook("beforeViewportScrollHorizontally",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return dropdownMenu_assertClassBrand(_DropdownMenu_brand,_this,_onBeforeViewportScrollHorizontally).call(_this,...args)}));const settings=this.hot.getSettings().dropdownMenu,predefinedItems={items:this.itemsFactory.getItems(settings)};this.registerEvents(),"function"==typeof settings.callback&&this.commandExecutor.setCommonCallback(settings.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",predefinedItems),this.itemsFactory.setPredefinedItems(predefinedItems.items);const menuItems=this.itemsFactory.getItems(settings);this.menu&&this.menu.destroy(),this.menu=new Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:settings.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",menuItems),this.menu.setMenuItems(menuItems),this.menu.addLocalHook("beforeOpen",(()=>dropdownMenu_assertClassBrand(_DropdownMenu_brand,this,dropdownMenu_onMenuBeforeOpen).call(this))),this.menu.addLocalHook("afterOpen",(()=>dropdownMenu_assertClassBrand(_DropdownMenu_brand,this,dropdownMenu_onMenuAfterOpen).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(subMenuInstance=>dropdownMenu_assertClassBrand(_DropdownMenu_brand,this,_onSubMenuAfterOpen).call(this,subMenuInstance))),this.menu.addLocalHook("afterClose",(()=>dropdownMenu_assertClassBrand(_DropdownMenu_brand,this,dropdownMenu_onMenuAfterClose).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var _len3=arguments.length,params=new Array(_len3),_key3=0;_key3<_len3;_key3++)params[_key3]=arguments[_key3];return _this.executeCommand.call(_this,...params)})),(0,array.z0)(menuItems,(command=>this.commandExecutor.registerCommand(command.key,command)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const callback=()=>{const{highlight}=this.hot.getSelectedRangeLast();if((highlight.isHeader()&&-1===highlight.row||highlight.isCell())&&highlight.col>=0){this.hot.selectColumns(highlight.col,highlight.col,-1);const{from}=this.hot.getSelectedRangeLast(),offset=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),target=this.hot.getCell(-1,from.col,!0).querySelector(".changeType"),rect=target.getBoundingClientRect();this.open({left:rect.left+offset.left,top:rect.top+target.offsetHeight+offset.top},{left:rect.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback,runOnlyIf:()=>{var _this$hot$getSelected;const highlight=null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.highlight;return highlight&&this.hot.selection.isCellVisible(highlight)&&highlight.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:"dropdownMenu"},{keys:[["Shift","Alt","ArrowDown"]],callback,runOnlyIf:()=>{var _this$hot$getSelected2;const highlight=null===(_this$hot$getSelected2=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected2?void 0:_this$hot$getSelected2.highlight;return highlight&&this.hot.selection.isCellVisible(highlight)&&highlight.isCell()&&!this.menu.isOpened()},group:"dropdownMenu"}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("dropdownMenu")}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(event=>dropdownMenu_assertClassBrand(_DropdownMenu_brand,this,_onTableClick).call(this,event)))}open(position){var _this$menu;let offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(_this$menu=this.menu)&&void 0!==_this$menu&&_this$menu.isOpened()||(this.menu.open(),(0,object.v4)(offset,((value,key)=>{this.menu.setOffset(key,value)})),this.menu.setPosition(position))}close(){var _this$menu2;null===(_this$menu2=this.menu)||void 0===_this$menu2||_this$menu2.close()}executeCommand(commandName){for(var _len4=arguments.length,params=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++)params[_key4-1]=arguments[_key4];this.commandExecutor.execute(commandName,...params)}setListening(){let listen=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(listen?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _addCustomShortcuts(menuInstance){menuInstance.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _onTableClick(event){if((0,dom_element.nB)(event.target,"changeType")){const offset=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),rect=event.target.getBoundingClientRect();event.stopPropagation(),dropdownMenu_classPrivateFieldSet(_isButtonClicked,this,!1),this.open({left:rect.left+offset.left,top:rect.top+event.target.offsetHeight+offset.top},{left:rect.width,right:0,above:0,below:3})}}function dropdownMenu_onAfterGetColHeader(col,TH){const headerRow=TH.parentNode;if(!headerRow)return;const headerRowList=headerRow.parentNode.childNodes,level=Array.prototype.indexOf.call(headerRowList,headerRow);if(col<0||level!==headerRowList.length-1)return;const existingButton=TH.querySelector(".changeType");if(this.enabled&&existingButton)return;if(!this.enabled)return void(existingButton&&existingButton.parentNode.removeChild(existingButton));const button=this.hot.rootDocument.createElement("button");button.className="changeType",button.type="button",button.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,dom_element.Bq)(button,[(0,a11y.MG)(),(0,a11y.SM)(" ")]),(0,dom_element.Bq)(TH,[(0,a11y.wP)("menu")])),button.onclick=function(){return!1},TH.firstChild.insertBefore(button,TH.firstChild.firstChild)}function dropdownMenu_onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}function dropdownMenu_onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),dropdownMenu_assertClassBrand(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,this.menu)}function _onSubMenuAfterOpen(subMenuInstance){dropdownMenu_assertClassBrand(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,subMenuInstance)}function dropdownMenu_onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function _onBeforeViewportScrollHorizontally(visualColumn){return function dropdownMenu_classPrivateFieldGet(s,a){return s.get(dropdownMenu_assertClassBrand(s,a))}(_isButtonClicked,this)?null:visualColumn}function dropdownMenu_onBeforeOnCellMouseDown(event){(0,dom_element.nB)(event.target,"changeType")&&dropdownMenu_classPrivateFieldSet(_isButtonClicked,this,!0)}function dataProvider_defineProperty(e,r,t){return(r=function dataProvider_toPropertyKey(t){var i=function dataProvider_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}DropdownMenu.SEPARATOR={name:KEY};const dataProvider=class DataProvider{constructor(hotInstance){dataProvider_defineProperty(this,"hot",void 0),dataProvider_defineProperty(this,"options",{}),this.hot=hotInstance}setOptions(options){this.options=options}getData(){const{startRow,startCol,endRow,endCol}=this._getDataRange(),options=this.options,data=[];return(0,number.Ti)(startRow,endRow,(rowIndex=>{const row=[];!options.exportHiddenRows&&this._isHiddenRow(rowIndex)||((0,number.Ti)(startCol,endCol,(colIndex=>{!options.exportHiddenColumns&&this._isHiddenColumn(colIndex)||row.push(this.hot.getDataAtCell(rowIndex,colIndex))})),data.push(row))})),data}getRowHeaders(){const headers=[];if(this.options.rowHeaders){const{startRow,endRow}=this._getDataRange(),rowHeaders=this.hot.getRowHeader();(0,number.Ti)(startRow,endRow,(row=>{!this.options.exportHiddenRows&&this._isHiddenRow(row)||headers.push(rowHeaders[row])}))}return headers}getColumnHeaders(){const headers=[];if(this.options.columnHeaders){const{startCol,endCol}=this._getDataRange(),colHeaders=this.hot.getColHeader();(0,number.Ti)(startCol,endCol,(column=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(column)||headers.push(colHeaders[column])}))}return headers}_getDataRange(){const cols=this.hot.countCols()-1,rows=this.hot.countRows()-1;let[startRow=0,startCol=0,endRow=rows,endCol=cols]=this.options.range;return startRow=Math.max(startRow,0),startCol=Math.max(startCol,0),endRow=Math.min(endRow,rows),endCol=Math.min(endCol,cols),{startRow,startCol,endRow,endCol}}_isHiddenRow(row){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(row))}_isHiddenColumn(column){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(column))}};function _base_defineProperty(e,r,t){return(r=function _base_toPropertyKey(t){var i=function _base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class BaseType{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(dataProvider,options){_base_defineProperty(this,"dataProvider",void 0),_base_defineProperty(this,"options",void 0),this.dataProvider=dataProvider,this.options=this._mergeOptions(options),this.dataProvider.setOptions(this.options)}_mergeOptions(options){let _options=(0,object.o8)(this.constructor.DEFAULT_OPTIONS);const date=new Date;return _options=(0,object.X$)((0,object.o8)(BaseType.DEFAULT_OPTIONS),_options),_options=(0,object.X$)(_options,options),_options.filename=(0,string.V2)(_options.filename,{YYYY:date.getFullYear(),MM:`${date.getMonth()+1}`.padStart(2,"0"),DD:`${date.getDate()}`.padStart(2,"0")}),_options}}const _base=BaseType,CHAR_CARRIAGE_RETURN=String.fromCharCode(13),CHAR_DOUBLE_QUOTES=String.fromCharCode(34),CHAR_LINE_FEED=String.fromCharCode(10);const csv=class Csv extends _base{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const options=this.options,data=this.dataProvider.getData();let columnHeaders=this.dataProvider.getColumnHeaders();const hasColumnHeaders=columnHeaders.length>0,rowHeaders=this.dataProvider.getRowHeaders(),hasRowHeaders=rowHeaders.length>0;let result=options.bom?String.fromCharCode(65279):"";return hasColumnHeaders&&(columnHeaders=(0,array.YD)(columnHeaders,(value=>this._escapeCell(value,!0))),hasRowHeaders&&(result+=options.columnDelimiter),result+=columnHeaders.join(options.columnDelimiter),result+=options.rowDelimiter),(0,array.z0)(data,((value,index)=>{index>0&&(result+=options.rowDelimiter),hasRowHeaders&&(result+=this._escapeCell(rowHeaders[index])+options.columnDelimiter),result+=value.map((cellValue=>this._escapeCell(cellValue))).join(options.columnDelimiter)})),result}_escapeCell(value){let force=arguments.length>1&&void 0!==arguments[1]&&arguments[1],escapedValue=(0,mixed.As)(value);return""!==escapedValue&&(force||escapedValue.indexOf(CHAR_CARRIAGE_RETURN)>=0||escapedValue.indexOf(CHAR_DOUBLE_QUOTES)>=0||escapedValue.indexOf(CHAR_LINE_FEED)>=0||escapedValue.indexOf(this.options.columnDelimiter)>=0)&&(escapedValue=escapedValue.replace(new RegExp('"',"g"),'""'),escapedValue=`"${escapedValue}"`),escapedValue}},TYPE_CSV="csv",EXPORT_TYPES={[TYPE_CSV]:csv};class ExportFile extends BasePlugin{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(format){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(format,options).export()}exportAsBlob(format){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(format,options))}downloadFile(format){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument,rootWindow}=this.hot,formatter=this._createTypeFormatter(format,options),blob=this._createBlob(formatter),URL=rootWindow.URL||rootWindow.webkitURL,a=rootDocument.createElement("a"),name=`${formatter.options.filename}.${formatter.options.fileExtension}`;if(void 0!==a.download){const url=URL.createObjectURL(blob);a.style.display="none",a.setAttribute("href",url),a.setAttribute("download",name),rootDocument.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),rootDocument.body.removeChild(a),setTimeout((()=>{URL.revokeObjectURL(url)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(blob,name)}_createTypeFormatter(format){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!EXPORT_TYPES[format])throw new Error(`Export format type "${format}" is not supported.`);return function typeFactory(type,dataProvider,options){return"function"==typeof EXPORT_TYPES[type]?new EXPORT_TYPES[type](dataProvider,options):null}(format,new dataProvider(this.hot),options)}_createBlob(typeFormatter){let formatter=null;return"undefined"!=typeof Blob&&(formatter=new Blob([typeFormatter.export()],{type:`${typeFormatter.options.mimeType};charset=${typeFormatter.options.encoding}`})),formatter}}__webpack_require__("./node_modules/core-js/modules/es.array.unscopables.flat.js");function component_base_defineProperty(e,r,t){return(r=function component_base_toPropertyKey(t){var i=function component_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class BaseComponent{constructor(hotInstance,_ref){let{id,stateless=!0}=_ref;component_base_defineProperty(this,"hot",void 0),component_base_defineProperty(this,"id",void 0),component_base_defineProperty(this,"elements",[]),component_base_defineProperty(this,"hidden",!1),component_base_defineProperty(this,"stateId",""),component_base_defineProperty(this,"state",void 0),this.hot=hotInstance,this.id=id,this.stateId=`Filters.component.${this.id}`,this.state=stateless?null:this.hot.columnIndexMapper.registerMap(this.stateId,new linkedPhysicalIndexToValueMap.z)}getElements(){return this.elements}reset(){(0,array.z0)(this.elements,(ui=>ui.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(physicalColumn){this.state&&this.setState(this.state.getValueAtIndex(physicalColumn))}setState(){throw new Error("The state setting logic is not implemented")}saveState(physicalColumn){this.state&&this.state.setValueAtIndex(physicalColumn,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,array.z0)(this.elements,(ui=>ui.destroy())),this.state=null,this.elements=null,this.hot=null}}(0,object.co)(BaseComponent,localHooks.A);const conditions={};function getCondition(name,args){if(!conditions[name])throw Error(`Filter condition "${name}" does not exist.`);const{condition,descriptor}=conditions[name];let conditionArguments=args;return descriptor.inputValuesDecorator&&(conditionArguments=descriptor.inputValuesDecorator(conditionArguments)),function(dataRow){return condition.apply(dataRow.meta.instance,[].concat([dataRow],[conditionArguments]))}}function getConditionDescriptor(name){if(!conditions[name])throw Error(`Filter condition "${name}" does not exist.`);return conditions[name].descriptor}function registerCondition(name,condition,descriptor){descriptor.key=name,conditions[name]={condition,descriptor}}registerCondition("none",(function condition(){return!0}),{name:i18n_constants.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});registerCondition("empty",(function empty_condition(dataRow){return(0,mixed.Im)(dataRow.value)}),{name:i18n_constants.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});registerCondition("not_empty",(function notEmpty_condition(dataRow,inputValues){return!getCondition("empty",inputValues)(dataRow)}),{name:i18n_constants.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});registerCondition("eq",(function equal_condition(dataRow,_ref){let[value]=_ref;return(0,mixed.As)(dataRow.value).toLocaleLowerCase(dataRow.meta.locale)===(0,mixed.As)(value)}),{name:i18n_constants.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});registerCondition("neq",(function notEqual_condition(dataRow,inputValues){return!getCondition("eq",inputValues)(dataRow)}),{name:i18n_constants.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});registerCondition("gt",(function greaterThan_condition(dataRow,_ref){let[value]=_ref,conditionValue=value;return"numeric"===dataRow.meta.type&&(conditionValue=parseFloat(conditionValue,10)),dataRow.value>conditionValue}),{name:i18n_constants.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});registerCondition("gte",(function greaterThanOrEqual_condition(dataRow,_ref){let[value]=_ref,conditionValue=value;return"numeric"===dataRow.meta.type&&(conditionValue=parseFloat(conditionValue,10)),dataRow.value>=conditionValue}),{name:i18n_constants.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});registerCondition("lt",(function lessThan_condition(dataRow,_ref){let[value]=_ref,conditionValue=value;return"numeric"===dataRow.meta.type&&(conditionValue=parseFloat(conditionValue,10)),dataRow.value<conditionValue}),{name:i18n_constants.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});registerCondition("lte",(function lessThanOrEqual_condition(dataRow,_ref){let[value]=_ref,conditionValue=value;return"numeric"===dataRow.meta.type&&(conditionValue=parseFloat(conditionValue,10)),dataRow.value<=conditionValue}),{name:i18n_constants.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});registerCondition("date_after",(function after_condition(dataRow,_ref){let[value]=_ref;const date=moment_default()(dataRow.value,dataRow.meta.dateFormat),inputDate=moment_default()(value,dataRow.meta.dateFormat);return!(!date.isValid()||!inputDate.isValid())&&date.diff(inputDate)>=0}),{name:i18n_constants.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});registerCondition("date_before",(function before_condition(dataRow,_ref){let[value]=_ref;const date=moment_default()(dataRow.value,dataRow.meta.dateFormat),inputDate=moment_default()(value,dataRow.meta.dateFormat);return!(!date.isValid()||!inputDate.isValid())&&date.diff(inputDate)<=0}),{name:i18n_constants.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});registerCondition("between",(function between_condition(dataRow,_ref){let[from,to]=_ref,fromValue=from,toValue=to;if("numeric"===dataRow.meta.type){const _from=parseFloat(fromValue,10),_to=parseFloat(toValue,10);fromValue=Math.min(_from,_to),toValue=Math.max(_from,_to)}else if("date"===dataRow.meta.type){const dateBefore=getCondition("date_before",[toValue]),dateAfter=getCondition("date_after",[fromValue]);return dateBefore(dataRow)&&dateAfter(dataRow)}return dataRow.value>=fromValue&&dataRow.value<=toValue}),{name:i18n_constants.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});registerCondition("not_between",(function notBetween_condition(dataRow,inputValues){return!getCondition("between",inputValues)(dataRow)}),{name:i18n_constants.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});registerCondition("begins_with",(function beginsWith_condition(dataRow,_ref){let[value]=_ref;return(0,mixed.As)(dataRow.value).toLocaleLowerCase(dataRow.meta.locale).startsWith((0,mixed.As)(value))}),{name:i18n_constants.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});registerCondition("ends_with",(function endsWith_condition(dataRow,_ref){let[value]=_ref;return(0,mixed.As)(dataRow.value).toLocaleLowerCase(dataRow.meta.locale).endsWith((0,mixed.As)(value))}),{name:i18n_constants.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});registerCondition("contains",(function contains_condition(dataRow,_ref){let[value]=_ref;return(0,mixed.As)(dataRow.value).toLocaleLowerCase(dataRow.meta.locale).indexOf((0,mixed.As)(value))>=0}),{name:i18n_constants.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});registerCondition("not_contains",(function notContains_condition(dataRow,inputValues){return!getCondition("contains",inputValues)(dataRow)}),{name:i18n_constants.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});registerCondition("date_tomorrow",(function tomorrow_condition(dataRow){const date=moment_default()(dataRow.value,dataRow.meta.dateFormat);return!!date.isValid()&&date.isSame(moment_default()().subtract(-1,"days").startOf("day"),"d")}),{name:i18n_constants.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});registerCondition("date_today",(function today_condition(dataRow){const date=moment_default()(dataRow.value,dataRow.meta.dateFormat);return!!date.isValid()&&date.isSame(moment_default()().startOf("day"),"d")}),{name:i18n_constants.FILTERS_CONDITIONS_TODAY,inputsCount:0});registerCondition("date_yesterday",(function yesterday_condition(dataRow){const date=moment_default()(dataRow.value,dataRow.meta.dateFormat);return!!date.isValid()&&date.isSame(moment_default()().subtract(1,"days").startOf("day"),"d")}),{name:i18n_constants.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});const TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES={[TYPE_NUMERIC]:["none",KEY,"empty","not_empty",KEY,"eq","neq",KEY,"gt","gte","lt","lte","between","not_between"],[TYPE_TEXT]:["none",KEY,"empty","not_empty",KEY,"eq","neq",KEY,"begins_with","ends_with",KEY,"contains","not_contains"],[TYPE_DATE]:["none",KEY,"empty","not_empty",KEY,"eq","neq",KEY,"date_before","date_after","between",KEY,"date_tomorrow","date_today","date_yesterday"]};function ui_base_defineProperty(e,r,t){return(r=function ui_base_toPropertyKey(t){var i=function ui_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"];class BaseUI{static get DEFAULTS(){return(0,object.o8)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(hotInstance,options){ui_base_defineProperty(this,"hot",void 0),ui_base_defineProperty(this,"eventManager",new handsontable_eventManager.A(this)),ui_base_defineProperty(this,"options",void 0),ui_base_defineProperty(this,"_element",void 0),ui_base_defineProperty(this,"buildState",void 0),this.hot=hotInstance,this.options=(0,object.X$)(BaseUI.DEFAULTS,options),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(value){this.options.value=value,this.update()}getValue(){return this.options.value}get element(){return"building"===this.buildState?this._element:"built"===this.buildState?(this.update(),this._element):(this.buildState="building",this.build(),this.buildState="built",this._element)}isBuilt(){return"built"===this.buildState}translateIfPossible(value){return"string"==typeof value&&value.startsWith(i18n_constants.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(value):value}build(){const registerEvent=(element,eventName)=>{this.eventManager.addEventListener(element,eventName,(event=>this.runLocalHooks(eventName,event,this)))};if(this.buildState||(this.buildState="building"),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,dom_element.iQ)(this._element,this.options.className),this.options.children.length)(0,array.z0)(this.options.children,(element=>this._element.appendChild(element.element)));else if(this.options.wrapIt){const element=this.hot.rootDocument.createElement(this.options.tagName);element.setAttribute("data-hot-input",!0),(0,object.v4)(this.options,((value,key)=>{void 0!==element[key]&&"className"!==key&&"tagName"!==key&&"children"!==key&&(element[key]=this.translateIfPossible(value))})),this._element.appendChild(element),(0,array.z0)(EVENTS_TO_REGISTER,(eventName=>registerEvent(element,eventName)))}else(0,array.z0)(EVENTS_TO_REGISTER,(eventName=>registerEvent(this._element,eventName)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function input_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function input_classPrivateFieldGet(s,a){return s.get(input_assertClassBrand(s,a))}function input_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(0,object.co)(BaseUI,localHooks.A);var _input=new WeakMap,_InputUI_brand=new WeakSet;class InputUI extends BaseUI{static get DEFAULTS(){return(0,object.o8)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(hotInstance,options){super(hotInstance,(0,object.X$)(InputUI.DEFAULTS,options)),function input_classPrivateMethodInitSpec(e,a){input_checkPrivateRedeclaration(e,a),a.add(e)}(this,_InputUI_brand),function input_classPrivateFieldInitSpec(e,t,a){input_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_input,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(event=>input_assertClassBrand(_InputUI_brand,this,_onKeyup).call(this,event)))}build(){super.build();const icon=this.hot.rootDocument.createElement("div");!function input_classPrivateFieldSet(s,a,r){return s.set(input_assertClassBrand(s,a),r),r}(_input,this,this._element.firstChild),(0,dom_element.iQ)(this._element,"htUIInput"),(0,dom_element.iQ)(icon,"htUIInputIcon"),this._element.appendChild(icon),this.update()}update(){this.isBuilt()&&(input_classPrivateFieldGet(_input,this).type=this.options.type,input_classPrivateFieldGet(_input,this).placeholder=this.translateIfPossible(this.options.placeholder),input_classPrivateFieldGet(_input,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&input_classPrivateFieldGet(_input,this).focus()}}function _onKeyup(event){this.options.value=event.target.value}function select_classPrivateFieldInitSpec(e,t,a){select_checkPrivateRedeclaration(e,t),t.set(e,a)}function select_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function select_classPrivateFieldSet(s,a,r){return s.set(select_assertClassBrand(s,a),r),r}function select_classPrivateFieldGet(s,a){return s.get(select_assertClassBrand(s,a))}function select_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _menu=new WeakMap,_items=new WeakMap,_caption=new WeakMap,_captionElement=new WeakMap,_dropdown=new WeakMap,_SelectUI_brand=new WeakSet;class SelectUI extends BaseUI{static get DEFAULTS(){return(0,object.o8)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(hotInstance,options){super(hotInstance,(0,object.X$)(SelectUI.DEFAULTS,options)),function select_classPrivateMethodInitSpec(e,a){select_checkPrivateRedeclaration(e,a),a.add(e)}(this,_SelectUI_brand),select_classPrivateFieldInitSpec(this,_menu,null),select_classPrivateFieldInitSpec(this,_items,[]),select_classPrivateFieldInitSpec(this,_caption,void 0),select_classPrivateFieldInitSpec(this,_captionElement,void 0),select_classPrivateFieldInitSpec(this,_dropdown,void 0),this.registerHooks()}getMenu(){return select_classPrivateFieldGet(_menu,this)}registerHooks(){this.addLocalHook("click",(()=>select_assertClassBrand(_SelectUI_brand,this,_onClick).call(this)))}setItems(items){select_classPrivateFieldSet(_items,this,this.translateNames(items)),select_classPrivateFieldGet(_menu,this)&&select_classPrivateFieldGet(_menu,this).setMenuItems(select_classPrivateFieldGet(_items,this))}translateNames(items){return(0,array.z0)(items,(item=>{item.name=this.translateIfPossible(item.name)})),items}build(){super.build(),select_classPrivateFieldSet(_menu,this,new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),select_classPrivateFieldGet(_menu,this).setMenuItems(select_classPrivateFieldGet(_items,this));const caption=new BaseUI(this.hot,{className:"htUISelectCaption"}),dropdown=new BaseUI(this.hot,{className:"htUISelectDropdown"});select_classPrivateFieldSet(_caption,this,caption),select_classPrivateFieldSet(_captionElement,this,caption.element),select_classPrivateFieldSet(_dropdown,this,dropdown),this.hot.getSettings().ariaTags&&((0,dom_element.Bq)(dropdown.element,[(0,a11y.MG)()]),(0,dom_element.Bq)(this._element,[(0,a11y.$o)()])),(0,array.z0)([caption,dropdown],(element=>this._element.appendChild(element.element))),select_classPrivateFieldGet(_menu,this).addLocalHook("select",(command=>select_assertClassBrand(_SelectUI_brand,this,_onMenuSelect).call(this,command))),select_classPrivateFieldGet(_menu,this).addLocalHook("afterClose",(()=>select_assertClassBrand(_SelectUI_brand,this,_onMenuClosed).call(this))),this.update()}update(){if(!this.isBuilt())return;let conditionName;conditionName=this.options.value?this.options.value.name:select_classPrivateFieldGet(_menu,this).hot.getTranslatedPhrase(i18n_constants.FILTERS_CONDITIONS_NONE),select_classPrivateFieldGet(_captionElement,this).textContent=conditionName,super.update()}openOptions(){const rect=this.element.getBoundingClientRect();select_classPrivateFieldGet(_menu,this)&&(select_classPrivateFieldGet(_menu,this).open(),select_classPrivateFieldGet(_menu,this).setPosition({left:this.hot.isLtr()?rect.left-5:rect.left-31,top:rect.top-1,width:rect.width,height:rect.height}),select_classPrivateFieldGet(_menu,this).getNavigator().toFirstItem(),select_classPrivateFieldGet(_menu,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:event=>{this.closeOptions(),this.runLocalHooks("tabKeydown",event)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){select_classPrivateFieldGet(_menu,this)&&select_classPrivateFieldGet(_menu,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){select_classPrivateFieldGet(_menu,this)&&(select_classPrivateFieldGet(_menu,this).destroy(),select_classPrivateFieldSet(_menu,this,null)),select_classPrivateFieldGet(_caption,this)&&select_classPrivateFieldGet(_caption,this).destroy(),select_classPrivateFieldGet(_dropdown,this)&&select_classPrivateFieldGet(_dropdown,this).destroy(),super.destroy()}}function _onMenuSelect(command){command.name!==KEY&&(this.options.value=command,this.update(),this.runLocalHooks("select",this.options.value))}function _onMenuClosed(){this.runLocalHooks("afterClose")}function _onClick(){this.openOptions()}function condition_classPrivateMethodInitSpec(e,a){(function condition_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function condition_defineProperty(e,r,t){return(r=function condition_toPropertyKey(t){var i=function condition_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function condition_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _ConditionComponent_brand=new WeakSet;class ConditionComponent extends BaseComponent{constructor(hotInstance,options){super(hotInstance,{id:options.id,stateless:!1}),condition_classPrivateMethodInitSpec(this,_ConditionComponent_brand),condition_defineProperty(this,"name",""),condition_defineProperty(this,"addSeparator",!1),this.name=options.name,this.addSeparator=options.addSeparator,this.elements.push(new SelectUI(this.hot,{menuContainer:options.menuContainer})),this.elements.push(new InputUI(this.hot,{placeholder:i18n_constants.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new InputUI(this.hot,{placeholder:i18n_constants.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(command=>condition_assertClassBrand(_ConditionComponent_brand,this,_onConditionSelect).call(this,command))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(event=>this.runLocalHooks("selectTabKeydown",event))),(0,array.z0)(this.getInputElements(),(input=>{input.addLocalHook("keydown",(event=>condition_assertClassBrand(_ConditionComponent_brand,this,_onInputKeyDown).call(this,event)))}))}setState(value){if(this.reset(),!value)return;const copyOfCommand=(0,object.o8)(value.command);copyOfCommand.name.startsWith(i18n_constants.FILTERS_CONDITIONS_NAMESPACE)&&(copyOfCommand.name=this.hot.getTranslatedPhrase(copyOfCommand.name)),this.getSelectElement().setValue(copyOfCommand),(0,array.z0)(value.args,((arg,index)=>{if(index>copyOfCommand.inputsCount-1)return!1;const element=this.getInputElement(index);element.setValue(arg),element[copyOfCommand.inputsCount>index?"show":"hide"](),index||this.hot._registerTimeout((()=>element.focus()),10)}))}getState(){const command=this.getSelectElement().getValue()||getConditionDescriptor("none"),args=[];return(0,array.z0)(this.getInputElements(),((element,index)=>{command.inputsCount>index&&args.push(element.getValue())})),{command,args}}updateState(condition,column){const command=getConditionDescriptor(condition?condition.name:"none");this.state.setValueAtIndex(column,{command,args:condition?condition.args:[]}),condition||(0,array.z0)(this.getInputElements(),(element=>element.setValue(null)))}getSelectElement(){return this.elements.filter((element=>element instanceof SelectUI))[0]}getInputElement(){let index=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[index]}getInputElements(){return this.elements.filter((element=>element instanceof InputUI))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(hot,wrapper,row,col,prop,value)=>{(0,dom_element.iQ)(wrapper.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,dom_element.iQ)(wrapper.parentNode,"border");const label=this.hot.rootDocument.createElement("div");return(0,dom_element.iQ)(label,"htFiltersMenuLabel"),label.textContent=value,wrapper.appendChild(label),wrapper.parentElement.hasAttribute("ghost-table")||(0,array.z0)(this.elements,(ui=>wrapper.appendChild(ui.element))),wrapper}}}reset(){const selectedColumn=this.hot.getPlugin("filters").getSelectedColumn();let items=[getConditionDescriptor("none")];if(null!==selectedColumn){const{visualIndex}=selectedColumn;items=function getOptionsList(type){const items=[];let typeName=type;return TYPES[typeName]||(typeName="text"),(0,array.z0)(TYPES[typeName],(typeValue=>{let option;option=typeValue===KEY?{name:KEY}:(0,object.o8)(getConditionDescriptor(typeValue)),items.push(option)})),items}(this.hot.getDataType(0,visualIndex,this.hot.countRows(),visualIndex))}(0,array.z0)(this.getInputElements(),(element=>element.hide())),this.getSelectElement().setItems(items),super.reset(),this.getSelectElement().setValue(items[0])}}function _onConditionSelect(command){(0,array.z0)(this.getInputElements(),((element,index)=>{element[command.inputsCount>index?"show":"hide"](),0===index&&this.hot._registerTimeout((()=>element.focus()),10)})),this.runLocalHooks("change",command)}function _onInputKeyDown(event){(0,unicode.m0)(event.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,dom_event.CA)(event))}const operations={};function registerOperation(id,name,func){operations[id]={name,func}}registerOperation("conjunction",i18n_constants.FILTERS_LABELS_CONJUNCTION,(function operationResult(conditions,value){return conditions.every((condition=>condition.func(value)))}));registerOperation("disjunction",i18n_constants.FILTERS_LABELS_DISJUNCTION,(function disjunction_operationResult(conditions,value){return conditions.some((condition=>condition.func(value)))}));function radioInput_classPrivateFieldInitSpec(e,t,a){(function radioInput_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function radioInput_classPrivateFieldGet(s,a){return s.get(radioInput_assertClassBrand(s,a))}function radioInput_classPrivateFieldSet(s,a,r){return s.set(radioInput_assertClassBrand(s,a),r),r}function radioInput_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}registerOperation("disjunctionWithExtraCondition",i18n_constants.FILTERS_LABELS_DISJUNCTION,(function disjunctionWithExtraCondition_operationResult(conditions,value){if(conditions.length<3)throw Error("Operation doesn't work on less then three conditions.");return conditions.slice(0,conditions.length-1).some((condition=>condition.func(value)))&&conditions[conditions.length-1].func(value)}));var radioInput_input=new WeakMap,_label=new WeakMap;class RadioInputUI extends BaseUI{static get DEFAULTS(){return(0,object.o8)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(hotInstance,options){super(hotInstance,(0,object.X$)(RadioInputUI.DEFAULTS,options)),radioInput_classPrivateFieldInitSpec(this,radioInput_input,void 0),radioInput_classPrivateFieldInitSpec(this,_label,void 0)}build(){super.build();const label=this.hot.rootDocument.createElement("label");label.textContent=this.translateIfPossible(this.options.label.textContent),label.htmlFor=this.translateIfPossible(this.options.label.htmlFor),radioInput_classPrivateFieldSet(_label,this,label),radioInput_classPrivateFieldSet(radioInput_input,this,this._element.firstChild),radioInput_classPrivateFieldGet(radioInput_input,this).checked=this.options.checked,this._element.appendChild(label),this.update()}update(){this.isBuilt()&&(radioInput_classPrivateFieldGet(_label,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&radioInput_classPrivateFieldGet(radioInput_input,this).checked}setChecked(){let value=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(radioInput_classPrivateFieldGet(radioInput_input,this).checked=value)}focus(){this.isBuilt()&&radioInput_classPrivateFieldGet(radioInput_input,this).focus()}}function operators_classPrivateMethodInitSpec(e,a){(function operators_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function operators_defineProperty(e,r,t){return(r=function operators_toPropertyKey(t){var i=function operators_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var _OperatorsComponent_brand=new WeakSet;class OperatorsComponent extends BaseComponent{constructor(hotInstance,options){super(hotInstance,{id:options.id,stateless:!1}),operators_classPrivateMethodInitSpec(this,_OperatorsComponent_brand),operators_defineProperty(this,"name",""),this.name=options.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(hot,wrapper)=>((0,dom_element.iQ)(wrapper.parentNode,"htFiltersMenuOperators"),(0,array.z0)(this.elements,(ui=>wrapper.appendChild(ui.element))),wrapper)}}buildOperatorsElement(){const operationKeys=["conjunction","disjunction"];(0,array.z0)(operationKeys,(operation=>{const radioInput=new RadioInputUI(this.hot,{name:"operator",label:{htmlFor:operation,textContent:(id=operation,operations[id].name)},value:operation,checked:operation===operationKeys[0],id:operation});var id;radioInput.addLocalHook("change",(event=>function operators_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(_OperatorsComponent_brand,this,_onRadioInputChange).call(this,event))),this.elements.push(radioInput)}))}setChecked(searchedIndex){if(this.elements.length<searchedIndex)throw Error(templateLiteralTag.O`Radio button with index ${searchedIndex} doesn't exist.`);(0,array.z0)(this.elements,((element,index)=>{element.setChecked(index===searchedIndex)}))}getActiveOperationId(){const operationElement=this.elements.find((element=>element instanceof RadioInputUI&&element.isChecked()));return operationElement?operationElement.getValue():"conjunction"}getState(){return this.getActiveOperationId()}setState(value){this.reset(),value&&this.getActiveOperationId()!==value&&(0,array.z0)(this.elements,(element=>{element.setChecked(element.getValue()===value)}))}updateState(){let column=arguments.length>1?arguments[1]:void 0,selectedOperationId=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"conjunction";"disjunctionWithExtraCondition"===selectedOperationId&&(selectedOperationId="disjunction"),this.state.setValueAtIndex(column,selectedOperationId)}reset(){this.setChecked(0)}}function _onRadioInputChange(event){this.setState(event.target.value)}(0,feature.II)();function toVisualValue(value,defaultEmptyValue){let visualValue=value;return""===visualValue&&(visualValue=`(${defaultEmptyValue})`),visualValue}function createArrayAssertion(initialData){const dataset=new Set(initialData);return function(value){return dataset.has(value)}}function toEmptyString(value){return null==value?"":value}function unifyColumnValues(values){return Array.from(new Set(values)).map((value=>toEmptyString(value))).sort(((a,b)=>"number"==typeof a&&"number"==typeof b?a-b:a===b?0:a>b?1:-1))}function intersectValues(base,selected,defaultEmptyValue,callback){const result=[],same=base===selected;let selectedItemsAssertion;return same||(selectedItemsAssertion=createArrayAssertion(selected)),base.forEach((value=>{let checked=!1;(same||selectedItemsAssertion(value))&&(checked=!0);const item={checked,value,visualValue:toVisualValue(value,defaultEmptyValue)};callback&&callback(item),result.push(item)})),result}var helpers_data=__webpack_require__("./node_modules/handsontable/helpers/data.mjs");function link_classPrivateFieldInitSpec(e,t,a){(function link_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function link_classPrivateFieldGet(s,a){return s.get(link_assertClassBrand(s,a))}function link_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _link=new WeakMap;class LinkUI extends BaseUI{static get DEFAULTS(){return(0,object.o8)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(hotInstance,options){super(hotInstance,(0,object.X$)(LinkUI.DEFAULTS,options)),link_classPrivateFieldInitSpec(this,_link,void 0)}build(){super.build(),function link_classPrivateFieldSet(s,a,r){return s.set(link_assertClassBrand(s,a),r),r}(_link,this,this._element.firstChild)}update(){this.isBuilt()&&(link_classPrivateFieldGet(_link,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&link_classPrivateFieldGet(_link,this).focus()}activate(){link_classPrivateFieldGet(_link,this).click()}}function multipleSelect_classPrivateFieldInitSpec(e,t,a){multipleSelect_checkPrivateRedeclaration(e,t),t.set(e,a)}function multipleSelect_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function multipleSelect_classPrivateFieldGet(s,a){return s.get(multipleSelect_assertClassBrand(s,a))}function multipleSelect_classPrivateFieldSet(s,a,r){return s.set(multipleSelect_assertClassBrand(s,a),r),r}function multipleSelect_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var multipleSelect_items=new WeakMap,_itemsBox=new WeakMap,_locale=new WeakMap,_searchInput=new WeakMap,_selectAllUI=new WeakMap,_clearAllUI=new WeakMap,_MultipleSelectUI_brand=new WeakSet;class MultipleSelectUI extends BaseUI{static get DEFAULTS(){return(0,object.o8)({className:"htUIMultipleSelect",value:[]})}constructor(hotInstance,options){super(hotInstance,(0,object.X$)(MultipleSelectUI.DEFAULTS,options)),function multipleSelect_classPrivateMethodInitSpec(e,a){multipleSelect_checkPrivateRedeclaration(e,a),a.add(e)}(this,_MultipleSelectUI_brand),multipleSelect_classPrivateFieldInitSpec(this,multipleSelect_items,[]),multipleSelect_classPrivateFieldInitSpec(this,_itemsBox,void 0),multipleSelect_classPrivateFieldInitSpec(this,_locale,void 0),multipleSelect_classPrivateFieldInitSpec(this,_searchInput,void 0),multipleSelect_classPrivateFieldInitSpec(this,_selectAllUI,void 0),multipleSelect_classPrivateFieldInitSpec(this,_clearAllUI,void 0),multipleSelect_classPrivateFieldSet(_searchInput,this,new InputUI(this.hot,{placeholder:i18n_constants.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),multipleSelect_classPrivateFieldSet(_selectAllUI,this,new LinkUI(this.hot,{textContent:i18n_constants.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),multipleSelect_classPrivateFieldSet(_clearAllUI,this,new LinkUI(this.hot,{textContent:i18n_constants.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return multipleSelect_classPrivateFieldGet(_itemsBox,this)}registerHooks(){multipleSelect_classPrivateFieldGet(_searchInput,this).addLocalHook("keydown",(event=>multipleSelect_assertClassBrand(_MultipleSelectUI_brand,this,multipleSelect_onInputKeyDown).call(this,event))),multipleSelect_classPrivateFieldGet(_searchInput,this).addLocalHook("input",(event=>multipleSelect_assertClassBrand(_MultipleSelectUI_brand,this,_onInput).call(this,event))),multipleSelect_classPrivateFieldGet(_selectAllUI,this).addLocalHook("click",(event=>multipleSelect_assertClassBrand(_MultipleSelectUI_brand,this,_onSelectAllClick).call(this,event))),multipleSelect_classPrivateFieldGet(_clearAllUI,this).addLocalHook("click",(event=>multipleSelect_assertClassBrand(_MultipleSelectUI_brand,this,_onClearAllClick).call(this,event)))}setItems(items){var _classPrivateFieldGet2;multipleSelect_classPrivateFieldSet(multipleSelect_items,this,items),null===(_classPrivateFieldGet2=multipleSelect_classPrivateFieldGet(_itemsBox,this))||void 0===_classPrivateFieldGet2||_classPrivateFieldGet2.loadData(multipleSelect_classPrivateFieldGet(multipleSelect_items,this))}setLocale(locale){multipleSelect_classPrivateFieldSet(_locale,this,locale)}getLocale(){return multipleSelect_classPrivateFieldGet(_locale,this)}getItems(){return[...multipleSelect_classPrivateFieldGet(multipleSelect_items,this)]}getValue(){return function itemsToValue(availableItems){const items=[];return availableItems.forEach((item=>{item.checked&&items.push(item.value)})),items}(multipleSelect_classPrivateFieldGet(multipleSelect_items,this))}getSearchInputElement(){return multipleSelect_classPrivateFieldGet(_searchInput,this)}getSelectAllElement(){return multipleSelect_classPrivateFieldGet(_selectAllUI,this)}getClearAllElement(){return multipleSelect_classPrivateFieldGet(_clearAllUI,this)}isSelectedAllValues(){return multipleSelect_classPrivateFieldGet(multipleSelect_items,this).length===this.getValue().length}build(){super.build();const{rootDocument}=this.hot,itemsBoxWrapper=rootDocument.createElement("div"),selectionControl=new BaseUI(this.hot,{className:"htUISelectionControls",children:[multipleSelect_classPrivateFieldGet(_selectAllUI,this),multipleSelect_classPrivateFieldGet(_clearAllUI,this)]});this._element.appendChild(multipleSelect_classPrivateFieldGet(_searchInput,this).element),this._element.appendChild(selectionControl.element),this._element.appendChild(itemsBoxWrapper);const hotInitializer=wrapper=>{var _classPrivateFieldGet3;if(!this._element)return;null===(_classPrivateFieldGet3=multipleSelect_classPrivateFieldGet(_itemsBox,this))||void 0===_classPrivateFieldGet3||_classPrivateFieldGet3.destroy(),(0,dom_element.iQ)(wrapper,"htUIMultipleSelectHot"),multipleSelect_classPrivateFieldSet(_itemsBox,this,new this.hot.constructor(wrapper,{data:multipleSelect_classPrivateFieldGet(multipleSelect_items,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(TD,row,col,prop,value,cellProperties)=>{TD.title=cellProperties.instance.getDataAtRowProp(row,cellProperties.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{multipleSelect_classPrivateFieldGet(_itemsBox,this).listen()},colWidths:()=>multipleSelect_classPrivateFieldGet(_itemsBox,this).container.scrollWidth-(0,dom_element.XJ)(rootDocument),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),multipleSelect_classPrivateFieldGet(_itemsBox,this).init(),this.hot.addHook("afterSetTheme",((themeName,firstRun)=>{firstRun||multipleSelect_classPrivateFieldGet(_itemsBox,this).useTheme(themeName)}));const gridContext=multipleSelect_classPrivateFieldGet(_itemsBox,this).getShortcutManager().getContext("grid");gridContext.removeShortcutsByKeys(["Tab"]),gridContext.removeShortcutsByKeys(["Shift","Tab"]),gridContext.addShortcut({keys:[["Escape"]],callback:event=>{this.runLocalHooks("keydown",event,this)},group:"multipleSelect.itemBox"}),gridContext.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:event=>{multipleSelect_classPrivateFieldGet(_itemsBox,this).deselectCell(),this.runLocalHooks("keydown",event,this),this.runLocalHooks("listTabKeydown",event,this)},group:"multipleSelect.itemBox"})};hotInitializer(itemsBoxWrapper),this.hot._registerTimeout((()=>hotInitializer(itemsBoxWrapper)),100)}focus(){this.isBuilt()&&multipleSelect_classPrivateFieldGet(_itemsBox,this).listen()}reset(){multipleSelect_classPrivateFieldGet(_searchInput,this).reset(),multipleSelect_classPrivateFieldGet(_selectAllUI,this).reset(),multipleSelect_classPrivateFieldGet(_clearAllUI,this).reset()}update(){this.isBuilt()&&(multipleSelect_classPrivateFieldGet(_itemsBox,this).loadData(function valueToItems(availableItems,selectedValue){const arrayAssertion=createArrayAssertion(selectedValue);return availableItems.map((item=>(item.checked=arrayAssertion(item.value),item)))}(multipleSelect_classPrivateFieldGet(multipleSelect_items,this),this.options.value)),super.update())}destroy(){var _classPrivateFieldGet4;null===(_classPrivateFieldGet4=multipleSelect_classPrivateFieldGet(_itemsBox,this))||void 0===_classPrivateFieldGet4||_classPrivateFieldGet4.destroy(),multipleSelect_classPrivateFieldGet(_searchInput,this).destroy(),multipleSelect_classPrivateFieldGet(_clearAllUI,this).destroy(),multipleSelect_classPrivateFieldGet(_selectAllUI,this).destroy(),multipleSelect_classPrivateFieldSet(_searchInput,this,null),multipleSelect_classPrivateFieldSet(_clearAllUI,this,null),multipleSelect_classPrivateFieldSet(_selectAllUI,this,null),multipleSelect_classPrivateFieldSet(_itemsBox,this,null),multipleSelect_classPrivateFieldSet(multipleSelect_items,this,null),super.destroy()}}function _onInput(event){const value=event.target.value.toLocaleLowerCase(this.getLocale());let filteredItems;filteredItems=""===value?[...multipleSelect_classPrivateFieldGet(multipleSelect_items,this)]:multipleSelect_classPrivateFieldGet(multipleSelect_items,this).filter((item=>`${item.value}`.toLocaleLowerCase(this.getLocale()).indexOf(value)>=0)),multipleSelect_classPrivateFieldGet(_itemsBox,this).loadData(filteredItems)}function multipleSelect_onInputKeyDown(event){this.runLocalHooks("keydown",event,this);(0,helpers_function.OH)(unicode.m0,event.keyCode)("ARROW_DOWN")&&(event.preventDefault(),(0,dom_event.CA)(event),multipleSelect_classPrivateFieldGet(_itemsBox,this).listen(),multipleSelect_classPrivateFieldGet(_itemsBox,this).selectCell(0,0))}function _onSelectAllClick(event){const changes=[];event.preventDefault(),multipleSelect_classPrivateFieldGet(_itemsBox,this).getSourceData().forEach(((row,rowIndex)=>{row.checked=!0,changes.push((0,helpers_data.Wm)(row,rowIndex)[0])})),multipleSelect_classPrivateFieldGet(_itemsBox,this).setSourceDataAtCell(changes)}function _onClearAllClick(event){const changes=[];event.preventDefault(),multipleSelect_classPrivateFieldGet(_itemsBox,this).getSourceData().forEach(((row,rowIndex)=>{row.checked=!1,changes.push((0,helpers_data.Wm)(row,rowIndex)[0])})),multipleSelect_classPrivateFieldGet(_itemsBox,this).setSourceDataAtCell(changes)}function value_classPrivateMethodInitSpec(e,a){(function value_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function value_defineProperty(e,r,t){return(r=function value_toPropertyKey(t){var i=function value_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function value_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}registerCondition("by_value",(function byValue_condition(dataRow,_ref){let[value]=_ref;return value(dataRow.value)}),{name:"By value",inputsCount:0,inputValuesDecorator(_ref2){let[data]=_ref2;return[createArrayAssertion(data)]},showOperators:!1});var _ActionBarComponent,_ValueComponent_brand=new WeakSet;class ValueComponent extends BaseComponent{constructor(hotInstance,options){super(hotInstance,{id:options.id,stateless:!1}),value_classPrivateMethodInitSpec(this,_ValueComponent_brand),value_defineProperty(this,"name",""),this.name=options.name,this.elements.push(new MultipleSelectUI(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(event=>value_assertClassBrand(_ValueComponent_brand,this,value_onInputKeyDown).call(this,event))).addLocalHook("listTabKeydown",(event=>this.runLocalHooks("listTabKeydown",event))),this.hot.addHook("modifyFiltersMultiSelectValue",((value,meta)=>value_assertClassBrand(_ValueComponent_brand,this,_onModifyDisplayedValue).call(this,value,meta)))}getElements(){const selectElement=this.getMultipleSelectElement();return[selectElement.getSearchInputElement(),selectElement.getSelectAllElement(),selectElement.getClearAllElement(),this.getMultipleSelectElement()]}setState(value){if(this.reset(),value&&"by_value"===value.command.key){const select=this.getMultipleSelectElement();select.setItems(value.itemsSnapshot),select.setValue(value.args[0]),select.setLocale(value.locale)}}getState(){const select=this.getMultipleSelectElement(),availableItems=select.getItems();return{command:{key:select.isSelectedAllValues()||!availableItems.length?"none":"by_value"},args:[select.getValue()],itemsSnapshot:availableItems}}updateState(stateInfo){const updateColumnState=(physicalColumn,conditions,conditionArgsChange,filteredRowsFactory,conditionsStack)=>{const[firstByValueCondition]=(0,array.y0)(conditions,(condition=>"by_value"===condition.name)),state={},defaultBlankCellValue=this.hot.getTranslatedPhrase(i18n_constants.FILTERS_VALUES_BLANK_CELLS);if(firstByValueCondition){const filteredRows=filteredRowsFactory(physicalColumn,conditionsStack),rowValues=(0,array.YD)(filteredRows,(row=>row.value)),rowMetaMap=new Map(filteredRows.map((row=>[row.value,this.hot.getCellMeta(row.meta.visualRow,row.meta.visualCol)]))),unifiedRowValues=unifyColumnValues(rowValues);conditionArgsChange&&(firstByValueCondition.args[0]=conditionArgsChange);const selectedValues=[],itemsSnapshot=intersectValues(unifiedRowValues,firstByValueCondition.args[0],defaultBlankCellValue,(item=>{item.checked&&selectedValues.push(item.value),value_assertClassBrand(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,item,rowMetaMap)})),column=stateInfo.editedConditionStack.column;state.locale=this.hot.getCellMeta(0,column).locale,state.args=[selectedValues],state.command=getConditionDescriptor("by_value"),state.itemsSnapshot=itemsSnapshot}else state.args=[],state.command=getConditionDescriptor("none");this.state.setValueAtIndex(physicalColumn,state)};updateColumnState(stateInfo.editedConditionStack.column,stateInfo.editedConditionStack.conditions,stateInfo.conditionArgsChange,stateInfo.filteredRowsFactory),stateInfo.dependentConditionStacks.length&&updateColumnState(stateInfo.dependentConditionStacks[0].column,stateInfo.dependentConditionStacks[0].conditions,stateInfo.conditionArgsChange,stateInfo.filteredRowsFactory,stateInfo.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((element=>element instanceof MultipleSelectUI))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(hot,wrapper,row,col,prop,value)=>{(0,dom_element.iQ)(wrapper.parentNode,"htFiltersMenuValue");const label=this.hot.rootDocument.createElement("div");return(0,dom_element.iQ)(label,"htFiltersMenuLabel"),label.textContent=value,wrapper.appendChild(label),wrapper.parentElement.hasAttribute("ghost-table")||(0,array.z0)(this.elements,(ui=>wrapper.appendChild(ui.element))),wrapper}}}reset(){const defaultBlankCellValue=this.hot.getTranslatedPhrase(i18n_constants.FILTERS_VALUES_BLANK_CELLS),rowEntries=this._getColumnVisibleValues(),rowValues=rowEntries.map((entry=>entry.value)),rowMetaMap=new Map(rowEntries.map((row=>[row.value,row.meta]))),values=unifyColumnValues(rowValues),items=intersectValues(values,values,defaultBlankCellValue,(item=>{value_assertClassBrand(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,item,rowMetaMap)}));this.getMultipleSelectElement().setItems(items),super.reset(),this.getMultipleSelectElement().setValue(values);const selectedColumn=this.hot.getPlugin("filters").getSelectedColumn();null!==selectedColumn&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,selectedColumn.visualIndex).locale)}_getColumnVisibleValues(){const selectedColumn=this.hot.getPlugin("filters").getSelectedColumn();return null===selectedColumn?[]:(0,array.YD)(this.hot.getDataAtCol(selectedColumn.visualIndex),((v,rowIndex)=>({value:toEmptyString(v),meta:this.hot.getCellMeta(rowIndex,selectedColumn.visualIndex)})))}}function value_onInputKeyDown(event){(0,unicode.m0)(event.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,dom_event.CA)(event))}function _triggerModifyMultipleSelectionValueHook(item,metaMap){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(item.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",item.visualValue,metaMap.get(item.value)))}function _onModifyDisplayedValue(value,meta){return"numeric"===meta.type?getRenderedValue(value,meta):value}function actionBar_classPrivateMethodInitSpec(e,a){(function actionBar_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function actionBar_defineProperty(e,r,t){return(r=function actionBar_toPropertyKey(t){var i=function actionBar_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var _ActionBarComponent_brand=new WeakSet;class ActionBarComponent extends BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(hotInstance,options){super(hotInstance,{id:options.id,stateless:!0}),actionBar_classPrivateMethodInitSpec(this,_ActionBarComponent_brand),actionBar_defineProperty(this,"name",""),this.name=options.name,this.elements.push(new InputUI(this.hot,{type:"button",value:i18n_constants.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:ActionBarComponent.BUTTON_OK})),this.elements.push(new InputUI(this.hot,{type:"button",value:i18n_constants.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:ActionBarComponent.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,array.z0)(this.elements,(element=>{element.addLocalHook("click",((event,button)=>function actionBar_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(_ActionBarComponent_brand,this,_onButtonClick).call(this,event,button)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(hot,wrapper)=>((0,dom_element.iQ)(wrapper.parentNode,"htFiltersMenuActionBar"),(0,array.z0)(this.elements,(ui=>wrapper.appendChild(ui.element))),wrapper)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function _onButtonClick(event,button){button.options.identifier===_ActionBarComponent.BUTTON_OK?this.accept():this.cancel()}function conditionCollection_defineProperty(e,r,t){return(r=function conditionCollection_toPropertyKey(t){var i=function conditionCollection_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}_ActionBarComponent=ActionBarComponent;const MAP_NAME="ConditionCollection.filteringStates";class ConditionCollection{constructor(hot){let isMapRegistrable=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];conditionCollection_defineProperty(this,"hot",void 0),conditionCollection_defineProperty(this,"isMapRegistrable",void 0),conditionCollection_defineProperty(this,"filteringStates",new linkedPhysicalIndexToValueMap.z),this.hot=hot,this.isMapRegistrable=isMapRegistrable,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(MAP_NAME,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(value,column){var _stateForColumn$condi;const stateForColumn=this.filteringStates.getValueAtIndex(column),conditions=null!==(_stateForColumn$condi=null==stateForColumn?void 0:stateForColumn.conditions)&&void 0!==_stateForColumn$condi?_stateForColumn$condi:[],operation=null==stateForColumn?void 0:stateForColumn.operation;return this.isMatchInConditions(conditions,value,operation)}isMatchInConditions(conditions,value){let operationType=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"conjunction";return!conditions.length||function getOperationFunc(id){if(!operations[id])throw Error(`Operation with id "${id}" does not exist.`);const func=operations[id].func;return function(conditions,value){return func(conditions,value)}}(operationType)(conditions,value)}addCondition(column,conditionDefinition){let operation=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"conjunction",position=arguments.length>3?arguments[3]:void 0;const localeForColumn=this.hot.getCellMeta(0,column).locale,args=conditionDefinition.args.map((v=>"string"==typeof v?v.toLocaleLowerCase(localeForColumn):v)),name=conditionDefinition.name||conditionDefinition.command.key;this.runLocalHooks("beforeAdd",column);const columnType=this.getOperation(column);if(columnType){if(columnType!==operation)throw Error(templateLiteralTag.O`The column of index ${column} has been already applied with a \`${columnType}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,mixed.b0)(operations[operation]))throw new Error(templateLiteralTag.O`Unexpected operation named \`${operation}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const conditionsForColumn=this.getConditions(column);0===conditionsForColumn.length?this.filteringStates.setValueAtIndex(column,{operation,conditions:[{name,args,func:getCondition(name,args)}]},position):conditionsForColumn.push({name,args,func:getCondition(name,args)}),this.runLocalHooks("afterAdd",column)}getConditions(column){var _this$filteringStates,_this$filteringStates2;return null!==(_this$filteringStates=null===(_this$filteringStates2=this.filteringStates.getValueAtIndex(column))||void 0===_this$filteringStates2?void 0:_this$filteringStates2.conditions)&&void 0!==_this$filteringStates?_this$filteringStates:[]}getOperation(column){var _this$filteringStates3;return null===(_this$filteringStates3=this.filteringStates.getValueAtIndex(column))||void 0===_this$filteringStates3?void 0:_this$filteringStates3.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((_ref=>{let[physicalColumn]=_ref;return physicalColumn}))}getColumnStackPosition(column){return this.getFilteredColumns().indexOf(column)}exportAllConditions(){return this.filteringStates.getEntries().reduce(((allConditions,_ref2)=>{let[column,{operation,conditions}]=_ref2;return allConditions.push({column,operation,conditions:conditions.map((_ref3=>{let{name,args}=_ref3;return{name,args:[...args]}}))}),allConditions}),[])}importAllConditions(conditions){this.clean(),conditions.forEach((stack=>{stack.conditions.forEach((condition=>this.addCondition(stack.column,condition)))}))}removeConditions(column){this.runLocalHooks("beforeRemove",column),this.filteringStates.clearValue(column),this.runLocalHooks("afterRemove",column)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(column,name){const conditions=this.getConditions(column);return name?conditions.some((condition=>condition.name===name)):conditions.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MAP_NAME),this.filteringStates=null,this.clearLocalHooks()}}(0,object.co)(ConditionCollection,localHooks.A);const conditionCollection=ConditionCollection;function dataFilter_defineProperty(e,r,t){return(r=function dataFilter_toPropertyKey(t){var i=function dataFilter_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const dataFilter=class DataFilter{constructor(conditionCollection){let columnDataFactory=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];dataFilter_defineProperty(this,"conditionCollection",void 0),dataFilter_defineProperty(this,"columnDataFactory",void 0),this.conditionCollection=conditionCollection,this.columnDataFactory=columnDataFactory}filter(){let filteredData=[];return(0,array.z0)(this.conditionCollection.getFilteredColumns(),((physicalColumn,index)=>{let columnData=this.columnDataFactory(physicalColumn);index&&(columnData=this._getIntersectData(columnData,filteredData)),filteredData=this.filterByColumn(physicalColumn,columnData)})),filteredData}filterByColumn(column){let dataSource=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const filteredData=[];return(0,array.z0)(dataSource,(dataRow=>{void 0!==dataRow&&this.conditionCollection.isMatch(dataRow,column)&&filteredData.push(dataRow)})),filteredData}_getIntersectData(data,needles){const result=[];return(0,array.z0)(needles,(needleRow=>{const row=needleRow.meta.visualRow;void 0!==data[row]&&(result[row]=data[row])})),result}};function conditionUpdateObserver_classPrivateMethodInitSpec(e,a){(function conditionUpdateObserver_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function conditionUpdateObserver_defineProperty(e,r,t){return(r=function conditionUpdateObserver_toPropertyKey(t){var i=function conditionUpdateObserver_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function conditionUpdateObserver_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _ConditionUpdateObserver_brand=new WeakSet;class ConditionUpdateObserver{constructor(hot,conditionCollection){let columnDataFactory=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];conditionUpdateObserver_classPrivateMethodInitSpec(this,_ConditionUpdateObserver_brand),conditionUpdateObserver_defineProperty(this,"hot",void 0),conditionUpdateObserver_defineProperty(this,"conditionCollection",void 0),conditionUpdateObserver_defineProperty(this,"columnDataFactory",void 0),conditionUpdateObserver_defineProperty(this,"changes",[]),conditionUpdateObserver_defineProperty(this,"grouping",!1),conditionUpdateObserver_defineProperty(this,"latestEditedColumnPosition",-1),conditionUpdateObserver_defineProperty(this,"latestOrderStack",[]),this.hot=hot,this.conditionCollection=conditionCollection,this.columnDataFactory=columnDataFactory,this.conditionCollection.addLocalHook("beforeRemove",(column=>conditionUpdateObserver_assertClassBrand(_ConditionUpdateObserver_brand,this,_onConditionBeforeModify).call(this,column))),this.conditionCollection.addLocalHook("afterRemove",(column=>this.updateStatesAtColumn(column))),this.conditionCollection.addLocalHook("afterAdd",(column=>this.updateStatesAtColumn(column))),this.conditionCollection.addLocalHook("beforeClean",(()=>conditionUpdateObserver_assertClassBrand(_ConditionUpdateObserver_brand,this,_onConditionBeforeClean).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>conditionUpdateObserver_assertClassBrand(_ConditionUpdateObserver_brand,this,_onConditionAfterClean).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,array.z0)(this.changes,(column=>{this.updateStatesAtColumn(column)})),this.changes.length=0}updateStatesAtColumn(column,conditionArgsChange){var _this=this;if(this.grouping)return void(-1===this.changes.indexOf(column)&&this.changes.push(column));const allConditions=this.conditionCollection.exportAllConditions();let editedColumnPosition=this.conditionCollection.getColumnStackPosition(column);-1===editedColumnPosition&&(editedColumnPosition=this.latestEditedColumnPosition);const conditionsBefore=allConditions.slice(0,editedColumnPosition),conditionsAfter=allConditions.slice(editedColumnPosition);conditionsAfter.length&&conditionsAfter[0].column===column&&conditionsAfter.shift();const visibleDataFactory=(0,helpers_function.cF)((function(curriedConditionsBefore,curriedColumn){let conditionsStack=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const splitConditionCollection=new conditionCollection(_this.hot,!1),curriedConditionsBeforeArray=[].concat(curriedConditionsBefore,conditionsStack);splitConditionCollection.importAllConditions(curriedConditionsBeforeArray);const allRows=_this.columnDataFactory(curriedColumn);let visibleRows;visibleRows=splitConditionCollection.isEmpty()?allRows:new dataFilter(splitConditionCollection,(columnData=>_this.columnDataFactory(columnData))).filter(),visibleRows=(0,array.YD)(visibleRows,(rowData=>rowData.meta.visualRow));const visibleRowsAssertion=createArrayAssertion(visibleRows);return splitConditionCollection.destroy(),(0,array.y0)(allRows,(rowData=>visibleRowsAssertion(rowData.meta.visualRow)))}))(conditionsBefore),editedConditions=[].concat(this.conditionCollection.getConditions(column));this.runLocalHooks("update",{editedConditionStack:{column,conditions:editedConditions},dependentConditionStacks:conditionsAfter,filteredRowsFactory:visibleDataFactory,conditionArgsChange})}destroy(){this.clearLocalHooks(),(0,object.v4)(this,((value,property)=>{this[property]=null}))}}function _onConditionBeforeModify(column){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(column)}function _onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function _onConditionAfterClean(){(0,array.z0)(this.latestOrderStack,(column=>{this.updateStatesAtColumn(column)}))}(0,object.co)(ConditionUpdateObserver,localHooks.A);const conditionUpdateObserver=ConditionUpdateObserver;function createMenuFocusController(mainMenu,menuItems){let menuInstance,lastSelectedMenuItem=-1;const focusNavigator=function createFocusNavigator(elements){return createPaginator({initialPage:0,size:()=>elements.length,onItemSelect:(currentIndex,directItemChange)=>{const element=elements[currentIndex];return element instanceof MultipleSelectUI?directItemChange:!(element.element&&!(0,dom_element.zN)(element.element))&&void element.focus()}})}(menuItems),updateNavigatorPosition=element=>()=>{menuInstance.isOpened()&&menuInstance.getKeyboardShortcutsCtrl().listen("filters"),focusNavigator.setCurrentPage(menuItems.indexOf(element))};function addKeyboardShortcuts(menu){const mainMenuShortcutsCtrl=menuInstance.getKeyboardShortcutsCtrl(),currentMenuShortcutsCtrl=menu.getKeyboardShortcutsCtrl();focusNavigator.clear(),currentMenuShortcutsCtrl.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:mainMenuShortcutsCtrl.getContext("filters"),callback:()=>{menu.isSubMenu()&&menu.close(),mainMenuShortcutsCtrl.listen("filters")}}]),menu.isSubMenu()||mainMenuShortcutsCtrl.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:event=>{const menuNavigator=menuInstance.getNavigator();menuNavigator.getCurrentPage()>-1&&(lastSelectedMenuItem=menuNavigator.getCurrentPage()),menuNavigator.clear(),event.shiftKey?focusNavigator.toPreviousItem():focusNavigator.toNextItem()}},{keys:[["Escape"]],callback:()=>{menuInstance.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:event=>{const element=menuItems[focusNavigator.getCurrentPage()];element instanceof SelectUI&&(element.openOptions(),event.preventDefault()),element instanceof LinkUI&&(element.activate(),event.preventDefault()),element instanceof BaseUI||event.preventDefault()}}],"filters")}function setMenu(menu){menu.addLocalHook("afterSelectionChange",(selectedItem=>{selectedItem.key.startsWith("filter_")||focusNavigator.clear()})),menu.addLocalHook("afterSubmenuOpen",addKeyboardShortcuts),menu.addLocalHook("afterOpen",addKeyboardShortcuts),menuInstance=menu}return menuItems.forEach((element=>{element instanceof BaseUI&&(element.addLocalHook("click",updateNavigatorPosition(element)),element.addLocalHook("focus",updateNavigatorPosition(element)),element.addLocalHook("afterClose",updateNavigatorPosition(element)))})),setMenu(mainMenu),{...focusNavigator,listen:function listen(){menuInstance.focus(),menuInstance.getKeyboardShortcutsCtrl().listen("filters")},setMenu,getMenu:function getMenu(){return menuInstance},getLastMenuPage:function getLastMenuPage(){return lastSelectedMenuItem}}}var trimmingMap=__webpack_require__("./node_modules/handsontable/translations/maps/trimmingMap.mjs");function filters_classPrivateFieldInitSpec(e,t,a){filters_checkPrivateRedeclaration(e,t),t.set(e,a)}function filters_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function filters_defineProperty(e,r,t){return(r=function filters_toPropertyKey(t){var i=function filters_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function filters_classPrivateFieldSet(s,a,r){return s.set(filters_assertClassBrand(s,a),r),r}function filters_classPrivateFieldGet(s,a){return s.get(filters_assertClassBrand(s,a))}function filters_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _menuFocusNavigator=new WeakMap,_dropdownMenuTraces=new WeakMap,_previousConditionStack=new WeakMap,_Filters_brand=new WeakSet;class Filters extends BasePlugin{static get PLUGIN_KEY(){return"filters"}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(hotInstance){var _this;super(hotInstance),_this=this,function filters_classPrivateMethodInitSpec(e,a){filters_checkPrivateRedeclaration(e,a),a.add(e)}(this,_Filters_brand),filters_defineProperty(this,"dropdownMenuPlugin",null),filters_defineProperty(this,"conditionCollection",null),filters_defineProperty(this,"conditionUpdateObserver",null),filters_defineProperty(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),filters_defineProperty(this,"filtersRowsMap",null),filters_classPrivateFieldInitSpec(this,_menuFocusNavigator,void 0),filters_classPrivateFieldInitSpec(this,_dropdownMenuTraces,new WeakSet),filters_classPrivateFieldInitSpec(this,_previousConditionStack,[]),this.hot.addHook("afterGetColHeader",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return filters_assertClassBrand(_Filters_brand,_this,filters_onAfterGetColHeader).call(_this,...args)}))}isEnabled(){return!!this.hot.getSettings().filters}enablePlugin(){var _this2=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new trimmingMap.q),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const dropdownSettings=this.hot.getSettings().dropdownMenu,menuContainer=dropdownSettings&&dropdownSettings.uiContainer||this.hot.rootDocument.body,addConfirmationHooks=component=>(component.addLocalHook("accept",(()=>filters_assertClassBrand(_Filters_brand,this,_onActionBarSubmit).call(this,"accept"))),component.addLocalHook("cancel",(()=>filters_assertClassBrand(_Filters_brand,this,_onActionBarSubmit).call(this,"cancel"))),component.addLocalHook("change",(command=>filters_assertClassBrand(_Filters_brand,this,_onComponentChange).call(this,component,command))),component),filterByConditionLabel=()=>`${this.hot.getTranslatedPhrase(i18n_constants.FILTERS_DIVS_FILTER_BY_CONDITION)}:`,filterValueLabel=()=>`${this.hot.getTranslatedPhrase(i18n_constants.FILTERS_DIVS_FILTER_BY_VALUE)}:`;if(!this.components.get("filter_by_condition")){const conditionComponent=new ConditionComponent(this.hot,{id:"filter_by_condition",name:filterByConditionLabel,addSeparator:!1,menuContainer});conditionComponent.addLocalHook("afterClose",(()=>filters_assertClassBrand(_Filters_brand,this,_onSelectUIClosed).call(this))),this.components.set("filter_by_condition",addConfirmationHooks(conditionComponent))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const conditionComponent=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer});conditionComponent.addLocalHook("afterClose",(()=>filters_assertClassBrand(_Filters_brand,this,_onSelectUIClosed).call(this))),this.components.set("filter_by_condition2",addConfirmationHooks(conditionComponent))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",addConfirmationHooks(new ValueComponent(this.hot,{id:"filter_by_value",name:filterValueLabel}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",addConfirmationHooks(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new conditionCollection(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new conditionUpdateObserver(this.hot,this.conditionCollection,(physicalColumn=>this.getDataMapAtColumn(physicalColumn))),this.conditionUpdateObserver.addLocalHook("update",(conditionState=>filters_assertClassBrand(_Filters_brand,this,_updateComponents).call(this,conditionState)))),this.components.forEach((component=>component.show())),this.addHook("afterDropdownMenuDefaultOptions",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return filters_assertClassBrand(_Filters_brand,_this2,_onAfterDropdownMenuDefaultOptions).call(_this2,...args)})),this.addHook("beforeDropdownMenuShow",(()=>filters_assertClassBrand(_Filters_brand,this,_onBeforeDropdownMenuShow).call(this))),this.addHook("afterDropdownMenuShow",(()=>filters_assertClassBrand(_Filters_brand,this,_onAfterDropdownMenuShow).call(this))),this.addHook("afterDropdownMenuHide",(()=>filters_assertClassBrand(_Filters_brand,this,_onAfterDropdownMenuHide).call(this))),this.addHook("afterChange",(changes=>filters_assertClassBrand(_Filters_brand,this,filters_onAfterChange).call(this,changes))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!filters_classPrivateFieldGet(_menuFocusNavigator,this)&&this.dropdownMenuPlugin.enabled){const focusableItems=[{focus:()=>{const menu=filters_classPrivateFieldGet(_menuFocusNavigator,this).getMenu(),menuNavigator=menu.getNavigator(),lastSelectedMenuItem=filters_classPrivateFieldGet(_menuFocusNavigator,this).getLastMenuPage();menu.focus(),lastSelectedMenuItem>0?menuNavigator.setCurrentPage(lastSelectedMenuItem):menuNavigator.toFirstItem()}},...Array.from(this.components).map((_ref=>{let[,component]=_ref;return component.getElements()})).flat()];filters_classPrivateFieldSet(_menuFocusNavigator,this,createMenuFocusController(this.dropdownMenuPlugin.menu,focusableItems));const forwardToFocusNavigation=event=>{filters_classPrivateFieldGet(_menuFocusNavigator,this).listen(),event.preventDefault(),(0,unicode.m0)(event.keyCode,"TAB")&&(event.shiftKey?filters_classPrivateFieldGet(_menuFocusNavigator,this).toPreviousItem():filters_classPrivateFieldGet(_menuFocusNavigator,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",forwardToFocusNavigation),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",forwardToFocusNavigation)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var _this$dropdownMenuPlu;this.enabled&&(null!==(_this$dropdownMenuPlu=this.dropdownMenuPlugin)&&void 0!==_this$dropdownMenuPlu&&_this$dropdownMenuPlu.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((component,key)=>{component.destroy(),this.components.set(key,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const selection=this.hot.getSelected();this.clearConditions(),this.filter(),selection&&this.hot.selectCells(selection)},group:"filters"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("filters")}addCondition(column,name,args){let operationId=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"conjunction";const physicalColumn=this.hot.toPhysicalColumn(column);this.conditionCollection.addCondition(physicalColumn,{command:{key:name},args},operationId)}removeConditions(column){const physicalColumn=this.hot.toPhysicalColumn(column);this.conditionCollection.removeConditions(physicalColumn)}clearConditions(column){if(void 0===column)this.conditionCollection.clean();else{const physicalColumn=this.hot.toPhysicalColumn(column);this.conditionCollection.removeConditions(physicalColumn)}}importConditions(conditions){this.conditionCollection.importAllConditions(conditions)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders}=this.hot.getSettings(),dataFilter=this._createDataFilter(),needToFilter=!this.conditionCollection.isEmpty();let visibleVisualRows=[];const conditions=this.exportConditions();if(!1!==this.hot.runHooks("beforeFilter",conditions,filters_classPrivateFieldGet(_previousConditionStack,this))){if(needToFilter){const trimmedRows=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),visibleVisualRows=(0,array.YD)(dataFilter.filter(),(rowData=>rowData.meta.visualRow));const visibleVisualRowsAssertion=createArrayAssertion(visibleVisualRows);(0,number.Ti)(this.hot.countSourceRows()-1,(row=>{visibleVisualRowsAssertion(row)||trimmedRows.push(row)})),(0,array.z0)(trimmedRows,(physicalRow=>{this.filtersRowsMap.setValueAtIndex(physicalRow,!0)}))}),!0),navigableHeaders||visibleVisualRows.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();filters_classPrivateFieldSet(_previousConditionStack,this,this.exportConditions()),this.hot.runHooks("afterFilter",conditions),this.hot.view.adjustElementsSize(),this.hot.render()}else this.importConditions(filters_classPrivateFieldGet(_previousConditionStack,this));this.hot.selection.isSelected()&&this.hot.selectCell(navigableHeaders?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var _this$hot$getSelected;const highlight=null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.highlight;return highlight?{visualIndex:highlight.col,physicalIndex:this.hot.toPhysicalColumn(highlight.col)}:null}getDataMapAtColumn(column){const visualColumn=this.hot.toVisualColumn(column),data=[];return(0,array.z0)(this.hot.getSourceDataAtCol(visualColumn),((value,rowIndex)=>{var _this$hot$getDataAtCe;const{row,col,visualCol,visualRow,type,instance,dateFormat,locale}=this.hot.getCellMeta(rowIndex,visualColumn),dataValue=null!==(_this$hot$getDataAtCe=this.hot.getDataAtCell(this.hot.toVisualRow(rowIndex),visualColumn))&&void 0!==_this$hot$getDataAtCe?_this$hot$getDataAtCe:value;data.push({meta:{row,col,visualCol,visualRow,type,instance,dateFormat,locale},value:toEmptyString(dataValue)})})),data}updateValueComponentCondition(columnIndex){const selectedValues=unifyColumnValues(this.hot.getDataAtCol(columnIndex));this.conditionUpdateObserver.updateStatesAtColumn(columnIndex,selectedValues)}restoreComponents(components){var _this$getSelectedColu;const physicalIndex=null===(_this$getSelectedColu=this.getSelectedColumn())||void 0===_this$getSelectedColu?void 0:_this$getSelectedColu.physicalIndex;components.forEach((component=>{component.isHidden()||component.restoreState(physicalIndex)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(suggestedOperation,byConditionState1,byConditionState2,byValueState){let operation=suggestedOperation;return"disjunction"===operation&&"none"!==byConditionState1.command.key&&"none"!==byConditionState2.command.key&&"none"!==byValueState.command.key?operation="disjunctionWithExtraCondition":"none"!==byValueState.command.key&&("none"!==byConditionState1.command.key&&"none"!==byConditionState2.command.key||(operation="conjunction")),operation}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const component=this.components.get("filter_by_condition"),{command}=component.getState(),componentsToShow=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];command.showOperators?this.showComponents(...componentsToShow):this.hideComponents(...componentsToShow)}_createDataFilter(){let conditionCollection=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new dataFilter(conditionCollection,(physicalColumn=>this.getDataMapAtColumn(physicalColumn)))}getIndexesOfComponents(){const indexes=[];if(!this.dropdownMenuPlugin)return indexes;const menu=this.dropdownMenuPlugin.menu;for(var _len3=arguments.length,components=new Array(_len3),_key3=0;_key3<_len3;_key3++)components[_key3]=arguments[_key3];return(0,array.z0)(components,(component=>{(0,array.z0)(menu.menuItems,((item,index)=>{item.key===component.getMenuItemDescriptor().key&&indexes.push(index)}))})),indexes}changeComponentsVisibility(){let visible=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const hotMenu=this.dropdownMenuPlugin.menu.hotMenu,hiddenRows=hotMenu.getPlugin("hiddenRows");for(var _len4=arguments.length,components=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++)components[_key4-1]=arguments[_key4];const indexes=this.getIndexesOfComponents(...components);visible?hiddenRows.showRows(indexes):hiddenRows.hideRows(indexes),hotMenu.render()}hideComponents(){for(var _len5=arguments.length,components=new Array(_len5),_key5=0;_key5<_len5;_key5++)components[_key5]=arguments[_key5];this.changeComponentsVisibility(!1,...components)}showComponents(){for(var _len6=arguments.length,components=new Array(_len6),_key6=0;_key6<_len6;_key6++)components[_key6]=arguments[_key6];this.changeComponentsVisibility(!0,...components)}destroy(){this.enabled&&(this.components.forEach(((component,key)=>{null!==component&&(component.destroy(),this.components.set(key,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function filters_onAfterChange(changes){changes&&(0,array.z0)(changes,(change=>{const[,prop]=change,columnIndex=this.hot.propToCol(prop);this.conditionCollection.hasConditions(columnIndex)&&this.updateValueComponentCondition(columnIndex)}))}function _onAfterDropdownMenuShow(){const menu=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),menu.updateMenuDimensions()}function _onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function _onBeforeDropdownMenuShow(){const mainMenu=this.dropdownMenuPlugin.menu;filters_classPrivateFieldGet(_dropdownMenuTraces,this).has(mainMenu)||filters_classPrivateFieldGet(_menuFocusNavigator,this).setMenu(mainMenu),filters_classPrivateFieldGet(_dropdownMenuTraces,this).add(mainMenu)}function _onAfterDropdownMenuDefaultOptions(defaultOptions){defaultOptions.items.push({name:KEY}),this.components.forEach((component=>{defaultOptions.items.push(component.getMenuItemDescriptor())}))}function _onActionBarSubmit(submitType){var _this$dropdownMenuPlu3;if("accept"===submitType){const selectedColumn=this.getSelectedColumn();var _this$dropdownMenuPlu2;if(null===selectedColumn)return void(null===(_this$dropdownMenuPlu2=this.dropdownMenuPlugin)||void 0===_this$dropdownMenuPlu2||_this$dropdownMenuPlu2.close());const{physicalIndex}=selectedColumn,byConditionState1=this.components.get("filter_by_condition").getState(),byConditionState2=this.components.get("filter_by_condition2").getState(),byValueState=this.components.get("filter_by_value").getState(),operation=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),byConditionState1,byConditionState2,byValueState);this.conditionUpdateObserver.groupChanges();let columnStackPosition=this.conditionCollection.getColumnStackPosition(physicalIndex);-1===columnStackPosition&&(columnStackPosition=void 0),this.conditionCollection.removeConditions(physicalIndex),"none"!==byConditionState1.command.key&&(this.conditionCollection.addCondition(physicalIndex,byConditionState1,operation,columnStackPosition),"none"!==byConditionState2.command.key&&this.conditionCollection.addCondition(physicalIndex,byConditionState2,operation,columnStackPosition)),"none"!==byValueState.command.key&&this.conditionCollection.addCondition(physicalIndex,byValueState,operation,columnStackPosition),this.conditionUpdateObserver.flush(),this.components.forEach((component=>component.saveState(physicalIndex))),this.filter()}null===(_this$dropdownMenuPlu3=this.dropdownMenuPlugin)||void 0===_this$dropdownMenuPlu3||_this$dropdownMenuPlu3.close()}function _onComponentChange(component,command){const menu=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),component.constructor!==ConditionComponent||command.inputsCount||this.setListeningDropdownMenu(),menu.updateMenuDimensions()}function _onSelectUIClosed(){this.setListeningDropdownMenu()}function filters_onAfterGetColHeader(col,TH,headerLevel){const physicalColumn=this.hot.toPhysicalColumn(col);this.enabled&&this.conditionCollection.hasConditions(physicalColumn)&&headerLevel===this.hot.view.getColumnHeadersCount()-1?(0,dom_element.iQ)(TH,"htFiltersActive"):(0,dom_element.vy)(TH,"htFiltersActive")}function _updateComponents(conditionsState){var _this$dropdownMenuPlu4;if(null===(_this$dropdownMenuPlu4=this.dropdownMenuPlugin)||void 0===_this$dropdownMenuPlu4||!_this$dropdownMenuPlu4.enabled)return;const{editedConditionStack:{conditions,column},conditionArgsChange}=conditionsState;Array.isArray(conditionArgsChange)&&filters_classPrivateFieldSet(_previousConditionStack,this,filters_classPrivateFieldGet(_previousConditionStack,this).map((stack=>(stack.column===column&&conditions.length>0&&stack.conditions.forEach((condition=>{"by_value"===condition.name&&(condition.args=[[...conditionArgsChange]])})),stack))));const conditionsByValue=conditions.filter((condition=>"by_value"===condition.name)),conditionsWithoutByValue=conditions.filter((condition=>"by_value"!==condition.name));if(conditionsByValue.length>=2||conditionsWithoutByValue.length>=3)(0,helpers_console.R8)(templateLiteralTag.O`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const operationType=this.conditionCollection.getOperation(column);this.components.get("filter_by_condition").updateState(conditionsWithoutByValue[0],column),this.components.get("filter_by_condition2").updateState(conditionsWithoutByValue[1],column),this.components.get("filter_operators").updateState(operationType,column),this.components.get("filter_by_value").updateState(conditionsState)}}__webpack_require__("./node_modules/core-js/modules/es.json.stringify.js");const DEFAULT_SETTINGS={licenseKey:"internal-use-in-handsontable",useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(hotSettings){var _hotSettings$PLUGIN_K;return{maxColumns:hotSettings.maxColumns,maxRows:hotSettings.maxRows,language:null===(_hotSettings$PLUGIN_K=hotSettings[formulas_PLUGIN_KEY])||void 0===_hotSettings$PLUGIN_K||null===(_hotSettings$PLUGIN_K=_hotSettings$PLUGIN_K.language)||void 0===_hotSettings$PLUGIN_K?void 0:_hotSettings$PLUGIN_K.langCode}}function cleanEngineSettings(pluginSettings){return Object.keys(pluginSettings).reduce(((obj,key)=>("hyperformula"!==key&&(obj[key]=pluginSettings[key]),obj)),{})}function getEngineRelationshipRegistry(){const pluginStaticRegistry=(0,staticRegister.A)(formulas_PLUGIN_KEY);return pluginStaticRegistry.hasItem("engine_relationship")||pluginStaticRegistry.register("engine_relationship",new Map),pluginStaticRegistry.getItem("engine_relationship")}function getSharedEngineUsageRegistry(){const pluginStaticRegistry=(0,staticRegister.A)(formulas_PLUGIN_KEY);return pluginStaticRegistry.hasItem("shared_engine_usage")||pluginStaticRegistry.register("shared_engine_usage",new Map),pluginStaticRegistry.getItem("shared_engine_usage")}function setupEngine(hotInstance){const hotSettings=hotInstance.getSettings(),pluginSettings=hotSettings[formulas_PLUGIN_KEY],engineConfigItem=null==pluginSettings?void 0:pluginSettings.engine;if(!0===pluginSettings)return null;if((0,mixed.b0)(engineConfigItem))return null;var _engineConfigItem$hyp;if("function"==typeof engineConfigItem.hyperformula||"function"==typeof engineConfigItem)return function registerEngine(engineClass,hotSettings,hotInstance){const pluginSettings=hotSettings[formulas_PLUGIN_KEY],engineSettings=function getEngineSettingsWithDefaultsAndOverrides(hotSettings){var _pluginSettings$engin;const pluginSettings=hotSettings[formulas_PLUGIN_KEY],userSettings=cleanEngineSettings(null!=pluginSettings&&null!==(_pluginSettings$engin=pluginSettings.engine)&&void 0!==_pluginSettings$engin&&_pluginSettings$engin.hyperformula?pluginSettings.engine:{}),overrides=getEngineSettingsOverrides(hotSettings);return{...DEFAULT_SETTINGS,...userSettings,...overrides}}(hotSettings),engineRegistry=getEngineRelationshipRegistry(),sharedEngineRegistry=getSharedEngineUsageRegistry();(function registerCustomFunctions(engineClass,customFunctions){customFunctions&&customFunctions.forEach((func=>{const{name,plugin,translations}=func;try{engineClass.registerFunction(name,plugin,translations)}catch(e){(0,helpers_console.R8)(e.message)}}))})(engineClass,pluginSettings.functions),function registerLanguage(engineClass,languageSetting){if(languageSetting){const{langCode}=languageSetting;try{engineClass.registerLanguage(langCode,languageSetting)}catch(e){(0,helpers_console.R8)(e.message)}}}(engineClass,pluginSettings.language);const engineInstance=engineClass.buildEmpty(engineSettings);return engineRegistry.set(engineInstance,[hotInstance]),sharedEngineRegistry.set(engineInstance,[hotInstance.guid]),function registerNamedExpressions(engineInstance,namedExpressions){namedExpressions&&(engineInstance.suspendEvaluation(),namedExpressions.forEach((namedExp=>{const{name,expression,scope,options}=namedExp;try{engineInstance.addNamedExpression(name,expression,scope,options)}catch(e){(0,helpers_console.R8)(e.message)}})),engineInstance.resumeEvaluation())}(engineInstance,pluginSettings.namedExpressions),engineInstance.on("sheetAdded",(()=>{engineInstance.rebuildAndRecalculate()})),engineInstance.on("sheetRemoved",(()=>{engineInstance.rebuildAndRecalculate()})),engineInstance}(null!==(_engineConfigItem$hyp=engineConfigItem.hyperformula)&&void 0!==_engineConfigItem$hyp?_engineConfigItem$hyp:engineConfigItem,hotSettings,hotInstance);if("object"==typeof engineConfigItem&&(0,mixed.b0)(engineConfigItem.hyperformula)){const engineRelationship=getEngineRelationshipRegistry(),sharedEngineUsage=getSharedEngineUsageRegistry().get(engineConfigItem);return engineRelationship.has(engineConfigItem)||engineRelationship.set(engineConfigItem,[]),engineRelationship.get(engineConfigItem).push(hotInstance),sharedEngineUsage&&sharedEngineUsage.push(hotInstance.guid),engineConfigItem.getConfig().licenseKey||engineConfigItem.updateConfig({licenseKey:"internal-use-in-handsontable"}),engineConfigItem.getConfig().leapYear1900===DEFAULT_SETTINGS.leapYear1900&&!1!==(0,object.wU)(engineConfigItem.getConfig().nullDate,DEFAULT_SETTINGS.nullDate)||(0,helpers_console.R8)(templateLiteralTag.O`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),engineConfigItem}return null}function getRegisteredHotInstances(engine){var _engineRegistry$get;const engineRegistry=getEngineRelationshipRegistry(),hotInstances=0===engineRegistry.size?[]:Array.from(null!==(_engineRegistry$get=engineRegistry.get(engine))&&void 0!==_engineRegistry$get?_engineRegistry$get:[]);return new Map(hotInstances.map((hot=>[hot.getPlugin("formulas").sheetId,hot])))}function unregisterEngine(engine,hotInstance){if(engine){const engineRegistry=getEngineRelationshipRegistry(),engineHotRelationship=engineRegistry.get(engine),sharedEngineRegistry=getSharedEngineUsageRegistry(),sharedEngineUsage=sharedEngineRegistry.get(engine);engineHotRelationship&&engineHotRelationship.includes(hotInstance)&&(engineHotRelationship.splice(engineHotRelationship.indexOf(hotInstance),1),0===engineHotRelationship.length&&engineRegistry.delete(engine)),sharedEngineUsage&&sharedEngineUsage.includes(hotInstance.guid)&&(sharedEngineUsage.splice(sharedEngineUsage.indexOf(hotInstance.guid),1),0===sharedEngineUsage.length&&(sharedEngineRegistry.delete(engine),engine.destroy()))}}function isEscapedFormulaExpression(expression){return"string"==typeof expression&&"'"===expression.charAt(0)&&"="===expression.charAt(1)}function utils_isDate(value,cellType){return"string"==typeof value&&"date"===cellType}function isDateValid(date,dateFormat){return moment_default()(date,dateFormat,!0).isValid()}function getDateInHfFormat(date,dateFormat){return moment_default()(date,dateFormat,!0).format("DD/MM/YYYY")}function getDateFromExcelDate(numericDate,dateFormat){const dateForFormatting=new Date(Date.UTC(0,0,numericDate+-1));return moment_default()(dateForFormatting).format(dateFormat)}function getMoves(movedIndexes,finalIndex,numberOfIndexes){const moves=function getInitiallyCalculatedMoves(movedIndexes,moveLine){const moves=[];return movedIndexes.forEach((movedIndex=>{const move={from:movedIndex,to:moveLine};moves.forEach((previouslyMovedIndex=>{const isMovingFromEndToStart=previouslyMovedIndex.from>previouslyMovedIndex.to,isMovingElementBefore=previouslyMovedIndex.to<=move.from;previouslyMovedIndex.from>move.from&&isMovingElementBefore&&isMovingFromEndToStart&&(move.from+=1)})),move.from>=moveLine&&(moveLine+=1),moves.push(move)})),moves}(movedIndexes,function getMoveLine(movedIndexes,finalIndex,numberOfIndexes){const notMovedElements=Array.from(Array(numberOfIndexes).keys()).filter((index=>!1===movedIndexes.includes(index)));var _notMovedElements$fin;return 0===finalIndex?null!==(_notMovedElements$fin=notMovedElements[finalIndex])&&void 0!==_notMovedElements$fin?_notMovedElements$fin:0:notMovedElements[finalIndex-1]+1}(movedIndexes,finalIndex,numberOfIndexes));return function adjustedCalculatedMoves(moves){return moves.forEach(((move,index)=>{moves.slice(index+1).forEach((nextMovedIndex=>{const isMovingFromStartToEnd=nextMovedIndex.from<nextMovedIndex.to;nextMovedIndex.from>move.from&&isMovingFromStartToEnd&&(nextMovedIndex.from-=1)}))})),moves}(moves)}function axisSyncer_classPrivateFieldInitSpec(e,t,a){(function axisSyncer_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function axisSyncer_classPrivateFieldGet(s,a){return s.get(axisSyncer_assertClassBrand(s,a))}function axisSyncer_classPrivateFieldSet(s,a,r){return s.set(axisSyncer_assertClassBrand(s,a),r),r}function axisSyncer_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _axis=new WeakMap,_indexMapper=new WeakMap,_indexSyncer=new WeakMap,_indexesSequence=new WeakMap,_movedIndexes=new WeakMap,_finalIndex=new WeakMap,_removedIndexes=new WeakMap;const axisSyncer=class AxisSyncer{constructor(axis,indexMapper,indexSyncer){axisSyncer_classPrivateFieldInitSpec(this,_axis,void 0),axisSyncer_classPrivateFieldInitSpec(this,_indexMapper,void 0),axisSyncer_classPrivateFieldInitSpec(this,_indexSyncer,void 0),axisSyncer_classPrivateFieldInitSpec(this,_indexesSequence,[]),axisSyncer_classPrivateFieldInitSpec(this,_movedIndexes,[]),axisSyncer_classPrivateFieldInitSpec(this,_finalIndex,void 0),axisSyncer_classPrivateFieldInitSpec(this,_removedIndexes,[]),axisSyncer_classPrivateFieldSet(_axis,this,axis),axisSyncer_classPrivateFieldSet(_indexMapper,this,indexMapper),axisSyncer_classPrivateFieldSet(_indexSyncer,this,indexSyncer)}setRemovedHfIndexes(removedIndexes){return axisSyncer_classPrivateFieldSet(_removedIndexes,this,removedIndexes.map((physicalIndex=>{const visualIndex=axisSyncer_classPrivateFieldGet(_indexMapper,this).getVisualFromPhysicalIndex(physicalIndex);return this.getHfIndexFromVisualIndex(visualIndex)}))),axisSyncer_classPrivateFieldGet(_removedIndexes,this)}getRemovedHfIndexes(){return axisSyncer_classPrivateFieldGet(_removedIndexes,this)}getHfIndexFromVisualIndex(visualIndex){const indexesSequence=axisSyncer_classPrivateFieldGet(_indexMapper,this).getIndexesSequence(),notTrimmedIndexes=axisSyncer_classPrivateFieldGet(_indexMapper,this).getNotTrimmedIndexes();return indexesSequence.indexOf(notTrimmedIndexes[visualIndex])}syncMoves(moves){const SYNC_MOVE_METHOD_NAME=`move${(0,string.Ob)(axisSyncer_classPrivateFieldGet(_axis,this))}s`;axisSyncer_classPrivateFieldGet(_indexSyncer,this).getEngine().batch((()=>{moves.forEach((move=>{const moveToTheSamePosition=move.from!==move.to,anotherMoveWithoutEffect=move.from+1!==move.to;moveToTheSamePosition&&anotherMoveWithoutEffect&&axisSyncer_classPrivateFieldGet(_indexSyncer,this).getEngine()[SYNC_MOVE_METHOD_NAME](axisSyncer_classPrivateFieldGet(_indexSyncer,this).getSheetId(),move.from,1,move.to)}))}))}storeMovesInformation(movedVisualIndexes,visualFinalIndex,movePossible){!1!==movePossible&&(axisSyncer_classPrivateFieldSet(_movedIndexes,this,movedVisualIndexes.map((index=>this.getHfIndexFromVisualIndex(index)))),axisSyncer_classPrivateFieldSet(_finalIndex,this,this.getHfIndexFromVisualIndex(visualFinalIndex)))}calculateAndSyncMoves(movePossible,orderChanged){if(axisSyncer_classPrivateFieldGet(_indexSyncer,this).isPerformingUndoRedo())return;if(!1===movePossible||!1===orderChanged)return;const calculatedMoves=getMoves(axisSyncer_classPrivateFieldGet(_movedIndexes,this),axisSyncer_classPrivateFieldGet(_finalIndex,this),axisSyncer_classPrivateFieldGet(_indexMapper,this).getNumberOfIndexes());null===axisSyncer_classPrivateFieldGet(_indexSyncer,this).getSheetId()?axisSyncer_classPrivateFieldGet(_indexSyncer,this).getPostponeAction((()=>this.syncMoves(calculatedMoves))):this.syncMoves(calculatedMoves)}getIndexesChangeSyncMethod(){const SYNC_ORDER_CHANGE_METHOD_NAME=`set${(0,string.Ob)(axisSyncer_classPrivateFieldGet(_axis,this))}Order`;return source=>{if(axisSyncer_classPrivateFieldGet(_indexSyncer,this).isPerformingUndoRedo())return;const newSequence=axisSyncer_classPrivateFieldGet(_indexMapper,this).getIndexesSequence();if("update"===source&&newSequence.length>0){const relativeTransformation=axisSyncer_classPrivateFieldGet(_indexesSequence,this).map((index=>newSequence.indexOf(index))),sheetDimensions=axisSyncer_classPrivateFieldGet(_indexSyncer,this).getEngine().getSheetDimensions(axisSyncer_classPrivateFieldGet(_indexSyncer,this).getSheetId());let sizeForAxis;sizeForAxis="row"===axisSyncer_classPrivateFieldGet(_axis,this)?sheetDimensions.height:sheetDimensions.width;for(let i=relativeTransformation.length;i<sizeForAxis;i+=1)relativeTransformation.push(i);axisSyncer_classPrivateFieldGet(_indexSyncer,this).getEngine()[SYNC_ORDER_CHANGE_METHOD_NAME](axisSyncer_classPrivateFieldGet(_indexSyncer,this).getSheetId(),relativeTransformation)}axisSyncer_classPrivateFieldSet(_indexesSequence,this,newSequence)}}init(){axisSyncer_classPrivateFieldSet(_indexesSequence,this,axisSyncer_classPrivateFieldGet(_indexMapper,this).getIndexesSequence())}};function indexSyncer_classPrivateFieldInitSpec(e,t,a){(function indexSyncer_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function indexSyncer_classPrivateFieldGet(s,a){return s.get(indexSyncer_assertClassBrand(s,a))}function indexSyncer_classPrivateFieldSet(s,a,r){return s.set(indexSyncer_assertClassBrand(s,a),r),r}function indexSyncer_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _rowIndexSyncer=new WeakMap,_columnIndexSyncer=new WeakMap,_postponeAction=new WeakMap,_isPerformingUndo=new WeakMap,_isPerformingRedo=new WeakMap,_engine=new WeakMap,_sheetId=new WeakMap;const indexSyncer=class IndexSyncer{constructor(rowIndexMapper,columnIndexMapper,postponeAction){indexSyncer_classPrivateFieldInitSpec(this,_rowIndexSyncer,void 0),indexSyncer_classPrivateFieldInitSpec(this,_columnIndexSyncer,void 0),indexSyncer_classPrivateFieldInitSpec(this,_postponeAction,void 0),indexSyncer_classPrivateFieldInitSpec(this,_isPerformingUndo,!1),indexSyncer_classPrivateFieldInitSpec(this,_isPerformingRedo,!1),indexSyncer_classPrivateFieldInitSpec(this,_engine,null),indexSyncer_classPrivateFieldInitSpec(this,_sheetId,null),indexSyncer_classPrivateFieldSet(_rowIndexSyncer,this,new axisSyncer("row",rowIndexMapper,this)),indexSyncer_classPrivateFieldSet(_columnIndexSyncer,this,new axisSyncer("column",columnIndexMapper,this)),indexSyncer_classPrivateFieldSet(_postponeAction,this,postponeAction)}getForAxis(indexType){return indexSyncer_classPrivateFieldGet("row"===indexType?_rowIndexSyncer:_columnIndexSyncer,this)}setPerformUndo(flagValue){indexSyncer_classPrivateFieldSet(_isPerformingUndo,this,flagValue)}setPerformRedo(flagValue){indexSyncer_classPrivateFieldSet(_isPerformingRedo,this,flagValue)}isPerformingUndoRedo(){return indexSyncer_classPrivateFieldGet(_isPerformingUndo,this)||indexSyncer_classPrivateFieldGet(_isPerformingRedo,this)}getSheetId(){return indexSyncer_classPrivateFieldGet(_sheetId,this)}getEngine(){return indexSyncer_classPrivateFieldGet(_engine,this)}getPostponeAction(){return indexSyncer_classPrivateFieldGet(_postponeAction,this)}setupSyncEndpoint(engine,sheetId){indexSyncer_classPrivateFieldSet(_engine,this,engine),indexSyncer_classPrivateFieldSet(_sheetId,this,sheetId),indexSyncer_classPrivateFieldGet(_rowIndexSyncer,this).init(),indexSyncer_classPrivateFieldGet(_columnIndexSyncer,this).init()}};function formulas_defineProperty(e,r,t){return(r=function formulas_toPropertyKey(t){var i=function formulas_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function formulas_classPrivateFieldInitSpec(e,t,a){formulas_checkPrivateRedeclaration(e,t),t.set(e,a)}function formulas_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function formulas_classPrivateFieldSet(s,a,r){return s.set(formulas_assertClassBrand(s,a),r),r}function formulas_classPrivateFieldGet(s,a){return s.get(formulas_assertClassBrand(s,a))}function formulas_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const formulas_PLUGIN_KEY="formulas",formulas_SETTING_KEYS=["maxRows","maxColumns","language"];hooks.R.getSingleton().register("afterNamedExpressionAdded"),hooks.R.getSingleton().register("afterNamedExpressionRemoved"),hooks.R.getSingleton().register("afterSheetAdded"),hooks.R.getSingleton().register("afterSheetRemoved"),hooks.R.getSingleton().register("afterSheetRenamed"),hooks.R.getSingleton().register("afterFormulasValuesUpdate");const isBlockedSource=source=>"UndoRedo.undo"===source||"UndoRedo.redo"===source||"auto"===source;var _internalOperationPending=new WeakMap,_hotWasInitializedWithEmptyData=new WeakMap,_engineListeners=new WeakMap,_Formulas_brand=new WeakSet;class Formulas extends BasePlugin{constructor(){var _this;super(...arguments),_this=this,function formulas_classPrivateMethodInitSpec(e,a){formulas_checkPrivateRedeclaration(e,a),a.add(e)}(this,_Formulas_brand),formulas_classPrivateFieldInitSpec(this,_internalOperationPending,!1),formulas_classPrivateFieldInitSpec(this,_hotWasInitializedWithEmptyData,!1),formulas_classPrivateFieldInitSpec(this,_engineListeners,[["valuesUpdated",function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return formulas_assertClassBrand(_Formulas_brand,_this,_onEngineValuesUpdated).call(_this,...args)}],["namedExpressionAdded",function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return formulas_assertClassBrand(_Formulas_brand,_this,_onEngineNamedExpressionsAdded).call(_this,...args)}],["namedExpressionRemoved",function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return formulas_assertClassBrand(_Formulas_brand,_this,_onEngineNamedExpressionsRemoved).call(_this,...args)}],["sheetAdded",function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return formulas_assertClassBrand(_Formulas_brand,_this,_onEngineSheetAdded).call(_this,...args)}],["sheetRenamed",function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return formulas_assertClassBrand(_Formulas_brand,_this,_onEngineSheetRenamed).call(_this,...args)}],["sheetRemoved",function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return formulas_assertClassBrand(_Formulas_brand,_this,_onEngineSheetRemoved).call(_this,...args)}]]),formulas_defineProperty(this,"staticRegister",(0,staticRegister.A)("formulas")),formulas_defineProperty(this,"engine",null),formulas_defineProperty(this,"sheetName",null),formulas_defineProperty(this,"indexSyncer",null),formulas_defineProperty(this,"rowAxisSyncer",null),formulas_defineProperty(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return formulas_PLUGIN_KEY}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[formulas_PLUGIN_KEY,...formulas_SETTING_KEYS]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[formulas_PLUGIN_KEY]}enablePlugin(){var _setupEngine,_this2=this;if(!this.enabled)if(this.engine=null!==(_setupEngine=setupEngine(this.hot))&&void 0!==_setupEngine?_setupEngine:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const newSheetName=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==newSheetName&&(this.sheetName=newSheetName)}this.addHook("beforeLoadData",(function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return formulas_assertClassBrand(_Formulas_brand,_this2,_onBeforeLoadData).call(_this2,...args)})),this.addHook("afterLoadData",(function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return formulas_assertClassBrand(_Formulas_brand,_this2,formulas_onAfterLoadData).call(_this2,...args)})),this.addHook("beforeUpdateData",(function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return formulas_assertClassBrand(_Formulas_brand,_this2,_onBeforeLoadData).call(_this2,...args)})),this.addHook("afterUpdateData",(function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return formulas_assertClassBrand(_Formulas_brand,_this2,formulas_onAfterLoadData).call(_this2,...args)})),this.addHook("modifyData",(function(){for(var _len11=arguments.length,args=new Array(_len11),_key11=0;_key11<_len11;_key11++)args[_key11]=arguments[_key11];return formulas_assertClassBrand(_Formulas_brand,_this2,_onModifyData).call(_this2,...args)})),this.addHook("modifySourceData",(function(){for(var _len12=arguments.length,args=new Array(_len12),_key12=0;_key12<_len12;_key12++)args[_key12]=arguments[_key12];return formulas_assertClassBrand(_Formulas_brand,_this2,_onModifySourceData).call(_this2,...args)})),this.addHook("beforeValidate",(function(){for(var _len13=arguments.length,args=new Array(_len13),_key13=0;_key13<_len13;_key13++)args[_key13]=arguments[_key13];return formulas_assertClassBrand(_Formulas_brand,_this2,_onBeforeValidate).call(_this2,...args)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var _len14=arguments.length,args=new Array(_len14),_key14=0;_key14<_len14;_key14++)args[_key14]=arguments[_key14];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterSetSourceDataAtCell).call(_this2,...args)})),this.addHook("afterSetDataAtCell",(function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterSetDataAtCell).call(_this2,...args)})),this.addHook("afterSetDataAtRowProp",(function(){for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++)args[_key16]=arguments[_key16];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterSetDataAtCell).call(_this2,...args)})),this.addHook("beforeCreateRow",(function(){for(var _len17=arguments.length,args=new Array(_len17),_key17=0;_key17<_len17;_key17++)args[_key17]=arguments[_key17];return formulas_assertClassBrand(_Formulas_brand,_this2,_onBeforeCreateRow).call(_this2,...args)})),this.addHook("beforeCreateCol",(function(){for(var _len18=arguments.length,args=new Array(_len18),_key18=0;_key18<_len18;_key18++)args[_key18]=arguments[_key18];return formulas_assertClassBrand(_Formulas_brand,_this2,_onBeforeCreateCol).call(_this2,...args)})),this.addHook("afterCreateRow",(function(){for(var _len19=arguments.length,args=new Array(_len19),_key19=0;_key19<_len19;_key19++)args[_key19]=arguments[_key19];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterCreateRow).call(_this2,...args)})),this.addHook("afterCreateCol",(function(){for(var _len20=arguments.length,args=new Array(_len20),_key20=0;_key20<_len20;_key20++)args[_key20]=arguments[_key20];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterCreateCol).call(_this2,...args)})),this.addHook("beforeRemoveRow",(function(){for(var _len21=arguments.length,args=new Array(_len21),_key21=0;_key21<_len21;_key21++)args[_key21]=arguments[_key21];return formulas_assertClassBrand(_Formulas_brand,_this2,_onBeforeRemoveRow).call(_this2,...args)})),this.addHook("beforeRemoveCol",(function(){for(var _len22=arguments.length,args=new Array(_len22),_key22=0;_key22<_len22;_key22++)args[_key22]=arguments[_key22];return formulas_assertClassBrand(_Formulas_brand,_this2,_onBeforeRemoveCol).call(_this2,...args)})),this.addHook("afterRemoveRow",(function(){for(var _len23=arguments.length,args=new Array(_len23),_key23=0;_key23<_len23;_key23++)args[_key23]=arguments[_key23];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterRemoveRow).call(_this2,...args)})),this.addHook("afterRemoveCol",(function(){for(var _len24=arguments.length,args=new Array(_len24),_key24=0;_key24<_len24;_key24++)args[_key24]=arguments[_key24];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterRemoveCol).call(_this2,...args)})),this.indexSyncer=new indexSyncer(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(postponedAction=>{this.hot.addHookOnce("init",(()=>{postponedAction()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((movedRows,finalIndex,_,movePossible)=>{this.rowAxisSyncer.storeMovesInformation(movedRows,finalIndex,movePossible)})),this.hot.addHook("beforeColumnMove",((movedColumns,finalIndex,_,movePossible)=>{this.columnAxisSyncer.storeMovesInformation(movedColumns,finalIndex,movePossible)})),this.hot.addHook("afterRowMove",((movedRows,finalIndex,dropIndex,movePossible,orderChanged)=>{this.rowAxisSyncer.calculateAndSyncMoves(movePossible,orderChanged)})),this.hot.addHook("afterColumnMove",((movedColumns,finalIndex,dropIndex,movePossible,orderChanged)=>{this.columnAxisSyncer.calculateAndSyncMoves(movePossible,orderChanged)})),this.hot.addHook("beforeColumnFreeze",((column,freezePerformed)=>{this.columnAxisSyncer.storeMovesInformation([column],this.hot.getSettings().fixedColumnsStart,freezePerformed)})),this.hot.addHook("afterColumnFreeze",((_,freezePerformed)=>{this.columnAxisSyncer.calculateAndSyncMoves(freezePerformed,freezePerformed)})),this.hot.addHook("beforeColumnUnfreeze",((column,unfreezePerformed)=>{this.columnAxisSyncer.storeMovesInformation([column],this.hot.getSettings().fixedColumnsStart-1,unfreezePerformed)})),this.hot.addHook("afterColumnUnfreeze",((_,unfreezePerformed)=>{this.columnAxisSyncer.calculateAndSyncMoves(unfreezePerformed,unfreezePerformed)})),this.addHook("afterCellMetaReset",(function(){for(var _len25=arguments.length,args=new Array(_len25),_key25=0;_key25<_len25;_key25++)args[_key25]=arguments[_key25];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterCellMetaReset).call(_this2,...args)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var _len26=arguments.length,args=new Array(_len26),_key26=0;_key26<_len26;_key26++)args[_key26]=arguments[_key26];return formulas_assertClassBrand(_Formulas_brand,_this2,_onAfterDetachChild).call(_this2,...args)})),this.addHook("beforeAutofill",(function(){for(var _len27=arguments.length,args=new Array(_len27),_key27=0;_key27<_len27;_key27++)args[_key27]=arguments[_key27];return formulas_assertClassBrand(_Formulas_brand,_this2,_onBeforeAutofill).call(_this2,...args)})),formulas_classPrivateFieldGet(_engineListeners,this).forEach((_ref=>{let[eventName,listener]=_ref;return this.engine.on(eventName,listener)})),super.enablePlugin()}else(0,helpers_console.R8)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){formulas_classPrivateFieldGet(_engineListeners,this).forEach((_ref2=>{let[eventName,listener]=_ref2;return this.engine.off(eventName,listener)})),unregisterEngine(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(newSettings){const newEngineSettings=function getEngineSettingsWithOverrides(hotSettings){var _pluginSettings$engin2;const pluginSettings=hotSettings[formulas_PLUGIN_KEY];return{...cleanEngineSettings(null!=pluginSettings&&null!==(_pluginSettings$engin2=pluginSettings.engine)&&void 0!==_pluginSettings$engin2&&_pluginSettings$engin2.hyperformula?pluginSettings.engine:{}),...getEngineSettingsOverrides(hotSettings)}}(this.hot.getSettings());(function haveEngineSettingsChanged(currentEngineSettings,newEngineSettings){return Object.keys(newEngineSettings).some((settingOption=>void 0!==newEngineSettings[settingOption]&&newEngineSettings[settingOption]!==currentEngineSettings[settingOption]))})(this.engine.getConfig(),newEngineSettings)&&this.engine.updateConfig(newEngineSettings);const pluginSettings=this.hot.getSettings()[formulas_PLUGIN_KEY];if((0,mixed.O9)(pluginSettings)&&(0,mixed.O9)(pluginSettings.sheetName)&&pluginSettings.sheetName!==this.sheetName&&this.switchSheet(pluginSettings.sheetName),!newSettings.data&&null===this.sheetName){const sheetName=this.hot.getSettings()[formulas_PLUGIN_KEY].sheetName;sheetName&&this.engine.doesSheetExist(sheetName)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=sheetName?sheetName:void 0,this.hot.getSourceDataArray())}super.updatePlugin(newSettings)}destroy(){formulas_classPrivateFieldGet(_engineListeners,this).forEach((_ref3=>{var _this$engine;let[eventName,listener]=_ref3;return null===(_this$engine=this.engine)||void 0===_this$engine?void 0:_this$engine.off(eventName,listener)})),formulas_classPrivateFieldSet(_engineListeners,this,null),unregisterEngine(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(sheetName,sheetData){if((0,mixed.O9)(sheetData)&&!(0,helpers_data.ZI)(sheetData))return(0,helpers_console.R8)("The provided data should be an array of arrays."),!1;if(null!=sheetName&&this.engine.doesSheetExist(sheetName))return(0,helpers_console.R8)("Sheet with the provided name already exists."),!1;try{const actualSheetName=this.engine.addSheet(null!=sheetName?sheetName:void 0);return sheetData&&this.engine.setSheetContent(this.engine.getSheetId(actualSheetName),sheetData),actualSheetName}catch(e){return(0,helpers_console.R8)(e.message),!1}}switchSheet(sheetName){if(!this.engine.doesSheetExist(sheetName))return void(0,helpers_console.z3)(`The sheet named \`${sheetName}\` does not exist, switch aborted.`);this.sheetName=sheetName;const serialized=this.engine.getSheetSerialized(this.sheetId);serialized.length>0&&this.hot.loadData(serialized,`${(0,string.Ob)(formulas_PLUGIN_KEY)}.switchSheet`)}getCellType(row,column){let sheet=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const physicalRow=this.hot.toPhysicalRow(row),physicalColumn=this.hot.toPhysicalColumn(column);return null!==physicalRow&&null!==physicalColumn?this.engine.getCellType({sheet,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(row),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(column)}):"EMPTY"}isFormulaCellType(row,column){let sheet=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(row),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(column)})}renderDependentSheets(dependentCells){let renderSelf=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const affectedSheetIds=new Set;dependentCells.forEach((change=>{var _change$address;const sheetId=null==change||null===(_change$address=change.address)||void 0===_change$address?void 0:_change$address.sheet;void 0!==sheetId&&(affectedSheetIds.has(sheetId)||affectedSheetIds.add(sheetId))})),getRegisteredHotInstances(this.engine).forEach(((relatedHot,sheetId)=>{var _relatedHot$view;(renderSelf||sheetId!==this.sheetId)&&affectedSheetIds.has(sheetId)&&(relatedHot.render(),null===(_relatedHot$view=relatedHot.view)||void 0===_relatedHot$view||_relatedHot$view.adjustElementsSize())}))}validateDependentCells(dependentCells){const stringifyAddress=change=>{var _change$address2;const{row,col,sheet}=null!==(_change$address2=null==change?void 0:change.address)&&void 0!==_change$address2?_change$address2:{};return(0,mixed.O9)(sheet)?`${sheet}:${row}x${col}`:""},changedCellsSet=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((change=>stringifyAddress(change))));dependentCells.forEach((change=>{var _change$address3,_change$address4;const{row,col}=null!==(_change$address3=change.address)&&void 0!==_change$address3?_change$address3:{};if(!1===(0,mixed.O9)(row)||!1===(0,mixed.O9)(col)||row>=this.hot.countRows()||col>=this.hot.countCols())return;const sheetId=null==change||null===(_change$address4=change.address)||void 0===_change$address4?void 0:_change$address4.sheet,addressId=stringifyAddress(change);if(void 0!==sheetId&&!changedCellsSet.has(addressId)){const boundHot=getRegisteredHotInstances(this.engine).get(sheetId);if(!boundHot)return;boundHot.validateCell(boundHot.getDataAtCell(row,col),boundHot.getCellMeta(row,col),(()=>{}))}}))}syncChangeWithEngine(row,column,newValue){const address={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(row),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(column),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(address))return void(0,helpers_console.R8)(`Not possible to set cell data at ${JSON.stringify(address)}`);const cellMeta=this.hot.getCellMeta(row,column);return utils_isDate(newValue,cellMeta.type)&&(isDateValid(newValue,cellMeta.dateFormat)?newValue=getDateInHfFormat(newValue,cellMeta.dateFormat):!1===function isFormula(value){return"string"==typeof value&&value.startsWith("=")}(newValue)&&(newValue=`'${newValue}`)),this.engine.setCellContents(address,newValue)}}function _onBeforeValidate(value,visualRow,prop){const visualColumn=this.hot.propToCol(prop);if(this.isFormulaCellType(visualRow,visualColumn)){const address={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(visualRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(visualColumn),sheet:this.sheetId},cellMeta=this.hot.getCellMeta(visualRow,visualColumn);let cellValue=this.engine.getCellValue(address);return"date"===cellMeta.type&&(0,number.kf)(cellValue)&&(cellValue=getDateFromExcelDate(cellValue,cellMeta.dateFormat)),"object"==typeof cellValue&&null!==cellValue?cellValue.value:cellValue}return value}function _onBeforeAutofill(fillData,sourceRange,targetRange){const{row:sourceTopStartRow,col:sourceTopStartColumn}=sourceRange.getTopStartCorner(),{row:sourceBottomEndRow,col:sourceBottomEndColumn}=sourceRange.getBottomEndCorner(),{row:targetTopStartRow,col:targetTopStartColumn}=targetRange.getTopStartCorner(),{row:targetBottomEndRow,col:targetBottomEndColumn}=targetRange.getBottomEndCorner(),engineSourceRange={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(sourceTopStartRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(sourceTopStartColumn),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(sourceBottomEndRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(sourceBottomEndColumn),sheet:this.sheetId}},engineTargetRange={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(targetTopStartRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(targetTopStartColumn),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(targetBottomEndRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(targetBottomEndColumn),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(engineTargetRange))return!1;const fillRangeData=this.engine.getFillRangeData(engineSourceRange,engineTargetRange),{row:sourceStartRow,col:sourceStartColumn}=engineSourceRange.start,{row:sourceEndRow,col:sourceEndColumn}=engineSourceRange.end,populationRowLength=sourceEndRow-sourceStartRow+1,populationColumnLength=sourceEndColumn-sourceStartColumn+1;for(let populatedRowIndex=0;populatedRowIndex<fillRangeData.length;populatedRowIndex+=1)for(let populatedColumnIndex=0;populatedColumnIndex<fillRangeData[populatedRowIndex].length;populatedColumnIndex+=1){const populatedValue=fillRangeData[populatedRowIndex][populatedColumnIndex],sourceRow=sourceStartRow+populatedRowIndex%populationRowLength,sourceColumn=sourceStartColumn+populatedColumnIndex%populationColumnLength,sourceCellMeta=this.hot.getCellMeta(sourceRow,sourceColumn);utils_isDate(populatedValue,sourceCellMeta.type)&&(populatedValue.startsWith("'")?fillRangeData[populatedRowIndex][populatedColumnIndex]=populatedValue.slice(1):!1===this.isFormulaCellType(sourceRow,sourceColumn,this.sheetId)&&(fillRangeData[populatedRowIndex][populatedColumnIndex]=(date=populatedValue,dateFormat=sourceCellMeta.dateFormat,moment_default()(date,"DD/MM/YYYY",!0).format(dateFormat))))}var date,dateFormat;return fillRangeData}function _onBeforeLoadData(sourceData,initialLoad){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes((0,string.Ob)(formulas_PLUGIN_KEY))||formulas_classPrivateFieldSet(_hotWasInitializedWithEmptyData,this,(0,mixed.b0)(this.hot.getSettings().data))}function _onAfterCellMetaReset(){const sourceDataArray=this.hot.getSourceDataArray();let valueChanged=!1;sourceDataArray.forEach(((rowData,rowIndex)=>{rowData.forEach(((cellValue,columnIndex)=>{const cellMeta=this.hot.getCellMeta(rowIndex,columnIndex),dateFormat=cellMeta.dateFormat;utils_isDate(cellValue,cellMeta.type)&&(valueChanged=!0,isDateValid(cellValue,dateFormat)?sourceDataArray[rowIndex][columnIndex]=getDateInHfFormat(cellValue,dateFormat):!1===this.isFormulaCellType(rowIndex,columnIndex)&&(sourceDataArray[rowIndex][columnIndex]=`'${cellValue}`))}))})),!0===valueChanged&&(formulas_classPrivateFieldSet(_internalOperationPending,this,!0),this.engine.setSheetContent(this.sheetId,sourceDataArray),formulas_classPrivateFieldSet(_internalOperationPending,this,!1))}function formulas_onAfterLoadData(sourceData,initialLoad){if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes((0,string.Ob)(formulas_PLUGIN_KEY)))if(this.sheetName=function setupSheet(engineInstance,sheetName){return!(0,mixed.b0)(sheetName)&&engineInstance.doesSheetExist(sheetName)||(sheetName=engineInstance.addSheet(sheetName)),sheetName}(this.engine,this.hot.getSettings()[formulas_PLUGIN_KEY].sheetName),formulas_classPrivateFieldGet(_hotWasInitializedWithEmptyData,this))this.switchSheet(this.sheetName);else{const sourceDataArray=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,sourceDataArray)){formulas_classPrivateFieldSet(_internalOperationPending,this,!0);const dependentCells=this.engine.setSheetContent(this.sheetId,sourceDataArray);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(dependentCells),formulas_classPrivateFieldSet(_internalOperationPending,this,!1)}}}function _onModifyData(physicalRow,visualColumn,valueHolder,ioMode){if("get"!==ioMode||formulas_classPrivateFieldGet(_internalOperationPending,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const visualRow=this.hot.toVisualRow(physicalRow);if(null===visualRow||null===visualColumn)return;if(!this.isFormulaCellType(visualRow,visualColumn)){if("ARRAY"!==this.getCellType(visualRow,visualColumn))return void(isEscapedFormulaExpression(valueHolder.value)&&(valueHolder.value=function unescapeFormulaExpression(expression){return isEscapedFormulaExpression(expression)?expression.substr(1):expression}(valueHolder.value)))}const address={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(visualRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(visualColumn),sheet:this.sheetId};let cellValue=this.engine.getCellValue(address),cellMeta=this.hot.getCellsMeta().find((singleCellMeta=>singleCellMeta.visualRow===visualRow&&singleCellMeta.visualCol===visualColumn));void 0===cellMeta&&(cellMeta={}),"date"===cellMeta.type&&(0,number.kf)(cellValue)&&(cellValue=getDateFromExcelDate(cellValue,cellMeta.dateFormat));const value="object"==typeof cellValue&&null!==cellValue?cellValue.value:cellValue;valueHolder.value=value}function _onModifySourceData(row,columnOrProp,valueHolder,ioMode){if("get"!==ioMode||formulas_classPrivateFieldGet(_internalOperationPending,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const visualRow=this.hot.toVisualRow(row),visualColumn=this.hot.propToCol(columnOrProp);if(null===visualRow||null===visualColumn)return;if(!this.isFormulaCellType(visualRow,visualColumn)){if("ARRAY"!==this.getCellType(visualRow,visualColumn))return}const dimensions=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===dimensions.width&&0===dimensions.height)return;const address={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(visualRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(visualColumn),sheet:this.sheetId};valueHolder.value=this.engine.getCellSerialized(address)}function _onAfterSetDataAtCell(changes,source){if(isBlockedSource(source))return;const outOfBoundsChanges=[],changedCells=[],dependentCells=this.engine.batch((()=>{changes.forEach((_ref4=>{let[visualRow,prop,,newValue]=_ref4;const visualColumn=this.hot.propToCol(prop),physicalRow=this.hot.toPhysicalRow(visualRow),physicalColumn=this.hot.toPhysicalColumn(visualColumn),address={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(visualRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(visualColumn),sheet:this.sheetId};null!==physicalRow&&null!==physicalColumn?this.syncChangeWithEngine(visualRow,visualColumn,newValue):outOfBoundsChanges.push([visualRow,visualColumn,newValue]),changedCells.push({address})}))}));outOfBoundsChanges.length&&this.hot.addHookOnce("afterChange",(()=>{const outOfBoundsDependentCells=this.engine.batch((()=>{outOfBoundsChanges.forEach((_ref5=>{let[row,column,newValue]=_ref5;this.syncChangeWithEngine(row,column,newValue)}))}));this.renderDependentSheets(outOfBoundsDependentCells,!0)})),this.renderDependentSheets(dependentCells),this.validateDependentCells(dependentCells,changedCells)}function _onAfterSetSourceDataAtCell(changes,source){if(isBlockedSource(source))return;const dependentCells=[],changedCells=[];changes.forEach((_ref6=>{let[visualRow,prop,,newValue]=_ref6;const visualColumn=this.hot.propToCol(prop);if(!(0,number.kf)(visualColumn))return;const address={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(visualRow),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(visualColumn),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(address)?(changedCells.push({address}),dependentCells.push(...this.engine.setCellContents(address,newValue))):(0,helpers_console.R8)(`Not possible to set source cell data at ${JSON.stringify(address)}`)})),this.renderDependentSheets(dependentCells),this.validateDependentCells(dependentCells,changedCells)}function _onBeforeCreateRow(visualRow,amount){let hfRowIndex=this.rowAxisSyncer.getHfIndexFromVisualIndex(visualRow);if(visualRow>=this.hot.countRows()&&(hfRowIndex=visualRow),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[hfRowIndex,amount]))return!1}function _onBeforeCreateCol(visualColumn,amount){let hfColumnIndex=this.columnAxisSyncer.getHfIndexFromVisualIndex(visualColumn);if(visualColumn>=this.hot.countCols()&&(hfColumnIndex=visualColumn),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[hfColumnIndex,amount]))return!1}function _onBeforeRemoveRow(row,amount,physicalRows){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(physicalRows).every((hfRow=>this.engine.isItPossibleToRemoveRows(this.sheetId,[hfRow,1])))&&void 0}function _onBeforeRemoveCol(col,amount,physicalColumns){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(physicalColumns).every((hfColumn=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[hfColumn,1])))&&void 0}function _onAfterCreateRow(visualRow,amount,source){if(isBlockedSource(source))return;const changes=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(visualRow),amount]);this.renderDependentSheets(changes)}function _onAfterCreateCol(visualColumn,amount,source){if(isBlockedSource(source))return;const changes=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(visualColumn),amount]);this.renderDependentSheets(changes)}function _onAfterRemoveRow(row,amount,physicalRows,source){if(isBlockedSource(source))return;const descendingHfRows=this.rowAxisSyncer.getRemovedHfIndexes().sort(((a,b)=>b-a)),changes=this.engine.batch((()=>{descendingHfRows.forEach((hfRow=>{this.engine.removeRows(this.sheetId,[hfRow,1])}))}));this.renderDependentSheets(changes)}function _onAfterRemoveCol(col,amount,physicalColumns,source){if(isBlockedSource(source))return;const descendingHfColumns=this.columnAxisSyncer.getRemovedHfIndexes().sort(((a,b)=>b-a)),changes=this.engine.batch((()=>{descendingHfColumns.forEach((hfColumn=>{this.engine.removeColumns(this.sheetId,[hfColumn,1])}))}));this.renderDependentSheets(changes)}function _onAfterDetachChild(parent,element,finalElementRowIndex){var _element$__children;formulas_classPrivateFieldSet(_internalOperationPending,this,!0);const rowsData=this.hot.getSourceDataArray(finalElementRowIndex,0,finalElementRowIndex+((null===(_element$__children=element.__children)||void 0===_element$__children?void 0:_element$__children.length)||0),this.hot.countSourceCols());formulas_classPrivateFieldSet(_internalOperationPending,this,!1),rowsData.forEach(((row,relativeRowIndex)=>{row.forEach(((value,colIndex)=>{this.engine.setCellContents({col:colIndex,row:finalElementRowIndex+relativeRowIndex,sheet:this.sheetId},[[value]])}))}))}function _onEngineValuesUpdated(changes){this.hot.runHooks("afterFormulasValuesUpdate",changes)}function _onEngineNamedExpressionsAdded(namedExpressionName,changes){this.hot.runHooks("afterNamedExpressionAdded",namedExpressionName,changes)}function _onEngineNamedExpressionsRemoved(namedExpressionName,changes){this.hot.runHooks("afterNamedExpressionRemoved",namedExpressionName,changes)}function _onEngineSheetAdded(addedSheetDisplayName){this.hot.runHooks("afterSheetAdded",addedSheetDisplayName)}function _onEngineSheetRenamed(oldDisplayName,newDisplayName){this.sheetName=newDisplayName,this.hot.runHooks("afterSheetRenamed",oldDisplayName,newDisplayName)}function _onEngineSheetRemoved(removedSheetDisplayName,changes){this.hot.runHooks("afterSheetRemoved",removedSheetDisplayName,changes)}var hidingMap=__webpack_require__("./node_modules/handsontable/translations/maps/hidingMap.mjs");function hiddenColumns_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hiddenColumns_classPrivateFieldGet(s,a){return s.get(hiddenColumns_assertClassBrand(s,a))}function hiddenColumns_classPrivateFieldSet(s,a,r){return s.set(hiddenColumns_assertClassBrand(s,a),r),r}function hiddenColumns_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("beforeHideColumns"),hooks.R.getSingleton().register("afterHideColumns"),hooks.R.getSingleton().register("beforeUnhideColumns"),hooks.R.getSingleton().register("afterUnhideColumns");var _hiddenColumnsMap=new WeakMap,_HiddenColumns_brand=new WeakSet;class HiddenColumns extends BasePlugin{constructor(){super(...arguments),function hiddenColumns_classPrivateMethodInitSpec(e,a){hiddenColumns_checkPrivateRedeclaration(e,a),a.add(e)}(this,_HiddenColumns_brand),function hiddenColumns_classPrivateFieldInitSpec(e,t,a){hiddenColumns_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_hiddenColumnsMap,null)}static get PLUGIN_KEY(){return"hiddenColumns"}static get PLUGIN_PRIORITY(){return 310}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings().hiddenColumns}enablePlugin(){var _this=this;this.enabled||(hiddenColumns_classPrivateFieldSet(_hiddenColumnsMap,this,new hidingMap.o),hiddenColumns_classPrivateFieldGet(_hiddenColumnsMap,this).addLocalHook("init",(()=>hiddenColumns_assertClassBrand(_HiddenColumns_brand,this,_onMapInit).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,hiddenColumns_classPrivateFieldGet(_hiddenColumnsMap,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return hiddenColumns_assertClassBrand(_HiddenColumns_brand,_this,hiddenColumns_onAfterContextMenuDefaultOptions).call(_this,...args)})),this.addHook("afterGetCellMeta",((row,col,cellProperties)=>hiddenColumns_assertClassBrand(_HiddenColumns_brand,this,_onAfterGetCellMeta).call(this,row,col,cellProperties))),this.addHook("modifyColWidth",((width,col)=>hiddenColumns_assertClassBrand(_HiddenColumns_brand,this,_onModifyColWidth).call(this,width,col)),2),this.addHook("afterGetColHeader",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return hiddenColumns_assertClassBrand(_HiddenColumns_brand,_this,hiddenColumns_onAfterGetColHeader).call(_this,...args)})),this.addHook("modifyCopyableRange",(ranges=>hiddenColumns_assertClassBrand(_HiddenColumns_brand,this,_onModifyCopyableRange).call(this,ranges))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(columns){const currentHideConfig=this.getHiddenColumns(),isValidConfig=this.isValidConfig(columns);let destinationHideConfig=currentHideConfig;const hidingMapValues=hiddenColumns_classPrivateFieldGet(_hiddenColumnsMap,this).getValues().slice(),isAnyColumnShowed=columns.length>0;if(isValidConfig&&isAnyColumnShowed){const physicalColumns=columns.map((visualColumn=>this.hot.toPhysicalColumn(visualColumn)));(0,array.z0)(physicalColumns,(physicalColumn=>{hidingMapValues[physicalColumn]=!1})),destinationHideConfig=(0,array.mu)(hidingMapValues,((hiddenIndexes,isHidden,physicalIndex)=>(isHidden&&hiddenIndexes.push(this.hot.toVisualColumn(physicalIndex)),hiddenIndexes)),[])}!1!==this.hot.runHooks("beforeUnhideColumns",currentHideConfig,destinationHideConfig,isValidConfig&&isAnyColumnShowed)&&(isValidConfig&&isAnyColumnShowed&&hiddenColumns_classPrivateFieldGet(_hiddenColumnsMap,this).setValues(hidingMapValues),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",currentHideConfig,destinationHideConfig,isValidConfig&&isAnyColumnShowed,isValidConfig&&destinationHideConfig.length<currentHideConfig.length))}showColumn(){for(var _len3=arguments.length,column=new Array(_len3),_key3=0;_key3<_len3;_key3++)column[_key3]=arguments[_key3];this.showColumns(column)}hideColumns(columns){const currentHideConfig=this.getHiddenColumns(),isConfigValid=this.isValidConfig(columns);let destinationHideConfig=currentHideConfig;isConfigValid&&(destinationHideConfig=Array.from(new Set(currentHideConfig.concat(columns))));!1!==this.hot.runHooks("beforeHideColumns",currentHideConfig,destinationHideConfig,isConfigValid)&&(isConfigValid&&this.hot.batchExecution((()=>{(0,array.z0)(columns,(visualColumn=>{hiddenColumns_classPrivateFieldGet(_hiddenColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(visualColumn),!0)}))}),!0),this.hot.runHooks("afterHideColumns",currentHideConfig,destinationHideConfig,isConfigValid,isConfigValid&&destinationHideConfig.length>currentHideConfig.length))}hideColumn(){for(var _len4=arguments.length,column=new Array(_len4),_key4=0;_key4<_len4;_key4++)column[_key4]=arguments[_key4];this.hideColumns(column)}getHiddenColumns(){return(0,array.YD)(hiddenColumns_classPrivateFieldGet(_hiddenColumnsMap,this).getHiddenIndexes(),(physicalColumnIndex=>this.hot.toVisualColumn(physicalColumnIndex)))}isHidden(column){return hiddenColumns_classPrivateFieldGet(_hiddenColumnsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(column))||!1}isValidConfig(hiddenColumns){const nrOfColumns=this.hot.countCols();return!!(Array.isArray(hiddenColumns)&&hiddenColumns.length>0)&&hiddenColumns.every((visualColumn=>Number.isInteger(visualColumn)&&visualColumn>=0&&visualColumn<nrOfColumns))}resetCellsMeta(){(0,array.z0)(this.hot.getCellsMeta(),(meta=>{meta.skipColumnOnPaste=!1}))}destroy(){hiddenColumns_classPrivateFieldSet(_hiddenColumnsMap,this,null),super.destroy()}}function _onModifyColWidth(width,column){return this.isHidden(column)?0:this.getSetting("indicators")&&(this.isHidden(column+1)||this.isHidden(column-1))&&"number"==typeof width&&this.hot.hasColHeaders()?width+15:void 0}function _onAfterGetCellMeta(row,column,cellProperties){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(column)&&(cellProperties.skipColumnOnPaste=!0),this.isHidden(column-1))cellProperties.className=cellProperties.className||"",-1===cellProperties.className.indexOf("afterHiddenColumn")&&(cellProperties.className+=" afterHiddenColumn");else if(cellProperties.className){const classArr=cellProperties.className.split(" ");if(classArr.length>0){const containAfterHiddenColumn=classArr.indexOf("afterHiddenColumn");containAfterHiddenColumn>-1&&classArr.splice(containAfterHiddenColumn,1),cellProperties.className=classArr.join(" ")}}}function _onModifyCopyableRange(ranges){if(this.getSetting("copyPasteEnabled"))return ranges;const newRanges=[],pushRange=(startRow,endRow,startCol,endCol)=>{newRanges.push({startRow,endRow,startCol,endCol})};return(0,array.z0)(ranges,(range=>{let isHidden=!0,rangeStart=0;(0,number.Ti)(range.startCol,range.endCol,(visualColumn=>{this.isHidden(visualColumn)?(isHidden||pushRange(range.startRow,range.endRow,rangeStart,visualColumn-1),isHidden=!0):(isHidden&&(rangeStart=visualColumn),visualColumn===range.endCol&&pushRange(range.startRow,range.endRow,rangeStart,visualColumn),isHidden=!1)}))})),newRanges}function hiddenColumns_onAfterGetColHeader(column,TH){if(!this.getSetting("indicators")||column<0)return;const classList=[];column>=1&&this.isHidden(column-1)&&classList.push("afterHiddenColumn"),column<this.hot.countCols()-1&&this.isHidden(column+1)&&classList.push("beforeHiddenColumn"),(0,dom_element.iQ)(TH,classList)}function hiddenColumns_onAfterContextMenuDefaultOptions(options){options.items.push({name:KEY},function hideColumnItem(hiddenColumnsPlugin){return{key:"hidden_columns_hide",name(){const selection=this.getSelectedLast();let pluralForm=0;if(Array.isArray(selection)){const[,fromColumn,,toColumn]=selection;fromColumn-toColumn!=0&&(pluralForm=1)}return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_HIDE_COLUMN,pluralForm)},callback(){const{from,to}=this.getSelectedRangeLast(),start=Math.max(Math.min(from.col,to.col),0),end=Math.max(from.col,to.col),columnsToHide=[];for(let visualColumn=start;visualColumn<=end;visualColumn+=1)columnsToHide.push(visualColumn);hiddenColumnsPlugin.hideColumns(columnsToHide);const lastHiddenColumn=columnsToHide[columnsToHide.length-1],columnToSelect=this.columnIndexMapper.getNearestNotHiddenIndex(lastHiddenColumn,1,!0);Number.isInteger(columnToSelect)&&columnToSelect>=0?this.selectColumns(columnToSelect):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}(this),function showColumnItem(hiddenColumnsPlugin){const columns=[];return{key:"hidden_columns_show",name(){const pluralForm=columns.length>1?1:0;return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_SHOW_COLUMN,pluralForm)},callback(){var _this$columnIndexMapp,_this$columnIndexMapp2;if(0===columns.length)return;let startVisualColumn=columns[0],endVisualColumn=columns[columns.length-1];startVisualColumn=null!==(_this$columnIndexMapp=this.columnIndexMapper.getNearestNotHiddenIndex(startVisualColumn-1,-1))&&void 0!==_this$columnIndexMapp?_this$columnIndexMapp:0,endVisualColumn=null!==(_this$columnIndexMapp2=this.columnIndexMapper.getNearestNotHiddenIndex(endVisualColumn+1,1))&&void 0!==_this$columnIndexMapp2?_this$columnIndexMapp2:this.countCols()-1,hiddenColumnsPlugin.showColumns(columns),this.render(),this.view.adjustElementsSize(),endVisualColumn-startVisualColumn+1===this.countCols()||this.selectColumns(startVisualColumn,endVisualColumn)},disabled:!1,hidden(){const hiddenPhysicalColumns=(0,array.YD)(hiddenColumnsPlugin.getHiddenColumns(),(visualColumnIndex=>this.toPhysicalColumn(visualColumnIndex)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||hiddenPhysicalColumns.length<1)return!0;columns.length=0;const selectedRangeLast=this.getSelectedRangeLast(),visualStartColumn=selectedRangeLast.getTopStartCorner().col,visualEndColumn=selectedRangeLast.getBottomEndCorner().col,columnIndexMapper=this.columnIndexMapper,renderableStartColumn=columnIndexMapper.getRenderableFromVisualIndex(visualStartColumn),renderableEndColumn=columnIndexMapper.getRenderableFromVisualIndex(visualEndColumn),notTrimmedColumnIndexes=columnIndexMapper.getNotTrimmedIndexes(),physicalColumnIndexes=[];if(visualStartColumn!==visualEndColumn){if(visualEndColumn-visualStartColumn+1>renderableEndColumn-renderableStartColumn+1){const physicalIndexesInRange=notTrimmedColumnIndexes.slice(visualStartColumn,visualEndColumn+1);physicalColumnIndexes.push(...physicalIndexesInRange.filter((physicalIndex=>hiddenPhysicalColumns.includes(physicalIndex))))}}else if(0===renderableStartColumn&&renderableStartColumn<visualStartColumn)physicalColumnIndexes.push(...notTrimmedColumnIndexes.slice(0,visualStartColumn));else if(null===renderableStartColumn)physicalColumnIndexes.push(...notTrimmedColumnIndexes.slice(0,this.countCols()));else{const lastVisualIndex=this.countCols()-1;renderableEndColumn===columnIndexMapper.getRenderableFromVisualIndex(columnIndexMapper.getNearestNotHiddenIndex(lastVisualIndex,-1))&&lastVisualIndex>visualEndColumn&&physicalColumnIndexes.push(...notTrimmedColumnIndexes.slice(visualEndColumn+1))}return(0,array.z0)(physicalColumnIndexes,(physicalColumnIndex=>{columns.push(this.toVisualColumn(physicalColumnIndex))})),0===columns.length}}}(this))}function _onMapInit(){const columns=this.getSetting("columns");Array.isArray(columns)&&this.hideColumns(columns)}function hiddenRows_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hiddenRows_classPrivateFieldGet(s,a){return s.get(hiddenRows_assertClassBrand(s,a))}function hiddenRows_classPrivateFieldSet(s,a,r){return s.set(hiddenRows_assertClassBrand(s,a),r),r}function hiddenRows_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("beforeHideRows"),hooks.R.getSingleton().register("afterHideRows"),hooks.R.getSingleton().register("beforeUnhideRows"),hooks.R.getSingleton().register("afterUnhideRows");var _hiddenRowsMap=new WeakMap,_HiddenRows_brand=new WeakSet;class HiddenRows extends BasePlugin{constructor(){super(...arguments),function hiddenRows_classPrivateMethodInitSpec(e,a){hiddenRows_checkPrivateRedeclaration(e,a),a.add(e)}(this,_HiddenRows_brand),function hiddenRows_classPrivateFieldInitSpec(e,t,a){hiddenRows_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_hiddenRowsMap,null)}static get PLUGIN_KEY(){return"hiddenRows"}static get PLUGIN_PRIORITY(){return 320}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings().hiddenRows}enablePlugin(){var _this=this;this.enabled||(hiddenRows_classPrivateFieldSet(_hiddenRowsMap,this,new hidingMap.o),hiddenRows_classPrivateFieldGet(_hiddenRowsMap,this).addLocalHook("init",(()=>hiddenRows_assertClassBrand(_HiddenRows_brand,this,hiddenRows_onMapInit).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,hiddenRows_classPrivateFieldGet(_hiddenRowsMap,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return hiddenRows_assertClassBrand(_HiddenRows_brand,_this,hiddenRows_onAfterContextMenuDefaultOptions).call(_this,...args)})),this.addHook("afterGetCellMeta",((row,col,cellProperties)=>hiddenRows_assertClassBrand(_HiddenRows_brand,this,hiddenRows_onAfterGetCellMeta).call(this,row,col,cellProperties))),this.addHook("modifyRowHeight",((height,row)=>hiddenRows_assertClassBrand(_HiddenRows_brand,this,_onModifyRowHeight).call(this,height,row))),this.addHook("afterGetRowHeader",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return hiddenRows_assertClassBrand(_HiddenRows_brand,_this,_onAfterGetRowHeader).call(_this,...args)})),this.addHook("modifyCopyableRange",(ranges=>hiddenRows_assertClassBrand(_HiddenRows_brand,this,hiddenRows_onModifyCopyableRange).call(this,ranges))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(rows){const currentHideConfig=this.getHiddenRows(),isValidConfig=this.isValidConfig(rows);let destinationHideConfig=currentHideConfig;const hidingMapValues=hiddenRows_classPrivateFieldGet(_hiddenRowsMap,this).getValues().slice(),isAnyRowShowed=rows.length>0;if(isValidConfig&&isAnyRowShowed){const physicalRows=rows.map((visualRow=>this.hot.toPhysicalRow(visualRow)));(0,array.z0)(physicalRows,(physicalRow=>{hidingMapValues[physicalRow]=!1})),destinationHideConfig=(0,array.mu)(hidingMapValues,((hiddenIndexes,isHidden,physicalIndex)=>(isHidden&&hiddenIndexes.push(this.hot.toVisualRow(physicalIndex)),hiddenIndexes)),[])}!1!==this.hot.runHooks("beforeUnhideRows",currentHideConfig,destinationHideConfig,isValidConfig&&isAnyRowShowed)&&(isValidConfig&&isAnyRowShowed&&hiddenRows_classPrivateFieldGet(_hiddenRowsMap,this).setValues(hidingMapValues),this.hot.runHooks("afterUnhideRows",currentHideConfig,destinationHideConfig,isValidConfig&&isAnyRowShowed,isValidConfig&&destinationHideConfig.length<currentHideConfig.length))}showRow(){for(var _len3=arguments.length,row=new Array(_len3),_key3=0;_key3<_len3;_key3++)row[_key3]=arguments[_key3];this.showRows(row)}hideRows(rows){const currentHideConfig=this.getHiddenRows(),isConfigValid=this.isValidConfig(rows);let destinationHideConfig=currentHideConfig;isConfigValid&&(destinationHideConfig=Array.from(new Set(currentHideConfig.concat(rows))));!1!==this.hot.runHooks("beforeHideRows",currentHideConfig,destinationHideConfig,isConfigValid)&&(isConfigValid&&this.hot.batchExecution((()=>{(0,array.z0)(rows,(visualRow=>{hiddenRows_classPrivateFieldGet(_hiddenRowsMap,this).setValueAtIndex(this.hot.toPhysicalRow(visualRow),!0)}))}),!0),this.hot.runHooks("afterHideRows",currentHideConfig,destinationHideConfig,isConfigValid,isConfigValid&&destinationHideConfig.length>currentHideConfig.length))}hideRow(){for(var _len4=arguments.length,row=new Array(_len4),_key4=0;_key4<_len4;_key4++)row[_key4]=arguments[_key4];this.hideRows(row)}getHiddenRows(){return(0,array.YD)(hiddenRows_classPrivateFieldGet(_hiddenRowsMap,this).getHiddenIndexes(),(physicalRowIndex=>this.hot.toVisualRow(physicalRowIndex)))}isHidden(row){return hiddenRows_classPrivateFieldGet(_hiddenRowsMap,this).getValueAtIndex(this.hot.toPhysicalRow(row))||!1}isValidConfig(hiddenRows){const nrOfRows=this.hot.countRows();return!!(Array.isArray(hiddenRows)&&hiddenRows.length>0)&&hiddenRows.every((visualRow=>Number.isInteger(visualRow)&&visualRow>=0&&visualRow<nrOfRows))}resetCellsMeta(){(0,array.z0)(this.hot.getCellsMeta(),(meta=>{meta.skipRowOnPaste=!1}))}destroy(){hiddenRows_classPrivateFieldSet(_hiddenRowsMap,this,null),super.destroy()}}function _onModifyRowHeight(height,row){return this.isHidden(row)?0:height}function hiddenRows_onAfterGetCellMeta(row,column,cellProperties){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(row)&&(cellProperties.skipRowOnPaste=!0),this.isHidden(row-1))cellProperties.className=cellProperties.className||"",-1===cellProperties.className.indexOf("afterHiddenRow")&&(cellProperties.className+=" afterHiddenRow");else if(cellProperties.className){const classArr=cellProperties.className.split(" ");if(classArr.length>0){const containAfterHiddenRow=classArr.indexOf("afterHiddenRow");containAfterHiddenRow>-1&&classArr.splice(containAfterHiddenRow,1),cellProperties.className=classArr.join(" ")}}}function hiddenRows_onModifyCopyableRange(ranges){if(this.getSetting("copyPasteEnabled"))return ranges;const newRanges=[],pushRange=(startRow,endRow,startCol,endCol)=>{newRanges.push({startRow,endRow,startCol,endCol})};return(0,array.z0)(ranges,(range=>{let isHidden=!0,rangeStart=0;(0,number.Ti)(range.startRow,range.endRow,(visualRow=>{this.isHidden(visualRow)?(isHidden||pushRange(rangeStart,visualRow-1,range.startCol,range.endCol),isHidden=!0):(isHidden&&(rangeStart=visualRow),visualRow===range.endRow&&pushRange(rangeStart,visualRow,range.startCol,range.endCol),isHidden=!1)}))})),newRanges}function _onAfterGetRowHeader(row,TH){if(!this.getSetting("indicators")||row<0)return;const classList=[];row>=1&&this.isHidden(row-1)&&classList.push("afterHiddenRow"),row<this.hot.countRows()-1&&this.isHidden(row+1)&&classList.push("beforeHiddenRow"),(0,dom_element.iQ)(TH,classList)}function hiddenRows_onAfterContextMenuDefaultOptions(options){options.items.push({name:KEY},function hideRowItem(hiddenRowsPlugin){return{key:"hidden_rows_hide",name(){const selection=this.getSelectedLast();let pluralForm=0;if(Array.isArray(selection)){const[fromRow,,toRow]=selection;fromRow-toRow!=0&&(pluralForm=1)}return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_HIDE_ROW,pluralForm)},callback(){const{from,to}=this.getSelectedRangeLast(),start=Math.max(Math.min(from.row,to.row),0),end=Math.max(from.row,to.row),rowsToHide=[];for(let visualRow=start;visualRow<=end;visualRow+=1)rowsToHide.push(visualRow);hiddenRowsPlugin.hideRows(rowsToHide);const lastHiddenRow=rowsToHide[rowsToHide.length-1],rowToSelect=this.rowIndexMapper.getNearestNotHiddenIndex(lastHiddenRow,1,!0);Number.isInteger(rowToSelect)&&rowToSelect>=0?this.selectRows(rowToSelect):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}(this),function showRowItem(hiddenRowsPlugin){const rows=[];return{key:"hidden_rows_show",name(){const pluralForm=rows.length>1?1:0;return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_SHOW_ROW,pluralForm)},callback(){var _this$rowIndexMapper$,_this$rowIndexMapper$2;if(0===rows.length)return;let startVisualRow=rows[0],endVisualRow=rows[rows.length-1];startVisualRow=null!==(_this$rowIndexMapper$=this.rowIndexMapper.getNearestNotHiddenIndex(startVisualRow-1,-1))&&void 0!==_this$rowIndexMapper$?_this$rowIndexMapper$:0,endVisualRow=null!==(_this$rowIndexMapper$2=this.rowIndexMapper.getNearestNotHiddenIndex(endVisualRow+1,1))&&void 0!==_this$rowIndexMapper$2?_this$rowIndexMapper$2:this.countRows()-1,hiddenRowsPlugin.showRows(rows),this.render(),this.view.adjustElementsSize(),endVisualRow-startVisualRow+1===this.countRows()||this.selectRows(startVisualRow,endVisualRow)},disabled:!1,hidden(){const hiddenPhysicalRows=(0,array.YD)(hiddenRowsPlugin.getHiddenRows(),(visualRowIndex=>this.toPhysicalRow(visualRowIndex)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||hiddenPhysicalRows.length<1)return!0;rows.length=0;const selectedRangeLast=this.getSelectedRangeLast(),visualStartRow=selectedRangeLast.getTopStartCorner().row,visualEndRow=selectedRangeLast.getBottomEndCorner().row,rowIndexMapper=this.rowIndexMapper,renderableStartRow=rowIndexMapper.getRenderableFromVisualIndex(visualStartRow),renderableEndRow=rowIndexMapper.getRenderableFromVisualIndex(visualEndRow),notTrimmedRowIndexes=rowIndexMapper.getNotTrimmedIndexes(),physicalRowIndexes=[];if(visualStartRow!==visualEndRow){if(visualEndRow-visualStartRow+1>renderableEndRow-renderableStartRow+1){const physicalIndexesInRange=notTrimmedRowIndexes.slice(visualStartRow,visualEndRow+1);physicalRowIndexes.push(...physicalIndexesInRange.filter((physicalIndex=>hiddenPhysicalRows.includes(physicalIndex))))}}else if(0===renderableStartRow&&renderableStartRow<visualStartRow)physicalRowIndexes.push(...notTrimmedRowIndexes.slice(0,visualStartRow));else if(null===renderableStartRow)physicalRowIndexes.push(...notTrimmedRowIndexes.slice(0,this.countRows()));else{const lastVisualIndex=this.countRows()-1;renderableEndRow===rowIndexMapper.getRenderableFromVisualIndex(rowIndexMapper.getNearestNotHiddenIndex(lastVisualIndex,-1))&&lastVisualIndex>visualEndRow&&physicalRowIndexes.push(...notTrimmedRowIndexes.slice(visualEndRow+1))}return(0,array.z0)(physicalRowIndexes,(physicalRowIndex=>{rows.push(this.toVisualRow(physicalRowIndex))})),0===rows.length}}}(this))}function hiddenRows_onMapInit(){const rows=this.getSetting("rows");Array.isArray(rows)&&this.hideRows(rows)}function manualColumnFreeze_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function manualColumnFreeze_classPrivateFieldGet(s,a){return s.get(manualColumnFreeze_assertClassBrand(s,a))}function manualColumnFreeze_classPrivateFieldSet(s,a,r){return s.set(manualColumnFreeze_assertClassBrand(s,a),r),r}function manualColumnFreeze_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("beforeColumnFreeze"),hooks.R.getSingleton().register("afterColumnFreeze"),hooks.R.getSingleton().register("beforeColumnUnfreeze"),hooks.R.getSingleton().register("afterColumnUnfreeze");var _afterFirstUse=new WeakMap,_ManualColumnFreeze_brand=new WeakSet;class ManualColumnFreeze extends BasePlugin{constructor(){super(...arguments),function manualColumnFreeze_classPrivateMethodInitSpec(e,a){manualColumnFreeze_checkPrivateRedeclaration(e,a),a.add(e)}(this,_ManualColumnFreeze_brand),function manualColumnFreeze_classPrivateFieldInitSpec(e,t,a){manualColumnFreeze_checkPrivateRedeclaration(e,t),t.set(e,a)}(this,_afterFirstUse,!1)}static get PLUGIN_KEY(){return"manualColumnFreeze"}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings().manualColumnFreeze}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(options=>manualColumnFreeze_assertClassBrand(_ManualColumnFreeze_brand,this,_addContextMenuEntry).call(this,options))),this.addHook("beforeColumnMove",((columns,finalIndex)=>manualColumnFreeze_assertClassBrand(_ManualColumnFreeze_brand,this,_onBeforeColumnMove).call(this,columns,finalIndex))),super.enablePlugin())}disablePlugin(){manualColumnFreeze_classPrivateFieldSet(_afterFirstUse,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(column){const settings=this.hot.getSettings(),freezePerformed=settings.fixedColumnsStart<this.hot.countCols()&&column>settings.fixedColumnsStart-1;manualColumnFreeze_classPrivateFieldGet(_afterFirstUse,this)||manualColumnFreeze_classPrivateFieldSet(_afterFirstUse,this,!0);!1!==this.hot.runHooks("beforeColumnFreeze",column,freezePerformed)&&(freezePerformed&&(this.hot.columnIndexMapper.moveIndexes(column,settings.fixedColumnsStart),settings._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",column,freezePerformed))}unfreezeColumn(column){const settings=this.hot.getSettings(),unfreezePerformed=settings.fixedColumnsStart>0&&column<=settings.fixedColumnsStart-1;manualColumnFreeze_classPrivateFieldGet(_afterFirstUse,this)||manualColumnFreeze_classPrivateFieldSet(_afterFirstUse,this,!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",column,unfreezePerformed)&&(unfreezePerformed&&(settings._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(column,settings.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",column,unfreezePerformed))}}function _addContextMenuEntry(options){options.items.push({name:"---------"},function freezeColumnItem(manualColumnFreezePlugin){return{key:"freeze_column",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(key,selected){const[{start:{col:selectedColumn}}]=selected;manualColumnFreezePlugin.freezeColumn(selectedColumn),this.render(),this.view.adjustElementsSize()},hidden(){const selection=this.getSelectedRange();let hide=!1;return(void 0===selection||selection.length>1||selection[0].from.col!==selection[0].to.col||selection[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(hide=!0),hide}}}(this),function unfreezeColumnItem(manualColumnFreezePlugin){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(key,selected){const[{start:{col:selectedColumn}}]=selected;manualColumnFreezePlugin.unfreezeColumn(selectedColumn),this.render(),this.view.adjustElementsSize()},hidden(){const selection=this.getSelectedRange();let hide=!1;return(void 0===selection||selection.length>1||selection[0].from.col!==selection[0].to.col||selection[0].from.col>=this.getSettings().fixedColumnsStart)&&(hide=!0),hide}}}(this))}function _onBeforeColumnMove(columns,finalIndex){if(manualColumnFreeze_classPrivateFieldGet(_afterFirstUse,this)){const freezeLine=this.hot.getSettings().fixedColumnsStart;if(finalIndex<freezeLine)return!1;if(columns.some((column=>column<freezeLine)))return!1}}function manualColumnMove_ui_base_defineProperty(e,r,t){return(r=function manualColumnMove_ui_base_toPropertyKey(t){var i=function manualColumnMove_ui_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const ui_base=class _base_BaseUI{constructor(hotInstance){manualColumnMove_ui_base_defineProperty(this,"hot",void 0),manualColumnMove_ui_base_defineProperty(this,"_element",null),manualColumnMove_ui_base_defineProperty(this,"state",0),manualColumnMove_ui_base_defineProperty(this,"inlineProperty",void 0),this.hot=hotInstance,this.inlineProperty=hotInstance.isRtl()?"right":"left"}appendTo(wrapper){wrapper.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(top,inlinePosition){(0,number.kf)(top)&&(this._element.style.top=top+"px"),(0,number.kf)(inlinePosition)&&(this._element.style[this.inlineProperty]=inlinePosition+"px")}getPosition(){const style=this._element.style;return{top:style.top?parseInt(style.top,10):0,start:style[this.inlineProperty]?parseInt(style[this.inlineProperty],10):0}}setSize(width,height){(0,number.kf)(width)&&(this._element.style.width=width+"px"),(0,number.kf)(height)&&(this._element.style.height=height+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(top,inlineOffset){(0,number.kf)(top)&&(this._element.style.marginTop=top+"px"),(0,number.kf)(inlineOffset)&&(this._element.style[`margin${(0,string.Ob)(this.inlineProperty)}`]=inlineOffset+"px")}getOffset(){const style=this._element.style,inlineProp=`margin${(0,string.Ob)(this.inlineProperty)}`;return{top:style.marginTop?parseInt(style.marginTop,10):0,start:style[inlineProp]?parseInt(style[inlineProp],10):0}}};const backlight=class BacklightUI extends ui_base{build(){super.build(),(0,dom_element.iQ)(this._element,"ht__manualColumnMove--backlight")}};const guideline=class GuidelineUI extends ui_base{build(){super.build(),(0,dom_element.iQ)(this._element,"ht__manualColumnMove--guideline")}};function manualColumnMove_classPrivateFieldInitSpec(e,t,a){manualColumnMove_checkPrivateRedeclaration(e,t),t.set(e,a)}function manualColumnMove_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function manualColumnMove_classPrivateFieldSet(s,a,r){return s.set(manualColumnMove_assertClassBrand(s,a),r),r}function manualColumnMove_classPrivateFieldGet(s,a){return s.get(manualColumnMove_assertClassBrand(s,a))}function manualColumnMove_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("beforeColumnMove"),hooks.R.getSingleton().register("afterColumnMove");var _backlight=new WeakMap,_guideline=new WeakMap,_columnsToMove=new WeakMap,_countCols=new WeakMap,_pressed=new WeakMap,_target=new WeakMap,_cachedDropIndex=new WeakMap,_hoveredColumn=new WeakMap,_rootElementOffset=new WeakMap,_hasRowHeaders=new WeakMap,_fixedColumnsStart=new WeakMap,_ManualColumnMove_brand=new WeakSet;class ManualColumnMove extends BasePlugin{constructor(){super(...arguments),function manualColumnMove_classPrivateMethodInitSpec(e,a){manualColumnMove_checkPrivateRedeclaration(e,a),a.add(e)}(this,_ManualColumnMove_brand),manualColumnMove_classPrivateFieldInitSpec(this,_backlight,new backlight(this.hot)),manualColumnMove_classPrivateFieldInitSpec(this,_guideline,new guideline(this.hot)),manualColumnMove_classPrivateFieldInitSpec(this,_columnsToMove,[]),manualColumnMove_classPrivateFieldInitSpec(this,_countCols,0),manualColumnMove_classPrivateFieldInitSpec(this,_pressed,!1),manualColumnMove_classPrivateFieldInitSpec(this,_target,{}),manualColumnMove_classPrivateFieldInitSpec(this,_cachedDropIndex,void 0),manualColumnMove_classPrivateFieldInitSpec(this,_hoveredColumn,void 0),manualColumnMove_classPrivateFieldInitSpec(this,_rootElementOffset,void 0),manualColumnMove_classPrivateFieldInitSpec(this,_hasRowHeaders,void 0),manualColumnMove_classPrivateFieldInitSpec(this,_fixedColumnsStart,void 0)}static get PLUGIN_KEY(){return"manualColumnMove"}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings().manualColumnMove}enablePlugin(){var _this=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return manualColumnMove_assertClassBrand(_ManualColumnMove_brand,_this,manualColumnMove_onBeforeOnCellMouseDown).call(_this,...args)})),this.addHook("beforeOnCellMouseOver",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return manualColumnMove_assertClassBrand(_ManualColumnMove_brand,_this,_onBeforeOnCellMouseOver).call(_this,...args)})),this.addHook("afterScrollVertically",(()=>manualColumnMove_assertClassBrand(_ManualColumnMove_brand,this,_onAfterScrollVertically).call(this))),this.addHook("afterLoadData",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return manualColumnMove_assertClassBrand(_ManualColumnMove_brand,_this,manualColumnMove_onAfterLoadData).call(_this,...args)})),this.buildPluginUI(),this.registerEvents(),(0,dom_element.iQ)(this.hot.rootElement,"ht__manualColumnMove"),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,dom_element.vy)(this.hot.rootElement,"ht__manualColumnMove"),this.unregisterEvents(),manualColumnMove_classPrivateFieldGet(_backlight,this).destroy(),manualColumnMove_classPrivateFieldGet(_guideline,this).destroy(),super.disablePlugin()}moveColumn(column,finalIndex){return this.moveColumns([column],finalIndex)}moveColumns(columns,finalIndex){const dropIndex=manualColumnMove_classPrivateFieldGet(_cachedDropIndex,this),movePossible=this.isMovePossible(columns,finalIndex),beforeMoveHook=this.hot.runHooks("beforeColumnMove",columns,finalIndex,dropIndex,movePossible);if(manualColumnMove_classPrivateFieldSet(_cachedDropIndex,this,void 0),!1===beforeMoveHook)return;movePossible&&this.hot.columnIndexMapper.moveIndexes(columns,finalIndex);const movePerformed=movePossible&&this.isColumnOrderChanged(columns,finalIndex);return this.hot.runHooks("afterColumnMove",columns,finalIndex,dropIndex,movePossible,movePerformed),movePerformed}dragColumn(column,dropIndex){return this.dragColumns([column],dropIndex)}dragColumns(columns,dropIndex){const finalIndex=this.countFinalIndex(columns,dropIndex);return manualColumnMove_classPrivateFieldSet(_cachedDropIndex,this,dropIndex),this.moveColumns(columns,finalIndex)}isMovePossible(movedColumns,finalIndex){const length=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),tooHighDestinationIndex=movedColumns.length+finalIndex>length,tooLowDestinationIndex=finalIndex<0,tooLowMovedColumnIndex=movedColumns.some((movedColumn=>movedColumn<0)),tooHighMovedColumnIndex=movedColumns.some((movedColumn=>movedColumn>=length));return!(tooHighDestinationIndex||tooLowDestinationIndex||tooLowMovedColumnIndex||tooHighMovedColumnIndex)}isColumnOrderChanged(movedColumns,finalIndex){return movedColumns.some(((column,nrOfMovedElement)=>column-nrOfMovedElement!==finalIndex))}countFinalIndex(movedColumns,dropIndex){const numberOfColumnsLowerThanDropIndex=(0,array.mu)(movedColumns,((numberOfColumns,currentColumnIndex)=>(currentColumnIndex<dropIndex&&(numberOfColumns+=1),numberOfColumns)),0);return dropIndex-numberOfColumnsLowerThanDropIndex}getColumnsWidth(fromColumn,toColumn){const columnMapper=this.hot.columnIndexMapper;let columnsWidth=0;for(let visualColumnIndex=fromColumn;visualColumnIndex<=toColumn;visualColumnIndex+=1){const renderableIndex=columnMapper.getRenderableFromVisualIndex(visualColumnIndex);visualColumnIndex<0?columnsWidth+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==renderableIndex&&(columnsWidth+=this.hot.view._wt.wtTable.getColumnWidth(renderableIndex)||0)}return columnsWidth}moveBySettingsOrLoad(){const pluginSettings=this.hot.getSettings().manualColumnMove;if(Array.isArray(pluginSettings))this.moveColumns(pluginSettings,0);else if(void 0!==pluginSettings){const persistentState=this.persistentStateLoad();persistentState.length&&this.moveColumns(persistentState,0)}}isFixedColumnsStart(column){return column<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const storedState={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",storedState),storedState.value?storedState.value:[]}prepareColumnsToMoving(start,end){const selectedColumns=[];return(0,number.Ti)(start,end,(i=>{selectedColumns.push(i)})),selectedColumns}refreshPositions(){const firstVisible=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(manualColumnMove_classPrivateFieldGet(_hoveredColumn,this))&&firstVisible>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(firstVisible-1,-1)});const wtTable=this.hot.view._wt.wtTable,scrollableElement=this.hot.view._wt.wtOverlays.scrollableElement,scrollStart="number"==typeof scrollableElement.scrollX?scrollableElement.scrollX:scrollableElement.scrollLeft;let tdOffsetStart=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,manualColumnMove_classPrivateFieldGet(_hoveredColumn,this)-1);const hiderWidth=wtTable.hider.offsetWidth,tbodyOffsetLeft=wtTable.TBODY.offsetLeft,backlightElemMarginStart=manualColumnMove_classPrivateFieldGet(_backlight,this).getOffset().start,backlightElemWidth=manualColumnMove_classPrivateFieldGet(_backlight,this).getSize().width;let rowHeaderWidth=0,mouseOffsetStart=0;if(this.hot.isRtl()){const rootWindow=this.hot.rootWindow,containerWidth=(0,dom_element.Gq)(this.hot.rootElement),gridMostRightPos=rootWindow.innerWidth-manualColumnMove_classPrivateFieldGet(_rootElementOffset,this)-containerWidth;mouseOffsetStart=rootWindow.innerWidth-manualColumnMove_classPrivateFieldGet(_target,this).eventPageX-gridMostRightPos-(void 0===scrollableElement.scrollX?scrollStart:0)}else mouseOffsetStart=manualColumnMove_classPrivateFieldGet(_target,this).eventPageX-(manualColumnMove_classPrivateFieldGet(_rootElementOffset,this)-(void 0===scrollableElement.scrollX?scrollStart:0));if(manualColumnMove_classPrivateFieldGet(_hasRowHeaders,this)&&(rowHeaderWidth=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(manualColumnMove_classPrivateFieldGet(_hoveredColumn,this))&&(tdOffsetStart+=scrollStart),tdOffsetStart+=rowHeaderWidth,manualColumnMove_classPrivateFieldGet(_hoveredColumn,this)<0)manualColumnMove_classPrivateFieldGet(_fixedColumnsStart,this)>0?manualColumnMove_classPrivateFieldGet(_target,this).col=0:manualColumnMove_classPrivateFieldGet(_target,this).col=firstVisible>0?firstVisible-1:firstVisible;else if(manualColumnMove_classPrivateFieldGet(_target,this).TD.offsetWidth/2+tdOffsetStart<=mouseOffsetStart){const newCoordsCol=manualColumnMove_classPrivateFieldGet(_hoveredColumn,this)>=manualColumnMove_classPrivateFieldGet(_countCols,this)?manualColumnMove_classPrivateFieldGet(_countCols,this)-1:manualColumnMove_classPrivateFieldGet(_hoveredColumn,this);manualColumnMove_classPrivateFieldGet(_target,this).col=newCoordsCol+1,tdOffsetStart+=manualColumnMove_classPrivateFieldGet(_target,this).TD.offsetWidth}else manualColumnMove_classPrivateFieldGet(_target,this).col=manualColumnMove_classPrivateFieldGet(_hoveredColumn,this);let backlightStart=mouseOffsetStart,guidelineStart=tdOffsetStart;mouseOffsetStart+backlightElemWidth+backlightElemMarginStart>=hiderWidth?backlightStart=hiderWidth-backlightElemWidth-backlightElemMarginStart:mouseOffsetStart+backlightElemMarginStart<tbodyOffsetLeft+rowHeaderWidth&&(backlightStart=tbodyOffsetLeft+rowHeaderWidth+Math.abs(backlightElemMarginStart)),tdOffsetStart>=hiderWidth-1?guidelineStart=hiderWidth-1:0===guidelineStart?guidelineStart=1:void 0!==scrollableElement.scrollX&&manualColumnMove_classPrivateFieldGet(_hoveredColumn,this)<manualColumnMove_classPrivateFieldGet(_fixedColumnsStart,this)&&(guidelineStart-=manualColumnMove_classPrivateFieldGet(_rootElementOffset,this)<=scrollableElement.scrollX?manualColumnMove_classPrivateFieldGet(_rootElementOffset,this):0),manualColumnMove_classPrivateFieldGet(_backlight,this).setPosition(null,backlightStart),manualColumnMove_classPrivateFieldGet(_guideline,this).setPosition(null,guidelineStart)}registerEvents(){const{documentElement}=this.hot.rootDocument;this.eventManager.addEventListener(documentElement,"mousemove",(event=>manualColumnMove_assertClassBrand(_ManualColumnMove_brand,this,manualColumnMove_onMouseMove).call(this,event))),this.eventManager.addEventListener(documentElement,"mouseup",(()=>manualColumnMove_assertClassBrand(_ManualColumnMove_brand,this,manualColumnMove_onMouseUp).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){manualColumnMove_classPrivateFieldGet(_backlight,this).build(),manualColumnMove_classPrivateFieldGet(_guideline,this).build()}destroy(){manualColumnMove_classPrivateFieldGet(_backlight,this).destroy(),manualColumnMove_classPrivateFieldGet(_guideline,this).destroy(),super.destroy()}}function manualColumnMove_onBeforeOnCellMouseDown(event,coords,TD,controller){const wtTable=this.hot.view._wt.wtTable,isHeaderSelection=this.hot.selection.isSelectedByColumnHeader(),selection=this.hot.getSelectedRangeLast(),isSortingElement=(0,dom_element.nB)(event.target,"sortAction");if(!selection||!isHeaderSelection||manualColumnMove_classPrivateFieldGet(_pressed,this)||0!==event.button||isSortingElement)return manualColumnMove_classPrivateFieldSet(_pressed,this,!1),manualColumnMove_classPrivateFieldGet(_columnsToMove,this).length=0,void(0,dom_element.vy)(this.hot.rootElement,["on-moving--columns","show-ui"]);const guidelineIsNotReady=manualColumnMove_classPrivateFieldGet(_guideline,this).isBuilt()&&!manualColumnMove_classPrivateFieldGet(_guideline,this).isAppended(),backlightIsNotReady=manualColumnMove_classPrivateFieldGet(_backlight,this).isBuilt()&&!manualColumnMove_classPrivateFieldGet(_backlight,this).isAppended();guidelineIsNotReady&&backlightIsNotReady&&(manualColumnMove_classPrivateFieldGet(_guideline,this).appendTo(wtTable.hider),manualColumnMove_classPrivateFieldGet(_backlight,this).appendTo(wtTable.hider));const{from,to}=selection,start=Math.min(from.col,to.col),end=Math.max(from.col,to.col);if(coords.row<0&&coords.col>=start&&coords.col<=end){controller.column=!0,manualColumnMove_classPrivateFieldSet(_pressed,this,!0);const eventOffsetX=TD.firstChild?(0,dom_event.zg)(event,TD.firstChild).x:event.offsetX;manualColumnMove_classPrivateFieldGet(_target,this).eventPageX=event.pageX,manualColumnMove_classPrivateFieldSet(_hoveredColumn,this,coords.col),manualColumnMove_classPrivateFieldGet(_target,this).TD=TD,manualColumnMove_classPrivateFieldGet(_target,this).col=coords.col,manualColumnMove_classPrivateFieldSet(_columnsToMove,this,this.prepareColumnsToMoving(start,end)),manualColumnMove_classPrivateFieldSet(_hasRowHeaders,this,!!this.hot.getSettings().rowHeaders),manualColumnMove_classPrivateFieldSet(_countCols,this,this.hot.countCols()),manualColumnMove_classPrivateFieldSet(_fixedColumnsStart,this,this.hot.getSettings().fixedColumnsStart),manualColumnMove_classPrivateFieldSet(_rootElementOffset,this,(0,dom_element.cY)(this.hot.rootElement).left);const countColumnsFrom=manualColumnMove_classPrivateFieldGet(_hasRowHeaders,this)?-1:0,topPos=wtTable.holder.scrollTop+wtTable.getColumnHeaderHeight(0)+1,fixedColumnsStart=coords.col<manualColumnMove_classPrivateFieldGet(_fixedColumnsStart,this),horizontalScrollPosition=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),offsetX=Math.abs(eventOffsetX-(this.hot.isRtl()?TD.offsetWidth:0)),inlineOffset=this.getColumnsWidth(start,coords.col-1)+offsetX,inlinePos=this.getColumnsWidth(countColumnsFrom,start-1)+(fixedColumnsStart?horizontalScrollPosition:0)+inlineOffset;manualColumnMove_classPrivateFieldGet(_backlight,this).setPosition(topPos,inlinePos),manualColumnMove_classPrivateFieldGet(_backlight,this).setSize(this.getColumnsWidth(start,end),wtTable.hider.offsetHeight-topPos),manualColumnMove_classPrivateFieldGet(_backlight,this).setOffset(null,-inlineOffset),(0,dom_element.iQ)(this.hot.rootElement,"on-moving--columns")}else(0,dom_element.vy)(this.hot.rootElement,"after-selection--columns"),manualColumnMove_classPrivateFieldSet(_pressed,this,!1),manualColumnMove_classPrivateFieldGet(_columnsToMove,this).length=0}function manualColumnMove_onMouseMove(event){manualColumnMove_classPrivateFieldGet(_pressed,this)&&(manualColumnMove_classPrivateFieldGet(_target,this).eventPageX=event.pageX,this.refreshPositions())}function _onBeforeOnCellMouseOver(event,coords,TD,controller){this.hot.getSelectedRangeLast()&&manualColumnMove_classPrivateFieldGet(_pressed,this)&&(manualColumnMove_classPrivateFieldGet(_columnsToMove,this).indexOf(coords.col)>-1?(0,dom_element.vy)(this.hot.rootElement,"show-ui"):(0,dom_element.iQ)(this.hot.rootElement,"show-ui"),controller.row=!0,controller.column=!0,controller.cell=!0,manualColumnMove_classPrivateFieldSet(_hoveredColumn,this,coords.col),manualColumnMove_classPrivateFieldGet(_target,this).TD=TD)}function manualColumnMove_onMouseUp(){const target=manualColumnMove_classPrivateFieldGet(_target,this).col,columnsLen=manualColumnMove_classPrivateFieldGet(_columnsToMove,this).length;if(manualColumnMove_classPrivateFieldSet(_hoveredColumn,this,void 0),manualColumnMove_classPrivateFieldSet(_pressed,this,!1),(0,dom_element.vy)(this.hot.rootElement,["on-moving--columns","show-ui","after-selection--columns"]),this.hot.selection.isSelectedByColumnHeader()&&(0,dom_element.iQ)(this.hot.rootElement,"after-selection--columns"),columnsLen<1||void 0===target)return;const firstMovedVisualColumn=manualColumnMove_classPrivateFieldGet(_columnsToMove,this)[0],firstMovedPhysicalColumn=this.hot.toPhysicalColumn(firstMovedVisualColumn),movePerformed=this.dragColumns(manualColumnMove_classPrivateFieldGet(_columnsToMove,this),target);if(manualColumnMove_classPrivateFieldGet(_columnsToMove,this).length=0,!0===movePerformed){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const selectionStart=this.hot.toVisualColumn(firstMovedPhysicalColumn),selectionEnd=selectionStart+columnsLen-1;this.hot.selectColumns(selectionStart,selectionEnd)}}function _onAfterScrollVertically(){const wtTable=this.hot.view._wt.wtTable,posTop=wtTable.getColumnHeaderHeight(0)+1+wtTable.holder.scrollTop;manualColumnMove_classPrivateFieldGet(_backlight,this).setPosition(posTop),manualColumnMove_classPrivateFieldGet(_backlight,this).setSize(null,wtTable.hider.offsetHeight-posTop)}function manualColumnMove_onAfterLoadData(){this.moveBySettingsOrLoad()}function manualColumnResize_classPrivateFieldInitSpec(e,t,a){manualColumnResize_checkPrivateRedeclaration(e,t),t.set(e,a)}function manualColumnResize_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function manualColumnResize_classPrivateFieldSet(s,a,r){return s.set(manualColumnResize_assertClassBrand(s,a),r),r}function manualColumnResize_classPrivateFieldGet(s,a){return s.get(manualColumnResize_assertClassBrand(s,a))}function manualColumnResize_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _currentTH=new WeakMap,_currentCol=new WeakMap,_selectedCols=new WeakMap,_currentWidth=new WeakMap,_newSize=new WeakMap,_startY=new WeakMap,_startWidth=new WeakMap,_startOffset=new WeakMap,_handle=new WeakMap,_guide=new WeakMap,manualColumnResize_pressed=new WeakMap,_isTriggeredByRMB=new WeakMap,_dblclick=new WeakMap,_autoresizeTimeout=new WeakMap,_columnWidthsMap=new WeakMap,_config=new WeakMap,_ManualColumnResize_brand=new WeakSet;class ManualColumnResize extends BasePlugin{static get PLUGIN_KEY(){return"manualColumnResize"}static get PLUGIN_PRIORITY(){return 130}constructor(hotInstance){super(hotInstance),function manualColumnResize_classPrivateMethodInitSpec(e,a){manualColumnResize_checkPrivateRedeclaration(e,a),a.add(e)}(this,_ManualColumnResize_brand),manualColumnResize_classPrivateFieldInitSpec(this,_currentTH,null),manualColumnResize_classPrivateFieldInitSpec(this,_currentCol,null),manualColumnResize_classPrivateFieldInitSpec(this,_selectedCols,[]),manualColumnResize_classPrivateFieldInitSpec(this,_currentWidth,null),manualColumnResize_classPrivateFieldInitSpec(this,_newSize,null),manualColumnResize_classPrivateFieldInitSpec(this,_startY,null),manualColumnResize_classPrivateFieldInitSpec(this,_startWidth,null),manualColumnResize_classPrivateFieldInitSpec(this,_startOffset,null),manualColumnResize_classPrivateFieldInitSpec(this,_handle,this.hot.rootDocument.createElement("DIV")),manualColumnResize_classPrivateFieldInitSpec(this,_guide,this.hot.rootDocument.createElement("DIV")),manualColumnResize_classPrivateFieldInitSpec(this,manualColumnResize_pressed,null),manualColumnResize_classPrivateFieldInitSpec(this,_isTriggeredByRMB,!1),manualColumnResize_classPrivateFieldInitSpec(this,_dblclick,0),manualColumnResize_classPrivateFieldInitSpec(this,_autoresizeTimeout,null),manualColumnResize_classPrivateFieldInitSpec(this,_columnWidthsMap,void 0),manualColumnResize_classPrivateFieldInitSpec(this,_config,void 0),(0,dom_element.iQ)(manualColumnResize_classPrivateFieldGet(_handle,this),"manualColumnResizer"),(0,dom_element.iQ)(manualColumnResize_classPrivateFieldGet(_guide,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings().manualColumnResize}enablePlugin(){var _this=this;this.enabled||(manualColumnResize_classPrivateFieldSet(_columnWidthsMap,this,new physicalIndexToValueMap._),manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).addLocalHook("init",(()=>manualColumnResize_assertClassBrand(_ManualColumnResize_brand,this,manualColumnResize_onMapInit).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this)),this.addHook("modifyColWidth",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return manualColumnResize_assertClassBrand(_ManualColumnResize_brand,_this,manualColumnResize_onModifyColWidth).call(_this,...args)}),1),this.addHook("beforeStretchingColumnWidth",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return manualColumnResize_assertClassBrand(_ManualColumnResize_brand,_this,_onBeforeStretchingColumnWidth).call(_this,...args)}),1),this.addHook("beforeColumnResize",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return manualColumnResize_assertClassBrand(_ManualColumnResize_brand,_this,manualColumnResize_onBeforeColumnResize).call(_this,...args)})),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){manualColumnResize_classPrivateFieldSet(_config,this,manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave","manualColumnWidths",manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).getValues())}loadManualColumnWidths(){const storedState={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",storedState),storedState.value}setManualSize(column,width){const newWidth=Math.max(width,20),physicalColumn=this.hot.toPhysicalColumn(column);return manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).setValueAtIndex(physicalColumn,newWidth),newWidth}clearManualSize(column){const physicalColumn=this.hot.toPhysicalColumn(column);manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).setValueAtIndex(physicalColumn,null)}setupHandlePosition(TH){if(!TH.parentNode)return;manualColumnResize_classPrivateFieldSet(_currentTH,this,TH);const{_wt:wt}=this.hot.view,cellCoords=wt.wtTable.getCoords(manualColumnResize_classPrivateFieldGet(_currentTH,this)),col=cellCoords.col;if(col<0)return;const headerHeight=(0,dom_element.DK)(manualColumnResize_classPrivateFieldGet(_currentTH,this)),box=manualColumnResize_classPrivateFieldGet(_currentTH,this).getBoundingClientRect();let relativeHeaderPosition;col<wt.getSetting("fixedColumnsStart")&&(relativeHeaderPosition=wt.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(manualColumnResize_classPrivateFieldGet(_currentTH,this),cellCoords.row,cellCoords.col)),relativeHeaderPosition||(relativeHeaderPosition=wt.wtOverlays.topOverlay.getRelativeCellPosition(manualColumnResize_classPrivateFieldGet(_currentTH,this),cellCoords.row,cellCoords.col)),manualColumnResize_classPrivateFieldSet(_currentCol,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(col)),manualColumnResize_classPrivateFieldSet(_selectedCols,this,[]);const isFullColumnSelected=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&isFullColumnSelected){const selectionRanges=this.hot.getSelectedRange();(0,array.z0)(selectionRanges,(selectionRange=>{const fromColumn=selectionRange.getTopStartCorner().col,toColumn=selectionRange.getBottomEndCorner().col;(0,number.Ti)(fromColumn,toColumn,(columnIndex=>{manualColumnResize_classPrivateFieldGet(_selectedCols,this).includes(columnIndex)||manualColumnResize_classPrivateFieldGet(_selectedCols,this).push(columnIndex)}))}))}manualColumnResize_classPrivateFieldGet(_selectedCols,this).includes(manualColumnResize_classPrivateFieldGet(_currentCol,this))||manualColumnResize_classPrivateFieldSet(_selectedCols,this,[manualColumnResize_classPrivateFieldGet(_currentCol,this)]),manualColumnResize_classPrivateFieldSet(_startOffset,this,relativeHeaderPosition.start-6),manualColumnResize_classPrivateFieldSet(_startWidth,this,parseInt(box.width,10)),manualColumnResize_classPrivateFieldGet(_handle,this).style.top=`${relativeHeaderPosition.top}px`,manualColumnResize_classPrivateFieldGet(_handle,this).style[this.inlineDir]=`${manualColumnResize_classPrivateFieldGet(_startOffset,this)+manualColumnResize_classPrivateFieldGet(_startWidth,this)}px`,manualColumnResize_classPrivateFieldGet(_handle,this).style.height=`${headerHeight}px`,this.hot.rootElement.appendChild(manualColumnResize_classPrivateFieldGet(_handle,this))}refreshHandlePosition(){manualColumnResize_classPrivateFieldGet(_handle,this).style[this.inlineDir]=`${manualColumnResize_classPrivateFieldGet(_startOffset,this)+manualColumnResize_classPrivateFieldGet(_currentWidth,this)}px`}setupGuidePosition(){const handleHeight=parseInt((0,dom_element.DK)(manualColumnResize_classPrivateFieldGet(_handle,this)),10),handleBottomPosition=parseInt(manualColumnResize_classPrivateFieldGet(_handle,this).style.top,10)+handleHeight,maximumVisibleElementHeight=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,dom_element.iQ)(manualColumnResize_classPrivateFieldGet(_handle,this),"active"),(0,dom_element.iQ)(manualColumnResize_classPrivateFieldGet(_guide,this),"active"),manualColumnResize_classPrivateFieldGet(_guide,this).style.top=`${handleBottomPosition}px`,this.refreshGuidePosition(),manualColumnResize_classPrivateFieldGet(_guide,this).style.height=maximumVisibleElementHeight-handleHeight+"px",this.hot.rootElement.appendChild(manualColumnResize_classPrivateFieldGet(_guide,this))}refreshGuidePosition(){manualColumnResize_classPrivateFieldGet(_guide,this).style[this.inlineDir]=manualColumnResize_classPrivateFieldGet(_handle,this).style[this.inlineDir]}hideHandleAndGuide(){(0,dom_element.vy)(manualColumnResize_classPrivateFieldGet(_handle,this),"active"),(0,dom_element.vy)(manualColumnResize_classPrivateFieldGet(_guide,this),"active")}checkIfColumnHeader(element){const thead=(0,dom_element.kp)(element,["THEAD"],this.hot.rootElement),{topOverlay,topInlineStartCornerOverlay}=this.hot.view._wt.wtOverlays;return[topOverlay.clone.wtTable.THEAD,topInlineStartCornerOverlay.clone.wtTable.THEAD].includes(thead)}getClosestTHParent(element){return"TABLE"!==element.tagName?"TH"===element.tagName?element:this.getClosestTHParent(element.parentNode):null}afterMouseDownTimeout(){const render=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},resize=(column,forceRender)=>{const hookNewSize=this.hot.runHooks("beforeColumnResize",manualColumnResize_classPrivateFieldGet(_newSize,this),column,!0);void 0!==hookNewSize&&manualColumnResize_classPrivateFieldSet(_newSize,this,hookNewSize),this.setManualSize(column,manualColumnResize_classPrivateFieldGet(_newSize,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",manualColumnResize_classPrivateFieldGet(_newSize,this),column,!0),forceRender&&render()};if(manualColumnResize_classPrivateFieldGet(_dblclick,this)>=2){manualColumnResize_classPrivateFieldGet(_selectedCols,this).length>1?((0,array.z0)(manualColumnResize_classPrivateFieldGet(_selectedCols,this),(selectedCol=>{resize(selectedCol)})),render()):(0,array.z0)(manualColumnResize_classPrivateFieldGet(_selectedCols,this),(selectedCol=>{resize(selectedCol,!0)}))}manualColumnResize_classPrivateFieldSet(_dblclick,this,0),manualColumnResize_classPrivateFieldSet(_autoresizeTimeout,this,null)}bindEvents(){const{rootWindow,rootElement}=this.hot;this.eventManager.addEventListener(rootElement,"mouseover",(e=>manualColumnResize_assertClassBrand(_ManualColumnResize_brand,this,manualColumnResize_onMouseOver).call(this,e))),this.eventManager.addEventListener(rootElement,"mousedown",(e=>manualColumnResize_assertClassBrand(_ManualColumnResize_brand,this,manualColumnResize_onMouseDown).call(this,e))),this.eventManager.addEventListener(rootWindow,"mousemove",(e=>manualColumnResize_assertClassBrand(_ManualColumnResize_brand,this,manualColumnResize_onMouseMove).call(this,e))),this.eventManager.addEventListener(rootWindow,"mouseup",(()=>manualColumnResize_assertClassBrand(_ManualColumnResize_brand,this,manualColumnResize_onMouseUp).call(this))),this.eventManager.addEventListener(manualColumnResize_classPrivateFieldGet(_handle,this),"contextmenu",(()=>manualColumnResize_assertClassBrand(_ManualColumnResize_brand,this,_onContextMenu).call(this)))}destroy(){super.destroy()}}function manualColumnResize_onMapInit(){const initialSetting=this.hot.getSettings().manualColumnResize,loadedManualColumnWidths=this.loadManualColumnWidths();void 0!==loadedManualColumnWidths?this.hot.batchExecution((()=>{loadedManualColumnWidths.forEach(((width,physicalIndex)=>{manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).setValueAtIndex(physicalIndex,width)}))}),!0):Array.isArray(initialSetting)?(this.hot.batchExecution((()=>{initialSetting.forEach(((width,physicalIndex)=>{manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).setValueAtIndex(physicalIndex,width)}))}),!0),manualColumnResize_classPrivateFieldSet(_config,this,initialSetting)):!0===initialSetting&&Array.isArray(manualColumnResize_classPrivateFieldGet(_config,this))&&this.hot.batchExecution((()=>{manualColumnResize_classPrivateFieldGet(_config,this).forEach(((width,physicalIndex)=>{manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).setValueAtIndex(physicalIndex,width)}))}),!0)}function manualColumnResize_onMouseOver(event){if(!(0,dom_element.$w)(event.target)&&!0!==manualColumnResize_classPrivateFieldGet(_isTriggeredByRMB,this)&&this.checkIfColumnHeader(event.target)){const th=this.getClosestTHParent(event.target);if(!th)return;const colspan=th.getAttribute("colspan");!th||null!==colspan&&"1"!==colspan||manualColumnResize_classPrivateFieldGet(manualColumnResize_pressed,this)||this.setupHandlePosition(th)}}function manualColumnResize_onMouseDown(event){event.target.parentNode===this.hot.rootElement&&(0,dom_element.nB)(event.target,"manualColumnResizer")&&(this.setupHandlePosition(manualColumnResize_classPrivateFieldGet(_currentTH,this)),this.setupGuidePosition(),manualColumnResize_classPrivateFieldSet(manualColumnResize_pressed,this,!0),null===manualColumnResize_classPrivateFieldGet(_autoresizeTimeout,this)&&(manualColumnResize_classPrivateFieldSet(_autoresizeTimeout,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(manualColumnResize_classPrivateFieldGet(_autoresizeTimeout,this))),manualColumnResize_classPrivateFieldSet(_dblclick,this,manualColumnResize_classPrivateFieldGet(_dblclick,this)+1),this.startX=event.pageX,manualColumnResize_classPrivateFieldSet(_newSize,this,manualColumnResize_classPrivateFieldGet(_startWidth,this)))}function manualColumnResize_onMouseMove(event){if(manualColumnResize_classPrivateFieldGet(manualColumnResize_pressed,this)){const change=(event.pageX-this.startX)*this.hot.getDirectionFactor();manualColumnResize_classPrivateFieldSet(_currentWidth,this,manualColumnResize_classPrivateFieldGet(_startWidth,this)+change),(0,array.z0)(manualColumnResize_classPrivateFieldGet(_selectedCols,this),(selectedCol=>{manualColumnResize_classPrivateFieldSet(_newSize,this,this.setManualSize(selectedCol,manualColumnResize_classPrivateFieldGet(_currentWidth,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function manualColumnResize_onMouseUp(){const render=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},resize=(column,forceRender)=>{this.hot.runHooks("beforeColumnResize",manualColumnResize_classPrivateFieldGet(_newSize,this),column,!1),forceRender&&render(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",manualColumnResize_classPrivateFieldGet(_newSize,this),column,!1)};if(manualColumnResize_classPrivateFieldGet(manualColumnResize_pressed,this)){if(this.hideHandleAndGuide(),manualColumnResize_classPrivateFieldSet(manualColumnResize_pressed,this,!1),manualColumnResize_classPrivateFieldGet(_newSize,this)!==manualColumnResize_classPrivateFieldGet(_startWidth,this)){manualColumnResize_classPrivateFieldGet(_selectedCols,this).length>1?((0,array.z0)(manualColumnResize_classPrivateFieldGet(_selectedCols,this),(selectedCol=>{resize(selectedCol)})),render()):(0,array.z0)(manualColumnResize_classPrivateFieldGet(_selectedCols,this),(selectedCol=>{resize(selectedCol,!0)}))}this.setupHandlePosition(manualColumnResize_classPrivateFieldGet(_currentTH,this))}}function _onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(manualColumnResize_classPrivateFieldGet(_handle,this)),this.hot.rootElement.removeChild(manualColumnResize_classPrivateFieldGet(_guide,this)),manualColumnResize_classPrivateFieldSet(manualColumnResize_pressed,this,!1),manualColumnResize_classPrivateFieldSet(_isTriggeredByRMB,this,!0),this.hot._registerImmediate((()=>{manualColumnResize_classPrivateFieldSet(_isTriggeredByRMB,this,!1)}))}function manualColumnResize_onModifyColWidth(width,column){let newWidth=width;if(this.enabled){const physicalColumn=this.hot.toPhysicalColumn(column),columnWidth=manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).getValueAtIndex(physicalColumn);this.hot.getSettings().manualColumnResize&&columnWidth&&(newWidth=columnWidth)}return newWidth}function _onBeforeStretchingColumnWidth(stretchedWidth,column){const width=manualColumnResize_classPrivateFieldGet(_columnWidthsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(column));return"number"==typeof width?width:stretchedWidth}function manualColumnResize_onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function manualRowMove_ui_base_defineProperty(e,r,t){return(r=function manualRowMove_ui_base_toPropertyKey(t){var i=function manualRowMove_ui_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const manualRowMove_ui_base=class ui_base_BaseUI{constructor(hotInstance){manualRowMove_ui_base_defineProperty(this,"hot",void 0),manualRowMove_ui_base_defineProperty(this,"_element",null),manualRowMove_ui_base_defineProperty(this,"state",0),this.hot=hotInstance}appendTo(wrapper){wrapper.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(top,left){void 0!==top&&(this._element.style.top=top+"px"),void 0!==left&&(this._element.style.left=left+"px")}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(width,height){width&&(this._element.style.width=width+"px"),height&&(this._element.style.height=height+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(top,left){top&&(this._element.style.marginTop=top+"px"),left&&(this._element.style.marginLeft=left+"px")}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const ui_backlight=class backlight_BacklightUI extends manualRowMove_ui_base{build(){super.build(),(0,dom_element.iQ)(this._element,"ht__manualRowMove--backlight")}};const ui_guideline=class guideline_GuidelineUI extends manualRowMove_ui_base{build(){super.build(),(0,dom_element.iQ)(this._element,"ht__manualRowMove--guideline")}};function manualRowMove_classPrivateFieldInitSpec(e,t,a){manualRowMove_checkPrivateRedeclaration(e,t),t.set(e,a)}function manualRowMove_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function manualRowMove_classPrivateFieldSet(s,a,r){return s.set(manualRowMove_assertClassBrand(s,a),r),r}function manualRowMove_classPrivateFieldGet(s,a){return s.get(manualRowMove_assertClassBrand(s,a))}function manualRowMove_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("beforeRowMove"),hooks.R.getSingleton().register("afterRowMove");var manualRowMove_backlight=new WeakMap,manualRowMove_guideline=new WeakMap,_rowsToMove=new WeakMap,manualRowMove_pressed=new WeakMap,manualRowMove_target=new WeakMap,manualRowMove_cachedDropIndex=new WeakMap,_ManualRowMove_brand=new WeakSet;class ManualRowMove extends BasePlugin{constructor(){super(...arguments),function manualRowMove_classPrivateMethodInitSpec(e,a){manualRowMove_checkPrivateRedeclaration(e,a),a.add(e)}(this,_ManualRowMove_brand),manualRowMove_classPrivateFieldInitSpec(this,manualRowMove_backlight,new ui_backlight(this.hot)),manualRowMove_classPrivateFieldInitSpec(this,manualRowMove_guideline,new ui_guideline(this.hot)),manualRowMove_classPrivateFieldInitSpec(this,_rowsToMove,[]),manualRowMove_classPrivateFieldInitSpec(this,manualRowMove_pressed,void 0),manualRowMove_classPrivateFieldInitSpec(this,manualRowMove_target,{}),manualRowMove_classPrivateFieldInitSpec(this,manualRowMove_cachedDropIndex,void 0)}static get PLUGIN_KEY(){return"manualRowMove"}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings().manualRowMove}enablePlugin(){var _this=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return manualRowMove_assertClassBrand(_ManualRowMove_brand,_this,manualRowMove_onBeforeOnCellMouseDown).call(_this,...args)})),this.addHook("beforeOnCellMouseOver",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return manualRowMove_assertClassBrand(_ManualRowMove_brand,_this,manualRowMove_onBeforeOnCellMouseOver).call(_this,...args)})),this.addHook("afterScrollHorizontally",(()=>manualRowMove_assertClassBrand(_ManualRowMove_brand,this,_onAfterScrollHorizontally).call(this))),this.addHook("afterLoadData",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return manualRowMove_assertClassBrand(_ManualRowMove_brand,_this,manualRowMove_onAfterLoadData).call(_this,...args)})),this.buildPluginUI(),this.registerEvents(),(0,dom_element.iQ)(this.hot.rootElement,"ht__manualRowMove"),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,dom_element.vy)(this.hot.rootElement,"ht__manualRowMove"),this.unregisterEvents(),manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).destroy(),manualRowMove_classPrivateFieldGet(manualRowMove_guideline,this).destroy(),super.disablePlugin()}moveRow(row,finalIndex){return this.moveRows([row],finalIndex)}moveRows(rows,finalIndex){const dropIndex=manualRowMove_classPrivateFieldGet(manualRowMove_cachedDropIndex,this),movePossible=this.isMovePossible(rows,finalIndex),beforeMoveHook=this.hot.runHooks("beforeRowMove",rows,finalIndex,dropIndex,movePossible);if(manualRowMove_classPrivateFieldSet(manualRowMove_cachedDropIndex,this,void 0),!1===beforeMoveHook)return;movePossible&&this.hot.rowIndexMapper.moveIndexes(rows,finalIndex);const movePerformed=movePossible&&this.isRowOrderChanged(rows,finalIndex);return this.hot.runHooks("afterRowMove",rows,finalIndex,dropIndex,movePossible,movePerformed),movePerformed}dragRow(row,dropIndex){return this.dragRows([row],dropIndex)}dragRows(rows,dropIndex){const finalIndex=this.countFinalIndex(rows,dropIndex);return manualRowMove_classPrivateFieldSet(manualRowMove_cachedDropIndex,this,dropIndex),this.moveRows(rows,finalIndex)}isMovePossible(movedRows,finalIndex){const length=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),tooHighDestinationIndex=movedRows.length+finalIndex>length,tooLowDestinationIndex=finalIndex<0,tooLowMovedRowIndex=movedRows.some((movedRow=>movedRow<0)),tooHighMovedRowIndex=movedRows.some((movedRow=>movedRow>=length));return!(tooHighDestinationIndex||tooLowDestinationIndex||tooLowMovedRowIndex||tooHighMovedRowIndex)}isRowOrderChanged(movedRows,finalIndex){return movedRows.some(((row,nrOfMovedElement)=>row-nrOfMovedElement!==finalIndex))}countFinalIndex(movedRows,dropIndex){const numberOfRowsLowerThanDropIndex=(0,array.mu)(movedRows,((numberOfRows,currentRowIndex)=>(currentRowIndex<dropIndex&&(numberOfRows+=1),numberOfRows)),0);return dropIndex-numberOfRowsLowerThanDropIndex}getRowsHeight(fromRow,toRow){const rowMapper=this.hot.rowIndexMapper;let rowsHeight=0;for(let visualRowIndex=fromRow;visualRowIndex<=toRow;visualRowIndex++){const renderableIndex=rowMapper.getRenderableFromVisualIndex(visualRowIndex);null!==renderableIndex&&(rowsHeight+=this.hot.view._wt.wtTable.getRowHeight(renderableIndex)||this.hot.view.getDefaultRowHeight())}return rowsHeight}moveBySettingsOrLoad(){const pluginSettings=this.hot.getSettings().manualRowMove;if(Array.isArray(pluginSettings))this.moveRows(pluginSettings,0);else if(void 0!==pluginSettings){const persistentState=this.persistentStateLoad();persistentState.length&&this.moveRows(persistentState,0)}}isFixedRowTop(row){return row<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(row){return row>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const storedState={};return this.hot.runHooks("persistentStateLoad","manualRowMove",storedState),storedState.value?storedState.value:[]}prepareRowsToMoving(){const selection=this.hot.getSelectedRangeLast(),selectedRows=[];if(!selection)return selectedRows;const{from,to}=selection,start=Math.min(from.row,to.row),end=Math.max(from.row,to.row);return(0,number.Ti)(start,end,(i=>{selectedRows.push(i)})),selectedRows}refreshPositions(){const coords=manualRowMove_classPrivateFieldGet(manualRowMove_target,this).coords,firstVisible=this.hot.getFirstFullyVisibleRow(),lastVisible=this.hot.getLastFullyVisibleRow(),countRows=this.hot.countRows();this.isFixedRowTop(coords.row)&&firstVisible>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(firstVisible-1,-1)),this.isFixedRowBottom(coords.row)&&lastVisible<countRows&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(lastVisible+1,1),void 0,!0);const wtTable=this.hot.view._wt.wtTable,TD=manualRowMove_classPrivateFieldGet(manualRowMove_target,this).TD,rootElement=this.hot.rootElement,rootElementOffset=(0,dom_element.cY)(rootElement),trimmingContainer=(0,dom_element.fX)(rootElement),tableScroll=wtTable.holder.scrollTop,trimmingContainerScroll=this.hot.rootWindow!==trimmingContainer?trimmingContainer.scrollTop:0,pixelsAbove=rootElementOffset.top-trimmingContainerScroll,pixelsRelToTableStart=manualRowMove_classPrivateFieldGet(manualRowMove_target,this).eventPageY-pixelsAbove+tableScroll,hiderHeight=wtTable.hider.offsetHeight,tbodyOffsetTop=wtTable.TBODY.offsetTop,backlightElemMarginTop=manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).getOffset().top,backlightElemHeight=manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).getSize().height,tdMiddle=TD.offsetHeight/2,tdHeight=TD.offsetHeight;let tdStartPixel=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,coords.row-1);const isBelowTable=pixelsRelToTableStart>=tdStartPixel+tdMiddle;this.isFixedRowTop(coords.row)&&(tdStartPixel+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),coords.row<0?manualRowMove_classPrivateFieldGet(manualRowMove_target,this).row=firstVisible>0?firstVisible-1:firstVisible:isBelowTable?(manualRowMove_classPrivateFieldGet(manualRowMove_target,this).row=coords.row+1,tdStartPixel+=0===coords.row?tdHeight-1:tdHeight):manualRowMove_classPrivateFieldGet(manualRowMove_target,this).row=coords.row;let backlightTop=pixelsRelToTableStart,guidelineTop=tdStartPixel;pixelsRelToTableStart+backlightElemHeight+backlightElemMarginTop>=hiderHeight?backlightTop=hiderHeight-backlightElemHeight-backlightElemMarginTop:pixelsRelToTableStart+backlightElemMarginTop<tbodyOffsetTop&&(backlightTop=tbodyOffsetTop+Math.abs(backlightElemMarginTop)),tdStartPixel>=hiderHeight-1&&(guidelineTop=hiderHeight-1),manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).setPosition(backlightTop),manualRowMove_classPrivateFieldGet(manualRowMove_guideline,this).setPosition(guidelineTop)}registerEvents(){const{documentElement}=this.hot.rootDocument;this.eventManager.addEventListener(documentElement,"mousemove",(event=>manualRowMove_assertClassBrand(_ManualRowMove_brand,this,manualRowMove_onMouseMove).call(this,event))),this.eventManager.addEventListener(documentElement,"mouseup",(()=>manualRowMove_assertClassBrand(_ManualRowMove_brand,this,manualRowMove_onMouseUp).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).build(),manualRowMove_classPrivateFieldGet(manualRowMove_guideline,this).build()}destroy(){manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).destroy(),manualRowMove_classPrivateFieldGet(manualRowMove_guideline,this).destroy(),super.destroy()}}function manualRowMove_onBeforeOnCellMouseDown(event,coords,TD,controller){const{wtTable,wtViewport}=this.hot.view._wt,isHeaderSelection=this.hot.selection.isSelectedByRowHeader(),selection=this.hot.getSelectedRangeLast();if(!selection||!isHeaderSelection||manualRowMove_classPrivateFieldGet(manualRowMove_pressed,this)||0!==event.button)return manualRowMove_classPrivateFieldSet(manualRowMove_pressed,this,!1),manualRowMove_classPrivateFieldGet(_rowsToMove,this).length=0,void(0,dom_element.vy)(this.hot.rootElement,["on-moving--rows","show-ui"]);const guidelineIsNotReady=manualRowMove_classPrivateFieldGet(manualRowMove_guideline,this).isBuilt()&&!manualRowMove_classPrivateFieldGet(manualRowMove_guideline,this).isAppended(),backlightIsNotReady=manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).isBuilt()&&!manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).isAppended();guidelineIsNotReady&&backlightIsNotReady&&(manualRowMove_classPrivateFieldGet(manualRowMove_guideline,this).appendTo(wtTable.hider),manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).appendTo(wtTable.hider));const{from,to}=selection,start=Math.min(from.row,to.row),end=Math.max(from.row,to.row);if(coords.col<0&&coords.row>=start&&coords.row<=end){controller.row=!0,manualRowMove_classPrivateFieldSet(manualRowMove_pressed,this,!0),manualRowMove_classPrivateFieldGet(manualRowMove_target,this).eventPageY=event.pageY,manualRowMove_classPrivateFieldGet(manualRowMove_target,this).coords=coords,manualRowMove_classPrivateFieldGet(manualRowMove_target,this).TD=TD,manualRowMove_classPrivateFieldSet(_rowsToMove,this,this.prepareRowsToMoving());const leftPos=wtTable.holder.scrollLeft+wtViewport.getRowHeaderWidth(),topOffset=this.getRowsHeight(start,coords.row-1)+(event.clientY-TD.getBoundingClientRect().top);manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).setPosition(null,leftPos),manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).setSize(wtTable.hider.offsetWidth-leftPos,this.getRowsHeight(start,end)),manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).setOffset(-topOffset,null),(0,dom_element.iQ)(this.hot.rootElement,"on-moving--rows"),this.refreshPositions()}else(0,dom_element.vy)(this.hot.rootElement,"after-selection--rows"),manualRowMove_classPrivateFieldSet(manualRowMove_pressed,this,!1),manualRowMove_classPrivateFieldGet(_rowsToMove,this).length=0}function manualRowMove_onMouseMove(event){manualRowMove_classPrivateFieldGet(manualRowMove_pressed,this)&&(manualRowMove_classPrivateFieldGet(manualRowMove_target,this).eventPageY=event.pageY,this.refreshPositions())}function manualRowMove_onBeforeOnCellMouseOver(event,coords,TD,controller){this.hot.getSelectedRangeLast()&&manualRowMove_classPrivateFieldGet(manualRowMove_pressed,this)&&(manualRowMove_classPrivateFieldGet(_rowsToMove,this).indexOf(coords.row)>-1?(0,dom_element.vy)(this.hot.rootElement,"show-ui"):(0,dom_element.iQ)(this.hot.rootElement,"show-ui"),controller.row=!0,controller.column=!0,controller.cell=!0,manualRowMove_classPrivateFieldGet(manualRowMove_target,this).coords=coords,manualRowMove_classPrivateFieldGet(manualRowMove_target,this).TD=TD)}function manualRowMove_onMouseUp(){const target=manualRowMove_classPrivateFieldGet(manualRowMove_target,this).row,rowsLen=manualRowMove_classPrivateFieldGet(_rowsToMove,this).length;if(manualRowMove_classPrivateFieldSet(manualRowMove_pressed,this,!1),(0,dom_element.vy)(this.hot.rootElement,["on-moving--rows","show-ui","after-selection--rows"]),this.hot.selection.isSelectedByRowHeader()&&(0,dom_element.iQ)(this.hot.rootElement,"after-selection--rows"),rowsLen<1||void 0===target)return;const firstMovedVisualRow=manualRowMove_classPrivateFieldGet(_rowsToMove,this)[0],firstMovedPhysicalRow=this.hot.toPhysicalRow(firstMovedVisualRow),movePerformed=this.dragRows(manualRowMove_classPrivateFieldGet(_rowsToMove,this),target);if(manualRowMove_classPrivateFieldGet(_rowsToMove,this).length=0,!0===movePerformed){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const selectionStart=this.hot.toVisualRow(firstMovedPhysicalRow),selectionEnd=selectionStart+rowsLen-1;this.hot.selectRows(selectionStart,selectionEnd)}}function _onAfterScrollHorizontally(){const wtTable=this.hot.view._wt.wtTable,posLeft=this.hot.view._wt.wtViewport.getRowHeaderWidth()+wtTable.holder.scrollLeft;manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).setPosition(null,posLeft),manualRowMove_classPrivateFieldGet(manualRowMove_backlight,this).setSize(wtTable.hider.offsetWidth-posLeft)}function manualRowMove_onAfterLoadData(){this.moveBySettingsOrLoad()}function manualRowResize_classPrivateFieldInitSpec(e,t,a){manualRowResize_checkPrivateRedeclaration(e,t),t.set(e,a)}function manualRowResize_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function manualRowResize_classPrivateFieldSet(s,a,r){return s.set(manualRowResize_assertClassBrand(s,a),r),r}function manualRowResize_classPrivateFieldGet(s,a){return s.get(manualRowResize_assertClassBrand(s,a))}function manualRowResize_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var manualRowResize_currentTH=new WeakMap,_currentRow=new WeakMap,_selectedRows=new WeakMap,_currentHeight=new WeakMap,manualRowResize_newSize=new WeakMap,manualRowResize_startY=new WeakMap,_startHeight=new WeakMap,manualRowResize_startOffset=new WeakMap,manualRowResize_handle=new WeakMap,manualRowResize_guide=new WeakMap,manualRowResize_pressed=new WeakMap,manualRowResize_isTriggeredByRMB=new WeakMap,manualRowResize_dblclick=new WeakMap,manualRowResize_autoresizeTimeout=new WeakMap,_rowHeightsMap=new WeakMap,manualRowResize_config=new WeakMap,_ManualRowResize_brand=new WeakSet;class ManualRowResize extends BasePlugin{static get PLUGIN_KEY(){return"manualRowResize"}static get PLUGIN_PRIORITY(){return 30}constructor(hotInstance){super(hotInstance),function manualRowResize_classPrivateMethodInitSpec(e,a){manualRowResize_checkPrivateRedeclaration(e,a),a.add(e)}(this,_ManualRowResize_brand),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_currentTH,null),manualRowResize_classPrivateFieldInitSpec(this,_currentRow,null),manualRowResize_classPrivateFieldInitSpec(this,_selectedRows,[]),manualRowResize_classPrivateFieldInitSpec(this,_currentHeight,null),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_newSize,null),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_startY,null),manualRowResize_classPrivateFieldInitSpec(this,_startHeight,null),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_startOffset,null),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_handle,this.hot.rootDocument.createElement("DIV")),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_guide,this.hot.rootDocument.createElement("DIV")),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_pressed,!1),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_isTriggeredByRMB,!1),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_dblclick,0),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_autoresizeTimeout,null),manualRowResize_classPrivateFieldInitSpec(this,_rowHeightsMap,void 0),manualRowResize_classPrivateFieldInitSpec(this,manualRowResize_config,void 0),(0,dom_element.iQ)(manualRowResize_classPrivateFieldGet(manualRowResize_handle,this),"manualRowResizer"),(0,dom_element.iQ)(manualRowResize_classPrivateFieldGet(manualRowResize_guide,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings().manualRowResize}enablePlugin(){this.enabled||(manualRowResize_classPrivateFieldSet(_rowHeightsMap,this,new physicalIndexToValueMap._),manualRowResize_classPrivateFieldGet(_rowHeightsMap,this).addLocalHook("init",(()=>manualRowResize_assertClassBrand(_ManualRowResize_brand,this,manualRowResize_onMapInit).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,manualRowResize_classPrivateFieldGet(_rowHeightsMap,this)),this.addHook("modifyRowHeight",((height,row)=>manualRowResize_assertClassBrand(_ManualRowResize_brand,this,manualRowResize_onModifyRowHeight).call(this,height,row))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){manualRowResize_classPrivateFieldSet(manualRowResize_config,this,manualRowResize_classPrivateFieldGet(_rowHeightsMap,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave","manualRowHeights",manualRowResize_classPrivateFieldGet(_rowHeightsMap,this).getValues())}loadManualRowHeights(){const storedState={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",storedState),storedState.value}setManualSize(row,height){const physicalRow=this.hot.toPhysicalRow(row),newHeight=Math.max(height,this.hot.view.getDefaultRowHeight());return manualRowResize_classPrivateFieldGet(_rowHeightsMap,this).setValueAtIndex(physicalRow,newHeight),newHeight}getLastDesiredRowHeight(){return manualRowResize_classPrivateFieldGet(_currentHeight,this)}setupHandlePosition(TH){manualRowResize_classPrivateFieldSet(manualRowResize_currentTH,this,TH);const{view}=this.hot,{_wt:wt}=view,cellCoords=wt.wtTable.getCoords(manualRowResize_classPrivateFieldGet(manualRowResize_currentTH,this)),row=cellCoords.row;if(row<0)return;const headerWidth=(0,dom_element.Gq)(manualRowResize_classPrivateFieldGet(manualRowResize_currentTH,this)),box=manualRowResize_classPrivateFieldGet(manualRowResize_currentTH,this).getBoundingClientRect(),fixedRowTop=row<wt.getSetting("fixedRowsTop"),fixedRowBottom=row>=view.countNotHiddenRowIndexes(0,1)-wt.getSetting("fixedRowsBottom");let relativeHeaderPosition;fixedRowTop?relativeHeaderPosition=wt.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(manualRowResize_classPrivateFieldGet(manualRowResize_currentTH,this),cellCoords.row,cellCoords.col):fixedRowBottom&&(relativeHeaderPosition=wt.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(manualRowResize_classPrivateFieldGet(manualRowResize_currentTH,this),cellCoords.row,cellCoords.col)),relativeHeaderPosition||(relativeHeaderPosition=wt.wtOverlays.inlineStartOverlay.getRelativeCellPosition(manualRowResize_classPrivateFieldGet(manualRowResize_currentTH,this),cellCoords.row,cellCoords.col)),manualRowResize_classPrivateFieldSet(_currentRow,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(row)),manualRowResize_classPrivateFieldSet(_selectedRows,this,[]);const isFullRowSelected=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&isFullRowSelected){const selectionRanges=this.hot.getSelectedRange();(0,array.z0)(selectionRanges,(selectionRange=>{const fromRow=selectionRange.getTopStartCorner().row,toRow=selectionRange.getBottomStartCorner().row;(0,number.Ti)(fromRow,toRow,(rowIndex=>{manualRowResize_classPrivateFieldGet(_selectedRows,this).includes(rowIndex)||manualRowResize_classPrivateFieldGet(_selectedRows,this).push(rowIndex)}))}))}manualRowResize_classPrivateFieldGet(_selectedRows,this).includes(manualRowResize_classPrivateFieldGet(_currentRow,this))||manualRowResize_classPrivateFieldSet(_selectedRows,this,[manualRowResize_classPrivateFieldGet(_currentRow,this)]),manualRowResize_classPrivateFieldSet(manualRowResize_startOffset,this,relativeHeaderPosition.top-6),manualRowResize_classPrivateFieldSet(_startHeight,this,parseInt(box.height,10)),manualRowResize_classPrivateFieldGet(manualRowResize_handle,this).style.top=`${manualRowResize_classPrivateFieldGet(manualRowResize_startOffset,this)+manualRowResize_classPrivateFieldGet(_startHeight,this)}px`,manualRowResize_classPrivateFieldGet(manualRowResize_handle,this).style[this.inlineDir]=`${relativeHeaderPosition.start}px`,manualRowResize_classPrivateFieldGet(manualRowResize_handle,this).style.width=`${headerWidth}px`,this.hot.rootElement.appendChild(manualRowResize_classPrivateFieldGet(manualRowResize_handle,this))}refreshHandlePosition(){manualRowResize_classPrivateFieldGet(manualRowResize_handle,this).style.top=`${manualRowResize_classPrivateFieldGet(manualRowResize_startOffset,this)+manualRowResize_classPrivateFieldGet(_currentHeight,this)}px`}setupGuidePosition(){const handleWidth=parseInt((0,dom_element.Gq)(manualRowResize_classPrivateFieldGet(manualRowResize_handle,this)),10),handleEndPosition=parseInt(manualRowResize_classPrivateFieldGet(manualRowResize_handle,this).style[this.inlineDir],10)+handleWidth,maximumVisibleElementWidth=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,dom_element.iQ)(manualRowResize_classPrivateFieldGet(manualRowResize_handle,this),"active"),(0,dom_element.iQ)(manualRowResize_classPrivateFieldGet(manualRowResize_guide,this),"active"),manualRowResize_classPrivateFieldGet(manualRowResize_guide,this).style.top=manualRowResize_classPrivateFieldGet(manualRowResize_handle,this).style.top,manualRowResize_classPrivateFieldGet(manualRowResize_guide,this).style[this.inlineDir]=`${handleEndPosition}px`,manualRowResize_classPrivateFieldGet(manualRowResize_guide,this).style.width=maximumVisibleElementWidth-handleWidth+"px",this.hot.rootElement.appendChild(manualRowResize_classPrivateFieldGet(manualRowResize_guide,this))}refreshGuidePosition(){manualRowResize_classPrivateFieldGet(manualRowResize_guide,this).style.top=manualRowResize_classPrivateFieldGet(manualRowResize_handle,this).style.top}hideHandleAndGuide(){(0,dom_element.vy)(manualRowResize_classPrivateFieldGet(manualRowResize_handle,this),"active"),(0,dom_element.vy)(manualRowResize_classPrivateFieldGet(manualRowResize_guide,this),"active")}checkIfRowHeader(element){const tbody=(0,dom_element.kp)(element,["TBODY"],this.hot.rootElement),{inlineStartOverlay,topInlineStartCornerOverlay,bottomInlineStartCornerOverlay}=this.hot.view._wt.wtOverlays;return[inlineStartOverlay.clone.wtTable.TBODY,topInlineStartCornerOverlay.clone.wtTable.TBODY,bottomInlineStartCornerOverlay.clone.wtTable.TBODY].includes(tbody)}getClosestTHParent(element){return"TABLE"!==element.tagName?"TH"===element.tagName?element:this.getClosestTHParent(element.parentNode):null}getActualRowHeight(row){const walkontableHeight=this.hot.view._wt.wtTable.getRowHeight(row);return void 0!==walkontableHeight&&manualRowResize_classPrivateFieldGet(manualRowResize_newSize,this)<walkontableHeight?walkontableHeight:manualRowResize_classPrivateFieldGet(manualRowResize_newSize,this)}afterMouseDownTimeout(){const render=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},resize=(row,forceRender)=>{const hookNewSize=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(row),row,!0);void 0!==hookNewSize&&manualRowResize_classPrivateFieldSet(manualRowResize_newSize,this,hookNewSize),this.setManualSize(row,manualRowResize_classPrivateFieldGet(manualRowResize_newSize,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(row),row,!0),forceRender&&render()};if(manualRowResize_classPrivateFieldGet(manualRowResize_dblclick,this)>=2){manualRowResize_classPrivateFieldGet(_selectedRows,this).length>1?((0,array.z0)(manualRowResize_classPrivateFieldGet(_selectedRows,this),(selectedRow=>{resize(selectedRow)})),render()):(0,array.z0)(manualRowResize_classPrivateFieldGet(_selectedRows,this),(selectedRow=>{resize(selectedRow,!0)}))}manualRowResize_classPrivateFieldSet(manualRowResize_dblclick,this,0),manualRowResize_classPrivateFieldSet(manualRowResize_autoresizeTimeout,this,null)}bindEvents(){const{rootElement,rootWindow}=this.hot;this.eventManager.addEventListener(rootElement,"mouseover",(e=>manualRowResize_assertClassBrand(_ManualRowResize_brand,this,manualRowResize_onMouseOver).call(this,e))),this.eventManager.addEventListener(rootElement,"mousedown",(e=>manualRowResize_assertClassBrand(_ManualRowResize_brand,this,manualRowResize_onMouseDown).call(this,e))),this.eventManager.addEventListener(rootWindow,"mousemove",(e=>manualRowResize_assertClassBrand(_ManualRowResize_brand,this,manualRowResize_onMouseMove).call(this,e))),this.eventManager.addEventListener(rootWindow,"mouseup",(()=>manualRowResize_assertClassBrand(_ManualRowResize_brand,this,manualRowResize_onMouseUp).call(this))),this.eventManager.addEventListener(manualRowResize_classPrivateFieldGet(manualRowResize_handle,this),"contextmenu",(()=>manualRowResize_assertClassBrand(_ManualRowResize_brand,this,manualRowResize_onContextMenu).call(this)))}destroy(){super.destroy()}}function manualRowResize_onMouseOver(event){if(!(0,dom_element.$w)(event.target)&&!0!==manualRowResize_classPrivateFieldGet(manualRowResize_isTriggeredByRMB,this)&&this.checkIfRowHeader(event.target)){const th=this.getClosestTHParent(event.target);th&&(manualRowResize_classPrivateFieldGet(manualRowResize_pressed,this)||this.setupHandlePosition(th))}}function manualRowResize_onMouseDown(event){(0,dom_element.nB)(event.target,"manualRowResizer")&&(this.setupHandlePosition(manualRowResize_classPrivateFieldGet(manualRowResize_currentTH,this)),this.setupGuidePosition(),manualRowResize_classPrivateFieldSet(manualRowResize_pressed,this,!0),null===manualRowResize_classPrivateFieldGet(manualRowResize_autoresizeTimeout,this)&&(manualRowResize_classPrivateFieldSet(manualRowResize_autoresizeTimeout,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(manualRowResize_classPrivateFieldGet(manualRowResize_autoresizeTimeout,this))),manualRowResize_classPrivateFieldSet(manualRowResize_dblclick,this,manualRowResize_classPrivateFieldGet(manualRowResize_dblclick,this)+1),manualRowResize_classPrivateFieldSet(manualRowResize_startY,this,event.pageY),manualRowResize_classPrivateFieldSet(manualRowResize_newSize,this,manualRowResize_classPrivateFieldGet(_startHeight,this)))}function manualRowResize_onMouseMove(event){manualRowResize_classPrivateFieldGet(manualRowResize_pressed,this)&&(manualRowResize_classPrivateFieldSet(_currentHeight,this,manualRowResize_classPrivateFieldGet(_startHeight,this)+(event.pageY-manualRowResize_classPrivateFieldGet(manualRowResize_startY,this))),(0,array.z0)(manualRowResize_classPrivateFieldGet(_selectedRows,this),(selectedRow=>{manualRowResize_classPrivateFieldSet(manualRowResize_newSize,this,this.setManualSize(selectedRow,manualRowResize_classPrivateFieldGet(_currentHeight,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function manualRowResize_onMouseUp(){const render=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},runHooks=(row,forceRender)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(row),row,!1),forceRender&&render(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(row),row,!1)};if(manualRowResize_classPrivateFieldGet(manualRowResize_pressed,this)){if(this.hideHandleAndGuide(),manualRowResize_classPrivateFieldSet(manualRowResize_pressed,this,!1),manualRowResize_classPrivateFieldGet(manualRowResize_newSize,this)!==manualRowResize_classPrivateFieldGet(_startHeight,this)){manualRowResize_classPrivateFieldGet(_selectedRows,this).length>1?((0,array.z0)(manualRowResize_classPrivateFieldGet(_selectedRows,this),(selectedRow=>{runHooks(selectedRow)})),render()):(0,array.z0)(manualRowResize_classPrivateFieldGet(_selectedRows,this),(selectedRow=>{runHooks(selectedRow,!0)}))}this.setupHandlePosition(manualRowResize_classPrivateFieldGet(manualRowResize_currentTH,this))}}function manualRowResize_onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(manualRowResize_classPrivateFieldGet(manualRowResize_handle,this)),this.hot.rootElement.removeChild(manualRowResize_classPrivateFieldGet(manualRowResize_guide,this)),manualRowResize_classPrivateFieldSet(manualRowResize_pressed,this,!1),manualRowResize_classPrivateFieldSet(manualRowResize_isTriggeredByRMB,this,!0),this.hot._registerImmediate((()=>{manualRowResize_classPrivateFieldSet(manualRowResize_isTriggeredByRMB,this,!1)}))}function manualRowResize_onModifyRowHeight(height,row){let newHeight=height;if(this.enabled){const physicalRow=this.hot.toPhysicalRow(row),rowHeight=manualRowResize_classPrivateFieldGet(_rowHeightsMap,this).getValueAtIndex(physicalRow);this.hot.getSettings().manualRowResize&&rowHeight&&(newHeight=rowHeight)}return newHeight}function manualRowResize_onMapInit(){const initialSetting=this.hot.getSettings().manualRowResize,loadedManualRowHeights=this.loadManualRowHeights();this.hot.batchExecution((()=>{void 0!==loadedManualRowHeights?loadedManualRowHeights.forEach(((height,index)=>{manualRowResize_classPrivateFieldGet(_rowHeightsMap,this).setValueAtIndex(index,height)})):Array.isArray(initialSetting)?(initialSetting.forEach(((height,index)=>{manualRowResize_classPrivateFieldGet(_rowHeightsMap,this).setValueAtIndex(index,height)})),manualRowResize_classPrivateFieldSet(manualRowResize_config,this,initialSetting)):!0===initialSetting&&Array.isArray(manualRowResize_classPrivateFieldGet(manualRowResize_config,this))&&manualRowResize_classPrivateFieldGet(manualRowResize_config,this).forEach(((height,index)=>{manualRowResize_classPrivateFieldGet(_rowHeightsMap,this).setValueAtIndex(index,height)}))}),!0)}__webpack_require__("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.flat-map.js");function cellCoords_classPrivateFieldInitSpec(e,t,a){(function cellCoords_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function cellCoords_defineProperty(e,r,t){return(r=function cellCoords_toPropertyKey(t){var i=function cellCoords_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function cellCoords_classPrivateFieldGet(s,a){return s.get(cellCoords_assertClassBrand(s,a))}function cellCoords_classPrivateFieldSet(s,a,r){return s.set(cellCoords_assertClassBrand(s,a),r),r}function cellCoords_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _cellRange=new WeakMap;const cellCoords=class MergedCellCoords{constructor(row,column,rowspan,colspan,cellCoordsFactory,cellRangeFactory){cellCoords_defineProperty(this,"row",void 0),cellCoords_defineProperty(this,"col",void 0),cellCoords_defineProperty(this,"rowspan",void 0),cellCoords_defineProperty(this,"colspan",void 0),cellCoords_defineProperty(this,"removed",!1),cellCoords_defineProperty(this,"cellCoordsFactory",void 0),cellCoords_defineProperty(this,"cellRangeFactory",void 0),cellCoords_classPrivateFieldInitSpec(this,_cellRange,null),this.row=row,this.col=column,this.rowspan=rowspan,this.colspan=colspan,this.cellCoordsFactory=cellCoordsFactory,this.cellRangeFactory=cellRangeFactory}static NEGATIVE_VALUES_WARNING(_ref){let{row,col,rowspan,colspan}=_ref;return templateLiteralTag.O`The merged cell declared with {row: ${row}, col: ${col},\x20
      rowspan: ${rowspan}, colspan: ${colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(_ref2){let{row,col}=_ref2;return templateLiteralTag.O`The merged cell declared at [${row}, ${col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(_ref3){let{row,col}=_ref3;return templateLiteralTag.O`The merged cell declared at [${row}, ${col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(_ref4){let{row,col}=_ref4;return templateLiteralTag.O`The merged cell declared at [${row}, ${col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(_ref5){let{row,col,rowspan,colspan}=_ref5;return row<0||col<0||rowspan<0||colspan<0}static isSingleCell(_ref6){let{rowspan,colspan}=_ref6;return 1===colspan&&1===rowspan}static containsZeroSpan(_ref7){let{rowspan,colspan}=_ref7;return 0===colspan||0===rowspan}static isOutOfBounds(mergeCell,rowCount,columnCount){return mergeCell.row<0||mergeCell.col<0||mergeCell.row>=rowCount||mergeCell.row+mergeCell.rowspan-1>=rowCount||mergeCell.col>=columnCount||mergeCell.col+mergeCell.colspan-1>=columnCount}normalize(hotInstance){const totalRows=hotInstance.countRows(),totalColumns=hotInstance.countCols();this.row<0?this.row=0:this.row>totalRows-1&&(this.row=totalRows-1),this.col<0?this.col=0:this.col>totalColumns-1&&(this.col=totalColumns-1),this.row+this.rowspan>totalRows-1&&(this.rowspan=totalRows-this.row),this.col+this.colspan>totalColumns-1&&(this.colspan=totalColumns-this.col),cellCoords_classPrivateFieldSet(_cellRange,this,null)}includes(row,column){return this.row<=row&&this.col<=column&&this.row+this.rowspan-1>=row&&this.col+this.colspan-1>=column}includesHorizontally(column){return this.col<=column&&this.col+this.colspan-1>=column}includesVertically(row){return this.row<=row&&this.row+this.rowspan-1>=row}shift(shiftVector,indexOfChange){const shiftValue=shiftVector[0]||shiftVector[1],shiftedIndex=indexOfChange+Math.abs(shiftVector[0]||shiftVector[1])-1,span=shiftVector[0]?"colspan":"rowspan",index=shiftVector[0]?"col":"row",changeStart=Math.min(indexOfChange,shiftedIndex),changeEnd=Math.max(indexOfChange,shiftedIndex),mergeStart=this[index],mergeEnd=this[index]+this[span]-1;if(mergeStart>=indexOfChange&&(this[index]+=shiftValue),shiftValue>0)indexOfChange<=mergeEnd&&indexOfChange>mergeStart&&(this[span]+=shiftValue);else if(shiftValue<0){if(changeStart<=mergeStart&&changeEnd>=mergeEnd)return this.removed=!0,cellCoords_classPrivateFieldSet(_cellRange,this,null),!1;if(mergeStart>=changeStart&&mergeStart<=changeEnd){const removedOffset=changeEnd-mergeStart+1,preRemovedOffset=Math.abs(shiftValue)-removedOffset;this[index]-=preRemovedOffset+shiftValue,this[span]-=removedOffset}else if(mergeStart<=changeStart&&mergeEnd>=changeEnd)this[span]+=shiftValue;else if(mergeStart<=changeStart&&mergeEnd>=changeStart&&mergeEnd<changeEnd){const removedPart=mergeEnd-changeStart+1;this[span]-=removedPart}}return cellCoords_classPrivateFieldSet(_cellRange,this,null),!0}isFarther(mergedCell,direction){return!mergedCell||("down"===direction?mergedCell.row+mergedCell.rowspan-1<this.row+this.rowspan-1:"up"===direction?mergedCell.row>this.row:"right"===direction?mergedCell.col+mergedCell.colspan-1<this.col+this.colspan-1:"left"===direction?mergedCell.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return cellCoords_classPrivateFieldGet(_cellRange,this)||cellCoords_classPrivateFieldSet(_cellRange,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),cellCoords_classPrivateFieldGet(_cellRange,this)}};function cellsCollection_classPrivateMethodInitSpec(e,a){(function cellsCollection_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function cellsCollection_defineProperty(e,r,t){return(r=function cellsCollection_toPropertyKey(t){var i=function cellsCollection_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function cellsCollection_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _MergedCellsCollection_brand=new WeakSet;class MergedCellsCollection{constructor(mergeCellsPlugin){cellsCollection_classPrivateMethodInitSpec(this,_MergedCellsCollection_brand),cellsCollection_defineProperty(this,"plugin",void 0),cellsCollection_defineProperty(this,"mergedCells",[]),cellsCollection_defineProperty(this,"mergedCellsMatrix",new Map),cellsCollection_defineProperty(this,"hot",void 0),this.plugin=mergeCellsPlugin,this.hot=mergeCellsPlugin.hot}static IS_OVERLAPPING_WARNING(_ref){let{row,col}=_ref;return templateLiteralTag.O`The merged cell declared at [${row}, ${col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(row,column){var _this$mergedCellsMatr;return!!this.mergedCellsMatrix.has(row)&&(null!==(_this$mergedCellsMatr=this.mergedCellsMatrix.get(row).get(column))&&void 0!==_this$mergedCellsMatr&&_this$mergedCellsMatr)}getByRange(range){const{row:rowStart,col:columnStart}=range.getTopStartCorner(),{row:rowEnd,col:columnEnd}=range.getBottomEndCorner(),mergedCellsLength=this.mergedCells.length;let result=!1;for(let i=0;i<mergedCellsLength;i++){const mergedCell=this.mergedCells[i],{row,col,rowspan,colspan}=mergedCell;if(row>=rowStart&&row+rowspan-1<=rowEnd&&col>=columnStart&&col+colspan-1<=columnEnd){result=mergedCell;break}}return result}filterOverlappingMergeCells(mergedCellsInfo){const occupiedCells=new Set;this.mergedCells.forEach((mergedCell=>{const{row,col,colspan,rowspan}=mergedCell;for(let r=row;r<row+rowspan;r++)for(let c=col;c<col+colspan;c++)occupiedCells.add(`r${r},c${c}`)}));return mergedCellsInfo.filter((mergedCell=>{const{row,col,colspan,rowspan}=mergedCell,localOccupiedCells=new Set;let isOverlapping=!1;for(let r=row;r<row+rowspan;r++){for(let c=col;c<col+colspan;c++){const cellId=`r${r},c${c}`;if(occupiedCells.has(cellId)){(0,helpers_console.R8)(MergedCellsCollection.IS_OVERLAPPING_WARNING(mergedCell)),isOverlapping=!0;break}localOccupiedCells.add(cellId)}if(isOverlapping)break}return isOverlapping||occupiedCells.add(...localOccupiedCells),!isOverlapping}))}getWithinRange(range){let countPartials=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:rowStart,col:columnStart}=range.getTopStartCorner(),{row:rowEnd,col:columnEnd}=range.getBottomEndCorner(),result=[];for(let row=rowStart;row<=rowEnd;row++)for(let column=columnStart;column<=columnEnd;column++){const mergedCell=this.get(row,column);mergedCell&&(countPartials||!countPartials&&mergedCell.row===row&&mergedCell.col===column)&&result.push(mergedCell)}return result}add(mergedCellInfo){let auto=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const row=mergedCellInfo.row,column=mergedCellInfo.col,rowspan=mergedCellInfo.rowspan,colspan=mergedCellInfo.colspan,newMergedCell=new cellCoords(row,column,rowspan,colspan,this.hot._createCellCoords,this.hot._createCellRange),alreadyExists=this.get(row,column),isOverlapping=!auto&&this.isOverlapping(newMergedCell);return alreadyExists||isOverlapping?(isOverlapping&&(0,helpers_console.R8)(MergedCellsCollection.IS_OVERLAPPING_WARNING(newMergedCell)),!1):(this.hot&&newMergedCell.normalize(this.hot),this.mergedCells.push(newMergedCell),cellsCollection_assertClassBrand(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,newMergedCell),newMergedCell)}remove(row,column){const mergedCell=this.get(row,column),mergedCellIndex=mergedCell?this.mergedCells.indexOf(mergedCell):-1;return!(!mergedCell||-1===mergedCellIndex)&&(this.mergedCells.splice(mergedCellIndex,1),cellsCollection_assertClassBrand(_MergedCellsCollection_brand,this,_removeMergedCellFromMatrix).call(this,mergedCell),mergedCell)}clear(){(0,array.z0)(this.mergedCells,(_ref2=>{let{row,col,rowspan,colspan}=_ref2;(0,number.Ti)(row,row+rowspan,(r=>{(0,number.Ti)(col,col+colspan,(c=>{const TD=this.hot.getCell(r,c);TD&&(TD.removeAttribute("rowspan"),TD.removeAttribute("colspan"),TD.style.display="")}))}))})),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(mergedCell){const mergedCellRange=mergedCell.getRange();for(let i=0;i<this.mergedCells.length;i++){if(this.mergedCells[i].getRange().overlaps(mergedCellRange))return!0}return!1}isFirstRenderableMergedCell(row,column){const mergeParent=this.get(row,column);if(!mergeParent)return!1;const{row:mergeRow,col:mergeColumn,rowspan,colspan}=mergeParent,overlayName=this.hot.view.getActiveOverlayName(),firstRenderedRow=["top","top_inline_start_corner"].includes(overlayName)?0:this.hot.getFirstRenderedVisibleRow(),firstRenderedColumn=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(overlayName)?0:this.hot.getFirstRenderedVisibleColumn(),mergeCellsTopRow=(0,number.qE)(firstRenderedRow,mergeRow,mergeRow+rowspan-1),mergeCellsStartColumn=(0,number.qE)(firstRenderedColumn,mergeColumn,mergeColumn+colspan-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(mergeCellsTopRow,1)===row&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(mergeCellsStartColumn,1)===column}getFirstRenderableCoords(row,column){const mergeParent=this.get(row,column);if(!mergeParent||this.isFirstRenderableMergedCell(row,column))return this.hot._createCellCoords(row,column);const firstRenderableRow=this.hot.rowIndexMapper.getNearestNotHiddenIndex(mergeParent.row,1),firstRenderableColumn=this.hot.columnIndexMapper.getNearestNotHiddenIndex(mergeParent.col,1);return this.hot._createCellCoords(firstRenderableRow,firstRenderableColumn)}getStartMostColumnIndex(range,visualColumnIndex){const indexes=cellsCollection_assertClassBrand(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,range,"col",-1);let startMostIndex=visualColumnIndex;for(let i=0;i<indexes.length;i++)if(indexes[i]<=visualColumnIndex){startMostIndex=indexes[i];break}return startMostIndex}getEndMostColumnIndex(range,visualColumnIndex){const indexes=cellsCollection_assertClassBrand(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,range,"col",1);let endMostIndex=visualColumnIndex;for(let i=0;i<indexes.length;i++)if(indexes[i]>=visualColumnIndex){endMostIndex=indexes[i];break}return endMostIndex}getTopMostRowIndex(range,visualRowIndex){const indexes=cellsCollection_assertClassBrand(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,range,"row",-1);let topMostIndex=visualRowIndex;for(let i=0;i<indexes.length;i++)if(indexes[i]<=visualRowIndex){topMostIndex=indexes[i];break}return topMostIndex}getBottomMostRowIndex(range,visualRowIndex){const indexes=cellsCollection_assertClassBrand(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,range,"row",1);let bottomMostIndex=visualRowIndex;for(let i=0;i<indexes.length;i++)if(indexes[i]>=visualRowIndex){bottomMostIndex=indexes[i];break}return bottomMostIndex}shiftCollections(direction,index,count){const shiftVector=[0,0];switch(direction){case"right":shiftVector[0]+=count;break;case"left":shiftVector[0]-=count;break;case"down":shiftVector[1]+=count;break;case"up":shiftVector[1]-=count}const removedMergedCells=[];this.mergedCells.forEach((currentMerge=>{currentMerge.shift(shiftVector,index),currentMerge.removed&&removedMergedCells.push(currentMerge)})),removedMergedCells.forEach((removedMerge=>{this.mergedCells.splice(this.mergedCells.indexOf(removedMerge),1)})),this.mergedCellsMatrix.clear(),this.mergedCells.forEach((currentMerge=>{cellsCollection_assertClassBrand(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,currentMerge)}))}}function _getNonIntersectingIndexes(range,axis){let scanDirection=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const indexes=new Map,from=1===scanDirection?range.getTopStartCorner():range.getBottomEndCorner(),to=1===scanDirection?range.getBottomEndCorner():range.getTopStartCorner();for(let row=from.row;1===scanDirection?row<=to.row:row>=to.row;row+=scanDirection)for(let column=from.col;1===scanDirection?column<=to.col:column>=to.col;column+=scanDirection){const index="row"===axis?row:column,mergedCell=this.get(row,column);let lastIndex=index;mergedCell&&(lastIndex=1===scanDirection?mergedCell[axis]+mergedCell[`${axis}span`]-1:mergedCell[axis]),indexes.has(index)||indexes.set(index,new Set),indexes.get(index).add(lastIndex)}return Array.from(new Set(Array.from(indexes.entries()).filter((_ref3=>{let[,set]=_ref3;return 1===set.size})).flatMap((_ref4=>{let[,set]=_ref4;return Array.from(set)}))))}function _addMergedCellToMatrix(mergedCell){for(let row=mergedCell.row;row<mergedCell.row+mergedCell.rowspan;row++)for(let col=mergedCell.col;col<mergedCell.col+mergedCell.colspan;col++)this.mergedCellsMatrix.has(row)||this.mergedCellsMatrix.set(row,new Map),this.mergedCellsMatrix.get(row).set(col,mergedCell)}function _removeMergedCellFromMatrix(mergedCell){for(let row=mergedCell.row;row<mergedCell.row+mergedCell.rowspan;row++)for(let col=mergedCell.col;col<mergedCell.col+mergedCell.colspan;col++)this.mergedCellsMatrix.get(row).delete(col)}const cellsCollection=MergedCellsCollection;function calculations_autofill_defineProperty(e,r,t){return(r=function calculations_autofill_toPropertyKey(t){var i=function calculations_autofill_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const autofill=class AutofillCalculations{constructor(plugin){calculations_autofill_defineProperty(this,"plugin",void 0),calculations_autofill_defineProperty(this,"mergedCellsCollection",void 0),calculations_autofill_defineProperty(this,"currentFillData",null),this.plugin=plugin,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(baseArea,fullArea){let direction=null;return direction=fullArea[0]===baseArea[0]&&fullArea[1]===baseArea[1]&&fullArea[3]===baseArea[3]?"down":fullArea[2]===baseArea[2]&&fullArea[1]===baseArea[1]&&fullArea[3]===baseArea[3]?"up":fullArea[1]===baseArea[1]&&fullArea[2]===baseArea[2]?"right":"left",direction}snapDragArea(baseArea,fullArea,dragDirection,foundMergedCells){const newDragArea=fullArea.slice(0),fillSize=this.getAutofillSize(baseArea,fullArea,dragDirection),[baseAreaStartRow,baseAreaStartColumn,baseAreaEndRow,baseAreaEndColumn]=baseArea,fullCycle=["up","down"].indexOf(dragDirection)>-1?baseAreaEndRow-baseAreaStartRow+1:baseAreaEndColumn-baseAreaStartColumn+1,partials=fillSize-Math.floor(fillSize/fullCycle)*fullCycle,farthestCollection=this.getFarthestCollection(baseArea,fullArea,dragDirection,foundMergedCells);if(farthestCollection)if("down"===dragDirection){const fill=farthestCollection.row+farthestCollection.rowspan-baseAreaStartRow-partials;newDragArea[2]+fill>=this.plugin.hot.countRows()?newDragArea[2]-=partials:newDragArea[2]+=partials?fill:0}else if("right"===dragDirection){const fill=farthestCollection.col+farthestCollection.colspan-baseAreaStartColumn-partials;newDragArea[3]+fill>=this.plugin.hot.countCols()?newDragArea[3]-=partials:newDragArea[3]+=partials?fill:0}else if("up"===dragDirection){const fill=baseAreaEndRow-partials-farthestCollection.row+1;newDragArea[0]+fill<0?newDragArea[0]+=partials:newDragArea[0]-=partials?fill:0}else if("left"===dragDirection){const fill=baseAreaEndColumn-partials-farthestCollection.col+1;newDragArea[1]+fill<0?newDragArea[1]+=partials:newDragArea[1]-=partials?fill:0}return this.updateCurrentFillCache({baseArea,dragDirection,foundMergedCells,fillSize,dragArea:newDragArea,cycleLength:fullCycle}),newDragArea}updateCurrentFillCache(updateObject){this.currentFillData||(this.currentFillData={}),(0,object.X$)(this.currentFillData,updateObject)}getAutofillSize(baseArea,fullArea,direction){const[baseAreaStartRow,baseAreaStartColumn,baseAreaEndRow,baseAreaEndColumn]=baseArea,[dragAreaStartRow,dragAreaStartColumn,dragAreaEndRow,dragAreaEndColumn]=fullArea;switch(direction){case"up":return baseAreaStartRow-dragAreaStartRow;case"down":return dragAreaEndRow-baseAreaEndRow;case"left":return baseAreaStartColumn-dragAreaStartColumn;case"right":return dragAreaEndColumn-baseAreaEndColumn;default:return null}}getDragArea(baseArea,fullArea,direction){const[baseAreaStartRow,baseAreaStartColumn,baseAreaEndRow,baseAreaEndColumn]=baseArea,[fullAreaStartRow,fullAreaStartColumn,fullAreaEndRow,fullAreaEndColumn]=fullArea;switch(direction){case"up":return[fullAreaStartRow,fullAreaStartColumn,baseAreaStartRow-1,baseAreaEndColumn];case"down":{const mergedCell=this.mergedCellsCollection.get(fullAreaEndRow,baseAreaEndColumn);return[baseAreaEndRow+1,baseAreaStartColumn,fullAreaEndRow+(mergedCell?mergedCell.rowspan-1:0),baseAreaEndColumn]}case"left":return[fullAreaStartRow,fullAreaStartColumn,baseAreaEndRow,baseAreaStartColumn-1];case"right":{const mergedCell=this.mergedCellsCollection.get(fullAreaEndRow,baseAreaEndColumn);return[baseAreaStartRow,baseAreaEndColumn+(mergedCell?mergedCell.colspan-1:0),fullAreaEndRow,fullAreaEndColumn]}default:return null}}getFarthestCollection(baseArea,fullArea,direction,mergedCellArray){const[baseAreaStartRow,baseAreaStartColumn,baseAreaEndRow,baseAreaEndColumn]=baseArea,verticalDirection=["up","down"].indexOf(direction)>-1,baseEnd=verticalDirection?baseAreaEndRow:baseAreaEndColumn,baseStart=verticalDirection?baseAreaStartRow:baseAreaStartColumn,fillSize=this.getAutofillSize(baseArea,fullArea,direction),fullCycle=verticalDirection?baseAreaEndRow-baseAreaStartRow+1:baseAreaEndColumn-baseAreaStartColumn+1,partials=fillSize-Math.floor(fillSize/fullCycle)*fullCycle;let inclusionFunctionName=null,farthestCollection=null,endOfDragRecreationIndex=null;switch(direction){case"up":inclusionFunctionName="includesVertically",endOfDragRecreationIndex=baseEnd-partials+1;break;case"left":inclusionFunctionName="includesHorizontally",endOfDragRecreationIndex=baseEnd-partials+1;break;case"down":inclusionFunctionName="includesVertically",endOfDragRecreationIndex=baseStart+partials-1;break;case"right":inclusionFunctionName="includesHorizontally",endOfDragRecreationIndex=baseStart+partials-1}return(0,array.z0)(mergedCellArray,(currentCollection=>{currentCollection[inclusionFunctionName](endOfDragRecreationIndex)&&currentCollection.isFarther(farthestCollection,direction)&&(farthestCollection=currentCollection)})),farthestCollection}recreateAfterDataPopulation(changes){if(!this.currentFillData)return;const fillRange=this.getRangeFromChanges(changes),foundMergedCells=this.currentFillData.foundMergedCells,dragDirection=this.currentFillData.dragDirection,inBounds=(current,offset)=>{switch(dragDirection){case"up":return current.row-offset>=fillRange.from.row;case"down":return current.row+current.rowspan-1+offset<=fillRange.to.row;case"left":return current.col-offset>=fillRange.from.column;case"right":return current.col+current.colspan-1+offset<=fillRange.to.column;default:return null}};let fillOffset=0,current=null,multiplier=1;do{for(let j=0;j<foundMergedCells.length;j+=1){if(current=foundMergedCells[j],fillOffset=multiplier*this.currentFillData.cycleLength,inBounds(current,fillOffset))switch(dragDirection){case"up":this.plugin.mergedCellsCollection.add({row:current.row-fillOffset,rowspan:current.rowspan,col:current.col,colspan:current.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:current.row+fillOffset,rowspan:current.rowspan,col:current.col,colspan:current.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:current.row,rowspan:current.rowspan,col:current.col-fillOffset,colspan:current.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:current.row,rowspan:current.rowspan,col:current.col+fillOffset,colspan:current.colspan},!0)}j===foundMergedCells.length-1&&(multiplier+=1)}}while(inBounds(current,fillOffset));this.currentFillData=null,this.plugin.hot.render(),foundMergedCells.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(changes){const rows={min:null,max:null},columns={min:null,max:null};return(0,array.z0)(changes,(change=>{const rowIndex=change[0],columnIndex=this.plugin.hot.propToCol(change[1]);(null===rows.min||rowIndex<rows.min)&&(rows.min=rowIndex),(null===rows.max||rowIndex>rows.max)&&(rows.max=rowIndex),(null===columns.min||columnIndex<columns.min)&&(columns.min=columnIndex),(null===columns.max||columnIndex>columns.max)&&(columns.max=columnIndex)})),{from:{row:rows.min,column:columns.min},to:{row:rows.max,column:columns.max}}}dragAreaOverlapsCollections(baseArea,fullArea,direction){const dragArea=this.getDragArea(baseArea,fullArea,direction),[dragAreaStartRow,dragAreaStartColumn,dragAreaEndRow,dragAreaEndColumn]=dragArea,topLeft=this.plugin.hot._createCellCoords(dragAreaStartRow,dragAreaStartColumn),bottomRight=this.plugin.hot._createCellCoords(dragAreaEndRow,dragAreaEndColumn),dragRange=this.plugin.hot._createCellRange(topLeft,topLeft,bottomRight);if(0===this.mergedCellsCollection.getWithinRange(dragRange,!0).length)return!1;const mergedCellsWithoutPartials=this.mergedCellsCollection.getWithinRange(dragRange,!1);return 0===mergedCellsWithoutPartials.length||("up"===direction||"down"===direction?!mergedCellsWithoutPartials.every((_ref=>{let{colspan}=_ref;return colspan===dragRange.getWidth()})):!mergedCellsWithoutPartials.every((_ref2=>{let{rowspan}=_ref2;return rowspan===dragRange.getHeight()})))}};function selection_defineProperty(e,r,t){return(r=function selection_toPropertyKey(t){var i=function selection_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const selection=class SelectionCalculations{constructor(plugin){selection_defineProperty(this,"plugin",void 0),selection_defineProperty(this,"hot",void 0),selection_defineProperty(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=plugin,this.hot=plugin.hot}getSelectedMergedCellClassName(currentRow,currentColumn,cornersOfSelection,layerLevel){const startRow=Math.min(cornersOfSelection[0],cornersOfSelection[2]),startColumn=Math.min(cornersOfSelection[1],cornersOfSelection[3]),endRow=Math.max(cornersOfSelection[0],cornersOfSelection[2]),endColumn=Math.max(cornersOfSelection[1],cornersOfSelection[3]);if(void 0===layerLevel)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(currentRow,currentColumn))return;const mergedCell=this.plugin.mergedCellsCollection.get(currentRow,currentColumn);if(!mergedCell)return;const mergeRowEnd=mergedCell.getLastRow(),mergeColumnEnd=mergedCell.getLastColumn();return startRow<=mergedCell.row&&startColumn<=mergedCell.col&&endRow>=mergeRowEnd&&endColumn>=mergeColumnEnd?`${this.fullySelectedMergedCellClassName}-${layerLevel}`:this.isMergeCellFullySelected(mergedCell,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(mergedCell,selectionRangesArray){const mergedCellIndividualCoords=[];if(!selectionRangesArray||!mergedCell)return!1;for(let r=0;r<mergedCell.rowspan;r+=1)for(let c=0;c<mergedCell.colspan;c+=1)mergedCellIndividualCoords.push(this.hot._createCellCoords(mergedCell.row+r,mergedCell.col+c));for(let i=0;i<mergedCellIndividualCoords.length;i+=1){const insideSelections=[];for(let s=0;s<selectionRangesArray.length;s+=1)insideSelections[s]=selectionRangesArray[s].includes(mergedCellIndividualCoords[i]);if(!insideSelections.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const classNames=[];for(let i=0;i<=7;i+=1)classNames.push(`${this.fullySelectedMergedCellClassName}-${i}`);return classNames.push(`${this.fullySelectedMergedCellClassName}-multiple`),classNames}};function linkedList_defineProperty(e,r,t){return(r=function linkedList_toPropertyKey(t){var i=function linkedList_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class NodeStructure{constructor(data){linkedList_defineProperty(this,"data",void 0),linkedList_defineProperty(this,"next",null),linkedList_defineProperty(this,"prev",null),this.data=data}}const linkedList=class LinkedList{constructor(){linkedList_defineProperty(this,"first",null),linkedList_defineProperty(this,"last",null)}push(data){const node=new NodeStructure(data);if(null===this.first)this.first=node,this.last=node;else{const temp=this.last;this.last=node,node.prev=temp,temp.next=node}return node}unshift(data){const node=new NodeStructure(data);if(null===this.first)this.first=node,this.last=node;else{const temp=this.first;this.first=node,node.next=temp,temp.prev=node}}inorder(callback){let temp=this.first;for(;temp;){const interrupt=callback(temp);if(temp===this.last||!0===interrupt)break;temp=temp.next}}remove(data){if(null===this.first)return!1;let next,prev,temp=this.first;for(;temp;){if(temp.data===data)return next=temp.next,prev=temp.prev,next&&(next.prev=prev),prev&&(prev.next=next),temp===this.first&&(this.first=next),temp===this.last&&(this.last=prev),!0;temp=temp.next}return!1}hasCycle(){let fast=this.first,slow=this.first;for(;;){if(null===fast)return!1;if(fast=fast.next,null===fast)return!1;if(fast=fast.next,slow=slow.next,fast===slow)return!0}}pop(){if(null===this.last)return null;const temp=this.last;return this.last=this.last.prev,temp}shift(){if(null===this.first)return null;const temp=this.first;return this.first=this.first.next,temp}recursiveReverse(){if(!this.first)return;!function inverse(current,next){next&&(inverse(next,next.next),next.next=current)}(this.first,this.first.next),this.first.next=null;const temp=this.first;this.first=this.last,this.last=temp}reverse(){if(!this.first||!this.first.next)return;let temp,current=this.first.next,prev=this.first;for(;current;)temp=current.next,current.next=prev,prev.prev=current,prev=current,current=temp;this.first.next=null,this.last.prev=null,temp=this.first,this.first=prev,this.last=temp}};function focusOrder_classPrivateFieldInitSpec(e,t,a){focusOrder_checkPrivateRedeclaration(e,t),t.set(e,a)}function focusOrder_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function focusOrder_classPrivateFieldGet(s,a){return s.get(focusOrder_assertClassBrand(s,a))}function focusOrder_classPrivateFieldSet(s,a,r){return s.set(focusOrder_assertClassBrand(s,a),r),r}function focusOrder_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _cellsHorizontalOrder=new WeakMap,_cellsVerticalOrder=new WeakMap,_currentHorizontalLinkedNode=new WeakMap,_currentVerticalLinkedNode=new WeakMap,_mergedCellsGetter=new WeakMap,_rowIndexMapper=new WeakMap,_columnIndexMapper=new WeakMap,_FocusOrder_brand=new WeakSet;class FocusOrder{constructor(_ref){let{mergedCellsGetter,rowIndexMapper,columnIndexMapper}=_ref;!function focusOrder_classPrivateMethodInitSpec(e,a){focusOrder_checkPrivateRedeclaration(e,a),a.add(e)}(this,_FocusOrder_brand),focusOrder_classPrivateFieldInitSpec(this,_cellsHorizontalOrder,new linkedList),focusOrder_classPrivateFieldInitSpec(this,_cellsVerticalOrder,new linkedList),focusOrder_classPrivateFieldInitSpec(this,_currentHorizontalLinkedNode,null),focusOrder_classPrivateFieldInitSpec(this,_currentVerticalLinkedNode,null),focusOrder_classPrivateFieldInitSpec(this,_mergedCellsGetter,null),focusOrder_classPrivateFieldInitSpec(this,_rowIndexMapper,null),focusOrder_classPrivateFieldInitSpec(this,_columnIndexMapper,null),focusOrder_classPrivateFieldSet(_mergedCellsGetter,this,mergedCellsGetter),focusOrder_classPrivateFieldSet(_rowIndexMapper,this,rowIndexMapper),focusOrder_classPrivateFieldSet(_columnIndexMapper,this,columnIndexMapper)}getCurrentVerticalNode(){return focusOrder_classPrivateFieldGet(_currentVerticalLinkedNode,this).data}getFirstVerticalNode(){return focusOrder_classPrivateFieldGet(_cellsVerticalOrder,this).first.data}getNextVerticalNode(){return focusOrder_classPrivateFieldGet(_currentVerticalLinkedNode,this).next.data}getPrevVerticalNode(){return focusOrder_classPrivateFieldGet(_currentVerticalLinkedNode,this).prev.data}getCurrentHorizontalNode(){return focusOrder_classPrivateFieldGet(_currentHorizontalLinkedNode,this).data}getFirstHorizontalNode(){return focusOrder_classPrivateFieldGet(_cellsHorizontalOrder,this).first.data}getNextHorizontalNode(){return focusOrder_classPrivateFieldGet(_currentHorizontalLinkedNode,this).next.data}getPrevHorizontalNode(){return focusOrder_classPrivateFieldGet(_currentHorizontalLinkedNode,this).prev.data}setPrevNodeAsActive(){focusOrder_classPrivateFieldSet(_currentVerticalLinkedNode,this,focusOrder_classPrivateFieldGet(_currentVerticalLinkedNode,this).prev),focusOrder_classPrivateFieldSet(_currentHorizontalLinkedNode,this,focusOrder_classPrivateFieldGet(_currentHorizontalLinkedNode,this).prev)}setNextNodeAsActive(){focusOrder_classPrivateFieldSet(_currentVerticalLinkedNode,this,focusOrder_classPrivateFieldGet(_currentVerticalLinkedNode,this).next),focusOrder_classPrivateFieldSet(_currentHorizontalLinkedNode,this,focusOrder_classPrivateFieldGet(_currentHorizontalLinkedNode,this).next)}buildFocusOrder(selectedRange){const topStart=selectedRange.getTopStartCorner(),bottomEnd=selectedRange.getBottomEndCorner(),visitedHorizontalCells=new WeakSet;focusOrder_classPrivateFieldSet(_cellsHorizontalOrder,this,new linkedList);for(let r=topStart.row;r<=bottomEnd.row;r++)if(!focusOrder_classPrivateFieldGet(_rowIndexMapper,this).isHidden(r))for(let c=topStart.col;c<=bottomEnd.col;c++){if(focusOrder_classPrivateFieldGet(_columnIndexMapper,this).isHidden(c))continue;const node=focusOrder_assertClassBrand(_FocusOrder_brand,this,_pushOrderNode).call(this,selectedRange,focusOrder_classPrivateFieldGet(_cellsHorizontalOrder,this),visitedHorizontalCells,r,c);node&&focusOrder_classPrivateFieldSet(_currentHorizontalLinkedNode,this,node)}focusOrder_classPrivateFieldGet(_cellsHorizontalOrder,this).first&&(focusOrder_classPrivateFieldGet(_cellsHorizontalOrder,this).first.prev=focusOrder_classPrivateFieldGet(_cellsHorizontalOrder,this).last,focusOrder_classPrivateFieldGet(_cellsHorizontalOrder,this).last.next=focusOrder_classPrivateFieldGet(_cellsHorizontalOrder,this).first);const visitedVerticalCells=new WeakSet;focusOrder_classPrivateFieldSet(_cellsVerticalOrder,this,new linkedList);for(let c=topStart.col;c<=bottomEnd.col;c++)if(!focusOrder_classPrivateFieldGet(_columnIndexMapper,this).isHidden(c))for(let r=topStart.row;r<=bottomEnd.row;r++){if(focusOrder_classPrivateFieldGet(_rowIndexMapper,this).isHidden(r))continue;const node=focusOrder_assertClassBrand(_FocusOrder_brand,this,_pushOrderNode).call(this,selectedRange,focusOrder_classPrivateFieldGet(_cellsVerticalOrder,this),visitedVerticalCells,r,c);node&&focusOrder_classPrivateFieldSet(_currentVerticalLinkedNode,this,node)}focusOrder_classPrivateFieldGet(_cellsVerticalOrder,this).first&&(focusOrder_classPrivateFieldGet(_cellsVerticalOrder,this).first.prev=focusOrder_classPrivateFieldGet(_cellsVerticalOrder,this).last,focusOrder_classPrivateFieldGet(_cellsVerticalOrder,this).last.next=focusOrder_classPrivateFieldGet(_cellsVerticalOrder,this).first)}setActiveNode(row,column){return focusOrder_classPrivateFieldGet(_cellsHorizontalOrder,this).inorder((node=>{const{rowStart,rowEnd,colStart,colEnd}=node.data;if(row>=rowStart&&row<=rowEnd&&column>=colStart&&column<=colEnd)return focusOrder_classPrivateFieldSet(_currentHorizontalLinkedNode,this,node),!1})),focusOrder_classPrivateFieldGet(_cellsVerticalOrder,this).inorder((node=>{const{rowStart,rowEnd,colStart,colEnd}=node.data;if(row>=rowStart&&row<=rowEnd&&column>=colStart&&column<=colEnd)return focusOrder_classPrivateFieldSet(_currentVerticalLinkedNode,this,node),!1})),this}}function _pushOrderNode(selectedRange,listOrder,mergeCellsVisitor,row,column){const topStart=selectedRange.getTopStartCorner(),bottomEnd=selectedRange.getBottomEndCorner(),highlight=selectedRange.highlight.clone().normalize(),mergeParent=focusOrder_classPrivateFieldGet(_mergedCellsGetter,this).call(this,row,column);if(mergeParent&&mergeCellsVisitor.has(mergeParent))return null;const node={colStart:column,colEnd:column,rowStart:row,rowEnd:row};if(mergeParent){if(mergeCellsVisitor.add(mergeParent),mergeParent.row<topStart.row||mergeParent.row+mergeParent.rowspan-1>bottomEnd.row||mergeParent.col<topStart.col||mergeParent.col+mergeParent.colspan-1>bottomEnd.col)return null;node.colStart=mergeParent.col,node.colEnd=mergeParent.col+mergeParent.colspan-1,node.rowStart=mergeParent.row,node.rowEnd=mergeParent.row+mergeParent.rowspan-1}const linkedNode=listOrder.push(node);return row===highlight.row&&column===highlight.col||mergeParent&&highlight.row>=mergeParent.row&&highlight.row<=mergeParent.row+mergeParent.rowspan-1&&highlight.col>=mergeParent.col&&highlight.col<=mergeParent.col+mergeParent.colspan-1?linkedNode:null}function mergeCells_classPrivateFieldInitSpec(e,t,a){mergeCells_checkPrivateRedeclaration(e,t),t.set(e,a)}function mergeCells_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mergeCells_defineProperty(e,r,t){return(r=function mergeCells_toPropertyKey(t){var i=function mergeCells_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function mergeCells_classPrivateFieldSet(s,a,r){return s.set(mergeCells_assertClassBrand(s,a),r),r}function mergeCells_classPrivateFieldGet(s,a){return s.get(mergeCells_assertClassBrand(s,a))}function mergeCells_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("beforeMergeCells"),hooks.R.getSingleton().register("afterMergeCells"),hooks.R.getSingleton().register("beforeUnmergeCells"),hooks.R.getSingleton().register("afterUnmergeCells");var _lastSelectedFocus=new WeakMap,_lastFocusDelta=new WeakMap,_focusOrder=new WeakMap,_cellRenderer=new WeakMap,_MergeCells_brand=new WeakSet;class MergeCells extends BasePlugin{constructor(){super(...arguments),function mergeCells_classPrivateMethodInitSpec(e,a){mergeCells_checkPrivateRedeclaration(e,a),a.add(e)}(this,_MergeCells_brand),mergeCells_defineProperty(this,"mergedCellsCollection",null),mergeCells_defineProperty(this,"autofillCalculations",null),mergeCells_defineProperty(this,"selectionCalculations",null),mergeCells_classPrivateFieldInitSpec(this,_lastSelectedFocus,null),mergeCells_classPrivateFieldInitSpec(this,_lastFocusDelta,{row:0,col:0}),mergeCells_classPrivateFieldInitSpec(this,_focusOrder,new FocusOrder({mergedCellsGetter:(row,column)=>this.mergedCellsCollection.get(row,column),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),mergeCells_classPrivateFieldInitSpec(this,_cellRenderer,function createMergeCellRenderer(plugin){const{hot}=plugin,{rowIndexMapper:rowMapper,columnIndexMapper:columnMapper}=hot;return{before:function before(){},after:function after(TD,row,col){const mergedCell=plugin.mergedCellsCollection.get(row,col);if(!(0,object.Gv)(mergedCell))return TD.removeAttribute("rowspan"),TD.removeAttribute("colspan"),void(TD.style.display="");const{row:origRow,col:origColumn,colspan:origColspan,rowspan:origRowspan}=mergedCell,[lastMergedRowIndex,lastMergedColumnIndex]=plugin.translateMergedCellToRenderable(origRow,origRowspan,origColumn,origColspan),isVirtualRenderingEnabled=plugin.getSetting("virtualized"),maxRowSpan=lastMergedRowIndex-rowMapper.getRenderableFromVisualIndex(row)+1,maxColSpan=lastMergedColumnIndex-columnMapper.getRenderableFromVisualIndex(col)+1;let notHiddenRow=rowMapper.getNearestNotHiddenIndex(origRow,1),notHiddenColumn=columnMapper.getNearestNotHiddenIndex(origColumn,1);if(isVirtualRenderingEnabled){const overlayName=hot.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(overlayName)||(notHiddenRow=Math.max(notHiddenRow,hot.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(overlayName)||(notHiddenColumn=Math.max(notHiddenColumn,hot.getFirstRenderedVisibleColumn()))}const notHiddenRowspan=Math.min(origRowspan,maxRowSpan),notHiddenColspan=Math.min(origColspan,maxColSpan);notHiddenRow===row&&notHiddenColumn===col?(TD.setAttribute("rowspan",notHiddenRowspan),TD.setAttribute("colspan",notHiddenColspan)):(TD.removeAttribute("rowspan"),TD.removeAttribute("colspan"),TD.style.display="none")}}}(this))}static get PLUGIN_KEY(){return"mergeCells"}static get PLUGIN_PRIORITY(){return 150}static get DEFAULT_SETTINGS(){return{[defaultMainSettingSymbol]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings().mergeCells}enablePlugin(){var _this=this;this.enabled||(this.mergedCellsCollection=new cellsCollection(this),this.autofillCalculations=new autofill(this),this.selectionCalculations=new selection(this),this.addHook("afterInit",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return mergeCells_assertClassBrand(_MergeCells_brand,_this,mergeCells_onAfterInit).call(_this,...args)})),this.addHook("modifyTransformFocus",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onModifyTransformFocus).call(_this,...args)})),this.addHook("modifyTransformStart",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onModifyTransformStart).call(_this,...args)})),this.addHook("modifyTransformEnd",(function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onModifyTransformEnd).call(_this,...args)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onBeforeSelectionHighlightSet).call(_this,...args)})),this.addHook("beforeSetRangeStart",(function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onBeforeSetRangeStart).call(_this,...args)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onBeforeSetRangeStart).call(_this,...args)})),this.addHook("beforeSelectionFocusSet",(function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onBeforeSelectionFocusSet).call(_this,...args)})),this.addHook("afterSelectionFocusSet",(function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onAfterSelectionFocusSet).call(_this,...args)})),this.addHook("afterSelectionEnd",(function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return mergeCells_assertClassBrand(_MergeCells_brand,_this,mergeCells_onAfterSelectionEnd).call(_this,...args)})),this.addHook("modifyGetCellCoords",(function(){for(var _len11=arguments.length,args=new Array(_len11),_key11=0;_key11<_len11;_key11++)args[_key11]=arguments[_key11];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onModifyGetCellCoords).call(_this,...args)})),this.addHook("modifyGetCoordsElement",(function(){for(var _len12=arguments.length,args=new Array(_len12),_key12=0;_key12<_len12;_key12++)args[_key12]=arguments[_key12];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onModifyGetCellCoords).call(_this,...args)})),this.addHook("afterIsMultipleSelection",(function(){for(var _len13=arguments.length,args=new Array(_len13),_key13=0;_key13<_len13;_key13++)args[_key13]=arguments[_key13];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onAfterIsMultipleSelection).call(_this,...args)})),this.addHook("afterRenderer",(function(){return mergeCells_classPrivateFieldGet(_cellRenderer,_this).after(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var _len14=arguments.length,args=new Array(_len14),_key14=0;_key14<_len14;_key14++)args[_key14]=arguments[_key14];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_addMergeActionsToContextMenu).call(_this,...args)})),this.addHook("afterGetCellMeta",(function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];return mergeCells_assertClassBrand(_MergeCells_brand,_this,mergeCells_onAfterGetCellMeta).call(_this,...args)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++)args[_key16]=arguments[_key16];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onAfterViewportRowCalculatorOverride).call(_this,...args)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var _len17=arguments.length,args=new Array(_len17),_key17=0;_key17<_len17;_key17++)args[_key17]=arguments[_key17];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onAfterViewportColumnCalculatorOverride).call(_this,...args)})),this.addHook("modifyAutofillRange",(function(){for(var _len18=arguments.length,args=new Array(_len18),_key18=0;_key18<_len18;_key18++)args[_key18]=arguments[_key18];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onModifyAutofillRange).call(_this,...args)})),this.addHook("afterCreateCol",(function(){for(var _len19=arguments.length,args=new Array(_len19),_key19=0;_key19<_len19;_key19++)args[_key19]=arguments[_key19];return mergeCells_assertClassBrand(_MergeCells_brand,_this,mergeCells_onAfterCreateCol).call(_this,...args)})),this.addHook("afterRemoveCol",(function(){for(var _len20=arguments.length,args=new Array(_len20),_key20=0;_key20<_len20;_key20++)args[_key20]=arguments[_key20];return mergeCells_assertClassBrand(_MergeCells_brand,_this,mergeCells_onAfterRemoveCol).call(_this,...args)})),this.addHook("afterCreateRow",(function(){for(var _len21=arguments.length,args=new Array(_len21),_key21=0;_key21<_len21;_key21++)args[_key21]=arguments[_key21];return mergeCells_assertClassBrand(_MergeCells_brand,_this,mergeCells_onAfterCreateRow).call(_this,...args)})),this.addHook("afterRemoveRow",(function(){for(var _len22=arguments.length,args=new Array(_len22),_key22=0;_key22<_len22;_key22++)args[_key22]=arguments[_key22];return mergeCells_assertClassBrand(_MergeCells_brand,_this,mergeCells_onAfterRemoveRow).call(_this,...args)})),this.addHook("afterChange",(function(){for(var _len23=arguments.length,args=new Array(_len23),_key23=0;_key23<_len23;_key23++)args[_key23]=arguments[_key23];return mergeCells_assertClassBrand(_MergeCells_brand,_this,mergeCells_onAfterChange).call(_this,...args)})),this.addHook("beforeDrawBorders",(function(){for(var _len24=arguments.length,args=new Array(_len24),_key24=0;_key24<_len24;_key24++)args[_key24]=arguments[_key24];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onBeforeDrawAreaBorders).call(_this,...args)})),this.addHook("afterDrawSelection",(function(){for(var _len25=arguments.length,args=new Array(_len25),_key25=0;_key25<_len25;_key25++)args[_key25]=arguments[_key25];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onAfterDrawSelection).call(_this,...args)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var _len26=arguments.length,args=new Array(_len26),_key26=0;_key26<_len26;_key26++)args[_key26]=arguments[_key26];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onBeforeRemoveCellClassNames).call(_this,...args)})),this.addHook("beforeBeginEditing",(function(){for(var _len27=arguments.length,args=new Array(_len27),_key27=0;_key27<_len27;_key27++)args[_key27]=arguments[_key27];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onBeforeBeginEditing).call(_this,...args)})),this.addHook("modifyRowHeightByOverlayName",(function(){for(var _len28=arguments.length,args=new Array(_len28),_key28=0;_key28<_len28;_key28++)args[_key28]=arguments[_key28];return mergeCells_assertClassBrand(_MergeCells_brand,_this,_onModifyRowHeightByOverlayName).call(_this,...args)})),this.addHook("beforeUndoStackChange",((action,source)=>{if("MergeCells"===source)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!(0,browser.H8)())return;const rowsToRefresh=[];let rowIndexesToRefresh=[];this.mergedCellsCollection.mergedCells.forEach((mergedCell=>{const{row,rowspan}=mergedCell;for(let r=row+1;r<row+rowspan;r++)rowIndexesToRefresh.push(r)})),rowIndexesToRefresh=[...new Set(rowIndexesToRefresh)],rowIndexesToRefresh.forEach((rowIndex=>{const renderableRowIndex=this.hot.rowIndexMapper.getRenderableFromVisualIndex(rowIndex);this.hot.view._wt.wtOverlays.getOverlays(!0).map((overlay=>"master"===(null==overlay?void 0:overlay.name)?overlay:overlay.clone.wtTable)).forEach((wtTableRef=>{const rowToRefresh=wtTableRef.getRow(renderableRowIndex);rowToRefresh&&(rowToRefresh.style.background=(0,dom_element.gd)(rowToRefresh,"backgroundColor").replace(")",", 0.99)"),rowsToRefresh.push(rowToRefresh))}))})),this.hot._registerTimeout((()=>{rowsToRefresh.forEach((rowElement=>{rowElement.style.background=(0,dom_element.gd)(rowElement,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(setting){return!!setting&&(cellCoords.containsNegativeValues(setting)?((0,helpers_console.R8)(cellCoords.NEGATIVE_VALUES_WARNING(setting)),!1):cellCoords.isOutOfBounds(setting,this.hot.countRows(),this.hot.countCols())?((0,helpers_console.R8)(cellCoords.IS_OUT_OF_BOUNDS_WARNING(setting)),!1):cellCoords.isSingleCell(setting)?((0,helpers_console.R8)(cellCoords.IS_SINGLE_CELL(setting)),!1):!cellCoords.containsZeroSpan(setting)||((0,helpers_console.R8)(cellCoords.ZERO_SPAN_WARNING(setting)),!1))}generateFromSettings(){const validSettings=this.getSetting("cells").filter((mergeCellInfo=>this.validateSetting(mergeCellInfo))),nonOverlappingSettings=this.mergedCellsCollection.filterOverlappingMergeCells(validSettings),populatedNulls=[];nonOverlappingSettings.forEach((mergeCellInfo=>{const{row,col,rowspan,colspan}=mergeCellInfo,from=this.hot._createCellCoords(row,col),to=this.hot._createCellCoords(row+rowspan-1,col+colspan-1),mergeRange=this.hot._createCellRange(from,from,to);this.mergeRange(mergeRange,!0,!0);for(let r=row;r<row+rowspan;r++)for(let c=col;c<col+colspan;c++)r===row&&c===col||populatedNulls.push([r,c,null])})),0!==populatedNulls.length&&this.hot.setDataAtCell(populatedNulls,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(newMergedCellInfo){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(newMergedCellInfo)}mergeSelection(){let cellRange=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!cellRange)return;cellRange.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from,to}=cellRange;this.unmergeRange(cellRange,!0),this.mergeRange(cellRange),this.hot.selectCell(from.row,from.col,to.row,to.col,!1)}unmergeSelection(){let cellRange=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!cellRange)return;const{from,to}=cellRange;this.unmergeRange(cellRange,!0),this.hot.selectCell(from.row,from.col,to.row,to.col,!1)}mergeRange(cellRange){let auto=arguments.length>1&&void 0!==arguments[1]&&arguments[1],preventPopulation=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const topStart=cellRange.getTopStartCorner(),bottomEnd=cellRange.getBottomEndCorner(),mergeParent={row:topStart.row,col:topStart.col,rowspan:bottomEnd.row-topStart.row+1,colspan:bottomEnd.col-topStart.col+1},clearedData=[];let populationInfo=null;if(!this.canMergeRange(mergeParent,auto))return!1;this.hot.runHooks("beforeMergeCells",cellRange,auto),(0,number.Ti)(0,mergeParent.rowspan-1,(i=>{(0,number.Ti)(0,mergeParent.colspan-1,(j=>{let clearedValue=null;clearedData[i]||(clearedData[i]=[]),0===i&&0===j?clearedValue=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(mergeParent.row),this.hot.toPhysicalColumn(mergeParent.col)):this.hot.setCellMeta(mergeParent.row+i,mergeParent.col+j,"hidden",!0),clearedData[i][j]=clearedValue}))})),this.hot.setCellMeta(mergeParent.row,mergeParent.col,"spanned",!0);return!this.mergedCellsCollection.add(mergeParent,auto)||(preventPopulation?populationInfo=[mergeParent.row,mergeParent.col,clearedData]:this.hot.populateFromArray(mergeParent.row,mergeParent.col,clearedData,void 0,void 0,this.pluginName),auto||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",cellRange,mergeParent,auto),populationInfo)}unmergeRange(cellRange){let auto=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const mergedCells=this.mergedCellsCollection.getWithinRange(cellRange);0!==mergedCells.length&&(this.hot.runHooks("beforeUnmergeCells",cellRange,auto),(0,array.z0)(mergedCells,(currentCollection=>{this.mergedCellsCollection.remove(currentCollection.row,currentCollection.col),(0,number.Ti)(0,currentCollection.rowspan-1,(i=>{(0,number.Ti)(0,currentCollection.colspan-1,(j=>{this.hot.removeCellMeta(currentCollection.row+i,currentCollection.col+j,"hidden"),this.hot.removeCellMeta(currentCollection.row+i,currentCollection.col+j,"copyable")}))})),this.hot.removeCellMeta(currentCollection.row,currentCollection.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",cellRange,auto),this.hot.render())}toggleMerge(cellRange){const mergedCell=this.mergedCellsCollection.get(cellRange.from.row,cellRange.from.col);mergedCell.row===cellRange.from.row&&mergedCell.col===cellRange.from.col&&mergedCell.row+mergedCell.rowspan-1===cellRange.to.row&&mergedCell.col+mergedCell.colspan-1===cellRange.to.col?this.unmergeRange(cellRange):this.mergeSelection(cellRange)}merge(startRow,startColumn,endRow,endColumn){const start=this.hot._createCellCoords(startRow,startColumn),end=this.hot._createCellCoords(endRow,endColumn);this.mergeRange(this.hot._createCellRange(start,start,end))}unmerge(startRow,startColumn,endRow,endColumn){const start=this.hot._createCellCoords(startRow,startColumn),end=this.hot._createCellCoords(endRow,endColumn);this.unmergeRange(this.hot._createCellRange(start,start,end))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const range=this.hot.getSelectedRangeLast();range&&!range.isSingleHeader()&&(this.toggleMerge(range),this.hot.render())},runOnlyIf:event=>!event.altKey,group:"mergeCells"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("mergeCells")}modifyViewportRowStart(calc,nrOfColumns){const rowMapper=this.hot.rowIndexMapper,visualStartRow=rowMapper.getVisualFromRenderableIndex(calc.startRow);for(let visualColumnIndex=0;visualColumnIndex<nrOfColumns;visualColumnIndex+=1){const mergeParentForViewportStart=this.mergedCellsCollection.get(visualStartRow,visualColumnIndex);if((0,object.Gv)(mergeParentForViewportStart)){const renderableIndexAtMergeStart=rowMapper.getRenderableFromVisualIndex(rowMapper.getNearestNotHiddenIndex(mergeParentForViewportStart.row,1));if(renderableIndexAtMergeStart<calc.startRow)return calc.startRow=renderableIndexAtMergeStart,void this.modifyViewportRowStart(calc,nrOfColumns)}}}modifyViewportRowEnd(calc,nrOfColumns){const rowMapper=this.hot.rowIndexMapper,visualEndRow=rowMapper.getVisualFromRenderableIndex(calc.endRow);for(let visualColumnIndex=0;visualColumnIndex<nrOfColumns;visualColumnIndex+=1){const mergeParentForViewportEnd=this.mergedCellsCollection.get(visualEndRow,visualColumnIndex);if((0,object.Gv)(mergeParentForViewportEnd)){const mergeEnd=mergeParentForViewportEnd.row+mergeParentForViewportEnd.rowspan-1,renderableIndexAtMergeEnd=rowMapper.getRenderableFromVisualIndex(rowMapper.getNearestNotHiddenIndex(mergeEnd,-1));if(renderableIndexAtMergeEnd>calc.endRow)return calc.endRow=renderableIndexAtMergeEnd,void this.modifyViewportRowEnd(calc,nrOfColumns)}}}modifyViewportColumnStart(calc,nrOfRows){const columnMapper=this.hot.columnIndexMapper,visualStartCol=columnMapper.getVisualFromRenderableIndex(calc.startColumn);for(let visualRowIndex=0;visualRowIndex<nrOfRows;visualRowIndex+=1){const mergeParentForViewportStart=this.mergedCellsCollection.get(visualRowIndex,visualStartCol);if((0,object.Gv)(mergeParentForViewportStart)){const renderableIndexAtMergeStart=columnMapper.getRenderableFromVisualIndex(columnMapper.getNearestNotHiddenIndex(mergeParentForViewportStart.col,1));if(renderableIndexAtMergeStart<calc.startColumn)return calc.startColumn=renderableIndexAtMergeStart,void this.modifyViewportColumnStart(calc,nrOfRows)}}}modifyViewportColumnEnd(calc,nrOfRows){const columnMapper=this.hot.columnIndexMapper,visualEndCol=columnMapper.getVisualFromRenderableIndex(calc.endColumn);for(let visualRowIndex=0;visualRowIndex<nrOfRows;visualRowIndex+=1){const mergeParentForViewportEnd=this.mergedCellsCollection.get(visualRowIndex,visualEndCol);if((0,object.Gv)(mergeParentForViewportEnd)){const mergeEnd=mergeParentForViewportEnd.col+mergeParentForViewportEnd.colspan-1,renderableIndexAtMergeEnd=columnMapper.getRenderableFromVisualIndex(columnMapper.getNearestNotHiddenIndex(mergeEnd,-1));if(renderableIndexAtMergeEnd>calc.endColumn)return calc.endColumn=renderableIndexAtMergeEnd,void this.modifyViewportColumnEnd(calc,nrOfRows)}}}translateMergedCellToRenderable(parentRow,rowspan,parentColumn,colspan){const{rowIndexMapper:rowMapper,columnIndexMapper:columnMapper}=this.hot;let firstNonHiddenRow,firstNonHiddenColumn;firstNonHiddenRow=0===rowspan?rowMapper.getNearestNotHiddenIndex(parentRow,1):rowMapper.getNearestNotHiddenIndex(parentRow+rowspan-1,-1),firstNonHiddenColumn=0===colspan?columnMapper.getNearestNotHiddenIndex(parentColumn,1):columnMapper.getNearestNotHiddenIndex(parentColumn+colspan-1,-1);return[parentRow>=0?rowMapper.getRenderableFromVisualIndex(firstNonHiddenRow):parentRow,parentColumn>=0?columnMapper.getRenderableFromVisualIndex(firstNonHiddenColumn):parentColumn]}}function mergeCells_onAfterInit(){this.generateFromSettings(),this.hot.render()}function _onAfterIsMultipleSelection(isMultiple){if(isMultiple){const mergedCells=this.mergedCellsCollection.mergedCells,selectionRange=this.hot.getSelectedRangeLast(),topStartCoords=selectionRange.getTopStartCorner(),bottomEndCoords=selectionRange.getBottomEndCorner();for(let group=0;group<mergedCells.length;group+=1)if(topStartCoords.row===mergedCells[group].row&&topStartCoords.col===mergedCells[group].col&&bottomEndCoords.row===mergedCells[group].row+mergedCells[group].rowspan-1&&bottomEndCoords.col===mergedCells[group].col+mergedCells[group].colspan-1)return!1}return isMultiple}function _onModifyTransformFocus(delta){mergeCells_classPrivateFieldGet(_lastFocusDelta,this).row=delta.row,mergeCells_classPrivateFieldGet(_lastFocusDelta,this).col=delta.col}function _onModifyTransformStart(delta){const selectedRange=this.hot.getSelectedRangeLast(),{highlight}=selectedRange,{columnIndexMapper,rowIndexMapper}=this.hot;mergeCells_classPrivateFieldGet(_lastSelectedFocus,this)&&(null!==rowIndexMapper.getRenderableFromVisualIndex(mergeCells_classPrivateFieldGet(_lastSelectedFocus,this).row)&&(highlight.row=mergeCells_classPrivateFieldGet(_lastSelectedFocus,this).row),null!==columnIndexMapper.getRenderableFromVisualIndex(mergeCells_classPrivateFieldGet(_lastSelectedFocus,this).col)&&(highlight.col=mergeCells_classPrivateFieldGet(_lastSelectedFocus,this).col),mergeCells_classPrivateFieldSet(_lastSelectedFocus,this,null));const mergedParent=this.mergedCellsCollection.get(highlight.row,highlight.col);if(!mergedParent)return;const visualColumnIndexStart=mergedParent.col,visualColumnIndexEnd=mergedParent.col+mergedParent.colspan-1;if(delta.col<0){const nextColumn=highlight.col>=visualColumnIndexStart&&highlight.col<=visualColumnIndexEnd?visualColumnIndexStart-1:visualColumnIndexEnd,notHiddenColumnIndex=columnIndexMapper.getNearestNotHiddenIndex(nextColumn,-1);delta.col=null===notHiddenColumnIndex?-this.hot.view.countRenderableColumnsInRange(0,highlight.col):-Math.max(this.hot.view.countRenderableColumnsInRange(notHiddenColumnIndex,highlight.col)-1,1)}else if(delta.col>0){const nextColumn=highlight.col>=visualColumnIndexStart&&highlight.col<=visualColumnIndexEnd?visualColumnIndexEnd+1:visualColumnIndexStart,notHiddenColumnIndex=columnIndexMapper.getNearestNotHiddenIndex(nextColumn,1);delta.col=null===notHiddenColumnIndex?this.hot.view.countRenderableColumnsInRange(highlight.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(highlight.col,notHiddenColumnIndex)-1,1)}const visualRowIndexStart=mergedParent.row,visualRowIndexEnd=mergedParent.row+mergedParent.rowspan-1;if(delta.row<0){const nextRow=highlight.row>=visualRowIndexStart&&highlight.row<=visualRowIndexEnd?visualRowIndexStart-1:visualRowIndexEnd,notHiddenRowIndex=rowIndexMapper.getNearestNotHiddenIndex(nextRow,-1);delta.row=null===notHiddenRowIndex?-this.hot.view.countRenderableRowsInRange(0,highlight.row):-Math.max(this.hot.view.countRenderableRowsInRange(notHiddenRowIndex,highlight.row)-1,1)}else if(delta.row>0){const nextRow=highlight.row>=visualRowIndexStart&&highlight.row<=visualRowIndexEnd?visualRowIndexEnd+1:visualRowIndexStart,notHiddenRowIndex=rowIndexMapper.getNearestNotHiddenIndex(nextRow,1);delta.row=null===notHiddenRowIndex?this.hot.view.countRenderableRowsInRange(highlight.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(highlight.row,notHiddenRowIndex)-1,1)}}function _onModifyTransformEnd(delta){const selectedRange=this.hot.getSelectedRangeLast(),cloneRange=selectedRange.clone(),{to}=selectedRange,{columnIndexMapper,rowIndexMapper}=this.hot,expandCloneRange=(row,col)=>{cloneRange.expand(this.hot._createCellCoords(row,col));for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)cloneRange.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange())};if(delta.col<0){let nextColumn=this.mergedCellsCollection.getStartMostColumnIndex(selectedRange,to.col)+delta.col;expandCloneRange(to.row,nextColumn),"E-W"===selectedRange.getHorizontalDirection()&&"E-W"===cloneRange.getHorizontalDirection()&&(nextColumn=cloneRange.getTopStartCorner().col);const notHiddenColumnIndex=columnIndexMapper.getNearestNotHiddenIndex(nextColumn,1);null!==notHiddenColumnIndex&&(delta.col=-Math.max(this.hot.view.countRenderableColumnsInRange(notHiddenColumnIndex,to.col)-1,1))}else if(delta.col>0){let nextColumn=this.mergedCellsCollection.getEndMostColumnIndex(selectedRange,to.col)+delta.col;expandCloneRange(to.row,nextColumn),"W-E"===selectedRange.getHorizontalDirection()&&"W-E"===cloneRange.getHorizontalDirection()&&(nextColumn=cloneRange.getBottomEndCorner().col);const notHiddenColumnIndex=columnIndexMapper.getNearestNotHiddenIndex(nextColumn,-1);null!==notHiddenColumnIndex&&(delta.col=Math.max(this.hot.view.countRenderableColumnsInRange(to.col,notHiddenColumnIndex)-1,1))}if(delta.row<0){let nextRow=this.mergedCellsCollection.getTopMostRowIndex(selectedRange,to.row)+delta.row;expandCloneRange(nextRow,to.col),"S-N"===selectedRange.getVerticalDirection()&&"S-N"===cloneRange.getVerticalDirection()&&(nextRow=cloneRange.getTopStartCorner().row);const notHiddenRowIndex=rowIndexMapper.getNearestNotHiddenIndex(nextRow,1);null!==notHiddenRowIndex&&(delta.row=-Math.max(this.hot.view.countRenderableRowsInRange(notHiddenRowIndex,to.row)-1,1))}else if(delta.row>0){let nextRow=this.mergedCellsCollection.getBottomMostRowIndex(selectedRange,to.row)+delta.row;expandCloneRange(nextRow,to.col),"N-S"===selectedRange.getVerticalDirection()&&"N-S"===cloneRange.getVerticalDirection()&&(nextRow=cloneRange.getBottomStartCorner().row);const notHiddenRowIndex=rowIndexMapper.getNearestNotHiddenIndex(nextRow,-1);null!==notHiddenRowIndex&&(delta.row=Math.max(this.hot.view.countRenderableRowsInRange(to.row,notHiddenRowIndex)-1,1))}}function _onBeforeSelectionHighlightSet(){const selectedRange=this.hot.getSelectedRangeLast(),{highlight}=selectedRange;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void mergeCells_classPrivateFieldSet(_lastSelectedFocus,this,highlight.clone());for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)selectedRange.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)selectedRange.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const mergedParent=this.mergedCellsCollection.get(highlight.row,highlight.col);mergeCells_classPrivateFieldSet(_lastSelectedFocus,this,highlight.clone()),mergedParent&&highlight.assign(mergedParent)}function _onModifyGetCellCoords(row,column,topmost,source){if(row<0||column<0)return;const mergeParent=this.mergedCellsCollection.get(row,column);if(!mergeParent)return;const{row:mergeRow,col:mergeColumn,colspan,rowspan}=mergeParent,topStartRow=mergeRow,topStartColumn=mergeColumn,bottomEndRow=mergeRow+rowspan-1,bottomEndColumn=mergeColumn+colspan-1;if("render"===source&&this.getSetting("virtualized")){const overlayName=this.hot.view.getActiveOverlayName(),firstRenderedRow=["top","top_inline_start_corner"].includes(overlayName)?0:this.hot.getFirstRenderedVisibleRow(),firstRenderedColumn=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(overlayName)?0:this.hot.getFirstRenderedVisibleColumn();return[(0,number.qE)(firstRenderedRow,topStartRow,bottomEndRow),(0,number.qE)(firstRenderedColumn,topStartColumn,bottomEndColumn),(0,number.qE)(this.hot.getLastRenderedVisibleRow(),topStartRow,bottomEndRow),(0,number.qE)(this.hot.getLastRenderedVisibleColumn(),topStartColumn,bottomEndColumn)]}return[topStartRow,topStartColumn,bottomEndRow,bottomEndColumn]}function _addMergeActionsToContextMenu(defaultOptions){defaultOptions.items.push({name:"---------"},function toggleMergeItem(plugin){return{key:"mergeCells",name(){const sel=this.getSelectedLast();if(sel){const info=plugin.mergedCellsCollection.get(sel[0],sel[1]);if(info.row===sel[0]&&info.col===sel[1]&&info.row+info.rowspan-1===sel[2]&&info.col+info.colspan-1===sel[3])return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){const currentRange=this.getSelectedRangeLast();if(!currentRange)return;currentRange.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from,to}=currentRange;plugin.toggleMerge(currentRange),this.selectCell(from.row,from.col,to.row,to.col,!1)},disabled(){const sel=this.getSelectedLast();return!sel||(cellCoords.isSingleCell({row:sel[0],col:sel[1],rowspan:sel[2]-sel[0]+1,colspan:sel[3]-sel[1]+1})||this.selection.isSelectedByCorner())},hidden:!1}}(this))}function _onBeforeSetRangeStart(){mergeCells_classPrivateFieldSet(_lastSelectedFocus,this,null)}function _onBeforeSelectionFocusSet(){if(mergeCells_classPrivateFieldGet(_lastSelectedFocus,this).isCell())return;const selectedRange=this.hot.getSelectedRangeLast(),verticalDir=selectedRange.getVerticalDirection(),horizontalDir=selectedRange.getHorizontalDirection(),focusCoords=mergeCells_classPrivateFieldGet(_lastSelectedFocus,this).clone().normalize();mergeCells_classPrivateFieldGet(_focusOrder,this).setActiveNode(focusCoords.row,focusCoords.col),mergeCells_classPrivateFieldGet(_lastFocusDelta,this).row>0||mergeCells_classPrivateFieldGet(_lastFocusDelta,this).col>0?mergeCells_classPrivateFieldGet(_focusOrder,this).setPrevNodeAsActive():("E-W"===horizontalDir&&mergeCells_classPrivateFieldGet(_lastFocusDelta,this).col<0||"S-N"===verticalDir&&mergeCells_classPrivateFieldGet(_lastFocusDelta,this).row<0)&&mergeCells_classPrivateFieldGet(_focusOrder,this).setNextNodeAsActive()}function _onAfterSelectionFocusSet(row,column){const selectedRange=this.hot.getSelectedRangeLast(),{columnIndexMapper,rowIndexMapper}=this.hot;let notHiddenRowIndex=null,notHiddenColumnIndex=null;if(mergeCells_classPrivateFieldGet(_lastFocusDelta,this).col<0){const{rowEnd,colEnd}=mergeCells_classPrivateFieldGet(_focusOrder,this).getPrevHorizontalNode();notHiddenColumnIndex=columnIndexMapper.getNearestNotHiddenIndex(colEnd,-1),notHiddenRowIndex=rowIndexMapper.getNearestNotHiddenIndex(rowEnd,-1)}else if(mergeCells_classPrivateFieldGet(_lastFocusDelta,this).col>0){const{rowStart,colStart}=mergeCells_classPrivateFieldGet(_focusOrder,this).getNextHorizontalNode();notHiddenColumnIndex=columnIndexMapper.getNearestNotHiddenIndex(colStart,1),notHiddenRowIndex=rowIndexMapper.getNearestNotHiddenIndex(rowStart,1)}else if(mergeCells_classPrivateFieldGet(_lastFocusDelta,this).row<0){const{rowEnd,colEnd}=mergeCells_classPrivateFieldGet(_focusOrder,this).getPrevVerticalNode();notHiddenColumnIndex=columnIndexMapper.getNearestNotHiddenIndex(colEnd,-1),notHiddenRowIndex=rowIndexMapper.getNearestNotHiddenIndex(rowEnd,-1)}else if(mergeCells_classPrivateFieldGet(_lastFocusDelta,this).row>0){const{rowStart,colStart}=mergeCells_classPrivateFieldGet(_focusOrder,this).getNextVerticalNode();notHiddenColumnIndex=columnIndexMapper.getNearestNotHiddenIndex(colStart,1),notHiddenRowIndex=rowIndexMapper.getNearestNotHiddenIndex(rowStart,1)}if(null!==notHiddenRowIndex||null!==notHiddenColumnIndex){const coords=this.hot._createCellCoords(notHiddenRowIndex,notHiddenColumnIndex),mergeParent=this.mergedCellsCollection.get(coords.row,coords.col),focusHighlight=this.hot.selection.highlight.getFocus();row=coords.row,column=coords.col,mergeParent?selectedRange.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(mergeParent.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(mergeParent.col,1)}):selectedRange.highlight.assign(coords),focusHighlight.clear(),focusHighlight.add(coords).commit()}mergeCells_classPrivateFieldGet(_focusOrder,this).setActiveNode(row,column),mergeCells_classPrivateFieldSet(_lastFocusDelta,this,{row:0,col:0})}function mergeCells_onAfterSelectionEnd(){this.hot.getSelectedRangeLast().isHeader()||mergeCells_classPrivateFieldGet(_focusOrder,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function mergeCells_onAfterGetCellMeta(row,col,cellProperties){const mergeParent=this.mergedCellsCollection.get(row,col);mergeParent&&(mergeParent.row!==row||mergeParent.col!==col?cellProperties.copyable=!1:(cellProperties.rowspan=mergeParent.rowspan,cellProperties.colspan=mergeParent.colspan))}function _onAfterViewportRowCalculatorOverride(calc){if(this.getSetting("virtualized"))return;const nrOfColumns=this.hot.countCols();this.modifyViewportRowStart(calc,nrOfColumns),this.modifyViewportRowEnd(calc,nrOfColumns)}function _onAfterViewportColumnCalculatorOverride(calc){if(this.getSetting("virtualized"))return;const nrOfRows=this.hot.countRows();this.modifyViewportColumnStart(calc,nrOfRows),this.modifyViewportColumnEnd(calc,nrOfRows)}function _onModifyAutofillRange(fullArea,baseArea){const dragDirection=this.autofillCalculations.getDirection(baseArea,fullArea);if(this.autofillCalculations.dragAreaOverlapsCollections(baseArea,fullArea,dragDirection))return baseArea;const from=this.hot._createCellCoords(baseArea[0],baseArea[1]),to=this.hot._createCellCoords(baseArea[2],baseArea[3]),range=this.hot._createCellRange(from,from,to),mergedCellsWithinSelectionArea=this.mergedCellsCollection.getWithinRange(range);return 0===mergedCellsWithinSelectionArea.length?fullArea:this.autofillCalculations.snapDragArea(baseArea,fullArea,dragDirection,mergedCellsWithinSelectionArea)}function mergeCells_onAfterCreateCol(column,count){this.mergedCellsCollection.shiftCollections("right",column,count)}function mergeCells_onAfterRemoveCol(column,count){this.mergedCellsCollection.shiftCollections("left",column,count)}function mergeCells_onAfterCreateRow(row,count,source){"auto"!==source&&this.mergedCellsCollection.shiftCollections("down",row,count)}function mergeCells_onAfterRemoveRow(row,count){this.mergedCellsCollection.shiftCollections("up",row,count)}function mergeCells_onAfterChange(changes,source){"Autofill.fill"===source&&this.autofillCalculations.recreateAfterDataPopulation(changes)}function _onBeforeDrawAreaBorders(corners,className){if(className&&"area"===className){const selectedRange=this.hot.getSelectedRangeLast(),mergedCellsWithinRange=this.mergedCellsCollection.getWithinRange(selectedRange);(0,array.z0)(mergedCellsWithinRange,(mergedCell=>{selectedRange.getBottomEndCorner().row===mergedCell.getLastRow()&&selectedRange.getBottomEndCorner().col===mergedCell.getLastColumn()&&(corners[2]=mergedCell.row,corners[3]=mergedCell.col)}))}}function _onAfterDrawSelection(currentRow,currentColumn,cornersOfSelection,layerLevel){if(cornersOfSelection)return this.selectionCalculations.getSelectedMergedCellClassName(currentRow,currentColumn,cornersOfSelection,layerLevel)}function _onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _onBeforeBeginEditing(row,column,initialValue,event){if(!(event instanceof MouseEvent))return;const selection=this.hot.getSelectedRangeLast(),mergeCell=this.mergedCellsCollection.getByRange(selection);if(!mergeCell)return;const from=this.hot._createCellCoords(mergeCell.row,mergeCell.col),to=this.hot._createCellCoords(mergeCell.row+mergeCell.rowspan-1,mergeCell.col+mergeCell.colspan-1);return 0===this.hot.selection.getLayerLevel()&&selection.isEqual(this.hot._createCellRange(from,from,to))}function _onModifyRowHeightByOverlayName(height,row,overlayType){if(this.hot.getSettings().rowHeaders||"bottom"===overlayType||"bottom_inline_start_corner"===overlayType)return height;let firstColumn,lastColumn;if("master"===overlayType)firstColumn=this.hot.getFirstRenderedVisibleColumn(),lastColumn=this.hot.getLastRenderedVisibleColumn();else{const activeOverlay=this.hot.view.getOverlayByName(overlayType);firstColumn=this.hot.columnIndexMapper.getVisualFromRenderableIndex(activeOverlay.clone.wtTable.getFirstRenderedColumn()),lastColumn=this.hot.columnIndexMapper.getVisualFromRenderableIndex(activeOverlay.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(row,firstColumn))return height;const from=this.hot._createCellCoords(row,firstColumn),to=this.hot._createCellCoords(row,lastColumn),viewportRange=this.hot._createCellRange(from,from,to),mergedCellsWithinRange=this.mergedCellsCollection.getWithinRange(viewportRange,!0),maxRowspan=mergedCellsWithinRange.reduce(((acc,_ref)=>{let{rowspan}=_ref;return Math.max(acc,rowspan)}),1);let rowspanCorrection=0;return mergedCellsWithinRange.length>1&&mergedCellsWithinRange[0].rowspan<maxRowspan&&(rowspanCorrection=maxRowspan-mergedCellsWithinRange[0].rowspan),mergedCellsWithinRange.forEach((_ref2=>{let{rowspan}=_ref2,rowspanAfterCorrection=0;rowspanAfterCorrection="top"===overlayType||"top_inline_start_corner"===overlayType?Math.min(maxRowspan,this.hot.view.countNotHiddenFixedRowsTop()-row):rowspan-rowspanCorrection,height=Math.max(null!=height?height:0,mergeCells_assertClassBrand(_MergeCells_brand,this,_sumCellsHeights).call(this,row,rowspanAfterCorrection))})),height}function _sumCellsHeights(row,rowspan){const{view,rowIndexMapper}=this.hot,stylesHandler=view.getStylesHandler(),defaultHeight=view.getDefaultRowHeight();let height=0;for(let i=row;i<row+rowspan;i++){var _this$hot$getRowHeigh;if(!rowIndexMapper.isHidden(i))height+=null!==(_this$hot$getRowHeigh=this.hot.getRowHeight(i))&&void 0!==_this$hot$getRowHeigh?_this$hot$getRowHeigh:defaultHeight,0!==i||stylesHandler.isClassicTheme()||(height+=1)}return height}function multiColumnSorting_defineProperty(e,r,t){return(r=function multiColumnSorting_toPropertyKey(t){var i=function multiColumnSorting_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}registerRootComparator("multiColumnSorting",(function rootComparator_rootComparator(sortingOrders,columnMetas){return function(rowIndexWithValues,nextRowIndexWithValues){const[,...values]=rowIndexWithValues,[,...nextValues]=nextRowIndexWithValues;return function getCompareResult(column){const sortingOrder=sortingOrders[column],columnMeta=columnMetas[column],value=values[column],nextValue=nextValues[column],pluginSettings=columnMeta.multiColumnSorting,compareResult=(pluginSettings.compareFunctionFactory?pluginSettings.compareFunctionFactory:getCompareFunctionFactory(columnMeta.type))(sortingOrder,columnMeta,pluginSettings)(value,nextValue);if(compareResult===DO_NOT_SWAP){const nextSortedColumn=column+1;if(void 0!==columnMetas[nextSortedColumn])return getCompareResult(nextSortedColumn)}return compareResult}(0)}}));class MultiColumnSorting extends ColumnSorting{constructor(){super(...arguments),multiColumnSorting_defineProperty(this,"pluginKey","multiColumnSorting")}static get PLUGIN_KEY(){return"multiColumnSorting"}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight}=this.hot.getSelectedRangeLast();return-1===highlight.row&&highlight.col>=0&&this.sort(this.getNextSortConfig(highlight.col,"append")),!1},runOnlyIf:()=>{var _this$hot$getSelected,_this$hot$getSelected2;const highlight=null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.highlight;return highlight&&(null===(_this$hot$getSelected2=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected2?void 0:_this$hot$getSelected2.isSingle())&&this.hot.selection.isCellVisible(highlight)&&highlight.isHeader()},relativeToGroup:constants.b,position:"before",group:"multiColumnSorting"})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("multiColumnSorting")}sort(sortConfig){super.sort(sortConfig)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(column){return super.getSortConfig(column)}setSortConfig(sortConfig){super.setSortConfig(sortConfig)}getNormalizedSortConfigs(){let sortConfig=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(sortConfig)?sortConfig:[sortConfig]}updateHeaderClasses(headerSpanElement){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];super.updateHeaderClasses(headerSpanElement,...args),(0,dom_element.vy)(headerSpanElement,function domHelpers_getClassesToRemove(htmlElement){const cssClasses=htmlElement.className.split(" "),sortSequenceRegExp=new RegExp("^sort-[0-9]{1,2}$");return cssClasses.filter((cssClass=>sortSequenceRegExp.test(cssClass)))}(headerSpanElement)),!1!==this.enabled&&(0,dom_element.iQ)(headerSpanElement,function domHelpers_getClassesToAdd(columnStatesManager,column,showSortIndicator){const cssClasses=[];return!1===showSortIndicator||columnStatesManager.isColumnSorted(column)&&columnStatesManager.getNumberOfSortedColumns()>1&&cssClasses.push(`sort-${columnStatesManager.getIndexOfColumnInSortQueue(column)+1}`),cssClasses}(...args))}onAfterOnCellMouseDown(event,coords){!1!==wasHeaderClickedProperly(coords.row,coords.col,event)&&this.wasClickableHeaderClicked(event,coords.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(coords.col),this.sort(this.getNextSortConfig(coords.col,"append"))):this.sort(this.getColumnNextConfig(coords.col)))}}function multipleSelectionHandles_defineProperty(e,r,t){return(r=function multipleSelectionHandles_toPropertyKey(t){var i=function multipleSelectionHandles_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class MultipleSelectionHandles extends BasePlugin{constructor(){super(...arguments),multipleSelectionHandles_defineProperty(this,"dragged",[]),multipleSelectionHandles_defineProperty(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return(0,browser.rr)()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const _this=this,{rootElement}=this.hot;function removeFromDragged(query){if(1===_this.dragged.length)return _this.dragged.splice(0,_this.dragged.length),!0;const entryPosition=_this.dragged.indexOf(query);if(-1===entryPosition)return!1;0===entryPosition?_this.dragged=_this.dragged.slice(0,1):1===entryPosition&&(_this.dragged=_this.dragged.slice(-1))}this.eventManager.addEventListener(rootElement,"touchstart",(event=>{let selectedRange;return(0,dom_element.nB)(event.target,"topSelectionHandle-HitArea")?(selectedRange=_this.hot.getSelectedRangeLast(),_this.dragged.push("top"),_this.touchStartRange={width:selectedRange.getWidth(),height:selectedRange.getHeight(),direction:selectedRange.getDirection()},event.preventDefault(),!1):(0,dom_element.nB)(event.target,"bottomSelectionHandle-HitArea")?(selectedRange=_this.hot.getSelectedRangeLast(),_this.dragged.push("bottom"),_this.touchStartRange={width:selectedRange.getWidth(),height:selectedRange.getHeight(),direction:selectedRange.getDirection()},event.preventDefault(),!1):void 0})),this.eventManager.addEventListener(rootElement,"touchend",(event=>(0,dom_element.nB)(event.target,"topSelectionHandle-HitArea")?(removeFromDragged.call(_this,"top"),_this.touchStartRange=void 0,event.preventDefault(),!1):(0,dom_element.nB)(event.target,"bottomSelectionHandle-HitArea")?(removeFromDragged.call(_this,"bottom"),_this.touchStartRange=void 0,event.preventDefault(),!1):void 0)),this.eventManager.addEventListener(rootElement,"touchmove",(event=>{const{rootDocument}=this.hot;let targetCoords,selectedRange,rangeWidth,rangeHeight,rangeDirection,newRangeCoords;if(0===_this.dragged.length)return;const endTarget=rootDocument.elementFromPoint(event.touches[0].clientX,event.touches[0].clientY);endTarget&&endTarget!==_this.lastSetCell&&("TD"!==endTarget.nodeName&&"TH"!==endTarget.nodeName||(targetCoords=_this.hot.getCoords(endTarget),-1===targetCoords.col&&(targetCoords.col=0),selectedRange=_this.hot.getSelectedRangeLast(),rangeWidth=selectedRange.getWidth(),rangeHeight=selectedRange.getHeight(),rangeDirection=selectedRange.getDirection(),1===rangeWidth&&1===rangeHeight&&_this.hot.selection.setRangeEnd(targetCoords),newRangeCoords=_this.getCurrentRangeCoords(selectedRange,targetCoords,_this.touchStartRange.direction,rangeDirection,_this.dragged[0]),null!==newRangeCoords.start&&_this.hot.selection.setRangeStart(newRangeCoords.start),_this.hot.selection.setRangeEnd(newRangeCoords.end),_this.lastSetCell=endTarget),event.preventDefault())}))}getCurrentRangeCoords(selectedRange,currentTouch,touchStartDirection,currentDirection,draggedHandle){const topStartCorner=selectedRange.getTopStartCorner(),bottomEndCorner=selectedRange.getBottomEndCorner(),bottomStartCorner=selectedRange.getBottomStartCorner(),topEndCorner=selectedRange.getTopEndCorner();let newCoords={start:null,end:null};switch(touchStartDirection){case"NE-SW":switch(currentDirection){case"NE-SW":case"NW-SE":newCoords="top"===draggedHandle?{start:this.hot._createCellCoords(currentTouch.row,selectedRange.highlight.col),end:this.hot._createCellCoords(bottomStartCorner.row,currentTouch.col)}:{start:this.hot._createCellCoords(selectedRange.highlight.row,currentTouch.col),end:this.hot._createCellCoords(currentTouch.row,topStartCorner.col)};break;case"SE-NW":"bottom"===draggedHandle&&(newCoords={start:this.hot._createCellCoords(bottomEndCorner.row,currentTouch.col),end:this.hot._createCellCoords(currentTouch.row,topStartCorner.col)})}break;case"NW-SE":switch(currentDirection){case"NE-SW":"top"===draggedHandle?newCoords={start:currentTouch,end:bottomStartCorner}:newCoords.end=currentTouch;break;case"NW-SE":"top"===draggedHandle?newCoords={start:currentTouch,end:bottomEndCorner}:newCoords.end=currentTouch;break;case"SE-NW":"top"===draggedHandle?newCoords={start:currentTouch,end:topStartCorner}:newCoords.end=currentTouch;break;case"SW-NE":"top"===draggedHandle?newCoords={start:currentTouch,end:topEndCorner}:newCoords.end=currentTouch}break;case"SW-NE":switch(currentDirection){case"NW-SE":newCoords="bottom"===draggedHandle?{start:this.hot._createCellCoords(currentTouch.row,topStartCorner.col),end:this.hot._createCellCoords(bottomStartCorner.row,currentTouch.col)}:{start:this.hot._createCellCoords(topStartCorner.row,currentTouch.col),end:this.hot._createCellCoords(currentTouch.row,bottomEndCorner.col)};break;case"SW-NE":newCoords="top"===draggedHandle?{start:this.hot._createCellCoords(selectedRange.highlight.row,currentTouch.col),end:this.hot._createCellCoords(currentTouch.row,bottomEndCorner.col)}:{start:this.hot._createCellCoords(currentTouch.row,topStartCorner.col),end:this.hot._createCellCoords(topStartCorner.row,currentTouch.col)};break;case"SE-NW":"bottom"===draggedHandle?newCoords={start:this.hot._createCellCoords(currentTouch.row,topEndCorner.col),end:this.hot._createCellCoords(topStartCorner.row,currentTouch.col)}:"top"===draggedHandle&&(newCoords={start:bottomStartCorner,end:currentTouch})}break;case"SE-NW":switch(currentDirection){case"NW-SE":case"NE-SW":case"SW-NE":"top"===draggedHandle&&(newCoords.end=currentTouch);break;case"SE-NW":"top"===draggedHandle?newCoords.end=currentTouch:newCoords={start:currentTouch,end:topStartCorner}}}return newCoords}isDragged(){return this.dragged.length>0}}var selection_constants=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/selection/constants.mjs");function createDefaultHeaderSettings(){let{label="",colspan=1,origColspan=1,collapsible=!1,crossHiddenColumns=[],isCollapsed=!1,isHidden=!1,isRoot=!1,isPlaceholder=!1,headerClassNames=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label,colspan,origColspan,collapsible,isCollapsed,crossHiddenColumns,isHidden,isRoot,isPlaceholder,headerClassNames}}function sourceSettings_classPrivateFieldInitSpec(e,t,a){(function sourceSettings_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function sourceSettings_classPrivateFieldGet(s,a){return s.get(sourceSettings_assertClassBrand(s,a))}function sourceSettings_classPrivateFieldSet(s,a,r){return s.set(sourceSettings_assertClassBrand(s,a),r),r}function sourceSettings_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const HEADER_CONFIGURABLE_PROPS=["label","collapsible"];var _data=new WeakMap,_dataLength=new WeakMap,sourceSettings_columnsLimit=new WeakMap;class SourceSettings{constructor(){sourceSettings_classPrivateFieldInitSpec(this,_data,[]),sourceSettings_classPrivateFieldInitSpec(this,_dataLength,0),sourceSettings_classPrivateFieldInitSpec(this,sourceSettings_columnsLimit,1/0)}setColumnsLimit(columnsCount){sourceSettings_classPrivateFieldSet(sourceSettings_columnsLimit,this,columnsCount)}setData(){sourceSettings_classPrivateFieldSet(_data,this,function normalizeSettings(sourceSettings){let columnsLimit=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const normalizedSettings=[];if(0===columnsLimit)return normalizedSettings;(0,array.z0)(sourceSettings,(headersSettings=>{const columns=[];let columnIndex=0;normalizedSettings.push(columns),(0,array.z0)(headersSettings,(sourceHeaderSettings=>{const headerSettings=createDefaultHeaderSettings();if((0,object.Gv)(sourceHeaderSettings)){const{label,colspan,headerClassName}=sourceHeaderSettings;headerSettings.label=(0,mixed.As)(label),"number"==typeof colspan&&colspan>1&&(headerSettings.colspan=colspan,headerSettings.origColspan=colspan),"string"==typeof headerClassName&&(headerSettings.headerClassNames=[...headerClassName.split(" ")])}else headerSettings.label=(0,mixed.As)(sourceHeaderSettings);columnIndex+=headerSettings.origColspan;let cancelProcessing=!1;if(columnIndex>=columnsLimit&&(headerSettings.colspan=headerSettings.origColspan-(columnIndex-columnsLimit),headerSettings.origColspan=headerSettings.colspan,cancelProcessing=!0),columns.push(headerSettings),headerSettings.colspan>1)for(let i=0;i<headerSettings.colspan-1;i++)columns.push({label:"",isPlaceholder:!0});return!cancelProcessing}))}));const columnsLength=Math.max(...(0,array.YD)(normalizedSettings,(headersSettings=>headersSettings.length)));return(0,array.z0)(normalizedSettings,(headersSettings=>{if(headersSettings.length<columnsLength){const defaultSettings=(0,array.YD)(new Array(columnsLength-headersSettings.length),(()=>createDefaultHeaderSettings()));headersSettings.splice(headersSettings.length,0,...defaultSettings)}})),normalizedSettings}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],sourceSettings_classPrivateFieldGet(sourceSettings_columnsLimit,this))),sourceSettings_classPrivateFieldSet(_dataLength,this,sourceSettings_classPrivateFieldGet(_data,this).length)}getData(){return sourceSettings_classPrivateFieldGet(_data,this)}mergeWith(additionalSettings){(0,array.z0)(additionalSettings,(_ref=>{let{row,col,...rest}=_ref;const headerSettings=this.getHeaderSettings(row,col);null!==headerSettings&&(0,object.X$)(headerSettings,rest,HEADER_CONFIGURABLE_PROPS)}))}map(callback){(0,array.z0)(sourceSettings_classPrivateFieldGet(_data,this),(header=>{(0,array.z0)(header,(headerSettings=>{const propsToExtend=callback({...headerSettings});(0,object.Gv)(propsToExtend)&&(0,object.X$)(headerSettings,propsToExtend,HEADER_CONFIGURABLE_PROPS)}))}))}getHeaderSettings(headerLevel,columnIndex){var _headersSettings$colu;if(headerLevel>=sourceSettings_classPrivateFieldGet(_dataLength,this)||headerLevel<0)return null;const headersSettings=sourceSettings_classPrivateFieldGet(_data,this)[headerLevel];return!1===Array.isArray(headersSettings)||columnIndex>=headersSettings.length?null:null!==(_headersSettings$colu=headersSettings[columnIndex])&&void 0!==_headersSettings$colu?_headersSettings$colu:null}getHeadersSettings(headerLevel,columnIndex){let columnsLength=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const headersSettingsChunks=[];if(headerLevel>=sourceSettings_classPrivateFieldGet(_dataLength,this)||headerLevel<0)return headersSettingsChunks;const headersSettings=sourceSettings_classPrivateFieldGet(_data,this)[headerLevel];let currentLength=0;for(let i=columnIndex;i<headersSettings.length;i++){const headerSettings=headersSettings[i];if(headerSettings.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(currentLength+=headerSettings.colspan,headersSettingsChunks.push(headerSettings),headerSettings.colspan>1&&(i+=headerSettings.colspan-1),currentLength===columnsLength)break;if(currentLength>columnsLength)throw new Error("The last column settings cannot overlap the other header layers")}return headersSettingsChunks}getLayersCount(){return sourceSettings_classPrivateFieldGet(_dataLength,this)}getColumnsCount(){return sourceSettings_classPrivateFieldGet(_dataLength,this)>0?sourceSettings_classPrivateFieldGet(_data,this)[0].length:0}clear(){sourceSettings_classPrivateFieldSet(_data,this,[]),sourceSettings_classPrivateFieldSet(_dataLength,this,0)}}function tree_defineProperty(e,r,t){return(r=function tree_toPropertyKey(t){var i=function tree_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const TRAVERSAL_STRATEGIES=new Map([["DF-pre-order",function depthFirstPreOrder(callback,context){let continueTraverse=callback.call(context,this);for(let i=0;i<this.childs.length;i++){if(!1===continueTraverse)return!1;continueTraverse=depthFirstPreOrder.call(this.childs[i],callback,context)}return continueTraverse}],["DF-post-order",function depthFirstPostOrder(callback,context){for(let i=0;i<this.childs.length;i++){if(!1===depthFirstPostOrder.call(this.childs[i],callback,context))return!1}return callback.call(context,this)}],["BF",function breadthFirst(callback,context){const queue=[this];!function process(){if(0===queue.length)return;const node=queue.shift();queue.push(...node.childs),!1!==callback.call(context,node)&&process()}()}]]);class TreeNode{constructor(data){tree_defineProperty(this,"data",{}),tree_defineProperty(this,"parent",null),tree_defineProperty(this,"childs",[]),this.data=data}addChild(node){node.parent=this,this.childs.push(node)}cloneTree(){let nodeTree=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const clonedNode=new TreeNode({...nodeTree.data});for(let i=0;i<nodeTree.childs.length;i++)clonedNode.addChild(this.cloneTree(nodeTree.childs[i]));return clonedNode}replaceTreeWith(nodeTree){this.data={...nodeTree.data},this.childs=[];for(let i=0;i<nodeTree.childs.length;i++)this.addChild(nodeTree.childs[i])}walkDown(callback){let traversalStrategy=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!TRAVERSAL_STRATEGIES.has(traversalStrategy))throw new Error(`Traversal strategy "${traversalStrategy}" does not exist`);TRAVERSAL_STRATEGIES.get(traversalStrategy).call(this,callback,this)}walkUp(callback){const context=this,process=node=>{!1!==callback.call(context,node)&&null!==node.parent&&process(node.parent)};process(this)}}function headersTree_classPrivateFieldInitSpec(e,t,a){(function headersTree_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function headersTree_classPrivateFieldGet(s,a){return s.get(headersTree_assertClassBrand(s,a))}function headersTree_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings=new WeakMap;class HeadersTree{constructor(sourceSettings){headersTree_classPrivateFieldInitSpec(this,_rootNodes,new Map),headersTree_classPrivateFieldInitSpec(this,_rootsIndex,new Map),headersTree_classPrivateFieldInitSpec(this,_sourceSettings,null),function headersTree_classPrivateFieldSet(s,a,r){return s.set(headersTree_assertClassBrand(s,a),r),r}(_sourceSettings,this,sourceSettings)}getRoots(){return Array.from(headersTree_classPrivateFieldGet(_rootNodes,this).values())}getRootByColumn(columnIndex){let node;return headersTree_classPrivateFieldGet(_rootsIndex,this).has(columnIndex)&&(node=headersTree_classPrivateFieldGet(_rootNodes,this).get(headersTree_classPrivateFieldGet(_rootsIndex,this).get(columnIndex))),node}getNode(headerLevel,columnIndex){const rootNode=this.getRootByColumn(columnIndex);if(!rootNode)return;const normColumnIndex=columnIndex-headersTree_classPrivateFieldGet(_rootsIndex,this).get(columnIndex);let treeNode,columnCursor=0;return rootNode.walkDown((node=>{const{data:{origColspan,headerLevel:nodeHeaderLevel}}=node;if(headerLevel===nodeHeaderLevel){if(normColumnIndex>=columnCursor&&normColumnIndex<=columnCursor+origColspan-1)return treeNode=node,treeNode.data.isRoot=columnIndex===treeNode.data.columnIndex,!1;columnCursor+=origColspan}})),treeNode}rebuildTreeIndex(){let columnIndex=0;headersTree_classPrivateFieldGet(_rootsIndex,this).clear(),(0,array.z0)(headersTree_classPrivateFieldGet(_rootNodes,this),(_ref=>{let[,{data:{colspan}}]=_ref;for(let i=columnIndex;i<columnIndex+colspan;i++)headersTree_classPrivateFieldGet(_rootsIndex,this).set(i,columnIndex);columnIndex+=colspan}))}buildTree(){this.clear();const columnsCount=headersTree_classPrivateFieldGet(_sourceSettings,this).getColumnsCount();let columnIndex=0;for(;columnIndex<columnsCount;){const columnSettings=headersTree_classPrivateFieldGet(_sourceSettings,this).getHeaderSettings(0,columnIndex),rootNode=new TreeNode;headersTree_classPrivateFieldGet(_rootNodes,this).set(columnIndex,rootNode),this.buildLeaves(rootNode,columnIndex,0,columnSettings.origColspan),columnIndex+=columnSettings.origColspan}this.rebuildTreeIndex()}buildLeaves(parentNode,columnIndex,headerLevel){let extractionLength=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const columnsSettings=headersTree_classPrivateFieldGet(_sourceSettings,this).getHeadersSettings(headerLevel,columnIndex,extractionLength);headerLevel+=1,(0,array.z0)(columnsSettings,(columnSettings=>{const nodeData={...columnSettings,headerLevel:headerLevel-1,columnIndex};let node;1===headerLevel?(parentNode.data=nodeData,node=parentNode):(node=new TreeNode(nodeData),parentNode.addChild(node)),headerLevel<headersTree_classPrivateFieldGet(_sourceSettings,this).getLayersCount()&&this.buildLeaves(node,columnIndex,headerLevel,columnSettings.origColspan),columnIndex+=columnSettings.origColspan}))}clear(){headersTree_classPrivateFieldGet(_rootNodes,this).clear(),headersTree_classPrivateFieldGet(_rootsIndex,this).clear()}}function traverseHiddenNodeColumnIndexes(node,callback){node.walkDown((_ref=>{let{data,childs}=_ref;if(!data.isHidden&&(callback(data.columnIndex),0===childs.length))for(let i=1;i<data.colspan;i++)callback(data.columnIndex+i)}))}function getFirstChildProperty(_ref2,propertyName){let{childs}=_ref2;if(0!==childs.length)return childs[0].data[propertyName]}function isNodeReflectsFirstChildColspan(node){return getFirstChildProperty(node,"origColspan")===node.data.origColspan}function expandNode(nodeToProcess){const{data:nodeData,childs:nodeChilds}=nodeToProcess;if(!nodeData.isCollapsed||nodeData.isHidden||nodeData.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(nodeToProcess))return expandNode(nodeChilds[0]);nodeData.isCollapsed=!1;const allLeavesExceptMostLeft=nodeChilds.slice(1),affectedColumns=new Set;let colspanCompensation=0;if(allLeavesExceptMostLeft.length>0)(0,array.z0)(allLeavesExceptMostLeft,(node=>{node.replaceTreeWith(node.data.clonedTree),node.data.clonedTree=null;const leafData=node.data;colspanCompensation+=leafData.colspan,traverseHiddenNodeColumnIndexes(node,(gridColumnIndex=>{affectedColumns.add(gridColumnIndex)}))}));else{const{colspan,origColspan,columnIndex}=nodeData;colspanCompensation=origColspan-colspan;for(let i=1;i<origColspan;i++)affectedColumns.add(columnIndex+i)}return nodeToProcess.walkUp((node=>{const{data}=node;data.colspan+=colspanCompensation,data.colspan>=data.origColspan?(data.colspan=data.origColspan,data.isCollapsed=!1):isNodeReflectsFirstChildColspan(node)&&(data.isCollapsed=getFirstChildProperty(node,"isCollapsed"))})),{rollbackModification:()=>collapseNode(nodeToProcess),affectedColumns:Array.from(affectedColumns),colspanCompensation}}function collapseNode(nodeToProcess){var _getFirstChildPropert;const{data:nodeData,childs:nodeChilds}=nodeToProcess;if(nodeData.isCollapsed||nodeData.isHidden||nodeData.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(nodeToProcess))return collapseNode(nodeChilds[0]);nodeData.isCollapsed=!0;const allLeavesExceptMostLeft=nodeChilds.slice(1),affectedColumns=new Set;if(allLeavesExceptMostLeft.length>0)(0,array.z0)(allLeavesExceptMostLeft,(node=>{traverseHiddenNodeColumnIndexes(node,(gridColumnIndex=>{affectedColumns.add(gridColumnIndex)})),node.data.clonedTree=node.cloneTree(),node.walkDown((_ref=>{let{data}=_ref;data.isHidden=!0}))}));else{const{origColspan,columnIndex}=nodeData;for(let i=1;i<origColspan;i++){const gridColumnIndex=columnIndex+i;affectedColumns.add(gridColumnIndex)}}const colspanCompensation=nodeData.colspan-(null!==(_getFirstChildPropert=getFirstChildProperty(nodeToProcess,"colspan"))&&void 0!==_getFirstChildPropert?_getFirstChildPropert:1);return nodeToProcess.walkUp((node=>{const{data}=node;data.colspan-=colspanCompensation,data.colspan<=1?(data.colspan=1,data.isCollapsed=!0):isNodeReflectsFirstChildColspan(node)&&(data.isCollapsed=getFirstChildProperty(node,"isCollapsed"))})),{rollbackModification:()=>expandNode(nodeToProcess),affectedColumns:Array.from(affectedColumns),colspanCompensation}}const availableModifiers=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",function hideColumn(nodeToProcess,gridColumnIndex){if(!Number.isInteger(gridColumnIndex))throw new Error("The passed gridColumnIndex argument has invalid type.");if(nodeToProcess.childs.length>0)throw new Error(templateLiteralTag.O`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns}=nodeToProcess.data;if(crossHiddenColumns.includes(gridColumnIndex))return;let isCollapsibleNode=!1;nodeToProcess.walkUp((node=>{const{data:{collapsible}}=node;if(collapsible)return isCollapsibleNode=!0,!1})),isCollapsibleNode||nodeToProcess.walkUp((node=>{const{data}=node;data.crossHiddenColumns.push(gridColumnIndex),data.colspan>1?data.colspan-=1:data.isHidden=!0}))}],["show-column",function showColumn(nodeToProcess,gridColumnIndex){if(!Number.isInteger(gridColumnIndex))throw new Error("The passed gridColumnIndex argument has invalid type.");if(nodeToProcess.childs.length>0)throw new Error(templateLiteralTag.O`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns}=nodeToProcess.data;if(!crossHiddenColumns.includes(gridColumnIndex))return;let isCollapsibleNode=!1;nodeToProcess.walkUp((node=>{const{data:{collapsible}}=node;if(collapsible)return isCollapsibleNode=!0,!1})),isCollapsibleNode||nodeToProcess.walkUp((node=>{const{data}=node;data.crossHiddenColumns.splice(data.crossHiddenColumns.indexOf(gridColumnIndex),1),!data.isHidden&&data.colspan<data.origColspan&&(data.colspan+=1),data.isHidden=!1}))}]]);function generateMatrix(headerRoots){const matrix=[];return(0,array.z0)(headerRoots,(rootNode=>{rootNode.walkDown((node=>{const nodeData=node.data,{origColspan,columnIndex,headerLevel,crossHiddenColumns}=nodeData,colspanHeaderLayer=function createNestedArrayIfNecessary(array,index){let subArray;Array.isArray(array[index])?subArray=array[index]:(subArray=[],array[index]=subArray);return subArray}(matrix,headerLevel);let isRootSettingsFound=!1;for(let i=columnIndex;i<columnIndex+origColspan;i++){if(crossHiddenColumns.includes(i)||isRootSettingsFound)colspanHeaderLayer.push({label:"",isPlaceholder:!0});else{const headerRootSettings=createHeaderSettings(nodeData);headerRootSettings.isRoot=!0,colspanHeaderLayer.push(headerRootSettings),isRootSettingsFound=!0}}}))})),matrix}function createHeaderSettings(nodeData){const{crossHiddenColumns,...headerRootSettings}=createDefaultHeaderSettings(nodeData);return headerRootSettings}function stateManager_classPrivateFieldInitSpec(e,t,a){(function stateManager_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function stateManager_classPrivateFieldSet(s,a,r){return s.set(stateManager_assertClassBrand(s,a),r),r}function stateManager_classPrivateFieldGet(s,a){return s.get(stateManager_assertClassBrand(s,a))}function stateManager_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var stateManager_sourceSettings=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap;class StateManager{constructor(){stateManager_classPrivateFieldInitSpec(this,stateManager_sourceSettings,new SourceSettings),stateManager_classPrivateFieldInitSpec(this,_headersTree,new HeadersTree(stateManager_classPrivateFieldGet(stateManager_sourceSettings,this))),stateManager_classPrivateFieldInitSpec(this,_stateMatrix,[[]])}setState(nestedHeadersSettings){stateManager_classPrivateFieldGet(stateManager_sourceSettings,this).setData(nestedHeadersSettings);let hasError=!1;try{stateManager_classPrivateFieldGet(_headersTree,this).buildTree()}catch(ex){stateManager_classPrivateFieldGet(_headersTree,this).clear(),stateManager_classPrivateFieldGet(stateManager_sourceSettings,this).clear(),hasError=!0}return stateManager_classPrivateFieldSet(_stateMatrix,this,generateMatrix(stateManager_classPrivateFieldGet(_headersTree,this).getRoots())),hasError}setColumnsLimit(columnsCount){stateManager_classPrivateFieldGet(stateManager_sourceSettings,this).setColumnsLimit(columnsCount)}mergeStateWith(settings){const transformedSettings=(0,array.YD)(settings,(_ref=>{let{row,...rest}=_ref;return{row:row<0?this.rowCoordsToLevel(row):row,...rest}}));stateManager_classPrivateFieldGet(stateManager_sourceSettings,this).mergeWith(transformedSettings),stateManager_classPrivateFieldGet(_headersTree,this).buildTree(),stateManager_classPrivateFieldSet(_stateMatrix,this,generateMatrix(stateManager_classPrivateFieldGet(_headersTree,this).getRoots()))}mapState(callback){stateManager_classPrivateFieldGet(stateManager_sourceSettings,this).map(callback),stateManager_classPrivateFieldGet(_headersTree,this).buildTree(),stateManager_classPrivateFieldSet(_stateMatrix,this,generateMatrix(stateManager_classPrivateFieldGet(_headersTree,this).getRoots()))}mapNodes(callback){return(0,array.mu)(stateManager_classPrivateFieldGet(_headersTree,this).getRoots(),((acc,rootNode)=>(rootNode.walkDown((node=>{const result=callback(node.data);void 0!==result&&acc.push(result)})),acc)),[])}triggerNodeModification(action,headerLevel,columnIndex){headerLevel<0&&(headerLevel=this.rowCoordsToLevel(headerLevel));const nodeToProcess=stateManager_classPrivateFieldGet(_headersTree,this).getNode(headerLevel,columnIndex);let actionResult;return nodeToProcess&&(actionResult=function triggerNodeModification(actionName,nodeToProcess,gridColumnIndex){if(!availableModifiers.has(actionName))throw new Error(`The node modifier action ("${actionName}") does not exist.`);return availableModifiers.get(actionName)(nodeToProcess,gridColumnIndex)}(action,nodeToProcess,columnIndex),stateManager_classPrivateFieldSet(_stateMatrix,this,generateMatrix(stateManager_classPrivateFieldGet(_headersTree,this).getRoots()))),actionResult}triggerColumnModification(action,columnIndex){return this.triggerNodeModification(action,-1,columnIndex)}rowCoordsToLevel(rowIndex){if(rowIndex>=0)return null;const headerLevel=rowIndex+Math.max(this.getLayersCount(),1);return headerLevel<0?null:headerLevel}levelToRowCoords(headerLevel){if(headerLevel<0)return null;const rowIndex=headerLevel-Math.max(this.getLayersCount(),1);return rowIndex>=0?null:rowIndex}getHeaderSettings(headerLevel,columnIndex){var _classPrivateFieldGet2,_classPrivateFieldGet3;return headerLevel<0&&(headerLevel=this.rowCoordsToLevel(headerLevel)),null===headerLevel||headerLevel>=this.getLayersCount()?null:null!==(_classPrivateFieldGet2=null===(_classPrivateFieldGet3=stateManager_classPrivateFieldGet(_stateMatrix,this)[headerLevel])||void 0===_classPrivateFieldGet3?void 0:_classPrivateFieldGet3[columnIndex])&&void 0!==_classPrivateFieldGet2?_classPrivateFieldGet2:null}getHeaderTreeNodeData(headerLevel,columnIndex){const node=this.getHeaderTreeNode(headerLevel,columnIndex);return node?{...node.data}:null}getHeaderTreeNode(headerLevel,columnIndex){if(headerLevel<0&&(headerLevel=this.rowCoordsToLevel(headerLevel)),null===headerLevel||headerLevel>=this.getLayersCount())return null;const node=stateManager_classPrivateFieldGet(_headersTree,this).getNode(headerLevel,columnIndex);return node||null}findTopMostEntireHeaderLevel(columnIndexFrom){let columnIndexTo=arguments.length>1&&void 0!==arguments[1]?arguments[1]:columnIndexFrom;const columnsWidth=columnIndexTo-columnIndexFrom+1;let atLeastOneRootFound=!1,headerLevel=null;for(let columnIndex=columnIndexFrom;columnIndex<=columnIndexTo;columnIndex++){const rootNode=stateManager_classPrivateFieldGet(_headersTree,this).getRootByColumn(columnIndex);if(!rootNode)break;atLeastOneRootFound=!0,rootNode.walkDown((node=>{const{columnIndex:nodeColumnIndex,headerLevel:nodeHeaderLevel,origColspan,isHidden}=node.data;isHidden||origColspan<=columnsWidth&&nodeColumnIndex>=columnIndexFrom&&nodeColumnIndex+origColspan-1<=columnIndexTo&&(null===headerLevel||nodeHeaderLevel<headerLevel)&&(headerLevel=nodeHeaderLevel)}),"DF-pre-order")}return atLeastOneRootFound&&null===headerLevel?-1:this.levelToRowCoords(null!=headerLevel?headerLevel:0)}findLeftMostColumnIndex(headerLevel,columnIndex){var _this$getHeaderSettin;const{isRoot}=null!==(_this$getHeaderSettin=this.getHeaderSettings(headerLevel,columnIndex))&&void 0!==_this$getHeaderSettin?_this$getHeaderSettin:{isRoot:!0};if(isRoot)return columnIndex;let stepBackColumn=columnIndex-1;for(;stepBackColumn>=0;){var _this$getHeaderSettin2;const{isRoot:isRootNode}=null!==(_this$getHeaderSettin2=this.getHeaderSettings(headerLevel,stepBackColumn))&&void 0!==_this$getHeaderSettin2?_this$getHeaderSettin2:{isRoot:!0};if(isRootNode)break;stepBackColumn-=1}return stepBackColumn}findRightMostColumnIndex(headerLevel,columnIndex){var _this$getHeaderSettin3;const{isRoot,origColspan}=null!==(_this$getHeaderSettin3=this.getHeaderSettings(headerLevel,columnIndex))&&void 0!==_this$getHeaderSettin3?_this$getHeaderSettin3:{isRoot:!0,origColspan:1};if(isRoot)return columnIndex+origColspan-1;let stepForthColumn=columnIndex+1;for(;stepForthColumn<this.getColumnsCount();){var _this$getHeaderSettin4;const{isRoot:isRootNode}=null!==(_this$getHeaderSettin4=this.getHeaderSettings(headerLevel,stepForthColumn))&&void 0!==_this$getHeaderSettin4?_this$getHeaderSettin4:{isRoot:!0};if(isRootNode)break;stepForthColumn+=1}return stepForthColumn-1}getLayersCount(){return stateManager_classPrivateFieldGet(stateManager_sourceSettings,this).getLayersCount()}getColumnsCount(){return stateManager_classPrivateFieldGet(stateManager_sourceSettings,this).getColumnsCount()}clear(){stateManager_classPrivateFieldSet(_stateMatrix,this,[]),stateManager_classPrivateFieldGet(stateManager_sourceSettings,this).clear(),stateManager_classPrivateFieldGet(_headersTree,this).clear()}}function utils_ghostTable_defineProperty(e,r,t){return(r=function utils_ghostTable_toPropertyKey(t){var i=function utils_ghostTable_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const utils_ghostTable=class ghostTable_GhostTable{constructor(hot,nestedHeaderSettingsGetter){utils_ghostTable_defineProperty(this,"hot",void 0),utils_ghostTable_defineProperty(this,"nestedHeaderSettingsGetter",void 0),utils_ghostTable_defineProperty(this,"layersCount",0),utils_ghostTable_defineProperty(this,"container",void 0),utils_ghostTable_defineProperty(this,"widthsMap",void 0),this.hot=hot,this.nestedHeaderSettingsGetter=nestedHeaderSettingsGetter,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(layersCount){return this.layersCount=layersCount,this}getWidth(visualColumn){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(visualColumn))}buildWidthsMap(){const currentThemeName=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),currentThemeName&&this.container.classList.add(currentThemeName),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const columns=this.container.querySelectorAll("tr:last-of-type th"),maxColumns=columns.length;this.widthsMap.clear();for(let column=0;column<maxColumns;column++){const visualColumnsIndex=this.hot.columnIndexMapper.getVisualFromRenderableIndex(column),physicalColumnIndex=this.hot.toPhysicalColumn(visualColumnsIndex);this.widthsMap.setValueAtIndex(physicalColumnIndex,columns[column].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(container){const{rootDocument,columnIndexMapper}=this.hot,fragment=rootDocument.createDocumentFragment(),table=rootDocument.createElement("table"),isDropdownEnabled=!!this.hot.getSettings().dropdownMenu,maxRenderedCols=columnIndexMapper.getRenderableIndexesLength();for(let row=0;row<this.layersCount;row++){const tr=rootDocument.createElement("tr");for(let col=0;col<maxRenderedCols;col++){let visualColumnsIndex=columnIndexMapper.getVisualFromRenderableIndex(col);null===visualColumnsIndex&&(visualColumnsIndex=col);const th=rootDocument.createElement("th"),headerSettings=this.nestedHeaderSettingsGetter(row,visualColumnsIndex);if(headerSettings&&(!headerSettings.isPlaceholder||headerSettings.isHidden)){let label=headerSettings.label;isDropdownEnabled&&(label+='<button class="changeType"></button>'),(0,dom_element.Mv)(th,label),th.colSpan=headerSettings.colspan,tr.appendChild(th)}}table.appendChild(tr)}fragment.appendChild(table),container.appendChild(fragment)}clear(){this.widthsMap.clear(),this.container=null}};function nestedHeaders_defineProperty(e,r,t){return(r=function nestedHeaders_toPropertyKey(t){var i=function nestedHeaders_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function nestedHeaders_classPrivateFieldInitSpec(e,t,a){nestedHeaders_checkPrivateRedeclaration(e,t),t.set(e,a)}function nestedHeaders_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nestedHeaders_classPrivateFieldSet(s,a,r){return s.set(nestedHeaders_assertClassBrand(s,a),r),r}function nestedHeaders_classPrivateFieldGet(s,a){return s.get(nestedHeaders_assertClassBrand(s,a))}function nestedHeaders_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _stateManager=new WeakMap,_hidingIndexMapObserver=new WeakMap,_focusInitialCoords=new WeakMap,_isColumnsSelectionInProgress=new WeakMap,_recentlyHighlightCoords=new WeakMap,_NestedHeaders_brand=new WeakSet;class NestedHeaders extends BasePlugin{constructor(){super(...arguments),function nestedHeaders_classPrivateMethodInitSpec(e,a){nestedHeaders_checkPrivateRedeclaration(e,a),a.add(e)}(this,_NestedHeaders_brand),nestedHeaders_classPrivateFieldInitSpec(this,_stateManager,new StateManager),nestedHeaders_classPrivateFieldInitSpec(this,_hidingIndexMapObserver,null),nestedHeaders_classPrivateFieldInitSpec(this,_focusInitialCoords,null),nestedHeaders_classPrivateFieldInitSpec(this,_isColumnsSelectionInProgress,!1),nestedHeaders_classPrivateFieldInitSpec(this,_recentlyHighlightCoords,null),nestedHeaders_defineProperty(this,"ghostTable",new utils_ghostTable(this.hot,((row,column)=>this.getHeaderSettings(row,column)))),nestedHeaders_defineProperty(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return"nestedHeaders"}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings().nestedHeaders}enablePlugin(){var _this=this;if(this.enabled)return;const{nestedHeaders}=this.hot.getSettings();Array.isArray(nestedHeaders)&&Array.isArray(nestedHeaders[0])||(0,helpers_console.R8)(templateLiteralTag.O`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>nestedHeaders_assertClassBrand(_NestedHeaders_brand,this,nestedHeaders_onInit).call(this))),this.addHook("afterLoadData",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,nestedHeaders_onAfterLoadData).call(_this,...args)})),this.addHook("beforeOnCellMouseDown",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,nestedHeaders_onBeforeOnCellMouseDown).call(_this,...args)})),this.addHook("afterOnCellMouseDown",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,_onAfterOnCellMouseDown).call(_this,...args)})),this.addHook("beforeOnCellMouseOver",(function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,nestedHeaders_onBeforeOnCellMouseOver).call(_this,...args)})),this.addHook("beforeOnCellMouseUp",(function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,_onBeforeOnCellMouseUp).call(_this,...args)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,nestedHeaders_onBeforeSelectionHighlightSet).call(_this,...args)})),this.addHook("modifyTransformStart",(function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,nestedHeaders_onModifyTransformStart).call(_this,...args)})),this.addHook("afterSelection",(()=>nestedHeaders_assertClassBrand(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this))),this.addHook("afterSelectionFocusSet",(()=>nestedHeaders_assertClassBrand(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,nestedHeaders_onBeforeViewportScrollHorizontally).call(_this,...args)})),this.addHook("afterGetColumnHeaderRenderers",(array=>nestedHeaders_assertClassBrand(_NestedHeaders_brand,this,_onAfterGetColumnHeaderRenderers).call(this,array))),this.addHook("modifyColWidth",(function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,nestedHeaders_onModifyColWidth).call(_this,...args)})),this.addHook("modifyColumnHeaderValue",(function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,_onModifyColumnHeaderValue).call(_this,...args)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var _len11=arguments.length,args=new Array(_len11),_key11=0;_key11<_len11;_key11++)args[_key11]=arguments[_key11];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,_onBeforeHighlightingColumnHeader).call(_this,...args)})),this.addHook("beforeCopy",(function(){for(var _len12=arguments.length,args=new Array(_len12),_key12=0;_key12<_len12;_key12++)args[_key12]=arguments[_key12];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,_onBeforeCopy).call(_this,...args)})),this.addHook("beforeSelectColumns",(function(){for(var _len13=arguments.length,args=new Array(_len13),_key13=0;_key13<_len13;_key13++)args[_key13]=arguments[_key13];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,_onBeforeSelectColumns).call(_this,...args)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var _len14=arguments.length,args=new Array(_len14),_key14=0;_key14<_len14;_key14++)args[_key14]=arguments[_key14];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,nestedHeaders_onAfterViewportColumnCalculatorOverride).call(_this,...args)})),this.addHook("modifyFocusedElement",(function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];return nestedHeaders_assertClassBrand(_NestedHeaders_brand,_this,_onModifyFocusedElement).call(_this,...args)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>nestedHeaders_assertClassBrand(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>nestedHeaders_assertClassBrand(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders}=this.hot.getSettings();nestedHeaders_classPrivateFieldGet(_stateManager,this).setColumnsLimit(this.hot.countCols()),Array.isArray(nestedHeaders)&&(this.detectedOverlappedHeaders=nestedHeaders_classPrivateFieldGet(_stateManager,this).setState(nestedHeaders)),this.detectedOverlappedHeaders&&(0,helpers_console.R8)(templateLiteralTag.O`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((isColumnHidden,physicalColumnIndex)=>{const actionName=!0===isColumnHidden?"hide-column":"show-column";nestedHeaders_classPrivateFieldGet(_stateManager,this).triggerColumnModification(actionName,physicalColumnIndex)})),!nestedHeaders_classPrivateFieldGet(_hidingIndexMapObserver,this)&&this.enabled&&nestedHeaders_classPrivateFieldSet(_hidingIndexMapObserver,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((changes=>{changes.forEach((_ref=>{let{op,index:columnIndex,newValue}=_ref;if("replace"===op){const actionName=!0===newValue?"hide-column":"show-column";nestedHeaders_classPrivateFieldGet(_stateManager,this).triggerColumnModification(actionName,columnIndex)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),nestedHeaders_classPrivateFieldGet(_stateManager,this).clear(),nestedHeaders_classPrivateFieldGet(_hidingIndexMapObserver,this).unsubscribe(),nestedHeaders_classPrivateFieldSet(_hidingIndexMapObserver,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return nestedHeaders_classPrivateFieldGet(_stateManager,this)}getLayersCount(){return nestedHeaders_classPrivateFieldGet(_stateManager,this).getLayersCount()}getHeaderSettings(headerLevel,columnIndex){return nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderSettings(headerLevel,columnIndex)}clearColspans(){if(!this.hot.view)return;const{_wt:wt}=this.hot.view,headerLevels=wt.getSetting("columnHeaders").length,mainHeaders=wt.wtTable.THEAD,topHeaders=wt.wtOverlays.topOverlay.clone.wtTable.THEAD,topLeftCornerHeaders=wt.wtOverlays.topInlineStartCornerOverlay?wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let i=0;i<headerLevels;i++){const masterLevel=mainHeaders.childNodes[i];if(!masterLevel)break;const topLevel=topHeaders.childNodes[i],topLeftCornerLevel=topLeftCornerHeaders?topLeftCornerHeaders.childNodes[i]:null;for(let j=0,masterNodes=masterLevel.childNodes.length;j<masterNodes;j++)masterLevel.childNodes[j].removeAttribute("colspan"),(0,dom_element.vy)(masterLevel.childNodes[j],"hiddenHeader"),topLevel&&topLevel.childNodes[j]&&(topLevel.childNodes[j].removeAttribute("colspan"),(0,dom_element.vy)(topLevel.childNodes[j],"hiddenHeader")),topLeftCornerHeaders&&topLeftCornerLevel&&topLeftCornerLevel.childNodes[j]&&(topLeftCornerLevel.childNodes[j].removeAttribute("colspan"),(0,dom_element.vy)(topLeftCornerLevel.childNodes[j],"hiddenHeader"))}}headerRendererFactory(headerLevel){var _this2=this;const fixedColumnsStart=this.hot.view._wt.getSetting("fixedColumnsStart");return(renderedColumnIndex,TH)=>{var _classPrivateFieldGet2;const{columnIndexMapper,view}=this.hot;let visualColumnIndex=columnIndexMapper.getVisualFromRenderableIndex(renderedColumnIndex);null===visualColumnIndex&&(visualColumnIndex=renderedColumnIndex),TH.removeAttribute("colspan"),(0,dom_element.vy)(TH,"hiddenHeader"),(0,dom_element.vy)(TH,"hiddenHeaderText");const{colspan,isHidden,isPlaceholder,headerClassNames}=null!==(_classPrivateFieldGet2=nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderSettings(headerLevel,visualColumnIndex))&&void 0!==_classPrivateFieldGet2?_classPrivateFieldGet2:{label:""};if(isPlaceholder||isHidden)(0,dom_element.iQ)(TH,"hiddenHeader");else if(colspan>1){var _wtOverlays$topInline,_wtOverlays$inlineSta,_wtOverlays$topOverla;const{wtOverlays}=view._wt,isTopInlineStartOverlay=null===(_wtOverlays$topInline=wtOverlays.topInlineStartCornerOverlay)||void 0===_wtOverlays$topInline?void 0:_wtOverlays$topInline.clone.wtTable.THEAD.contains(TH),isInlineStartOverlay=null===(_wtOverlays$inlineSta=wtOverlays.inlineStartOverlay)||void 0===_wtOverlays$inlineSta?void 0:_wtOverlays$inlineSta.clone.wtTable.THEAD.contains(TH);(null===(_wtOverlays$topOverla=wtOverlays.topOverlay)||void 0===_wtOverlays$topOverla?void 0:_wtOverlays$topOverla.clone.wtTable.THEAD.contains(TH))&&visualColumnIndex<fixedColumnsStart&&(0,dom_element.iQ)(TH,"hiddenHeaderText");const correctedColspan=isTopInlineStartOverlay||isInlineStartOverlay?Math.min(colspan,fixedColumnsStart-renderedColumnIndex):colspan;correctedColspan>1&&TH.setAttribute("colspan",correctedColspan)}if(this.hot.view.appendColHeader(visualColumnIndex,TH,(function(){return _this2.getColumnHeaderValue(...arguments)}),headerLevel),!isPlaceholder&&!isHidden){const innerHeaderDiv=TH.querySelector("div.relative");innerHeaderDiv&&headerClassNames&&headerClassNames.length>0&&((0,dom_element.vy)(innerHeaderDiv,this.hot.getColumnMeta(visualColumnIndex).headerClassName),(0,dom_element.iQ)(innerHeaderDiv,headerClassNames))}}}getColumnHeaderValue(visualColumnIndex,headerLevel){var _classPrivateFieldGet3;const{isHidden,isPlaceholder}=null!==(_classPrivateFieldGet3=nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderSettings(headerLevel,visualColumnIndex))&&void 0!==_classPrivateFieldGet3?_classPrivateFieldGet3:{};return isPlaceholder||isHidden?"":this.hot.getColHeader(visualColumnIndex,headerLevel)}destroy(){nestedHeaders_classPrivateFieldSet(_stateManager,this,null),null!==nestedHeaders_classPrivateFieldGet(_hidingIndexMapObserver,this)&&(nestedHeaders_classPrivateFieldGet(_hidingIndexMapObserver,this).unsubscribe(),nestedHeaders_classPrivateFieldSet(_hidingIndexMapObserver,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(coords){if(!(coords.row>=0||coords.col<0))return nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderTreeNodeData(coords.row,coords.col)}}function _updateFocusHighlightPosition(){var _this$hot;const selection=null===(_this$hot=this.hot)||void 0===_this$hot?void 0:_this$hot.getSelectedRangeLast();if(!selection)return;const{highlight}=selection;if(highlight.isHeader()&&highlight.col>=0){const columnIndex=nestedHeaders_classPrivateFieldGet(_stateManager,this).findLeftMostColumnIndex(highlight.row,highlight.col),focusHighlight=this.hot.selection.highlight.getFocus();focusHighlight.visualCellRange.highlight.col=columnIndex,focusHighlight.visualCellRange.from.col=columnIndex,focusHighlight.visualCellRange.to.col=columnIndex,focusHighlight.commit()}}function nestedHeaders_onBeforeViewportScrollHorizontally(visualColumn,snapping){var _classPrivateFieldGet4;const selection=this.hot.getSelectedRangeLast();if(!selection)return visualColumn;const{highlight}=selection,{navigableHeaders}=this.hot.getSettings(),isSelectedByColumnHeader=this.hot.selection.isSelectedByColumnHeader(),highlightRow=navigableHeaders?highlight.row:null===(_classPrivateFieldGet4=nestedHeaders_classPrivateFieldGet(_recentlyHighlightCoords,this))||void 0===_classPrivateFieldGet4?void 0:_classPrivateFieldGet4.row,highlightColumn=isSelectedByColumnHeader?visualColumn:highlight.col,isNestedHeadersRange=highlightRow<0&&highlightColumn>=0;if(nestedHeaders_classPrivateFieldSet(_recentlyHighlightCoords,this,null),!isNestedHeadersRange)return visualColumn;const firstVisibleColumn=this.hot.getFirstFullyVisibleColumn(),lastVisibleColumn=this.hot.getLastFullyVisibleColumn(),viewportWidth=lastVisibleColumn-firstVisibleColumn+1,mostLeftColumnIndex=nestedHeaders_classPrivateFieldGet(_stateManager,this).findLeftMostColumnIndex(highlightRow,highlightColumn),mostRightColumnIndex=nestedHeaders_classPrivateFieldGet(_stateManager,this).findRightMostColumnIndex(highlightRow,highlightColumn),headerWidth=mostRightColumnIndex-mostLeftColumnIndex+1;if(mostLeftColumnIndex<firstVisibleColumn&&mostRightColumnIndex>lastVisibleColumn)return mostLeftColumnIndex;if(isSelectedByColumnHeader){let scrollColumnIndex=null;return mostLeftColumnIndex>=firstVisibleColumn&&mostRightColumnIndex>lastVisibleColumn?headerWidth>viewportWidth?(snapping.value="start",scrollColumnIndex=mostLeftColumnIndex):(snapping.value="end",scrollColumnIndex=mostRightColumnIndex):mostLeftColumnIndex<firstVisibleColumn&&mostRightColumnIndex<=lastVisibleColumn&&(headerWidth>viewportWidth?(snapping.value="end",scrollColumnIndex=mostRightColumnIndex):(snapping.value="start",scrollColumnIndex=mostLeftColumnIndex)),scrollColumnIndex}return mostLeftColumnIndex<=firstVisibleColumn?mostLeftColumnIndex:mostRightColumnIndex}function _onBeforeHighlightingColumnHeader(visualColumn,headerLevel,highlightMeta){const headerNodeData=nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderTreeNodeData(headerLevel,visualColumn);if(!headerNodeData)return visualColumn;const{columnCursor,selectionType,selectionWidth}=highlightMeta,{isRoot,colspan}=nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderSettings(headerLevel,visualColumn);if(selectionType===selection_constants.PP){if(!isRoot)return headerNodeData.columnIndex}else if(selectionType===selection_constants.E6&&(colspan>selectionWidth-columnCursor||!isRoot))return null;return visualColumn}function _onBeforeCopy(data,copyableRanges,_ref2){let{columnHeadersCount}=_ref2;if(0!==columnHeadersCount)for(let rangeIndex=0;rangeIndex<copyableRanges.length;rangeIndex++){const{startRow,startCol,endRow,endCol}=copyableRanges[rangeIndex],rowsCount=endRow-startRow+1;if(startRow>=0||1===startCol-endCol+1)break;for(let column=startCol;column<=endCol;column++)for(let row=startRow;row<=endRow;row++){var _classPrivateFieldGet5;const zeroBasedColumnHeaderLevel=rowsCount+row,zeroBasedColumnIndex=column-startCol;if(0===zeroBasedColumnIndex)continue;!1===(null===(_classPrivateFieldGet5=nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderTreeNodeData(row,column))||void 0===_classPrivateFieldGet5?void 0:_classPrivateFieldGet5.isRoot)&&(data[zeroBasedColumnHeaderLevel][zeroBasedColumnIndex]="")}}}function nestedHeaders_onBeforeOnCellMouseDown(event,coords,TD,controller){this._getHeaderTreeNodeDataByCoords(coords)&&(controller.column=!0)}function _onAfterOnCellMouseDown(event,coords){const headerNodeData=this._getHeaderTreeNodeDataByCoords(coords);if(!headerNodeData)return;nestedHeaders_classPrivateFieldSet(_focusInitialCoords,this,coords.clone()),nestedHeaders_classPrivateFieldSet(_isColumnsSelectionInProgress,this,!0);const{selection}=this.hot,currentSelection=selection.isSelected()?selection.getSelectedRange().current():null,columnsToSelect=[],{columnIndex,origColspan}=headerNodeData,allowRightClickSelection=!selection.inInSelection(coords);event.shiftKey&&currentSelection?coords.col<currentSelection.from.col?columnsToSelect.push(currentSelection.getTopEndCorner().col,columnIndex,coords.row):coords.col>currentSelection.from.col?columnsToSelect.push(currentSelection.getTopStartCorner().col,columnIndex+origColspan-1,coords.row):columnsToSelect.push(columnIndex,columnIndex+origColspan-1,coords.row):((0,dom_event.Ml)(event)||(0,dom_event.nO)(event)&&allowRightClickSelection||(0,dom_event.kH)(event))&&columnsToSelect.push(columnIndex,columnIndex+origColspan-1,coords.row),selection.selectColumns(...columnsToSelect)}function nestedHeaders_onBeforeOnCellMouseOver(event,coords,TD,controller){if(!this.hot.view.isMouseDown()||controller.column)return;const headerNodeData=this._getHeaderTreeNodeDataByCoords(coords);if(!headerNodeData)return;const{columnIndex,origColspan}=headerNodeData,selectedRange=this.hot.getSelectedRangeLast(),topStartCoords=selectedRange.getTopStartCorner(),bottomEndCoords=selectedRange.getBottomEndCorner(),{from}=selectedRange;controller.column=!0,controller.cell=!0;const columnsToSelect=[],headerLevel=(0,number.qE)(coords.row,-1/0,-1);coords.col<from.col?columnsToSelect.push(bottomEndCoords.col,columnIndex,headerLevel):coords.col>from.col?columnsToSelect.push(topStartCoords.col,columnIndex+origColspan-1,headerLevel):columnsToSelect.push(columnIndex,columnIndex+origColspan-1,headerLevel),this.hot.selection.selectColumns(...columnsToSelect)}function _onBeforeOnCellMouseUp(){nestedHeaders_classPrivateFieldSet(_isColumnsSelectionInProgress,this,!1)}function nestedHeaders_onBeforeSelectionHighlightSet(){const{navigableHeaders}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!nestedHeaders_classPrivateFieldGet(_isColumnsSelectionInProgress,this)||!navigableHeaders)return;const selectedRange=this.hot.getSelectedRangeLast(),columnStart=selectedRange.getTopStartCorner().col,columnEnd=selectedRange.getBottomEndCorner().col,{columnIndex,origColspan}=nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderTreeNodeData(nestedHeaders_classPrivateFieldGet(_focusInitialCoords,this).row,nestedHeaders_classPrivateFieldGet(_focusInitialCoords,this).col);if(selectedRange.setHighlight(nestedHeaders_classPrivateFieldGet(_focusInitialCoords,this)),origColspan>selectedRange.getWidth()||columnIndex<columnStart||columnIndex+origColspan-1>columnEnd){const headerLevel=nestedHeaders_classPrivateFieldGet(_stateManager,this).findTopMostEntireHeaderLevel((0,number.qE)(columnStart,columnIndex,columnIndex+origColspan-1),(0,number.qE)(columnEnd,columnIndex,columnIndex+origColspan-1));selectedRange.highlight.row=headerLevel,selectedRange.highlight.col=selectedRange.from.col}}function nestedHeaders_onModifyTransformStart(delta){const{highlight}=this.hot.getSelectedRangeLast(),nextCoords=this.hot._createCellCoords(highlight.row+delta.row,highlight.col+delta.col);if(!(nextCoords.isHeader()&&nextCoords.col>=0))return;const visualColumnIndexStart=nestedHeaders_classPrivateFieldGet(_stateManager,this).findLeftMostColumnIndex(nextCoords.row,nextCoords.col),visualColumnIndexEnd=nestedHeaders_classPrivateFieldGet(_stateManager,this).findRightMostColumnIndex(nextCoords.row,nextCoords.col);if(delta.col<0){const nextColumn=highlight.col>=visualColumnIndexStart&&highlight.col<=visualColumnIndexEnd?visualColumnIndexStart-1:visualColumnIndexEnd,notHiddenColumnIndex=this.hot.columnIndexMapper.getNearestNotHiddenIndex(nextColumn,-1);delta.col=null===notHiddenColumnIndex?-this.hot.view.countRenderableColumnsInRange(0,highlight.col):-Math.max(this.hot.view.countRenderableColumnsInRange(notHiddenColumnIndex,highlight.col)-1,1)}else if(delta.col>0){const nextColumn=highlight.col>=visualColumnIndexStart&&highlight.col<=visualColumnIndexEnd?visualColumnIndexEnd+1:visualColumnIndexStart,notHiddenColumnIndex=this.hot.columnIndexMapper.getNearestNotHiddenIndex(nextColumn,1);delta.col=null===notHiddenColumnIndex?this.hot.view.countRenderableColumnsInRange(highlight.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(highlight.col,notHiddenColumnIndex)-1,1)}}function _onBeforeSelectColumns(from,to,highlight){const headerLevel=from.row,startNodeData=this._getHeaderTreeNodeDataByCoords({row:headerLevel,col:from.col}),endNodeData=this._getHeaderTreeNodeDataByCoords({row:headerLevel,col:to.col});nestedHeaders_classPrivateFieldSet(_recentlyHighlightCoords,this,highlight.clone()),to.col<from.col?(startNodeData&&(from.col=startNodeData.columnIndex+startNodeData.origColspan-1),endNodeData&&(to.col=endNodeData.columnIndex)):to.col>=from.col&&(startNodeData&&(from.col=startNodeData.columnIndex),endNodeData&&(to.col=endNodeData.columnIndex+endNodeData.origColspan-1))}function _onAfterGetColumnHeaderRenderers(renderersArray){if(nestedHeaders_classPrivateFieldGet(_stateManager,this).getLayersCount()>0){renderersArray.length=0;for(let headerLayer=0;headerLayer<nestedHeaders_classPrivateFieldGet(_stateManager,this).getLayersCount();headerLayer++)renderersArray.push(this.headerRendererFactory(headerLayer))}}function nestedHeaders_onAfterViewportColumnCalculatorOverride(calc){const headerLayersCount=nestedHeaders_classPrivateFieldGet(_stateManager,this).getLayersCount();let newStartColumn=calc.startColumn,nonRenderable=!!headerLayersCount;for(let headerLayer=0;headerLayer<headerLayersCount;headerLayer++){const startColumn=nestedHeaders_classPrivateFieldGet(_stateManager,this).findLeftMostColumnIndex(headerLayer,calc.startColumn),renderedStartColumn=this.hot.columnIndexMapper.getRenderableFromVisualIndex(startColumn);if(startColumn>=0&&(nonRenderable=!1),(0,number.kf)(renderedStartColumn)&&renderedStartColumn<calc.startColumn){newStartColumn=renderedStartColumn;break}}calc.startColumn=nonRenderable?nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderTreeNodeData(0,newStartColumn).columnIndex:newStartColumn}function nestedHeaders_onModifyColWidth(width,column){const cachedWidth=this.ghostTable.getWidth(column);return width>cachedWidth?width:cachedWidth}function _onModifyColumnHeaderValue(value,visualColumnIndex,headerLevel){var _classPrivateFieldGet6;const{label}=null!==(_classPrivateFieldGet6=nestedHeaders_classPrivateFieldGet(_stateManager,this).getHeaderTreeNodeData(headerLevel,visualColumnIndex))&&void 0!==_classPrivateFieldGet6?_classPrivateFieldGet6:{label:""};return label}function _onModifyFocusedElement(row,column){if(row<0)return this.hot.getCell(row,nestedHeaders_classPrivateFieldGet(_stateManager,this).findLeftMostColumnIndex(row,column),!0)}function nestedHeaders_onInit(){this.updatePlugin()}function nestedHeaders_onAfterLoadData(sourceData,initialLoad){initialLoad||this.updatePlugin()}function dataManager_defineProperty(e,r,t){return(r=function dataManager_toPropertyKey(t){var i=function dataManager_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const dataManager=class DataManager{constructor(nestedRowsPlugin,hotInstance){dataManager_defineProperty(this,"hot",void 0),dataManager_defineProperty(this,"data",null),dataManager_defineProperty(this,"plugin",void 0),dataManager_defineProperty(this,"parentReference",new WeakMap),dataManager_defineProperty(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=hotInstance,this.plugin=nestedRowsPlugin}setData(data){this.data=data}getData(){return this.data}getRawSourceData(){let rawSourceData=null;return this.plugin.disableCoreAPIModifiers(),rawSourceData=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),rawSourceData}updateWithData(data){this.setData(data),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,number.Ti)(0,this.data.length-1,(i=>{this.cacheNode(this.data[i],0,null)}))}cacheNode(node,level,parent){this.cache.levels[level]||(this.cache.levels[level]=[],this.cache.levelCount+=1),this.cache.levels[level].push(node),this.cache.rows.push(node),this.cache.nodeInfo.set(node,{parent,row:this.cache.rows.length-1,level}),this.hasChildren(node)&&(0,array.z0)(node.__children,(elem=>{this.cacheNode(elem,level+1,node)}))}getDataObject(row){return null==row?null:this.cache.rows[row]}readTreeNodes(parent,readCount,neededIndex,neededObject){let rootLevel=!1,readNodesCount=readCount;if(isNaN(readNodesCount)&&readNodesCount.end)return readNodesCount;let parentObj=parent;return parentObj||(parentObj={__children:this.data},rootLevel=!0,readNodesCount-=1),null!=neededIndex&&readNodesCount===neededIndex?{result:parentObj,end:!0}:null!=neededObject&&parentObj===neededObject?{result:readNodesCount,end:!0}:(readNodesCount+=1,parentObj.__children&&(0,array.z0)(parentObj.__children,(val=>{if(this.parentReference.set(val,rootLevel?null:parentObj),readNodesCount=this.readTreeNodes(val,readNodesCount,neededIndex,neededObject),isNaN(readNodesCount)&&readNodesCount.end)return!1})),readNodesCount)}mockParent(){const fakeParent=this.mockNode();return fakeParent.__children=this.data,fakeParent}mockNode(){const fakeNode={};return(0,object.v4)(this.data[0],((val,key)=>{fakeNode[key]=null})),fakeNode}getRowIndex(rowObj){return null==rowObj?null:this.cache.nodeInfo.get(rowObj).row}getRowIndexWithinParent(row){let rowObj=null;rowObj=isNaN(row)?row:this.getDataObject(row);const parent=this.getRowParent(row);return null==parent?this.data.indexOf(rowObj):parent.__children.indexOf(rowObj)}countAllRows(){const rootNodeMock={__children:this.data};return this.countChildren(rootNodeMock)}countChildren(parent){let rowCount=0,parentNode=parent;return isNaN(parentNode)||(parentNode=this.getDataObject(parentNode)),parentNode&&parentNode.__children?((0,array.z0)(parentNode.__children,(elem=>{rowCount+=1,elem.__children&&(rowCount+=this.countChildren(elem))})),rowCount):0}getRowParent(row){let rowObject;return rowObject=isNaN(row)?row:this.getDataObject(row),this.getRowObjectParent(rowObject)}getRowObjectParent(rowObject){return rowObject&&"object"==typeof rowObject?this.cache.nodeInfo.get(rowObject).parent:null}getRowLevel(row){let rowObject=null;return rowObject=isNaN(row)?row:this.getDataObject(row),rowObject?this.getRowObjectLevel(rowObject):null}getRowObjectLevel(rowObject){return null==rowObject?null:this.cache.nodeInfo.get(rowObject).level}hasChildren(row){let rowObj=row;return isNaN(rowObj)||(rowObj=this.getDataObject(rowObj)),!(!rowObj.__children||!rowObj.__children.length)}isChild(index){return null!==this.getRowParent(index)}getChild(parent,index){var _parent$__children;return(null===(_parent$__children=parent.__children)||void 0===_parent$__children?void 0:_parent$__children[index])||null}isRowHighestLevel(index){return!this.isChild(index)}isParent(row){var _rowObj$__children;let rowObj=row;return isNaN(rowObj)||(rowObj=this.getDataObject(rowObj)),rowObj&&!!rowObj.__children&&0!==(null===(_rowObj$__children=rowObj.__children)||void 0===_rowObj$__children?void 0:_rowObj$__children.length)}addChild(parent,element){let childElement=element;this.hot.runHooks("beforeAddChild",parent,childElement);let parentIndex=null;parent&&(parentIndex=this.getRowIndex(parent)),this.hot.runHooks("beforeCreateRow",parentIndex+this.countChildren(parent)+1,1);let functionalParent=parent;parent||(functionalParent=this.mockParent()),functionalParent.__children||(functionalParent.__children=[]),childElement||(childElement=this.mockNode()),functionalParent.__children.push(childElement),this.rewriteCache();const newRowIndex=this.getRowIndex(childElement);this.hot.rowIndexMapper.insertIndexes(newRowIndex,1),this.hot.runHooks("afterCreateRow",newRowIndex,1),this.hot.runHooks("afterAddChild",parent,childElement)}addChildAtIndex(parent,index,element){let flattenedIndex,childElement=element;if(childElement||(childElement=this.mockNode()),this.hot.runHooks("beforeAddChild",parent,childElement,index),parent){const finalChildIndex=this.getRowIndex(parent)+index+1;this.hot.runHooks("beforeCreateRow",finalChildIndex,1),parent.__children.splice(index,null,childElement),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(parent),"__children",parent.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(finalChildIndex,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",finalChildIndex,1),flattenedIndex=finalChildIndex}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",index,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),flattenedIndex=this.getRowIndex(this.data[index]);childElement=this.getDataObject(flattenedIndex),this.hot.runHooks("afterAddChild",parent,childElement,index)}addSibling(index){let where=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const translatedIndex=this.translateTrimmedRow(index),parent=this.getRowParent(translatedIndex),indexWithinParent=this.getRowIndexWithinParent(translatedIndex);switch(where){case"below":this.addChildAtIndex(parent,indexWithinParent+1,null);break;case"above":this.addChildAtIndex(parent,indexWithinParent,null)}}detachFromParent(elements){let forceRender=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],element=null;const rowObjects=[];Array.isArray(elements)?((0,number.Ti)(elements[0],elements[2],(i=>{const translatedIndex=this.translateTrimmedRow(i);rowObjects.push(this.getDataObject(translatedIndex))})),(0,number.Ti)(0,rowObjects.length-2,(i=>{this.detachFromParent(rowObjects[i],!1)})),element=rowObjects[rowObjects.length-1]):element=elements;const childRowIndex=this.getRowIndex(element),childCount=this.countChildren(element),indexWithinParent=this.getRowIndexWithinParent(element),parent=this.getRowParent(element),grandparent=this.getRowParent(parent),grandparentRowIndex=this.getRowIndex(grandparent);let movedElementRowIndex=null;if(this.hot.runHooks("beforeDetachChild",parent,element),null!=indexWithinParent){const removedRowIndexes=Array.from(new Array(childRowIndex+childCount+1).keys()).splice(-1*(childCount+1));if(this.hot.runHooks("beforeRemoveRow",childRowIndex,childCount+1,removedRowIndexes,this.plugin.pluginName),parent.__children.splice(indexWithinParent,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",childRowIndex,childCount+1,removedRowIndexes,this.plugin.pluginName),grandparent){movedElementRowIndex=grandparentRowIndex+this.countChildren(grandparent);const lastGrandparentChild=this.getChild(grandparent,this.countChildren(grandparent)-1),lastGrandparentChildIndex=this.getRowIndex(lastGrandparentChild);this.hot.runHooks("beforeCreateRow",lastGrandparentChildIndex+1,childCount+1,this.plugin.pluginName),grandparent.__children.push(element)}else movedElementRowIndex=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",movedElementRowIndex-2,childCount+1,this.plugin.pluginName),this.data.push(element)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",movedElementRowIndex-2,childCount+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",parent,element,this.getRowIndex(element)),forceRender&&this.hot.render()}filterData(index,amount,logicRows){const elementsToRemove=[];(0,array.z0)(logicRows,(elem=>{elementsToRemove.push(this.getDataObject(elem))})),(0,array.z0)(elementsToRemove,(elem=>{const indexWithinParent=this.getRowIndexWithinParent(elem),tempParent=this.getRowParent(elem);null===tempParent?this.data.splice(indexWithinParent,1):tempParent.__children.splice(indexWithinParent,1)})),this.rewriteCache()}spliceData(index,amount,elements){const previousElement=this.getDataObject(index-1);let newRowParent=null,indexWithinParent=index;previousElement&&previousElement.__children&&0===previousElement.__children.length?(newRowParent=previousElement,indexWithinParent=0):index<this.countAllRows()&&(newRowParent=this.getRowParent(index),indexWithinParent=this.getRowIndexWithinParent(index)),newRowParent?elements?newRowParent.__children.splice(indexWithinParent,amount,...elements):newRowParent.__children.splice(indexWithinParent,amount):elements?this.data.splice(indexWithinParent,amount,...elements):this.data.splice(indexWithinParent,amount),this.rewriteCache()}syncRowWithRawSource(rowElement){let upmostParent=rowElement,tempParent=null;do{tempParent=this.getRowParent(tempParent),null!==tempParent&&(upmostParent=tempParent)}while(null!==tempParent);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(upmostParent),"__children",upmostParent.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(fromIndex,toIndex,moveToCollapsed,moveToLastChild){const moveToLastRow=toIndex===this.hot.countRows(),fromParent=this.getRowParent(fromIndex),indexInFromParent=this.getRowIndexWithinParent(fromIndex),elemToMove=fromParent.__children.slice(indexInFromParent,indexInFromParent+1),movingUp=fromIndex>toIndex;let toParent=moveToLastRow?this.getRowParent(toIndex-1):this.getRowParent(toIndex);null==toParent&&(toParent=this.getRowParent(toIndex-1)),null==toParent&&(toParent=this.getDataObject(toIndex-1)),toParent?toParent.__children||(toParent.__children=[]):(toParent=this.getDataObject(toIndex),toParent.__children=[]);const indexInTargetParent=moveToLastRow||moveToCollapsed||moveToLastChild?toParent.__children.length:this.getRowIndexWithinParent(toIndex),sameParent=fromParent===toParent;toParent.__children.splice(indexInTargetParent,0,elemToMove[0]),fromParent.__children.splice(indexInFromParent+(movingUp&&sameParent?1:0),1),this.syncRowWithRawSource(fromParent),sameParent||this.syncRowWithRawSource(toParent)}translateTrimmedRow(row){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(row):row}untranslateTrimmedRow(row){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(row):row}};function nestedRows_ui_base_defineProperty(e,r,t){return(r=function nestedRows_ui_base_toPropertyKey(t){var i=function nestedRows_ui_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const nestedRows_ui_base=class nestedRows_ui_base_BaseUI{constructor(pluginInstance,hotInstance){nestedRows_ui_base_defineProperty(this,"hot",void 0),nestedRows_ui_base_defineProperty(this,"plugin",void 0),this.hot=hotInstance,this.plugin=pluginInstance}};class HeadersUI extends nestedRows_ui_base{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(nestedRowsPlugin,hotInstance){super(nestedRowsPlugin,hotInstance),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(row,TH){const rowIndex=this.hot.toPhysicalRow(row),rowLevel=this.dataManager.getRowLevel(rowIndex),rowObject=this.dataManager.getDataObject(rowIndex),innerDiv=TH.getElementsByTagName("DIV")[0],innerSpan=innerDiv.querySelector("span.rowHeader"),previousIndicators=innerDiv.querySelectorAll('[class^="ht_nesting"]'),ariaEnabled=this.hot.getSettings().ariaTags;if((0,array.z0)(previousIndicators,(elem=>{elem&&innerDiv.removeChild(elem)})),(0,dom_element.iQ)(TH,HeadersUI.CSS_CLASSES.indicatorContainer),rowLevel){const{rootDocument}=this.hot,initialContent=innerSpan.cloneNode(!0);innerDiv.innerHTML="",(0,number.Ti)(0,rowLevel-1,(()=>{const levelIndicator=rootDocument.createElement("SPAN");(0,dom_element.iQ)(levelIndicator,HeadersUI.CSS_CLASSES.emptyIndicator),innerDiv.appendChild(levelIndicator)})),innerDiv.appendChild(initialContent)}if(this.dataManager.hasChildren(rowObject)){const buttonsContainer=this.hot.rootDocument.createElement("DIV");ariaEnabled&&(0,dom_element.Bq)(buttonsContainer,[(0,a11y.MG)()]),(0,dom_element.iQ)(TH,HeadersUI.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(rowIndex)?((0,dom_element.iQ)(buttonsContainer,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.expandButton}`),ariaEnabled&&(0,dom_element.Bq)(TH,[(0,a11y.dV)(!1)])):((0,dom_element.iQ)(buttonsContainer,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.collapseButton}`),ariaEnabled&&(0,dom_element.Bq)(TH,[(0,a11y.dV)(!0)])),innerDiv.appendChild(buttonsContainer)}}updateRowHeaderWidth(deepestLevel){let deepestLevelIndex=deepestLevel;deepestLevelIndex||(deepestLevelIndex=this.dataManager.cache.levelCount);const stylesHandler=this.hot.view.getStylesHandler();let completeVerticalPadding=11;if(!stylesHandler.isClassicTheme()){completeVerticalPadding=2*stylesHandler.getCSSVariableValue("cell-horizontal-padding")}this.rowHeaderWidthCache=Math.max(50,completeVerticalPadding+10*deepestLevelIndex+25),this.hot.render()}}const headers=HeadersUI;const collapsing=class CollapsingUI extends nestedRows_ui_base{constructor(nestedRowsPlugin,hotInstance){var _this;super(nestedRowsPlugin,hotInstance),_this=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let forceRender=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_this.lastCollapsedRows=_this.collapsedRows.slice(0),_this.expandMultipleChildren(_this.lastCollapsedRows,forceRender)},shiftStash:function(baseIndex,targetIndex){let delta=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==targetIndex&&(targetIndex=1/0),(0,array.z0)(_this.lastCollapsedRows,((elem,i)=>{elem>=baseIndex&&elem<targetIndex&&(_this.lastCollapsedRows[i]=elem+delta)}))},applyStash:function(){let forceRender=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];_this.collapseMultipleChildren(_this.lastCollapsedRows,forceRender),_this.lastCollapsedRows=void 0},trimStash:(realElementIndex,amount)=>{(0,number.Ti)(realElementIndex,realElementIndex+amount-1,(i=>{const indexOfElement=this.lastCollapsedRows.indexOf(i);indexOfElement>-1&&this.lastCollapsedRows.splice(indexOfElement,1)}))}}}collapseChildren(row){let forceRender=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],doTrimming=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const rowsToCollapse=[];let rowObject=null,rowIndex=null,rowsToTrim=null;return isNaN(row)?(rowObject=row,rowIndex=this.dataManager.getRowIndex(rowObject)):(rowObject=this.dataManager.getDataObject(row),rowIndex=row),this.dataManager.hasChildren(rowObject)&&(0,array.z0)(rowObject.__children,(elem=>{rowsToCollapse.push(this.dataManager.getRowIndex(elem))})),rowsToTrim=this.collapseRows(rowsToCollapse,!0,!1),doTrimming&&this.trimRows(rowsToTrim),forceRender&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(rowIndex)&&this.collapsedRows.push(rowIndex),rowsToTrim}collapseMultipleChildren(rows){let forceRender=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],doTrimming=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const rowsToTrim=[];(0,array.z0)(rows,(elem=>{rowsToTrim.push(...this.collapseChildren(elem,!1,!1))})),doTrimming&&this.trimRows(rowsToTrim),forceRender&&this.renderAndAdjust()}collapseRow(rowIndex){let recursive=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([rowIndex],recursive)}collapseRows(rowIndexes){let recursive=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],doTrimming=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const rowsToTrim=[];return(0,array.z0)(rowIndexes,(elem=>{rowsToTrim.push(elem),recursive&&this.collapseChildRows(elem,rowsToTrim)})),doTrimming&&this.trimRows(rowsToTrim),rowsToTrim}collapseChildRows(parentIndex){let rowsToTrim=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],doTrimming=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(parentIndex)){const parentObject=this.dataManager.getDataObject(parentIndex);(0,array.z0)(parentObject.__children,(elem=>{const elemIndex=this.dataManager.getRowIndex(elem);rowsToTrim.push(elemIndex),this.collapseChildRows(elemIndex,rowsToTrim)}))}doTrimming&&this.trimRows(rowsToTrim)}expandRow(rowIndex){let recursive=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([rowIndex],recursive)}expandRows(rowIndexes){let recursive=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],doTrimming=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const rowsToUntrim=[];return(0,array.z0)(rowIndexes,(elem=>{rowsToUntrim.push(elem),recursive&&this.expandChildRows(elem,rowsToUntrim)})),doTrimming&&this.untrimRows(rowsToUntrim),rowsToUntrim}expandChildRows(parentIndex){let rowsToUntrim=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],doTrimming=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(parentIndex)){const parentObject=this.dataManager.getDataObject(parentIndex);(0,array.z0)(parentObject.__children,(elem=>{if(!this.isAnyParentCollapsed(elem)){const elemIndex=this.dataManager.getRowIndex(elem);rowsToUntrim.push(elemIndex),this.expandChildRows(elemIndex,rowsToUntrim)}}))}doTrimming&&this.untrimRows(rowsToUntrim)}expandChildren(row){let forceRender=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],doTrimming=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const rowsToExpand=[];let rowObject=null,rowIndex=null,rowsToUntrim=null;return isNaN(row)?(rowObject=row,rowIndex=this.dataManager.getRowIndex(row)):(rowObject=this.dataManager.getDataObject(row),rowIndex=row),this.collapsedRows.splice(this.collapsedRows.indexOf(rowIndex),1),this.dataManager.hasChildren(rowObject)&&(0,array.z0)(rowObject.__children,(elem=>{const childIndex=this.dataManager.getRowIndex(elem);rowsToExpand.push(childIndex)})),rowsToUntrim=this.expandRows(rowsToExpand,!0,!1),doTrimming&&this.untrimRows(rowsToUntrim),forceRender&&this.renderAndAdjust(),rowsToUntrim}expandMultipleChildren(rows){let forceRender=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],doTrimming=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const rowsToUntrim=[];(0,array.z0)(rows,(elem=>{rowsToUntrim.push(...this.expandChildren(elem,!1,!1))})),doTrimming&&this.untrimRows(rowsToUntrim),forceRender&&this.renderAndAdjust()}collapseAll(){const data=this.dataManager.getData(),parentsToCollapse=[];(0,array.z0)(data,(elem=>{this.dataManager.hasChildren(elem)&&parentsToCollapse.push(elem)})),this.collapseMultipleChildren(parentsToCollapse),this.renderAndAdjust()}expandAll(){const data=this.dataManager.getData(),parentsToExpand=[];(0,array.z0)(data,(elem=>{this.dataManager.hasChildren(elem)&&parentsToExpand.push(elem)})),this.expandMultipleChildren(parentsToExpand),this.renderAndAdjust()}trimRows(rows){this.hot.batchExecution((()=>{(0,array.z0)(rows,(physicalRow=>{this.plugin.collapsedRowsMap.setValueAtIndex(physicalRow,!0)}))}),!0)}untrimRows(rows){this.hot.batchExecution((()=>{(0,array.z0)(rows,(physicalRow=>{this.plugin.collapsedRowsMap.setValueAtIndex(physicalRow,!1)}))}),!0)}areChildrenCollapsed(row){let rowObj=isNaN(row)?row:this.dataManager.getDataObject(row),allCollapsed=!0;return null===rowObj&&(rowObj={__children:this.dataManager.data}),this.dataManager.hasChildren(rowObj)&&(0,array.z0)(rowObj.__children,(elem=>{const rowIndex=this.dataManager.getRowIndex(elem);if(!this.plugin.collapsedRowsMap.getValueAtIndex(rowIndex))return allCollapsed=!1,!1})),allCollapsed}isAnyParentCollapsed(rowObj){let parent=rowObj;for(;null!==parent;){parent=this.dataManager.getRowParent(parent);const parentIndex=this.dataManager.getRowIndex(parent);if(this.collapsedRows.indexOf(parentIndex)>-1)return!0}return!1}toggleState(event,coords){if(coords.col>=0)return;const row=this.translateTrimmedRow(coords.row);(0,dom_element.nB)(event.target,headers.CSS_CLASSES.button)&&(this.areChildrenCollapsed(row)?this.expandChildren(row):this.collapseChildren(row),(0,dom_event.CA)(event))}translateTrimmedRow(row){return this.hot.toPhysicalRow(row)}untranslateTrimmedRow(row){return this.hot.toVisualRow(row)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};function contextMenu_classPrivateFieldInitSpec(e,t,a){(function ui_contextMenu_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function ui_contextMenu_defineProperty(e,r,t){return(r=function ui_contextMenu_toPropertyKey(t){var i=function ui_contextMenu_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function contextMenu_classPrivateFieldGet(s,a){return s.get(function ui_contextMenu_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(s,a))}var _menuEntries=new WeakMap;const contextMenu=class ContextMenuUI extends nestedRows_ui_base{constructor(){super(...arguments),ui_contextMenu_defineProperty(this,"dataManager",this.plugin.dataManager),contextMenu_classPrivateFieldInitSpec(this,_menuEntries,{row_above:(key,selection)=>{const lastSelection=selection[selection.length-1];this.dataManager.addSibling(lastSelection.start.row,"above")},row_below:(key,selection)=>{const lastSelection=selection[selection.length-1];this.dataManager.addSibling(lastSelection.start.row,"below")}})}appendOptions(defaultOptions){const newEntries=[{key:"add_child",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{const translatedRowIndex=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),parent=this.dataManager.getDataObject(translatedRowIndex);this.dataManager.addChild(parent)},disabled:()=>{const selected=this.hot.getSelectedLast();return!selected||selected[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(i18n_constants.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const selected=this.hot.getSelectedLast(),translatedRowIndex=this.dataManager.translateTrimmedRow(selected[0]);return!this.dataManager.getRowParent(translatedRowIndex)||!selected||selected[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,number.Ti)(0,defaultOptions.items.length-1,(i=>{if(0===i)return(0,array.z0)(newEntries,((val,j)=>{defaultOptions.items.splice(i+j,0,val)})),!1})),this.modifyRowInsertingOptions(defaultOptions)}modifyRowInsertingOptions(defaultOptions){return(0,number.Ti)(0,defaultOptions.items.length-1,(i=>{const option=contextMenu_classPrivateFieldGet(_menuEntries,this)[defaultOptions.items[i].key];null!=option&&(defaultOptions.items[i].callback=option)})),defaultOptions}};function rowMoveController_defineProperty(e,r,t){return(r=function rowMoveController_toPropertyKey(t){var i=function rowMoveController_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RowMoveController{constructor(plugin){rowMoveController_defineProperty(this,"plugin",void 0),rowMoveController_defineProperty(this,"hot",void 0),rowMoveController_defineProperty(this,"dataManager",void 0),rowMoveController_defineProperty(this,"collapsingUI",void 0),this.plugin=plugin,this.hot=plugin.hot,this.dataManager=plugin.dataManager,this.collapsingUI=plugin.collapsingUI}onBeforeRowMove(rows,finalIndex,dropIndex,movePossible){if(this.displayAPICompatibilityWarning({rows,finalIndex,dropIndex,movePossible}))return!1;this.movedToCollapsed=!1;const dropToLastRow=dropIndex===this.hot.countRows(),physicalDropIndex=dropToLastRow?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(dropIndex);let allowMove=!0;const physicalStartIndexes=rows.map((rowIndex=>{if(!allowMove)return!1;const physicalRowIndex=this.dataManager.translateTrimmedRow(rowIndex);return allowMove=this.shouldAllowMoving(physicalRowIndex,physicalDropIndex),physicalRowIndex})),willDataChange=-1===physicalStartIndexes.indexOf(physicalDropIndex);if(!allowMove||!willDataChange)return!1;const baseParent=this.getBaseParent(physicalStartIndexes),targetParent=this.getTargetParent(dropToLastRow,physicalDropIndex),sameParent=baseParent===targetParent;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(targetParent),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(physicalStartIndexes,physicalDropIndex,sameParent),this.moveRows(physicalStartIndexes,physicalDropIndex,targetParent),this.dataManager.rewriteCache(),this.moveCellsMeta(physicalStartIndexes,physicalDropIndex),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",rows,finalIndex,dropIndex,movePossible,movePossible&&this.isRowOrderChanged(rows,finalIndex)),this.hot.render(),this.selectCells(rows,dropIndex),!1}displayAPICompatibilityWarning(beforeMoveRowHookArgs){const{rows,finalIndex,dropIndex,movePossible}=beforeMoveRowHookArgs;let shouldTerminate=!1;return(0,mixed.b0)(dropIndex)&&((0,helpers_console.R8)(templateLiteralTag.O`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",rows,finalIndex,dropIndex,movePossible,!1),shouldTerminate=!0),shouldTerminate}shouldAllowMoving(physicalRowIndex,physicalDropIndex){return!(this.dataManager.isParent(physicalRowIndex)||this.dataManager.isRowHighestLevel(physicalRowIndex)||physicalRowIndex===physicalDropIndex||0===physicalDropIndex)}getBaseParent(physicalStartIndexes){return this.dataManager.getRowParent(physicalStartIndexes[0])}getTargetParent(dropToLastRow,physicalDropIndex){let targetParent=this.dataManager.getRowParent(dropToLastRow?physicalDropIndex-1:physicalDropIndex);return null==targetParent&&(targetParent=this.dataManager.getRowParent(physicalDropIndex-1)),targetParent}shiftCollapsibleParentsLocations(physicalStartIndexes,physicalDropIndex,sameParent){sameParent||(Math.max(...physicalStartIndexes)<=physicalDropIndex?this.collapsingUI.collapsedRowsStash.shiftStash(physicalStartIndexes[0],physicalDropIndex,-1*physicalStartIndexes.length):this.collapsingUI.collapsedRowsStash.shiftStash(physicalDropIndex,physicalStartIndexes[0],physicalStartIndexes.length))}moveRows(physicalStartIndexes,physicalDropIndex,targetParent){const moveToLastChild=physicalDropIndex===this.dataManager.getRowIndex(targetParent)+this.dataManager.countChildren(targetParent)+1;this.hot.batchRender((()=>{physicalStartIndexes.forEach((physicalStartIndex=>{this.dataManager.moveRow(physicalStartIndex,physicalDropIndex,this.movedToCollapsed,moveToLastChild)}))}))}moveCellsMeta(baseIndexes,targetIndex){const rowsOfMeta=[],movingDown=Math.max(...baseIndexes)<targetIndex;baseIndexes.forEach((baseIndex=>{rowsOfMeta.push(this.hot.getCellMetaAtRow(baseIndex))})),this.hot.spliceCellsMeta(baseIndexes[0],baseIndexes.length),this.hot.spliceCellsMeta(targetIndex-(movingDown?rowsOfMeta.length:0),0,...rowsOfMeta)}selectCells(rows,dropIndex){const rowsLen=rows.length;let startRow=0,endRow=0;if(this.movedToCollapsed){let physicalDropIndex=null;physicalDropIndex=rows[rowsLen-1]<dropIndex?this.dataManager.translateTrimmedRow(dropIndex-rowsLen):this.dataManager.translateTrimmedRow(dropIndex);const parentObject=this.dataManager.getRowParent(null===physicalDropIndex?this.hot.countSourceRows()-1:physicalDropIndex-1),parentIndex=this.dataManager.getRowIndex(parentObject);startRow=this.dataManager.untranslateTrimmedRow(parentIndex),endRow=startRow}else rows[rowsLen-1]<dropIndex?(endRow=dropIndex-1,startRow=endRow-rowsLen+1):(startRow=dropIndex,endRow=startRow+rowsLen-1);this.hot.selectCells([[startRow,0,endRow,this.hot.countCols()-1]],!1)}isRowOrderChanged(movedRows,finalIndex){return movedRows.some(((row,nrOfMovedElement)=>row-nrOfMovedElement!==finalIndex))}}function nestedRows_classPrivateFieldInitSpec(e,t,a){nestedRows_checkPrivateRedeclaration(e,t),t.set(e,a)}function nestedRows_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nestedRows_defineProperty(e,r,t){return(r=function nestedRows_toPropertyKey(t){var i=function nestedRows_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function nestedRows_classPrivateFieldGet(s,a){return s.get(nestedRows_assertClassBrand(s,a))}function nestedRows_classPrivateFieldSet(s,a,r){return s.set(nestedRows_assertClassBrand(s,a),r),r}function nestedRows_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _skipRender=new WeakMap,_skipCoreAPIModifiers=new WeakMap,_NestedRows_brand=new WeakSet;class NestedRows extends BasePlugin{constructor(){super(...arguments),function nestedRows_classPrivateMethodInitSpec(e,a){nestedRows_checkPrivateRedeclaration(e,a),a.add(e)}(this,_NestedRows_brand),nestedRows_defineProperty(this,"dataManager",null),nestedRows_defineProperty(this,"headersUI",null),nestedRows_defineProperty(this,"collapsedRowsMap",null),nestedRows_classPrivateFieldInitSpec(this,_skipRender,!1),nestedRows_classPrivateFieldInitSpec(this,_skipCoreAPIModifiers,!1)}static get PLUGIN_KEY(){return"nestedRows"}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings().nestedRows}enablePlugin(){var _this=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new trimmingMap.q),this.dataManager=new dataManager(this,this.hot),this.collapsingUI=new collapsing(this,this.hot),this.headersUI=new headers(this,this.hot),this.contextMenuUI=new contextMenu(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return nestedRows_assertClassBrand(_NestedRows_brand,_this,nestedRows_onAfterInit).call(_this,...args)})),this.addHook("beforeViewRender",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return nestedRows_assertClassBrand(_NestedRows_brand,_this,_onBeforeViewRender).call(_this,...args)})),this.addHook("modifyRowData",(function(){return _this.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return _this.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return _this.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return nestedRows_assertClassBrand(_NestedRows_brand,_this,_onFilterData).call(_this,...args)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return nestedRows_assertClassBrand(_NestedRows_brand,_this,nestedRows_onAfterContextMenuDefaultOptions).call(_this,...args)})),this.addHook("afterGetRowHeader",(function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return nestedRows_assertClassBrand(_NestedRows_brand,_this,nestedRows_onAfterGetRowHeader).call(_this,...args)})),this.addHook("beforeOnCellMouseDown",(function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return nestedRows_assertClassBrand(_NestedRows_brand,_this,nestedRows_onBeforeOnCellMouseDown).call(_this,...args)})),this.addHook("beforeRemoveRow",(function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return nestedRows_assertClassBrand(_NestedRows_brand,_this,nestedRows_onBeforeRemoveRow).call(_this,...args)})),this.addHook("afterRemoveRow",(function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return nestedRows_assertClassBrand(_NestedRows_brand,_this,nestedRows_onAfterRemoveRow).call(_this,...args)})),this.addHook("beforeAddChild",(function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return nestedRows_assertClassBrand(_NestedRows_brand,_this,_onBeforeAddChild).call(_this,...args)})),this.addHook("afterAddChild",(function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return nestedRows_assertClassBrand(_NestedRows_brand,_this,_onAfterAddChild).call(_this,...args)})),this.addHook("beforeDetachChild",(function(){for(var _len11=arguments.length,args=new Array(_len11),_key11=0;_key11<_len11;_key11++)args[_key11]=arguments[_key11];return nestedRows_assertClassBrand(_NestedRows_brand,_this,_onBeforeDetachChild).call(_this,...args)})),this.addHook("afterDetachChild",(function(){for(var _len12=arguments.length,args=new Array(_len12),_key12=0;_key12<_len12;_key12++)args[_key12]=arguments[_key12];return nestedRows_assertClassBrand(_NestedRows_brand,_this,nestedRows_onAfterDetachChild).call(_this,...args)})),this.addHook("modifyRowHeaderWidth",(function(){for(var _len13=arguments.length,args=new Array(_len13),_key13=0;_key13<_len13;_key13++)args[_key13]=arguments[_key13];return nestedRows_assertClassBrand(_NestedRows_brand,_this,_onModifyRowHeaderWidth).call(_this,...args)})),this.addHook("afterCreateRow",(function(){for(var _len14=arguments.length,args=new Array(_len14),_key14=0;_key14<_len14;_key14++)args[_key14]=arguments[_key14];return nestedRows_assertClassBrand(_NestedRows_brand,_this,nestedRows_onAfterCreateRow).call(_this,...args)})),this.addHook("beforeRowMove",(function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];return nestedRows_assertClassBrand(_NestedRows_brand,_this,_onBeforeRowMove).call(_this,...args)})),this.addHook("beforeLoadData",(data=>nestedRows_assertClassBrand(_NestedRows_brand,this,nestedRows_onBeforeLoadData).call(this,data))),this.addHook("beforeUpdateData",(data=>nestedRows_assertClassBrand(_NestedRows_brand,this,nestedRows_onBeforeLoadData).call(this,data))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const currentSourceData=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(currentSourceData),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight}=this.hot.getSelectedRangeLast(),row=this.collapsingUI.translateTrimmedRow(highlight.row);return this.collapsingUI.areChildrenCollapsed(row)?this.collapsingUI.expandChildren(row):this.collapsingUI.collapseChildren(row),!1},runOnlyIf:()=>{var _this$hot$getSelected,_this$hot$getSelected2;const highlight=null===(_this$hot$getSelected=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected?void 0:_this$hot$getSelected.highlight;return highlight&&(null===(_this$hot$getSelected2=this.hot.getSelectedRangeLast())||void 0===_this$hot$getSelected2?void 0:_this$hot$getSelected2.isSingle())&&this.hot.selection.isCellVisible(highlight)&&-1===highlight.col&&highlight.row>=0},group:"nestedRows",relativeToGroup:constants.b,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("nestedRows")}disableCoreAPIModifiers(){nestedRows_classPrivateFieldSet(_skipCoreAPIModifiers,this,!0)}enableCoreAPIModifiers(){nestedRows_classPrivateFieldSet(_skipCoreAPIModifiers,this,!1)}onModifyRowData(row){if(!nestedRows_classPrivateFieldGet(_skipCoreAPIModifiers,this))return this.dataManager.getDataObject(row)}onModifySourceLength(){if(!nestedRows_classPrivateFieldGet(_skipCoreAPIModifiers,this))return this.dataManager.countAllRows()}onBeforeDataSplice(index,amount,element){return!(!nestedRows_classPrivateFieldGet(_skipCoreAPIModifiers,this)&&!this.dataManager.isRowHighestLevel(index))||(this.dataManager.spliceData(index,amount,element),!1)}destroy(){super.destroy()}}function _onBeforeRowMove(rows,finalIndex,dropIndex,movePossible){return this.rowMoveController.onBeforeRowMove(rows,finalIndex,dropIndex,movePossible)}function nestedRows_onBeforeOnCellMouseDown(event,coords,TD){this.collapsingUI.toggleState(event,coords,TD)}function _onFilterData(index,amount,physicalRows){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(physicalRows[0],amount),this.collapsingUI.collapsedRowsStash.shiftStash(physicalRows[0],null,-1*amount),this.dataManager.filterData(index,amount,physicalRows),nestedRows_classPrivateFieldSet(_skipRender,this,!0),this.dataManager.getData().slice()}function nestedRows_onAfterContextMenuDefaultOptions(defaultOptions){return this.contextMenuUI.appendOptions(defaultOptions)}function nestedRows_onAfterGetRowHeader(row,TH){this.headersUI.appendLevelIndicators(row,TH)}function _onModifyRowHeaderWidth(rowHeaderWidth){return Math.max(this.headersUI.rowHeaderWidthCache,rowHeaderWidth)}function nestedRows_onAfterRemoveRow(index,amount,logicRows,source){source!==this.pluginName&&this.hot._registerTimeout((()=>{nestedRows_classPrivateFieldSet(_skipRender,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function nestedRows_onBeforeRemoveRow(index,amount,physicalRows){const modifiedPhysicalRows=Array.from(physicalRows.reduce(((removedRows,physicalIndex)=>{if(this.dataManager.isParent(physicalIndex)){const children=this.dataManager.getDataObject(physicalIndex).__children;return removedRows.add(physicalIndex),Array.isArray(children)&&children.forEach((child=>removedRows.add(this.dataManager.getRowIndex(child)))),removedRows}return removedRows.add(physicalIndex)}),new Set));physicalRows.length=0,physicalRows.push(...modifiedPhysicalRows)}function _onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterAddChild(parent,element){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(element)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}function nestedRows_onAfterDetachChild(parent,element,finalElementRowIndex){this.collapsingUI.collapsedRowsStash.shiftStash(finalElementRowIndex,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function nestedRows_onAfterCreateRow(){this.dataManager.rewriteCache()}function nestedRows_onAfterInit(){this.headersUI.updateRowHeaderWidth()}function _onBeforeViewRender(force,skipRender){nestedRows_classPrivateFieldGet(_skipRender,this)&&(skipRender.skipRender=!0)}function nestedRows_onBeforeLoadData(data){if(!(0,helpers_data.DJ)(data))return(0,helpers_console.z3)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings().nestedRows=!1,void this.disablePlugin();this.dataManager.setData(data),this.dataManager.rewriteCache()}function storage_defineProperty(e,r,t){return(r=function storage_toPropertyKey(t){var i=function storage_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const storage=class Storage{constructor(prefix){let rootWindow=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;storage_defineProperty(this,"rootWindow",void 0),storage_defineProperty(this,"prefix",void 0),storage_defineProperty(this,"savedKeys",[]),this.rootWindow=rootWindow,this.prefix=prefix,this.loadSavedKeys()}saveValue(key,value){this.rootWindow.localStorage.setItem(`${this.prefix}_${key}`,JSON.stringify(value)),-1===this.savedKeys.indexOf(key)&&(this.savedKeys.push(key),this.saveSavedKeys())}loadValue(key,defaultValue){const itemKey=void 0===key?defaultValue:key,value=this.rootWindow.localStorage.getItem(`${this.prefix}_${itemKey}`);return null===value?void 0:JSON.parse(value)}reset(key){this.rootWindow.localStorage.removeItem(`${this.prefix}_${key}`)}resetAll(){(0,array.z0)(this.savedKeys,((value,index)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[index]}`)})),this.clearSavedKeys()}loadSavedKeys(){const keysJSON=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),keys="string"==typeof keysJSON?JSON.parse(keysJSON):void 0;this.savedKeys=keys||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};function persistentState_defineProperty(e,r,t){return(r=function persistentState_toPropertyKey(t){var i=function persistentState_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}hooks.R.getSingleton().register("persistentStateSave"),hooks.R.getSingleton().register("persistentStateLoad"),hooks.R.getSingleton().register("persistentStateReset");class PersistentState extends BasePlugin{constructor(){super(...arguments),persistentState_defineProperty(this,"storage",void 0)}static get PLUGIN_KEY(){return"persistentState"}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings().persistentState}enablePlugin(){this.enabled||(this.storage||(this.storage=new storage(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((key,value)=>this.saveValue(key,value))),this.addHook("persistentStateLoad",((key,saveTo)=>this.loadValue(key,saveTo))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(key,saveTo){saveTo.value=this.storage.loadValue(key)}saveValue(key,value){this.storage.saveValue(key,value)}resetValue(key){void 0===key?this.storage.resetAll():this.storage.reset(key)}destroy(){super.destroy()}}function search_classPrivateMethodInitSpec(e,a){(function search_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function search_defineProperty(e,r,t){return(r=function search_toPropertyKey(t){var i=function search_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function search_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const DEFAULT_CALLBACK=function(instance,row,col,data,testResult){instance.getCellMeta(row,col).isSearchResult=testResult},DEFAULT_QUERY_METHOD=function(query,value,cellProperties){return!((0,mixed.b0)(query)||null===query||!query.toLocaleLowerCase||0===query.length)&&(!(0,mixed.b0)(value)&&null!==value&&-1!==value.toString().toLocaleLowerCase(cellProperties.locale).indexOf(query.toLocaleLowerCase(cellProperties.locale)))};var _Search_brand=new WeakSet;class Search extends BasePlugin{constructor(){super(...arguments),search_classPrivateMethodInitSpec(this,_Search_brand),search_defineProperty(this,"callback",DEFAULT_CALLBACK),search_defineProperty(this,"queryMethod",DEFAULT_QUERY_METHOD),search_defineProperty(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return"search"}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings().search}enablePlugin(){var _this=this;if(this.enabled)return;const searchSettings=this.hot.getSettings().search;this.updatePluginSettings(searchSettings),this.addHook("beforeRenderer",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return search_assertClassBrand(_Search_brand,_this,_onBeforeRenderer).call(_this,...args)})),super.enablePlugin()}disablePlugin(){var _this2=this;const beforeRendererCallback=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return search_assertClassBrand(_Search_brand,_this2,_onBeforeRenderer).call(_this2,...args)};this.hot.addHook("beforeRenderer",beforeRendererCallback),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",beforeRendererCallback)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(queryStr){let callback=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),queryMethod=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const rowCount=this.hot.countRows(),colCount=this.hot.countCols(),queryResult=[],instance=this.hot;return(0,number.Ti)(0,rowCount-1,(rowIndex=>{(0,number.Ti)(0,colCount-1,(colIndex=>{const cellData=this.hot.getDataAtCell(rowIndex,colIndex),cellProperties=this.hot.getCellMeta(rowIndex,colIndex),cellCallback=cellProperties.search.callback||callback,testResult=(cellProperties.search.queryMethod||queryMethod)(queryStr,cellData,cellProperties);if(testResult){const singleResult={row:rowIndex,col:colIndex,data:cellData};queryResult.push(singleResult)}cellCallback&&cellCallback(instance,rowIndex,colIndex,cellData,testResult)}))})),queryResult}getCallback(){return this.callback}setCallback(newCallback){this.callback=newCallback}getQueryMethod(){return this.queryMethod}setQueryMethod(newQueryMethod){this.queryMethod=newQueryMethod}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(newElementClass){this.searchResultClass=newElementClass}updatePluginSettings(searchSettings){(0,object.Gv)(searchSettings)&&(searchSettings.searchResultClass&&this.setSearchResultClass(searchSettings.searchResultClass),searchSettings.queryMethod&&this.setQueryMethod(searchSettings.queryMethod),searchSettings.callback&&this.setCallback(searchSettings.callback))}destroy(){super.destroy()}}function _onBeforeRenderer(TD,row,col,prop,value,cellProperties){const className=cellProperties.className||[];let classArray=[];"string"==typeof className?classArray=className.split(" "):classArray.push(...className),this.isEnabled()&&cellProperties.isSearchResult?classArray.includes(this.searchResultClass)||classArray.push(`${this.searchResultClass}`):classArray.includes(this.searchResultClass)&&classArray.splice(classArray.indexOf(this.searchResultClass),1),cellProperties.className=classArray.join(" ")}function strategies_base_defineProperty(e,r,t){return(r=function strategies_base_toPropertyKey(t){var i=function strategies_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class StretchStrategy{constructor(overwriteColumnWidthFn){strategies_base_defineProperty(this,"viewportWidth",void 0),strategies_base_defineProperty(this,"overwriteColumnWidthFn",void 0),strategies_base_defineProperty(this,"baseWidths",new Map),strategies_base_defineProperty(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=overwriteColumnWidthFn}prepare(_ref){let{viewportWidth}=_ref;this.viewportWidth=viewportWidth,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(columnVisualIndex,columnWidth){this.baseWidths.set(columnVisualIndex,columnWidth)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class StretchAllStrategy extends StretchStrategy{calculate(){const allColumnsWidth=Array.from(this.baseWidths).reduce(((sum,_ref)=>{let[,width]=_ref;return sum+width}),0);if(this.viewportWidth-allColumnsWidth<0)return void this.stretchedWidths.clear();const initialStretchRatio=this.viewportWidth/allColumnsWidth,stretchedWidths=[],fixedColumns=[];let viewportWidth=this.viewportWidth,allStretchedColumnsWidth=0;if(this.baseWidths.forEach(((columnWidth,columnVisualIndex)=>{const stretchedWidth=Math.round(columnWidth*initialStretchRatio),finalWidth=this.overwriteColumnWidthFn(stretchedWidth,columnVisualIndex);stretchedWidth===finalWidth&&stretchedWidth>=viewportColumns.j?(stretchedWidths.push([columnVisualIndex,finalWidth]),allStretchedColumnsWidth+=finalWidth):stretchedWidth!==finalWidth&&(stretchedWidths.push([columnVisualIndex,finalWidth]),fixedColumns.push(columnVisualIndex),viewportWidth-=finalWidth)})),viewportWidth<=viewportColumns.j)return void this.stretchedWidths.clear();const finalStretchRatio=viewportWidth/allStretchedColumnsWidth;let lastColumnIndex=-1,sumColumnsWithoutLastOne=0;stretchedWidths.forEach(((_ref2,index)=>{let[columnVisualIndex,columnWidth]=_ref2,newWidth=columnWidth;fixedColumns.includes(columnVisualIndex)||(newWidth=Math.round(columnWidth*finalStretchRatio)),this.stretchedWidths.set(columnVisualIndex,newWidth),lastColumnIndex=columnVisualIndex,index<stretchedWidths.length-1&&(sumColumnsWithoutLastOne+=newWidth)})),this.stretchedWidths.size>1&&this.stretchedWidths.set(lastColumnIndex,Math.round(this.viewportWidth-sumColumnsWithoutLastOne))}}function last_classPrivateFieldInitSpec(e,t,a){(function last_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function last_classPrivateFieldGet(s,a){return s.get(last_assertClassBrand(s,a))}function last_classPrivateFieldSet(s,a,r){return s.set(last_assertClassBrand(s,a),r),r}function last_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _lastColumnWidth=new WeakMap,_lastColumnIndex=new WeakMap;class StretchLastStrategy extends StretchStrategy{constructor(){super(...arguments),last_classPrivateFieldInitSpec(this,_lastColumnWidth,0),last_classPrivateFieldInitSpec(this,_lastColumnIndex,-1)}prepare(calcArgs){super.prepare(calcArgs),last_classPrivateFieldSet(_lastColumnWidth,this,0),last_classPrivateFieldSet(_lastColumnIndex,this,-1)}setColumnBaseWidth(columnVisualIndex,columnWidth){super.setColumnBaseWidth(columnVisualIndex,columnWidth),last_classPrivateFieldSet(_lastColumnIndex,this,columnVisualIndex),last_classPrivateFieldSet(_lastColumnWidth,this,columnWidth)}calculate(){if(-1===last_classPrivateFieldGet(_lastColumnIndex,this))return;const allColumnsWidth=Array.from(this.baseWidths).reduce(((sum,_ref)=>{let[,width]=_ref;return sum+width}),0),lastColumnWidth=Math.max(this.viewportWidth-allColumnsWidth+last_classPrivateFieldGet(_lastColumnWidth,this),0);this.stretchedWidths.set(last_classPrivateFieldGet(_lastColumnIndex,this),lastColumnWidth)}}function calculator_classPrivateFieldInitSpec(e,t,a){calculator_checkPrivateRedeclaration(e,t),t.set(e,a)}function calculator_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function calculator_classPrivateFieldGet(s,a){return s.get(calculator_assertClassBrand(s,a))}function calculator_classPrivateFieldSet(s,a,r){return s.set(calculator_assertClassBrand(s,a),r),r}function calculator_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _hot=new WeakMap,_widthsMap=new WeakMap,_stretchStrategies=new WeakMap,_activeStrategy=new WeakMap,_StretchCalculator_brand=new WeakSet;class StretchCalculator{constructor(hotInstance){!function calculator_classPrivateMethodInitSpec(e,a){calculator_checkPrivateRedeclaration(e,a),a.add(e)}(this,_StretchCalculator_brand),calculator_classPrivateFieldInitSpec(this,_hot,void 0),calculator_classPrivateFieldInitSpec(this,_widthsMap,void 0),calculator_classPrivateFieldInitSpec(this,_stretchStrategies,new Map([["all",new StretchAllStrategy(calculator_assertClassBrand(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))],["last",new StretchLastStrategy(calculator_assertClassBrand(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))]])),calculator_classPrivateFieldInitSpec(this,_activeStrategy,"none"),calculator_classPrivateFieldSet(_hot,this,hotInstance),calculator_classPrivateFieldSet(_widthsMap,this,calculator_classPrivateFieldGet(_hot,this).columnIndexMapper.createAndRegisterIndexMap("stretchColumns","physicalIndexToValue"))}useStrategy(strategyName){calculator_classPrivateFieldSet(_activeStrategy,this,calculator_classPrivateFieldGet(_stretchStrategies,this).has(strategyName)?strategyName:"none")}refreshStretching(){"none"!==calculator_classPrivateFieldGet(_activeStrategy,this)?calculator_classPrivateFieldGet(_hot,this).batchExecution((()=>{calculator_classPrivateFieldGet(_widthsMap,this).clear();const stretchStrategy=calculator_classPrivateFieldGet(_stretchStrategies,this).get(calculator_classPrivateFieldGet(_activeStrategy,this));let viewportWidth=calculator_classPrivateFieldGet(_hot,this).view.getViewportWidth();calculator_assertClassBrand(_StretchCalculator_brand,this,_willVerticalScrollAppear).call(this)&&(viewportWidth-=(0,dom_element.XJ)(calculator_classPrivateFieldGet(_hot,this).rootDocument)),stretchStrategy.prepare({viewportWidth});for(let columnIndex=0;columnIndex<calculator_classPrivateFieldGet(_hot,this).countCols();columnIndex++)calculator_classPrivateFieldGet(_hot,this).columnIndexMapper.isHidden(calculator_classPrivateFieldGet(_hot,this).toPhysicalColumn(columnIndex))||stretchStrategy.setColumnBaseWidth(columnIndex,calculator_assertClassBrand(_StretchCalculator_brand,this,_getWidthWithoutStretching).call(this,columnIndex));stretchStrategy.calculate(),stretchStrategy.getWidths().forEach((_ref=>{let[columnIndex,width]=_ref;calculator_classPrivateFieldGet(_widthsMap,this).setValueAtIndex(calculator_classPrivateFieldGet(_hot,this).toPhysicalColumn(columnIndex),width)}))}),!0):calculator_classPrivateFieldGet(_widthsMap,this).clear()}getStretchedWidth(columnVisualIndex){return calculator_classPrivateFieldGet(_widthsMap,this).getValueAtIndex(calculator_classPrivateFieldGet(_hot,this).toPhysicalColumn(columnVisualIndex))}}function _willVerticalScrollAppear(){const{view}=calculator_classPrivateFieldGet(_hot,this);if(view.isVerticallyScrollableByWindow())return!1;const viewportHeight=view.getViewportHeight(),totalRows=calculator_classPrivateFieldGet(_hot,this).countRows(),defaultRowHeight=view.getStylesHandler().getDefaultRowHeight();let totalHeight=0,hasVerticalScroll=!1;for(let row=0;row<totalRows;row++){var _classPrivateFieldGet2;if(totalHeight+=(null!==(_classPrivateFieldGet2=calculator_classPrivateFieldGet(_hot,this).getRowHeight(row))&&void 0!==_classPrivateFieldGet2?_classPrivateFieldGet2:defaultRowHeight)+(0===row?1:0),totalHeight>viewportHeight){hasVerticalScroll=!0;break}}return hasVerticalScroll}function _getWidthWithoutStretching(columnVisualIndex){var _classPrivateFieldGet3;return null!==(_classPrivateFieldGet3=calculator_classPrivateFieldGet(_hot,this).getColWidth(columnVisualIndex,"StretchColumns"))&&void 0!==_classPrivateFieldGet3?_classPrivateFieldGet3:viewportColumns.j}function _overwriteColumnWidthFn(columnWidth,columnVisualIndex){return calculator_classPrivateFieldGet(_hot,this).runHooks("beforeStretchingColumnWidth",columnWidth,columnVisualIndex)}function stretchColumns_classPrivateFieldInitSpec(e,t,a){stretchColumns_checkPrivateRedeclaration(e,t),t.set(e,a)}function stretchColumns_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function stretchColumns_classPrivateFieldSet(s,a,r){return s.set(stretchColumns_assertClassBrand(s,a),r),r}function stretchColumns_classPrivateFieldGet(s,a){return s.get(stretchColumns_assertClassBrand(s,a))}function stretchColumns_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _stretchCalculator=new WeakMap,_previousTableWidth=new WeakMap,stretchColumns_resizeObserver=new WeakMap,_StretchColumns_brand=new WeakSet;class StretchColumns extends BasePlugin{constructor(){super(...arguments),function stretchColumns_classPrivateMethodInitSpec(e,a){stretchColumns_checkPrivateRedeclaration(e,a),a.add(e)}(this,_StretchColumns_brand),stretchColumns_classPrivateFieldInitSpec(this,_stretchCalculator,new StretchCalculator(this.hot)),stretchColumns_classPrivateFieldInitSpec(this,_previousTableWidth,null),stretchColumns_classPrivateFieldInitSpec(this,stretchColumns_resizeObserver,new ResizeObserver((entries=>{requestAnimationFrame((()=>{var _this$hot;null!==(_this$hot=this.hot)&&void 0!==_this$hot&&_this$hot.view.isHorizontallyScrollableByWindow()&&entries.forEach((_ref=>{let{contentRect}=_ref;null!==stretchColumns_classPrivateFieldGet(_previousTableWidth,this)&&stretchColumns_classPrivateFieldGet(_previousTableWidth,this)!==contentRect.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),stretchColumns_classPrivateFieldSet(_previousTableWidth,this,contentRect.width)}))}))})))}static get PLUGIN_KEY(){return"stretchColumns"}static get PLUGIN_PRIORITY(){return 155}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var _this=this;this.enabled||(stretchColumns_classPrivateFieldGet(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),stretchColumns_classPrivateFieldGet(stretchColumns_resizeObserver,this).observe(this.hot.rootElement),this.addHook("beforeRender",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return stretchColumns_assertClassBrand(_StretchColumns_brand,_this,stretchColumns_onBeforeRender).call(_this,...args)})),this.addHook("modifyColWidth",(function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return stretchColumns_assertClassBrand(_StretchColumns_brand,_this,stretchColumns_onModifyColWidth).call(_this,...args)}),10),super.enablePlugin())}updatePlugin(){stretchColumns_classPrivateFieldGet(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),stretchColumns_classPrivateFieldGet(stretchColumns_resizeObserver,this).unobserve(this.hot.rootElement)}getColumnWidth(columnVisualIndex){return stretchColumns_classPrivateFieldGet(_stretchCalculator,this).getStretchedWidth(columnVisualIndex)}destroy(){stretchColumns_classPrivateFieldGet(stretchColumns_resizeObserver,this).disconnect(),stretchColumns_classPrivateFieldSet(stretchColumns_resizeObserver,this,null),stretchColumns_classPrivateFieldSet(_stretchCalculator,this,null),super.destroy()}}function stretchColumns_onModifyColWidth(width,column,source){if(source===this.pluginName)return;const newWidth=this.getColumnWidth(column);return"number"==typeof newWidth?newWidth:width}function stretchColumns_onBeforeRender(fullRender){fullRender&&stretchColumns_classPrivateFieldGet(_stretchCalculator,this).refreshStretching()}function touchScroll_classPrivateMethodInitSpec(e,a){(function touchScroll_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function touchScroll_defineProperty(e,r,t){return(r=function touchScroll_toPropertyKey(t){var i=function touchScroll_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function touchScroll_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _TouchScroll_brand=new WeakSet;class TouchScroll extends BasePlugin{constructor(){super(...arguments),touchScroll_classPrivateMethodInitSpec(this,_TouchScroll_brand),touchScroll_defineProperty(this,"scrollbars",[]),touchScroll_defineProperty(this,"clones",[]),touchScroll_defineProperty(this,"lockedCollection",!1),touchScroll_defineProperty(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return(0,feature.yd)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>touchScroll_assertClassBrand(_TouchScroll_brand,this,_onAfterViewRender).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>touchScroll_assertClassBrand(_TouchScroll_brand,this,_onBeforeTouchScroll).call(this))),this.addHook("afterMomentumScroll",(()=>touchScroll_assertClassBrand(_TouchScroll_brand,this,_onAfterMomentumScroll).call(this)))}}function _onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay,bottomOverlay,inlineStartOverlay,topInlineStartCornerOverlay,bottomInlineStartCornerOverlay}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(topOverlay),bottomOverlay.clone&&this.scrollbars.push(bottomOverlay),this.scrollbars.push(inlineStartOverlay),topInlineStartCornerOverlay&&this.scrollbars.push(topInlineStartCornerOverlay),bottomInlineStartCornerOverlay&&bottomInlineStartCornerOverlay.clone&&this.scrollbars.push(bottomInlineStartCornerOverlay),this.clones=[],topOverlay.needFullRender&&this.clones.push(topOverlay.clone.wtTable.holder.parentNode),bottomOverlay.needFullRender&&this.clones.push(bottomOverlay.clone.wtTable.holder.parentNode),inlineStartOverlay.needFullRender&&this.clones.push(inlineStartOverlay.clone.wtTable.holder.parentNode),topInlineStartCornerOverlay&&this.clones.push(topInlineStartCornerOverlay.clone.wtTable.holder.parentNode),bottomInlineStartCornerOverlay&&bottomInlineStartCornerOverlay.clone&&this.clones.push(bottomInlineStartCornerOverlay.clone.wtTable.holder.parentNode)}function _onBeforeTouchScroll(){this.freezeOverlays=!0,(0,array.z0)(this.clones,(clone=>{(0,dom_element.iQ)(clone,"hide-tween")}))}function _onAfterMomentumScroll(){this.freezeOverlays=!1,(0,array.z0)(this.clones,(clone=>{(0,dom_element.vy)(clone,"hide-tween"),(0,dom_element.iQ)(clone,"show-tween")})),this.hot._registerTimeout((()=>{(0,array.z0)(this.clones,(clone=>{(0,dom_element.vy)(clone,"show-tween")}))}),400),(0,array.z0)(this.scrollbars,(scrollbar=>{scrollbar.refresh(),scrollbar.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function trimRows_classPrivateMethodInitSpec(e,a){(function trimRows_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function trimRows_defineProperty(e,r,t){return(r=function trimRows_toPropertyKey(t){var i=function trimRows_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var _TrimRows_brand=new WeakSet;class TrimRows extends BasePlugin{constructor(){super(...arguments),trimRows_classPrivateMethodInitSpec(this,_TrimRows_brand),trimRows_defineProperty(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return"trimRows"}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings().trimRows}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new trimmingMap.q),this.trimmedRowsMap.addLocalHook("init",(()=>function trimRows_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(_TrimRows_brand,this,trimRows_onMapInit).call(this))),super.enablePlugin())}updatePlugin(){const trimmedRows=this.hot.getSettings().trimRows;Array.isArray(trimmedRows)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),(0,array.z0)(trimmedRows,(physicalRow=>{this.trimmedRowsMap.setValueAtIndex(physicalRow,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(rows){const currentTrimConfig=this.getTrimmedRows(),isValidConfig=this.isValidConfig(rows);let destinationTrimConfig=currentTrimConfig;isValidConfig&&(destinationTrimConfig=Array.from(new Set(currentTrimConfig.concat(rows))));!1!==this.hot.runHooks("beforeTrimRow",currentTrimConfig,destinationTrimConfig,isValidConfig)&&(isValidConfig&&this.hot.batchExecution((()=>{(0,array.z0)(rows,(physicalRow=>{this.trimmedRowsMap.setValueAtIndex(physicalRow,!0)}))}),!0),this.hot.runHooks("afterTrimRow",currentTrimConfig,destinationTrimConfig,isValidConfig,isValidConfig&&destinationTrimConfig.length>currentTrimConfig.length))}trimRow(){for(var _len=arguments.length,row=new Array(_len),_key=0;_key<_len;_key++)row[_key]=arguments[_key];this.trimRows(row)}untrimRows(rows){const currentTrimConfig=this.getTrimmedRows(),isValidConfig=this.isValidConfig(rows);let destinationTrimConfig=currentTrimConfig;const trimmingMapValues=this.trimmedRowsMap.getValues().slice(),isAnyRowUntrimmed=rows.length>0;isValidConfig&&isAnyRowUntrimmed&&((0,array.z0)(rows,(physicalRow=>{trimmingMapValues[physicalRow]=!1})),destinationTrimConfig=(0,array.mu)(trimmingMapValues,((trimmedIndexes,isTrimmed,physicalIndex)=>(isTrimmed&&trimmedIndexes.push(physicalIndex),trimmedIndexes)),[]));!1!==this.hot.runHooks("beforeUntrimRow",currentTrimConfig,destinationTrimConfig,isValidConfig&&isAnyRowUntrimmed)&&(isValidConfig&&isAnyRowUntrimmed&&this.trimmedRowsMap.setValues(trimmingMapValues),this.hot.runHooks("afterUntrimRow",currentTrimConfig,destinationTrimConfig,isValidConfig&&isAnyRowUntrimmed,isValidConfig&&destinationTrimConfig.length<currentTrimConfig.length))}untrimRow(){for(var _len2=arguments.length,row=new Array(_len2),_key2=0;_key2<_len2;_key2++)row[_key2]=arguments[_key2];this.untrimRows(row)}isTrimmed(physicalRow){return this.trimmedRowsMap.getValueAtIndex(physicalRow)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(trimmedRows){const sourceRows=this.hot.countSourceRows();return trimmedRows.every((trimmedRow=>Number.isInteger(trimmedRow)&&trimmedRow>=0&&trimmedRow<sourceRows))}destroy(){super.destroy()}}function trimRows_onMapInit(){const trimmedRows=this.hot.getSettings().trimRows;Array.isArray(trimmedRows)&&this.hot.batchExecution((()=>{(0,array.z0)(trimmedRows,(physicalRow=>{this.trimmedRowsMap.setValueAtIndex(physicalRow,!0)}))}),!0)}function actions_base_defineProperty(e,r,t){return(r=function actions_base_toPropertyKey(t){var i=function actions_base_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class BaseAction{constructor(actionType){actions_base_defineProperty(this,"actionType",""),this.actionType=actionType}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function cellAlignment_defineProperty(e,r,t){return(r=function cellAlignment_toPropertyKey(t){var i=function cellAlignment_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class CellAlignmentAction extends BaseAction{constructor(_ref){let{stateBefore,range,type,alignment}=_ref;super("cell_alignment"),cellAlignment_defineProperty(this,"stateBefore",void 0),cellAlignment_defineProperty(this,"range",void 0),cellAlignment_defineProperty(this,"type",void 0),cellAlignment_defineProperty(this,"alignment",void 0),this.stateBefore=stateBefore,this.range=range,this.type=type,this.alignment=alignment}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeCellAlignment",((stateBefore,range,type,alignment)=>{undoRedoPlugin.done((()=>new CellAlignmentAction({stateBefore,range,type,alignment})))}))}undo(hot,undoneCallback){(0,array.z0)(this.range,(range=>{range.forAll(((row,col)=>{row>=0&&col>=0&&hot.setCellMeta(row,col,"className",this.stateBefore[row][col]||" htLeft")}))})),hot.addHookOnce("afterViewRender",undoneCallback),hot.render()}redo(hot,redoneCallback){align(this.range,this.type,this.alignment,((row,col)=>hot.getCellMeta(row,col)),((row,col,key,value)=>hot.setCellMeta(row,col,key,value))),hot.addHookOnce("afterViewRender",redoneCallback),hot.render()}}function columnMove_defineProperty(e,r,t){return(r=function columnMove_toPropertyKey(t){var i=function columnMove_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ColumnMoveAction extends BaseAction{constructor(_ref){let{columns,finalIndex}=_ref;super("col_move"),columnMove_defineProperty(this,"columns",void 0),columnMove_defineProperty(this,"finalColumnIndex",void 0),this.columns=columns.slice(),this.finalColumnIndex=finalIndex}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeColumnMove",((columns,finalIndex)=>{!1!==columns&&undoRedoPlugin.done((()=>new ColumnMoveAction({columns,finalIndex})))}))}undo(hot,undoneCallback){const manualColumnMove=hot.getPlugin("manualColumnMove");hot.addHookOnce("afterViewRender",undoneCallback);getMoves(this.columns,this.finalColumnIndex,hot.columnIndexMapper.getNumberOfIndexes()).reverse().forEach((_ref2=>{let{from,to}=_ref2;from<to&&(to-=1),manualColumnMove.moveColumn(to,from)})),hot.render(),hot.deselectCell(),hot.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(hot,redoneCallback){const manualColumnMove=hot.getPlugin("manualColumnMove");hot.addHookOnce("afterViewRender",redoneCallback),manualColumnMove.moveColumns(this.columns.slice(),this.finalColumnIndex),hot.render(),hot.deselectCell(),hot.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function columnSort_defineProperty(e,r,t){return(r=function columnSort_toPropertyKey(t){var i=function columnSort_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class ColumnSortAction extends BaseAction{constructor(_ref){let{currentSortState,newSortState}=_ref;super("col_sort"),columnSort_defineProperty(this,"previousSortState",void 0),columnSort_defineProperty(this,"nextSortState",void 0),this.previousSortState=currentSortState,this.nextSortState=newSortState}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeColumnSort",((currentSortState,newSortState,sortPossible)=>{sortPossible&&undoRedoPlugin.done((()=>new ColumnSortAction({currentSortState,newSortState})))}))}undo(hot,undoneCallback){const sortPlugin=hot.getPlugin("columnSorting"),multiSortPlugin=hot.getPlugin("multiColumnSorting"),enabledSortPlugin=multiSortPlugin.isEnabled()?multiSortPlugin:sortPlugin;this.previousSortState.length?enabledSortPlugin.sort(this.previousSortState):enabledSortPlugin.clearSort(),undoneCallback()}redo(hot,redoneCallback){const sortPlugin=hot.getPlugin("columnSorting"),multiSortPlugin=hot.getPlugin("multiColumnSorting");(multiSortPlugin.isEnabled()?multiSortPlugin:sortPlugin).sort(this.nextSortState),redoneCallback()}}function createColumn_defineProperty(e,r,t){return(r=function createColumn_toPropertyKey(t){var i=function createColumn_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class CreateColumnAction extends BaseAction{constructor(_ref){let{index,amount}=_ref;super("insert_col"),createColumn_defineProperty(this,"index",void 0),createColumn_defineProperty(this,"amount",void 0),this.index=index,this.amount=amount}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("afterCreateCol",((index,amount,source)=>{undoRedoPlugin.done((()=>new CreateColumnAction({index,amount})),source)}))}undo(hot,undoneCallback){hot.addHookOnce("afterRemoveCol",undoneCallback),hot.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(hot,redoneCallback){hot.addHookOnce("afterCreateCol",redoneCallback),hot.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function createRow_defineProperty(e,r,t){return(r=function createRow_toPropertyKey(t){var i=function createRow_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class CreateRowAction extends BaseAction{constructor(_ref){let{index,amount}=_ref;super("insert_row"),createRow_defineProperty(this,"index",void 0),createRow_defineProperty(this,"amount",void 0),this.index=index,this.amount=amount}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("afterCreateRow",((index,amount,source)=>{undoRedoPlugin.done((()=>new CreateRowAction({index,amount})),source)}))}undo(hot,undoneCallback){const rowCount=hot.countRows(),minSpareRows=hot.getSettings().minSpareRows;this.index>=rowCount&&this.index-minSpareRows<rowCount&&(this.index-=minSpareRows),hot.addHookOnce("afterRemoveRow",undoneCallback),hot.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(hot,redoneCallback){hot.addHookOnce("afterCreateRow",redoneCallback),hot.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function dataChange_defineProperty(e,r,t){return(r=function dataChange_toPropertyKey(t){var i=function dataChange_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class DataChangeAction extends BaseAction{constructor(_ref){let{changes,selected,countCols,countRows}=_ref;super("change"),dataChange_defineProperty(this,"changes",void 0),dataChange_defineProperty(this,"selected",void 0),dataChange_defineProperty(this,"countCols",void 0),dataChange_defineProperty(this,"countRows",void 0),this.changes=changes,this.selected=selected,this.countCols=countCols,this.countRows=countRows}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeChange",(function(changes,source){const changesLen=changes&&changes.length;if(!changesLen)return;if(!changes.find((change=>{const[,,oldValue,newValue]=change;return oldValue!==newValue})))return;undoRedoPlugin.done((()=>{const clonedChanges=changes.reduce(((arr,change)=>(arr.push([...change]),arr)),[]);clonedChanges.forEach((change=>{change[1]=hot.propToCol(change[1])}));const selected=changesLen>1?this.getSelected():[[clonedChanges[0][0],clonedChanges[0][1]]];return new DataChangeAction({changes:clonedChanges,selected,countCols:hot.countCols(),countRows:hot.countRows()})}),source)}))}undo(hot,undoneCallback){const data=(0,object.Go)(this.changes);for(let i=0,len=data.length;i<len;i++)data[i].splice(3,1);hot.addHookOnce("afterChange",undoneCallback),hot.setDataAtCell(data,null,null,"UndoRedo.undo");const rowsToRemove=hot.countRows()-this.countRows;rowsToRemove>0&&hot.alter("remove_row",null,rowsToRemove,"UndoRedo.undo");const columnsToRemove=hot.countCols()-this.countCols;columnsToRemove>0&&hot.isColumnModificationAllowed()&&hot.alter("remove_col",null,columnsToRemove,"UndoRedo.undo"),hot.scrollToFocusedCell(),hot.selectCells(this.selected,!1,!1)}redo(hot,redoneCallback){const data=(0,object.Go)(this.changes);for(let i=0,len=data.length;i<len;i++)data[i].splice(2,1);hot.addHookOnce("afterChange",redoneCallback),hot.setDataAtCell(data,null,null,"UndoRedo.redo"),this.selected&&hot.selectCells(this.selected,!1,!1)}}function actions_filters_defineProperty(e,r,t){return(r=function actions_filters_toPropertyKey(t){var i=function actions_filters_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class FiltersAction extends BaseAction{constructor(_ref){let{conditionsStack,previousConditionsStack}=_ref;super("filter"),actions_filters_defineProperty(this,"conditionsStack",void 0),actions_filters_defineProperty(this,"previousConditionsStack",void 0),this.conditionsStack=conditionsStack,this.previousConditionsStack=previousConditionsStack}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeFilter",((conditionsStack,previousConditionsStack)=>{undoRedoPlugin.done((()=>new FiltersAction({conditionsStack,previousConditionsStack})))}))}undo(hot,undoneCallback){const filters=hot.getPlugin("filters");hot.addHookOnce("afterViewRender",undoneCallback),filters.importConditions(this.previousConditionsStack),filters.filter()}redo(hot,redoneCallback){const filters=hot.getPlugin("filters");hot.addHookOnce("afterViewRender",redoneCallback),filters.importConditions(this.conditionsStack),filters.filter()}}function actions_mergeCells_defineProperty(e,r,t){return(r=function actions_mergeCells_toPropertyKey(t){var i=function actions_mergeCells_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class MergeCellsAction extends BaseAction{constructor(_ref){let{data,cellRange}=_ref;super("merge_cells"),actions_mergeCells_defineProperty(this,"cellRange",void 0),this.cellRange=cellRange,this.data=data}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeMergeCells",((cellRange,auto)=>{if(auto)return;const topStartCorner=cellRange.getTopStartCorner(),bottomEndCorner=cellRange.getBottomEndCorner(),data=hot.getData(topStartCorner.row,topStartCorner.col,bottomEndCorner.row,bottomEndCorner.col);undoRedoPlugin.done((()=>new MergeCellsAction({data,cellRange})))}))}undo(hot,undoneCallback){const mergeCellsPlugin=hot.getPlugin("mergeCells");hot.addHookOnce("afterViewRender",undoneCallback),mergeCellsPlugin.unmergeRange(this.cellRange,!0);const topStartCorner=this.cellRange.getTopStartCorner();hot.populateFromArray(topStartCorner.row,topStartCorner.col,this.data,void 0,void 0,"MergeCells")}redo(hot,redoneCallback){const mergeCellsPlugin=hot.getPlugin("mergeCells");hot.addHookOnce("afterViewRender",redoneCallback),mergeCellsPlugin.mergeRange(this.cellRange)}}__webpack_require__("./node_modules/core-js/modules/es.object.from-entries.js");function getCellMetas(hot,fromRow,toRow,fromColumn,toColumn){const genericKeys=["visualRow","visualCol","row","col","prop"],genericKeysLength=genericKeys.length,cellMetas=[];return(0,number.Ti)(fromColumn,toColumn,(columnIndex=>{(0,number.Ti)(fromRow,toRow,(rowIndex=>{const cellMeta=hot.getCellMeta(rowIndex,columnIndex);if(Object.keys(cellMeta).length!==genericKeysLength){const uniqueMeta=Object.fromEntries(Object.entries(cellMeta).filter((_ref=>{let[key]=_ref;return!1===genericKeys.includes(key)})));cellMetas.push([cellMeta.visualRow,cellMeta.visualCol,uniqueMeta])}}))})),cellMetas}function removeColumn_defineProperty(e,r,t){return(r=function removeColumn_toPropertyKey(t){var i=function removeColumn_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RemoveColumnAction extends BaseAction{constructor(_ref){let{index,indexes,data,amount,headers,columnPositions,rowPositions,fixedColumnsStart,removedCellMetas}=_ref;super("remove_col"),removeColumn_defineProperty(this,"index",void 0),removeColumn_defineProperty(this,"indexes",void 0),removeColumn_defineProperty(this,"data",void 0),removeColumn_defineProperty(this,"amount",void 0),removeColumn_defineProperty(this,"headers",void 0),removeColumn_defineProperty(this,"columnPositions",void 0),removeColumn_defineProperty(this,"rowPositions",void 0),removeColumn_defineProperty(this,"fixedColumnsStart",void 0),removeColumn_defineProperty(this,"removedCellMetas",void 0),this.index=index,this.indexes=indexes,this.data=data,this.amount=amount,this.headers=headers,this.columnPositions=columnPositions.slice(0),this.rowPositions=rowPositions.slice(0),this.fixedColumnsStart=fixedColumnsStart,this.removedCellMetas=removedCellMetas}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeRemoveCol",((index,amount,logicColumns,source)=>{undoRedoPlugin.done((()=>{const originalData=hot.getSourceDataArray(),columnIndex=(hot.countCols()+index)%hot.countCols(),lastColumnIndex=columnIndex+amount-1,removedData=[],headers=[],indexes=[];(0,number.Ti)(originalData.length-1,(i=>{const column=[],origRow=originalData[i];(0,number.Ti)(columnIndex,lastColumnIndex,(j=>{column.push(origRow[hot.toPhysicalColumn(j)])})),removedData.push(column)})),(0,number.Ti)(amount-1,(i=>{indexes.push(hot.toPhysicalColumn(columnIndex+i))})),Array.isArray(hot.getSettings().colHeaders)&&(0,number.Ti)(amount-1,(i=>{headers.push(hot.getSettings().colHeaders[hot.toPhysicalColumn(columnIndex+i)]||null)}));const columnsMap=hot.columnIndexMapper.getIndexesSequence(),rowsMap=hot.rowIndexMapper.getIndexesSequence();return new RemoveColumnAction({index:columnIndex,indexes,data:removedData,amount,headers,columnPositions:columnsMap,rowPositions:rowsMap,fixedColumnsStart:hot.getSettings().fixedColumnsStart,removedCellMetas:getCellMetas(hot,0,hot.countRows(),columnIndex,lastColumnIndex)})}),source)}))}undo(hot,undoneCallback){hot.getSettings().fixedColumnsStart=this.fixedColumnsStart;const ascendingIndexes=this.indexes.slice(0).sort(),sortByIndexes=(elem,j,arr)=>arr[this.indexes.indexOf(ascendingIndexes[j])],removedDataLength=this.data.length,sortedData=[];for(let rowIndex=0;rowIndex<removedDataLength;rowIndex++)sortedData.push((0,array.YD)(this.data[rowIndex],sortByIndexes));const sortedHeaders=(0,array.YD)(this.headers,sortByIndexes),changes=[];hot.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),(0,array.z0)(hot.getSourceDataArray(),((rowData,rowIndex)=>{(0,array.z0)(ascendingIndexes,((changedIndex,contiquesIndex)=>{rowData[changedIndex]=sortedData[rowIndex][contiquesIndex],changes.push([rowIndex,changedIndex,rowData[changedIndex]])}))})),hot.setSourceDataAtCell(changes,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&(0,array.z0)(sortedHeaders,((headerData,columnIndex)=>{hot.getSettings().colHeaders[ascendingIndexes[columnIndex]]=headerData})),this.removedCellMetas.forEach((_ref2=>{let[rowIndex,columnIndex,cellMeta]=_ref2;hot.setCellMetaObject(rowIndex,columnIndex,cellMeta)})),hot.batchExecution((()=>{hot.rowIndexMapper.setIndexesSequence(this.rowPositions),hot.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),hot.addHookOnce("afterViewRender",undoneCallback),hot.render()}redo(hot,redoneCallback){hot.addHookOnce("afterRemoveCol",redoneCallback),hot.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function removeRow_defineProperty(e,r,t){return(r=function removeRow_toPropertyKey(t){var i=function removeRow_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RemoveRowAction extends BaseAction{constructor(_ref){let{index,data,fixedRowsBottom,fixedRowsTop,rowIndexesSequence,removedCellMetas}=_ref;super("remove_row"),removeRow_defineProperty(this,"index",void 0),removeRow_defineProperty(this,"data",void 0),removeRow_defineProperty(this,"fixedRowsBottom",void 0),removeRow_defineProperty(this,"fixedRowsTop",void 0),removeRow_defineProperty(this,"rowIndexesSequence",void 0),removeRow_defineProperty(this,"removedCellMetas",void 0),this.index=index,this.data=data,this.fixedRowsBottom=fixedRowsBottom,this.fixedRowsTop=fixedRowsTop,this.rowIndexesSequence=rowIndexesSequence,this.removedCellMetas=removedCellMetas}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeRemoveRow",((index,amount,logicRows,source)=>{undoRedoPlugin.done((()=>{const physicalRowIndex=hot.toPhysicalRow(index),lastRowIndex=physicalRowIndex+amount-1,removedData=(0,object.Go)(hot.getSourceData(physicalRowIndex,0,physicalRowIndex+amount-1,hot.countSourceCols()-1));return new RemoveRowAction({index:physicalRowIndex,data:removedData,fixedRowsBottom:hot.getSettings().fixedRowsBottom,fixedRowsTop:hot.getSettings().fixedRowsTop,rowIndexesSequence:hot.rowIndexMapper.getIndexesSequence(),removedCellMetas:getCellMetas(hot,physicalRowIndex,lastRowIndex,0,hot.countCols()-1)})}),source)}))}undo(hot,undoneCallback){const settings=hot.getSettings(),changes=[];settings.fixedRowsBottom=this.fixedRowsBottom,settings.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((dataRow,rowIndexDelta)=>{Object.keys(dataRow).forEach((columnProp=>{const columnIndex=parseInt(columnProp,10);changes.push([this.index+rowIndexDelta,isNaN(columnIndex)?columnProp:columnIndex,dataRow[columnProp]])}))})),hot.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((_ref2=>{let[rowIndex,columnIndex,cellMeta]=_ref2;hot.setCellMetaObject(rowIndex,columnIndex,cellMeta)})),hot.addHookOnce("afterViewRender",undoneCallback),hot.setSourceDataAtCell(changes,null,null,"UndoRedo.undo"),hot.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)}redo(hot,redoneCallback){hot.addHookOnce("afterRemoveRow",redoneCallback),hot.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")}}function rowMove_defineProperty(e,r,t){return(r=function rowMove_toPropertyKey(t){var i=function rowMove_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class RowMoveAction extends BaseAction{constructor(_ref){let{rows,finalIndex}=_ref;super("row_move"),rowMove_defineProperty(this,"rows",void 0),rowMove_defineProperty(this,"finalRowIndex",void 0),this.rows=rows.slice(),this.finalRowIndex=finalIndex}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("beforeRowMove",((rows,finalIndex)=>{!1!==rows&&undoRedoPlugin.done((()=>new RowMoveAction({rows,finalIndex})))}))}undo(hot,undoneCallback){const manualRowMove=hot.getPlugin("manualRowMove");hot.addHookOnce("afterViewRender",undoneCallback);getMoves(this.rows,this.finalRowIndex,hot.rowIndexMapper.getNumberOfIndexes()).reverse().forEach((_ref2=>{let{from,to}=_ref2;from<to&&(to-=1),manualRowMove.moveRow(to,from)})),hot.render(),hot.deselectCell(),hot.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(hot,redoneCallback){const manualRowMove=hot.getPlugin("manualRowMove");hot.addHookOnce("afterViewRender",redoneCallback),manualRowMove.moveRows(this.rows.slice(),this.finalRowIndex),hot.render(),hot.deselectCell(),hot.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function unmergeCells_defineProperty(e,r,t){return(r=function unmergeCells_toPropertyKey(t){var i=function unmergeCells_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class UnmergeCellsAction extends BaseAction{constructor(_ref){let{cellRange}=_ref;super("unmerge_cells"),unmergeCells_defineProperty(this,"cellRange",void 0),this.cellRange=cellRange}static startRegisteringEvents(hot,undoRedoPlugin){hot.addHook("afterUnmergeCells",((cellRange,auto)=>{auto||undoRedoPlugin.done((()=>new UnmergeCellsAction({cellRange})))}))}undo(hot,undoneCallback){const mergeCellsPlugin=hot.getPlugin("mergeCells");hot.addHookOnce("afterViewRender",undoneCallback),mergeCellsPlugin.mergeRange(this.cellRange,!0)}redo(hot,redoneCallback){const mergeCellsPlugin=hot.getPlugin("mergeCells");hot.addHookOnce("afterViewRender",redoneCallback),mergeCellsPlugin.unmergeRange(this.cellRange,!0),hot.render()}}function undoRedo_classPrivateMethodInitSpec(e,a){(function undoRedo_checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,a),a.add(e)}function undoRedo_defineProperty(e,r,t){return(r=function undoRedo_toPropertyKey(t){var i=function undoRedo_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function undoRedo_assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}hooks.R.getSingleton().register("beforeUndo"),hooks.R.getSingleton().register("afterUndo"),hooks.R.getSingleton().register("beforeRedo"),hooks.R.getSingleton().register("afterRedo");const deprecationWarns=new Set;var _UndoRedo_brand=new WeakSet;class UndoRedo extends BasePlugin{static get PLUGIN_KEY(){return"undoRedo"}static get PLUGIN_PRIORITY(){return 1e3}static get SETTING_KEYS(){return!0}constructor(hotInstance){super(hotInstance),undoRedo_classPrivateMethodInitSpec(this,_UndoRedo_brand),undoRedo_defineProperty(this,"doneActions",[]),undoRedo_defineProperty(this,"undoneActions",[]),undoRedo_defineProperty(this,"ignoreNewActions",!1),function registerActions(hot,undoRedoPlugin){[CellAlignmentAction,ColumnMoveAction,ColumnSortAction,CreateColumnAction,CreateRowAction,DataChangeAction,FiltersAction,MergeCellsAction,RemoveColumnAction,RemoveRowAction,RowMoveAction,UnmergeCellsAction].forEach((action=>action.startRegisteringEvents(hot,undoRedoPlugin)))}(hotInstance,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var _this=this;this.enabled||(this.addHook("afterChange",(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return undoRedo_assertClassBrand(_UndoRedo_brand,_this,undoRedo_onAfterChange).call(_this,...args)})),this.registerShortcuts(),undoRedo_assertClassBrand(_UndoRedo_brand,this,_exposeAPIToCore).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),undoRedo_assertClassBrand(_UndoRedo_brand,this,_removeAPIFromCore).call(this)}registerShortcuts(){const config={runOnlyIf:event=>!event.altKey,group:"undoRedo"};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],config)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("undoRedo")}done(wrappedAction,source){if(this.ignoreNewActions)return;if("UndoRedo.undo"===source||"UndoRedo.redo"===source||"auto"===source)return;const doneActionsCopy=this.doneActions.slice();if(!1===this.hot.runHooks("beforeUndoStackChange",doneActionsCopy,source))return;const newAction=wrappedAction(),undoneActionsCopy=this.undoneActions.slice();this.doneActions.push(newAction),this.hot.runHooks("afterUndoStackChange",doneActionsCopy,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",undoneActionsCopy),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",undoneActionsCopy,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const doneActionsCopy=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",doneActionsCopy);const action=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",doneActionsCopy,this.doneActions.slice());const actionClone=(0,object.Go)(action);if(!1===this.hot.runHooks("beforeUndo",actionClone))return;this.ignoreNewActions=!0;const undoneActionsCopy=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",undoneActionsCopy),action.undo(this.hot,(()=>{this.ignoreNewActions=!1,this.undoneActions.push(action)})),this.hot.runHooks("afterRedoStackChange",undoneActionsCopy,this.undoneActions.slice()),this.hot.runHooks("afterUndo",actionClone)}redo(){if(!this.isRedoAvailable())return;const undoneActionsCopy=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",undoneActionsCopy);const action=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",undoneActionsCopy,this.undoneActions.slice());const actionClone=(0,object.Go)(action);if(!1===this.hot.runHooks("beforeRedo",actionClone))return;this.ignoreNewActions=!0;const doneActionsCopy=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",doneActionsCopy),action.redo(this.hot,(()=>{this.ignoreNewActions=!1,this.doneActions.push(action)})),this.hot.runHooks("afterUndoStackChange",doneActionsCopy,this.doneActions.slice()),this.hot.runHooks("afterRedo",actionClone)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function undoRedo_onAfterChange(changes,source){"loadData"===source&&this.clear()}function _exposeAPIToCore(){const deprecatedWarn=methodName=>{deprecationWarns.has(methodName)||((0,helpers_console.R8)(templateLiteralTag.O`The "${methodName}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${methodName}()\`).`),deprecationWarns.add(methodName))};this.hot.undo=()=>{deprecatedWarn("undo"),this.undo()},this.hot.redo=()=>{deprecatedWarn("redo"),this.redo()},this.hot.isUndoAvailable=()=>(deprecatedWarn("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(deprecatedWarn("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{deprecatedWarn("clear"),this.clear()},this.hot.undoRedo=this}function _removeAPIFromCore(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function registerAllModules(){!function registerAllEditors(){(0,registry.VA)(baseEditor.b7),(0,registry.VA)(AutocompleteEditor),(0,registry.VA)(CheckboxEditor),(0,registry.VA)(DateEditor),(0,registry.VA)(DropdownEditor),(0,registry.VA)(HandsontableEditor),(0,registry.VA)(NumericEditor),(0,registry.VA)(PasswordEditor),(0,registry.VA)(SelectEditor),(0,registry.VA)(textEditor.t),(0,registry.VA)(TimeEditor)}(),function registerAllRenderers(){(0,renderers_registry.TS)(autocompleteRenderer),(0,renderers_registry.TS)(baseRenderer.j),(0,renderers_registry.TS)(checkboxRenderer),(0,renderers_registry.TS)(dropdownRenderer),(0,renderers_registry.TS)(handsontableRenderer),(0,renderers_registry.TS)(htmlRenderer),(0,renderers_registry.TS)(numericRenderer),(0,renderers_registry.TS)(passwordRenderer),(0,renderers_registry.TS)(selectRenderer),(0,renderers_registry.TS)(textRenderer.F),(0,renderers_registry.TS)(timeRenderer)}(),function registerAllValidators(){(0,validators_registry.qV)(autocompleteValidator),(0,validators_registry.qV)(dropdownValidator),(0,validators_registry.qV)(dateValidator),(0,validators_registry.qV)(numericValidator),(0,validators_registry.qV)(timeValidator)}(),function registerAllCellTypes(){(0,cellTypes_registry.Gk)(AutocompleteCellType),(0,cellTypes_registry.Gk)(CheckboxCellType),(0,cellTypes_registry.Gk)(DateCellType),(0,cellTypes_registry.Gk)(DropdownCellType),(0,cellTypes_registry.Gk)(HandsontableCellType),(0,cellTypes_registry.Gk)(NumericCellType),(0,cellTypes_registry.Gk)(PasswordCellType),(0,cellTypes_registry.Gk)(SelectCellType),(0,cellTypes_registry.Gk)(textType.Y),(0,cellTypes_registry.Gk)(TimeCellType)}(),function registerAllPlugins(){(0,plugins_registry.F3)(AutoColumnSize),(0,plugins_registry.F3)(Autofill),(0,plugins_registry.F3)(AutoRowSize),(0,plugins_registry.F3)(BindRowsWithHeaders),(0,plugins_registry.F3)(CollapsibleColumns),(0,plugins_registry.F3)(ColumnSorting),(0,plugins_registry.F3)(ColumnSummary),(0,plugins_registry.F3)(Comments),(0,plugins_registry.F3)(ContextMenu),(0,plugins_registry.F3)(CopyPaste),(0,plugins_registry.F3)(CustomBorders),(0,plugins_registry.F3)(DragToScroll),(0,plugins_registry.F3)(DropdownMenu),(0,plugins_registry.F3)(ExportFile),(0,plugins_registry.F3)(Filters),(0,plugins_registry.F3)(Formulas),(0,plugins_registry.F3)(HiddenColumns),(0,plugins_registry.F3)(HiddenRows),(0,plugins_registry.F3)(ManualColumnFreeze),(0,plugins_registry.F3)(ManualColumnMove),(0,plugins_registry.F3)(ManualColumnResize),(0,plugins_registry.F3)(ManualRowMove),(0,plugins_registry.F3)(ManualRowResize),(0,plugins_registry.F3)(MergeCells),(0,plugins_registry.F3)(MultiColumnSorting),(0,plugins_registry.F3)(MultipleSelectionHandles),(0,plugins_registry.F3)(NestedHeaders),(0,plugins_registry.F3)(NestedRows),(0,plugins_registry.F3)(PersistentState),(0,plugins_registry.F3)(Search),(0,plugins_registry.F3)(StretchColumns),(0,plugins_registry.F3)(TouchScroll),(0,plugins_registry.F3)(TrimRows),(0,plugins_registry.F3)(UndoRedo)}()}},"./node_modules/handsontable/renderers/baseRenderer/baseRenderer.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{j:()=>baseRenderer});__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _helpers_dom_element_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/helpers/dom/element.mjs"),_helpers_a11y_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/a11y.mjs");function baseRenderer(hotInstance,TD,row,col,prop,value,cellProperties){const ariaEnabled=cellProperties.ariaTags,classesToAdd=[],classesToRemove=[],attributesToRemove=[],attributesToAdd=[];cellProperties.className&&(0,_helpers_dom_element_mjs__WEBPACK_IMPORTED_MODULE_1__.iQ)(TD,cellProperties.className),cellProperties.readOnly?(classesToAdd.push(cellProperties.readOnlyCellClassName),ariaEnabled&&attributesToAdd.push((0,_helpers_a11y_mjs__WEBPACK_IMPORTED_MODULE_2__.u8)())):ariaEnabled&&attributesToRemove.push((0,_helpers_a11y_mjs__WEBPACK_IMPORTED_MODULE_2__.u8)()[0]),!1===cellProperties.valid&&cellProperties.invalidCellClassName?(classesToAdd.push(cellProperties.invalidCellClassName),ariaEnabled&&attributesToAdd.push((0,_helpers_a11y_mjs__WEBPACK_IMPORTED_MODULE_2__.PF)())):(classesToRemove.push(cellProperties.invalidCellClassName),ariaEnabled&&attributesToRemove.push((0,_helpers_a11y_mjs__WEBPACK_IMPORTED_MODULE_2__.PF)()[0])),!1===cellProperties.wordWrap&&cellProperties.noWordWrapClassName&&classesToAdd.push(cellProperties.noWordWrapClassName),!value&&cellProperties.placeholder&&classesToAdd.push(cellProperties.placeholderCellClassName),(0,_helpers_dom_element_mjs__WEBPACK_IMPORTED_MODULE_1__.vy)(TD,classesToRemove),(0,_helpers_dom_element_mjs__WEBPACK_IMPORTED_MODULE_1__.iQ)(TD,classesToAdd),(0,_helpers_dom_element_mjs__WEBPACK_IMPORTED_MODULE_1__.De)(TD,attributesToRemove),(0,_helpers_dom_element_mjs__WEBPACK_IMPORTED_MODULE_1__.Bq)(TD,attributesToAdd)}baseRenderer.RENDERER_TYPE="base"},"./node_modules/handsontable/renderers/registry.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{TS:()=>_register,gB:()=>_getItem,sl:()=>hasItem});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js");var _utils_staticRegister_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/utils/staticRegister.mjs");const{register,getItem,hasItem,getNames,getValues}=(0,_utils_staticRegister_mjs__WEBPACK_IMPORTED_MODULE_1__.A)("renderers");function _getItem(name){if("function"==typeof name)return name;if(!hasItem(name))throw Error(`No registered renderer found under "${name}" name`);return getItem(name)}function _register(name,renderer){"string"!=typeof name&&(name=(renderer=name).RENDERER_TYPE),register(name,renderer)}},"./node_modules/handsontable/renderers/textRenderer/textRenderer.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F:()=>textRenderer});var _baseRenderer_index_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/renderers/baseRenderer/baseRenderer.mjs"),_helpers_dom_element_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/dom/element.mjs"),_helpers_mixed_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs");function textRenderer(hotInstance,TD,row,col,prop,value,cellProperties){_baseRenderer_index_mjs__WEBPACK_IMPORTED_MODULE_0__.j.apply(this,[hotInstance,TD,row,col,prop,value,cellProperties]);let escaped=value;!escaped&&cellProperties.placeholder&&(escaped=cellProperties.placeholder),escaped=(0,_helpers_mixed_mjs__WEBPACK_IMPORTED_MODULE_1__.As)(escaped),cellProperties.trimWhitespace&&(escaped=escaped.trim()),(0,_helpers_dom_element_mjs__WEBPACK_IMPORTED_MODULE_2__.c6)(TD,escaped)}textRenderer.RENDERER_TYPE="text"},"./node_modules/handsontable/selection/utils.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ML:()=>detectSelectionType,NB:()=>transformSelectionToColumnDistance,Qz:()=>SELECTION_TYPE_EMPTY,_e:()=>normalizeSelectionFactory,ay:()=>SELECTION_TYPE_UNRECOGNIZED,f7:()=>transformSelectionToRowDistance});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/es.set.difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.intersection.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-subset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.is-superset-of.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.symmetric-difference.v2.js"),__webpack_require__("./node_modules/core-js/modules/es.set.union.v2.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.some.js");var _3rdparty_walkontable_src_index_mjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/handsontable/3rdparty/walkontable/src/cell/range.mjs"),_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs"),_helpers_mixed_mjs__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs");const SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(selectionRanges){let _callSymbol=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rootCall;if(_callSymbol!==rootCall&&_callSymbol!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");const isArray=Array.isArray(selectionRanges),isRootCall=_callSymbol===rootCall;let result=SELECTION_TYPE_UNRECOGNIZED;if(isArray){const firstItem=selectionRanges[0];if(0===selectionRanges.length)result=SELECTION_TYPE_EMPTY;else if(isRootCall&&firstItem instanceof _3rdparty_walkontable_src_index_mjs__WEBPACK_IMPORTED_MODULE_11__.A)result=SELECTION_TYPE_OBJECT;else if(isRootCall&&Array.isArray(firstItem))result=detectSelectionType(firstItem,childCall);else if(selectionRanges.length>=2&&selectionRanges.length<=4){!selectionRanges.some(((value,index)=>!ARRAY_TYPE_PATTERN[index].includes(typeof value)))&&(result=SELECTION_TYPE_ARRAY)}}return result}function normalizeSelectionFactory(type){let{createCellCoords,createCellRange,keepDirection=!1,propToCol}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!SELECTION_TYPES.includes(type))throw new Error("Unsupported selection ranges schema type was provided.");return function(selection){const isObjectType=type===SELECTION_TYPE_OBJECT;let rowStart=isObjectType?selection.from.row:selection[0],columnStart=isObjectType?selection.from.col:selection[1],rowEnd=isObjectType?selection.to.row:selection[2],columnEnd=isObjectType?selection.to.col:selection[3];if("function"==typeof propToCol&&("string"==typeof columnStart&&(columnStart=propToCol(columnStart)),"string"==typeof columnEnd&&(columnEnd=propToCol(columnEnd))),(0,_helpers_mixed_mjs__WEBPACK_IMPORTED_MODULE_12__.b0)(rowEnd)&&(rowEnd=rowStart),(0,_helpers_mixed_mjs__WEBPACK_IMPORTED_MODULE_12__.b0)(columnEnd)&&(columnEnd=columnStart),!keepDirection){const origRowStart=rowStart,origColumnStart=columnStart,origRowEnd=rowEnd,origColumnEnd=columnEnd;rowStart=Math.min(origRowStart,origRowEnd),columnStart=Math.min(origColumnStart,origColumnEnd),rowEnd=Math.max(origRowStart,origRowEnd),columnEnd=Math.max(origColumnStart,origColumnEnd)}const from=createCellCoords(rowStart,columnStart),to=createCellCoords(rowEnd,columnEnd);return createCellRange(from,from,to)}}function transformSelectionToColumnDistance(hotInstance){const selectionType=detectSelectionType(hotInstance.getSelected());if(selectionType===SELECTION_TYPE_UNRECOGNIZED||selectionType===SELECTION_TYPE_EMPTY)return[];const selectionSchemaNormalizer=normalizeSelectionFactory(selectionType,{createCellCoords:hotInstance._createCellCoords.bind(hotInstance),createCellRange:hotInstance._createCellRange.bind(hotInstance)}),unorderedIndexes=new Set;(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_13__.z0)(hotInstance.getSelected(),(selection=>{const{from,to}=selectionSchemaNormalizer(selection),columnNonHeaderStart=Math.max(from.col,0),amount=to.col-columnNonHeaderStart+1;(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_13__.z0)(Array.from(new Array(amount),((_,i)=>columnNonHeaderStart+i)),(index=>{unorderedIndexes.has(index)||unorderedIndexes.add(index)}))}));const orderedIndexes=Array.from(unorderedIndexes).sort(((a,b)=>a-b));return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_13__.mu)(orderedIndexes,((acc,visualColumnIndex,index,array)=>(0!==index&&visualColumnIndex===array[index-1]+1?acc[acc.length-1][1]+=1:acc.push([visualColumnIndex,1]),acc)),[])}function transformSelectionToRowDistance(hotInstance){const selectionType=detectSelectionType(hotInstance.getSelected());if(selectionType===SELECTION_TYPE_UNRECOGNIZED||selectionType===SELECTION_TYPE_EMPTY)return[];const selectionSchemaNormalizer=normalizeSelectionFactory(selectionType,{createCellCoords:hotInstance._createCellCoords.bind(hotInstance),createCellRange:hotInstance._createCellRange.bind(hotInstance)}),unorderedIndexes=new Set;(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_13__.z0)(hotInstance.getSelected(),(selection=>{const{from,to}=selectionSchemaNormalizer(selection),rowNonHeaderStart=Math.max(from.row,0),amount=to.row-rowNonHeaderStart+1;(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_13__.z0)(Array.from(new Array(amount),((_,i)=>rowNonHeaderStart+i)),(index=>{unorderedIndexes.has(index)||unorderedIndexes.add(index)}))}));const orderedIndexes=Array.from(unorderedIndexes).sort(((a,b)=>a-b));return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_13__.mu)(orderedIndexes,((acc,rowIndex,index,array)=>(0!==index&&rowIndex===array[index-1]+1?acc[acc.length-1][1]+=1:acc.push([rowIndex,1]),acc)),[])}},"./node_modules/handsontable/shortcutContexts/constants.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{B:()=>GRID_GROUP,b:()=>EDITOR_EDIT_GROUP});const GRID_GROUP="gridDefault",EDITOR_EDIT_GROUP="editorManager.handlingEditor"},"./node_modules/handsontable/translations/maps/hidingMap.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{o:()=>HidingMap});__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _physicalIndexToValueMap_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/translations/maps/physicalIndexToValueMap.mjs"),_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs");class HidingMap extends _physicalIndexToValueMap_mjs__WEBPACK_IMPORTED_MODULE_1__._{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_2__.mu)(this.getValues(),((indexesList,isHidden,physicalIndex)=>(isHidden&&indexesList.push(physicalIndex),indexesList)),[])}}},"./node_modules/handsontable/translations/maps/indexMap.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>IndexMap});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _helpers_number_mjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/handsontable/helpers/number.mjs"),_helpers_object_mjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/handsontable/helpers/object.mjs"),_helpers_function_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/function.mjs"),_mixins_localHooks_mjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/handsontable/mixins/localHooks.mjs");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class IndexMap{constructor(){let initValueOrFn=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_defineProperty(this,"indexedValues",[]),_defineProperty(this,"initValueOrFn",void 0),this.initValueOrFn=initValueOrFn}getValues(){return this.indexedValues}getValueAtIndex(index){const values=this.indexedValues;if(index<values.length)return values[index]}setValues(values){this.indexedValues=values.slice(),this.runLocalHooks("change")}setValueAtIndex(index,value){return index<this.indexedValues.length&&(this.indexedValues[index]=value,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let length=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,_helpers_function_mjs__WEBPACK_IMPORTED_MODULE_2__.Tn)(this.initValueOrFn)?(0,_helpers_number_mjs__WEBPACK_IMPORTED_MODULE_3__.Ti)(length-1,(index=>this.indexedValues.push(this.initValueOrFn(index)))):(0,_helpers_number_mjs__WEBPACK_IMPORTED_MODULE_3__.Ti)(length-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(length){return this.setDefaultValues(length),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}(0,_helpers_object_mjs__WEBPACK_IMPORTED_MODULE_4__.co)(IndexMap,_mixins_localHooks_mjs__WEBPACK_IMPORTED_MODULE_5__.A)},"./node_modules/handsontable/translations/maps/indexesSequence.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{K:()=>IndexesSequence});var _indexMap_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/translations/maps/indexMap.mjs"),_utils_indexesSequence_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/translations/maps/utils/indexesSequence.mjs"),_utils_index_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/translations/maps/utils/actionsOnIndexes.mjs");class IndexesSequence extends _indexMap_mjs__WEBPACK_IMPORTED_MODULE_0__.n{constructor(){super((index=>index))}insert(insertionIndex,insertedIndexes){const listAfterUpdate=(0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_1__.z)(this.indexedValues,insertedIndexes);this.indexedValues=(0,_utils_indexesSequence_mjs__WEBPACK_IMPORTED_MODULE_2__.N)(listAfterUpdate,insertionIndex,insertedIndexes),super.insert(insertionIndex,insertedIndexes)}remove(removedIndexes){const listAfterUpdate=(0,_utils_indexesSequence_mjs__WEBPACK_IMPORTED_MODULE_2__.H)(this.indexedValues,removedIndexes);this.indexedValues=(0,_utils_index_mjs__WEBPACK_IMPORTED_MODULE_1__.v)(listAfterUpdate,removedIndexes),super.remove(removedIndexes)}}},"./node_modules/handsontable/translations/maps/linkedPhysicalIndexToValueMap.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{z:()=>LinkedPhysicalIndexToValueMap});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var _indexMap_mjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/handsontable/translations/maps/indexMap.mjs"),_utils_physicallyIndexed_mjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/handsontable/translations/maps/utils/physicallyIndexed.mjs"),_utils_indexesSequence_mjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/handsontable/translations/maps/utils/indexesSequence.mjs"),_utils_actionsOnIndexes_mjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/handsontable/translations/maps/utils/actionsOnIndexes.mjs"),_helpers_function_mjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/handsontable/helpers/function.mjs");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class LinkedPhysicalIndexToValueMap extends _indexMap_mjs__WEBPACK_IMPORTED_MODULE_3__.n{constructor(){super(...arguments),_defineProperty(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((physicalIndex=>this.indexedValues[physicalIndex]))}setValues(values){this.orderOfIndexes=[...Array(values.length).keys()],super.setValues(values)}setValueAtIndex(index,value){let position=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return index<this.indexedValues.length&&(this.indexedValues[index]=value,!1===this.orderOfIndexes.includes(index)&&this.orderOfIndexes.splice(position,0,index),this.runLocalHooks("change"),!0)}clearValue(physicalIndex){this.orderOfIndexes=(0,_utils_indexesSequence_mjs__WEBPACK_IMPORTED_MODULE_4__.H)(this.orderOfIndexes,[physicalIndex]),(0,_helpers_function_mjs__WEBPACK_IMPORTED_MODULE_5__.Tn)(this.initValueOrFn)?super.setValueAtIndex(physicalIndex,this.initValueOrFn(physicalIndex)):super.setValueAtIndex(physicalIndex,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let length=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(length)}insert(insertionIndex,insertedIndexes){this.indexedValues=(0,_utils_physicallyIndexed_mjs__WEBPACK_IMPORTED_MODULE_6__.N)(this.indexedValues,insertionIndex,insertedIndexes,this.initValueOrFn),this.orderOfIndexes=(0,_utils_actionsOnIndexes_mjs__WEBPACK_IMPORTED_MODULE_7__.z)(this.orderOfIndexes,insertedIndexes),super.insert(insertionIndex,insertedIndexes)}remove(removedIndexes){this.indexedValues=(0,_utils_physicallyIndexed_mjs__WEBPACK_IMPORTED_MODULE_6__.H)(this.indexedValues,removedIndexes),this.orderOfIndexes=(0,_utils_indexesSequence_mjs__WEBPACK_IMPORTED_MODULE_4__.H)(this.orderOfIndexes,removedIndexes),this.orderOfIndexes=(0,_utils_actionsOnIndexes_mjs__WEBPACK_IMPORTED_MODULE_7__.v)(this.orderOfIndexes,removedIndexes),super.remove(removedIndexes)}getEntries(){return this.orderOfIndexes.map((physicalIndex=>[physicalIndex,this.getValueAtIndex(physicalIndex)]))}}},"./node_modules/handsontable/translations/maps/physicalIndexToValueMap.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_:()=>PhysicalIndexToValueMap});var _indexMap_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/translations/maps/indexMap.mjs"),_utils_physicallyIndexed_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/translations/maps/utils/physicallyIndexed.mjs");class PhysicalIndexToValueMap extends _indexMap_mjs__WEBPACK_IMPORTED_MODULE_0__.n{insert(insertionIndex,insertedIndexes){this.indexedValues=(0,_utils_physicallyIndexed_mjs__WEBPACK_IMPORTED_MODULE_1__.N)(this.indexedValues,insertionIndex,insertedIndexes,this.initValueOrFn),super.insert(insertionIndex,insertedIndexes)}remove(removedIndexes){this.indexedValues=(0,_utils_physicallyIndexed_mjs__WEBPACK_IMPORTED_MODULE_1__.H)(this.indexedValues,removedIndexes),super.remove(removedIndexes)}}},"./node_modules/handsontable/translations/maps/trimmingMap.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>TrimmingMap});__webpack_require__("./node_modules/core-js/modules/es.array.push.js");var _physicalIndexToValueMap_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/translations/maps/physicalIndexToValueMap.mjs"),_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs");class TrimmingMap extends _physicalIndexToValueMap_mjs__WEBPACK_IMPORTED_MODULE_1__._{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_2__.mu)(this.getValues(),((indexesList,isTrimmed,physicalIndex)=>(isTrimmed&&indexesList.push(physicalIndex),indexesList)),[])}}},"./node_modules/handsontable/translations/maps/utils/actionsOnIndexes.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{v:()=>getDecreasedIndexes,z:()=>getIncreasedIndexes});__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js");var _helpers_array_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs");function getDecreasedIndexes(indexedValues,removedIndexes){return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_2__.YD)(indexedValues,(index=>index-removedIndexes.filter((removedIndex=>removedIndex<index)).length))}function getIncreasedIndexes(indexedValues,insertedIndexes){const firstInsertedIndex=insertedIndexes[0],amountOfIndexes=insertedIndexes.length;return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_2__.YD)(indexedValues,(index=>index>=firstInsertedIndex?index+amountOfIndexes:index))}},"./node_modules/handsontable/translations/maps/utils/indexesSequence.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{H:()=>getListWithRemovedItems,N:()=>getListWithInsertedItems});var _helpers_array_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs");function getListWithInsertedItems(indexedValues,insertionIndex,insertedIndexes){return[...indexedValues.slice(0,insertionIndex),...insertedIndexes,...indexedValues.slice(insertionIndex)]}function getListWithRemovedItems(indexedValues,removedIndexes){return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_0__.y0)(indexedValues,(index=>!1===removedIndexes.includes(index)))}},"./node_modules/handsontable/translations/maps/utils/physicallyIndexed.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{H:()=>getListWithRemovedItems,N:()=>getListWithInsertedItems});__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js");var _helpers_function_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/handsontable/helpers/function.mjs"),_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/handsontable/helpers/array.mjs");function getListWithInsertedItems(indexedValues,insertionIndex,insertedIndexes,insertedValuesMapping){const firstInsertedIndex=insertedIndexes.length?insertedIndexes[0]:void 0;return[...indexedValues.slice(0,firstInsertedIndex),...insertedIndexes.map(((insertedIndex,ordinalNumber)=>(0,_helpers_function_mjs__WEBPACK_IMPORTED_MODULE_2__.Tn)(insertedValuesMapping)?insertedValuesMapping(insertedIndex,ordinalNumber):insertedValuesMapping)),...void 0===firstInsertedIndex?[]:indexedValues.slice(firstInsertedIndex)]}function getListWithRemovedItems(indexedValues,removedIndexes){return(0,_helpers_array_mjs__WEBPACK_IMPORTED_MODULE_3__.y0)(indexedValues,((_,index)=>!1===removedIndexes.includes(index)))}},"./node_modules/handsontable/utils/autoResize.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function observe(element,eventName,handler){element.addEventListener(eventName,handler,!1)}function unObserve(element,eventName,handler){element.removeEventListener(eventName,handler,!1)}function getComputedStyle(element){return element.ownerDocument.defaultView.getComputedStyle(element)}function createInputElementResizer(ownerDocument){const defaults={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:element=>element.value,...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},body=ownerDocument.body,textHolder=ownerDocument.createTextNode(""),textContainer=ownerDocument.createElement("span");let observedElement;function resize(){var _getComputedStyle,_getComputedStyle2;textHolder.textContent=defaults.textContent(observedElement),textContainer.style.position="absolute",textContainer.style.fontSize=getComputedStyle(observedElement).fontSize,textContainer.style.fontFamily=getComputedStyle(observedElement).fontFamily,textContainer.style.whiteSpace="pre",body.appendChild(textContainer);const paddingStart=parseInt((null===(_getComputedStyle=getComputedStyle(observedElement))||void 0===_getComputedStyle?void 0:_getComputedStyle.paddingInlineStart)||0,10),paddingEnd=parseInt((null===(_getComputedStyle2=getComputedStyle(observedElement))||void 0===_getComputedStyle2?void 0:_getComputedStyle2.paddingInlineEnd)||0,10),width=textContainer.clientWidth+paddingStart+paddingEnd+1;body.removeChild(textContainer);const elementStyle=observedElement.style;elementStyle.height=`${defaults.minHeight}px`,defaults.minWidth>width?elementStyle.width=`${defaults.minWidth}px`:width>defaults.maxWidth?elementStyle.width=`${defaults.maxWidth}px`:elementStyle.width=`${width}px`;const scrollHeight=observedElement.scrollHeight?observedElement.scrollHeight-1:0;defaults.minHeight>scrollHeight?elementStyle.height=`${defaults.minHeight}px`:defaults.maxHeight<scrollHeight?(elementStyle.height=`${defaults.maxHeight}px`,elementStyle.overflowY="visible"):elementStyle.height=`${scrollHeight}px`}function delayedResize(){ownerDocument.defaultView.setTimeout(resize,0)}return{init:function init(elementToObserve,config){let doObserve=arguments.length>2&&void 0!==arguments[2]&&arguments[2];observedElement=elementToObserve,function extendDefaults(config){if(config&&config.minHeight)if("inherit"===config.minHeight)defaults.minHeight=observedElement.clientHeight;else{const minHeight=parseInt(config.minHeight,10);isNaN(minHeight)||(defaults.minHeight=minHeight)}if(config&&config.maxHeight)if("inherit"===config.maxHeight)defaults.maxHeight=observedElement.clientHeight;else{const maxHeight=parseInt(config.maxHeight,10);isNaN(maxHeight)||(defaults.maxHeight=maxHeight)}if(config&&config.minWidth)if("inherit"===config.minWidth)defaults.minWidth=observedElement.clientWidth;else{const minWidth=parseInt(config.minWidth,10);isNaN(minWidth)||(defaults.minWidth=minWidth)}if(config&&config.maxWidth)if("inherit"===config.maxWidth)defaults.maxWidth=observedElement.clientWidth;else{const maxWidth=parseInt(config.maxWidth,10);isNaN(maxWidth)||(defaults.maxWidth=maxWidth)}textContainer.firstChild||(textContainer.className="autoResize",textContainer.style.display="inline-block",textContainer.appendChild(textHolder))}(config),"TEXTAREA"===observedElement.nodeName&&(observedElement.style.resize="none",observedElement.style.height=`${defaults.minHeight}px`,observedElement.style.minWidth=`${defaults.minWidth}px`,observedElement.style.maxWidth=`${defaults.maxWidth}px`,observedElement.style.overflowY="hidden"),doObserve&&(observe(observedElement,"input",resize),observe(observedElement,"keydown",delayedResize)),resize()},resize,unObserve(){unObserve(observedElement,"input",resize),unObserve(observedElement,"keydown",delayedResize)}}}__webpack_require__.d(__webpack_exports__,{j:()=>createInputElementResizer})},"./node_modules/handsontable/utils/dataStructures/uniqueMap.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u:()=>createUniqueMap});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.find.js");var _helpers_function_mjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/handsontable/helpers/function.mjs");const DEFAULT_ERROR_ID_EXISTS=id=>`The id '${id}' is already declared in a map.`;function createUniqueMap(){let{errorIdExists}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const uniqueMap=new Map;function getItems(){return[...uniqueMap]}function hasItem(id){return uniqueMap.has(id)}return errorIdExists=(0,_helpers_function_mjs__WEBPACK_IMPORTED_MODULE_3__.Tn)(errorIdExists)?errorIdExists:DEFAULT_ERROR_ID_EXISTS,{addItem:function addItem(id,item){if(hasItem(id))throw new Error(errorIdExists(id));uniqueMap.set(id,item)},clear:function clear(){uniqueMap.clear()},getId:function getId(item){const[itemId]=getItems().find((_ref=>{let[id,element]=_ref;return item===element&&id}))||[null];return itemId},getItem:function getItem(id){return uniqueMap.get(id)},getItems,hasItem,removeItem:function removeItem(id){return uniqueMap.delete(id)}}}},"./node_modules/handsontable/utils/parseTable.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{KN:()=>instanceToHTML,oh:()=>htmlToGridSettings,ub:()=>_dataToHTML});__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/es.string.replace-all.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.constructor.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.filter.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.map.js"),__webpack_require__("./node_modules/core-js/modules/esnext.iterator.reduce.js");var _helpers_mixed_mjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/handsontable/helpers/mixed.mjs");const ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map((key=>`(${key})`)).join("|"),"gi");function instanceToHTML(instance){const hasColumnHeaders=instance.hasColHeaders(),hasRowHeaders=instance.hasRowHeaders(),coords=[hasColumnHeaders?-1:0,hasRowHeaders?-1:0,instance.countRows()-1,instance.countCols()-1],data=instance.getData(...coords),countRows=data.length,countCols=countRows>0?data[0].length:0,TABLE=["<table>","</table>"],THEAD=hasColumnHeaders?["<thead>","</thead>"]:[],TBODY=["<tbody>","</tbody>"],rowModifier=hasRowHeaders?1:0,columnModifier=hasColumnHeaders?1:0;for(let row=0;row<countRows;row+=1){const isColumnHeadersRow=hasColumnHeaders&&0===row,CELLS=[];for(let column=0;column<countCols;column+=1){const isRowHeadersColumn=!isColumnHeadersRow&&hasRowHeaders&&0===column;let cell="";if(isColumnHeadersRow)cell=`<th>${instance.getColHeader(column-rowModifier)}</th>`;else if(isRowHeadersColumn)cell=`<th>${instance.getRowHeader(row-columnModifier)}</th>`;else{const cellData=data[row][column],{hidden,rowspan,colspan}=instance.getCellMeta(row-columnModifier,column-rowModifier);if(!hidden){const attrs=[];if(rowspan&&attrs.push(`rowspan="${rowspan}"`),colspan&&attrs.push(`colspan="${colspan}"`),(0,_helpers_mixed_mjs__WEBPACK_IMPORTED_MODULE_6__.Im)(cellData))cell=`<td ${attrs.join(" ")}></td>`;else{const value=cellData.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");cell=`<td ${attrs.join(" ")}>${value}</td>`}}}CELLS.push(cell)}const TR=["<tr>",...CELLS,"</tr>"].join("");isColumnHeadersRow?THEAD.splice(1,0,TR):TBODY.splice(-1,0,TR)}return TABLE.splice(1,0,THEAD.join(""),TBODY.join("")),TABLE.join("")}function _dataToHTML(input){const inputLen=input.length,result=["<table>"];for(let row=0;row<inputLen;row+=1){const rowData=input[row],columnsLen=rowData.length,columnsResult=[];0===row&&result.push("<tbody>");for(let column=0;column<columnsLen;column+=1){const cellData=rowData[column],parsedCellData=(0,_helpers_mixed_mjs__WEBPACK_IMPORTED_MODULE_6__.Im)(cellData)?"":cellData.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(substring=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(substring.length-1)} </span>`)).replace(/\t/gi,"&#9;");columnsResult.push(`<td>${parsedCellData}</td>`)}result.push("<tr>",...columnsResult,"</tr>"),row+1===inputLen&&result.push("</tbody>")}return result.push("</table>"),result.join("")}function htmlToGridSettings(element){let rootDocument=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const settingsObj={},fragment=rootDocument.createDocumentFragment(),tempElem=rootDocument.createElement("div");fragment.appendChild(tempElem);let checkElement=element;if("string"==typeof checkElement){const escapedAdjacentHTML=checkElement.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(cellFragment=>{const openingTag=cellFragment.match(/<td\b[^>]*?>/g)[0];return`${openingTag}${cellFragment.substring(openingTag.length,cellFragment.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")}</td>`}));tempElem.insertAdjacentHTML("afterbegin",`${escapedAdjacentHTML}`),checkElement=tempElem.querySelector("table")}if(!checkElement||!function isHTMLTable(element){return"TABLE"===(element&&element.nodeName||"")}(checkElement))return;const generator=tempElem.querySelector('meta[name$="enerator"]'),hasRowHeaders=null!==checkElement.querySelector("tbody th"),trElement=checkElement.querySelector("tr"),countCols=trElement?Array.from(trElement.cells).reduce(((cols,cell)=>cols+cell.colSpan),0)-(hasRowHeaders?1:0):0,fixedRowsBottom=checkElement.tFoot&&Array.from(checkElement.tFoot.rows)||[],fixedRowsTop=[];let hasColHeaders=!1,thRowsLen=0,countRows=0;if(checkElement.tHead){const thRows=Array.from(checkElement.tHead.rows).filter((tr=>{const isDataRow=null!==tr.querySelector("td");return isDataRow&&fixedRowsTop.push(tr),!isDataRow}));thRowsLen=thRows.length,hasColHeaders=thRowsLen>0,thRowsLen>1?settingsObj.nestedHeaders=Array.from(thRows).reduce(((rows,row)=>{const headersRow=Array.from(row.cells).reduce(((headers,header,currentIndex)=>{if(hasRowHeaders&&0===currentIndex)return headers;const{colSpan:colspan,innerHTML}=header,nextHeader=colspan>1?{label:innerHTML,colspan}:innerHTML;return headers.push(nextHeader),headers}),[]);return rows.push(headersRow),rows}),[]):hasColHeaders&&(settingsObj.colHeaders=Array.from(thRows[0].children).reduce(((headers,header,index)=>(hasRowHeaders&&0===index||headers.push(header.innerHTML),headers)),[]))}fixedRowsTop.length&&(settingsObj.fixedRowsTop=fixedRowsTop.length),fixedRowsBottom.length&&(settingsObj.fixedRowsBottom=fixedRowsBottom.length);const dataRows=[...fixedRowsTop,...Array.from(checkElement.tBodies).reduce(((sections,section)=>(sections.push(...Array.from(section.rows)),sections)),[]),...fixedRowsBottom];countRows=dataRows.length;const dataArr=new Array(countRows);for(let r=0;r<countRows;r++)dataArr[r]=new Array(countCols);const mergeCells=[],rowHeaders=[];for(let row=0;row<countRows;row++){const tr=dataRows[row],cells=Array.from(tr.cells),cellsLen=cells.length;for(let cellId=0;cellId<cellsLen;cellId++){const cell=cells[cellId],{nodeName,innerHTML,rowSpan:rowspan,colSpan:colspan}=cell,col=dataArr[row].findIndex((value=>void 0===value));if("TD"===nodeName){if(rowspan>1||colspan>1){for(let rstart=row;rstart<row+rowspan;rstart++)if(rstart<countRows)for(let cstart=col;cstart<col+colspan;cstart++)dataArr[rstart][cstart]=null;const styleAttr=cell.getAttribute("style");styleAttr&&styleAttr.includes("mso-ignore:colspan")||mergeCells.push({col,row,rowspan,colspan})}let cellValue="";cellValue=generator&&/excel/gi.test(generator.content)?innerHTML.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):innerHTML.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),dataArr[row][col]=cellValue.replace(regEscapedChars,(match=>ESCAPED_HTML_CHARS[match]))}else rowHeaders.push(innerHTML)}}return mergeCells.length&&(settingsObj.mergeCells=mergeCells),rowHeaders.length&&(settingsObj.rowHeaders=rowHeaders),dataArr.length&&(settingsObj.data=dataArr),settingsObj}},"./node_modules/handsontable/utils/staticRegister.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>staticRegister});const collection=new Map;function staticRegister(){let namespace=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";collection.has(namespace)||collection.set(namespace,new Map);const subCollection=collection.get(namespace);return{register:function register(name,item){subCollection.set(name,item)},getItem:function getItem(name){return subCollection.get(name)},hasItem:function hasItem(name){return subCollection.has(name)},getNames:function getNames(){return[...subCollection.keys()]},getValues:function getValues(){return[...subCollection.values()]}}}},"./node_modules/handsontable/validators/registry.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{by:()=>_getItem,qV:()=>_register,tR:()=>hasItem});__webpack_require__("./node_modules/core-js/modules/es.error.cause.js");var _utils_staticRegister_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/handsontable/utils/staticRegister.mjs");const{register,getItem,hasItem,getNames,getValues}=(0,_utils_staticRegister_mjs__WEBPACK_IMPORTED_MODULE_1__.A)("validators");function _getItem(name){if("function"==typeof name)return name;if(!hasItem(name))throw Error(`No registered validator found under "${name}" name`);return getItem(name)}function _register(name,validator){"string"!=typeof name&&(name=(validator=name).VALIDATOR_TYPE),register(name,validator)}},"./node_modules/moment/moment.js":function(module,__unused_webpack_exports,__webpack_require__){(module=__webpack_require__.nmd(module)).exports=function(){"use strict";var hookCallback,some;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return input instanceof Array||"[object Array]"===Object.prototype.toString.call(input)}function isObject(input){return null!=input&&"[object Object]"===Object.prototype.toString.call(input)}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function isObjectEmpty(obj){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(obj).length;var k;for(k in obj)if(hasOwnProp(obj,k))return!1;return!0}function isUndefined(input){return void 0===input}function isNumber(input){return"number"==typeof input||"[object Number]"===Object.prototype.toString.call(input)}function isDate(input){return input instanceof Date||"[object Date]"===Object.prototype.toString.call(input)}function map(arr,fn){var i,res=[],arrLen=arr.length;for(i=0;i<arrLen;++i)res.push(fn(arr[i],i));return res}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function getParsingFlags(m){return null==m._pf&&(m._pf=defaultParsingFlags()),m._pf}function isValid(m){var flags=null,parsedParts=!1,isNowValid=m._d&&!isNaN(m._d.getTime());return isNowValid&&(flags=getParsingFlags(m),parsedParts=some.call(flags.parsedDateParts,(function(i){return null!=i})),isNowValid=flags.overflow<0&&!flags.empty&&!flags.invalidEra&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts),m._strict&&(isNowValid=isNowValid&&0===flags.charsLeftOver&&0===flags.unusedTokens.length&&void 0===flags.bigHour)),null!=Object.isFrozen&&Object.isFrozen(m)?isNowValid:(m._isValid=isNowValid,m._isValid)}function createInvalid(flags){var m=createUTC(NaN);return null!=flags?extend(getParsingFlags(m),flags):getParsingFlags(m).userInvalidated=!0,m}some=Array.prototype.some?Array.prototype.some:function(fun){var i,t=Object(this),len=t.length>>>0;for(i=0;i<len;i++)if(i in t&&fun.call(this,t[i],i,t))return!0;return!1};var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(to,from){var i,prop,val,momentPropertiesLen=momentProperties.length;if(isUndefined(from._isAMomentObject)||(to._isAMomentObject=from._isAMomentObject),isUndefined(from._i)||(to._i=from._i),isUndefined(from._f)||(to._f=from._f),isUndefined(from._l)||(to._l=from._l),isUndefined(from._strict)||(to._strict=from._strict),isUndefined(from._tzm)||(to._tzm=from._tzm),isUndefined(from._isUTC)||(to._isUTC=from._isUTC),isUndefined(from._offset)||(to._offset=from._offset),isUndefined(from._pf)||(to._pf=getParsingFlags(from)),isUndefined(from._locale)||(to._locale=from._locale),momentPropertiesLen>0)for(i=0;i<momentPropertiesLen;i++)isUndefined(val=from[prop=momentProperties[i]])||(to[prop]=val);return to}function Moment(config){copyConfig(this,config),this._d=new Date(null!=config._d?config._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===updateInProgress&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(obj){return obj instanceof Moment||null!=obj&&null!=obj._isAMomentObject}function warn(msg){!1===hooks.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend((function(){if(null!=hooks.deprecationHandler&&hooks.deprecationHandler(null,msg),firstTime){var arg,i,key,args=[],argLen=arguments.length;for(i=0;i<argLen;i++){if(arg="","object"==typeof arguments[i]){for(key in arg+="\n["+i+"] ",arguments[0])hasOwnProp(arguments[0],key)&&(arg+=key+": "+arguments[0][key]+", ");arg=arg.slice(0,-2)}else arg=arguments[i];args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack),firstTime=!1}return fn.apply(this,arguments)}),fn)}var keys,deprecations={};function deprecateSimple(name,msg){null!=hooks.deprecationHandler&&hooks.deprecationHandler(name,msg),deprecations[name]||(warn(msg),deprecations[name]=!0)}function isFunction(input){return"undefined"!=typeof Function&&input instanceof Function||"[object Function]"===Object.prototype.toString.call(input)}function set(config){var prop,i;for(i in config)hasOwnProp(config,i)&&(isFunction(prop=config[i])?this[i]=prop:this["_"+i]=prop);this._config=config,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(parentConfig,childConfig){var prop,res=extend({},parentConfig);for(prop in childConfig)hasOwnProp(childConfig,prop)&&(isObject(parentConfig[prop])&&isObject(childConfig[prop])?(res[prop]={},extend(res[prop],parentConfig[prop]),extend(res[prop],childConfig[prop])):null!=childConfig[prop]?res[prop]=childConfig[prop]:delete res[prop]);for(prop in parentConfig)hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])&&(res[prop]=extend({},res[prop]));return res}function Locale(config){null!=config&&this.set(config)}hooks.suppressDeprecationWarnings=!1,hooks.deprecationHandler=null,keys=Object.keys?Object.keys:function(obj){var i,res=[];for(i in obj)hasOwnProp(obj,i)&&res.push(i);return res};var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar.sameElse;return isFunction(output)?output.call(mom,now):output}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length;return(number>=0?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;"string"==typeof callback&&(func=function(){return this[callback]()}),token&&(formatTokenFunctions[token]=func),padded&&(formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}),ordinal&&(formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)})}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;i<length;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=removeFormattingTokens(array[i]);return function(mom){var i,output="";for(i=0;i<length;i++)output+=isFunction(array[i])?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];return format||!formatUpper?format:(this._longDateFormat[key]=formatUpper.match(formattingTokens).map((function(tok){return"MMMM"===tok||"MM"===tok||"DD"===tok||"dddd"===tok?tok.slice(1):tok})).join(""),this._longDateFormat[key])}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)}var aliases={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function normalizeUnits(units){return"string"==typeof units?aliases[units]||aliases[units.toLowerCase()]:void 0}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop))&&(normalizedInput[normalizedProp]=inputObject[prop]);return normalizedInput}var priorities={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function getPrioritizedUnits(unitsObj){var u,units=[];for(u in unitsObj)hasOwnProp(unitsObj,u)&&units.push({unit:u,priority:priorities[u]});return units.sort((function(a,b){return a.priority-b.priority})),units}var regexes,match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,match1to2NoLeadingZero=/^[1-9]\d?/,match1to2HasZero=/^([1-9]\d|\d)/;function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){return hasOwnProp(regexes,token)?regexes[token](config._strict,config._locale):new RegExp(unescapeFormat(token))}function unescapeFormat(s){return regexEscape(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function absFloor(number){return number<0?Math.ceil(number)||0:Math.floor(number)}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=absFloor(coercedNumber)),value}regexes={};var tokens={};function addParseToken(token,callback){var i,tokenLen,func=callback;for("string"==typeof token&&(token=[token]),isNumber(callback)&&(func=function(input,array){array[callback]=toInt(input)}),tokenLen=token.length,i=0;i<tokenLen;i++)tokens[token[i]]=func}function addWeekParseToken(token,callback){addParseToken(token,(function(input,array,config,token){config._w=config._w||{},callback(input,config._w,config,token)}))}function addTimeToArrayFromToken(token,input,config){null!=input&&hasOwnProp(tokens,token)&&tokens[token](input,config._a,config,token)}function isLeapYear(year){return year%4==0&&year%100!=0||year%400==0}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function daysInYear(year){return isLeapYear(year)?366:365}addFormatToken("Y",0,0,(function(){var y=this.year();return y<=9999?zeroFill(y,4):"+"+y})),addFormatToken(0,["YY",2],0,(function(){return this.year()%100})),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,!0],0,"year"),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",(function(input,array){array[YEAR]=2===input.length?hooks.parseTwoDigitYear(input):toInt(input)})),addParseToken("YY",(function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)})),addParseToken("Y",(function(input,array){array[YEAR]=parseInt(input,10)})),hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var indexOf,getSetYear=makeGetSet("FullYear",!0);function getIsLeapYear(){return isLeapYear(this.year())}function makeGetSet(unit,keepTime){return function(value){return null!=value?(set$1(this,unit,value),hooks.updateOffset(this,keepTime),this):get(this,unit)}}function get(mom,unit){if(!mom.isValid())return NaN;var d=mom._d,isUTC=mom._isUTC;switch(unit){case"Milliseconds":return isUTC?d.getUTCMilliseconds():d.getMilliseconds();case"Seconds":return isUTC?d.getUTCSeconds():d.getSeconds();case"Minutes":return isUTC?d.getUTCMinutes():d.getMinutes();case"Hours":return isUTC?d.getUTCHours():d.getHours();case"Date":return isUTC?d.getUTCDate():d.getDate();case"Day":return isUTC?d.getUTCDay():d.getDay();case"Month":return isUTC?d.getUTCMonth():d.getMonth();case"FullYear":return isUTC?d.getUTCFullYear():d.getFullYear();default:return NaN}}function set$1(mom,unit,value){var d,isUTC,year,month,date;if(mom.isValid()&&!isNaN(value)){switch(d=mom._d,isUTC=mom._isUTC,unit){case"Milliseconds":return void(isUTC?d.setUTCMilliseconds(value):d.setMilliseconds(value));case"Seconds":return void(isUTC?d.setUTCSeconds(value):d.setSeconds(value));case"Minutes":return void(isUTC?d.setUTCMinutes(value):d.setMinutes(value));case"Hours":return void(isUTC?d.setUTCHours(value):d.setHours(value));case"Date":return void(isUTC?d.setUTCDate(value):d.setDate(value));case"FullYear":break;default:return}year=value,month=mom.month(),date=29!==(date=mom.date())||1!==month||isLeapYear(year)?date:28,isUTC?d.setUTCFullYear(year,month,date):d.setFullYear(year,month,date)}}function stringGet(units){return isFunction(this[units=normalizeUnits(units)])?this[units]():this}function stringSet(units,value){if("object"==typeof units){var i,prioritized=getPrioritizedUnits(units=normalizeObjectUnits(units)),prioritizedLen=prioritized.length;for(i=0;i<prioritizedLen;i++)this[prioritized[i].unit](units[prioritized[i].unit])}else if(isFunction(this[units=normalizeUnits(units)]))return this[units](value);return this}function mod(n,x){return(n%x+x)%x}function daysInMonth(year,month){if(isNaN(year)||isNaN(month))return NaN;var modMonth=mod(month,12);return year+=(month-modMonth)/12,1===modMonth?isLeapYear(year)?29:28:31-modMonth%7%2}indexOf=Array.prototype.indexOf?Array.prototype.indexOf:function(o){var i;for(i=0;i<this.length;++i)if(this[i]===o)return i;return-1},addFormatToken("M",["MM",2],"Mo",(function(){return this.month()+1})),addFormatToken("MMM",0,0,(function(format){return this.localeData().monthsShort(this,format)})),addFormatToken("MMMM",0,0,(function(format){return this.localeData().months(this,format)})),addRegexToken("M",match1to2,match1to2NoLeadingZero),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",(function(isStrict,locale){return locale.monthsShortRegex(isStrict)})),addRegexToken("MMMM",(function(isStrict,locale){return locale.monthsRegex(isStrict)})),addParseToken(["M","MM"],(function(input,array){array[MONTH]=toInt(input)-1})),addParseToken(["MMM","MMMM"],(function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);null!=month?array[MONTH]=month:getParsingFlags(config).invalidMonth=input}));var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(m,format){return m?isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]:isArray(this._months)?this._months:this._months.standalone}function localeMonthsShort(m,format){return m?isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]:isArray(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)mom=createUTC([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase();return strict?"MMM"===format?-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:null:-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:null:"MMM"===format?-1!==(ii=indexOf.call(this._shortMonthsParse,llc))||-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:null:-1!==(ii=indexOf.call(this._longMonthsParse,llc))||-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:null}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact)return handleStrictParse.call(this,monthName,format,strict);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(mom=createUTC([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}}function setMonth(mom,value){if(!mom.isValid())return mom;if("string"==typeof value)if(/^\d+$/.test(value))value=toInt(value);else if(!isNumber(value=mom.localeData().monthsParse(value)))return mom;var month=value,date=mom.date();return date=date<29?date:Math.min(date,daysInMonth(mom.year(),month)),mom._isUTC?mom._d.setUTCMonth(month,date):mom._d.setMonth(month,date),mom}function getSetMonth(value){return null!=value?(setMonth(this,value),hooks.updateOffset(this,!0),this):get(this,"Month")}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex)}function monthsRegex(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex)}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,shortP,longP,shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<12;i++)mom=createUTC([2e3,i]),shortP=regexEscape(this.monthsShort(mom,"")),longP=regexEscape(this.months(mom,"")),shortPieces.push(shortP),longPieces.push(longP),mixedPieces.push(longP),mixedPieces.push(shortP);shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}function createDate(y,m,d,h,M,s,ms){var date;return y<100&&y>=0?(date=new Date(y+400,m,d,h,M,s,ms),isFinite(date.getFullYear())&&date.setFullYear(y)):date=new Date(y,m,d,h,M,s,ms),date}function createUTCDate(y){var date,args;return y<100&&y>=0?((args=Array.prototype.slice.call(arguments))[0]=y+400,date=new Date(Date.UTC.apply(null,args)),isFinite(date.getUTCFullYear())&&date.setUTCFullYear(y)):date=new Date(Date.UTC.apply(null,arguments)),date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy;return-(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var resYear,resDayOfYear,dayOfYear=1+7*(week-1)+(7+weekday-dow)%7+firstWeekOffset(year,dow,doy);return dayOfYear<=0?resDayOfYear=daysInYear(resYear=year-1)+dayOfYear:dayOfYear>daysInYear(year)?(resYear=year+1,resDayOfYear=dayOfYear-daysInYear(year)):(resYear=year,resDayOfYear=dayOfYear),{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var resWeek,resYear,weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1;return week<1?resWeek=week+weeksInYear(resYear=mom.year()-1,dow,doy):week>weeksInYear(mom.year(),dow,doy)?(resWeek=week-weeksInYear(mom.year(),dow,doy),resYear=mom.year()+1):(resYear=mom.year(),resWeek=week),{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addRegexToken("w",match1to2,match1to2NoLeadingZero),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2,match1to2NoLeadingZero),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],(function(input,week,config,token){week[token.substr(0,1)]=toInt(input)}));var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")}function parseWeekday(input,locale){return"string"!=typeof input?input:isNaN(input)?"number"==typeof(input=locale.weekdaysParse(input))?input:null:parseInt(input,10)}function parseIsoWeekday(input,locale){return"string"==typeof input?locale.weekdaysParse(input)%7||7:isNaN(input)?null:input}function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n))}addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,(function(format){return this.localeData().weekdaysMin(this,format)})),addFormatToken("ddd",0,0,(function(format){return this.localeData().weekdaysShort(this,format)})),addFormatToken("dddd",0,0,(function(format){return this.localeData().weekdays(this,format)})),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",(function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)})),addRegexToken("ddd",(function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)})),addRegexToken("dddd",(function(isStrict,locale){return locale.weekdaysRegex(isStrict)})),addWeekParseToken(["dd","ddd","dddd"],(function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);null!=weekday?week.d=weekday:getParsingFlags(config).invalidWeekday=input})),addWeekParseToken(["d","e","E"],(function(input,week,config,token){week[token]=toInt(input)}));var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[m&&!0!==m&&this._weekdays.isFormat.test(format)?"format":"standalone"];return!0===m?shiftWeekdays(weekdays,this._week.dow):m?weekdays[m.day()]:weekdays}function localeWeekdaysShort(m){return!0===m?shiftWeekdays(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort}function localeWeekdaysMin(m){return!0===m?shiftWeekdays(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin}function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)mom=createUTC([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase();return strict?"dddd"===format?-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:null:"ddd"===format?-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:null:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:"dddd"===format?-1!==(ii=indexOf.call(this._weekdaysParse,llc))||-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))||-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:"ddd"===format?-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))||-1!==(ii=indexOf.call(this._weekdaysParse,llc))||-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))||-1!==(ii=indexOf.call(this._weekdaysParse,llc))||-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:null}function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact)return handleStrictParse$1.call(this,weekdayName,format,strict);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(mom=createUTC([2e3,1]).day(i),strict&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"dddd"===format&&this._fullWeekdaysParse[i].test(weekdayName))return i;if(strict&&"ddd"===format&&this._shortWeekdaysParse[i].test(weekdayName))return i;if(strict&&"dd"===format&&this._minWeekdaysParse[i].test(weekdayName))return i;if(!strict&&this._weekdaysParse[i].test(weekdayName))return i}}function getSetDayOfWeek(input){if(!this.isValid())return null!=input?this:NaN;var day=get(this,"Day");return null!=input?(input=parseWeekday(input,this.localeData()),this.add(input-day,"d")):day}function getSetLocaleDayOfWeek(input){if(!this.isValid())return null!=input?this:NaN;var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){if(!this.isValid())return null!=input?this:NaN;if(null!=input){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}return this.day()||7}function weekdaysRegex(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex)}function weekdaysShortRegex(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function weekdaysMinRegex(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,minp,shortp,longp,minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<7;i++)mom=createUTC([2e3,1]).day(i),minp=regexEscape(this.weekdaysMin(mom,"")),shortp=regexEscape(this.weekdaysShort(mom,"")),longp=regexEscape(this.weekdays(mom,"")),minPieces.push(minp),shortPieces.push(shortp),longPieces.push(longp),mixedPieces.push(minp),mixedPieces.push(shortp),mixedPieces.push(longp);minPieces.sort(cmpLenRev),shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}function meridiem(token,lowercase){addFormatToken(token,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)}))}function matchMeridiem(isStrict,locale){return locale._meridiemParse}function localeIsPM(input){return"p"===(input+"").toLowerCase().charAt(0)}addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,hFormat),addFormatToken("k",["kk",2],0,kFormat),addFormatToken("hmm",0,0,(function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)})),addFormatToken("hmmss",0,0,(function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)})),addFormatToken("Hmm",0,0,(function(){return""+this.hours()+zeroFill(this.minutes(),2)})),addFormatToken("Hmmss",0,0,(function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)})),meridiem("a",!0),meridiem("A",!1),addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2,match1to2HasZero),addRegexToken("h",match1to2,match1to2NoLeadingZero),addRegexToken("k",match1to2,match1to2NoLeadingZero),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addRegexToken("kk",match1to2,match2),addRegexToken("hmm",match3to4),addRegexToken("hmmss",match5to6),addRegexToken("Hmm",match3to4),addRegexToken("Hmmss",match5to6),addParseToken(["H","HH"],HOUR),addParseToken(["k","kk"],(function(input,array,config){var kInput=toInt(input);array[HOUR]=24===kInput?0:kInput})),addParseToken(["a","A"],(function(input,array,config){config._isPm=config._locale.isPM(input),config._meridiem=input})),addParseToken(["h","hh"],(function(input,array,config){array[HOUR]=toInt(input),getParsingFlags(config).bigHour=!0})),addParseToken("hmm",(function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos)),getParsingFlags(config).bigHour=!0})),addParseToken("hmmss",(function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2)),getParsingFlags(config).bigHour=!0})),addParseToken("Hmm",(function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos))})),addParseToken("Hmmss",(function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2))}));var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);function localeMeridiem(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"}var globalLocale,baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse},locales={},localeFamilies={};function commonPrefix(arr1,arr2){var i,minl=Math.min(arr1.length,arr2.length);for(i=0;i<minl;i+=1)if(arr1[i]!==arr2[i])return i;return minl}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){for(var j,next,locale,split,i=0;i<names.length;){for(j=(split=normalizeLocale(names[i]).split("-")).length,next=(next=normalizeLocale(names[i+1]))?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&commonPrefix(split,next)>=j-1)break;j--}i++}return globalLocale}function isLocaleNameSane(name){return!(!name||!name.match("^[^/\\\\]*$"))}function loadLocale(name){var oldLocale=null;if(void 0===locales[name]&&module&&module.exports&&isLocaleNameSane(name))try{oldLocale=globalLocale._abbr,Object(function webpackMissingModule(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),getSetGlobalLocale(oldLocale)}catch(e){locales[name]=null}return locales[name]}function getSetGlobalLocale(key,values){var data;return key&&((data=isUndefined(values)?getLocale(key):defineLocale(key,values))?globalLocale=data:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+key+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(name,config){if(null!==config){var locale,parentConfig=baseConfig;if(config.abbr=name,null!=locales[name])deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),parentConfig=locales[name]._config;else if(null!=config.parentLocale)if(null!=locales[config.parentLocale])parentConfig=locales[config.parentLocale]._config;else{if(null==(locale=loadLocale(config.parentLocale)))return localeFamilies[config.parentLocale]||(localeFamilies[config.parentLocale]=[]),localeFamilies[config.parentLocale].push({name,config}),null;parentConfig=locale._config}return locales[name]=new Locale(mergeConfigs(parentConfig,config)),localeFamilies[name]&&localeFamilies[name].forEach((function(x){defineLocale(x.name,x.config)})),getSetGlobalLocale(name),locales[name]}return delete locales[name],null}function updateLocale(name,config){if(null!=config){var locale,tmpLocale,parentConfig=baseConfig;null!=locales[name]&&null!=locales[name].parentLocale?locales[name].set(mergeConfigs(locales[name]._config,config)):(null!=(tmpLocale=loadLocale(name))&&(parentConfig=tmpLocale._config),config=mergeConfigs(parentConfig,config),null==tmpLocale&&(config.abbr=name),(locale=new Locale(config)).parentLocale=locales[name],locales[name]=locale),getSetGlobalLocale(name)}else null!=locales[name]&&(null!=locales[name].parentLocale?(locales[name]=locales[name].parentLocale,name===getSetGlobalLocale()&&getSetGlobalLocale(name)):null!=locales[name]&&delete locales[name]);return locales[name]}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return globalLocale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return chooseLocale(key)}function listLocales(){return keys(locales)}function checkOverflow(m){var overflow,a=m._a;return a&&-2===getParsingFlags(m).overflow&&(overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||24===a[HOUR]&&(0!==a[MINUTE]||0!==a[SECOND]||0!==a[MILLISECOND])?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)&&(overflow=DATE),getParsingFlags(m)._overflowWeeks&&-1===overflow&&(overflow=WEEK),getParsingFlags(m)._overflowWeekday&&-1===overflow&&(overflow=WEEKDAY),getParsingFlags(m).overflow=overflow),m}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function configFromISO(config){var i,l,allowTime,dateFormat,timeFormat,tzFormat,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),isoDatesLen=isoDates.length,isoTimesLen=isoTimes.length;if(match){for(getParsingFlags(config).iso=!0,i=0,l=isoDatesLen;i<l;i++)if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0],allowTime=!1!==isoDates[i][2];break}if(null==dateFormat)return void(config._isValid=!1);if(match[3]){for(i=0,l=isoTimesLen;i<l;i++)if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}if(null==timeFormat)return void(config._isValid=!1)}if(!allowTime&&null!=timeFormat)return void(config._isValid=!1);if(match[4]){if(!tzRegex.exec(match[4]))return void(config._isValid=!1);tzFormat="Z"}config._f=dateFormat+(timeFormat||"")+(tzFormat||""),configFromStringAndFormat(config)}else config._isValid=!1}function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];return secondStr&&result.push(parseInt(secondStr,10)),result}function untruncateYear(yearStr){var year=parseInt(yearStr,10);return year<=49?2e3+year:year<=999?1900+year:year}function preprocessRFC2822(s){return s.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(weekdayStr,parsedInput,config){return!weekdayStr||defaultLocaleWeekdaysShort.indexOf(weekdayStr)===new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay()||(getParsingFlags(config).weekdayMismatch=!0,config._isValid=!1,!1)}function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset)return obsOffsets[obsOffset];if(militaryOffset)return 0;var hm=parseInt(numOffset,10),m=hm%100;return(hm-m)/100*60+m}function configFromRFC2822(config){var parsedArray,match=rfc2822.exec(preprocessRFC2822(config._i));if(match){if(parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]),!checkWeekday(match[1],parsedArray,config))return;config._a=parsedArray,config._tzm=calculateOffset(match[8],match[9],match[10]),config._d=createUTCDate.apply(null,config._a),config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),getParsingFlags(config).rfc2822=!0}else config._isValid=!1}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);null===matched?(configFromISO(config),!1===config._isValid&&(delete config._isValid,configFromRFC2822(config),!1===config._isValid&&(delete config._isValid,config._strict?config._isValid=!1:hooks.createFromInputFallback(config)))):config._d=new Date(+matched[1])}function defaults(a,b,c){return null!=a?a:null!=b?b:c}function currentDateArray(config){var nowValue=new Date(hooks.now());return config._useUTC?[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]:[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}function configFromArray(config){var i,date,currentDate,expectedWeekday,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),null!=config._dayOfYear&&(yearToUse=defaults(config._a[YEAR],currentDate[YEAR]),(config._dayOfYear>daysInYear(yearToUse)||0===config._dayOfYear)&&(getParsingFlags(config)._overflowDayOfYear=!0),date=createUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;i<3&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;i<7;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?createUTCDate:createDate).apply(null,input),expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay(),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24),config._w&&void 0!==config._w.d&&config._w.d!==expectedWeekday&&(getParsingFlags(config).weekdayMismatch=!0)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow,curWeek;null!=(w=config._w).GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year),week=defaults(w.W,1),((weekday=defaults(w.E,1))<1||weekday>7)&&(weekdayOverflow=!0)):(dow=config._locale._week.dow,doy=config._locale._week.doy,curWeek=weekOfYear(createLocal(),dow,doy),weekYear=defaults(w.gg,config._a[YEAR],curWeek.year),week=defaults(w.w,curWeek.week),null!=w.d?((weekday=w.d)<0||weekday>6)&&(weekdayOverflow=!0):null!=w.e?(weekday=w.e+dow,(w.e<0||w.e>6)&&(weekdayOverflow=!0)):weekday=dow),week<1||week>weeksInYear(weekYear,dow,doy)?getParsingFlags(config)._overflowWeeks=!0:null!=weekdayOverflow?getParsingFlags(config)._overflowWeekday=!0:(temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear)}function configFromStringAndFormat(config){if(config._f!==hooks.ISO_8601)if(config._f!==hooks.RFC_2822){config._a=[],getParsingFlags(config).empty=!0;var i,parsedInput,tokens,token,skipped,era,tokenLen,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokenLen=(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[]).length,i=0;i<tokenLen;i++)token=tokens[i],(parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0])&&((skipped=string.substr(0,string.indexOf(parsedInput))).length>0&&getParsingFlags(config).unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?getParsingFlags(config).empty=!1:getParsingFlags(config).unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&getParsingFlags(config).unusedTokens.push(token);getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&getParsingFlags(config).unusedInput.push(string),config._a[HOUR]<=12&&!0===getParsingFlags(config).bigHour&&config._a[HOUR]>0&&(getParsingFlags(config).bigHour=void 0),getParsingFlags(config).parsedDateParts=config._a.slice(0),getParsingFlags(config).meridiem=config._meridiem,config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem),null!==(era=getParsingFlags(config).era)&&(config._a[YEAR]=config._locale.erasConvertYear(era,config._a[YEAR])),configFromArray(config),checkOverflow(config)}else configFromRFC2822(config);else configFromISO(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;return null==meridiem?hour:null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?((isPm=locale.isPM(meridiem))&&hour<12&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore,validFormatFound,bestFormatIsValid=!1,configfLen=config._f.length;if(0===configfLen)return getParsingFlags(config).invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<configfLen;i++)currentScore=0,validFormatFound=!1,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._f=config._f[i],configFromStringAndFormat(tempConfig),isValid(tempConfig)&&(validFormatFound=!0),currentScore+=getParsingFlags(tempConfig).charsLeftOver,currentScore+=10*getParsingFlags(tempConfig).unusedTokens.length,getParsingFlags(tempConfig).score=currentScore,bestFormatIsValid?currentScore<scoreToBeat&&(scoreToBeat=currentScore,bestMoment=tempConfig):(null==scoreToBeat||currentScore<scoreToBeat||validFormatFound)&&(scoreToBeat=currentScore,bestMoment=tempConfig,validFormatFound&&(bestFormatIsValid=!0));extend(config,bestMoment||tempConfig)}function configFromObject(config){if(!config._d){var i=normalizeObjectUnits(config._i),dayOrDate=void 0===i.day?i.date:i.day;config._a=map([i.year,i.month,dayOrDate,i.hour,i.minute,i.second,i.millisecond],(function(obj){return obj&&parseInt(obj,10)})),configFromArray(config)}}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));return res._nextDay&&(res.add(1,"d"),res._nextDay=void 0),res}function prepareConfig(config){var input=config._i,format=config._f;return config._locale=config._locale||getLocale(config._l),null===input||void 0===format&&""===input?createInvalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),isMoment(input)?new Moment(checkOverflow(input)):(isDate(input)?config._d=input:isArray(format)?configFromStringAndArray(config):format?configFromStringAndFormat(config):configFromInput(config),isValid(config)||(config._d=null),config))}function configFromInput(config){var input=config._i;isUndefined(input)?config._d=new Date(hooks.now()):isDate(input)?config._d=new Date(input.valueOf()):"string"==typeof input?configFromString(config):isArray(input)?(config._a=map(input.slice(0),(function(obj){return parseInt(obj,10)})),configFromArray(config)):isObject(input)?configFromObject(config):isNumber(input)?config._d=new Date(input):hooks.createFromInputFallback(config)}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};return!0!==format&&!1!==format||(strict=format,format=void 0),!0!==locale&&!1!==locale||(strict=locale,locale=void 0),(isObject(input)&&isObjectEmpty(input)||isArray(input)&&0===input.length)&&(input=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=isUTC,c._l=locale,c._i=input,c._f=format,c._strict=strict,createFromConfig(c)}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!1)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))})),hooks.ISO_8601=function(){},hooks.RFC_2822=function(){};var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var other=createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other<this?this:other:createInvalid()})),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var other=createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other>this?this:other:createInvalid()}));function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return createLocal();for(res=moments[0],i=1;i<moments.length;++i)moments[i].isValid()&&!moments[i][fn](res)||(res=moments[i]);return res}function min(){return pickBy("isBefore",[].slice.call(arguments,0))}function max(){return pickBy("isAfter",[].slice.call(arguments,0))}var now=function(){return Date.now?Date.now():+new Date},ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(m){var key,i,unitHasDecimal=!1,orderLen=ordering.length;for(key in m)if(hasOwnProp(m,key)&&(-1===indexOf.call(ordering,key)||null!=m[key]&&isNaN(m[key])))return!1;for(i=0;i<orderLen;++i)if(m[ordering[i]]){if(unitHasDecimal)return!1;parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])&&(unitHasDecimal=!0)}return!0}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput),this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+1e3*hours*60*60,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){return number<0?-1*Math.round(-1*number):Math.round(number)}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;i<len;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function offset(token,separator){addFormatToken(token,0,0,(function(){var offset=this.utcOffset(),sign="+";return offset<0&&(offset=-offset,sign="-"),sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)}))}offset("Z",":"),offset("ZZ",""),addRegexToken("Z",matchShortOffset),addRegexToken("ZZ",matchShortOffset),addParseToken(["Z","ZZ"],(function(input,array,config){config._useUTC=!0,config._tzm=offsetFromString(matchShortOffset,input)}));var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var parts,minutes,matches=(string||"").match(matcher);return null===matches?null:0===(minutes=60*(parts=((matches[matches.length-1]||[])+"").match(chunkOffset)||["-",0,0])[1]+toInt(parts[2]))?0:"+"===parts[0]?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf(),res._d.setTime(res._d.valueOf()+diff),hooks.updateOffset(res,!1),res):createLocal(input).local()}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset())}function getSetOffset(input,keepLocalTime,keepMinutes){var localAdjust,offset=this._offset||0;if(!this.isValid())return null!=input?this:NaN;if(null!=input){if("string"==typeof input){if(null===(input=offsetFromString(matchShortOffset,input)))return this}else Math.abs(input)<16&&!keepMinutes&&(input*=60);return!this._isUTC&&keepLocalTime&&(localAdjust=getDateOffset(this)),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addSubtract(this,createDuration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?offset:getDateOffset(this)}function getSetZone(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var tZone=offsetFromString(matchOffset,this._i);null!=tZone?this.utcOffset(tZone):this.utcOffset(0,!0)}return this}function hasAlignedHourOffset(input){return!!this.isValid()&&(input=input?createLocal(input).utcOffset():0,(this.utcOffset()-input)%60==0)}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted))return this._isDSTShifted;var other,c={};return copyConfig(c,this),(c=prepareConfig(c))._a?(other=c._isUTC?createUTC(c._a):createLocal(c._a),this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function isLocal(){return!!this.isValid()&&!this._isUTC}function isUtcOffset(){return!!this.isValid()&&this._isUTC}function isUtc(){return!!this.isValid()&&this._isUTC&&0===this._offset}hooks.updateOffset=function(){};var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var sign,ret,diffRes,duration=input,match=null;return isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:isNumber(input)||!isNaN(+input)?(duration={},key?duration[key]=+input:duration.milliseconds=+input):(match=aspNetRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(1e3*match[MILLISECOND]))*sign}):(match=isoRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to)),(duration={}).ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),isDuration(input)&&hasOwnProp(input,"_isValid")&&(ret._isValid=input._isValid),ret}function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function momentsDifference(base,other){var res;return base.isValid()&&other.isValid()?(other=cloneWithOffset(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):((res=positiveMomentsDifference(other,base)).milliseconds=-res.milliseconds,res.months=-res.months),res):{milliseconds:0,months:0}}function createAdder(direction,name){return function(val,period){var tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),tmp=val,val=period,period=tmp),addSubtract(this,createDuration(val,period),direction),this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);mom.isValid()&&(updateOffset=null==updateOffset||updateOffset,months&&setMonth(mom,get(mom,"Month")+months*isAdding),days&&set$1(mom,"Date",get(mom,"Date")+days*isAdding),milliseconds&&mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding),updateOffset&&hooks.updateOffset(mom,days||months))}createDuration.fn=Duration.prototype,createDuration.invalid=createInvalid$1;var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function isString(input){return"string"==typeof input||input instanceof String}function isMomentInput(input){return isMoment(input)||isDate(input)||isString(input)||isNumber(input)||isNumberOrStringArray(input)||isMomentInputObject(input)||null==input}function isMomentInputObject(input){var i,property,objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=!1,properties=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],propertyLen=properties.length;for(i=0;i<propertyLen;i+=1)property=properties[i],propertyTest=propertyTest||hasOwnProp(input,property);return objectTest&&propertyTest}function isNumberOrStringArray(input){var arrayTest=isArray(input),dataTypeTest=!1;return arrayTest&&(dataTypeTest=0===input.filter((function(item){return!isNumber(item)&&isString(input)})).length),arrayTest&&dataTypeTest}function isCalendarSpec(input){var i,property,objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=!1,properties=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(i=0;i<properties.length;i+=1)property=properties[i],propertyTest=propertyTest||hasOwnProp(input,property);return objectTest&&propertyTest}function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,"days",!0);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"}function calendar$1(time,formats){1===arguments.length&&(arguments[0]?isMomentInput(arguments[0])?(time=arguments[0],formats=void 0):isCalendarSpec(arguments[0])&&(formats=arguments[0],time=void 0):(time=void 0,formats=void 0));var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse",output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()>localInput.valueOf():localInput.valueOf()<this.clone().startOf(units).valueOf())}function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()<localInput.valueOf():this.clone().endOf(units).valueOf()<localInput.valueOf())}function isBetween(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);return!!(this.isValid()&&localFrom.isValid()&&localTo.isValid())&&("("===(inclusivity=inclusivity||"()")[0]?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(")"===inclusivity[1]?this.isBefore(localTo,units):!this.isAfter(localTo,units))}function isSame(input,units){var inputMs,localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()===localInput.valueOf():(inputMs=localInput.valueOf(),this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()))}function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units)}function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units)}function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid())return NaN;if(!(that=cloneWithOffset(input,this)).isValid())return NaN;switch(zoneDelta=6e4*(that.utcOffset()-this.utcOffset()),units=normalizeUnits(units)){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)}function monthDiff(a,b){if(a.date()<b.date())return-monthDiff(b,a);var wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return-(wholeMonthDiff+(b-anchor<0?(b-anchor)/(anchor-a.clone().add(wholeMonthDiff-1,"months")):(b-anchor)/(a.clone().add(wholeMonthDiff+1,"months")-anchor)))||0}function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(keepOffset){if(!this.isValid())return null;var utc=!0!==keepOffset,m=utc?this.clone().utc():this;return m.year()<0||m.year()>9999?formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction(Date.prototype.toISOString)?utc?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",formatMoment(m,"Z")):formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var prefix,year,datetime,suffix,func="moment",zone="";return this.isLocal()||(func=0===this.utcOffset()?"moment.utc":"moment.parseZone",zone="Z"),prefix="["+func+'("]',year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",datetime="-MM-DD[T]HH:mm:ss.SSS",suffix=zone+'[")]',this.format(prefix+year+datetime+suffix)}function format(inputString){inputString||(inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var output=formatMoment(this,inputString);return this.localeData().postformat(output)}function from(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())?createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()}function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix)}function to(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())?createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()}function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix)}function locale(key){var newLocaleData;return void 0===key?this._locale._abbr:(null!=(newLocaleData=getLocale(key))&&(this._locale=newLocaleData),this)}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(key){return void 0===key?this.localeData():this.locale(key)}));function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=3506328*MS_PER_HOUR;function mod$1(dividend,divisor){return(dividend%divisor+divisor)%divisor}function localStartOfDate(y,m,d){return y<100&&y>=0?new Date(y+400,m,d)-MS_PER_400_YEARS:new Date(y,m,d).valueOf()}function utcStartOfDate(y,m,d){return y<100&&y>=0?Date.UTC(y+400,m,d)-MS_PER_400_YEARS:Date.UTC(y,m,d)}function startOf(units){var time,startOfDate;if(void 0===(units=normalizeUnits(units))||"millisecond"===units||!this.isValid())return this;switch(startOfDate=this._isUTC?utcStartOfDate:localStartOfDate,units){case"year":time=startOfDate(this.year(),0,1);break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3,1);break;case"month":time=startOfDate(this.year(),this.month(),1);break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date());break;case"hour":time=this._d.valueOf(),time-=mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":time=this._d.valueOf(),time-=mod$1(time,MS_PER_MINUTE);break;case"second":time=this._d.valueOf(),time-=mod$1(time,MS_PER_SECOND)}return this._d.setTime(time),hooks.updateOffset(this,!0),this}function endOf(units){var time,startOfDate;if(void 0===(units=normalizeUnits(units))||"millisecond"===units||!this.isValid())return this;switch(startOfDate=this._isUTC?utcStartOfDate:localStartOfDate,units){case"year":time=startOfDate(this.year()+1,0,1)-1;break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":time=startOfDate(this.year(),this.month()+1,1)-1;break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case"hour":time=this._d.valueOf(),time+=MS_PER_HOUR-mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":time=this._d.valueOf(),time+=MS_PER_MINUTE-mod$1(time,MS_PER_MINUTE)-1;break;case"second":time=this._d.valueOf(),time+=MS_PER_SECOND-mod$1(time,MS_PER_SECOND)-1}return this._d.setTime(time),hooks.updateOffset(this,!0),this}function valueOf(){return this._d.valueOf()-6e4*(this._offset||0)}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function localeEras(m,format){var i,l,date,eras=this._eras||getLocale("en")._eras;for(i=0,l=eras.length;i<l;++i)switch("string"==typeof eras[i].since&&(date=hooks(eras[i].since).startOf("day"),eras[i].since=date.valueOf()),typeof eras[i].until){case"undefined":eras[i].until=1/0;break;case"string":date=hooks(eras[i].until).startOf("day").valueOf(),eras[i].until=date.valueOf()}return eras}function localeErasParse(eraName,format,strict){var i,l,name,abbr,narrow,eras=this.eras();for(eraName=eraName.toUpperCase(),i=0,l=eras.length;i<l;++i)if(name=eras[i].name.toUpperCase(),abbr=eras[i].abbr.toUpperCase(),narrow=eras[i].narrow.toUpperCase(),strict)switch(format){case"N":case"NN":case"NNN":if(abbr===eraName)return eras[i];break;case"NNNN":if(name===eraName)return eras[i];break;case"NNNNN":if(narrow===eraName)return eras[i]}else if([name,abbr,narrow].indexOf(eraName)>=0)return eras[i]}function localeErasConvertYear(era,year){var dir=era.since<=era.until?1:-1;return void 0===year?hooks(era.since).year():hooks(era.since).year()+(year-era.offset)*dir}function getEraName(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].name;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].name}return""}function getEraNarrow(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].narrow;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].narrow}return""}function getEraAbbr(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].abbr;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].abbr}return""}function getEraYear(){var i,l,dir,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i)if(dir=eras[i].since<=eras[i].until?1:-1,val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until||eras[i].until<=val&&val<=eras[i].since)return(this.year()-hooks(eras[i].since).year())*dir+eras[i].offset;return this.year()}function erasNameRegex(isStrict){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),isStrict?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(isStrict){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),isStrict?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(isStrict){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),isStrict?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(isStrict,locale){return locale.erasAbbrRegex(isStrict)}function matchEraName(isStrict,locale){return locale.erasNameRegex(isStrict)}function matchEraNarrow(isStrict,locale){return locale.erasNarrowRegex(isStrict)}function matchEraYearOrdinal(isStrict,locale){return locale._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var i,l,erasName,erasAbbr,erasNarrow,abbrPieces=[],namePieces=[],narrowPieces=[],mixedPieces=[],eras=this.eras();for(i=0,l=eras.length;i<l;++i)erasName=regexEscape(eras[i].name),erasAbbr=regexEscape(eras[i].abbr),erasNarrow=regexEscape(eras[i].narrow),namePieces.push(erasName),abbrPieces.push(erasAbbr),narrowPieces.push(erasNarrow),mixedPieces.push(erasName),mixedPieces.push(erasAbbr),mixedPieces.push(erasNarrow);this._erasRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+namePieces.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+abbrPieces.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+narrowPieces.join("|")+")","i")}function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getWeeksInWeekYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.weekYear(),weekInfo.dow,weekInfo.doy)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;return null==input?weekOfYear(this,dow,doy).year:(week>(weeksTarget=weeksInYear(input,dow,doy))&&(week=weeksTarget),setWeekAll.call(this,input,week,weekday,dow,doy))}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);return this.year(date.getUTCFullYear()),this.month(date.getUTCMonth()),this.date(date.getUTCDate()),this}function getSetQuarter(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)}addFormatToken("N",0,0,"eraAbbr"),addFormatToken("NN",0,0,"eraAbbr"),addFormatToken("NNN",0,0,"eraAbbr"),addFormatToken("NNNN",0,0,"eraName"),addFormatToken("NNNNN",0,0,"eraNarrow"),addFormatToken("y",["y",1],"yo","eraYear"),addFormatToken("y",["yy",2],0,"eraYear"),addFormatToken("y",["yyy",3],0,"eraYear"),addFormatToken("y",["yyyy",4],0,"eraYear"),addRegexToken("N",matchEraAbbr),addRegexToken("NN",matchEraAbbr),addRegexToken("NNN",matchEraAbbr),addRegexToken("NNNN",matchEraName),addRegexToken("NNNNN",matchEraNarrow),addParseToken(["N","NN","NNN","NNNN","NNNNN"],(function(input,array,config,token){var era=config._locale.erasParse(input,token,config._strict);era?getParsingFlags(config).era=era:getParsingFlags(config).invalidEra=input})),addRegexToken("y",matchUnsigned),addRegexToken("yy",matchUnsigned),addRegexToken("yyy",matchUnsigned),addRegexToken("yyyy",matchUnsigned),addRegexToken("yo",matchEraYearOrdinal),addParseToken(["y","yy","yyy","yyyy"],YEAR),addParseToken(["yo"],(function(input,array,config,token){var match;config._locale._eraYearOrdinalRegex&&(match=input.match(config._locale._eraYearOrdinalRegex)),config._locale.eraYearOrdinalParse?array[YEAR]=config._locale.eraYearOrdinalParse(input,match):array[YEAR]=parseInt(input,10)})),addFormatToken(0,["gg",2],0,(function(){return this.weekYear()%100})),addFormatToken(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],(function(input,week,config,token){week[token.substr(0,2)]=toInt(input)})),addWeekParseToken(["gg","GG"],(function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)})),addFormatToken("Q",0,"Qo","quarter"),addRegexToken("Q",match1),addParseToken("Q",(function(input,array){array[MONTH]=3*(toInt(input)-1)})),addFormatToken("D",["DD",2],"Do","date"),addRegexToken("D",match1to2,match1to2NoLeadingZero),addRegexToken("DD",match1to2,match2),addRegexToken("Do",(function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient})),addParseToken(["D","DD"],DATE),addParseToken("Do",(function(input,array){array[DATE]=toInt(input.match(match1to2)[0])}));var getSetDayOfMonth=makeGetSet("Date",!0);function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")}addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],(function(input,array,config){config._dayOfYear=toInt(input)})),addFormatToken("m",["mm",2],0,"minute"),addRegexToken("m",match1to2,match1to2HasZero),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second"),addRegexToken("s",match1to2,match1to2HasZero),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var token,getSetMillisecond,getSetSecond=makeGetSet("Seconds",!1);for(addFormatToken("S",0,0,(function(){return~~(this.millisecond()/100)})),addFormatToken(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),addFormatToken(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),addFormatToken(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),addFormatToken(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),addFormatToken(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),addFormatToken(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3),token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(input,array){array[MILLISECOND]=toInt(1e3*("0."+input))}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}getSetMillisecond=makeGetSet("Milliseconds",!1),addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");var proto=Moment.prototype;function createUnix(input){return createLocal(1e3*input)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(string){return string}proto.add=add,proto.calendar=calendar$1,proto.clone=clone,proto.diff=diff,proto.endOf=endOf,proto.format=format,proto.from=from,proto.fromNow=fromNow,proto.to=to,proto.toNow=toNow,proto.get=stringGet,proto.invalidAt=invalidAt,proto.isAfter=isAfter,proto.isBefore=isBefore,proto.isBetween=isBetween,proto.isSame=isSame,proto.isSameOrAfter=isSameOrAfter,proto.isSameOrBefore=isSameOrBefore,proto.isValid=isValid$2,proto.lang=lang,proto.locale=locale,proto.localeData=localeData,proto.max=prototypeMax,proto.min=prototypeMin,proto.parsingFlags=parsingFlags,proto.set=stringSet,proto.startOf=startOf,proto.subtract=subtract,proto.toArray=toArray,proto.toObject=toObject,proto.toDate=toDate,proto.toISOString=toISOString,proto.inspect=inspect,"undefined"!=typeof Symbol&&null!=Symbol.for&&(proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),proto.toJSON=toJSON,proto.toString=toString,proto.unix=unix,proto.valueOf=valueOf,proto.creationData=creationData,proto.eraName=getEraName,proto.eraNarrow=getEraNarrow,proto.eraAbbr=getEraAbbr,proto.eraYear=getEraYear,proto.year=getSetYear,proto.isLeapYear=getIsLeapYear,proto.weekYear=getSetWeekYear,proto.isoWeekYear=getSetISOWeekYear,proto.quarter=proto.quarters=getSetQuarter,proto.month=getSetMonth,proto.daysInMonth=getDaysInMonth,proto.week=proto.weeks=getSetWeek,proto.isoWeek=proto.isoWeeks=getSetISOWeek,proto.weeksInYear=getWeeksInYear,proto.weeksInWeekYear=getWeeksInWeekYear,proto.isoWeeksInYear=getISOWeeksInYear,proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear,proto.date=getSetDayOfMonth,proto.day=proto.days=getSetDayOfWeek,proto.weekday=getSetLocaleDayOfWeek,proto.isoWeekday=getSetISODayOfWeek,proto.dayOfYear=getSetDayOfYear,proto.hour=proto.hours=getSetHour,proto.minute=proto.minutes=getSetMinute,proto.second=proto.seconds=getSetSecond,proto.millisecond=proto.milliseconds=getSetMillisecond,proto.utcOffset=getSetOffset,proto.utc=setOffsetToUTC,proto.local=setOffsetToLocal,proto.parseZone=setOffsetToParsedOffset,proto.hasAlignedHourOffset=hasAlignedHourOffset,proto.isDST=isDaylightSavingTime,proto.isLocal=isLocal,proto.isUtcOffset=isUtcOffset,proto.isUtc=isUtc,proto.isUTC=isUtc,proto.zoneAbbr=getZoneAbbr,proto.zoneName=getZoneName,proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone),proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);var proto$1=Locale.prototype;function get$1(format,index,field,setter){var locale=getLocale(),utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)&&(index=format,format=void 0),format=format||"",null!=index)return get$1(format,index,field,"month");var i,out=[];for(i=0;i<12;i++)out[i]=get$1(format,i,field,"month");return out}function listWeekdaysImpl(localeSorted,format,index,field){"boolean"==typeof localeSorted?(isNumber(format)&&(index=format,format=void 0),format=format||""):(index=format=localeSorted,localeSorted=!1,isNumber(format)&&(index=format,format=void 0),format=format||"");var i,locale=getLocale(),shift=localeSorted?locale._week.dow:0,out=[];if(null!=index)return get$1(format,(index+shift)%7,field,"day");for(i=0;i<7;i++)out[i]=get$1(format,(i+shift)%7,field,"day");return out}function listMonths(format,index){return listMonthsImpl(format,index,"months")}function listMonthsShort(format,index){return listMonthsImpl(format,index,"monthsShort")}function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")}function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")}function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")}proto$1.calendar=calendar,proto$1.longDateFormat=longDateFormat,proto$1.invalidDate=invalidDate,proto$1.ordinal=ordinal,proto$1.preparse=preParsePostFormat,proto$1.postformat=preParsePostFormat,proto$1.relativeTime=relativeTime,proto$1.pastFuture=pastFuture,proto$1.set=set,proto$1.eras=localeEras,proto$1.erasParse=localeErasParse,proto$1.erasConvertYear=localeErasConvertYear,proto$1.erasAbbrRegex=erasAbbrRegex,proto$1.erasNameRegex=erasNameRegex,proto$1.erasNarrowRegex=erasNarrowRegex,proto$1.months=localeMonths,proto$1.monthsShort=localeMonthsShort,proto$1.monthsParse=localeMonthsParse,proto$1.monthsRegex=monthsRegex,proto$1.monthsShortRegex=monthsShortRegex,proto$1.week=localeWeek,proto$1.firstDayOfYear=localeFirstDayOfYear,proto$1.firstDayOfWeek=localeFirstDayOfWeek,proto$1.weekdays=localeWeekdays,proto$1.weekdaysMin=localeWeekdaysMin,proto$1.weekdaysShort=localeWeekdaysShort,proto$1.weekdaysParse=localeWeekdaysParse,proto$1.weekdaysRegex=weekdaysRegex,proto$1.weekdaysShortRegex=weekdaysShortRegex,proto$1.weekdaysMinRegex=weekdaysMinRegex,proto$1.isPM=localeIsPM,proto$1.meridiem=localeMeridiem,getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10;return number+(1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale),hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),data.milliseconds=mathAbs(data.milliseconds),data.seconds=mathAbs(data.seconds),data.minutes=mathAbs(data.minutes),data.hours=mathAbs(data.hours),data.months=mathAbs(data.months),data.years=mathAbs(data.years),this}function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);return duration._milliseconds+=direction*other._milliseconds,duration._days+=direction*other._days,duration._months+=direction*other._months,duration._bubble()}function add$1(input,value){return addSubtract$1(this,input,value,1)}function subtract$1(input,value){return addSubtract$1(this,input,value,-1)}function absCeil(number){return number<0?Math.floor(number):Math.ceil(number)}function bubble(){var seconds,minutes,hours,years,monthsFromDays,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;return milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0||(milliseconds+=864e5*absCeil(monthsToDays(months)+days),days=0,months=0),data.milliseconds=milliseconds%1e3,seconds=absFloor(milliseconds/1e3),data.seconds=seconds%60,minutes=absFloor(seconds/60),data.minutes=minutes%60,hours=absFloor(minutes/60),data.hours=hours%24,days+=absFloor(hours/24),months+=monthsFromDays=absFloor(daysToMonths(days)),days-=absCeil(monthsToDays(monthsFromDays)),years=absFloor(months/12),months%=12,data.days=days,data.months=months,data.years=years,this}function daysToMonths(days){return 4800*days/146097}function monthsToDays(months){return 146097*months/4800}function as(units){if(!this.isValid())return NaN;var days,months,milliseconds=this._milliseconds;if("month"===(units=normalizeUnits(units))||"quarter"===units||"year"===units)switch(days=this._days+milliseconds/864e5,months=this._months+daysToMonths(days),units){case"month":return months;case"quarter":return months/3;case"year":return months/12}else switch(days=this._days+Math.round(monthsToDays(this._months)),units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return 24*days+milliseconds/36e5;case"minute":return 1440*days+milliseconds/6e4;case"second":return 86400*days+milliseconds/1e3;case"millisecond":return Math.floor(864e5*days)+milliseconds;default:throw new Error("Unknown unit "+units)}}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y"),valueOf$1=asMilliseconds;function clone$1(){return createDuration(this)}function get$2(units){return units=normalizeUnits(units),this.isValid()?this[units+"s"]():NaN}function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime$1(posNegDuration,withoutSuffix,thresholds,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),weeks=round(duration.as("w")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days];return null!=thresholds.w&&(a=a||weeks<=1&&["w"]||weeks<thresholds.w&&["ww",weeks]),(a=a||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years])[2]=withoutSuffix,a[3]=+posNegDuration>0,a[4]=locale,substituteTimeAgo.apply(null,a)}function getSetRelativeTimeRounding(roundingFunction){return void 0===roundingFunction?round:"function"==typeof roundingFunction&&(round=roundingFunction,!0)}function getSetRelativeTimeThreshold(threshold,limit){return void 0!==thresholds[threshold]&&(void 0===limit?thresholds[threshold]:(thresholds[threshold]=limit,"s"===threshold&&(thresholds.ss=limit-1),!0))}function humanize(argWithSuffix,argThresholds){if(!this.isValid())return this.localeData().invalidDate();var locale,output,withSuffix=!1,th=thresholds;return"object"==typeof argWithSuffix&&(argThresholds=argWithSuffix,argWithSuffix=!1),"boolean"==typeof argWithSuffix&&(withSuffix=argWithSuffix),"object"==typeof argThresholds&&(th=Object.assign({},thresholds,argThresholds),null!=argThresholds.s&&null==argThresholds.ss&&(th.ss=argThresholds.s-1)),output=relativeTime$1(this,!withSuffix,th,locale=this.localeData()),withSuffix&&(output=locale.pastFuture(+this,output)),locale.postformat(output)}var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var minutes,hours,years,s,totalSign,ymSign,daysSign,hmsSign,seconds=abs$1(this._milliseconds)/1e3,days=abs$1(this._days),months=abs$1(this._months),total=this.asSeconds();return total?(minutes=absFloor(seconds/60),hours=absFloor(minutes/60),seconds%=60,minutes%=60,years=absFloor(months/12),months%=12,s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"",totalSign=total<0?"-":"",ymSign=sign(this._months)!==sign(total)?"-":"",daysSign=sign(this._days)!==sign(total)?"-":"",hmsSign=sign(this._milliseconds)!==sign(total)?"-":"",totalSign+"P"+(years?ymSign+years+"Y":"")+(months?ymSign+months+"M":"")+(days?daysSign+days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hmsSign+hours+"H":"")+(minutes?hmsSign+minutes+"M":"")+(seconds?hmsSign+s+"S":"")):"P0D"}var proto$2=Duration.prototype;return proto$2.isValid=isValid$1,proto$2.abs=abs,proto$2.add=add$1,proto$2.subtract=subtract$1,proto$2.as=as,proto$2.asMilliseconds=asMilliseconds,proto$2.asSeconds=asSeconds,proto$2.asMinutes=asMinutes,proto$2.asHours=asHours,proto$2.asDays=asDays,proto$2.asWeeks=asWeeks,proto$2.asMonths=asMonths,proto$2.asQuarters=asQuarters,proto$2.asYears=asYears,proto$2.valueOf=valueOf$1,proto$2._bubble=bubble,proto$2.clone=clone$1,proto$2.get=get$2,proto$2.milliseconds=milliseconds,proto$2.seconds=seconds,proto$2.minutes=minutes,proto$2.hours=hours,proto$2.days=days,proto$2.weeks=weeks,proto$2.months=months,proto$2.years=years,proto$2.humanize=humanize,proto$2.toISOString=toISOString$1,proto$2.toString=toISOString$1,proto$2.toJSON=toISOString$1,proto$2.locale=locale,proto$2.localeData=localeData,proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1),proto$2.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",matchTimestamp),addParseToken("X",(function(input,array,config){config._d=new Date(1e3*parseFloat(input))})),addParseToken("x",(function(input,array,config){config._d=new Date(toInt(input))})),hooks.version="2.30.1",setHookCallback(createLocal),hooks.fn=proto,hooks.min=min,hooks.max=max,hooks.now=now,hooks.utc=createUTC,hooks.unix=createUnix,hooks.months=listMonths,hooks.isDate=isDate,hooks.locale=getSetGlobalLocale,hooks.invalid=createInvalid,hooks.duration=createDuration,hooks.isMoment=isMoment,hooks.weekdays=listWeekdays,hooks.parseZone=createInZone,hooks.localeData=getLocale,hooks.isDuration=isDuration,hooks.monthsShort=listMonthsShort,hooks.weekdaysMin=listWeekdaysMin,hooks.defineLocale=defineLocale,hooks.updateLocale=updateLocale,hooks.locales=listLocales,hooks.weekdaysShort=listWeekdaysShort,hooks.normalizeUnits=normalizeUnits,hooks.relativeTimeRounding=getSetRelativeTimeRounding,hooks.relativeTimeThreshold=getSetRelativeTimeThreshold,hooks.calendarFormat=getCalendarFormat,hooks.prototype=proto,hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},hooks}()},"./node_modules/react-dom/cjs/react-dom.production.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var React=__webpack_require__("./node_modules/react/index.js");function formatProdErrorMessage(code){var url="https://react.dev/errors/"+code;if(1<arguments.length){url+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)url+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+code+"; visit "+url+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function noop(){}var Internals={d:{f:noop,r:function(){throw Error(formatProdErrorMessage(522))},D:noop,C:noop,L:noop,m:noop,X:noop,S:noop,M:noop},p:0,findDOMNode:null},REACT_PORTAL_TYPE=Symbol.for("react.portal");var ReactSharedInternals=React.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function getCrossOriginStringAs(as,input){return"font"===as?"":"string"==typeof input?"use-credentials"===input?input:"":void 0}exports.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Internals,exports.createPortal=function(children,container){var key=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!container||1!==container.nodeType&&9!==container.nodeType&&11!==container.nodeType)throw Error(formatProdErrorMessage(299));return function createPortal$1(children,containerInfo,implementation){var key=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:REACT_PORTAL_TYPE,key:null==key?null:""+key,children,containerInfo,implementation}}(children,container,null,key)},exports.flushSync=function(fn){var previousTransition=ReactSharedInternals.T,previousUpdatePriority=Internals.p;try{if(ReactSharedInternals.T=null,Internals.p=2,fn)return fn()}finally{ReactSharedInternals.T=previousTransition,Internals.p=previousUpdatePriority,Internals.d.f()}},exports.preconnect=function(href,options){"string"==typeof href&&(options?options="string"==typeof(options=options.crossOrigin)?"use-credentials"===options?options:"":void 0:options=null,Internals.d.C(href,options))},exports.prefetchDNS=function(href){"string"==typeof href&&Internals.d.D(href)},exports.preinit=function(href,options){if("string"==typeof href&&options&&"string"==typeof options.as){var as=options.as,crossOrigin=getCrossOriginStringAs(as,options.crossOrigin),integrity="string"==typeof options.integrity?options.integrity:void 0,fetchPriority="string"==typeof options.fetchPriority?options.fetchPriority:void 0;"style"===as?Internals.d.S(href,"string"==typeof options.precedence?options.precedence:void 0,{crossOrigin,integrity,fetchPriority}):"script"===as&&Internals.d.X(href,{crossOrigin,integrity,fetchPriority,nonce:"string"==typeof options.nonce?options.nonce:void 0})}},exports.preinitModule=function(href,options){if("string"==typeof href)if("object"==typeof options&&null!==options){if(null==options.as||"script"===options.as){var crossOrigin=getCrossOriginStringAs(options.as,options.crossOrigin);Internals.d.M(href,{crossOrigin,integrity:"string"==typeof options.integrity?options.integrity:void 0,nonce:"string"==typeof options.nonce?options.nonce:void 0})}}else null==options&&Internals.d.M(href)},exports.preload=function(href,options){if("string"==typeof href&&"object"==typeof options&&null!==options&&"string"==typeof options.as){var as=options.as,crossOrigin=getCrossOriginStringAs(as,options.crossOrigin);Internals.d.L(href,as,{crossOrigin,integrity:"string"==typeof options.integrity?options.integrity:void 0,nonce:"string"==typeof options.nonce?options.nonce:void 0,type:"string"==typeof options.type?options.type:void 0,fetchPriority:"string"==typeof options.fetchPriority?options.fetchPriority:void 0,referrerPolicy:"string"==typeof options.referrerPolicy?options.referrerPolicy:void 0,imageSrcSet:"string"==typeof options.imageSrcSet?options.imageSrcSet:void 0,imageSizes:"string"==typeof options.imageSizes?options.imageSizes:void 0,media:"string"==typeof options.media?options.media:void 0})}},exports.preloadModule=function(href,options){if("string"==typeof href)if(options){var crossOrigin=getCrossOriginStringAs(options.as,options.crossOrigin);Internals.d.m(href,{as:"string"==typeof options.as&&"script"!==options.as?options.as:void 0,crossOrigin,integrity:"string"==typeof options.integrity?options.integrity:void 0})}else Internals.d.m(href)},exports.requestFormReset=function(form){Internals.d.r(form)},exports.unstable_batchedUpdates=function(fn,a){return fn(a)},exports.useFormState=function(action,initialState,permalink){return ReactSharedInternals.H.useFormState(action,initialState,permalink)},exports.useFormStatus=function(){return ReactSharedInternals.H.useHostTransitionStatus()},exports.version="19.1.0"},"./node_modules/react-dom/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";!function checkDCE(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(err){console.error(err)}}(),module.exports=__webpack_require__("./node_modules/react-dom/cjs/react-dom.production.js")}}]);
//# sourceMappingURL=8558.38f90a7d.iframe.bundle.js.map