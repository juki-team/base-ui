"use strict";(self.webpackChunk_juki_team_base_ui=self.webpackChunk_juki_team_base_ui||[]).push([[985],{"./src/components/organisms/ImageUploader/ImageUploaderModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ImageUploaderModal:()=>ImageUploaderModal});var react=__webpack_require__("./node_modules/react/index.js"),atoms=__webpack_require__("./src/components/atoms/index.tsx"),molecules=__webpack_require__("./src/components/molecules/index.tsx"),server=__webpack_require__("./src/components/server/index.ts"),settings=__webpack_require__("./src/settings/index.ts"),helpers=__webpack_require__("./src/helpers/index.ts"),hooks=__webpack_require__("./src/hooks/index.ts"),types=__webpack_require__("./src/types/index.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const PublicImages=props=>{const{copyButtons,onPickImageUrl,publicImages}=props,{addNotification}=(0,hooks.Eq)();return(0,jsx_runtime.jsx)("div",{className:"public-images-tab jk-row",children:publicImages.map(((publicImage,index)=>(0,jsx_runtime.jsxs)("div",{className:"thumbnail",children:[(0,jsx_runtime.jsx)("img",{src:publicImage.imageThumbnailUrl+`?v=${(new Date).getTime()}`,alt:"image "+index}),(0,jsx_runtime.jsx)(molecules.GK,{actionButtons:[...copyButtons?[{icon:(0,jsx_runtime.jsx)(server.c8I,{}),buttons:[{icon:(0,jsx_runtime.jsx)(server.c8I,{size:"small"}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"URL"}),onClick:()=>{(0,helpers.C)(publicImage.imageUrl),addNotification({type:types.NotificationType.QUIET,message:(0,jsx_runtime.jsx)(atoms.T,{children:"copied"})})}},{icon:(0,jsx_runtime.jsx)(server.c8I,{}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"MD"}),onClick:()=>{(0,helpers.C)(`![image alt](${publicImage.imageUrl})`),addNotification({type:types.NotificationType.QUIET,message:(0,jsx_runtime.jsx)(atoms.T,{children:"copied"})})}}]}]:[],...onPickImageUrl?[{icon:(0,jsx_runtime.jsx)(server.Srz,{}),buttons:[{icon:(0,jsx_runtime.jsx)(server.Srz,{size:"small"}),label:(0,jsx_runtime.jsx)(atoms.T,{children:"pick"}),onClick:()=>{onPickImageUrl(publicImage),addNotification({type:types.NotificationType.QUIET,message:(0,jsx_runtime.jsx)(atoms.T,{children:"picked"})})}}]}]:[]]})]},publicImage.imageUrl)))})};try{PublicImages.displayName="PublicImages",PublicImages.__docgenInfo={description:"",displayName:"PublicImages",props:{copyButtons:{defaultValue:null,description:"",name:"copyButtons",required:!1,type:{name:"boolean"}},onPickImageUrl:{defaultValue:null,description:"",name:"onPickImageUrl",required:!1,type:{name:"onPickImageUrlType"}},publicImages:{defaultValue:null,description:"",name:"publicImages",required:!0,type:{name:"ImageSummaryResponseDTO[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/ImageUploader/ImageUploaderModal/PublicImagesTab/PublicImages.tsx#PublicImages"]={docgenInfo:PublicImages.__docgenInfo,name:"PublicImages",path:"src/components/organisms/ImageUploader/ImageUploaderModal/PublicImagesTab/PublicImages.tsx#PublicImages"})}catch(__react_docgen_typescript_loader_error){}const PublicImagesTab=props=>(0,jsx_runtime.jsx)(molecules.pW,{url:settings.u.API_V1.image.getPublicList().url,triggerFetch:props.trigger,children:_ref=>{let{data:{contents},mutate}=_ref;return(0,jsx_runtime.jsx)(PublicImages,{publicImages:contents,copyButtons:props.copyButtons,onPickImageUrl:props.onPickImageUrl})}});try{PublicImagesTab.displayName="PublicImagesTab",PublicImagesTab.__docgenInfo={description:"",displayName:"PublicImagesTab",props:{trigger:{defaultValue:null,description:"",name:"trigger",required:!0,type:{name:"number"}},copyButtons:{defaultValue:null,description:"",name:"copyButtons",required:!1,type:{name:"boolean"}},onPickImageUrl:{defaultValue:null,description:"",name:"onPickImageUrl",required:!1,type:{name:"onPickImageUrlType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/ImageUploader/ImageUploaderModal/PublicImagesTab/index.tsx#PublicImagesTab"]={docgenInfo:PublicImagesTab.__docgenInfo,name:"PublicImagesTab",path:"src/components/organisms/ImageUploader/ImageUploaderModal/PublicImagesTab/index.tsx#PublicImagesTab"})}catch(__react_docgen_typescript_loader_error){}var esm=__webpack_require__("./node_modules/@juki-team/commons/dist/esm/index.js");const UploadNewImageTab=(0,react.memo)((_ref=>{let{copyButtons,onPickImageUrl,onUploadedImage}=_ref;const[imagePublicUrl,setImagePublicUrl]=(0,react.useState)(""),[cropImage,setCropImage]=(0,react.useState)(),[isPublic,setIsPublic]=(0,react.useState)(!1),{addNotification}=(0,hooks.Eq)();return(0,jsx_runtime.jsxs)("div",{className:"upload-new-image-tab jk-col top gap",children:[imagePublicUrl&&(0,jsx_runtime.jsxs)("div",{className:"jk-col left",children:[copyButtons&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"jk-row gap left fw-bd",children:[(0,jsx_runtime.jsx)(atoms.T,{children:"public url"}),":",(0,jsx_runtime.jsxs)("div",{className:"copyable jk-row",children:[(0,jsx_runtime.jsx)("a",{href:imagePublicUrl,className:"link",target:"_blank",rel:"noreferrer",children:imagePublicUrl}),(0,jsx_runtime.jsx)(atoms.$r,{text:imagePublicUrl,size:"small"})]})]}),(0,jsx_runtime.jsxs)("div",{className:"jk-row gap left fw-bd",children:[(0,jsx_runtime.jsx)(atoms.T,{children:"markdown use"}),":",(0,jsx_runtime.jsxs)("div",{className:"copyable jk-row",children:[(0,jsx_runtime.jsxs)("span",{className:"tx-t fw-bd",children:["![image alt](",imagePublicUrl,")"]}),(0,jsx_runtime.jsx)(atoms.$r,{text:`![image alt](${imagePublicUrl})`,size:"small"})]})]})]}),onPickImageUrl&&(0,jsx_runtime.jsx)(atoms.$n,{onClick:()=>onPickImageUrl({imageUrl:imagePublicUrl,imageThumbnailUrl:imagePublicUrl.replace("https://images.juki.pub/o/","https://images.juki.pub/t/")}),size:"small",expand:!0,children:(0,jsx_runtime.jsx)(atoms.T,{children:"pick"})})]}),(0,jsx_runtime.jsx)(atoms.GL,{checked:isPublic,label:isPublic?(0,jsx_runtime.jsx)(atoms.T,{children:"public"}):(0,jsx_runtime.jsx)(atoms.T,{children:"not public"}),onChange:setIsPublic}),(0,jsx_runtime.jsx)(molecules.mT,{onClick:async setLoader=>{if(null!=cropImage&&cropImage.previewCanvasRef.current){const blob=await(0,helpers.ZR)(cropImage.previewCanvasRef.current);if(blob){null==setLoader||setLoader(esm.nW6.LOADING);const{status,message,content}=await(0,helpers.XO)(blob,isPublic);status===esm.nW6.SUCCESS?(addNotification({type:types.NotificationType.SUCCESS,message:(0,jsx_runtime.jsx)(atoms.T,{children:message})}),null==setLoader||setLoader(esm.nW6.SUCCESS),setImagePublicUrl(content.imageUrl),onUploadedImage()):(addNotification({type:types.NotificationType.ERROR,message:(0,jsx_runtime.jsx)(atoms.T,{children:message})}),null==setLoader||setLoader(esm.nW6.ERROR))}}},disabled:!cropImage||!(null!=cropImage&&cropImage.previewCanvasRef.current),size:"small",children:(0,jsx_runtime.jsx)(atoms.T,{children:"upload image"})}),(0,jsx_runtime.jsx)(molecules.MI,{onCropChange:setCropImage,withAspect:!0,withRotate:!0,withScale:!0})]})}));try{UploadNewImageTab.displayName="UploadNewImageTab",UploadNewImageTab.__docgenInfo={description:"",displayName:"UploadNewImageTab",props:{copyButtons:{defaultValue:null,description:"",name:"copyButtons",required:!1,type:{name:"boolean"}},onPickImageUrl:{defaultValue:null,description:"",name:"onPickImageUrl",required:!1,type:{name:"onPickImageUrlType"}},onUploadedImage:{defaultValue:null,description:"",name:"onUploadedImage",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/ImageUploader/ImageUploaderModal/UploadNewImageTab/index.tsx#UploadNewImageTab"]={docgenInfo:UploadNewImageTab.__docgenInfo,name:"UploadNewImageTab",path:"src/components/organisms/ImageUploader/ImageUploaderModal/UploadNewImageTab/index.tsx#UploadNewImageTab"})}catch(__react_docgen_typescript_loader_error){}const ImageUploaderModal=props=>{const{isOpen,onClose,withPublicImagesTab=!0,copyButtons,onPickImageUrl}=props,[count,setCount]=(0,react.useState)(0),tabHeaders=[];return withPublicImagesTab&&tabHeaders.push({key:"public-images",header:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"public images"}),(0,jsx_runtime.jsx)(atoms.$n,{icon:(0,jsx_runtime.jsx)(server.fNY,{}),size:"small",type:"light",onClick:()=>setCount(count+1)})]}),body:(0,jsx_runtime.jsx)(PublicImagesTab,{trigger:count,copyButtons,onPickImageUrl},"public-images-tab")}),tabHeaders.push({key:"upload-new-image",header:(0,jsx_runtime.jsx)(atoms.T,{className:"tt-se",children:"upload new image"}),body:(0,jsx_runtime.jsx)(UploadNewImageTab,{copyButtons,onPickImageUrl,onUploadedImage:()=>setCount(count+1)},"upload-new-image-tab")}),(0,jsx_runtime.jsx)(atoms.aF,{isOpen,onClose,className:"modal-upload-image",children:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(molecules.tU,{tabs:tabHeaders})})})};try{ImageUploaderModal.displayName="ImageUploaderModal",ImageUploaderModal.__docgenInfo={description:"",displayName:"ImageUploaderModal",props:{withPublicImagesTab:{defaultValue:null,description:"",name:"withPublicImagesTab",required:!1,type:{name:"boolean"}},copyButtons:{defaultValue:null,description:"",name:"copyButtons",required:!1,type:{name:"boolean"}},onPickImageUrl:{defaultValue:null,description:"",name:"onPickImageUrl",required:!1,type:{name:"onPickImageUrlType"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},containerClassName:{defaultValue:null,description:"",name:"containerClassName",required:!1,type:{name:"string"}},closeIcon:{defaultValue:null,description:"",name:"closeIcon",required:!1,type:{name:"boolean"}},expand:{defaultValue:null,description:"",name:"expand",required:!1,type:{name:"boolean"}},closeOnKeyEscape:{defaultValue:null,description:"",name:"closeOnKeyEscape",required:!1,type:{name:"boolean"}},closeOnClickOverlay:{defaultValue:null,description:"",name:"closeOnClickOverlay",required:!1,type:{name:"boolean"}},setLoaderStatusRef:{defaultValue:null,description:"",name:"setLoaderStatusRef",required:!1,type:{name:"((setLoader: SetLoaderStatusOnClickType) => void)"}},onLoaderStatusChange:{defaultValue:null,description:"",name:"onLoaderStatusChange",required:!1,type:{name:"((status: Status) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/organisms/ImageUploader/ImageUploaderModal.tsx#ImageUploaderModal"]={docgenInfo:ImageUploaderModal.__docgenInfo,name:"ImageUploaderModal",path:"src/components/organisms/ImageUploader/ImageUploaderModal.tsx#ImageUploaderModal"})}catch(__react_docgen_typescript_loader_error){}}}]);