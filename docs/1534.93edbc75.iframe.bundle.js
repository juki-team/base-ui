/*! For license information please see 1534.93edbc75.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_juki_team_base_ui=self.webpackChunk_juki_team_base_ui||[]).push([[1534],{"./node_modules/@codemirror/language-data/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{e:()=>languages});var _codemirror_language__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@codemirror/language/dist/index.js");function legacy(parser){return new _codemirror_language__WEBPACK_IMPORTED_MODULE_0__.Yy(_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.Tg.define(parser))}function sql(dialectName){return Promise.all([__webpack_require__.e(7421),__webpack_require__.e(6492)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-sql/dist/index.js")).then(m=>m.sql({dialect:m[dialectName]}))}const languages=[_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"C",extensions:["c","h","ino"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(1494)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-cpp/dist/index.js")).then(m=>m.cpp())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"C++",alias:["cpp"],extensions:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(1494)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-cpp/dist/index.js")).then(m=>m.cpp())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"CQL",alias:["cassandra"],extensions:["cql"],load:()=>sql("Cassandra")}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"CSS",extensions:["css"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-css/dist/index.js")).then(m=>m.css())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Go",extensions:["go"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(931)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-go/dist/index.js")).then(m=>m.go())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"HTML",alias:["xhtml"],extensions:["html","htm","handlebars","hbs"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(5985),__webpack_require__.e(7154)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-html/dist/index.js")).then(m=>m.html())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Java",extensions:["java"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(6645)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-java/dist/index.js")).then(m=>m.java())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"JavaScript",alias:["ecmascript","js","node"],extensions:["js","mjs","cjs"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(5985)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-javascript/dist/index.js")).then(m=>m.javascript())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"JSON",alias:["json5"],extensions:["json","map"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(1250)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-json/dist/index.js")).then(m=>m.json())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"JSX",extensions:["jsx"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(5985)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-javascript/dist/index.js")).then(m=>m.javascript({jsx:!0}))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"LESS",extensions:["less"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(6085)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-less/dist/index.js")).then(m=>m.less())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Liquid",extensions:["liquid"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(5985),__webpack_require__.e(7154),__webpack_require__.e(4474)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-liquid/dist/index.js")).then(m=>m.liquid())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"MariaDB SQL",load:()=>sql("MariaSQL")}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Markdown",extensions:["md","markdown","mkd"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(5985),__webpack_require__.e(7154),__webpack_require__.e(2047)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-markdown/dist/index.js")).then(m=>m.markdown())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"MS SQL",load:()=>sql("MSSQL")}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"MySQL",load:()=>sql("MySQL")}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"PHP",extensions:["php","php3","php4","php5","php7","phtml"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(5985),__webpack_require__.e(7154),__webpack_require__.e(8444)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-php/dist/index.js")).then(m=>m.php())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"PLSQL",extensions:["pls"],load:()=>sql("PLSQL")}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"PostgreSQL",load:()=>sql("PostgreSQL")}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Python",extensions:["BUILD","bzl","py","pyw"],filename:/^(BUCK|BUILD)$/,load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(4833)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-python/dist/index.js")).then(m=>m.python())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Rust",extensions:["rs"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(1475)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-rust/dist/index.js")).then(m=>m.rust())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Sass",extensions:["sass"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(7901)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-sass/dist/index.js")).then(m=>m.sass({indented:!0}))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"SCSS",extensions:["scss"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(7901)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-sass/dist/index.js")).then(m=>m.sass())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"SQL",extensions:["sql"],load:()=>sql("StandardSQL")}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"SQLite",load:()=>sql("SQLite")}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"TSX",extensions:["tsx"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(5985)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-javascript/dist/index.js")).then(m=>m.javascript({jsx:!0,typescript:!0}))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"TypeScript",alias:["ts"],extensions:["ts","mts","cts"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(5985)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-javascript/dist/index.js")).then(m=>m.javascript({typescript:!0}))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"WebAssembly",extensions:["wat","wast"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(6095)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-wast/dist/index.js")).then(m=>m.wast())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"XML",alias:["rss","wsdl","xsd"],extensions:["xml","xsl","xsd","svg"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(3195)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-xml/dist/index.js")).then(m=>m.xml())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"YAML",alias:["yml"],extensions:["yaml","yml"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(8448)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-yaml/dist/index.js")).then(m=>m.yaml())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"APL",extensions:["dyalog","apl"],load:()=>__webpack_require__.e(5085).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/apl.js")).then(m=>legacy(m.apl))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"PGP",alias:["asciiarmor"],extensions:["asc","pgp","sig"],load:()=>__webpack_require__.e(1834).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/asciiarmor.js")).then(m=>legacy(m.asciiArmor))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"ASN.1",extensions:["asn","asn1"],load:()=>__webpack_require__.e(5929).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/asn1.js")).then(m=>legacy(m.asn1({})))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Asterisk",filename:/^extensions\.conf$/i,load:()=>__webpack_require__.e(1436).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/asterisk.js")).then(m=>legacy(m.asterisk))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Brainfuck",extensions:["b","bf"],load:()=>__webpack_require__.e(1737).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/brainfuck.js")).then(m=>legacy(m.brainfuck))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Cobol",extensions:["cob","cpy"],load:()=>__webpack_require__.e(8217).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/cobol.js")).then(m=>legacy(m.cobol))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"C#",alias:["csharp","cs"],extensions:["cs"],load:()=>__webpack_require__.e(4528).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clike.js")).then(m=>legacy(m.csharp))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Clojure",extensions:["clj","cljc","cljx"],load:()=>__webpack_require__.e(3974).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clojure.js")).then(m=>legacy(m.clojure))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"ClojureScript",extensions:["cljs"],load:()=>__webpack_require__.e(3974).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clojure.js")).then(m=>legacy(m.clojure))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Closure Stylesheets (GSS)",extensions:["gss"],load:()=>__webpack_require__.e(9137).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/css.js")).then(m=>legacy(m.gss))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"CMake",extensions:["cmake","cmake.in"],filename:/^CMakeLists\.txt$/,load:()=>__webpack_require__.e(5317).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/cmake.js")).then(m=>legacy(m.cmake))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"CoffeeScript",alias:["coffee","coffee-script"],extensions:["coffee"],load:()=>__webpack_require__.e(2823).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/coffeescript.js")).then(m=>legacy(m.coffeeScript))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Common Lisp",alias:["lisp"],extensions:["cl","lisp","el"],load:()=>__webpack_require__.e(4797).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/commonlisp.js")).then(m=>legacy(m.commonLisp))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Cypher",extensions:["cyp","cypher"],load:()=>__webpack_require__.e(9023).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/cypher.js")).then(m=>legacy(m.cypher))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Cython",extensions:["pyx","pxd","pxi"],load:()=>__webpack_require__.e(8830).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/python.js")).then(m=>legacy(m.cython))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Crystal",extensions:["cr"],load:()=>__webpack_require__.e(3372).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/crystal.js")).then(m=>legacy(m.crystal))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"D",extensions:["d"],load:()=>__webpack_require__.e(5318).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/d.js")).then(m=>legacy(m.d))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Dart",extensions:["dart"],load:()=>__webpack_require__.e(4528).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clike.js")).then(m=>legacy(m.dart))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"diff",extensions:["diff","patch"],load:()=>__webpack_require__.e(1991).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/diff.js")).then(m=>legacy(m.diff))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Dockerfile",filename:/^Dockerfile$/,load:()=>__webpack_require__.e(2574).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/dockerfile.js")).then(m=>legacy(m.dockerFile))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"DTD",extensions:["dtd"],load:()=>__webpack_require__.e(246).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/dtd.js")).then(m=>legacy(m.dtd))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Dylan",extensions:["dylan","dyl","intr"],load:()=>__webpack_require__.e(4076).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/dylan.js")).then(m=>legacy(m.dylan))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"EBNF",load:()=>__webpack_require__.e(7587).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/ebnf.js")).then(m=>legacy(m.ebnf))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"ECL",extensions:["ecl"],load:()=>__webpack_require__.e(6294).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/ecl.js")).then(m=>legacy(m.ecl))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"edn",extensions:["edn"],load:()=>__webpack_require__.e(3974).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clojure.js")).then(m=>legacy(m.clojure))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Eiffel",extensions:["e"],load:()=>__webpack_require__.e(1887).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/eiffel.js")).then(m=>legacy(m.eiffel))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Elm",extensions:["elm"],load:()=>__webpack_require__.e(7318).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/elm.js")).then(m=>legacy(m.elm))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Erlang",extensions:["erl"],load:()=>__webpack_require__.e(867).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/erlang.js")).then(m=>legacy(m.erlang))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Esper",load:()=>__webpack_require__.e(5566).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/sql.js")).then(m=>legacy(m.esper))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Factor",extensions:["factor"],load:()=>__webpack_require__.e(5211).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/factor.js")).then(m=>legacy(m.factor))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"FCL",load:()=>__webpack_require__.e(6831).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/fcl.js")).then(m=>legacy(m.fcl))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Forth",extensions:["forth","fth","4th"],load:()=>__webpack_require__.e(6941).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/forth.js")).then(m=>legacy(m.forth))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Fortran",extensions:["f","for","f77","f90","f95"],load:()=>__webpack_require__.e(4408).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/fortran.js")).then(m=>legacy(m.fortran))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"F#",alias:["fsharp"],extensions:["fs"],load:()=>__webpack_require__.e(1954).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mllike.js")).then(m=>legacy(m.fSharp))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Gas",extensions:["s"],load:()=>__webpack_require__.e(9123).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/gas.js")).then(m=>legacy(m.gas))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Gherkin",extensions:["feature"],load:()=>__webpack_require__.e(6060).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/gherkin.js")).then(m=>legacy(m.gherkin))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Groovy",extensions:["groovy","gradle"],filename:/^Jenkinsfile$/,load:()=>__webpack_require__.e(874).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/groovy.js")).then(m=>legacy(m.groovy))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Haskell",extensions:["hs"],load:()=>__webpack_require__.e(1986).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/haskell.js")).then(m=>legacy(m.haskell))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Haxe",extensions:["hx"],load:()=>__webpack_require__.e(6412).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/haxe.js")).then(m=>legacy(m.haxe))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"HXML",extensions:["hxml"],load:()=>__webpack_require__.e(6412).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/haxe.js")).then(m=>legacy(m.hxml))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"HTTP",load:()=>__webpack_require__.e(3112).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/http.js")).then(m=>legacy(m.http))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"IDL",extensions:["pro"],load:()=>__webpack_require__.e(7769).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/idl.js")).then(m=>legacy(m.idl))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"JSON-LD",alias:["jsonld"],extensions:["jsonld"],load:()=>__webpack_require__.e(5987).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/javascript.js")).then(m=>legacy(m.jsonld))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Jinja2",extensions:["j2","jinja","jinja2"],load:()=>__webpack_require__.e(7694).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/jinja2.js")).then(m=>legacy(m.jinja2))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Julia",extensions:["jl"],load:()=>__webpack_require__.e(7575).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/julia.js")).then(m=>legacy(m.julia))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Kotlin",extensions:["kt","kts"],load:()=>__webpack_require__.e(4528).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clike.js")).then(m=>legacy(m.kotlin))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"LiveScript",alias:["ls"],extensions:["ls"],load:()=>__webpack_require__.e(7881).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/livescript.js")).then(m=>legacy(m.liveScript))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Lua",extensions:["lua"],load:()=>__webpack_require__.e(1960).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/lua.js")).then(m=>legacy(m.lua))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"mIRC",extensions:["mrc"],load:()=>__webpack_require__.e(1449).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mirc.js")).then(m=>legacy(m.mirc))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Mathematica",extensions:["m","nb","wl","wls"],load:()=>__webpack_require__.e(5862).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mathematica.js")).then(m=>legacy(m.mathematica))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Modelica",extensions:["mo"],load:()=>__webpack_require__.e(3832).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/modelica.js")).then(m=>legacy(m.modelica))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"MUMPS",extensions:["mps"],load:()=>__webpack_require__.e(2658).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mumps.js")).then(m=>legacy(m.mumps))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Mbox",extensions:["mbox"],load:()=>__webpack_require__.e(4068).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mbox.js")).then(m=>legacy(m.mbox))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Nginx",filename:/nginx.*\.conf$/i,load:()=>__webpack_require__.e(8326).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/nginx.js")).then(m=>legacy(m.nginx))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"NSIS",extensions:["nsh","nsi"],load:()=>__webpack_require__.e(339).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/nsis.js")).then(m=>legacy(m.nsis))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"NTriples",extensions:["nt","nq"],load:()=>__webpack_require__.e(5847).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/ntriples.js")).then(m=>legacy(m.ntriples))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Objective-C",alias:["objective-c","objc"],extensions:["m"],load:()=>__webpack_require__.e(4528).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clike.js")).then(m=>legacy(m.objectiveC))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Objective-C++",alias:["objective-c++","objc++"],extensions:["mm"],load:()=>__webpack_require__.e(4528).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clike.js")).then(m=>legacy(m.objectiveCpp))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"OCaml",extensions:["ml","mli","mll","mly"],load:()=>__webpack_require__.e(1954).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mllike.js")).then(m=>legacy(m.oCaml))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Octave",extensions:["m"],load:()=>__webpack_require__.e(7260).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/octave.js")).then(m=>legacy(m.octave))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Oz",extensions:["oz"],load:()=>__webpack_require__.e(7445).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/oz.js")).then(m=>legacy(m.oz))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Pascal",extensions:["p","pas"],load:()=>__webpack_require__.e(8232).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/pascal.js")).then(m=>legacy(m.pascal))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Perl",extensions:["pl","pm"],load:()=>__webpack_require__.e(3709).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/perl.js")).then(m=>legacy(m.perl))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Pig",extensions:["pig"],load:()=>__webpack_require__.e(4486).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/pig.js")).then(m=>legacy(m.pig))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"PowerShell",extensions:["ps1","psd1","psm1"],load:()=>__webpack_require__.e(6145).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/powershell.js")).then(m=>legacy(m.powerShell))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Properties files",alias:["ini","properties"],extensions:["properties","ini","in"],load:()=>__webpack_require__.e(9517).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/properties.js")).then(m=>legacy(m.properties))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"ProtoBuf",extensions:["proto"],load:()=>__webpack_require__.e(3303).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/protobuf.js")).then(m=>legacy(m.protobuf))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Pug",alias:["jade"],extensions:["pug","jade"],load:()=>__webpack_require__.e(6170).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/pug.js")).then(m=>legacy(m.pug))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Puppet",extensions:["pp"],load:()=>__webpack_require__.e(4878).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/puppet.js")).then(m=>legacy(m.puppet))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Q",extensions:["q"],load:()=>__webpack_require__.e(89).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/q.js")).then(m=>legacy(m.q))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"R",alias:["rscript"],extensions:["r","R"],load:()=>__webpack_require__.e(7136).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/r.js")).then(m=>legacy(m.r))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"RPM Changes",load:()=>__webpack_require__.e(4323).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/rpm.js")).then(m=>legacy(m.rpmChanges))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"RPM Spec",extensions:["spec"],load:()=>__webpack_require__.e(4323).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/rpm.js")).then(m=>legacy(m.rpmSpec))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Ruby",alias:["jruby","macruby","rake","rb","rbx"],extensions:["rb"],filename:/^(Gemfile|Rakefile)$/,load:()=>__webpack_require__.e(4616).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/ruby.js")).then(m=>legacy(m.ruby))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"SAS",extensions:["sas"],load:()=>__webpack_require__.e(247).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/sas.js")).then(m=>legacy(m.sas))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Scala",extensions:["scala"],load:()=>__webpack_require__.e(4528).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clike.js")).then(m=>legacy(m.scala))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Scheme",extensions:["scm","ss"],load:()=>__webpack_require__.e(2959).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/scheme.js")).then(m=>legacy(m.scheme))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Shell",alias:["bash","sh","zsh"],extensions:["sh","ksh","bash"],filename:/^PKGBUILD$/,load:()=>__webpack_require__.e(84).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/shell.js")).then(m=>legacy(m.shell))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Sieve",extensions:["siv","sieve"],load:()=>__webpack_require__.e(5224).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/sieve.js")).then(m=>legacy(m.sieve))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Smalltalk",extensions:["st"],load:()=>__webpack_require__.e(8368).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/smalltalk.js")).then(m=>legacy(m.smalltalk))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Solr",load:()=>__webpack_require__.e(2280).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/solr.js")).then(m=>legacy(m.solr))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"SML",extensions:["sml","sig","fun","smackspec"],load:()=>__webpack_require__.e(1954).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mllike.js")).then(m=>legacy(m.sml))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"SPARQL",alias:["sparul"],extensions:["rq","sparql"],load:()=>__webpack_require__.e(8753).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/sparql.js")).then(m=>legacy(m.sparql))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Spreadsheet",alias:["excel","formula"],load:()=>__webpack_require__.e(3780).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/spreadsheet.js")).then(m=>legacy(m.spreadsheet))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Squirrel",extensions:["nut"],load:()=>__webpack_require__.e(4528).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/clike.js")).then(m=>legacy(m.squirrel))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Stylus",extensions:["styl"],load:()=>__webpack_require__.e(4462).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/stylus.js")).then(m=>legacy(m.stylus))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Swift",extensions:["swift"],load:()=>__webpack_require__.e(321).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/swift.js")).then(m=>legacy(m.swift))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"sTeX",load:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/stex.js")).then(m=>legacy(m.stex))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"LaTeX",alias:["tex"],extensions:["text","ltx","tex"],load:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/stex.js")).then(m=>legacy(m.stex))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"SystemVerilog",extensions:["v","sv","svh"],load:()=>__webpack_require__.e(4372).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/verilog.js")).then(m=>legacy(m.verilog))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Tcl",extensions:["tcl"],load:()=>__webpack_require__.e(1189).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/tcl.js")).then(m=>legacy(m.tcl))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Textile",extensions:["textile"],load:()=>__webpack_require__.e(4611).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/textile.js")).then(m=>legacy(m.textile))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"TiddlyWiki",load:()=>__webpack_require__.e(7756).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/tiddlywiki.js")).then(m=>legacy(m.tiddlyWiki))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Tiki wiki",load:()=>__webpack_require__.e(6843).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/tiki.js")).then(m=>legacy(m.tiki))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"TOML",extensions:["toml"],load:()=>__webpack_require__.e(6460).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/toml.js")).then(m=>legacy(m.toml))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Troff",extensions:["1","2","3","4","5","6","7","8","9"],load:()=>__webpack_require__.e(4053).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/troff.js")).then(m=>legacy(m.troff))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"TTCN",extensions:["ttcn","ttcn3","ttcnpp"],load:()=>__webpack_require__.e(7269).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/ttcn.js")).then(m=>legacy(m.ttcn))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"TTCN_CFG",extensions:["cfg"],load:()=>__webpack_require__.e(6874).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/ttcn-cfg.js")).then(m=>legacy(m.ttcnCfg))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Turtle",extensions:["ttl"],load:()=>__webpack_require__.e(9474).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/turtle.js")).then(m=>legacy(m.turtle))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Web IDL",extensions:["webidl"],load:()=>__webpack_require__.e(265).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/webidl.js")).then(m=>legacy(m.webIDL))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"VB.NET",extensions:["vb"],load:()=>__webpack_require__.e(492).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/vb.js")).then(m=>legacy(m.vb))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"VBScript",extensions:["vbs"],load:()=>__webpack_require__.e(6767).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/vbscript.js")).then(m=>legacy(m.vbScript))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Velocity",extensions:["vtl"],load:()=>__webpack_require__.e(2467).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/velocity.js")).then(m=>legacy(m.velocity))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Verilog",extensions:["v"],load:()=>__webpack_require__.e(4372).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/verilog.js")).then(m=>legacy(m.verilog))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"VHDL",extensions:["vhd","vhdl"],load:()=>__webpack_require__.e(4838).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/vhdl.js")).then(m=>legacy(m.vhdl))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"XQuery",extensions:["xy","xquery"],load:()=>__webpack_require__.e(4484).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/xquery.js")).then(m=>legacy(m.xQuery))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Yacas",extensions:["ys"],load:()=>__webpack_require__.e(2681).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/yacas.js")).then(m=>legacy(m.yacas))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Z80",extensions:["z80"],load:()=>__webpack_require__.e(4296).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/z80.js")).then(m=>legacy(m.z80))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"MscGen",extensions:["mscgen","mscin","msc"],load:()=>__webpack_require__.e(5877).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mscgen.js")).then(m=>legacy(m.mscgen))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Xù",extensions:["xu"],load:()=>__webpack_require__.e(5877).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mscgen.js")).then(m=>legacy(m.xu))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"MsGenny",extensions:["msgenny"],load:()=>__webpack_require__.e(5877).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/legacy-modes/mode/mscgen.js")).then(m=>legacy(m.msgenny))}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Vue",extensions:["vue"],load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(5985),__webpack_require__.e(7154),__webpack_require__.e(1832)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-vue/dist/index.js")).then(m=>m.vue())}),_codemirror_language__WEBPACK_IMPORTED_MODULE_0__.t$.of({name:"Angular Template",load:()=>Promise.all([__webpack_require__.e(7421),__webpack_require__.e(2973),__webpack_require__.e(5985),__webpack_require__.e(7154),__webpack_require__.e(8014)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@codemirror/lang-angular/dist/index.js")).then(m=>m.angular())})]},"./node_modules/@codemirror/legacy-modes/mode/stex.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function mkStex(mathMode){function pushCommand(state,command){state.cmdState.push(command)}function peekCommand(state){return state.cmdState.length>0?state.cmdState[state.cmdState.length-1]:null}function addPluginPattern(pluginName,cmdStyle,styles){return function(){this.name=pluginName,this.bracketNo=0,this.style=cmdStyle,this.styles=styles,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,"bracket"},this.closeBracket=function(){}}}var plugins={};function setState(state,f){state.f=f}function normal(source,state){var plug;if(source.match(/^\\[a-zA-Z@\xc0-\u1fff\u2060-\uffff]+/)){var cmdName=source.current().slice(1);return pushCommand(state,plug=new(plug=plugins.hasOwnProperty(cmdName)?plugins[cmdName]:plugins.DEFAULT)),setState(state,beginParams),plug.style}if(source.match(/^\\[$&%#{}_]/))return"tag";if(source.match(/^\\[,;!\/\\]/))return"tag";if(source.match("\\["))return setState(state,function(source,state){return inMathMode(source,state,"\\]")}),"keyword";if(source.match("\\("))return setState(state,function(source,state){return inMathMode(source,state,"\\)")}),"keyword";if(source.match("$$"))return setState(state,function(source,state){return inMathMode(source,state,"$$")}),"keyword";if(source.match("$"))return setState(state,function(source,state){return inMathMode(source,state,"$")}),"keyword";var ch=source.next();return"%"==ch?(source.skipToEnd(),"comment"):"}"==ch||"]"==ch?(plug=peekCommand(state))?(plug.closeBracket(ch),setState(state,beginParams),"bracket"):"error":"{"==ch||"["==ch?(pushCommand(state,plug=new(plug=plugins.DEFAULT)),"bracket"):/\d/.test(ch)?(source.eatWhile(/[\w.%]/),"atom"):(source.eatWhile(/[\w\-_]/),plug=function getMostPowerful(state){for(var context=state.cmdState,i=context.length-1;i>=0;i--){var plug=context[i];if("DEFAULT"!=plug.name)return plug}return{styleIdentifier:function(){return null}}}(state),"begin"==plug.name&&(plug.argument=source.current()),plug.styleIdentifier())}function inMathMode(source,state,endModeSeq){if(source.eatSpace())return null;if(endModeSeq&&source.match(endModeSeq))return setState(state,normal),"keyword";if(source.match(/^\\[a-zA-Z@]+/))return"tag";if(source.match(/^[a-zA-Z]+/))return"variableName.special";if(source.match(/^\\[$&%#{}_]/))return"tag";if(source.match(/^\\[,;!\/]/))return"tag";if(source.match(/^[\^_&]/))return"tag";if(source.match(/^[+\-<>|=,\/@!*:;'"`~#?]/))return null;if(source.match(/^(\d+\.\d*|\d*\.\d+|\d+)/))return"number";var ch=source.next();return"{"==ch||"}"==ch||"["==ch||"]"==ch||"("==ch||")"==ch?"bracket":"%"==ch?(source.skipToEnd(),"comment"):"error"}function beginParams(source,state){var ch=source.peek();return"{"==ch||"["==ch?(peekCommand(state).openBracket(ch),source.eat(ch),setState(state,normal),"bracket"):/[ \t\r]/.test(ch)?(source.eat(ch),null):(setState(state,normal),function popCommand(state){var plug=state.cmdState.pop();plug&&plug.closeBracket()}(state),normal(source,state))}return plugins.importmodule=addPluginPattern("importmodule","tag",["string","builtin"]),plugins.documentclass=addPluginPattern("documentclass","tag",["","atom"]),plugins.usepackage=addPluginPattern("usepackage","tag",["atom"]),plugins.begin=addPluginPattern("begin","tag",["atom"]),plugins.end=addPluginPattern("end","tag",["atom"]),plugins.label=addPluginPattern("label","tag",["atom"]),plugins.ref=addPluginPattern("ref","tag",["atom"]),plugins.eqref=addPluginPattern("eqref","tag",["atom"]),plugins.cite=addPluginPattern("cite","tag",["atom"]),plugins.bibitem=addPluginPattern("bibitem","tag",["atom"]),plugins.Bibitem=addPluginPattern("Bibitem","tag",["atom"]),plugins.RBibitem=addPluginPattern("RBibitem","tag",["atom"]),plugins.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{name:"stex",startState:function(){return{cmdState:[],f:mathMode?function(source,state){return inMathMode(source,state)}:normal}},copyState:function(s){return{cmdState:s.cmdState.slice(),f:s.f}},token:function(stream,state){return state.f(stream,state)},blankLine:function(state){state.f=normal,state.cmdState.length=0},languageData:{commentTokens:{line:"%"}}}}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{stex:()=>stex,stexMath:()=>stexMath});const stex=mkStex(!1),stexMath=mkStex(!0)},"./node_modules/@milkdown/components/lib/code-block/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{MJ:()=>codeBlockComponent,T4:()=>codeBlockConfig});var _milkdown_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@milkdown/utils/lib/index.js"),_milkdown_preset_commonmark__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@milkdown/preset-commonmark/lib/index.js"),_codemirror_state__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@codemirror/state/dist/index.js"),_codemirror_view__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@codemirror/view/dist/index.js"),_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/prosemirror-commands/dist/index.js"),_milkdown_prose_history__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/prosemirror-history/dist/index.js"),_milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),vue__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.js"),vue__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js"),vue__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@vue/runtime-dom/dist/runtime-dom.esm-bundler.js"),clsx__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),dompurify__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/dompurify/dist/purify.es.mjs"),_floating_ui_dom__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@floating-ui/dom/dist/floating-ui.dom.mjs"),__defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a};function withMeta(plugin,meta){return Object.assign(plugin,{meta:__spreadValues({package:"@milkdown/components"},meta)}),plugin}const codeBlockConfig=(0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_0__.Qx)({extensions:[],languages:[],expandIcon:"⬇",searchIcon:"🔍",clearSearchIcon:"⌫",searchPlaceholder:"Search language",noResultText:"No result",copyText:"Copy",copyIcon:"📋",onCopy:()=>{},renderLanguage:language=>language,renderPreview:()=>null,previewToggleButton:previewOnlyMode=>previewOnlyMode?"Edit":"Hide",previewLabel:"Preview"},"codeBlockConfigCtx");withMeta(codeBlockConfig,{displayName:"Config<code-block>",group:"CodeBlock"});class LanguageLoader{constructor(languages){this.languages=languages,this.map={},languages.forEach(language=>{language.alias.forEach(alias=>{this.map[alias]=language})})}getAll(){return this.languages.map(language=>({name:language.name,alias:language.alias}))}load(languageName){const language=this.map[languageName.toLowerCase()];return language?language.support?Promise.resolve(language.support):language.load():Promise.resolve(void 0)}}function Icon({icon,class:className,onClick}){return(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("span",{class:(0,clsx__WEBPACK_IMPORTED_MODULE_10__.A)("milkdown-icon",className),onPointerdown:onClick,ref:el=>{el&&icon&&(el.innerHTML=dompurify__WEBPACK_IMPORTED_MODULE_11__.A.sanitize(icon.trim()))}})}Icon.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};function copyToClipboard(text){return __this=this,__arguments=null,generator=function*(){try{return navigator.clipboard.writeText(text)}catch(e){const element=document.createElement("textarea"),previouslyFocusedElement=document.activeElement;element.value=text,element.setAttribute("readonly",""),element.style.contain="strict",element.style.position="absolute",element.style.left="-9999px",element.style.fontSize="12pt";const selection=document.getSelection(),originalRange=selection?selection.rangeCount>0&&selection.getRangeAt(0):null;document.body.appendChild(element),element.select(),element.selectionStart=0,element.selectionEnd=text.length,document.execCommand("copy"),document.body.removeChild(element),originalRange&&(selection.removeAllRanges(),selection.addRange(originalRange)),previouslyFocusedElement&&previouslyFocusedElement.focus()}},new Promise((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())});var __this,__arguments,generator}const CopyButton=(0,vue__WEBPACK_IMPORTED_MODULE_7__.pM)({props:{copyText:{type:String,required:!0},copyIcon:{type:String,required:!0},onCopy:{type:Function,required:!0},text:{type:String,required:!0}},setup(props){const onCopyCode=()=>{copyToClipboard(props.text).then(()=>props.onCopy(props.text)).catch(console.error)};return()=>(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(vue__WEBPACK_IMPORTED_MODULE_7__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("button",{type:"button",class:"copy-button",onClick:onCopyCode},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(Icon,{icon:props.copyIcon}),props.copyText))}}),LanguagePicker=(0,vue__WEBPACK_IMPORTED_MODULE_7__.pM)({props:{language:{type:Object,required:!0},getReadOnly:{type:Function,required:!0},config:{type:Object,required:!0},getAllLanguages:{type:Function,required:!0},setLanguage:{type:Function,required:!0}},setup({language,config,setLanguage,getAllLanguages,getReadOnly}){const triggerRef=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(),showPicker=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(!1),searchRef=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(),pickerRef=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(),filter=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)("");(0,vue__WEBPACK_IMPORTED_MODULE_7__.wB)([showPicker,triggerRef,pickerRef],()=>{filter.value="";const picker=triggerRef.value,languageList=pickerRef.value;picker&&languageList&&(0,_floating_ui_dom__WEBPACK_IMPORTED_MODULE_12__.rD)(picker,languageList,{placement:"bottom-start"}).then(({x,y})=>{Object.assign(languageList.style,{left:`${x}px`,top:`${y}px`})}).catch(console.error)});const onTogglePicker=e=>{if(e.preventDefault(),e.stopPropagation(),getReadOnly())return;const next=!showPicker.value;showPicker.value=next,next&&setTimeout(()=>{var _a;return null==(_a=searchRef.value)?void 0:_a.focus()},0)},changeFilter=e=>{const target=e.target;filter.value=target.value},onSearchKeydown=e=>{"Escape"===e.key&&(filter.value="")},languages=(0,vue__WEBPACK_IMPORTED_MODULE_7__.EW)(()=>{var _a;if(!showPicker.value)return[];const all=null!=(_a=getAllLanguages())?_a:[],selected=all.find(languageInfo=>languageInfo.name.toLowerCase()===language.value.toLowerCase()),filtered=all.filter(languageInfo=>{const currentValue=filter.value.toLowerCase();return(languageInfo.name.toLowerCase().includes(currentValue)||languageInfo.alias.some(alias=>alias.toLowerCase().includes(currentValue)))&&languageInfo!==selected});return 0===filtered.length?[]:selected?[selected,...filtered]:filtered}),clickHandler=e=>{const target=e.target;if(triggerRef.value&&triggerRef.value.contains(target))return;const picker=pickerRef.value,trigger=triggerRef.value;trigger&&picker&&"true"===trigger.dataset.expanded&&(picker.contains(target)||(showPicker.value=!1))};return(0,vue__WEBPACK_IMPORTED_MODULE_7__.sV)(()=>{window.addEventListener("click",clickHandler)}),(0,vue__WEBPACK_IMPORTED_MODULE_7__.hi)(()=>{window.removeEventListener("click",clickHandler)}),()=>(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(vue__WEBPACK_IMPORTED_MODULE_7__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("button",{type:"button",ref:triggerRef,class:"language-button",onClick:onTogglePicker,"data-expanded":String(showPicker.value)},language.value||"Text",(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:"expand-icon"},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(Icon,{icon:config.expandIcon}))),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{ref:pickerRef,class:"language-picker"},showPicker.value?(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:"list-wrapper"},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:"search-box"},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:"search-icon"},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(Icon,{icon:config.searchIcon})),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("input",{ref:searchRef,class:"search-input",placeholder:config.searchPlaceholder,value:filter.value,onInput:changeFilter,onKeydown:onSearchKeydown}),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:(0,clsx__WEBPACK_IMPORTED_MODULE_10__.A)("clear-icon",0===filter.value.length&&"hidden"),onMousedown:e=>{e.preventDefault(),filter.value=""}},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(Icon,{icon:config.clearSearchIcon}))),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("ul",{class:"language-list",role:"listbox",onKeydown:e=>{if("Enter"===e.key){const active=document.activeElement;active instanceof HTMLElement&&active.dataset.language&&setLanguage(active.dataset.language)}}},languages.value.length?languages.value.map(languageInfo=>(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("li",{role:"listitem",tabindex:"0",class:"language-list-item","aria-selected":languageInfo.name.toLowerCase()===language.value.toLowerCase(),"data-language":languageInfo.name,onClick:()=>{setLanguage(languageInfo.name),showPicker.value=!1}},config.renderLanguage(languageInfo.name,languageInfo.name.toLowerCase()===language.value.toLowerCase()))):(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("li",{class:"language-list-item no-result"},config.noResultText))):null))}}),PreviewPanel=(0,vue__WEBPACK_IMPORTED_MODULE_7__.pM)({props:{text:{type:Object,required:!0},language:{type:Object,required:!0},config:{type:Object,required:!0},previewOnlyMode:{type:Object,required:!0},preview:{type:Object,required:!0}},setup(props){const{previewOnlyMode,config,preview}=props,previewRef=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)();return(0,vue__WEBPACK_IMPORTED_MODULE_7__.nT)(()=>{const previewContainer=previewRef.value;if(!previewContainer)return;for(;previewContainer.firstChild;)previewContainer.removeChild(previewContainer.firstChild);const previewContent=preview.value;("string"==typeof previewContent||previewContent instanceof Element)&&(previewContainer.innerHTML=dompurify__WEBPACK_IMPORTED_MODULE_11__.A.sanitize(previewContent))}),()=>preview.value?(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:"preview-panel"},!previewOnlyMode.value&&(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(vue__WEBPACK_IMPORTED_MODULE_7__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:"preview-divider"}),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:(0,clsx__WEBPACK_IMPORTED_MODULE_10__.A)("preview-label",previewOnlyMode&&"hidden")},config.previewLabel)),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{ref:previewRef,class:"preview"})):null}}),CodeBlock=(0,vue__WEBPACK_IMPORTED_MODULE_7__.pM)({props:{text:{type:Object,required:!0},selected:{type:Object,required:!0},getReadOnly:{type:Function,required:!0},codemirror:{type:Object,required:!0},language:{type:Object,required:!0},getAllLanguages:{type:Function,required:!0},setLanguage:{type:Function,required:!0},config:{type:Object,required:!0}},setup(props){const previewOnlyMode=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(!1),codemirrorHostRef=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)();(0,vue__WEBPACK_IMPORTED_MODULE_7__.sV)(()=>{for(var _a;null==(_a=codemirrorHostRef.value)?void 0:_a.firstChild;)codemirrorHostRef.value.removeChild(codemirrorHostRef.value.firstChild);codemirrorHostRef.value&&codemirrorHostRef.value.appendChild(props.codemirror.dom)});const preview=(0,vue__WEBPACK_IMPORTED_MODULE_7__.EW)(()=>{const text=props.text.value,language=props.language.value;return props.config.renderPreview(language,text)}),empty=()=>{};return()=>{var _a;return(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(vue__WEBPACK_IMPORTED_MODULE_7__.FK,null,(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:"tools"},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(LanguagePicker,{language:props.language,config:props.config,setLanguage:props.setLanguage,getAllLanguages:props.getAllLanguages,getReadOnly:props.getReadOnly}),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{class:"tools-button-group"},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(CopyButton,{copyIcon:props.config.copyIcon,copyText:props.config.copyText,onCopy:null!=(_a=props.config.onCopy)?_a:empty,text:props.text.value}),preview.value?(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("button",{class:"preview-toggle-button",onClick:()=>previewOnlyMode.value=!previewOnlyMode.value},(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(Icon,{icon:props.config.previewToggleButton(previewOnlyMode.value)})):null)),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)("div",{ref:codemirrorHostRef,class:(0,clsx__WEBPACK_IMPORTED_MODULE_10__.A)("codemirror-host",preview.value&&previewOnlyMode.value&&"hidden")}),(0,vue__WEBPACK_IMPORTED_MODULE_7__.h)(PreviewPanel,{text:props.text,language:props.language,config:props.config,previewOnlyMode,preview}))}}});class CodeMirrorBlock{constructor(node,view,getPos,loader,config){this.node=node,this.view=view,this.getPos=getPos,this.loader=loader,this.config=config,this.selected=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(!1),this.language=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(""),this.text=(0,vue__WEBPACK_IMPORTED_MODULE_8__.KR)(""),this.updating=!1,this.languageName="",this.forwardUpdate=update=>{var _a;if(this.updating||!this.cm.hasFocus)return;let offset=(null!=(_a=this.getPos())?_a:0)+1;const{main}=update.state.selection,selFrom=offset+main.from,selTo=offset+main.to,pmSel=this.view.state.selection;if(update.docChanged||pmSel.from!==selFrom||pmSel.to!==selTo){const tr=this.view.state.tr;update.changes.iterChanges((fromA,toA,fromB,toB,text)=>{text.length?tr.replaceWith(offset+fromA,offset+toA,this.view.state.schema.text(text.toString())):tr.delete(offset+fromA,offset+toA),offset+=toB-fromB-(toA-fromA)}),tr.setSelection(_milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.U3.create(tr.doc,selFrom,selTo)),this.view.dispatch(tr)}},this.createApp=()=>(0,vue__WEBPACK_IMPORTED_MODULE_9__.Ef)(CodeBlock,{text:this.text,selected:this.selected,codemirror:this.cm,language:this.language,getAllLanguages:this.getAllLanguages,getReadOnly:()=>!this.view.editable,setLanguage:this.setLanguage,config:this.config}),this.codeMirrorKeymap=()=>{const view=this.view;return[{key:"ArrowUp",run:()=>this.maybeEscape("line",-1)},{key:"ArrowLeft",run:()=>this.maybeEscape("char",-1)},{key:"ArrowDown",run:()=>this.maybeEscape("line",1)},{key:"ArrowRight",run:()=>this.maybeEscape("char",1)},{key:"Mod-Enter",run:()=>!!(0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_4__.I$)(view.state,view.dispatch)&&(view.focus(),!0)},{key:"Mod-z",run:()=>(0,_milkdown_prose_history__WEBPACK_IMPORTED_MODULE_5__.tN)(view.state,view.dispatch)},{key:"Shift-Mod-z",run:()=>(0,_milkdown_prose_history__WEBPACK_IMPORTED_MODULE_5__.ZS)(view.state,view.dispatch)},{key:"Mod-y",run:()=>(0,_milkdown_prose_history__WEBPACK_IMPORTED_MODULE_5__.ZS)(view.state,view.dispatch)},{key:"Backspace",run:()=>{var _a;const ranges=this.cm.state.selection.ranges;if(ranges.length>1)return!1;const selection=ranges[0];if(selection&&(!selection.empty||selection.anchor>0))return!1;if(this.cm.state.doc.lines>=2)return!1;const state=this.view.state,pos=null!=(_a=this.getPos())?_a:0,tr=state.tr.replaceWith(pos,pos+this.node.nodeSize,state.schema.nodes.paragraph.createChecked({},this.node.content));return tr.setSelection(_milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.U3.near(tr.doc.resolve(pos))),this.view.dispatch(tr),this.view.focus(),!0}}]},this.maybeEscape=(unit,dir)=>{var _a;const{state}=this.cm;let main=state.selection.main;if(!main.empty)return!1;if("line"===unit&&(main=state.doc.lineAt(main.head)),dir<0?main.from>0:main.to<state.doc.length)return!1;const targetPos=(null!=(_a=this.getPos())?_a:0)+(dir<0?0:this.node.nodeSize),selection=_milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.U3.near(this.view.state.doc.resolve(targetPos),dir),tr=this.view.state.tr.setSelection(selection).scrollIntoView();return this.view.dispatch(tr),this.view.focus(),!0},this.setLanguage=language=>{var _a;this.view.dispatch(this.view.state.tr.setNodeAttribute(null!=(_a=this.getPos())?_a:0,"language",language))},this.getAllLanguages=()=>this.loader.getAll(),this.languageConf=new _codemirror_state__WEBPACK_IMPORTED_MODULE_2__.xx,this.readOnlyConf=new _codemirror_state__WEBPACK_IMPORTED_MODULE_2__.xx,this.cm=new _codemirror_view__WEBPACK_IMPORTED_MODULE_3__.Lz({doc:this.node.textContent,root:this.view.root,extensions:[this.readOnlyConf.of(_codemirror_state__WEBPACK_IMPORTED_MODULE_2__.$t.readOnly.of(!this.view.editable)),(0,_codemirror_view__WEBPACK_IMPORTED_MODULE_3__.VH)(),_codemirror_view__WEBPACK_IMPORTED_MODULE_3__.w4.of(this.codeMirrorKeymap()),this.languageConf.of([]),_codemirror_state__WEBPACK_IMPORTED_MODULE_2__.$t.changeFilter.of(()=>this.view.editable),...config.extensions,_codemirror_view__WEBPACK_IMPORTED_MODULE_3__.Lz.updateListener.of(this.forwardUpdate)]}),this.app=this.createApp(),this.dom=this.createDom(this.app),this.disposeSelectedWatcher=(0,vue__WEBPACK_IMPORTED_MODULE_7__.nT)(()=>{this.selected.value?this.dom.classList.add("selected"):this.dom.classList.remove("selected")}),this.updateLanguage()}createDom(app){const dom=document.createElement("div");return dom.className="milkdown-code-block",this.text.value=this.node.textContent,app.mount(dom),dom}updateLanguage(){const languageName=this.node.attrs.language;if(languageName===this.languageName)return;this.language.value=languageName;this.loader.load(null!=languageName?languageName:"").then(lang=>{lang&&(this.cm.dispatch({effects:this.languageConf.reconfigure(lang)}),this.languageName=languageName)}).catch(console.error)}setSelection(anchor,head){this.cm.dom.isConnected&&(this.cm.focus(),this.updating=!0,this.cm.dispatch({selection:{anchor,head}}),this.updating=!1)}update(node){if(node.type!==this.node.type)return!1;if(this.updating)return!0;this.node=node,this.text.value=node.textContent,this.updateLanguage(),this.view.editable===this.cm.state.readOnly&&this.cm.dispatch({effects:this.readOnlyConf.reconfigure(_codemirror_state__WEBPACK_IMPORTED_MODULE_2__.$t.readOnly.of(!this.view.editable))});const change=function computeChange(oldVal,newVal){if(oldVal===newVal)return null;let start=0,oldEnd=oldVal.length,newEnd=newVal.length;for(;start<oldEnd&&oldVal.charCodeAt(start)===newVal.charCodeAt(start);)++start;for(;oldEnd>start&&newEnd>start&&oldVal.charCodeAt(oldEnd-1)===newVal.charCodeAt(newEnd-1);)oldEnd--,newEnd--;return{from:start,to:oldEnd,text:newVal.slice(start,newEnd)}}(this.cm.state.doc.toString(),node.textContent);return change&&(this.updating=!0,this.cm.dispatch({changes:{from:change.from,to:change.to,insert:change.text},scrollIntoView:!0}),this.updating=!1),!0}selectNode(){this.selected.value=!0,this.cm.focus()}deselectNode(){this.selected.value=!1}stopEvent(){return!0}destroy(){this.app.unmount(),this.cm.destroy(),this.disposeSelectedWatcher()}}const codeBlockView=(0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_0__.m5)(_milkdown_preset_commonmark__WEBPACK_IMPORTED_MODULE_1__.Ay.node,ctx=>{const config=ctx.get(codeBlockConfig.key),languageLoader=new LanguageLoader(config.languages);return(node,view,getPos)=>new CodeMirrorBlock(node,view,getPos,languageLoader,config)});withMeta(codeBlockView,{displayName:"NodeView<code-block>",group:"CodeBlock"});const codeBlockComponent=[codeBlockView,codeBlockConfig]},"./node_modules/@milkdown/core/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A2:()=>CommandsReady,KE:()=>Editor,qv:()=>EditorStatus,CU:()=>EditorViewReady,ge:()=>InitReady,lq:()=>KeymapReady,x8:()=>SchemaReady,g3:()=>SerializerReady,MD:()=>commandsCtx,qf:()=>createCmdKey,CI:()=>defaultValueCtx,Fq:()=>editorCtx,kY:()=>editorViewCtx,QM:()=>editorViewOptionsCtx,f4:()=>inputRulesCtx,nu:()=>keymapCtx,aD:()=>markViewCtx,u7:()=>marksCtx,pe:()=>nodeViewCtx,P_:()=>nodesCtx,bQ:()=>parserCtx,TP:()=>prosePluginsCtx,eM:()=>remarkPluginsCtx,P5:()=>remarkStringifyOptionsCtx,k:()=>rootCtx,pZ:()=>schemaCtx,M:()=>serializerCtx});var lib=__webpack_require__("./node_modules/@milkdown/ctx/lib/index.js"),dist=__webpack_require__("./node_modules/prosemirror-model/dist/index.js"),remark_parse_lib=__webpack_require__("./node_modules/remark-parse/lib/index.js");const own={}.hasOwnProperty;const configure_own={}.hasOwnProperty;function configure(base,extension){let key,index=-1;if(extension.extensions)for(;++index<extension.extensions.length;)configure(base,extension.extensions[index]);for(key in extension)if(configure_own.call(extension,key))switch(key){case"extensions":break;case"unsafe":case"join":list(base[key],extension[key]);break;case"handlers":map(base[key],extension[key]);break;default:base.options[key]=extension[key]}return base}function list(left,right){right&&left.push(...right)}function map(left,right){right&&Object.assign(left,right)}var handle=__webpack_require__("./node_modules/mdast-util-to-markdown/lib/handle/index.js"),format_code_as_indented=__webpack_require__("./node_modules/mdast-util-to-markdown/lib/util/format-code-as-indented.js"),format_heading_as_setext=__webpack_require__("./node_modules/mdast-util-to-markdown/lib/util/format-heading-as-setext.js");const join=[function joinDefaults(left,right,parent,state){if("code"===right.type&&(0,format_code_as_indented.m)(right,state)&&("list"===left.type||left.type===right.type&&(0,format_code_as_indented.m)(left,state)))return!1;if("spread"in parent&&"boolean"==typeof parent.spread){if("paragraph"===left.type&&(left.type===right.type||"definition"===right.type||"heading"===right.type&&(0,format_heading_as_setext.f)(right,state)))return;return parent.spread?1:0}}];const fullPhrasingSpans=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],unsafe=[{character:"\t",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"\t",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"\t",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:"\n",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:"(?:[\r\n]|$)"},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:"(?:[ \t\r\n*])"},{character:"*",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{atBreak:!0,character:"+",after:"(?:[ \t\r\n])"},{atBreak:!0,character:"-",after:"(?:[ \t\r\n-])"},{atBreak:!0,before:"\\d+",character:".",after:"(?:[ \t\r\n]|$)"},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{atBreak:!0,character:"~"}];var micromark_util_decode_string=__webpack_require__("./node_modules/micromark-util-decode-string/index.js");function association(node){return node.label||!node.identifier?node.label||"":(0,micromark_util_decode_string.s)(node.identifier)}function compilePattern(pattern){if(!pattern._compiled){const before=(pattern.atBreak?"[\\r\\n][\\t ]*":"")+(pattern.before?"(?:"+pattern.before+")":"");pattern._compiled=new RegExp((before?"("+before+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(pattern.character)?"\\":"")+pattern.character+(pattern.after?"(?:"+pattern.after+")":""),"g")}return pattern._compiled}var encode_character_reference=__webpack_require__("./node_modules/mdast-util-to-markdown/lib/util/encode-character-reference.js");function between(left,right,parent,state){let index=state.join.length;for(;index--;){const result=state.join[index](left,right,parent,state);if(!0===result||1===result)break;if("number"==typeof result)return"\n".repeat(1+result);if(!1===result)return"\n\n\x3c!----\x3e\n\n"}return"\n\n"}const eol=/\r?\n|\r/g;function indentLines(value,map){const result=[];let match,start=0,line=0;for(;match=eol.exec(value);)one(value.slice(start,match.index)),result.push(match[0]),start=match.index+match[0].length,line++;return one(value.slice(start)),result.join("");function one(value){result.push(map(value,line,!value))}}var pattern_in_scope=__webpack_require__("./node_modules/mdast-util-to-markdown/lib/util/pattern-in-scope.js");function numerical(a,b){return a-b}function escapeBackslashes(value,after){const expression=/\\(?=[!-/:-@[-`{-~])/g,positions=[],results=[],whole=value+after;let match,index=-1,start=0;for(;match=expression.exec(whole);)positions.push(match.index);for(;++index<positions.length;)start!==positions[index]&&results.push(value.slice(start,positions[index])),results.push("\\"),start=positions[index];return results.push(value.slice(start)),results.join("")}function track(config){const options=config||{},now=options.now||{};let lineShift=options.lineShift||0,line=now.line||1,column=now.column||1;return{move:function move(input){const value=input||"",chunks=value.split(/\r?\n|\r/g),tail=chunks[chunks.length-1];return line+=chunks.length-1,column=1===chunks.length?column+tail.length:1+tail.length+lineShift,value},current:function current(){return{now:{line,column},lineShift}},shift:function shift(value){lineShift+=value}}}function toMarkdown(tree,options){const settings=options||{},state={associationId:association,containerPhrasing:containerPhrasingBound,containerFlow:containerFlowBound,createTracker:track,compilePattern,enter:function enter(name){return state.stack.push(name),function exit(){state.stack.pop()}},handlers:{...handle.p},handle:void 0,indentLines,indexStack:[],join:[...join],options:{},safe:safeBound,stack:[],unsafe:[...unsafe]};configure(state,settings),state.options.tightDefinitions&&state.join.push(joinDefinition),state.handle=function zwitch(key,options){const settings=options||{};function one(value,...parameters){let fn=one.invalid;const handlers=one.handlers;if(value&&own.call(value,key)){const id=String(value[key]);fn=own.call(handlers,id)?handlers[id]:one.unknown}if(fn)return fn.call(this,value,...parameters)}return one.handlers=settings.handlers||{},one.invalid=settings.invalid,one.unknown=settings.unknown,one}("type",{invalid,unknown,handlers:state.handlers});let result=state.handle(tree,void 0,state,{before:"\n",after:"\n",now:{line:1,column:1},lineShift:0});return result&&10!==result.charCodeAt(result.length-1)&&13!==result.charCodeAt(result.length-1)&&(result+="\n"),result}function invalid(value){throw new Error("Cannot handle value `"+value+"`, expected node")}function unknown(value){throw new Error("Cannot handle unknown node `"+value.type+"`")}function joinDefinition(left,right){if("definition"===left.type&&left.type===right.type)return 0}function containerPhrasingBound(parent,info){return function containerPhrasing(parent,state,info){const indexStack=state.indexStack,children=parent.children||[],results=[];let encodeAfter,index=-1,before=info.before;indexStack.push(-1);let tracker=state.createTracker(info);for(;++index<children.length;){const child=children[index];let after;if(indexStack[indexStack.length-1]=index,index+1<children.length){let handle=state.handle.handlers[children[index+1].type];handle&&handle.peek&&(handle=handle.peek),after=handle?handle(children[index+1],parent,state,{before:"",after:"",...tracker.current()}).charAt(0):""}else after=info.after;results.length>0&&("\r"===before||"\n"===before)&&"html"===child.type&&(results[results.length-1]=results[results.length-1].replace(/(\r?\n|\r)$/," "),before=" ",tracker=state.createTracker(info),tracker.move(results.join("")));let value=state.handle(child,parent,state,{...tracker.current(),after,before});encodeAfter&&encodeAfter===value.slice(0,1)&&(value=(0,encode_character_reference.T)(encodeAfter.charCodeAt(0))+value.slice(1));const encodingInfo=state.attentionEncodeSurroundingInfo;state.attentionEncodeSurroundingInfo=void 0,encodeAfter=void 0,encodingInfo&&(results.length>0&&encodingInfo.before&&before===results[results.length-1].slice(-1)&&(results[results.length-1]=results[results.length-1].slice(0,-1)+(0,encode_character_reference.T)(before.charCodeAt(0))),encodingInfo.after&&(encodeAfter=after)),tracker.move(value),results.push(value),before=value.slice(-1)}return indexStack.pop(),results.join("")}(parent,this,info)}function containerFlowBound(parent,info){return function containerFlow(parent,state,info){const indexStack=state.indexStack,children=parent.children||[],tracker=state.createTracker(info),results=[];let index=-1;for(indexStack.push(-1);++index<children.length;){const child=children[index];indexStack[indexStack.length-1]=index,results.push(tracker.move(state.handle(child,parent,state,{before:"\n",after:"\n",...tracker.current()}))),"list"!==child.type&&(state.bulletLastUsed=void 0),index<children.length-1&&results.push(tracker.move(between(child,children[index+1],parent,state)))}return indexStack.pop(),results.join("")}(parent,this,info)}function safeBound(value,config){return function safe(state,input,config){const value=(config.before||"")+(input||"")+(config.after||""),positions=[],result=[],infos={};let index=-1;for(;++index<state.unsafe.length;){const pattern=state.unsafe[index];if(!(0,pattern_in_scope.q)(state.stack,pattern))continue;const expression=state.compilePattern(pattern);let match;for(;match=expression.exec(value);){const before="before"in pattern||Boolean(pattern.atBreak),after="after"in pattern,position=match.index+(before?match[1].length:0);positions.includes(position)?(infos[position].before&&!before&&(infos[position].before=!1),infos[position].after&&!after&&(infos[position].after=!1)):(positions.push(position),infos[position]={before,after})}}positions.sort(numerical);let start=config.before?config.before.length:0;const end=value.length-(config.after?config.after.length:0);for(index=-1;++index<positions.length;){const position=positions[index];position<start||position>=end||position+1<end&&positions[index+1]===position+1&&infos[position].after&&!infos[position+1].before&&!infos[position+1].after||positions[index-1]===position-1&&infos[position].before&&!infos[position-1].before&&!infos[position-1].after||(start!==position&&result.push(escapeBackslashes(value.slice(start,position),"\\")),start=position,!/[!-/:-@[-`{-~]/.test(value.charAt(position))||config.encode&&config.encode.includes(value.charAt(position))?(result.push((0,encode_character_reference.T)(value.charCodeAt(position))),start++):result.push("\\"))}return result.push(escapeBackslashes(value.slice(start,end),config.after)),result.join("")}(this,value,config)}function remarkStringify(options){const self=this;self.compiler=function compiler(tree){return toMarkdown(tree,{...self.data("settings"),...options,extensions:self.data("toMarkdownExtensions")||[]})}}var _marks,_hasText,_maybeMerge,_matchTarget,_runNode,_closeNodeAndPush,_addNodeAndPush,_marks2,_matchTarget2,_runProseNode,_runProseMark,_runNode2,_searchType,_maybeMergeChildren,_createMarkdownNode,_moveSpaces,_closeNodeAndPush2,_addNodeAndPush2,_openMark,_closeMark,unified_lib=__webpack_require__("./node_modules/unified/lib/index.js"),exception_lib=__webpack_require__("./node_modules/@milkdown/exception/lib/index.js"),__typeError=msg=>{throw TypeError(msg)},__accessCheck=(obj,member,msg)=>member.has(obj)||__typeError("Cannot "+msg),__privateGet=(obj,member,getter)=>(__accessCheck(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd=(obj,member,value)=>member.has(obj)?__typeError("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),__privateSet=(obj,member,value,setter)=>(__accessCheck(obj,member,"write to private field"),setter?setter.call(obj,value):member.set(obj,value),value);class StackElement{}class Stack{constructor(){this.elements=[],this.size=()=>this.elements.length,this.top=()=>this.elements.at(-1),this.push=node=>{this.top()?.push(node)},this.open=node=>{this.elements.push(node)},this.close=()=>{const el=this.elements.pop();if(!el)throw(0,exception_lib.TR)();return el}}}class ParserStackElement extends StackElement{constructor(type,content,attrs){super(),this.type=type,this.content=content,this.attrs=attrs}push(node,...rest){this.content.push(node,...rest)}pop(){return this.content.pop()}static create(type,content,attrs){return new ParserStackElement(type,content,attrs)}}const _ParserState=class _ParserState extends Stack{constructor(schema){super(),__privateAdd(this,_marks),__privateAdd(this,_hasText),__privateAdd(this,_maybeMerge),__privateAdd(this,_matchTarget),__privateAdd(this,_runNode),__privateAdd(this,_closeNodeAndPush),__privateAdd(this,_addNodeAndPush),__privateSet(this,_marks,dist.CU.none),__privateSet(this,_hasText,node=>node.isText),__privateSet(this,_maybeMerge,(a,b)=>{if(__privateGet(this,_hasText).call(this,a)&&__privateGet(this,_hasText).call(this,b)&&dist.CU.sameSet(a.marks,b.marks))return this.schema.text(a.text+b.text,a.marks)}),__privateSet(this,_matchTarget,node=>{const result=Object.values({...this.schema.nodes,...this.schema.marks}).find(x=>x.spec.parseMarkdown.match(node));if(!result)throw(0,exception_lib.Xm)(node);return result}),__privateSet(this,_runNode,node=>{const type=__privateGet(this,_matchTarget).call(this,node);type.spec.parseMarkdown.runner(this,node,type)}),this.injectRoot=(node,nodeType,attrs)=>(this.openNode(nodeType,attrs),this.next(node.children),this),this.openNode=(nodeType,attrs)=>(this.open(ParserStackElement.create(nodeType,[],attrs)),this),__privateSet(this,_closeNodeAndPush,()=>{__privateSet(this,_marks,dist.CU.none);const element=this.close();return __privateGet(this,_addNodeAndPush).call(this,element.type,element.attrs,element.content)}),this.closeNode=()=>{try{__privateGet(this,_closeNodeAndPush).call(this)}catch(e){console.error(e)}return this},__privateSet(this,_addNodeAndPush,(nodeType,attrs,content)=>{const node=nodeType.createAndFill(attrs,content,__privateGet(this,_marks));if(!node)throw(0,exception_lib.$D)(nodeType,attrs,content);return this.push(node),node}),this.addNode=(nodeType,attrs,content)=>{try{__privateGet(this,_addNodeAndPush).call(this,nodeType,attrs,content)}catch(e){console.error(e)}return this},this.openMark=(markType,attrs)=>{const mark=markType.create(attrs);return __privateSet(this,_marks,mark.addToSet(__privateGet(this,_marks))),this},this.closeMark=markType=>(__privateSet(this,_marks,markType.removeFromSet(__privateGet(this,_marks))),this),this.addText=text=>{try{const topElement=this.top();if(!topElement)throw(0,exception_lib.TR)();const prevNode=topElement.pop(),currNode=this.schema.text(text,__privateGet(this,_marks));if(!prevNode)return topElement.push(currNode),this;const merged=__privateGet(this,_maybeMerge).call(this,prevNode,currNode);return merged?(topElement.push(merged),this):(topElement.push(prevNode,currNode),this)}catch(e){return console.error(e),this}},this.build=()=>{let doc;do{doc=__privateGet(this,_closeNodeAndPush).call(this)}while(this.size());return doc},this.next=(nodes=[])=>([nodes].flat().forEach(node=>__privateGet(this,_runNode).call(this,node)),this),this.toDoc=()=>this.build(),this.run=(remark,markdown)=>{const tree=remark.runSync(remark.parse(markdown),markdown);return this.next(tree),this},this.schema=schema}};_marks=new WeakMap,_hasText=new WeakMap,_maybeMerge=new WeakMap,_matchTarget=new WeakMap,_runNode=new WeakMap,_closeNodeAndPush=new WeakMap,_addNodeAndPush=new WeakMap,_ParserState.create=(schema,remark)=>{const state=new _ParserState(schema);return text=>(state.run(remark,text),state.toDoc())};let ParserState=_ParserState;const _SerializerStackElement=class _SerializerStackElement extends StackElement{constructor(type,children,value,props={}){super(),this.type=type,this.children=children,this.value=value,this.props=props,this.push=(node,...rest)=>{this.children||(this.children=[]),this.children.push(node,...rest)},this.pop=()=>this.children?.pop()}};_SerializerStackElement.create=(type,children,value,props={})=>new _SerializerStackElement(type,children,value,props);let SerializerStackElement=_SerializerStackElement;const _SerializerState=class _SerializerState extends Stack{constructor(schema){super(),__privateAdd(this,_marks2),__privateAdd(this,_matchTarget2),__privateAdd(this,_runProseNode),__privateAdd(this,_runProseMark),__privateAdd(this,_runNode2),__privateAdd(this,_searchType),__privateAdd(this,_maybeMergeChildren),__privateAdd(this,_createMarkdownNode),__privateAdd(this,_moveSpaces),__privateAdd(this,_closeNodeAndPush2),__privateAdd(this,_addNodeAndPush2),__privateAdd(this,_openMark),__privateAdd(this,_closeMark),__privateSet(this,_marks2,dist.CU.none),__privateSet(this,_matchTarget2,node=>{const result=Object.values({...this.schema.nodes,...this.schema.marks}).find(x=>x.spec.toMarkdown.match(node));if(!result)throw(0,exception_lib._K)(node.type);return result}),__privateSet(this,_runProseNode,node=>__privateGet(this,_matchTarget2).call(this,node).spec.toMarkdown.runner(this,node)),__privateSet(this,_runProseMark,(mark,node)=>__privateGet(this,_matchTarget2).call(this,mark).spec.toMarkdown.runner(this,mark,node)),__privateSet(this,_runNode2,node=>{const{marks}=node,getPriority=x=>x.type.spec.priority??50;[...marks].sort((a,b)=>getPriority(a)-getPriority(b)).every(mark=>!__privateGet(this,_runProseMark).call(this,mark,node))&&__privateGet(this,_runProseNode).call(this,node),marks.forEach(mark=>__privateGet(this,_closeMark).call(this,mark))}),__privateSet(this,_searchType,(child,type)=>{if(child.type===type)return child;if(1!==child.children?.length)return child;const searchNode=node2=>{if(node2.type===type)return node2;if(1!==node2.children?.length)return null;const[firstChild]=node2.children;return firstChild?searchNode(firstChild):null},target=searchNode(child);if(!target)return child;const tmp=target.children?[...target.children]:void 0,node={...child,children:tmp};return node.children=tmp,target.children=[node],target}),__privateSet(this,_maybeMergeChildren,node=>{const{children}=node;return children?(node.children=children.reduce((nextChildren,child,index)=>{if(0===index)return[child];const last=nextChildren.at(-1);if(last&&last.isMark&&child.isMark){child=__privateGet(this,_searchType).call(this,child,last.type);const{children:currChildren,...currRest}=child,{children:prevChildren,...prevRest}=last;if(child.type===last.type&&currChildren&&prevChildren&&JSON.stringify(currRest)===JSON.stringify(prevRest)){const next={...prevRest,children:[...prevChildren,...currChildren]};return nextChildren.slice(0,-1).concat(__privateGet(this,_maybeMergeChildren).call(this,next))}}return nextChildren.concat(child)},[]),node):node}),__privateSet(this,_createMarkdownNode,element=>{const node={...element.props,type:element.type};return element.children&&(node.children=element.children),element.value&&(node.value=element.value),node}),this.openNode=(type,value,props)=>(this.open(SerializerStackElement.create(type,void 0,value,props)),this),__privateSet(this,_moveSpaces,(element,onPush)=>{let startSpaces="",endSpaces="";const children=element.children;let first=-1,last=-1;if(children){(node=children)&&node.forEach((child,index)=>{"text"===child.type&&child.value&&(first<0&&(first=index),last=index)});const lastChild=children?.[last],firstChild=children?.[first];if(lastChild&&lastChild.value.endsWith(" ")){const text=lastChild.value,trimmed=text.trimEnd();endSpaces=text.slice(trimmed.length),lastChild.value=trimmed}if(firstChild&&firstChild.value.startsWith(" ")){const text=firstChild.value,trimmed=text.trimStart();startSpaces=text.slice(0,text.length-trimmed.length),firstChild.value=trimmed}}var node;startSpaces.length&&__privateGet(this,_addNodeAndPush2).call(this,"text",void 0,startSpaces);const result=onPush();return endSpaces.length&&__privateGet(this,_addNodeAndPush2).call(this,"text",void 0,endSpaces),result}),__privateSet(this,_closeNodeAndPush2,(trim=!1)=>{const element=this.close(),onPush=()=>__privateGet(this,_addNodeAndPush2).call(this,element.type,element.children,element.value,element.props);return trim?__privateGet(this,_moveSpaces).call(this,element,onPush):onPush()}),this.closeNode=()=>(__privateGet(this,_closeNodeAndPush2).call(this),this),__privateSet(this,_addNodeAndPush2,(type,children,value,props)=>{const element=SerializerStackElement.create(type,children,value,props),node=__privateGet(this,_maybeMergeChildren).call(this,__privateGet(this,_createMarkdownNode).call(this,element));return this.push(node),node}),this.addNode=(type,children,value,props)=>(__privateGet(this,_addNodeAndPush2).call(this,type,children,value,props),this),__privateSet(this,_openMark,(mark,type,value,props)=>mark.isInSet(__privateGet(this,_marks2))?this:(__privateSet(this,_marks2,mark.addToSet(__privateGet(this,_marks2))),this.openNode(type,value,{...props,isMark:!0}))),__privateSet(this,_closeMark,mark=>{mark.isInSet(__privateGet(this,_marks2))&&(__privateSet(this,_marks2,mark.type.removeFromSet(__privateGet(this,_marks2))),__privateGet(this,_closeNodeAndPush2).call(this,!0))}),this.withMark=(mark,type,value,props)=>(__privateGet(this,_openMark).call(this,mark,type,value,props),this),this.closeMark=mark=>(__privateGet(this,_closeMark).call(this,mark),this),this.build=()=>{let doc=null;do{doc=__privateGet(this,_closeNodeAndPush2).call(this)}while(this.size());return doc},this.next=nodes=>{return x=nodes,Object.prototype.hasOwnProperty.call(x,"size")?(nodes.forEach(node=>{__privateGet(this,_runNode2).call(this,node)}),this):(__privateGet(this,_runNode2).call(this,nodes),this);var x},this.toString=remark=>remark.stringify(this.build()),this.run=tree=>(this.next(tree),this),this.schema=schema}};_marks2=new WeakMap,_matchTarget2=new WeakMap,_runProseNode=new WeakMap,_runProseMark=new WeakMap,_runNode2=new WeakMap,_searchType=new WeakMap,_maybeMergeChildren=new WeakMap,_createMarkdownNode=new WeakMap,_moveSpaces=new WeakMap,_closeNodeAndPush2=new WeakMap,_addNodeAndPush2=new WeakMap,_openMark=new WeakMap,_closeMark=new WeakMap,_SerializerState.create=(schema,remark)=>{const state=new _SerializerState(schema);return content=>(state.run(content),state.toString(remark))};let SerializerState=_SerializerState;var prosemirror_commands_dist=__webpack_require__("./node_modules/prosemirror-commands/dist/index.js"),prosemirror_inputrules_dist=__webpack_require__("./node_modules/prosemirror-inputrules/dist/index.js"),prose_lib=__webpack_require__("./node_modules/@milkdown/prose/lib/index.js"),prosemirror_keymap_dist=__webpack_require__("./node_modules/prosemirror-keymap/dist/index.js"),prosemirror_state_dist=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),prosemirror_view_dist=__webpack_require__("./node_modules/prosemirror-view/dist/index.js");function withMeta(plugin,meta){return plugin.meta={package:"@milkdown/core",group:"System",...meta},plugin}const remarkHandlers={text:(node,_,state,info)=>{const value=node.value;return/^[^*_\\]*\s+$/.test(value)?value:state.safe(value,{...info,encode:[]})},strong:(node,_,state,info)=>{const marker=node.marker||state.options.strong||"*",exit=state.enter("strong"),tracker=state.createTracker(info);let value=tracker.move(marker+marker);return value+=tracker.move(state.containerPhrasing(node,{before:value,after:marker,...tracker.current()})),value+=tracker.move(marker+marker),exit(),value},emphasis:(node,_,state,info)=>{const marker=node.marker||state.options.emphasis||"*",exit=state.enter("emphasis"),tracker=state.createTracker(info);let value=tracker.move(marker);return value+=tracker.move(state.containerPhrasing(node,{before:value,after:marker,...tracker.current()})),value+=tracker.move(marker),exit(),value}},editorViewCtx=(0,lib.Z0)({},"editorView"),editorStateCtx=(0,lib.Z0)({},"editorState"),initTimerCtx=(0,lib.Z0)([],"initTimer"),editorCtx=(0,lib.Z0)({},"editor"),inputRulesCtx=(0,lib.Z0)([],"inputRules"),prosePluginsCtx=(0,lib.Z0)([],"prosePlugins"),remarkPluginsCtx=(0,lib.Z0)([],"remarkPlugins"),nodeViewCtx=(0,lib.Z0)([],"nodeView"),markViewCtx=(0,lib.Z0)([],"markView"),remarkCtx=(0,lib.Z0)((0,unified_lib.l)().use(remark_parse_lib.A).use(remarkStringify),"remark"),remarkStringifyOptionsCtx=(0,lib.Z0)({handlers:remarkHandlers,encode:[]},"remarkStringifyOptions"),ConfigReady=(0,lib.CR)("ConfigReady");const InitReady=(0,lib.CR)("InitReady");function init(editor){const plugin=ctx=>(ctx.inject(editorCtx,editor).inject(prosePluginsCtx,[]).inject(remarkPluginsCtx,[]).inject(inputRulesCtx,[]).inject(nodeViewCtx,[]).inject(markViewCtx,[]).inject(remarkStringifyOptionsCtx,{handlers:remarkHandlers,encode:[]}).inject(remarkCtx,(0,unified_lib.l)().use(remark_parse_lib.A).use(remarkStringify)).inject(initTimerCtx,[ConfigReady]).record(InitReady),async()=>{await ctx.waitTimers(initTimerCtx);const options=ctx.get(remarkStringifyOptionsCtx);return ctx.set(remarkCtx,(0,unified_lib.l)().use(remark_parse_lib.A).use(remarkStringify,options)),ctx.done(InitReady),()=>{ctx.remove(editorCtx).remove(prosePluginsCtx).remove(remarkPluginsCtx).remove(inputRulesCtx).remove(nodeViewCtx).remove(markViewCtx).remove(remarkStringifyOptionsCtx).remove(remarkCtx).remove(initTimerCtx).clearTimer(InitReady)}});return withMeta(plugin,{displayName:"Init"}),plugin}const SchemaReady=(0,lib.CR)("SchemaReady"),schemaTimerCtx=(0,lib.Z0)([],"schemaTimer"),schemaCtx=(0,lib.Z0)({},"schema"),nodesCtx=(0,lib.Z0)([],"nodes"),marksCtx=(0,lib.Z0)([],"marks");function extendPriority(x){return{...x,parseDOM:x.parseDOM?.map(rule=>({priority:x.priority,...rule}))}}const schema=ctx=>(ctx.inject(schemaCtx,{}).inject(nodesCtx,[]).inject(marksCtx,[]).inject(schemaTimerCtx,[InitReady]).record(SchemaReady),async()=>{await ctx.waitTimers(schemaTimerCtx);const remark=ctx.get(remarkCtx),processor=ctx.get(remarkPluginsCtx).reduce((acc,plug)=>acc.use(plug.plugin,plug.options),remark);ctx.set(remarkCtx,processor);const nodes=Object.fromEntries(ctx.get(nodesCtx).map(([key2,x])=>[key2,extendPriority(x)])),marks=Object.fromEntries(ctx.get(marksCtx).map(([key2,x])=>[key2,extendPriority(x)])),schema2=new dist.Sj({nodes,marks});return ctx.set(schemaCtx,schema2),ctx.done(SchemaReady),()=>{ctx.remove(schemaCtx).remove(nodesCtx).remove(marksCtx).remove(schemaTimerCtx).clearTimer(SchemaReady)}});withMeta(schema,{displayName:"Schema"});class CommandManager{constructor(){this.#container=new lib.mc,this.#ctx=null,this.setCtx=ctx=>{this.#ctx=ctx},this.chain=()=>{if(null==this.#ctx)throw(0,exception_lib.zD)();const ctx=this.#ctx,commands2=[],get=this.get.bind(this),chains={run:()=>{const chained=(0,prosemirror_commands_dist.st)(...commands2),view=ctx.get(editorViewCtx);return chained(view.state,view.dispatch,view)},inline:command=>(commands2.push(command),chains),pipe:function pipe(slice,payload){const cmd=get(slice);return commands2.push(cmd(payload)),chains}.bind(this)};return chains}}#container;#ctx;get ctx(){return this.#ctx}create(meta,value){const slice=meta.create(this.#container.sliceMap);return slice.set(value),slice}get(slice){return this.#container.get(slice).get()}remove(slice){return this.#container.remove(slice)}call(slice,payload){if(null==this.#ctx)throw(0,exception_lib.zD)();const command=this.get(slice)(payload),view=this.#ctx.get(editorViewCtx);return command(view.state,view.dispatch,view)}inline(command){if(null==this.#ctx)throw(0,exception_lib.zD)();const view=this.#ctx.get(editorViewCtx);return command(view.state,view.dispatch,view)}}function createCmdKey(key2="cmdKey"){return(0,lib.Z0)(()=>()=>!1,key2)}const commandsCtx=(0,lib.Z0)(new CommandManager,"commands"),commandsTimerCtx=(0,lib.Z0)([SchemaReady],"commandsTimer"),CommandsReady=(0,lib.CR)("CommandsReady"),commands=ctx=>{const cmd=new CommandManager;return cmd.setCtx(ctx),ctx.inject(commandsCtx,cmd).inject(commandsTimerCtx,[SchemaReady]).record(CommandsReady),async()=>(await ctx.waitTimers(commandsTimerCtx),ctx.done(CommandsReady),()=>{ctx.remove(commandsCtx).remove(commandsTimerCtx).clearTimer(CommandsReady)})};withMeta(commands,{displayName:"Commands"});class KeymapManager{constructor(){this.#ctx=null,this.#keymap=[],this.setCtx=ctx=>{this.#ctx=ctx},this.add=keymap2=>(this.#keymap.push(keymap2),()=>{this.#keymap=this.#keymap.filter(item=>item!==keymap2)}),this.addObjectKeymap=keymaps=>{const remove=[];return Object.entries(keymaps).forEach(([key2,command])=>{if("function"==typeof command){const keymapItem={key:key2,onRun:()=>command};this.#keymap.push(keymapItem),remove.push(()=>{this.#keymap=this.#keymap.filter(item=>item!==keymapItem)})}else this.#keymap.push(command),remove.push(()=>{this.#keymap=this.#keymap.filter(item=>item!==command)})}),()=>{remove.forEach(fn=>fn())}},this.addBaseKeymap=()=>{const base=function overrideBaseKeymap(keymap2){const handleBackspace=(0,prosemirror_commands_dist.st)(prosemirror_inputrules_dist.dv,prosemirror_commands_dist.ic,prosemirror_commands_dist.eB,prosemirror_commands_dist._e);return keymap2.Backspace=handleBackspace,keymap2}(prosemirror_commands_dist.RV);return this.addObjectKeymap(base)},this.build=()=>{const keymap2={};this.#keymap.forEach(item=>{keymap2[item.key]=[...keymap2[item.key]||[],item]});return Object.fromEntries(Object.entries(keymap2).map(([key2,items])=>{const sortedItems=items.sort((a,b)=>(b.priority??50)-(a.priority??50));return[key2,(state,dispatch,view)=>{const ctx=this.#ctx;if(null==ctx)throw(0,exception_lib.dI)();const commands2=sortedItems.map(item=>item.onRun(ctx));return(0,prosemirror_commands_dist.st)(...commands2)(state,dispatch,view)}]}))}}#ctx;#keymap;get ctx(){return this.#ctx}}const keymapCtx=(0,lib.Z0)(new KeymapManager,"keymap"),keymapTimerCtx=(0,lib.Z0)([SchemaReady],"keymapTimer"),KeymapReady=(0,lib.CR)("KeymapReady"),keymap=ctx=>{const km=new KeymapManager;return km.setCtx(ctx),ctx.inject(keymapCtx,km).inject(keymapTimerCtx,[SchemaReady]).record(KeymapReady),async()=>(await ctx.waitTimers(keymapTimerCtx),ctx.done(KeymapReady),()=>{ctx.remove(keymapCtx).remove(keymapTimerCtx).clearTimer(KeymapReady)})},ParserReady=(0,lib.CR)("ParserReady"),outOfScope$1=()=>{throw(0,exception_lib.dI)()},parserCtx=(0,lib.Z0)(outOfScope$1,"parser"),parserTimerCtx=(0,lib.Z0)([],"parserTimer"),parser=ctx=>(ctx.inject(parserCtx,outOfScope$1).inject(parserTimerCtx,[SchemaReady]).record(ParserReady),async()=>{await ctx.waitTimers(parserTimerCtx);const remark=ctx.get(remarkCtx),schema2=ctx.get(schemaCtx);return ctx.set(parserCtx,ParserState.create(schema2,remark)),ctx.done(ParserReady),()=>{ctx.remove(parserCtx).remove(parserTimerCtx).clearTimer(ParserReady)}});withMeta(parser,{displayName:"Parser"});const SerializerReady=(0,lib.CR)("SerializerReady"),serializerTimerCtx=(0,lib.Z0)([],"serializerTimer"),outOfScope=()=>{throw(0,exception_lib.dI)()},serializerCtx=(0,lib.Z0)(outOfScope,"serializer"),serializer=ctx=>(ctx.inject(serializerCtx,outOfScope).inject(serializerTimerCtx,[SchemaReady]).record(SerializerReady),async()=>{await ctx.waitTimers(serializerTimerCtx);const remark=ctx.get(remarkCtx),schema2=ctx.get(schemaCtx);return ctx.set(serializerCtx,SerializerState.create(schema2,remark)),ctx.done(SerializerReady),()=>{ctx.remove(serializerCtx).remove(serializerTimerCtx).clearTimer(SerializerReady)}});withMeta(serializer,{displayName:"Serializer"});const defaultValueCtx=(0,lib.Z0)("","defaultValue"),editorStateOptionsCtx=(0,lib.Z0)(x=>x,"stateOptions"),editorStateTimerCtx=(0,lib.Z0)([],"editorStateTimer"),EditorStateReady=(0,lib.CR)("EditorStateReady");const key$1=new prosemirror_state_dist.hs("MILKDOWN_STATE_TRACKER"),editorState=ctx=>(ctx.inject(defaultValueCtx,"").inject(editorStateCtx,{}).inject(editorStateOptionsCtx,x=>x).inject(editorStateTimerCtx,[ParserReady,SerializerReady,CommandsReady,KeymapReady]).record(EditorStateReady),async()=>{await ctx.waitTimers(editorStateTimerCtx);const schema2=ctx.get(schemaCtx),parser2=ctx.get(parserCtx),rules=ctx.get(inputRulesCtx),optionsOverride=ctx.get(editorStateOptionsCtx),prosePlugins=ctx.get(prosePluginsCtx),doc=function getDoc(defaultValue,parser2,schema2){if("string"==typeof defaultValue)return parser2(defaultValue);if("html"===defaultValue.type)return dist.S4.fromSchema(schema2).parse(defaultValue.dom);if("json"===defaultValue.type)return dist.bP.fromJSON(schema2,defaultValue.value);throw(0,exception_lib.j7)(defaultValue)}(ctx.get(defaultValueCtx),parser2,schema2),km=ctx.get(keymapCtx),disposeBaseKeymap=km.addBaseKeymap(),plugins=[...prosePlugins,new prosemirror_state_dist.k_({key:key$1,state:{init:()=>{},apply:(_tr,_value,_oldState,newState)=>{ctx.set(editorStateCtx,newState)}}}),(0,prose_lib.Z6)({rules}),(0,prosemirror_keymap_dist.w)(km.build())];ctx.set(prosePluginsCtx,plugins);const options=optionsOverride({schema:schema2,doc,plugins}),state=prosemirror_state_dist.$t.create(options);return ctx.set(editorStateCtx,state),ctx.done(EditorStateReady),()=>{disposeBaseKeymap(),ctx.remove(defaultValueCtx).remove(editorStateCtx).remove(editorStateOptionsCtx).remove(editorStateTimerCtx).clearTimer(EditorStateReady)}});withMeta(editorState,{displayName:"EditorState"});const EditorViewReady=(0,lib.CR)("EditorViewReady"),editorViewTimerCtx=(0,lib.Z0)([],"editorViewTimer"),editorViewOptionsCtx=(0,lib.Z0)({},"editorViewOptions"),rootCtx=(0,lib.Z0)(null,"root"),rootDOMCtx=(0,lib.Z0)(null,"rootDOM"),rootAttrsCtx=(0,lib.Z0)({},"rootAttrs");const key=new prosemirror_state_dist.hs("MILKDOWN_VIEW_CLEAR"),editorView=ctx=>(ctx.inject(rootCtx,document.body).inject(editorViewCtx,{}).inject(editorViewOptionsCtx,{}).inject(rootDOMCtx,null).inject(rootAttrsCtx,{}).inject(editorViewTimerCtx,[EditorStateReady]).record(EditorViewReady),async()=>{await ctx.wait(InitReady);const root=ctx.get(rootCtx)||document.body,el="string"==typeof root?document.querySelector(root):root;ctx.update(prosePluginsCtx,xs=>[new prosemirror_state_dist.k_({key,view:editorView2=>{const container=el?function createViewContainer(root,ctx){const container=document.createElement("div");container.className="milkdown",root.appendChild(container),ctx.set(rootDOMCtx,container);const attrs=ctx.get(rootAttrsCtx);return Object.entries(attrs).forEach(([key2,value])=>container.setAttribute(key2,value)),container}(el,ctx):void 0;return(()=>{if(container&&el){const editor=editorView2.dom;el.replaceChild(container,editor),container.appendChild(editor)}})(),{destroy:()=>{container?.parentNode&&container?.parentNode.replaceChild(editorView2.dom,container),container?.remove()}}}}),...xs]),await ctx.waitTimers(editorViewTimerCtx);const state=ctx.get(editorStateCtx),options=ctx.get(editorViewOptionsCtx),nodeViews=Object.fromEntries(ctx.get(nodeViewCtx)),markViews=Object.fromEntries(ctx.get(markViewCtx)),view=new prosemirror_view_dist.Lz(el,{state,nodeViews,markViews,...options});return function prepareViewDom(dom){dom.classList.add("editor"),dom.setAttribute("role","textbox")}(view.dom),ctx.set(editorViewCtx,view),ctx.done(EditorViewReady),()=>{view?.destroy(),ctx.remove(rootCtx).remove(editorViewCtx).remove(editorViewOptionsCtx).remove(rootDOMCtx).remove(rootAttrsCtx).remove(editorViewTimerCtx).clearTimer(EditorViewReady)}});withMeta(editorView,{displayName:"EditorView"});var EditorStatus=(EditorStatus2=>(EditorStatus2.Idle="Idle",EditorStatus2.OnCreate="OnCreate",EditorStatus2.Created="Created",EditorStatus2.OnDestroy="OnDestroy",EditorStatus2.Destroyed="Destroyed",EditorStatus2))(EditorStatus||{});class Editor{constructor(){this.#enableInspector=!1,this.#status="Idle",this.#configureList=[],this.#onStatusChange=()=>{},this.#container=new lib.mc,this.#clock=new lib.zD,this.#usrPluginStore=new Map,this.#sysPluginStore=new Map,this.#ctx=new lib.Kj(this.#container,this.#clock),this.#loadInternal=()=>{const configPlugin=function config(configure){const plugin=ctx=>(ctx.record(ConfigReady),async()=>(await configure(ctx),ctx.done(ConfigReady),()=>{ctx.clearTimer(ConfigReady)}));return withMeta(plugin,{displayName:"Config"}),plugin}(async ctx=>{await Promise.all(this.#configureList.map(fn=>fn(ctx)))}),internalPlugins=[schema,parser,serializer,commands,keymap,editorState,editorView,init(this),configPlugin];this.#prepare(internalPlugins,this.#sysPluginStore)},this.#prepare=(plugins,store)=>{plugins.forEach(plugin=>{const ctx=this.#ctx.produce(this.#enableInspector?plugin.meta:void 0),handler=plugin(ctx);store.set(plugin,{ctx,handler,cleanup:void 0})})},this.#cleanup=(plugins,remove=!1)=>Promise.all([plugins].flat().map(plugin=>{const loader=this.#usrPluginStore.get(plugin),cleanup=loader?.cleanup;return remove?this.#usrPluginStore.delete(plugin):this.#usrPluginStore.set(plugin,{ctx:void 0,handler:void 0,cleanup:void 0}),"function"==typeof cleanup?cleanup():cleanup})),this.#cleanupInternal=async()=>{await Promise.all([...this.#sysPluginStore.entries()].map(([_,{cleanup}])=>"function"==typeof cleanup?cleanup():cleanup)),this.#sysPluginStore.clear()},this.#setStatus=status=>{this.#status=status,this.#onStatusChange(status)},this.#loadPluginInStore=store=>[...store.entries()].map(async([key2,loader])=>{const{ctx,handler}=loader;if(!handler)return;const cleanup=await handler();store.set(key2,{ctx,handler,cleanup})}),this.enableInspector=(enable=!0)=>(this.#enableInspector=enable,this),this.onStatusChange=onChange=>(this.#onStatusChange=onChange,this),this.config=configure=>(this.#configureList.push(configure),this),this.removeConfig=configure=>(this.#configureList=this.#configureList.filter(x=>x!==configure),this),this.use=plugins=>{const _plugins=[plugins].flat();return _plugins.flat().forEach(plugin=>{this.#usrPluginStore.set(plugin,{ctx:void 0,handler:void 0,cleanup:void 0})}),"Created"===this.#status&&this.#prepare(_plugins,this.#usrPluginStore),this},this.remove=async plugins=>"OnCreate"===this.#status?(console.warn("[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code."),new Promise(resolve=>{setTimeout(()=>{resolve(this.remove(plugins))},50)})):(await this.#cleanup([plugins].flat(),!0),this),this.create=async()=>("OnCreate"===this.#status||("Created"===this.#status&&await this.destroy(),this.#setStatus("OnCreate"),this.#loadInternal(),this.#prepare([...this.#usrPluginStore.keys()],this.#usrPluginStore),await Promise.all([this.#loadPluginInStore(this.#sysPluginStore),this.#loadPluginInStore(this.#usrPluginStore)].flat()),this.#setStatus("Created")),this),this.destroy=async(clearPlugins=!1)=>"Destroyed"===this.#status||"OnDestroy"===this.#status?this:"OnCreate"===this.#status?new Promise(resolve=>{setTimeout(()=>{resolve(this.destroy(clearPlugins))},50)}):(clearPlugins&&(this.#configureList=[]),this.#setStatus("OnDestroy"),await this.#cleanup([...this.#usrPluginStore.keys()],clearPlugins),await this.#cleanupInternal(),this.#setStatus("Destroyed"),this),this.action=action=>action(this.#ctx),this.inspect=()=>this.#enableInspector?[...this.#sysPluginStore.values(),...this.#usrPluginStore.values()].map(({ctx})=>ctx?.inspector?.read()).filter(x=>Boolean(x)):(console.warn("[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first."),[])}static make(){return new Editor}#enableInspector;#status;#configureList;#onStatusChange;#container;#clock;#usrPluginStore;#sysPluginStore;#ctx;#loadInternal;#prepare;#cleanup;#cleanupInternal;#setStatus;#loadPluginInStore;get ctx(){return this.#ctx}get status(){return this.#status}}},"./node_modules/@milkdown/crepe/lib/esm/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{mA:()=>Crepe});var _apply=__webpack_require__("./node_modules/lodash-es/_apply.js"),_baseRest=__webpack_require__("./node_modules/lodash-es/_baseRest.js"),_baseMerge=__webpack_require__("./node_modules/lodash-es/_baseMerge.js"),isObject=__webpack_require__("./node_modules/lodash-es/isObject.js");const _customDefaultsMerge=function customDefaultsMerge(objValue,srcValue,key,object,source,stack){return(0,isObject.A)(objValue)&&(0,isObject.A)(srcValue)&&(stack.set(srcValue,objValue),(0,_baseMerge.A)(objValue,srcValue,void 0,customDefaultsMerge,stack),stack.delete(srcValue)),objValue};const lodash_es_mergeWith=(0,__webpack_require__("./node_modules/lodash-es/_createAssigner.js").A)(function(object,source,srcIndex,customizer){(0,_baseMerge.A)(object,source,srcIndex,customizer)});const lodash_es_defaultsDeep=(0,_baseRest.A)(function(args){return args.push(void 0,_customDefaultsMerge),(0,_apply.A)(lodash_es_mergeWith,void 0,args)});var dist=__webpack_require__("./node_modules/@codemirror/language-data/dist/index.js"),theme_one_dark_dist=__webpack_require__("./node_modules/@codemirror/theme-one-dark/dist/index.js"),lib=__webpack_require__("./node_modules/@milkdown/prose/lib/index.js"),utils_lib=__webpack_require__("./node_modules/@milkdown/utils/lib/index.js"),prosemirror_state_dist=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),core_lib=__webpack_require__("./node_modules/@milkdown/core/lib/index.js"),throttle=__webpack_require__("./node_modules/lodash-es/throttle.js"),floating_ui_dom=__webpack_require__("./node_modules/@floating-ui/dom/dist/floating-ui.dom.mjs");function withMeta(plugin,meta){return Object.assign(plugin,{meta:{package:"@milkdown/plugin-block",...meta}}),plugin}const blockConfig=(0,utils_lib.Qx)({filterNodes:pos=>!(0,lib.gi)(node=>"table"===node.type.name)(pos)},"blockConfig");withMeta(blockConfig,{displayName:"Ctx<blockConfig>"});const brokenClipboardAPI=lib.T.ie&&lib.T.ie_version<15||lib.T.ios&&lib.T.webkit_version<604;class BlockService{constructor(){this.#createSelection=()=>{if(!this.#active)return null;const result=this.#active,view=this.#view;if(view&&prosemirror_state_dist.nh.isSelectable(result.node)){const nodeSelection=prosemirror_state_dist.nh.create(view.state.doc,result.$pos.pos);return view.dispatch(view.state.tr.setSelection(nodeSelection)),view.focus(),this.#activeSelection=nodeSelection,nodeSelection}return null},this.#activeSelection=null,this.#active=null,this.#activeDOMRect=void 0,this.#dragging=!1,this.#hide=()=>{this.#notify?.({type:"hide"}),this.#active=null},this.#show=active=>{this.#active=active,this.#notify?.({type:"show",active})},this.bind=(ctx,notify)=>{this.#ctx=ctx,this.#notify=notify},this.addEvent=dom=>{dom.addEventListener("mousedown",this.#handleMouseDown),dom.addEventListener("mouseup",this.#handleMouseUp),dom.addEventListener("dragstart",this.#handleDragStart)},this.removeEvent=dom=>{dom.removeEventListener("mousedown",this.#handleMouseDown),dom.removeEventListener("mouseup",this.#handleMouseUp),dom.removeEventListener("dragstart",this.#handleDragStart)},this.unBind=()=>{this.#notify=void 0},this.#handleMouseDown=()=>{this.#activeDOMRect=this.#active?.el.getBoundingClientRect(),this.#createSelection()},this.#handleMouseUp=()=>{this.#dragging?(this.#dragging=!1,this.#activeSelection=null):requestAnimationFrame(()=>{this.#activeDOMRect&&this.#view?.focus()})},this.#handleDragStart=event=>{this.#dragging=!0;const view=this.#view;if(!view)return;view.dom.dataset.dragging="true";const selection=this.#activeSelection;if(event.dataTransfer&&selection){const slice=selection.content();event.dataTransfer.effectAllowed="copyMove";const{dom,text}=view.serializeForClipboard(slice);event.dataTransfer.clearData(),event.dataTransfer.setData(brokenClipboardAPI?"Text":"text/html",dom.innerHTML),brokenClipboardAPI||event.dataTransfer.setData("text/plain",text);const activeEl=this.#active?.el;activeEl&&event.dataTransfer.setDragImage(activeEl,0,0),view.dragging={slice,move:!0}}},this.keydownCallback=view=>(this.#hide(),this.#dragging=!1,view.dom.dataset.dragging="false",!1),this.#mousemoveCallback=(0,throttle.A)((view,event)=>{if(!view.editable)return;const rect=view.dom.getBoundingClientRect(),x=rect.left+rect.width/2;if(!(view.root.elementFromPoint(x,event.clientY)instanceof Element))return void this.#hide();const filterNodes=this.#filterNodes;if(!filterNodes)return;const result=function selectRootNodeByDom(view,coords,filterNodes){if(!view.dom.parentElement)return null;try{const pos=view.posAtCoords({left:coords.x,top:coords.y})?.inside;if(null==pos||pos<0)return null;let $pos=view.state.doc.resolve(pos),node=view.state.doc.nodeAt(pos),element=view.nodeDOM(pos);const filter=needLookup=>{const checkDepth=$pos.depth>=1&&0===$pos.index($pos.depth);if(!needLookup&&!checkDepth)return;const ancestorPos=$pos.before($pos.depth);node=view.state.doc.nodeAt(ancestorPos),element=view.nodeDOM(ancestorPos),$pos=view.state.doc.resolve(ancestorPos),filterNodes($pos,node)||filter(!0)},filterResult=filterNodes($pos,node);return filter(!filterResult),element&&node?{node,$pos,el:element}:null}catch{return null}}(view,{x,y:event.clientY},filterNodes);result?this.#show(result):this.#hide()},200),this.mousemoveCallback=(view,event)=>(view.composing||!view.editable||this.#mousemoveCallback(view,event),!1),this.dragoverCallback=(view,event)=>{if(this.#dragging){const root=this.#view?.dom.parentElement;if(!root)return!1;const hasHorizontalScrollbar=root.scrollHeight>root.clientHeight,rootRect=root.getBoundingClientRect();if(hasHorizontalScrollbar){if(root.scrollTop>0&&Math.abs(event.y-rootRect.y)<20){const top=root.scrollTop>10?root.scrollTop-10:0;return root.scrollTop=top,!1}const totalHeight=Math.round(view.dom.getBoundingClientRect().height);if(Math.round(root.scrollTop+rootRect.height)<totalHeight&&Math.abs(event.y-(rootRect.height+rootRect.y))<20){const top=root.scrollTop+10;return root.scrollTop=top,!1}}}return!1},this.dragenterCallback=view=>{view.dragging&&(this.#dragging=!0,view.dom.dataset.dragging="true")},this.dragleaveCallback=(view,event)=>{const x=event.clientX,y=event.clientY;(x<0||y<0||x>window.innerWidth||y>window.innerHeight)&&(this.#active=null,this.#dragEnd(view))},this.dropCallback=view=>(this.#dragEnd(view),!1),this.dragendCallback=view=>{this.#dragEnd(view)},this.#dragEnd=view=>{this.#dragging=!1,view.dom.dataset.dragging="false"}}#ctx;#createSelection;#activeSelection;#active;#activeDOMRect;#dragging;get#filterNodes(){try{return this.#ctx?.get(blockConfig.key).filterNodes}catch{return}}get#view(){return this.#ctx?.get(core_lib.kY)}#notify;#hide;#show;#handleMouseDown;#handleMouseUp;#handleDragStart;#mousemoveCallback;#dragEnd}const blockService=(0,utils_lib.Qx)(()=>new BlockService,"blockService"),blockServiceInstance=(0,utils_lib.Qx)({},"blockServiceInstance");withMeta(blockService,{displayName:"Ctx<blockService>"}),withMeta(blockServiceInstance,{displayName:"Ctx<blockServiceInstance>"});const blockSpec=(0,utils_lib.Qx)({},"blockSpec");withMeta(blockSpec,{displayName:"Ctx<blockSpec>"});const blockPlugin=(0,utils_lib.Gf)(ctx=>{const milkdownPluginBlockKey=new prosemirror_state_dist.hs("MILKDOWN_BLOCK"),service=ctx.get(blockService.key)();ctx.set(blockServiceInstance.key,service);const spec=ctx.get(blockSpec.key);return new prosemirror_state_dist.k_({key:milkdownPluginBlockKey,...spec,props:{...spec.props,handleDOMEvents:{drop:view=>service.dropCallback(view),pointermove:(view,event)=>service.mousemoveCallback(view,event),keydown:view=>service.keydownCallback(view),dragover:(view,event)=>service.dragoverCallback(view,event),dragleave:(view,event)=>service.dragleaveCallback(view,event),dragenter:view=>service.dragenterCallback(view),dragend:view=>service.dragendCallback(view)}}})});withMeta(blockPlugin,{displayName:"Prose<block>"});class BlockProvider{constructor(options){this.#activeNode=null,this.#initialized=!1,this.update=()=>{requestAnimationFrame(()=>{if(!this.#initialized)try{this.#init(),this.#initialized=!0}catch{}})},this.destroy=()=>{this.#service?.unBind(),this.#service?.removeEvent(this.#element),this.#element.remove()},this.show=active=>{const dom=active.el,editorDom=this.#ctx.get(core_lib.kY).dom,deriveContext={ctx:this.#ctx,active,editorDom,blockDom:this.#element},virtualEl={contextElement:dom,getBoundingClientRect:()=>this.#getPosition?this.#getPosition(deriveContext):dom.getBoundingClientRect()},middleware=[(0,floating_ui_dom.UU)()];if(this.#getOffset){const offsetOption=this.#getOffset(deriveContext),offsetExt=(0,floating_ui_dom.cY)(offsetOption);middleware.push(offsetExt)}(0,floating_ui_dom.rD)(virtualEl,this.#element,{placement:this.#getPlacement?this.#getPlacement(deriveContext):"left",middleware:[...middleware,...this.#middleware],...this.#floatingUIOptions}).then(({x,y})=>{Object.assign(this.#element.style,{left:`${x}px`,top:`${y}px`}),this.#element.dataset.show="true"}).catch(console.error)},this.hide=()=>{this.#element.dataset.show="false"},this.#ctx=options.ctx,this.#element=options.content,this.#getOffset=options.getOffset,this.#getPosition=options.getPosition,this.#getPlacement=options.getPlacement,this.#middleware=options.middleware??[],this.#floatingUIOptions=options.floatingUIOptions??{},this.#root=options.root,this.hide()}#element;#ctx;#service;#activeNode;#root;#initialized;#middleware;#floatingUIOptions;#getOffset;#getPosition;#getPlacement;get active(){return this.#activeNode}#init(){const view=this.#ctx.get(core_lib.kY);(this.#root??view.dom.parentElement??document.body).appendChild(this.#element);const service=this.#ctx.get(blockServiceInstance.key);service.bind(this.#ctx,message=>{"hide"===message.type?(this.hide(),this.#activeNode=null):"show"===message.type&&(this.show(message.active),this.#activeNode=message.active)}),this.#service=service,this.#service.addEvent(this.#element),this.#element.draggable=!0}}const block=[blockSpec,blockConfig,blockService,blockServiceInstance,blockPlugin];block.key=blockSpec.key,block.pluginKey=blockPlugin.key;var ctx_lib=__webpack_require__("./node_modules/@milkdown/ctx/lib/index.js"),preset_commonmark_lib=__webpack_require__("./node_modules/@milkdown/preset-commonmark/lib/index.js"),runtime_core_esm_bundler=__webpack_require__("./node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.js"),reactivity_esm_bundler=__webpack_require__("./node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js"),runtime_dom_esm_bundler=__webpack_require__("./node_modules/@vue/runtime-dom/dist/runtime-dom.esm-bundler.js"),debounce=__webpack_require__("./node_modules/lodash-es/debounce.js");class SlashProvider{constructor(options){this.#initialized=!1,this.onShow=()=>{},this.onHide=()=>{},this.#onUpdate=(view,prevState)=>{const{state,composing}=view,{selection,doc}=state,{ranges}=selection,from=Math.min(...ranges.map(range=>range.$from.pos)),to=Math.max(...ranges.map(range=>range.$to.pos)),isSame=prevState&&prevState.doc.eq(doc)&&prevState.selection.eq(selection);if(!this.#initialized){(this.#root??view.dom.parentElement??document.body).appendChild(this.element),this.#initialized=!0}if(composing||isSame)return;if(!this.#shouldShow(view,prevState))return void this.hide();const virtualEl={getBoundingClientRect:()=>(0,lib.MG)(view,from,to)};(0,floating_ui_dom.rD)(virtualEl,this.element,{placement:"bottom-start",middleware:[(0,floating_ui_dom.UU)(),(0,floating_ui_dom.cY)(this.#offset),...this.#middleware],...this.#floatingUIOptions}).then(({x,y})=>{Object.assign(this.element.style,{left:`${x}px`,top:`${y}px`})}).catch(console.error),this.show()},this.update=(view,prevState)=>{this.#updater(view,prevState)},this.getContent=(view,matchNode=node=>"paragraph"===node.type.name)=>{const{selection}=view.state,{empty,$from}=selection,isTextBlock=view.state.selection instanceof prosemirror_state_dist.U3;if("undefined"==typeof document)return;const isSlashChildren=this.element.contains(document.activeElement),notHasFocus=!view.hasFocus()&&!isSlashChildren,isReadonly=!view.editable,paragraph=(0,lib.KP)(matchNode)(view.state.selection);return!notHasFocus&&!isReadonly&&empty&&isTextBlock&&paragraph?$from.parent.textBetween(Math.max(0,$from.parentOffset-500),$from.parentOffset,void 0,"￼"):void 0},this.destroy=()=>{this.#updater.cancel()},this.show=()=>{this.element.dataset.show="true",this.onShow()},this.hide=()=>{this.element.dataset.show="false",this.onHide()},this.element=options.content,this.#debounce=options.debounce??200,this.#shouldShow=options.shouldShow??this.#_shouldShow,this.#trigger=options.trigger??"/",this.#offset=options.offset,this.#middleware=options.middleware??[],this.#floatingUIOptions=options.floatingUIOptions??{},this.#root=options.root,this.#updater=(0,debounce.A)(this.#onUpdate,this.#debounce)}#initialized;#middleware;#floatingUIOptions;#root;#debounce;#trigger;#shouldShow;#updater;#offset;#onUpdate;#_shouldShow(view){const currentTextBlockContent=this.getContent(view);if(!currentTextBlockContent)return!1;const target=currentTextBlockContent.at(-1);return!!target&&(Array.isArray(this.#trigger)?this.#trigger.includes(target):this.#trigger===target)}}var clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),purify_es=__webpack_require__("./node_modules/dompurify/dist/purify.es.mjs");function Icon({icon,class:className,onClick}){return(0,runtime_core_esm_bundler.h)("span",{class:(0,clsx.A)("milkdown-icon",className),onPointerdown:onClick,ref:el=>{el&&icon&&(el.innerHTML=purify_es.A.sanitize(icon.trim()))}})}Icon.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};var unist_util_visit_lib=__webpack_require__("./node_modules/unist-util-visit/lib/index.js"),exception_lib=__webpack_require__("./node_modules/@milkdown/exception/lib/index.js"),index_browser=__webpack_require__("./node_modules/nanoid/index.browser.js"),__defProp$2=Object.defineProperty,__getOwnPropSymbols$2=Object.getOwnPropertySymbols,__hasOwnProp$2=Object.prototype.hasOwnProperty,__propIsEnum$2=Object.prototype.propertyIsEnumerable,__defNormalProp$2=(obj,key,value)=>key in obj?__defProp$2(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues$2=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp$2.call(b,prop)&&__defNormalProp$2(a,prop,b[prop]);if(__getOwnPropSymbols$2)for(var prop of __getOwnPropSymbols$2(b))__propIsEnum$2.call(b,prop)&&__defNormalProp$2(a,prop,b[prop]);return a};function image_block_withMeta(plugin,meta){return Object.assign(plugin,{meta:__spreadValues$2({package:"@milkdown/components"},meta)}),plugin}const defaultImageBlockConfig={imageIcon:"🌌",captionIcon:"💬",uploadButton:"Upload file",confirmButton:"Confirm ⏎",uploadPlaceholderText:"or paste the image link ...",captionPlaceholderText:"Image caption",onUpload:file=>Promise.resolve(URL.createObjectURL(file))},imageBlockConfig=(0,utils_lib.Qx)(defaultImageBlockConfig,"imageBlockConfigCtx");function visitImage(ast){return(0,unist_util_visit_lib.YR)(ast,"paragraph",(node,index,parent)=>{var _a,_b;if(1!==(null==(_a=node.children)?void 0:_a.length))return;const firstChild=null==(_b=node.children)?void 0:_b[0];if(!firstChild||"image"!==firstChild.type)return;const{url,alt,title}=firstChild,newNode={type:"image-block",url,alt,title};parent.children.splice(index,1,newNode)})}image_block_withMeta(imageBlockConfig,{displayName:"Config<image-block>",group:"ImageBlock"});const remarkImageBlockPlugin=(0,utils_lib.lz)("remark-image-block",()=>()=>visitImage);image_block_withMeta(remarkImageBlockPlugin.plugin,{displayName:"Remark<remarkImageBlock>",group:"ImageBlock"}),image_block_withMeta(remarkImageBlockPlugin.options,{displayName:"RemarkConfig<remarkImageBlock>",group:"ImageBlock"});var __defProp$1=Object.defineProperty,__getOwnPropSymbols$1=Object.getOwnPropertySymbols,__hasOwnProp$1=Object.prototype.hasOwnProperty,__propIsEnum$1=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(obj,key,value)=>key in obj?__defProp$1(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues$1=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp$1.call(b,prop)&&__defNormalProp$1(a,prop,b[prop]);if(__getOwnPropSymbols$1)for(var prop of __getOwnPropSymbols$1(b))__propIsEnum$1.call(b,prop)&&__defNormalProp$1(a,prop,b[prop]);return a};const imageBlockSchema=(0,utils_lib.Yh)("image-block",()=>({inline:!1,group:"block",selectable:!0,draggable:!0,isolating:!0,marks:"",atom:!0,priority:100,attrs:{src:{default:"",validate:"string"},caption:{default:"",validate:"string"},ratio:{default:1,validate:"number"}},parseDOM:[{tag:'img[data-type="image-block"]',getAttrs:dom=>{var _a;if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{src:dom.getAttribute("src")||"",caption:dom.getAttribute("caption")||"",ratio:Number(null!=(_a=dom.getAttribute("ratio"))?_a:1)}}}],toDOM:node=>["img",__spreadValues$1({"data-type":"image-block"},node.attrs)],parseMarkdown:{match:({type})=>"image-block"===type,runner:(state,node,type)=>{const src=node.url,caption=node.title;let ratio=Number(node.alt||1);(Number.isNaN(ratio)||0===ratio)&&(ratio=1),state.addNode(type,{src,caption,ratio})}},toMarkdown:{match:node=>"image-block"===node.type.name,runner:(state,node)=>{state.openNode("paragraph"),state.addNode("image",void 0,void 0,{title:node.attrs.caption,url:node.attrs.src,alt:`${Number.parseFloat(node.attrs.ratio).toFixed(2)}`}),state.closeNode()}}}));function image_block_Icon({icon,class:className,onClick}){return(0,runtime_core_esm_bundler.h)("span",{class:(0,clsx.A)("milkdown-icon",className),onPointerdown:onClick,ref:el=>{el&&icon&&(el.innerHTML=purify_es.A.sanitize(icon.trim()))}})}image_block_withMeta(imageBlockSchema.node,{displayName:"NodeSchema<image-block>",group:"ImageBlock"}),image_block_Icon.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const nanoid=(0,index_browser.d_)("abcdefg",8),ImageInput=(0,runtime_core_esm_bundler.pM)({props:{src:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setLink:{type:Function,required:!0},imageIcon:{type:String,required:!1},uploadButton:{type:String,required:!1},confirmButton:{type:String,required:!1},uploadPlaceholderText:{type:String,required:!1},onUpload:{type:Function,required:!0}},setup({readonly,src,setLink,onUpload,imageIcon,uploadButton,confirmButton,uploadPlaceholderText,className}){var _a,_b;const focusLinkInput=(0,reactivity_esm_bundler.KR)(!1),linkInputRef=(0,reactivity_esm_bundler.KR)(),currentLink=(0,reactivity_esm_bundler.KR)(null!=(_a=src.value)?_a:""),uuid=(0,reactivity_esm_bundler.KR)(nanoid()),hidePlaceholder=(0,reactivity_esm_bundler.KR)(0!==(null==(_b=src.value)?void 0:_b.length)),onEditLink=e=>{const value=e.target.value;hidePlaceholder.value=0!==value.length,currentLink.value=value},onKeydown=e=>{var _a2,_b2;"Enter"===e.key&&setLink(null!=(_b2=null==(_a2=linkInputRef.value)?void 0:_a2.value)?_b2:"")},onUploadFile=e=>{var _a2;const file=null==(_a2=e.target.files)?void 0:_a2[0];file&&onUpload(file).then(url=>{url&&(setLink(url),hidePlaceholder.value=!0)}).catch(err=>{console.error("An error occurred while uploading image"),console.error(err)})};return()=>(0,runtime_core_esm_bundler.h)("div",{class:(0,clsx.A)("image-edit",className)},(0,runtime_core_esm_bundler.h)(image_block_Icon,{icon:imageIcon,class:"image-icon"}),(0,runtime_core_esm_bundler.h)("div",{class:(0,clsx.A)("link-importer",focusLinkInput.value&&"focus")},(0,runtime_core_esm_bundler.h)("input",{ref:linkInputRef,draggable:"true",onDragstart:e=>{e.preventDefault(),e.stopPropagation()},disabled:readonly.value,class:"link-input-area",value:currentLink.value,onInput:onEditLink,onKeydown,onFocus:()=>focusLinkInput.value=!0,onBlur:()=>focusLinkInput.value=!1}),!hidePlaceholder.value&&(0,runtime_core_esm_bundler.h)("div",{class:"placeholder"},(0,runtime_core_esm_bundler.h)("input",{disabled:readonly.value,class:"hidden",id:uuid.value,type:"file",accept:"image/*",onChange:onUploadFile}),(0,runtime_core_esm_bundler.h)("label",{class:"uploader",for:uuid.value},(0,runtime_core_esm_bundler.h)(image_block_Icon,{icon:uploadButton})),(0,runtime_core_esm_bundler.h)("span",{class:"text",onClick:()=>{var _a2;return null==(_a2=linkInputRef.value)?void 0:_a2.focus()}},uploadPlaceholderText))),currentLink.value&&(0,runtime_core_esm_bundler.h)("div",{class:"confirm",onClick:()=>{var _a2,_b2;setLink(null!=(_b2=null==(_a2=linkInputRef.value)?void 0:_a2.value)?_b2:"")}},(0,runtime_core_esm_bundler.h)(image_block_Icon,{icon:confirmButton})))}}),ImageViewer=(0,runtime_core_esm_bundler.pM)({props:{src:{type:Object,required:!0},caption:{type:Object,required:!0},ratio:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setAttr:{type:Function,required:!0},config:{type:Object,required:!0}},setup({src,caption,ratio,readonly,setAttr,config}){var _a;const imageRef=(0,reactivity_esm_bundler.KR)(),resizeHandle=(0,reactivity_esm_bundler.KR)(),showCaption=(0,reactivity_esm_bundler.KR)(Boolean(null==(_a=caption.value)?void 0:_a.length)),timer=(0,reactivity_esm_bundler.KR)(0),onImageLoad=()=>{var _a2;const image=imageRef.value;if(!image)return;const host=image.closest(".milkdown-image-block");if(!host)return;const maxWidth=host.getBoundingClientRect().width;if(!maxWidth)return;const height=image.height,width=image.width,transformedHeight=width<maxWidth?height:maxWidth*(height/width),h2=(transformedHeight*(null!=(_a2=ratio.value)?_a2:1)).toFixed(2);image.dataset.origin=transformedHeight.toFixed(2),image.dataset.height=h2,image.style.height=`${h2}px`},onToggleCaption=e=>{e.preventDefault(),e.stopPropagation(),readonly.value||(showCaption.value=!showCaption.value)},onInputCaption=e=>{const value=e.target.value;timer.value&&window.clearTimeout(timer.value),timer.value=window.setTimeout(()=>{setAttr("caption",value)},1e3)},onBlurCaption=e=>{const value=e.target.value;timer.value&&(window.clearTimeout(timer.value),timer.value=0),setAttr("caption",value)},onResizeHandlePointerMove=e=>{e.preventDefault();const image=imageRef.value;if(!image)return;const top=image.getBoundingClientRect().top,height=e.clientY-top,h2=Number(height<100?100:height).toFixed(2);image.dataset.height=h2,image.style.height=`${h2}px`},onResizeHandlePointerUp=()=>{window.removeEventListener("pointermove",onResizeHandlePointerMove),window.removeEventListener("pointerup",onResizeHandlePointerUp);const image=imageRef.value;if(!image)return;const originHeight=Number(image.dataset.origin),currentHeight=Number(image.dataset.height),ratio2=Number.parseFloat(Number(currentHeight/originHeight).toFixed(2));Number.isNaN(ratio2)||setAttr("ratio",ratio2)},onResizeHandlePointerDown=e=>{readonly.value||(e.preventDefault(),e.stopPropagation(),window.addEventListener("pointermove",onResizeHandlePointerMove),window.addEventListener("pointerup",onResizeHandlePointerUp))};return()=>(0,runtime_core_esm_bundler.h)(runtime_core_esm_bundler.FK,null,(0,runtime_core_esm_bundler.h)("div",{class:"image-wrapper"},(0,runtime_core_esm_bundler.h)("div",{class:"operation"},(0,runtime_core_esm_bundler.h)("div",{class:"operation-item",onPointerdown:onToggleCaption},(0,runtime_core_esm_bundler.h)(image_block_Icon,{icon:config.captionIcon}))),(0,runtime_core_esm_bundler.h)("img",{ref:imageRef,"data-type":"image-block",onLoad:onImageLoad,src:src.value,alt:caption.value}),(0,runtime_core_esm_bundler.h)("div",{ref:resizeHandle,class:"image-resize-handle",onPointerdown:onResizeHandlePointerDown})),showCaption.value&&(0,runtime_core_esm_bundler.h)("input",{draggable:"true",onDragstart:e=>{e.preventDefault(),e.stopPropagation()},class:"caption-input",placeholder:null==config?void 0:config.captionPlaceholderText,onInput:onInputCaption,onBlur:onBlurCaption,value:caption.value}))}});var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value;const MilkdownImageBlock=(0,runtime_core_esm_bundler.pM)({props:{src:{type:Object,required:!0},caption:{type:Object,required:!0},ratio:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setAttr:{type:Function,required:!0},config:{type:Object,required:!0}},setup(props){const{src}=props;return()=>{var _a;return(null==(_a=src.value)?void 0:_a.length)?(0,runtime_core_esm_bundler.h)(ImageViewer,((a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a})({},props)):(0,runtime_core_esm_bundler.h)(ImageInput,{src:props.src,selected:props.selected,readonly:props.readonly,setLink:link=>props.setAttr("src",link),imageIcon:props.config.imageIcon,uploadButton:props.config.uploadButton,confirmButton:props.config.confirmButton,uploadPlaceholderText:props.config.uploadPlaceholderText,onUpload:props.config.onUpload})}}}),imageBlockView=(0,utils_lib.m5)(imageBlockSchema.node,ctx=>(initialNode,view,getPos)=>{const src=(0,reactivity_esm_bundler.KR)(initialNode.attrs.src),caption=(0,reactivity_esm_bundler.KR)(initialNode.attrs.caption),ratio=(0,reactivity_esm_bundler.KR)(initialNode.attrs.ratio),selected=(0,reactivity_esm_bundler.KR)(!1),readonly=(0,reactivity_esm_bundler.KR)(!view.editable),config=ctx.get(imageBlockConfig.key),app=(0,runtime_dom_esm_bundler.Ef)(MilkdownImageBlock,{src,caption,ratio,selected,readonly,setAttr:(attr,value)=>{if(!view.editable)return;const pos=getPos();null!=pos&&view.dispatch(view.state.tr.setNodeAttribute(pos,attr,"src"===attr?purify_es.A.sanitize(value):value))},config}),dom=document.createElement("div");dom.className="milkdown-image-block";const disposeSelectedWatcher=(0,runtime_core_esm_bundler.nT)(()=>{selected.value?dom.classList.add("selected"):dom.classList.remove("selected")}),proxyDomURL=config.proxyDomURL,bindAttrs=node=>{if(proxyDomURL){const proxiedURL=proxyDomURL(node.attrs.src);"string"==typeof proxiedURL?src.value=proxiedURL:proxiedURL.then(url=>{src.value=url}).catch(console.error)}else src.value=node.attrs.src;ratio.value=node.attrs.ratio,caption.value=node.attrs.caption,readonly.value=!view.editable};return bindAttrs(initialNode),app.mount(dom),{dom,update:updatedNode=>updatedNode.type===initialNode.type&&(bindAttrs(updatedNode),!0),stopEvent:e=>e.target instanceof HTMLInputElement,selectNode:()=>{selected.value=!0},deselectNode:()=>{selected.value=!1},destroy:()=>{disposeSelectedWatcher(),app.unmount(),dom.remove()}}});image_block_withMeta(imageBlockView,{displayName:"NodeView<image-block>",group:"ImageBlock"});const imageBlockComponent=[remarkImageBlockPlugin,imageBlockSchema,imageBlockView,imageBlockConfig].flat();var readFromCache,addToCache,prosemirror_inputrules_dist=__webpack_require__("./node_modules/prosemirror-inputrules/dist/index.js"),prosemirror_model_dist=__webpack_require__("./node_modules/prosemirror-model/dist/index.js"),prosemirror_view_dist=__webpack_require__("./node_modules/prosemirror-view/dist/index.js"),prosemirror_keymap_dist=__webpack_require__("./node_modules/prosemirror-keymap/dist/index.js"),prosemirror_transform_dist=__webpack_require__("./node_modules/prosemirror-transform/dist/index.js");if("undefined"!=typeof WeakMap){let cache=new WeakMap;readFromCache=key=>cache.get(key),addToCache=(key,value)=>(cache.set(key,value),value)}else{const cache=[],cacheSize=10;let cachePos=0;readFromCache=key=>{for(let i=0;i<cache.length;i+=2)if(cache[i]==key)return cache[i+1]},addToCache=(key,value)=>(cachePos==cacheSize&&(cachePos=0),cache[cachePos++]=key,cache[cachePos++]=value)}var dist_TableMap=class{constructor(width,height,map,problems){this.width=width,this.height=height,this.map=map,this.problems=problems}findCell(pos){for(let i=0;i<this.map.length;i++){const curPos=this.map[i];if(curPos!=pos)continue;const left=i%this.width,top=i/this.width|0;let right=left+1,bottom=top+1;for(let j=1;right<this.width&&this.map[i+j]==curPos;j++)right++;for(let j=1;bottom<this.height&&this.map[i+this.width*j]==curPos;j++)bottom++;return{left,top,right,bottom}}throw new RangeError(`No cell with offset ${pos} found`)}colCount(pos){for(let i=0;i<this.map.length;i++)if(this.map[i]==pos)return i%this.width;throw new RangeError(`No cell with offset ${pos} found`)}nextCell(pos,axis,dir){const{left,right,top,bottom}=this.findCell(pos);return"horiz"==axis?(dir<0?0==left:right==this.width)?null:this.map[top*this.width+(dir<0?left-1:right)]:(dir<0?0==top:bottom==this.height)?null:this.map[left+this.width*(dir<0?top-1:bottom)]}rectBetween(a,b){const{left:leftA,right:rightA,top:topA,bottom:bottomA}=this.findCell(a),{left:leftB,right:rightB,top:topB,bottom:bottomB}=this.findCell(b);return{left:Math.min(leftA,leftB),top:Math.min(topA,topB),right:Math.max(rightA,rightB),bottom:Math.max(bottomA,bottomB)}}cellsInRect(rect){const result=[],seen={};for(let row=rect.top;row<rect.bottom;row++)for(let col=rect.left;col<rect.right;col++){const index=row*this.width+col,pos=this.map[index];seen[pos]||(seen[pos]=!0,col==rect.left&&col&&this.map[index-1]==pos||row==rect.top&&row&&this.map[index-this.width]==pos||result.push(pos))}return result}positionAt(row,col,table){for(let i=0,rowStart=0;;i++){const rowEnd=rowStart+table.child(i).nodeSize;if(i==row){let index=col+row*this.width;const rowEndIndex=(row+1)*this.width;for(;index<rowEndIndex&&this.map[index]<rowStart;)index++;return index==rowEndIndex?rowEnd-1:this.map[index]}rowStart=rowEnd}}static get(table){return readFromCache(table)||addToCache(table,function computeMap(table){if("table"!=table.type.spec.tableRole)throw new RangeError("Not a table node: "+table.type.name);const width=function findWidth(table){let width=-1,hasRowSpan=!1;for(let row=0;row<table.childCount;row++){const rowNode=table.child(row);let rowWidth=0;if(hasRowSpan)for(let j=0;j<row;j++){const prevRow=table.child(j);for(let i=0;i<prevRow.childCount;i++){const cell=prevRow.child(i);j+cell.attrs.rowspan>row&&(rowWidth+=cell.attrs.colspan)}}for(let i=0;i<rowNode.childCount;i++){const cell=rowNode.child(i);rowWidth+=cell.attrs.colspan,cell.attrs.rowspan>1&&(hasRowSpan=!0)}-1==width?width=rowWidth:width!=rowWidth&&(width=Math.max(width,rowWidth))}return width}(table),height=table.childCount,map=[];let mapPos=0,problems=null;const colWidths=[];for(let i=0,e=width*height;i<e;i++)map[i]=0;for(let row=0,pos=0;row<height;row++){const rowNode=table.child(row);pos++;for(let i=0;;i++){for(;mapPos<map.length&&0!=map[mapPos];)mapPos++;if(i==rowNode.childCount)break;const cellNode=rowNode.child(i),{colspan,rowspan,colwidth}=cellNode.attrs;for(let h=0;h<rowspan;h++){if(h+row>=height){(problems||(problems=[])).push({type:"overlong_rowspan",pos,n:rowspan-h});break}const start=mapPos+h*width;for(let w=0;w<colspan;w++){0==map[start+w]?map[start+w]=pos:(problems||(problems=[])).push({type:"collision",row,pos,n:colspan-w});const colW=colwidth&&colwidth[w];if(colW){const widthIndex=(start+w)%width*2,prev=colWidths[widthIndex];null==prev||prev!=colW&&1==colWidths[widthIndex+1]?(colWidths[widthIndex]=colW,colWidths[widthIndex+1]=1):prev==colW&&colWidths[widthIndex+1]++}}}mapPos+=colspan,pos+=cellNode.nodeSize}const expectedPos=(row+1)*width;let missing=0;for(;mapPos<expectedPos;)0==map[mapPos++]&&missing++;missing&&(problems||(problems=[])).push({type:"missing",row,n:missing}),pos++}0!==width&&0!==height||(problems||(problems=[])).push({type:"zero_sized"});const tableMap=new dist_TableMap(width,height,map,problems);let badWidths=!1;for(let i=0;!badWidths&&i<colWidths.length;i+=2)null!=colWidths[i]&&colWidths[i+1]<height&&(badWidths=!0);badWidths&&function findBadColWidths(map,colWidths,table){map.problems||(map.problems=[]);const seen={};for(let i=0;i<map.map.length;i++){const pos=map.map[i];if(seen[pos])continue;seen[pos]=!0;const node=table.nodeAt(pos);if(!node)throw new RangeError(`No cell with offset ${pos} found`);let updated=null;const attrs=node.attrs;for(let j=0;j<attrs.colspan;j++){const colWidth=colWidths[2*((i+j)%map.width)];null==colWidth||attrs.colwidth&&attrs.colwidth[j]==colWidth||((updated||(updated=freshColWidth(attrs)))[j]=colWidth)}updated&&map.problems.unshift({type:"colwidth mismatch",pos,colwidth:updated})}}(tableMap,colWidths,table);return tableMap}(table))}};function freshColWidth(attrs){if(attrs.colwidth)return attrs.colwidth.slice();const result=[];for(let i=0;i<attrs.colspan;i++)result.push(0);return result}function getCellAttrs(dom,extraAttrs){if("string"==typeof dom)return{};const widthAttr=dom.getAttribute("data-colwidth"),widths=widthAttr&&/^\d+(,\d+)*$/.test(widthAttr)?widthAttr.split(",").map(s=>Number(s)):null,colspan=Number(dom.getAttribute("colspan")||1),result={colspan,rowspan:Number(dom.getAttribute("rowspan")||1),colwidth:widths&&widths.length==colspan?widths:null};for(const prop in extraAttrs){const getter=extraAttrs[prop].getFromDOM,value=getter&&getter(dom);null!=value&&(result[prop]=value)}return result}function setCellAttrs(node,extraAttrs){const attrs={};1!=node.attrs.colspan&&(attrs.colspan=node.attrs.colspan),1!=node.attrs.rowspan&&(attrs.rowspan=node.attrs.rowspan),node.attrs.colwidth&&(attrs["data-colwidth"]=node.attrs.colwidth.join(","));for(const prop in extraAttrs){const setter=extraAttrs[prop].setDOMAttr;setter&&setter(node.attrs[prop],attrs)}return attrs}function validateColwidth(value){if(null!==value){if(!Array.isArray(value))throw new TypeError("colwidth must be null or an array");for(const item of value)if("number"!=typeof item)throw new TypeError("colwidth must be null or an array of numbers")}}function tableNodeTypes(schema){let result=schema.cached.tableNodeTypes;if(!result){result=schema.cached.tableNodeTypes={};for(const name in schema.nodes){const type=schema.nodes[name],role=type.spec.tableRole;role&&(result[role]=type)}}return result}var tableEditingKey=new prosemirror_state_dist.hs("selectingCells");function cellAround($pos){for(let d=$pos.depth-1;d>0;d--)if("row"==$pos.node(d).type.spec.tableRole)return $pos.node(0).resolve($pos.before(d+1));return null}function isInTable(state){const $head=state.selection.$head;for(let d=$head.depth;d>0;d--)if("row"==$head.node(d).type.spec.tableRole)return!0;return!1}function selectionCell(state){const sel=state.selection;if("$anchorCell"in sel&&sel.$anchorCell)return sel.$anchorCell.pos>sel.$headCell.pos?sel.$anchorCell:sel.$headCell;if("node"in sel&&sel.node&&"cell"==sel.node.type.spec.tableRole)return sel.$anchor;const $cell=cellAround(sel.$head)||cellNear(sel.$head);if($cell)return $cell;throw new RangeError(`No cell found around position ${sel.head}`)}function cellNear($pos){for(let after=$pos.nodeAfter,pos=$pos.pos;after;after=after.firstChild,pos++){const role=after.type.spec.tableRole;if("cell"==role||"header_cell"==role)return $pos.doc.resolve(pos)}for(let before=$pos.nodeBefore,pos=$pos.pos;before;before=before.lastChild,pos--){const role=before.type.spec.tableRole;if("cell"==role||"header_cell"==role)return $pos.doc.resolve(pos-before.nodeSize)}}function pointsAtCell($pos){return"row"==$pos.parent.type.spec.tableRole&&!!$pos.nodeAfter}function inSameTable($cellA,$cellB){return $cellA.depth==$cellB.depth&&$cellA.pos>=$cellB.start(-1)&&$cellA.pos<=$cellB.end(-1)}function nextCell($pos,axis,dir){const table=$pos.node(-1),map=dist_TableMap.get(table),tableStart=$pos.start(-1),moved=map.nextCell($pos.pos-tableStart,axis,dir);return null==moved?null:$pos.node(0).resolve(tableStart+moved)}function removeColSpan(attrs,pos,n=1){const result={...attrs,colspan:attrs.colspan-n};return result.colwidth&&(result.colwidth=result.colwidth.slice(),result.colwidth.splice(pos,n),result.colwidth.some(w=>w>0)||(result.colwidth=null)),result}function addColSpan(attrs,pos,n=1){const result={...attrs,colspan:attrs.colspan+n};if(result.colwidth){result.colwidth=result.colwidth.slice();for(let i=0;i<n;i++)result.colwidth.splice(pos,0,0)}return result}var CellSelection=class _CellSelection extends prosemirror_state_dist.LN{constructor($anchorCell,$headCell=$anchorCell){const table=$anchorCell.node(-1),map=dist_TableMap.get(table),tableStart=$anchorCell.start(-1),rect=map.rectBetween($anchorCell.pos-tableStart,$headCell.pos-tableStart),doc=$anchorCell.node(0),cells=map.cellsInRect(rect).filter(p=>p!=$headCell.pos-tableStart);cells.unshift($headCell.pos-tableStart);const ranges=cells.map(pos=>{const cell=table.nodeAt(pos);if(!cell)throw RangeError(`No cell with offset ${pos} found`);const from=tableStart+pos+1;return new prosemirror_state_dist.yn(doc.resolve(from),doc.resolve(from+cell.content.size))});super(ranges[0].$from,ranges[0].$to,ranges),this.$anchorCell=$anchorCell,this.$headCell=$headCell}map(doc,mapping){const $anchorCell=doc.resolve(mapping.map(this.$anchorCell.pos)),$headCell=doc.resolve(mapping.map(this.$headCell.pos));if(pointsAtCell($anchorCell)&&pointsAtCell($headCell)&&inSameTable($anchorCell,$headCell)){const tableChanged=this.$anchorCell.node(-1)!=$anchorCell.node(-1);return tableChanged&&this.isRowSelection()?_CellSelection.rowSelection($anchorCell,$headCell):tableChanged&&this.isColSelection()?_CellSelection.colSelection($anchorCell,$headCell):new _CellSelection($anchorCell,$headCell)}return prosemirror_state_dist.U3.between($anchorCell,$headCell)}content(){const table=this.$anchorCell.node(-1),map=dist_TableMap.get(table),tableStart=this.$anchorCell.start(-1),rect=map.rectBetween(this.$anchorCell.pos-tableStart,this.$headCell.pos-tableStart),seen={},rows=[];for(let row=rect.top;row<rect.bottom;row++){const rowContent=[];for(let index=row*map.width+rect.left,col=rect.left;col<rect.right;col++,index++){const pos=map.map[index];if(seen[pos])continue;seen[pos]=!0;const cellRect=map.findCell(pos);let cell=table.nodeAt(pos);if(!cell)throw RangeError(`No cell with offset ${pos} found`);const extraLeft=rect.left-cellRect.left,extraRight=cellRect.right-rect.right;if(extraLeft>0||extraRight>0){let attrs=cell.attrs;if(extraLeft>0&&(attrs=removeColSpan(attrs,0,extraLeft)),extraRight>0&&(attrs=removeColSpan(attrs,attrs.colspan-extraRight,extraRight)),cellRect.left<rect.left){if(cell=cell.type.createAndFill(attrs),!cell)throw RangeError(`Could not create cell with attrs ${JSON.stringify(attrs)}`)}else cell=cell.type.create(attrs,cell.content)}if(cellRect.top<rect.top||cellRect.bottom>rect.bottom){const attrs={...cell.attrs,rowspan:Math.min(cellRect.bottom,rect.bottom)-Math.max(cellRect.top,rect.top)};cell=cellRect.top<rect.top?cell.type.createAndFill(attrs):cell.type.create(attrs,cell.content)}rowContent.push(cell)}rows.push(table.child(row).copy(prosemirror_model_dist.FK.from(rowContent)))}const fragment=this.isColSelection()&&this.isRowSelection()?table:rows;return new prosemirror_model_dist.Ji(prosemirror_model_dist.FK.from(fragment),1,1)}replace(tr,content=prosemirror_model_dist.Ji.empty){const mapFrom=tr.steps.length,ranges=this.ranges;for(let i=0;i<ranges.length;i++){const{$from,$to}=ranges[i],mapping=tr.mapping.slice(mapFrom);tr.replace(mapping.map($from.pos),mapping.map($to.pos),i?prosemirror_model_dist.Ji.empty:content)}const sel=prosemirror_state_dist.LN.findFrom(tr.doc.resolve(tr.mapping.slice(mapFrom).map(this.to)),-1);sel&&tr.setSelection(sel)}replaceWith(tr,node){this.replace(tr,new prosemirror_model_dist.Ji(prosemirror_model_dist.FK.from(node),0,0))}forEachCell(f){const table=this.$anchorCell.node(-1),map=dist_TableMap.get(table),tableStart=this.$anchorCell.start(-1),cells=map.cellsInRect(map.rectBetween(this.$anchorCell.pos-tableStart,this.$headCell.pos-tableStart));for(let i=0;i<cells.length;i++)f(table.nodeAt(cells[i]),tableStart+cells[i])}isColSelection(){const anchorTop=this.$anchorCell.index(-1),headTop=this.$headCell.index(-1);if(Math.min(anchorTop,headTop)>0)return!1;const anchorBottom=anchorTop+this.$anchorCell.nodeAfter.attrs.rowspan,headBottom=headTop+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(anchorBottom,headBottom)==this.$headCell.node(-1).childCount}static colSelection($anchorCell,$headCell=$anchorCell){const table=$anchorCell.node(-1),map=dist_TableMap.get(table),tableStart=$anchorCell.start(-1),anchorRect=map.findCell($anchorCell.pos-tableStart),headRect=map.findCell($headCell.pos-tableStart),doc=$anchorCell.node(0);return anchorRect.top<=headRect.top?(anchorRect.top>0&&($anchorCell=doc.resolve(tableStart+map.map[anchorRect.left])),headRect.bottom<map.height&&($headCell=doc.resolve(tableStart+map.map[map.width*(map.height-1)+headRect.right-1]))):(headRect.top>0&&($headCell=doc.resolve(tableStart+map.map[headRect.left])),anchorRect.bottom<map.height&&($anchorCell=doc.resolve(tableStart+map.map[map.width*(map.height-1)+anchorRect.right-1]))),new _CellSelection($anchorCell,$headCell)}isRowSelection(){const table=this.$anchorCell.node(-1),map=dist_TableMap.get(table),tableStart=this.$anchorCell.start(-1),anchorLeft=map.colCount(this.$anchorCell.pos-tableStart),headLeft=map.colCount(this.$headCell.pos-tableStart);if(Math.min(anchorLeft,headLeft)>0)return!1;const anchorRight=anchorLeft+this.$anchorCell.nodeAfter.attrs.colspan,headRight=headLeft+this.$headCell.nodeAfter.attrs.colspan;return Math.max(anchorRight,headRight)==map.width}eq(other){return other instanceof _CellSelection&&other.$anchorCell.pos==this.$anchorCell.pos&&other.$headCell.pos==this.$headCell.pos}static rowSelection($anchorCell,$headCell=$anchorCell){const table=$anchorCell.node(-1),map=dist_TableMap.get(table),tableStart=$anchorCell.start(-1),anchorRect=map.findCell($anchorCell.pos-tableStart),headRect=map.findCell($headCell.pos-tableStart),doc=$anchorCell.node(0);return anchorRect.left<=headRect.left?(anchorRect.left>0&&($anchorCell=doc.resolve(tableStart+map.map[anchorRect.top*map.width])),headRect.right<map.width&&($headCell=doc.resolve(tableStart+map.map[map.width*(headRect.top+1)-1]))):(headRect.left>0&&($headCell=doc.resolve(tableStart+map.map[headRect.top*map.width])),anchorRect.right<map.width&&($anchorCell=doc.resolve(tableStart+map.map[map.width*(anchorRect.top+1)-1]))),new _CellSelection($anchorCell,$headCell)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(doc,json){return new _CellSelection(doc.resolve(json.anchor),doc.resolve(json.head))}static create(doc,anchorCell,headCell=anchorCell){return new _CellSelection(doc.resolve(anchorCell),doc.resolve(headCell))}getBookmark(){return new CellBookmark(this.$anchorCell.pos,this.$headCell.pos)}};CellSelection.prototype.visible=!1,prosemirror_state_dist.LN.jsonID("cell",CellSelection);var CellBookmark=class _CellBookmark{constructor(anchor,head){this.anchor=anchor,this.head=head}map(mapping){return new _CellBookmark(mapping.map(this.anchor),mapping.map(this.head))}resolve(doc){const $anchorCell=doc.resolve(this.anchor),$headCell=doc.resolve(this.head);return"row"==$anchorCell.parent.type.spec.tableRole&&"row"==$headCell.parent.type.spec.tableRole&&$anchorCell.index()<$anchorCell.parent.childCount&&$headCell.index()<$headCell.parent.childCount&&inSameTable($anchorCell,$headCell)?new CellSelection($anchorCell,$headCell):prosemirror_state_dist.LN.near($headCell,1)}};function drawCellSelection(state){if(!(state.selection instanceof CellSelection))return null;const cells=[];return state.selection.forEachCell((node,pos)=>{cells.push(prosemirror_view_dist.NZ.node(pos,pos+node.nodeSize,{class:"selectedCell"}))}),prosemirror_view_dist.zF.create(state.doc,cells)}var fixTablesKey=new prosemirror_state_dist.hs("fix-tables");function changedDescendants(old,cur,offset,f){const oldSize=old.childCount,curSize=cur.childCount;outer:for(let i=0,j=0;i<curSize;i++){const child=cur.child(i);for(let scan=j,e=Math.min(oldSize,i+3);scan<e;scan++)if(old.child(scan)==child){j=scan+1,offset+=child.nodeSize;continue outer}f(child,offset),j<oldSize&&old.child(j).sameMarkup(child)?changedDescendants(old.child(j),child,offset+1,f):child.nodesBetween(0,child.content.size,f,offset+1),offset+=child.nodeSize}}function fixTables(state,oldState){let tr;const check=(node,pos)=>{"table"==node.type.spec.tableRole&&(tr=function fixTable(state,table,tablePos,tr){const map=dist_TableMap.get(table);if(!map.problems)return tr;tr||(tr=state.tr);const mustAdd=[];for(let i=0;i<map.height;i++)mustAdd.push(0);for(let i=0;i<map.problems.length;i++){const prob=map.problems[i];if("collision"==prob.type){const cell=table.nodeAt(prob.pos);if(!cell)continue;const attrs=cell.attrs;for(let j=0;j<attrs.rowspan;j++)mustAdd[prob.row+j]+=prob.n;tr.setNodeMarkup(tr.mapping.map(tablePos+1+prob.pos),null,removeColSpan(attrs,attrs.colspan-prob.n,prob.n))}else if("missing"==prob.type)mustAdd[prob.row]+=prob.n;else if("overlong_rowspan"==prob.type){const cell=table.nodeAt(prob.pos);if(!cell)continue;tr.setNodeMarkup(tr.mapping.map(tablePos+1+prob.pos),null,{...cell.attrs,rowspan:cell.attrs.rowspan-prob.n})}else if("colwidth mismatch"==prob.type){const cell=table.nodeAt(prob.pos);if(!cell)continue;tr.setNodeMarkup(tr.mapping.map(tablePos+1+prob.pos),null,{...cell.attrs,colwidth:prob.colwidth})}else if("zero_sized"==prob.type){const pos=tr.mapping.map(tablePos);tr.delete(pos,pos+table.nodeSize)}}let first,last;for(let i=0;i<mustAdd.length;i++)mustAdd[i]&&(null==first&&(first=i),last=i);for(let i=0,pos=tablePos+1;i<map.height;i++){const row=table.child(i),end=pos+row.nodeSize,add=mustAdd[i];if(add>0){let role="cell";row.firstChild&&(role=row.firstChild.type.spec.tableRole);const nodes=[];for(let j=0;j<add;j++){const node=tableNodeTypes(state.schema)[role].createAndFill();node&&nodes.push(node)}const side=0!=i&&first!=i-1||last!=i?end-1:pos+1;tr.insert(tr.mapping.map(side),nodes)}pos=end}return tr.setMeta(fixTablesKey,{fixTables:!0})}(state,node,pos,tr))};return oldState?oldState.doc!=state.doc&&changedDescendants(oldState.doc,state.doc,0,check):state.doc.descendants(check),tr}function convertTableNodeToArrayOfRows(tableNode){const map=dist_TableMap.get(tableNode),rows=[],rowCount=map.height,colCount2=map.width;for(let rowIndex=0;rowIndex<rowCount;rowIndex++){const row=[];for(let colIndex=0;colIndex<colCount2;colIndex++){const cellIndex=rowIndex*colCount2+colIndex,cellPos=map.map[cellIndex];if(rowIndex>0){const topCellIndex=cellIndex-colCount2;if(cellPos===map.map[topCellIndex]){row.push(null);continue}}if(colIndex>0){const leftCellIndex=cellIndex-1;if(cellPos===map.map[leftCellIndex]){row.push(null);continue}}row.push(tableNode.nodeAt(cellPos))}rows.push(row)}return rows}function convertArrayOfRowsToTableNode(tableNode,arrayOfNodes){const newRows=[],map=dist_TableMap.get(tableNode),rowCount=map.height,colCount2=map.width;for(let rowIndex=0;rowIndex<rowCount;rowIndex++){const oldRow=tableNode.child(rowIndex),newCells=[];for(let colIndex=0;colIndex<colCount2;colIndex++){const cell=arrayOfNodes[rowIndex][colIndex];if(!cell)continue;const cellPos=map.map[rowIndex*map.width+colIndex],oldCell=tableNode.nodeAt(cellPos);if(!oldCell)continue;const newCell=oldCell.type.createChecked(cell.attrs,cell.content,cell.marks);newCells.push(newCell)}const newRow=oldRow.type.createChecked(oldRow.attrs,newCells,oldRow.marks);newRows.push(newRow)}return tableNode.type.createChecked(tableNode.attrs,newRows,tableNode.marks)}function dist_findTable($pos){return function findParentNode(predicate,$pos){for(let depth=$pos.depth;depth>=0;depth-=1){const node=$pos.node(depth);if(predicate(node)){return{node,pos:0===depth?0:$pos.before(depth),start:$pos.start(depth),depth}}}return null}(node=>"table"===node.type.spec.tableRole,$pos)}function getCellsInColumn(columnIndex,selection){const table=dist_findTable(selection.$from);if(!table)return;const map=dist_TableMap.get(table.node);if(columnIndex<0||columnIndex>map.width-1)return;return map.cellsInRect({left:columnIndex,right:columnIndex+1,top:0,bottom:map.height}).map(nodePos=>{const node=table.node.nodeAt(nodePos),pos=nodePos+table.start;return{pos,start:pos+1,node,depth:table.depth+2}})}function getCellsInRow(rowIndex,selection){const table=dist_findTable(selection.$from);if(!table)return;const map=dist_TableMap.get(table.node);if(rowIndex<0||rowIndex>map.height-1)return;return map.cellsInRect({left:0,right:map.width,top:rowIndex,bottom:rowIndex+1}).map(nodePos=>{const node=table.node.nodeAt(nodePos),pos=nodePos+table.start;return{pos,start:pos+1,node,depth:table.depth+2}})}function getSelectionRangeInColumn(tr,startColIndex,endColIndex=startColIndex){let startIndex=startColIndex,endIndex=endColIndex;for(let i=startColIndex;i>=0;i--){const cells=getCellsInColumn(i,tr.selection);cells&&cells.forEach(cell=>{const maybeEndIndex=cell.node.attrs.colspan+i-1;maybeEndIndex>=startIndex&&(startIndex=i),maybeEndIndex>endIndex&&(endIndex=maybeEndIndex)})}for(let i=startColIndex;i<=endIndex;i++){const cells=getCellsInColumn(i,tr.selection);cells&&cells.forEach(cell=>{const maybeEndIndex=cell.node.attrs.colspan+i-1;cell.node.attrs.colspan>1&&maybeEndIndex>endIndex&&(endIndex=maybeEndIndex)})}const indexes=[];for(let i=startIndex;i<=endIndex;i++){const maybeCells=getCellsInColumn(i,tr.selection);maybeCells&&maybeCells.length>0&&indexes.push(i)}startIndex=indexes[0],endIndex=indexes[indexes.length-1];const firstSelectedColumnCells=getCellsInColumn(startIndex,tr.selection),firstRowCells=getCellsInRow(0,tr.selection);if(!firstSelectedColumnCells||!firstRowCells)return;const $anchor=tr.doc.resolve(firstSelectedColumnCells[firstSelectedColumnCells.length-1].pos);let headCell;for(let i=endIndex;i>=startIndex;i--){const columnCells=getCellsInColumn(i,tr.selection);if(columnCells&&columnCells.length>0){for(let j=firstRowCells.length-1;j>=0;j--)if(firstRowCells[j].pos===columnCells[0].pos){headCell=columnCells[0];break}if(headCell)break}}if(!headCell)return;return{$anchor,$head:tr.doc.resolve(headCell.pos),indexes}}function getSelectionRangeInRow(tr,startRowIndex,endRowIndex=startRowIndex){let startIndex=startRowIndex,endIndex=endRowIndex;for(let i=startRowIndex;i>=0;i--){const cells=getCellsInRow(i,tr.selection);cells&&cells.forEach(cell=>{const maybeEndIndex=cell.node.attrs.rowspan+i-1;maybeEndIndex>=startIndex&&(startIndex=i),maybeEndIndex>endIndex&&(endIndex=maybeEndIndex)})}for(let i=startRowIndex;i<=endIndex;i++){const cells=getCellsInRow(i,tr.selection);cells&&cells.forEach(cell=>{const maybeEndIndex=cell.node.attrs.rowspan+i-1;cell.node.attrs.rowspan>1&&maybeEndIndex>endIndex&&(endIndex=maybeEndIndex)})}const indexes=[];for(let i=startIndex;i<=endIndex;i++){const maybeCells=getCellsInRow(i,tr.selection);maybeCells&&maybeCells.length>0&&indexes.push(i)}startIndex=indexes[0],endIndex=indexes[indexes.length-1];const firstSelectedRowCells=getCellsInRow(startIndex,tr.selection),firstColumnCells=getCellsInColumn(0,tr.selection);if(!firstSelectedRowCells||!firstColumnCells)return;const $anchor=tr.doc.resolve(firstSelectedRowCells[firstSelectedRowCells.length-1].pos);let headCell;for(let i=endIndex;i>=startIndex;i--){const rowCells=getCellsInRow(i,tr.selection);if(rowCells&&rowCells.length>0){for(let j=firstColumnCells.length-1;j>=0;j--)if(firstColumnCells[j].pos===rowCells[0].pos){headCell=rowCells[0];break}if(headCell)break}}if(!headCell)return;return{$anchor,$head:tr.doc.resolve(headCell.pos),indexes}}function moveRowInArrayOfRows(rows,indexesOrigin,indexesTarget,directionOverride){const direction=indexesOrigin[0]>indexesTarget[0]?-1:1,rowsExtracted=rows.splice(indexesOrigin[0],indexesOrigin.length),positionOffset=rowsExtracted.length%2==0?1:0;let target;return target=-1===directionOverride&&1===direction?indexesTarget[0]-1:1===directionOverride&&-1===direction?indexesTarget[indexesTarget.length-1]-positionOffset+1:-1===direction?indexesTarget[0]:indexesTarget[indexesTarget.length-1]-positionOffset,rows.splice(target,0,...rowsExtracted),rows}function transpose(array){return array[0].map((_,i)=>array.map(column=>column[i]))}function moveColumn(moveColParams){var _a,_b;const{tr,originIndex,targetIndex,select,pos}=moveColParams,table=dist_findTable(tr.doc.resolve(pos));if(!table)return!1;const indexesOriginColumn=null==(_a=getSelectionRangeInColumn(tr,originIndex))?void 0:_a.indexes,indexesTargetColumn=null==(_b=getSelectionRangeInColumn(tr,targetIndex))?void 0:_b.indexes;if(!indexesOriginColumn||!indexesTargetColumn)return!1;if(indexesOriginColumn.includes(targetIndex))return!1;const newTable=function moveTableColumn(table,indexesOrigin,indexesTarget,direction){let rows=transpose(convertTableNodeToArrayOfRows(table));return rows=moveRowInArrayOfRows(rows,indexesOrigin,indexesTarget,direction),rows=transpose(rows),convertArrayOfRowsToTableNode(table,rows)}(table.node,indexesOriginColumn,indexesTargetColumn,0);if(tr.replaceWith(table.pos,table.pos+table.node.nodeSize,newTable),!select)return!0;const map=dist_TableMap.get(newTable),start=table.start,index=targetIndex,lastCell=map.positionAt(map.height-1,index,newTable),$lastCell=tr.doc.resolve(start+lastCell),firstCell=map.positionAt(0,index,newTable),$firstCell=tr.doc.resolve(start+firstCell);return tr.setSelection(CellSelection.colSelection($lastCell,$firstCell)),!0}function moveRow(moveRowParams){var _a,_b;const{tr,originIndex,targetIndex,select,pos}=moveRowParams,table=dist_findTable(tr.doc.resolve(pos));if(!table)return!1;const indexesOriginRow=null==(_a=getSelectionRangeInRow(tr,originIndex))?void 0:_a.indexes,indexesTargetRow=null==(_b=getSelectionRangeInRow(tr,targetIndex))?void 0:_b.indexes;if(!indexesOriginRow||!indexesTargetRow)return!1;if(indexesOriginRow.includes(targetIndex))return!1;const newTable=function moveTableRow(table,indexesOrigin,indexesTarget,direction){let rows=convertTableNodeToArrayOfRows(table);return rows=moveRowInArrayOfRows(rows,indexesOrigin,indexesTarget,direction),convertArrayOfRowsToTableNode(table,rows)}(table.node,indexesOriginRow,indexesTargetRow,0);if(tr.replaceWith(table.pos,table.pos+table.node.nodeSize,newTable),!select)return!0;const map=dist_TableMap.get(newTable),start=table.start,index=targetIndex,lastCell=map.positionAt(index,map.width-1,newTable),$lastCell=tr.doc.resolve(start+lastCell),firstCell=map.positionAt(index,0,newTable),$firstCell=tr.doc.resolve(start+firstCell);return tr.setSelection(CellSelection.rowSelection($lastCell,$firstCell)),!0}function selectedRect(state){const sel=state.selection,$pos=selectionCell(state),table=$pos.node(-1),tableStart=$pos.start(-1),map=dist_TableMap.get(table);return{...sel instanceof CellSelection?map.rectBetween(sel.$anchorCell.pos-tableStart,sel.$headCell.pos-tableStart):map.findCell($pos.pos-tableStart),tableStart,map,table}}function addColumn(tr,{map,tableStart,table},col){let refColumn=col>0?-1:0;(function columnIsHeader(map,table,col){const headerCell=tableNodeTypes(table.type.schema).header_cell;for(let row=0;row<map.height;row++)if(table.nodeAt(map.map[col+row*map.width]).type!=headerCell)return!1;return!0})(map,table,col+refColumn)&&(refColumn=0==col||col==map.width?null:0);for(let row=0;row<map.height;row++){const index=row*map.width+col;if(col>0&&col<map.width&&map.map[index-1]==map.map[index]){const pos=map.map[index],cell=table.nodeAt(pos);tr.setNodeMarkup(tr.mapping.map(tableStart+pos),null,addColSpan(cell.attrs,col-map.colCount(pos))),row+=cell.attrs.rowspan-1}else{const type=null==refColumn?tableNodeTypes(table.type.schema).cell:table.nodeAt(map.map[index+refColumn]).type,pos=map.positionAt(row,col,table);tr.insert(tr.mapping.map(tableStart+pos),type.createAndFill())}}return tr}function addColumnBefore(state,dispatch){if(!isInTable(state))return!1;if(dispatch){const rect=selectedRect(state);dispatch(addColumn(state.tr,rect,rect.left))}return!0}function addColumnAfter(state,dispatch){if(!isInTable(state))return!1;if(dispatch){const rect=selectedRect(state);dispatch(addColumn(state.tr,rect,rect.right))}return!0}function removeColumn(tr,{map,table,tableStart},col){const mapStart=tr.mapping.maps.length;for(let row=0;row<map.height;){const index=row*map.width+col,pos=map.map[index],cell=table.nodeAt(pos),attrs=cell.attrs;if(col>0&&map.map[index-1]==pos||col<map.width-1&&map.map[index+1]==pos)tr.setNodeMarkup(tr.mapping.slice(mapStart).map(tableStart+pos),null,removeColSpan(attrs,col-map.colCount(pos)));else{const start=tr.mapping.slice(mapStart).map(tableStart+pos);tr.delete(start,start+cell.nodeSize)}row+=attrs.rowspan}}function removeRow(tr,{map,table,tableStart},row){let rowPos=0;for(let i=0;i<row;i++)rowPos+=table.child(i).nodeSize;const nextRow=rowPos+table.child(row).nodeSize,mapFrom=tr.mapping.maps.length;tr.delete(rowPos+tableStart,nextRow+tableStart);const seen=new Set;for(let col=0,index=row*map.width;col<map.width;col++,index++){const pos=map.map[index];if(!seen.has(pos))if(seen.add(pos),row>0&&pos==map.map[index-map.width]){const attrs=table.nodeAt(pos).attrs;tr.setNodeMarkup(tr.mapping.slice(mapFrom).map(pos+tableStart),null,{...attrs,rowspan:attrs.rowspan-1}),col+=attrs.colspan-1}else if(row<map.height&&pos==map.map[index+map.width]){const cell=table.nodeAt(pos),attrs=cell.attrs,copy=cell.type.create({...attrs,rowspan:cell.attrs.rowspan-1},cell.content),newPos=map.positionAt(row+1,col,table);tr.insert(tr.mapping.slice(mapFrom).map(tableStart+newPos),copy),col+=attrs.colspan-1}}}function isHeaderEnabledByType(type,rect,types){const cellPositions=rect.map.cellsInRect({left:0,top:0,right:"row"==type?rect.map.width:1,bottom:"column"==type?rect.map.height:1});for(let i=0;i<cellPositions.length;i++){const cell=rect.table.nodeAt(cellPositions[i]);if(cell&&cell.type!==types.header_cell)return!1}return!0}function toggleHeader(type,options){return(options=options||{useDeprecatedLogic:!1}).useDeprecatedLogic?function deprecated_toggleHeader(type){return function(state,dispatch){if(!isInTable(state))return!1;if(dispatch){const types=tableNodeTypes(state.schema),rect=selectedRect(state),tr=state.tr,cells=rect.map.cellsInRect("column"==type?{left:rect.left,top:0,right:rect.right,bottom:rect.map.height}:"row"==type?{left:0,top:rect.top,right:rect.map.width,bottom:rect.bottom}:rect),nodes=cells.map(pos=>rect.table.nodeAt(pos));for(let i=0;i<cells.length;i++)nodes[i].type==types.header_cell&&tr.setNodeMarkup(rect.tableStart+cells[i],types.cell,nodes[i].attrs);if(0==tr.steps.length)for(let i=0;i<cells.length;i++)tr.setNodeMarkup(rect.tableStart+cells[i],types.header_cell,nodes[i].attrs);dispatch(tr)}return!0}}(type):function(state,dispatch){if(!isInTable(state))return!1;if(dispatch){const types=tableNodeTypes(state.schema),rect=selectedRect(state),tr=state.tr,isHeaderRowEnabled=isHeaderEnabledByType("row",rect,types),isHeaderColumnEnabled=isHeaderEnabledByType("column",rect,types),selectionStartsAt=("column"===type?isHeaderRowEnabled:"row"===type&&isHeaderColumnEnabled)?1:0,cellsRect="column"==type?{left:0,top:selectionStartsAt,right:1,bottom:rect.map.height}:"row"==type?{left:selectionStartsAt,top:0,right:rect.map.width,bottom:1}:rect,newType="column"==type?isHeaderColumnEnabled?types.cell:types.header_cell:"row"==type?isHeaderRowEnabled?types.cell:types.header_cell:types.cell;rect.map.cellsInRect(cellsRect).forEach(relativeCellPos=>{const cellPos=relativeCellPos+rect.tableStart,cell=tr.doc.nodeAt(cellPos);cell&&tr.setNodeMarkup(cellPos,newType,cell.attrs)}),dispatch(tr)}return!0}}toggleHeader("row",{useDeprecatedLogic:!0}),toggleHeader("column",{useDeprecatedLogic:!0}),toggleHeader("cell",{useDeprecatedLogic:!0});function goToNextCell(direction){return function(state,dispatch){if(!isInTable(state))return!1;const cell=function findNextCell($cell,dir){if(dir<0){const before=$cell.nodeBefore;if(before)return $cell.pos-before.nodeSize;for(let row=$cell.index(-1)-1,rowEnd=$cell.before();row>=0;row--){const rowNode=$cell.node(-1).child(row),lastChild=rowNode.lastChild;if(lastChild)return rowEnd-1-lastChild.nodeSize;rowEnd-=rowNode.nodeSize}}else{if($cell.index()<$cell.parent.childCount-1)return $cell.pos+$cell.nodeAfter.nodeSize;const table=$cell.node(-1);for(let row=$cell.indexAfter(-1),rowStart=$cell.after();row<table.childCount;row++){const rowNode=table.child(row);if(rowNode.childCount)return rowStart+1;rowStart+=rowNode.nodeSize}}return null}(selectionCell(state),direction);if(null==cell)return!1;if(dispatch){const $cell=state.doc.resolve(cell);dispatch(state.tr.setSelection(prosemirror_state_dist.U3.between($cell,function moveCellForward($pos){return $pos.node(0).resolve($pos.pos+$pos.nodeAfter.nodeSize)}($cell))).scrollIntoView())}return!0}}function deleteCellSelection(state,dispatch){const sel=state.selection;if(!(sel instanceof CellSelection))return!1;if(dispatch){const tr=state.tr,baseContent=tableNodeTypes(state.schema).cell.createAndFill().content;sel.forEachCell((cell,pos)=>{cell.content.eq(baseContent)||tr.replace(tr.mapping.map(pos+1),tr.mapping.map(pos+cell.nodeSize-1),new prosemirror_model_dist.Ji(baseContent,0,0))}),tr.docChanged&&dispatch(tr)}return!0}function pastedCells(slice){if(!slice.size)return null;let{content,openStart,openEnd}=slice;for(;1==content.childCount&&(openStart>0&&openEnd>0||"table"==content.child(0).type.spec.tableRole);)openStart--,openEnd--,content=content.child(0).content;const first=content.child(0),role=first.type.spec.tableRole,schema=first.type.schema,rows=[];if("row"==role)for(let i=0;i<content.childCount;i++){let cells=content.child(i).content;const left=i?0:Math.max(0,openStart-1),right=i<content.childCount-1?0:Math.max(0,openEnd-1);(left||right)&&(cells=fitSlice(tableNodeTypes(schema).row,new prosemirror_model_dist.Ji(cells,left,right)).content),rows.push(cells)}else{if("cell"!=role&&"header_cell"!=role)return null;rows.push(openStart||openEnd?fitSlice(tableNodeTypes(schema).row,new prosemirror_model_dist.Ji(content,openStart,openEnd)).content:content)}return function ensureRectangular(schema,rows){const widths=[];for(let i=0;i<rows.length;i++){const row=rows[i];for(let j=row.childCount-1;j>=0;j--){const{rowspan,colspan}=row.child(j).attrs;for(let r=i;r<i+rowspan;r++)widths[r]=(widths[r]||0)+colspan}}let width=0;for(let r=0;r<widths.length;r++)width=Math.max(width,widths[r]);for(let r=0;r<widths.length;r++)if(r>=rows.length&&rows.push(prosemirror_model_dist.FK.empty),widths[r]<width){const empty=tableNodeTypes(schema).cell.createAndFill(),cells=[];for(let i=widths[r];i<width;i++)cells.push(empty);rows[r]=rows[r].append(prosemirror_model_dist.FK.from(cells))}return{height:rows.length,width,rows}}(schema,rows)}function fitSlice(nodeType,slice){const node=nodeType.createAndFill();return new prosemirror_transform_dist.dL(node).replace(0,node.content.size,slice).doc}function isolateHorizontal(tr,map,table,start,left,right,top,mapFrom){if(0==top||top==map.height)return!1;let found=!1;for(let col=left;col<right;col++){const index=top*map.width+col,pos=map.map[index];if(map.map[index-map.width]==pos){found=!0;const cell=table.nodeAt(pos),{top:cellTop,left:cellLeft}=map.findCell(pos);tr.setNodeMarkup(tr.mapping.slice(mapFrom).map(pos+start),null,{...cell.attrs,rowspan:top-cellTop}),tr.insert(tr.mapping.slice(mapFrom).map(map.positionAt(top,cellLeft,table)),cell.type.createAndFill({...cell.attrs,rowspan:cellTop+cell.attrs.rowspan-top})),col+=cell.attrs.colspan-1}}return found}function isolateVertical(tr,map,table,start,top,bottom,left,mapFrom){if(0==left||left==map.width)return!1;let found=!1;for(let row=top;row<bottom;row++){const index=row*map.width+left,pos=map.map[index];if(map.map[index-1]==pos){found=!0;const cell=table.nodeAt(pos),cellLeft=map.colCount(pos),updatePos=tr.mapping.slice(mapFrom).map(pos+start);tr.setNodeMarkup(updatePos,null,removeColSpan(cell.attrs,left-cellLeft,cell.attrs.colspan-(left-cellLeft))),tr.insert(updatePos+cell.nodeSize,cell.type.createAndFill(removeColSpan(cell.attrs,0,left-cellLeft))),row+=cell.attrs.rowspan-1}}return found}function insertCells(state,dispatch,tableStart,rect,cells){let table=tableStart?state.doc.nodeAt(tableStart-1):state.doc;if(!table)throw new Error("No table found");let map=dist_TableMap.get(table);const{top,left}=rect,right=left+cells.width,bottom=top+cells.height,tr=state.tr;let mapFrom=0;function recomp(){if(table=tableStart?tr.doc.nodeAt(tableStart-1):tr.doc,!table)throw new Error("No table found");map=dist_TableMap.get(table),mapFrom=tr.mapping.maps.length}(function growTable(tr,map,table,start,width,height,mapFrom){const types=tableNodeTypes(tr.doc.type.schema);let empty,emptyHead;if(width>map.width)for(let row=0,rowEnd=0;row<map.height;row++){const rowNode=table.child(row);rowEnd+=rowNode.nodeSize;const cells=[];let add;add=null==rowNode.lastChild||rowNode.lastChild.type==types.cell?empty||(empty=types.cell.createAndFill()):emptyHead||(emptyHead=types.header_cell.createAndFill());for(let i=map.width;i<width;i++)cells.push(add);tr.insert(tr.mapping.slice(mapFrom).map(rowEnd-1+start),cells)}if(height>map.height){const cells=[];for(let i=0,start2=(map.height-1)*map.width;i<Math.max(map.width,width);i++){const header=!(i>=map.width)&&table.nodeAt(map.map[start2+i]).type==types.header_cell;cells.push(header?emptyHead||(emptyHead=types.header_cell.createAndFill()):empty||(empty=types.cell.createAndFill()))}const emptyRow=types.row.create(null,prosemirror_model_dist.FK.from(cells)),rows=[];for(let i=map.height;i<height;i++)rows.push(emptyRow);tr.insert(tr.mapping.slice(mapFrom).map(start+table.nodeSize-2),rows)}return!(!empty&&!emptyHead)})(tr,map,table,tableStart,right,bottom,mapFrom)&&recomp(),isolateHorizontal(tr,map,table,tableStart,left,right,top,mapFrom)&&recomp(),isolateHorizontal(tr,map,table,tableStart,left,right,bottom,mapFrom)&&recomp(),isolateVertical(tr,map,table,tableStart,top,bottom,left,mapFrom)&&recomp(),isolateVertical(tr,map,table,tableStart,top,bottom,right,mapFrom)&&recomp();for(let row=top;row<bottom;row++){const from=map.positionAt(row,left,table),to=map.positionAt(row,right,table);tr.replace(tr.mapping.slice(mapFrom).map(from+tableStart),tr.mapping.slice(mapFrom).map(to+tableStart),new prosemirror_model_dist.Ji(cells.rows[row-top],0,0))}recomp(),tr.setSelection(new CellSelection(tr.doc.resolve(tableStart+map.positionAt(top,left,table)),tr.doc.resolve(tableStart+map.positionAt(bottom-1,right-1,table)))),dispatch(tr)}var handleKeyDown=(0,prosemirror_keymap_dist.K)({ArrowLeft:arrow("horiz",-1),ArrowRight:arrow("horiz",1),ArrowUp:arrow("vert",-1),ArrowDown:arrow("vert",1),"Shift-ArrowLeft":shiftArrow("horiz",-1),"Shift-ArrowRight":shiftArrow("horiz",1),"Shift-ArrowUp":shiftArrow("vert",-1),"Shift-ArrowDown":shiftArrow("vert",1),Backspace:deleteCellSelection,"Mod-Backspace":deleteCellSelection,Delete:deleteCellSelection,"Mod-Delete":deleteCellSelection});function maybeSetSelection(state,dispatch,selection){return!selection.eq(state.selection)&&(dispatch&&dispatch(state.tr.setSelection(selection).scrollIntoView()),!0)}function arrow(axis,dir){return(state,dispatch,view)=>{if(!view)return!1;const sel=state.selection;if(sel instanceof CellSelection)return maybeSetSelection(state,dispatch,prosemirror_state_dist.LN.near(sel.$headCell,dir));if("horiz"!=axis&&!sel.empty)return!1;const end=atEndOfCell(view,axis,dir);if(null==end)return!1;if("horiz"==axis)return maybeSetSelection(state,dispatch,prosemirror_state_dist.LN.near(state.doc.resolve(sel.head+dir),dir));{const $cell=state.doc.resolve(end),$next=nextCell($cell,axis,dir);let newSel;return newSel=$next?prosemirror_state_dist.LN.near($next,1):dir<0?prosemirror_state_dist.LN.near(state.doc.resolve($cell.before(-1)),-1):prosemirror_state_dist.LN.near(state.doc.resolve($cell.after(-1)),1),maybeSetSelection(state,dispatch,newSel)}}}function shiftArrow(axis,dir){return(state,dispatch,view)=>{if(!view)return!1;const sel=state.selection;let cellSel;if(sel instanceof CellSelection)cellSel=sel;else{const end=atEndOfCell(view,axis,dir);if(null==end)return!1;cellSel=new CellSelection(state.doc.resolve(end))}const $head=nextCell(cellSel.$headCell,axis,dir);return!!$head&&maybeSetSelection(state,dispatch,new CellSelection(cellSel.$anchorCell,$head))}}function handleTripleClick(view,pos){const $cell=cellAround(view.state.doc.resolve(pos));return!!$cell&&(view.dispatch(view.state.tr.setSelection(new CellSelection($cell))),!0)}function handlePaste(view,_,slice){if(!isInTable(view.state))return!1;let cells=pastedCells(slice);const sel=view.state.selection;if(sel instanceof CellSelection){cells||(cells={width:1,height:1,rows:[prosemirror_model_dist.FK.from(fitSlice(tableNodeTypes(view.state.schema).cell,slice))]});const table=sel.$anchorCell.node(-1),start=sel.$anchorCell.start(-1),rect=dist_TableMap.get(table).rectBetween(sel.$anchorCell.pos-start,sel.$headCell.pos-start);return cells=function clipCells({width,height,rows},newWidth,newHeight){if(width!=newWidth){const added=[],newRows=[];for(let row=0;row<rows.length;row++){const frag=rows[row],cells=[];for(let col=added[row]||0,i=0;col<newWidth;i++){let cell=frag.child(i%frag.childCount);col+cell.attrs.colspan>newWidth&&(cell=cell.type.createChecked(removeColSpan(cell.attrs,cell.attrs.colspan,col+cell.attrs.colspan-newWidth),cell.content)),cells.push(cell),col+=cell.attrs.colspan;for(let j=1;j<cell.attrs.rowspan;j++)added[row+j]=(added[row+j]||0)+cell.attrs.colspan}newRows.push(prosemirror_model_dist.FK.from(cells))}rows=newRows,width=newWidth}if(height!=newHeight){const newRows=[];for(let row=0,i=0;row<newHeight;row++,i++){const cells=[],source=rows[i%height];for(let j=0;j<source.childCount;j++){let cell=source.child(j);row+cell.attrs.rowspan>newHeight&&(cell=cell.type.create({...cell.attrs,rowspan:Math.max(1,newHeight-cell.attrs.rowspan)},cell.content)),cells.push(cell)}newRows.push(prosemirror_model_dist.FK.from(cells))}rows=newRows,height=newHeight}return{width,height,rows}}(cells,rect.right-rect.left,rect.bottom-rect.top),insertCells(view.state,view.dispatch,start,rect,cells),!0}if(cells){const $cell=selectionCell(view.state),start=$cell.start(-1);return insertCells(view.state,view.dispatch,start,dist_TableMap.get($cell.node(-1)).findCell($cell.pos-start),cells),!0}return!1}function handleMouseDown(view,startEvent){var _a;if(startEvent.ctrlKey||startEvent.metaKey)return;const startDOMCell=domInCell(view,startEvent.target);let $anchor;if(startEvent.shiftKey&&view.state.selection instanceof CellSelection)setCellSelection(view.state.selection.$anchorCell,startEvent),startEvent.preventDefault();else if(startEvent.shiftKey&&startDOMCell&&null!=($anchor=cellAround(view.state.selection.$anchor))&&(null==(_a=cellUnderMouse(view,startEvent))?void 0:_a.pos)!=$anchor.pos)setCellSelection($anchor,startEvent),startEvent.preventDefault();else if(!startDOMCell)return;function setCellSelection($anchor2,event){let $head=cellUnderMouse(view,event);const starting=null==tableEditingKey.getState(view.state);if(!$head||!inSameTable($anchor2,$head)){if(!starting)return;$head=$anchor2}const selection=new CellSelection($anchor2,$head);if(starting||!view.state.selection.eq(selection)){const tr=view.state.tr.setSelection(selection);starting&&tr.setMeta(tableEditingKey,$anchor2.pos),view.dispatch(tr)}}function stop(){view.root.removeEventListener("mouseup",stop),view.root.removeEventListener("dragstart",stop),view.root.removeEventListener("mousemove",move),null!=tableEditingKey.getState(view.state)&&view.dispatch(view.state.tr.setMeta(tableEditingKey,-1))}function move(_event){const event=_event,anchor=tableEditingKey.getState(view.state);let $anchor2;if(null!=anchor)$anchor2=view.state.doc.resolve(anchor);else if(domInCell(view,event.target)!=startDOMCell&&($anchor2=cellUnderMouse(view,startEvent),!$anchor2))return stop();$anchor2&&setCellSelection($anchor2,event)}view.root.addEventListener("mouseup",stop),view.root.addEventListener("dragstart",stop),view.root.addEventListener("mousemove",move)}function atEndOfCell(view,axis,dir){if(!(view.state.selection instanceof prosemirror_state_dist.U3))return null;const{$head}=view.state.selection;for(let d=$head.depth-1;d>=0;d--){const parent=$head.node(d);if((dir<0?$head.index(d):$head.indexAfter(d))!=(dir<0?0:parent.childCount))return null;if("cell"==parent.type.spec.tableRole||"header_cell"==parent.type.spec.tableRole){const cellPos=$head.before(d),dirStr="vert"==axis?dir>0?"down":"up":dir>0?"right":"left";return view.endOfTextblock(dirStr)?cellPos:null}}return null}function domInCell(view,dom){for(;dom&&dom!=view.dom;dom=dom.parentNode)if("TD"==dom.nodeName||"TH"==dom.nodeName)return dom;return null}function cellUnderMouse(view,event){const mousePos=view.posAtCoords({left:event.clientX,top:event.clientY});return mousePos&&mousePos?cellAround(view.state.doc.resolve(mousePos.pos)):null}var TableView=class{constructor(node,defaultCellMinWidth){this.node=node,this.defaultCellMinWidth=defaultCellMinWidth,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${defaultCellMinWidth}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),updateColumnsOnResize(node,this.colgroup,this.table,defaultCellMinWidth),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(node){return node.type==this.node.type&&(this.node=node,updateColumnsOnResize(node,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(record){return"attributes"==record.type&&(record.target==this.table||this.colgroup.contains(record.target))}};function updateColumnsOnResize(node,colgroup,table,defaultCellMinWidth,overrideCol,overrideValue){var _a;let totalWidth=0,fixedWidth=!0,nextDOM=colgroup.firstChild;const row=node.firstChild;if(row){for(let i=0,col=0;i<row.childCount;i++){const{colspan,colwidth}=row.child(i).attrs;for(let j=0;j<colspan;j++,col++){const hasWidth=overrideCol==col?overrideValue:colwidth&&colwidth[j],cssWidth=hasWidth?hasWidth+"px":"";if(totalWidth+=hasWidth||defaultCellMinWidth,hasWidth||(fixedWidth=!1),nextDOM)nextDOM.style.width!=cssWidth&&(nextDOM.style.width=cssWidth),nextDOM=nextDOM.nextSibling;else{const col2=document.createElement("col");col2.style.width=cssWidth,colgroup.appendChild(col2)}}}for(;nextDOM;){const after=nextDOM.nextSibling;null==(_a=nextDOM.parentNode)||_a.removeChild(nextDOM),nextDOM=after}fixedWidth?(table.style.width=totalWidth+"px",table.style.minWidth=""):(table.style.width="",table.style.minWidth=totalWidth+"px")}}var columnResizingPluginKey=new prosemirror_state_dist.hs("tableColumnResizing");function columnResizing({handleWidth=5,cellMinWidth=25,defaultCellMinWidth=100,View=TableView,lastColumnResizable=!0}={}){const plugin=new prosemirror_state_dist.k_({key:columnResizingPluginKey,state:{init(_,state){var _a,_b;const nodeViews=null==(_b=null==(_a=plugin.spec)?void 0:_a.props)?void 0:_b.nodeViews,tableName=tableNodeTypes(state.schema).table.name;return View&&nodeViews&&(nodeViews[tableName]=(node,view)=>new View(node,defaultCellMinWidth,view)),new ResizeState(-1,!1)},apply:(tr,prev)=>prev.apply(tr)},props:{attributes:state=>{const pluginState=columnResizingPluginKey.getState(state);return pluginState&&pluginState.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(view,event)=>{!function handleMouseMove(view,event,handleWidth,lastColumnResizable){if(!view.editable)return;const pluginState=columnResizingPluginKey.getState(view.state);if(!pluginState)return;if(!pluginState.dragging){const target=function domCellAround(target){for(;target&&"TD"!=target.nodeName&&"TH"!=target.nodeName;)target=target.classList&&target.classList.contains("ProseMirror")?null:target.parentNode;return target}(event.target);let cell=-1;if(target){const{left,right}=target.getBoundingClientRect();event.clientX-left<=handleWidth?cell=edgeCell(view,event,"left",handleWidth):right-event.clientX<=handleWidth&&(cell=edgeCell(view,event,"right",handleWidth))}if(cell!=pluginState.activeHandle){if(!lastColumnResizable&&-1!==cell){const $cell=view.state.doc.resolve(cell),table=$cell.node(-1),map=dist_TableMap.get(table),tableStart=$cell.start(-1);if(map.colCount($cell.pos-tableStart)+$cell.nodeAfter.attrs.colspan-1==map.width-1)return}updateHandle(view,cell)}}}(view,event,handleWidth,lastColumnResizable)},mouseleave:view=>{!function handleMouseLeave(view){if(!view.editable)return;const pluginState=columnResizingPluginKey.getState(view.state);pluginState&&pluginState.activeHandle>-1&&!pluginState.dragging&&updateHandle(view,-1)}(view)},mousedown:(view,event)=>{!function handleMouseDown2(view,event,cellMinWidth,defaultCellMinWidth){var _a;if(!view.editable)return!1;const win=null!=(_a=view.dom.ownerDocument.defaultView)?_a:window,pluginState=columnResizingPluginKey.getState(view.state);if(!pluginState||-1==pluginState.activeHandle||pluginState.dragging)return!1;const cell=view.state.doc.nodeAt(pluginState.activeHandle),width=function currentColWidth(view,cellPos,{colspan,colwidth}){const width=colwidth&&colwidth[colwidth.length-1];if(width)return width;const dom=view.domAtPos(cellPos);let domWidth=dom.node.childNodes[dom.offset].offsetWidth,parts=colspan;if(colwidth)for(let i=0;i<colspan;i++)colwidth[i]&&(domWidth-=colwidth[i],parts--);return domWidth/parts}(view,pluginState.activeHandle,cell.attrs);function finish(event2){win.removeEventListener("mouseup",finish),win.removeEventListener("mousemove",move);const pluginState2=columnResizingPluginKey.getState(view.state);(null==pluginState2?void 0:pluginState2.dragging)&&(!function updateColumnWidth(view,cell,width){const $cell=view.state.doc.resolve(cell),table=$cell.node(-1),map=dist_TableMap.get(table),start=$cell.start(-1),col=map.colCount($cell.pos-start)+$cell.nodeAfter.attrs.colspan-1,tr=view.state.tr;for(let row=0;row<map.height;row++){const mapIndex=row*map.width+col;if(row&&map.map[mapIndex]==map.map[mapIndex-map.width])continue;const pos=map.map[mapIndex],attrs=table.nodeAt(pos).attrs,index=1==attrs.colspan?0:col-map.colCount(pos);if(attrs.colwidth&&attrs.colwidth[index]==width)continue;const colwidth=attrs.colwidth?attrs.colwidth.slice():zeroes(attrs.colspan);colwidth[index]=width,tr.setNodeMarkup(start+pos,null,{...attrs,colwidth})}tr.docChanged&&view.dispatch(tr)}(view,pluginState2.activeHandle,draggedWidth(pluginState2.dragging,event2,cellMinWidth)),view.dispatch(view.state.tr.setMeta(columnResizingPluginKey,{setDragging:null})))}function move(event2){if(!event2.which)return finish(event2);const pluginState2=columnResizingPluginKey.getState(view.state);if(pluginState2&&pluginState2.dragging){const dragged=draggedWidth(pluginState2.dragging,event2,cellMinWidth);displayColumnWidth(view,pluginState2.activeHandle,dragged,defaultCellMinWidth)}}return view.dispatch(view.state.tr.setMeta(columnResizingPluginKey,{setDragging:{startX:event.clientX,startWidth:width}})),displayColumnWidth(view,pluginState.activeHandle,width,defaultCellMinWidth),win.addEventListener("mouseup",finish),win.addEventListener("mousemove",move),event.preventDefault(),!0}(view,event,cellMinWidth,defaultCellMinWidth)}},decorations:state=>{const pluginState=columnResizingPluginKey.getState(state);if(pluginState&&pluginState.activeHandle>-1)return function handleDecorations(state,cell){var _a;const decorations=[],$cell=state.doc.resolve(cell),table=$cell.node(-1);if(!table)return prosemirror_view_dist.zF.empty;const map=dist_TableMap.get(table),start=$cell.start(-1),col=map.colCount($cell.pos-start)+$cell.nodeAfter.attrs.colspan-1;for(let row=0;row<map.height;row++){const index=col+row*map.width;if(!(col!=map.width-1&&map.map[index]==map.map[index+1]||0!=row&&map.map[index]==map.map[index-map.width])){const cellPos=map.map[index],pos=start+cellPos+table.nodeAt(cellPos).nodeSize-1,dom=document.createElement("div");dom.className="column-resize-handle",(null==(_a=columnResizingPluginKey.getState(state))?void 0:_a.dragging)&&decorations.push(prosemirror_view_dist.NZ.node(start+cellPos,start+cellPos+table.nodeAt(cellPos).nodeSize,{class:"column-resize-dragging"})),decorations.push(prosemirror_view_dist.NZ.widget(pos,dom))}}return prosemirror_view_dist.zF.create(state.doc,decorations)}(state,pluginState.activeHandle)},nodeViews:{}}});return plugin}var ResizeState=class _ResizeState{constructor(activeHandle,dragging){this.activeHandle=activeHandle,this.dragging=dragging}apply(tr){const state=this,action=tr.getMeta(columnResizingPluginKey);if(action&&null!=action.setHandle)return new _ResizeState(action.setHandle,!1);if(action&&void 0!==action.setDragging)return new _ResizeState(state.activeHandle,action.setDragging);if(state.activeHandle>-1&&tr.docChanged){let handle=tr.mapping.map(state.activeHandle,-1);return pointsAtCell(tr.doc.resolve(handle))||(handle=-1),new _ResizeState(handle,state.dragging)}return state}};function edgeCell(view,event,side,handleWidth){const offset="right"==side?-handleWidth:handleWidth,found=view.posAtCoords({left:event.clientX+offset,top:event.clientY});if(!found)return-1;const{pos}=found,$cell=cellAround(view.state.doc.resolve(pos));if(!$cell)return-1;if("right"==side)return $cell.pos;const map=dist_TableMap.get($cell.node(-1)),start=$cell.start(-1),index=map.map.indexOf($cell.pos-start);return index%map.width==0?-1:start+map.map[index-1]}function draggedWidth(dragging,event,resizeMinWidth){const offset=event.clientX-dragging.startX;return Math.max(resizeMinWidth,dragging.startWidth+offset)}function updateHandle(view,value){view.dispatch(view.state.tr.setMeta(columnResizingPluginKey,{setHandle:value}))}function displayColumnWidth(view,cell,width,defaultCellMinWidth){const $cell=view.state.doc.resolve(cell),table=$cell.node(-1),start=$cell.start(-1),col=dist_TableMap.get(table).colCount($cell.pos-start)+$cell.nodeAfter.attrs.colspan-1;let dom=view.domAtPos($cell.start(-1)).node;for(;dom&&"TABLE"!=dom.nodeName;)dom=dom.parentNode;dom&&updateColumnsOnResize(table,dom.firstChild,dom,defaultCellMinWidth,col,width)}function zeroes(n){return Array(n).fill(0)}function tableEditing({allowTableNodeSelection=!1}={}){return new prosemirror_state_dist.k_({key:tableEditingKey,state:{init:()=>null,apply(tr,cur){const set=tr.getMeta(tableEditingKey);if(null!=set)return-1==set?null:set;if(null==cur||!tr.docChanged)return cur;const{deleted,pos}=tr.mapping.mapResult(cur);return deleted?null:pos}},props:{decorations:drawCellSelection,handleDOMEvents:{mousedown:handleMouseDown},createSelectionBetween:view=>null!=tableEditingKey.getState(view.state)?view.state.selection:null,handleTripleClick,handleKeyDown,handlePaste},appendTransaction:(_,oldState,state)=>function normalizeSelection(state,tr,allowTableNodeSelection){const sel=(tr||state).selection,doc=(tr||state).doc;let normalize,role;if(sel instanceof prosemirror_state_dist.nh&&(role=sel.node.type.spec.tableRole)){if("cell"==role||"header_cell"==role)normalize=CellSelection.create(doc,sel.from);else if("row"==role){const $cell=doc.resolve(sel.from+1);normalize=CellSelection.rowSelection($cell,$cell)}else if(!allowTableNodeSelection){const map=dist_TableMap.get(sel.node),start=sel.from+1,lastCell=start+map.map[map.width*map.height-1];normalize=CellSelection.create(doc,start+1,lastCell)}}else sel instanceof prosemirror_state_dist.U3&&function isCellBoundarySelection({$from,$to}){if($from.pos==$to.pos||$from.pos<$to.pos-6)return!1;let afterFrom=$from.pos,beforeTo=$to.pos,depth=$from.depth;for(;depth>=0&&!($from.after(depth+1)<$from.end(depth));depth--,afterFrom++);for(let d=$to.depth;d>=0&&!($to.before(d+1)>$to.start(d));d--,beforeTo--);return afterFrom==beforeTo&&/row|table/.test($from.node(depth).type.spec.tableRole)}(sel)?normalize=prosemirror_state_dist.U3.create(doc,sel.from):sel instanceof prosemirror_state_dist.U3&&function isTextSelectionAcrossCells({$from,$to}){let fromCellBoundaryNode,toCellBoundaryNode;for(let i=$from.depth;i>0;i--){const node=$from.node(i);if("cell"===node.type.spec.tableRole||"header_cell"===node.type.spec.tableRole){fromCellBoundaryNode=node;break}}for(let i=$to.depth;i>0;i--){const node=$to.node(i);if("cell"===node.type.spec.tableRole||"header_cell"===node.type.spec.tableRole){toCellBoundaryNode=node;break}}return fromCellBoundaryNode!==toCellBoundaryNode&&0===$to.parentOffset}(sel)&&(normalize=prosemirror_state_dist.U3.create(doc,sel.$from.start(),sel.$from.end()));return normalize&&(tr||(tr=state.tr)).setSelection(normalize),tr}(state,fixTables(state,oldState),allowTableNodeSelection)})}var prosemirror_commands_dist=__webpack_require__("./node_modules/prosemirror-commands/dist/index.js"),nav="undefined"!=typeof navigator?navigator:null,agent=nav&&nav.userAgent||"",ie_edge=/Edge\/(\d+)/.exec(agent),ie_upto10=/MSIE \d/.exec(agent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(agent),safari=!!!(ie_upto10||ie_11up||ie_edge)&&!!nav&&/Apple Computer/.test(nav.vendor),key=new prosemirror_state_dist.hs("safari-ime-span"),isComposing=!1,spec={key,props:{decorations:function createDecorations(state){const{$from,$to,to}=state.selection;if(isComposing&&$from.sameParent($to)){const deco=prosemirror_view_dist.NZ.widget(to,createSpan,{ignoreSelection:!0,key:"safari-ime-span"});return prosemirror_view_dist.zF.create(state.doc,[deco])}},handleDOMEvents:{compositionstart:()=>{isComposing=!0},compositionend:()=>{isComposing=!1}}}};function createSpan(view){const span=view.dom.ownerDocument.createElement("span");return span.className="ProseMirror-safari-ime-span",span}var imeSpan=new prosemirror_state_dist.k_(safari?spec:{key}),remark_gfm_lib=__webpack_require__("./node_modules/remark-gfm/lib/index.js");function lib_withMeta(plugin,meta){return Object.assign(plugin,{meta:{package:"@milkdown/preset-gfm",...meta}}),plugin}const strikethroughAttr=(0,utils_lib.JY)("strike_through");lib_withMeta(strikethroughAttr,{displayName:"Attr<strikethrough>",group:"Strikethrough"});const strikethroughSchema=(0,utils_lib.hk)("strike_through",ctx=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:value=>"line-through"===value}],toDOM:mark=>["del",ctx.get(strikethroughAttr.key)(mark)],parseMarkdown:{match:node=>"delete"===node.type,runner:(state,node,markType)=>{state.openMark(markType),state.next(node.children),state.closeMark(markType)}},toMarkdown:{match:mark=>"strike_through"===mark.type.name,runner:(state,mark)=>{state.withMark(mark,"delete")}}}));lib_withMeta(strikethroughSchema.mark,{displayName:"MarkSchema<strikethrough>",group:"Strikethrough"}),lib_withMeta(strikethroughSchema.ctx,{displayName:"MarkSchemaCtx<strikethrough>",group:"Strikethrough"});const toggleStrikethroughCommand=(0,utils_lib.yu)("ToggleStrikeThrough",ctx=>()=>(0,prosemirror_commands_dist.wh)(strikethroughSchema.type(ctx)));lib_withMeta(toggleStrikethroughCommand,{displayName:"Command<ToggleStrikethrough>",group:"Strikethrough"});const strikethroughInputRule=(0,utils_lib.b_)(ctx=>(0,lib.uX)(new RegExp("(?<![\\w:/])(~{1,2})(.+?)\\1(?!\\w|\\/)"),strikethroughSchema.type(ctx)));lib_withMeta(strikethroughInputRule,{displayName:"InputRule<strikethrough>",group:"Strikethrough"});const strikethroughKeymap=(0,utils_lib.pq)("strikeThroughKeymap",{ToggleStrikethrough:{shortcuts:"Mod-Alt-x",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(toggleStrikethroughCommand.key)}}});lib_withMeta(strikethroughKeymap.ctx,{displayName:"KeymapCtx<strikethrough>",group:"Strikethrough"}),lib_withMeta(strikethroughKeymap.shortcuts,{displayName:"Keymap<strikethrough>",group:"Strikethrough"});const originalSchema=function tableNodes(options){const extraAttrs=options.cellAttributes||{},cellAttrs={colspan:{default:1,validate:"number"},rowspan:{default:1,validate:"number"},colwidth:{default:null,validate:validateColwidth}};for(const prop in extraAttrs)cellAttrs[prop]={default:extraAttrs[prop].default,validate:extraAttrs[prop].validate};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:options.tableGroup,parseDOM:[{tag:"table"}],toDOM:()=>["table",["tbody",0]]},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:()=>["tr",0]},table_cell:{content:options.cellContent,attrs:cellAttrs,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:dom=>getCellAttrs(dom,extraAttrs)}],toDOM:node=>["td",setCellAttrs(node,extraAttrs),0]},table_header:{content:options.cellContent,attrs:cellAttrs,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:dom=>getCellAttrs(dom,extraAttrs)}],toDOM:node=>["th",setCellAttrs(node,extraAttrs),0]}}}({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:dom=>dom.style.textAlign||"left",setDOMAttr:(value,attrs)=>{attrs.style=`text-align: ${value||"left"}`}}}}),tableSchema=(0,utils_lib.Yh)("table",()=>({...originalSchema.table,content:"table_header_row table_row+",disableDropCursor:!0,parseMarkdown:{match:node=>"table"===node.type,runner:(state,node,type)=>{const align=node.align,children=node.children.map((x,i)=>({...x,align,isHeader:0===i}));state.openNode(type),state.next(children),state.closeNode()}},toMarkdown:{match:node=>"table"===node.type.name,runner:(state,node)=>{const firstLine=node.content.firstChild?.content;if(!firstLine)return;const align=[];firstLine.forEach(cell=>{align.push(cell.attrs.alignment)}),state.openNode("table",void 0,{align}),state.next(node.content),state.closeNode()}}}));lib_withMeta(tableSchema.node,{displayName:"NodeSchema<table>",group:"Table"}),lib_withMeta(tableSchema.ctx,{displayName:"NodeSchemaCtx<table>",group:"Table"});const tableHeaderRowSchema=(0,utils_lib.Yh)("table_header_row",()=>({...originalSchema.table_row,disableDropCursor:!0,content:"(table_header)*",parseDOM:[{tag:"tr[data-is-header]"}],toDOM:()=>["tr",{"data-is-header":!0},0],parseMarkdown:{match:node=>Boolean("tableRow"===node.type&&node.isHeader),runner:(state,node,type)=>{const align=node.align,children=node.children.map((x,i)=>({...x,align:align[i],isHeader:node.isHeader}));state.openNode(type),state.next(children),state.closeNode()}},toMarkdown:{match:node=>"table_header_row"===node.type.name,runner:(state,node)=>{state.openNode("tableRow",void 0,{isHeader:!0}),state.next(node.content),state.closeNode()}}}));lib_withMeta(tableHeaderRowSchema.node,{displayName:"NodeSchema<tableHeaderRow>",group:"Table"}),lib_withMeta(tableHeaderRowSchema.ctx,{displayName:"NodeSchemaCtx<tableHeaderRow>",group:"Table"});const tableRowSchema=(0,utils_lib.Yh)("table_row",()=>({...originalSchema.table_row,disableDropCursor:!0,content:"(table_cell)*",parseMarkdown:{match:node=>"tableRow"===node.type,runner:(state,node,type)=>{const align=node.align,children=node.children.map((x,i)=>({...x,align:align[i]}));state.openNode(type),state.next(children),state.closeNode()}},toMarkdown:{match:node=>"table_row"===node.type.name,runner:(state,node)=>{0!==node.content.size&&(state.openNode("tableRow"),state.next(node.content),state.closeNode())}}}));lib_withMeta(tableRowSchema.node,{displayName:"NodeSchema<tableRow>",group:"Table"}),lib_withMeta(tableRowSchema.ctx,{displayName:"NodeSchemaCtx<tableRow>",group:"Table"});const tableCellSchema=(0,utils_lib.Yh)("table_cell",()=>({...originalSchema.table_cell,disableDropCursor:!0,parseMarkdown:{match:node=>"tableCell"===node.type&&!node.isHeader,runner:(state,node,type)=>{const align=node.align;state.openNode(type,{alignment:align}).openNode(state.schema.nodes.paragraph).next(node.children).closeNode().closeNode()}},toMarkdown:{match:node=>"table_cell"===node.type.name,runner:(state,node)=>{state.openNode("tableCell").next(node.content).closeNode()}}}));lib_withMeta(tableCellSchema.node,{displayName:"NodeSchema<tableCell>",group:"Table"}),lib_withMeta(tableCellSchema.ctx,{displayName:"NodeSchemaCtx<tableCell>",group:"Table"});const tableHeaderSchema=(0,utils_lib.Yh)("table_header",()=>({...originalSchema.table_header,disableDropCursor:!0,parseMarkdown:{match:node=>"tableCell"===node.type&&!!node.isHeader,runner:(state,node,type)=>{const align=node.align;state.openNode(type,{alignment:align}),state.openNode(state.schema.nodes.paragraph),state.next(node.children),state.closeNode(),state.closeNode()}},toMarkdown:{match:node=>"table_header"===node.type.name,runner:(state,node)=>{state.openNode("tableCell"),state.next(node.content),state.closeNode()}}}));function createTable(ctx,rowsCount=3,colsCount=3){const cells=Array(colsCount).fill(0).map(()=>tableCellSchema.type(ctx).createAndFill()),headerCells=Array(colsCount).fill(0).map(()=>tableHeaderSchema.type(ctx).createAndFill()),rows=Array(rowsCount).fill(0).map((_,i)=>0===i?tableHeaderRowSchema.type(ctx).create(null,headerCells):tableRowSchema.type(ctx).create(null,cells));return tableSchema.type(ctx).create(null,rows)}function selectLine(type){return(index,pos)=>tr=>{pos=pos??tr.selection.from;const $pos=tr.doc.resolve(pos),$node=(0,lib.eL)(node=>"table"===node.type.name)($pos),table=$node?{node:$node.node,from:$node.start}:void 0,isRowSelection="row"===type;if(table){const map=dist_TableMap.get(table.node);if(index>=0&&index<(isRowSelection?map.height:map.width)){const lastCell=map.positionAt(isRowSelection?index:map.height-1,isRowSelection?map.width-1:index,table.node),$lastCell=tr.doc.resolve(table.from+lastCell),createCellSelection=isRowSelection?CellSelection.rowSelection:CellSelection.colSelection,firstCell=map.positionAt(isRowSelection?index:0,isRowSelection?0:index,table.node),$firstCell=tr.doc.resolve(table.from+firstCell);return(0,lib.I9)(tr.setSelection(createCellSelection($lastCell,$firstCell)))}}return tr}}lib_withMeta(tableHeaderSchema.node,{displayName:"NodeSchema<tableHeader>",group:"Table"}),lib_withMeta(tableHeaderSchema.ctx,{displayName:"NodeSchemaCtx<tableHeader>",group:"Table"});const selectRow=selectLine("row"),selectCol=selectLine("col");function addRowWithAlignment(ctx,tr,{map,tableStart,table},row){const rowPos=Array(row).fill(0).reduce((acc,_,i)=>acc+table.child(i).nodeSize,tableStart),cells=Array(map.width).fill(0).map((_,col)=>{const headerCol=table.nodeAt(map.map[col]);return tableCellSchema.type(ctx).createAndFill({alignment:headerCol?.attrs.alignment})});return tr.insert(rowPos,tableRowSchema.type(ctx).create(null,cells)),tr}function selectTable(tr){const cells=function getAllCellsInTable(selection){const table=dist_findTable(selection.$from);if(!table)return;const map=dist_TableMap.get(table.node);return map.cellsInRect({left:0,right:map.width,top:0,bottom:map.height}).map(nodePos=>{const node=table.node.nodeAt(nodePos),pos=nodePos+table.start;return{pos,start:pos+1,node}})}(tr.selection);if(cells&&cells[0]){const $firstCell=tr.doc.resolve(cells[0].pos),last=cells[cells.length-1];if(last){const $lastCell=tr.doc.resolve(last.pos);return(0,lib.I9)(tr.setSelection(new CellSelection($lastCell,$firstCell)))}}return tr}const goToPrevTableCellCommand=(0,utils_lib.yu)("GoToPrevTableCell",()=>()=>goToNextCell(-1));lib_withMeta(goToPrevTableCellCommand,{displayName:"Command<goToPrevTableCellCommand>",group:"Table"});const goToNextTableCellCommand=(0,utils_lib.yu)("GoToNextTableCell",()=>()=>goToNextCell(1));lib_withMeta(goToNextTableCellCommand,{displayName:"Command<goToNextTableCellCommand>",group:"Table"});const exitTable=(0,utils_lib.yu)("ExitTable",ctx=>()=>(state,dispatch)=>{if(!isInTable(state))return!1;const{$head}=state.selection,table=(0,lib.qx)($head,tableSchema.type(ctx));if(!table)return!1;const{to}=table,tr=state.tr.replaceWith(to,to,preset_commonmark_lib.Wf.type(ctx).createAndFill());return tr.setSelection(prosemirror_state_dist.LN.near(tr.doc.resolve(to),1)).scrollIntoView(),dispatch?.(tr),!0});lib_withMeta(exitTable,{displayName:"Command<breakTableCommand>",group:"Table"});const insertTableCommand=(0,utils_lib.yu)("InsertTable",ctx=>({row,col}={})=>(state,dispatch)=>{const{selection,tr}=state,{from}=selection,table=createTable(ctx,row,col),_tr=tr.replaceSelectionWith(table),sel=prosemirror_state_dist.LN.findFrom(_tr.doc.resolve(from),1,!0);return sel&&_tr.setSelection(sel),dispatch?.(_tr),!0});lib_withMeta(insertTableCommand,{displayName:"Command<insertTableCommand>",group:"Table"});const moveRowCommand=(0,utils_lib.yu)("MoveRow",()=>({from,to,pos}={})=>function moveTableRow2(options){return(state,dispatch)=>{const{from:originIndex,to:targetIndex,select=!0,pos=state.selection.from}=options,tr=state.tr;return!!moveRow({tr,originIndex,targetIndex,select,pos})&&(null==dispatch||dispatch(tr),!0)}}({from:from??0,to:to??0,pos}));lib_withMeta(moveRowCommand,{displayName:"Command<moveRowCommand>",group:"Table"});const moveColCommand=(0,utils_lib.yu)("MoveCol",()=>({from,to,pos}={})=>function moveTableColumn2(options){return(state,dispatch)=>{const{from:originIndex,to:targetIndex,select=!0,pos=state.selection.from}=options,tr=state.tr;return!!moveColumn({tr,originIndex,targetIndex,select,pos})&&(null==dispatch||dispatch(tr),!0)}}({from:from??0,to:to??0,pos}));lib_withMeta(moveColCommand,{displayName:"Command<moveColCommand>",group:"Table"});const selectRowCommand=(0,utils_lib.yu)("SelectRow",()=>(payload={index:0})=>(state,dispatch)=>{const{tr}=state,result=dispatch?.(selectRow(payload.index,payload.pos)(tr));return Boolean(result)});lib_withMeta(selectRowCommand,{displayName:"Command<selectRowCommand>",group:"Table"});const selectColCommand=(0,utils_lib.yu)("SelectCol",()=>(payload={index:0})=>(state,dispatch)=>{const{tr}=state,result=dispatch?.(selectCol(payload.index,payload.pos)(tr));return Boolean(result)});lib_withMeta(selectColCommand,{displayName:"Command<selectColCommand>",group:"Table"});const selectTableCommand=(0,utils_lib.yu)("SelectTable",()=>()=>(state,dispatch)=>{const{tr}=state,result=dispatch?.(selectTable(tr));return Boolean(result)});lib_withMeta(selectTableCommand,{displayName:"Command<selectTableCommand>",group:"Table"});const deleteSelectedCellsCommand=(0,utils_lib.yu)("DeleteSelectedCells",()=>()=>(state,dispatch)=>{const{selection}=state;if(!(selection instanceof CellSelection))return!1;const isRow=selection.isRowSelection(),isCol=selection.isColSelection();return isRow&&isCol?function deleteTable(state,dispatch){const $pos=state.selection.$anchor;for(let d=$pos.depth;d>0;d--)if("table"==$pos.node(d).type.spec.tableRole)return dispatch&&dispatch(state.tr.delete($pos.before(d),$pos.after(d)).scrollIntoView()),!0;return!1}(state,dispatch):isCol?function deleteColumn(state,dispatch){if(!isInTable(state))return!1;if(dispatch){const rect=selectedRect(state),tr=state.tr;if(0==rect.left&&rect.right==rect.map.width)return!1;for(let i=rect.right-1;removeColumn(tr,rect,i),i!=rect.left;i--){const table=rect.tableStart?tr.doc.nodeAt(rect.tableStart-1):tr.doc;if(!table)throw RangeError("No table found");rect.table=table,rect.map=dist_TableMap.get(table)}dispatch(tr)}return!0}(state,dispatch):function deleteRow(state,dispatch){if(!isInTable(state))return!1;if(dispatch){const rect=selectedRect(state),tr=state.tr;if(0==rect.top&&rect.bottom==rect.map.height)return!1;for(let i=rect.bottom-1;removeRow(tr,rect,i),i!=rect.top;i--){const table=rect.tableStart?tr.doc.nodeAt(rect.tableStart-1):tr.doc;if(!table)throw RangeError("No table found");rect.table=table,rect.map=dist_TableMap.get(rect.table)}dispatch(tr)}return!0}(state,dispatch)});lib_withMeta(deleteSelectedCellsCommand,{displayName:"Command<deleteSelectedCellsCommand>",group:"Table"});const addColBeforeCommand=(0,utils_lib.yu)("AddColBefore",()=>()=>addColumnBefore);lib_withMeta(addColBeforeCommand,{displayName:"Command<addColBeforeCommand>",group:"Table"});const addColAfterCommand=(0,utils_lib.yu)("AddColAfter",()=>()=>addColumnAfter);lib_withMeta(addColAfterCommand,{displayName:"Command<addColAfterCommand>",group:"Table"});const addRowBeforeCommand=(0,utils_lib.yu)("AddRowBefore",ctx=>()=>(state,dispatch)=>{if(!isInTable(state))return!1;if(dispatch){const rect=selectedRect(state);dispatch(addRowWithAlignment(ctx,state.tr,rect,rect.top))}return!0});lib_withMeta(addRowBeforeCommand,{displayName:"Command<addRowBeforeCommand>",group:"Table"});const addRowAfterCommand=(0,utils_lib.yu)("AddRowAfter",ctx=>()=>(state,dispatch)=>{if(!isInTable(state))return!1;if(dispatch){const rect=selectedRect(state);dispatch(addRowWithAlignment(ctx,state.tr,rect,rect.bottom))}return!0});lib_withMeta(addRowAfterCommand,{displayName:"Command<addRowAfterCommand>",group:"Table"});const setAlignCommand=(0,utils_lib.yu)("SetAlign",()=>(alignment="left")=>function setCellAttr(name,value){return function(state,dispatch){if(!isInTable(state))return!1;const $cell=selectionCell(state);if($cell.nodeAfter.attrs[name]===value)return!1;if(dispatch){const tr=state.tr;state.selection instanceof CellSelection?state.selection.forEachCell((node,pos)=>{node.attrs[name]!==value&&tr.setNodeMarkup(pos,null,{...node.attrs,[name]:value})}):tr.setNodeMarkup($cell.pos,null,{...$cell.nodeAfter.attrs,[name]:value}),dispatch(tr)}return!0}}("alignment",alignment));lib_withMeta(setAlignCommand,{displayName:"Command<setAlignCommand>",group:"Table"});const insertTableInputRule=(0,utils_lib.b_)(ctx=>new prosemirror_inputrules_dist.fV(/^\|(?<col>\d+)[xX](?<row>\d+)\|\s$/,(state,match,start,end)=>{const $start=state.doc.resolve(start);if(!$start.node(-1).canReplaceWith($start.index(-1),$start.indexAfter(-1),tableSchema.type(ctx)))return null;const row=Math.max(Number(match.groups?.row??0),2),tableNode=createTable(ctx,row,Number(match.groups?.col)),tr=state.tr.replaceRangeWith(start,end,tableNode);return tr.setSelection(prosemirror_state_dist.U3.create(tr.doc,start+3)).scrollIntoView()}));lib_withMeta(insertTableInputRule,{displayName:"InputRule<insertTableInputRule>",group:"Table"});const tableKeymap=(0,utils_lib.pq)("tableKeymap",{NextCell:{priority:100,shortcuts:["Mod-]","Tab"],command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(goToNextTableCellCommand.key)}},PrevCell:{shortcuts:["Mod-[","Shift-Tab"],command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(goToPrevTableCellCommand.key)}},ExitTable:{shortcuts:["Mod-Enter","Enter"],command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(exitTable.key)}}});lib_withMeta(tableKeymap.ctx,{displayName:"KeymapCtx<table>",group:"Table"}),lib_withMeta(tableKeymap.shortcuts,{displayName:"Keymap<table>",group:"Table"});const id$1="footnote_definition",footnoteDefinitionSchema=(0,utils_lib.Yh)("footnote_definition",()=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:`dl[data-type="${id$1}"]`,getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{label:dom.dataset.label}},contentElement:"dd"}],toDOM:node=>{const label=node.attrs.label;return["dl",{"data-label":label,"data-type":id$1},["dt",label],["dd",0]]},parseMarkdown:{match:({type})=>"footnoteDefinition"===type,runner:(state,node,type)=>{state.openNode(type,{label:node.label}).next(node.children).closeNode()}},toMarkdown:{match:node=>node.type.name===id$1,runner:(state,node)=>{state.openNode("footnoteDefinition",void 0,{label:node.attrs.label,identifier:node.attrs.label}).next(node.content).closeNode()}}}));lib_withMeta(footnoteDefinitionSchema.ctx,{displayName:"NodeSchemaCtx<footnodeDef>",group:"footnote"}),lib_withMeta(footnoteDefinitionSchema.node,{displayName:"NodeSchema<footnodeDef>",group:"footnote"});const id="footnote_reference",footnoteReferenceSchema=(0,utils_lib.Yh)("footnote_reference",()=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:`sup[data-type="${id}"]`,getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{label:dom.dataset.label}}}],toDOM:node=>{const label=node.attrs.label;return["sup",{"data-label":label,"data-type":id},label]},parseMarkdown:{match:({type})=>"footnoteReference"===type,runner:(state,node,type)=>{state.addNode(type,{label:node.label})}},toMarkdown:{match:node=>node.type.name===id,runner:(state,node)=>{state.addNode("footnoteReference",void 0,void 0,{label:node.attrs.label,identifier:node.attrs.label})}}}));lib_withMeta(footnoteReferenceSchema.ctx,{displayName:"NodeSchemaCtx<footnodeRef>",group:"footnote"}),lib_withMeta(footnoteReferenceSchema.node,{displayName:"NodeSchema<footnodeRef>",group:"footnote"});const extendListItemSchemaForTask=preset_commonmark_lib.hm.extendSchema(prev=>ctx=>{const baseSchema=prev(ctx);return{...baseSchema,attrs:{...baseSchema.attrs,checked:{default:null,validate:"boolean|null"}},parseDOM:[{tag:'li[data-item-type="task"]',getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{label:dom.dataset.label,listType:dom.dataset.listType,spread:dom.dataset.spread,checked:dom.dataset.checked?"true"===dom.dataset.checked:null}}},...baseSchema?.parseDOM||[]],toDOM:node=>baseSchema.toDOM&&null==node.attrs.checked?baseSchema.toDOM(node):["li",{"data-item-type":"task","data-label":node.attrs.label,"data-list-type":node.attrs.listType,"data-spread":node.attrs.spread,"data-checked":node.attrs.checked},0],parseMarkdown:{match:({type})=>"listItem"===type,runner:(state,node,type)=>{if(null==node.checked)return void baseSchema.parseMarkdown.runner(state,node,type);const label=null!=node.label?`${node.label}.`:"•",checked=null!=node.checked?Boolean(node.checked):null,listType=null!=node.label?"ordered":"bullet",spread=null!=node.spread?`${node.spread}`:"true";state.openNode(type,{label,listType,spread,checked}),state.next(node.children),state.closeNode()}},toMarkdown:{match:node=>"list_item"===node.type.name,runner:(state,node)=>{if(null==node.attrs.checked)return void baseSchema.toMarkdown.runner(state,node);const label=node.attrs.label,listType=node.attrs.listType,spread="true"===node.attrs.spread,checked=node.attrs.checked;state.openNode("listItem",void 0,{label,listType,spread,checked}),state.next(node.content),state.closeNode()}}}});lib_withMeta(extendListItemSchemaForTask.node,{displayName:"NodeSchema<taskListItem>",group:"ListItem"}),lib_withMeta(extendListItemSchemaForTask.ctx,{displayName:"NodeSchemaCtx<taskListItem>",group:"ListItem"});const wrapInTaskListInputRule=(0,utils_lib.b_)(()=>new prosemirror_inputrules_dist.fV(/^\[(?<checked>\s|x)\]\s$/,(state,match,start,end)=>{const pos=state.doc.resolve(start);let depth=0,node=pos.node(depth);for(;node&&"list_item"!==node.type.name;)depth--,node=pos.node(depth);if(!node||null!=node.attrs.checked)return null;const checked=Boolean("x"===match.groups?.checked),finPos=pos.before(depth),tr=state.tr;return tr.deleteRange(start,end).setNodeMarkup(finPos,void 0,{...node.attrs,checked}),tr}));lib_withMeta(wrapInTaskListInputRule,{displayName:"InputRule<wrapInTaskListInputRule>",group:"ListItem"});const lib_keymap=[strikethroughKeymap,tableKeymap].flat(),inputRules=[insertTableInputRule,wrapInTaskListInputRule],markInputRules=[strikethroughInputRule],autoInsertSpanPlugin=(0,utils_lib.Gf)(()=>imeSpan);lib_withMeta(autoInsertSpanPlugin,{displayName:"Prose<autoInsertSpanPlugin>",group:"Prose"});lib_withMeta((0,utils_lib.Gf)(()=>columnResizing({})),{displayName:"Prose<columnResizingPlugin>",group:"Prose"});const tableEditingPlugin=(0,utils_lib.Gf)(()=>tableEditing({allowTableNodeSelection:!0}));lib_withMeta(tableEditingPlugin,{displayName:"Prose<tableEditingPlugin>",group:"Prose"});const remarkGFMPlugin=(0,utils_lib.lz)("remarkGFM",()=>remark_gfm_lib.A);lib_withMeta(remarkGFMPlugin.plugin,{displayName:"Remark<remarkGFMPlugin>",group:"Remark"}),lib_withMeta(remarkGFMPlugin.options,{displayName:"RemarkConfig<remarkGFMPlugin>",group:"Remark"});const pluginKey=new prosemirror_state_dist.hs("MILKDOWN_KEEP_TABLE_ALIGN_PLUGIN");const keepTableAlignPlugin=(0,utils_lib.Gf)(()=>new prosemirror_state_dist.k_({key:pluginKey,appendTransaction:(_tr,oldState,state)=>{let tr;return oldState.doc!==state.doc&&state.doc.descendants((node,pos)=>{if(tr||(tr=state.tr),"table_cell"!==node.type.name)return;const $pos=state.doc.resolve(pos),tableRow=$pos.node($pos.depth),tableHeaderRow=$pos.node($pos.depth-1).firstChild;if(!tableHeaderRow)return;const index=function getChildIndex(node,parent){let index=0;return parent.forEach((child,_offset,i)=>{child===node&&(index=i)}),index}(node,tableRow),headerCell=tableHeaderRow.maybeChild(index);if(!headerCell)return;const align=headerCell.attrs.alignment;align!==node.attrs.alignment&&tr.setNodeMarkup(pos,void 0,{...node.attrs,alignment:align})}),tr}}));lib_withMeta(keepTableAlignPlugin,{displayName:"Prose<keepTableAlignPlugin>",group:"Prose"});const plugins=[keepTableAlignPlugin,autoInsertSpanPlugin,remarkGFMPlugin,tableEditingPlugin].flat(),gfm=[[extendListItemSchemaForTask,tableSchema,tableHeaderRowSchema,tableRowSchema,tableHeaderSchema,tableCellSchema,footnoteDefinitionSchema,footnoteReferenceSchema,strikethroughAttr,strikethroughSchema].flat(),inputRules,markInputRules,lib_keymap,[goToNextTableCellCommand,goToPrevTableCellCommand,exitTable,insertTableCommand,moveRowCommand,moveColCommand,selectRowCommand,selectColCommand,selectTableCommand,deleteSelectedCellsCommand,addRowBeforeCommand,addRowAfterCommand,addColBeforeCommand,addColAfterCommand,setAlignCommand,toggleStrikethroughCommand],plugins].flat();var commands_dist=__webpack_require__("./node_modules/@codemirror/commands/dist/index.js"),view_dist=__webpack_require__("./node_modules/@codemirror/view/dist/index.js"),code_block=__webpack_require__("./node_modules/@milkdown/components/lib/code-block/index.js"),state_dist=__webpack_require__("./node_modules/@codemirror/state/dist/index.js"),language_dist=__webpack_require__("./node_modules/@codemirror/language/dist/index.js"),search_dist=__webpack_require__("./node_modules/@codemirror/search/dist/index.js"),autocomplete_dist=__webpack_require__("./node_modules/@codemirror/autocomplete/dist/index.js"),lint_dist=__webpack_require__("./node_modules/@codemirror/lint/dist/index.js");const basicSetup=(()=>[(0,view_dist.$K)(),(0,view_dist.Wu)(),(0,view_dist.N$)(),(0,commands_dist.b6)(),(0,language_dist.Lv)(),(0,view_dist.VH)(),(0,view_dist.A)(),state_dist.$t.allowMultipleSelections.of(!0),(0,language_dist.WD)(),(0,language_dist.y9)(language_dist.Zt,{fallback:!0}),(0,language_dist.SG)(),(0,autocomplete_dist.wm)(),(0,autocomplete_dist.yU)(),(0,view_dist.D4)(),(0,view_dist.HJ)(),(0,view_dist.dz)(),(0,search_dist.gN)(),view_dist.w4.of([...autocomplete_dist.Bc,...commands_dist.pw,...search_dist.Eo,...commands_dist.cL,...language_dist.f7,...autocomplete_dist.OO,...lint_dist.$w])])();var plugin_cursor_lib=__webpack_require__("./node_modules/@milkdown/plugin-cursor/lib/index.js");function createVirtualCursor(options){var _a;const skipWarning=null!=(_a=null==options?void 0:options.skipWarning)&&_a;let _cursor="undefined"==typeof document?null:document.createElement("div");return new prosemirror_state_dist.k_({key:dist_key,view:view=>{!0!==skipWarning&&function checkInclusive(schema,skipWarning){for(const[mark,type]of Object.entries(schema.marks))!1!==type.spec.inclusive||skipWarning.includes(mark)||console.warn(`[prosemirror-virtual-cursor] Virtual cursor does not work well with marks that have inclusive set to false. Please consider removing the inclusive option from the "${mark}" mark or adding it to the "skipWarning" option.`)}(view.state.schema,skipWarning||[]);const doc=view.dom.ownerDocument;_cursor=_cursor||document.createElement("div");const cursor=_cursor,update=()=>{!function updateCursor(view,cursor){if(!view||!view.dom||view.isDestroyed||!cursor)return;const{state,dom}=view,{selection}=state;if(!isTextSelection(selection))return;const cursorRect=function getCursorRect(view,toStart){var _a;const selection=window.getSelection();if(!selection||!selection.rangeCount)return null;const range=null==(_a=null==selection?void 0:selection.getRangeAt(0))?void 0:_a.cloneRange();if(!range)return null;range.collapse(toStart);const rects=range.getClientRects(),rect=(null==rects?void 0:rects.length)?rects[rects.length-1]:null;return(null==rect?void 0:rect.height)?rect:view.coordsAtPos(view.state.selection.head)}(view,selection.$head===selection.$from);if(!cursorRect)return cursor;const editorRect=dom.getBoundingClientRect();let className="prosemirror-virtual-cursor";const $pos=state.selection.$head,[marksBefore,marksAfter]=getMarksAround($pos),marks=state.storedMarks||$pos.marks();selection.$cursor&&marksBefore&&marksAfter&&marks&&!prosemirror_model_dist.CU.sameSet(marksBefore,marksAfter)&&(prosemirror_model_dist.CU.sameSet(marksBefore,marks)?className+=" prosemirror-virtual-cursor-left":prosemirror_model_dist.CU.sameSet(marksAfter,marks)&&(className+=" prosemirror-virtual-cursor-right"));cursor.className=className,function restartAnimation(element,className){element.classList.remove(className),element.offsetWidth,element.classList.add(className)}(cursor,"prosemirror-virtual-cursor-animation"),cursor.style.height=cursorRect.bottom-cursorRect.top+"px",cursor.style.left=cursorRect.left-editorRect.left+"px",cursor.style.top=cursorRect.top-editorRect.top+"px"}(view,cursor)};let observer;return window.ResizeObserver&&(observer=new window.ResizeObserver(()=>update()),observer.observe(view.dom)),doc.addEventListener("selectionchange",update),{update:()=>{update()},destroy:()=>{doc.removeEventListener("selectionchange",update),observer&&observer.unobserve(view.dom)}}},props:{handleKeyDown:(view,event)=>{var _a2;const{selection}=view.state;if(event.altKey||event.ctrlKey||event.metaKey||event.shiftKey||event.isComposing||!["ArrowLeft","ArrowRight"].includes(event.key)||!isTextSelection(selection)||!selection.empty)return!1;const $pos=selection.$head,[marksBefore,marksAfter]=getMarksAround($pos),marks=view.state.storedMarks||$pos.marks();if(marksBefore&&marksAfter&&!prosemirror_model_dist.CU.sameSet(marksBefore,marksAfter)){if("ArrowLeft"===event.key&&!prosemirror_model_dist.CU.sameSet(marksBefore,marks))return view.dispatch(view.state.tr.setStoredMarks(marksBefore)),!0;if("ArrowRight"===event.key&&!prosemirror_model_dist.CU.sameSet(marksAfter,marks))return view.dispatch(view.state.tr.setStoredMarks(marksAfter)),!0}return"ArrowLeft"===event.key&&1===$pos.textOffset?(view.dispatch(view.state.tr.setSelection(prosemirror_state_dist.U3.create(view.state.doc,$pos.pos-1)).setStoredMarks($pos.marks())),!0):"ArrowRight"===event.key&&$pos.textOffset+1===(null==(_a2=$pos.parent.maybeChild($pos.index()))?void 0:_a2.nodeSize)&&(view.dispatch(view.state.tr.setSelection(prosemirror_state_dist.U3.create(view.state.doc,$pos.pos+1)).setStoredMarks($pos.marks())),!0)},decorations:state=>{if(_cursor&&isTextSelection(state.selection)&&state.selection.empty)return prosemirror_view_dist.zF.create(state.doc,[prosemirror_view_dist.NZ.widget(0,_cursor,{key:"prosemirror-virtual-cursor"})])},attributes:{class:"virtual-cursor-enabled"}}})}var dist_key=new prosemirror_state_dist.hs("prosemirror-virtual-cursor");function getMarksAround($pos){const index=$pos.index(),after=$pos.parent.maybeChild(index);let before=$pos.textOffset?after:null;return!before&&index>0&&(before=$pos.parent.maybeChild(index-1)),[null==before?void 0:before.marks,null==after?void 0:after.marks]}function isTextSelection(selection){return selection&&"object"==typeof selection&&"$cursor"in selection}var image_inline_defProp=Object.defineProperty,image_inline_getOwnPropSymbols=Object.getOwnPropertySymbols,image_inline_hasOwnProp=Object.prototype.hasOwnProperty,image_inline_propIsEnum=Object.prototype.propertyIsEnumerable,image_inline_defNormalProp=(obj,key,value)=>key in obj?image_inline_defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,image_inline_spreadValues=(a,b)=>{for(var prop in b||(b={}))image_inline_hasOwnProp.call(b,prop)&&image_inline_defNormalProp(a,prop,b[prop]);if(image_inline_getOwnPropSymbols)for(var prop of image_inline_getOwnPropSymbols(b))image_inline_propIsEnum.call(b,prop)&&image_inline_defNormalProp(a,prop,b[prop]);return a};function image_inline_withMeta(plugin,meta){return Object.assign(plugin,{meta:image_inline_spreadValues({package:"@milkdown/components"},meta)}),plugin}const defaultInlineImageConfig={imageIcon:"🌌",uploadButton:"Upload",confirmButton:"⏎",uploadPlaceholderText:"/Paste",onUpload:file=>Promise.resolve(URL.createObjectURL(file))},inlineImageConfig=(0,utils_lib.Qx)(defaultInlineImageConfig,"inlineImageConfigCtx");function image_inline_Icon({icon,class:className,onClick}){return(0,runtime_core_esm_bundler.h)("span",{class:(0,clsx.A)("milkdown-icon",className),onPointerdown:onClick,ref:el=>{el&&icon&&(el.innerHTML=purify_es.A.sanitize(icon.trim()))}})}image_inline_withMeta(inlineImageConfig,{displayName:"Config<image-inline>",group:"ImageInline"}),image_inline_Icon.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const image_inline_nanoid=(0,index_browser.d_)("abcdefg",8),image_inline_ImageInput=(0,runtime_core_esm_bundler.pM)({props:{src:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setLink:{type:Function,required:!0},imageIcon:{type:String,required:!1},uploadButton:{type:String,required:!1},confirmButton:{type:String,required:!1},uploadPlaceholderText:{type:String,required:!1},onUpload:{type:Function,required:!0}},setup({readonly,src,setLink,onUpload,imageIcon,uploadButton,confirmButton,uploadPlaceholderText,className}){var _a,_b;const focusLinkInput=(0,reactivity_esm_bundler.KR)(!1),linkInputRef=(0,reactivity_esm_bundler.KR)(),currentLink=(0,reactivity_esm_bundler.KR)(null!=(_a=src.value)?_a:""),uuid=(0,reactivity_esm_bundler.KR)(image_inline_nanoid()),hidePlaceholder=(0,reactivity_esm_bundler.KR)(0!==(null==(_b=src.value)?void 0:_b.length)),onEditLink=e=>{const value=e.target.value;hidePlaceholder.value=0!==value.length,currentLink.value=value},onKeydown=e=>{var _a2,_b2;"Enter"===e.key&&setLink(null!=(_b2=null==(_a2=linkInputRef.value)?void 0:_a2.value)?_b2:"")},onUploadFile=e=>{var _a2;const file=null==(_a2=e.target.files)?void 0:_a2[0];file&&onUpload(file).then(url=>{url&&(setLink(url),hidePlaceholder.value=!0)}).catch(err=>{console.error("An error occurred while uploading image"),console.error(err)})};return()=>(0,runtime_core_esm_bundler.h)("div",{class:(0,clsx.A)("image-edit",className)},(0,runtime_core_esm_bundler.h)(image_inline_Icon,{icon:imageIcon,class:"image-icon"}),(0,runtime_core_esm_bundler.h)("div",{class:(0,clsx.A)("link-importer",focusLinkInput.value&&"focus")},(0,runtime_core_esm_bundler.h)("input",{ref:linkInputRef,draggable:"true",onDragstart:e=>{e.preventDefault(),e.stopPropagation()},disabled:readonly.value,class:"link-input-area",value:currentLink.value,onInput:onEditLink,onKeydown,onFocus:()=>focusLinkInput.value=!0,onBlur:()=>focusLinkInput.value=!1}),!hidePlaceholder.value&&(0,runtime_core_esm_bundler.h)("div",{class:"placeholder"},(0,runtime_core_esm_bundler.h)("input",{disabled:readonly.value,class:"hidden",id:uuid.value,type:"file",accept:"image/*",onChange:onUploadFile}),(0,runtime_core_esm_bundler.h)("label",{class:"uploader",for:uuid.value},(0,runtime_core_esm_bundler.h)(image_inline_Icon,{icon:uploadButton})),(0,runtime_core_esm_bundler.h)("span",{class:"text",onClick:()=>{var _a2;return null==(_a2=linkInputRef.value)?void 0:_a2.focus()}},uploadPlaceholderText))),currentLink.value&&(0,runtime_core_esm_bundler.h)("div",{class:"confirm",onClick:()=>{var _a2,_b2;setLink(null!=(_b2=null==(_a2=linkInputRef.value)?void 0:_a2.value)?_b2:"")}},(0,runtime_core_esm_bundler.h)(image_inline_Icon,{icon:confirmButton})))}}),MilkdownImageInline=(0,runtime_core_esm_bundler.pM)({props:{src:{type:Object,required:!0},alt:{type:Object,required:!0},title:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setAttr:{type:Function,required:!0},config:{type:Object,required:!0}},setup(props){const{src,alt,title}=props;return()=>{var _a;return(null==(_a=src.value)?void 0:_a.length)?(0,runtime_core_esm_bundler.h)("img",{class:"image-inline",src:src.value,alt:alt.value,title:title.value}):(0,runtime_core_esm_bundler.h)(image_inline_ImageInput,{src:props.src,selected:props.selected,readonly:props.readonly,setLink:link=>props.setAttr("src",link),imageIcon:props.config.imageIcon,uploadButton:props.config.uploadButton,confirmButton:props.config.confirmButton,uploadPlaceholderText:props.config.uploadPlaceholderText,onUpload:props.config.onUpload,className:"empty-image-inline"})}}}),inlineImageView=(0,utils_lib.m5)(preset_commonmark_lib.Fi.node,ctx=>(initialNode,view,getPos)=>{const src=(0,reactivity_esm_bundler.KR)(initialNode.attrs.src),alt=(0,reactivity_esm_bundler.KR)(initialNode.attrs.alt),title=(0,reactivity_esm_bundler.KR)(initialNode.attrs.title),selected=(0,reactivity_esm_bundler.KR)(!1),readonly=(0,reactivity_esm_bundler.KR)(!view.editable),config=ctx.get(inlineImageConfig.key),app=(0,runtime_dom_esm_bundler.Ef)(MilkdownImageInline,{src,alt,title,selected,readonly,setAttr:(attr,value)=>{if(!view.editable)return;const pos=getPos();null!=pos&&view.dispatch(view.state.tr.setNodeAttribute(pos,attr,"src"===attr?purify_es.A.sanitize(value):value))},config}),dom=document.createElement("span");dom.className="milkdown-image-inline";const disposeSelectedWatcher=(0,runtime_core_esm_bundler.nT)(()=>{selected.value?dom.classList.add("selected"):dom.classList.remove("selected")}),proxyDomURL=config.proxyDomURL,bindAttrs=node=>{if(proxyDomURL){const proxiedURL=proxyDomURL(node.attrs.src);"string"==typeof proxiedURL?src.value=proxiedURL:proxiedURL.then(url=>{src.value=url}).catch(console.error)}else src.value=node.attrs.src;alt.value=node.attrs.alt,title.value=node.attrs.title};return bindAttrs(initialNode),app.mount(dom),{dom,update:updatedNode=>updatedNode.type===initialNode.type&&(bindAttrs(updatedNode),!0),stopEvent:e=>e.target instanceof HTMLInputElement,selectNode:()=>{selected.value=!0},deselectNode:()=>{selected.value=!1},destroy:()=>{disposeSelectedWatcher(),app.unmount(),dom.remove()}}});image_inline_withMeta(inlineImageView,{displayName:"NodeView<image-inline>",group:"ImageInline"});const imageInlineComponent=[inlineImageConfig,inlineImageView];var katex=__webpack_require__("./node_modules/katex/dist/katex.mjs");class TooltipProvider{constructor(options){this.#initialized=!1,this.onShow=()=>{},this.onHide=()=>{},this.#onUpdate=(view,prevState)=>{const{state,composing}=view,{selection,doc}=state,{ranges}=selection,from=Math.min(...ranges.map(range=>range.$from.pos)),to=Math.max(...ranges.map(range=>range.$to.pos)),isSame=prevState&&prevState.doc.eq(doc)&&prevState.selection.eq(selection);if(!this.#initialized){(this.#root??view.dom.parentElement??document.body).appendChild(this.element),this.#initialized=!0}if(composing||isSame)return;if(!this.#shouldShow(view,prevState))return void this.hide();const virtualEl={getBoundingClientRect:()=>(0,lib.MG)(view,from,to)};(0,floating_ui_dom.rD)(virtualEl,this.element,{placement:this.#floatingUIOptions.placement??"top",middleware:[(0,floating_ui_dom.UU)(),(0,floating_ui_dom.cY)(this.#offset),(0,floating_ui_dom.BN)(this.#shift),...this.#middleware]}).then(({x,y})=>{Object.assign(this.element.style,{left:`${x}px`,top:`${y}px`})}).catch(console.error),this.show()},this.update=(view,prevState)=>{this.#updater(view,prevState)},this.destroy=()=>{this.#updater.cancel()},this.show=virtualElement=>{this.element.dataset.show="true",virtualElement&&(0,floating_ui_dom.rD)(virtualElement,this.element,{placement:"top",middleware:[(0,floating_ui_dom.UU)(),(0,floating_ui_dom.cY)(this.#offset),(0,floating_ui_dom.BN)(this.#shift),...this.#middleware],...this.#floatingUIOptions}).then(({x,y})=>{Object.assign(this.element.style,{left:`${x}px`,top:`${y}px`})}).catch(console.error),this.onShow()},this.hide=()=>{"false"!==this.element.dataset.show&&(this.element.dataset.show="false",this.onHide())},this.element=options.content,this.#debounce=options.debounce??200,this.#shouldShow=options.shouldShow??this.#_shouldShow,this.#offset=options.offset,this.#shift=options.shift,this.#middleware=options.middleware??[],this.#floatingUIOptions=options.floatingUIOptions??{},this.#root=options.root,this.element.dataset.show="false",this.#updater=(0,throttle.A)(this.#onUpdate,this.#debounce)}#debounce;#shouldShow;#middleware;#floatingUIOptions;#root;#initialized;#offset;#shift;#updater;#onUpdate;#_shouldShow(view){const{doc,selection}=view.state,{empty,from,to}=selection,isEmptyTextBlock=!doc.textBetween(from,to).length&&view.state.selection instanceof prosemirror_state_dist.U3,isTooltipChildren=this.element.contains(document.activeElement),notHasFocus=!view.hasFocus()&&!isTooltipChildren,isReadonly=!view.editable;return!(notHasFocus||empty||isEmptyTextBlock||isReadonly)}}function tooltipFactory(id){const tooltipSpec=(0,utils_lib.Qx)({},`${id}_TOOLTIP_SPEC`),tooltipPlugin=(0,utils_lib.Gf)(ctx=>{const spec=ctx.get(tooltipSpec.key);return new prosemirror_state_dist.k_({key:new prosemirror_state_dist.hs(`${id}_TOOLTIP`),...spec})}),result=[tooltipSpec,tooltipPlugin];return result.key=tooltipSpec.key,result.pluginKey=tooltipPlugin.key,tooltipSpec.meta={package:"@milkdown/plugin-tooltip",displayName:`Ctx<tooltipSpec>|${id}`},tooltipPlugin.meta={package:"@milkdown/plugin-tooltip",displayName:`Prose<tooltip>|${id}`},result}var prosemirror_history_dist=__webpack_require__("./node_modules/prosemirror-history/dist/index.js"),remark_math_lib=__webpack_require__("./node_modules/remark-math/lib/index.js"),__defProp$3=Object.defineProperty,__getOwnPropSymbols$3=Object.getOwnPropertySymbols,__hasOwnProp$3=Object.prototype.hasOwnProperty,__propIsEnum$3=Object.prototype.propertyIsEnumerable,__defNormalProp$3=(obj,key,value)=>key in obj?__defProp$3(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues$3=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp$3.call(b,prop)&&__defNormalProp$3(a,prop,b[prop]);if(__getOwnPropSymbols$3)for(var prop of __getOwnPropSymbols$3(b))__propIsEnum$3.call(b,prop)&&__defNormalProp$3(a,prop,b[prop]);return a};function link_tooltip_withMeta(plugin,meta){return Object.assign(plugin,{meta:__spreadValues$3({package:"@milkdown/components"},meta)}),plugin}var link_tooltip_defProp$2=Object.defineProperty,link_tooltip_getOwnPropSymbols$2=Object.getOwnPropertySymbols,link_tooltip_hasOwnProp$2=Object.prototype.hasOwnProperty,link_tooltip_propIsEnum$2=Object.prototype.propertyIsEnumerable,link_tooltip_defNormalProp$2=(obj,key,value)=>key in obj?link_tooltip_defProp$2(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,link_tooltip_spreadValues$2=(a,b)=>{for(var prop in b||(b={}))link_tooltip_hasOwnProp$2.call(b,prop)&&link_tooltip_defNormalProp$2(a,prop,b[prop]);if(link_tooltip_getOwnPropSymbols$2)for(var prop of link_tooltip_getOwnPropSymbols$2(b))link_tooltip_propIsEnum$2.call(b,prop)&&link_tooltip_defNormalProp$2(a,prop,b[prop]);return a};const linkTooltipState=(0,utils_lib.Qx)(link_tooltip_spreadValues$2({},{mode:"preview"}),"linkTooltipStateCtx");link_tooltip_withMeta(linkTooltipState,{displayName:"State<link-tooltip>",group:"LinkTooltip"});const linkTooltipAPI=(0,utils_lib.Qx)(link_tooltip_spreadValues$2({},{addLink:()=>{},editLink:()=>{},removeLink:()=>{}}),"linkTooltipAPICtx");link_tooltip_withMeta(linkTooltipState,{displayName:"API<link-tooltip>",group:"LinkTooltip"});const linkTooltipConfig=(0,utils_lib.Qx)(link_tooltip_spreadValues$2({},{linkIcon:"🔗",editButton:"✎",removeButton:"⌫",confirmButton:"Confirm ⏎",onCopyLink:()=>{},inputPlaceholder:"Paste link..."}),"linkTooltipConfigCtx");link_tooltip_withMeta(linkTooltipState,{displayName:"Config<link-tooltip>",group:"LinkTooltip"});const toggleLinkCommand=(0,utils_lib.yu)("ToggleLink",ctx=>()=>state=>{const{doc,selection}=state,mark=preset_commonmark_lib.Yk.type(ctx);return doc.rangeHasMark(selection.from,selection.to,mark)?(ctx.get(linkTooltipAPI.key).removeLink(selection.from,selection.to),!0):(ctx.get(linkTooltipAPI.key).addLink(selection.from,selection.to),!0)}),linkPreviewTooltip=tooltipFactory("LINK_PREVIEW");link_tooltip_withMeta(linkPreviewTooltip[0],{displayName:"PreviewTooltipSpec<link-tooltip>",group:"LinkTooltip"}),link_tooltip_withMeta(linkPreviewTooltip[1],{displayName:"PreviewTooltipPlugin<link-tooltip>",group:"LinkTooltip"});const linkEditTooltip=tooltipFactory("LINK_EDIT");function link_tooltip_Icon({icon,class:className,onClick}){return(0,runtime_core_esm_bundler.h)("span",{class:(0,clsx.A)("milkdown-icon",className),onPointerdown:onClick,ref:el=>{el&&icon&&(el.innerHTML=purify_es.A.sanitize(icon.trim()))}})}link_tooltip_withMeta(linkEditTooltip[0],{displayName:"EditTooltipSpec<link-tooltip>",group:"LinkTooltip"}),link_tooltip_withMeta(linkEditTooltip[1],{displayName:"EditTooltipPlugin<link-tooltip>",group:"LinkTooltip"}),link_tooltip_Icon.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const EditLink=(0,runtime_core_esm_bundler.pM)({props:{config:{type:Object,required:!0},src:{type:Object,required:!0},onConfirm:{type:Function,required:!0},onCancel:{type:Function,required:!0}},setup({config,src,onConfirm,onCancel}){const link=(0,reactivity_esm_bundler.KR)(src);(0,runtime_core_esm_bundler.wB)(src,value=>{link.value=value});const onConfirmEdit=()=>{onConfirm(link.value)},onKeydown=e=>{e.stopPropagation(),"Enter"===e.key&&(e.preventDefault(),onConfirmEdit()),"Escape"===e.key&&(e.preventDefault(),onCancel())};return()=>(0,runtime_core_esm_bundler.h)("div",{class:"link-edit"},(0,runtime_core_esm_bundler.h)("input",{class:"input-area",placeholder:config.value.inputPlaceholder,onKeydown,onInput:e=>{link.value=e.target.value},value:link.value}),link.value?(0,runtime_core_esm_bundler.h)(link_tooltip_Icon,{class:"button confirm",icon:config.value.confirmButton,onClick:onConfirmEdit}):null)}});var _content$1,_provider$1,_data,_app$1,_config$1,_src$1,_reset,_confirmEdit,_enterEditMode,link_tooltip_defProp$1=Object.defineProperty,__defProps$1=Object.defineProperties,__getOwnPropDescs$1=Object.getOwnPropertyDescriptors,link_tooltip_getOwnPropSymbols$1=Object.getOwnPropertySymbols,link_tooltip_hasOwnProp$1=Object.prototype.hasOwnProperty,link_tooltip_propIsEnum$1=Object.prototype.propertyIsEnumerable,__typeError$1=msg=>{throw TypeError(msg)},link_tooltip_defNormalProp$1=(obj,key,value)=>key in obj?link_tooltip_defProp$1(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,link_tooltip_spreadValues$1=(a,b)=>{for(var prop in b||(b={}))link_tooltip_hasOwnProp$1.call(b,prop)&&link_tooltip_defNormalProp$1(a,prop,b[prop]);if(link_tooltip_getOwnPropSymbols$1)for(var prop of link_tooltip_getOwnPropSymbols$1(b))link_tooltip_propIsEnum$1.call(b,prop)&&link_tooltip_defNormalProp$1(a,prop,b[prop]);return a},__spreadProps$1=(a,b)=>__defProps$1(a,__getOwnPropDescs$1(b)),__accessCheck$1=(obj,member,msg)=>member.has(obj)||__typeError$1("Cannot "+msg),__privateGet$1=(obj,member,getter)=>(__accessCheck$1(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd$1=(obj,member,value)=>member.has(obj)?__typeError$1("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),__privateSet$1=(obj,member,value,setter)=>(__accessCheck$1(obj,member,"write to private field"),member.set(obj,value),value);const defaultData={from:-1,to:-1,mark:null};class LinkEditTooltip{constructor(ctx,view){this.ctx=ctx,__privateAdd$1(this,_content$1),__privateAdd$1(this,_provider$1),__privateAdd$1(this,_data,link_tooltip_spreadValues$1({},defaultData)),__privateAdd$1(this,_app$1),__privateAdd$1(this,_config$1),__privateAdd$1(this,_src$1,(0,reactivity_esm_bundler.KR)("")),__privateAdd$1(this,_reset,()=>{__privateGet$1(this,_provider$1).hide(),this.ctx.update(linkTooltipState.key,state=>__spreadProps$1(link_tooltip_spreadValues$1({},state),{mode:"preview"})),__privateSet$1(this,_data,link_tooltip_spreadValues$1({},defaultData))}),__privateAdd$1(this,_confirmEdit,href=>{const view=this.ctx.get(core_lib.kY),{from,to,mark}=__privateGet$1(this,_data),type=preset_commonmark_lib.Yk.type(this.ctx),link=purify_es.A.sanitize(href);if(mark&&mark.attrs.href===link)return void __privateGet$1(this,_reset).call(this);const tr=view.state.tr;mark&&tr.removeMark(from,to,mark),tr.addMark(from,to,type.create({href:link})),view.dispatch(tr),__privateGet$1(this,_reset).call(this)}),__privateAdd$1(this,_enterEditMode,(value,from,to)=>{const config=this.ctx.get(linkTooltipConfig.key);__privateGet$1(this,_config$1).value=config,__privateGet$1(this,_src$1).value=value,this.ctx.update(linkTooltipState.key,state=>__spreadProps$1(link_tooltip_spreadValues$1({},state),{mode:"edit"}));const view=this.ctx.get(core_lib.kY);view.dispatch(view.state.tr.setSelection(prosemirror_state_dist.U3.create(view.state.doc,from,to))),__privateGet$1(this,_provider$1).show({getBoundingClientRect:()=>(0,lib.MG)(view,from,to)}),requestAnimationFrame(()=>{var _a;null==(_a=__privateGet$1(this,_content$1).querySelector("input"))||_a.focus()})}),this.update=view=>{const{state}=view,{selection}=state;if(!(selection instanceof prosemirror_state_dist.U3))return;const{from,to}=selection;from===__privateGet$1(this,_data).from&&to===__privateGet$1(this,_data).to||__privateGet$1(this,_reset).call(this)},this.destroy=()=>{__privateGet$1(this,_app$1).unmount(),__privateGet$1(this,_provider$1).destroy(),__privateGet$1(this,_content$1).remove()},this.addLink=(from,to)=>{__privateSet$1(this,_data,{from,to,mark:null}),__privateGet$1(this,_enterEditMode).call(this,"",from,to)},this.editLink=(mark,from,to)=>{__privateSet$1(this,_data,{from,to,mark}),__privateGet$1(this,_enterEditMode).call(this,mark.attrs.href,from,to)},this.removeLink=(from,to)=>{const view=this.ctx.get(core_lib.kY),tr=view.state.tr;tr.removeMark(from,to,preset_commonmark_lib.Yk.type(this.ctx)),view.dispatch(tr),__privateGet$1(this,_reset).call(this)},__privateSet$1(this,_config$1,(0,reactivity_esm_bundler.KR)(this.ctx.get(linkTooltipConfig.key)));const content=document.createElement("div");content.className="milkdown-link-edit";const app=(0,runtime_dom_esm_bundler.Ef)(EditLink,{config:__privateGet$1(this,_config$1),src:__privateGet$1(this,_src$1),onConfirm:__privateGet$1(this,_confirmEdit),onCancel:__privateGet$1(this,_reset)});app.mount(content),__privateSet$1(this,_app$1,app),__privateSet$1(this,_content$1,content),__privateSet$1(this,_provider$1,new TooltipProvider({content,debounce:0,shouldShow:()=>!1})),__privateGet$1(this,_provider$1).onHide=()=>{requestAnimationFrame(()=>{view.dom.focus({preventScroll:!0})})},__privateGet$1(this,_provider$1).update(view)}}_content$1=new WeakMap,_provider$1=new WeakMap,_data=new WeakMap,_app$1=new WeakMap,_config$1=new WeakMap,_src$1=new WeakMap,_reset=new WeakMap,_confirmEdit=new WeakMap,_enterEditMode=new WeakMap;var link_tooltip_defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,link_tooltip_getOwnPropSymbols=Object.getOwnPropertySymbols,link_tooltip_hasOwnProp=Object.prototype.hasOwnProperty,link_tooltip_propIsEnum=Object.prototype.propertyIsEnumerable,link_tooltip_defNormalProp=(obj,key,value)=>key in obj?link_tooltip_defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value;function configureLinkEditTooltip(ctx){let linkEditTooltipView;ctx.update(linkTooltipAPI.key,api=>{return a=((a,b)=>{for(var prop in b||(b={}))link_tooltip_hasOwnProp.call(b,prop)&&link_tooltip_defNormalProp(a,prop,b[prop]);if(link_tooltip_getOwnPropSymbols)for(var prop of link_tooltip_getOwnPropSymbols(b))link_tooltip_propIsEnum.call(b,prop)&&link_tooltip_defNormalProp(a,prop,b[prop]);return a})({},api),__defProps(a,__getOwnPropDescs({addLink:(from,to)=>{null==linkEditTooltipView||linkEditTooltipView.addLink(from,to)},editLink:(mark,from,to)=>{null==linkEditTooltipView||linkEditTooltipView.editLink(mark,from,to)},removeLink:(from,to)=>{null==linkEditTooltipView||linkEditTooltipView.removeLink(from,to)}}));var a}),ctx.set(linkEditTooltip.key,{view:view=>(linkEditTooltipView=new LinkEditTooltip(ctx,view),linkEditTooltipView)})}const PreviewLink=(0,runtime_core_esm_bundler.pM)({props:{config:{type:Object,required:!0},src:{type:Object,required:!0},onEdit:{type:Object,required:!0},onRemove:{type:Object,required:!0}},setup({config,src,onEdit,onRemove}){const onClickEditButton=e=>{e.preventDefault(),e.stopPropagation(),onEdit.value()},onClickRemoveButton=e=>{e.preventDefault(),e.stopPropagation(),onRemove.value()},onClickPreview=e=>{e.preventDefault();const link=src.value;navigator.clipboard&&link&&navigator.clipboard.writeText(link).then(()=>{config.value.onCopyLink(link)}).catch(e2=>console.error(e2))};return()=>(0,runtime_core_esm_bundler.h)("div",{class:"link-preview"},(0,runtime_core_esm_bundler.h)(link_tooltip_Icon,{class:"button link-icon",icon:config.value.linkIcon,onClick:onClickPreview}),(0,runtime_core_esm_bundler.h)("a",{href:src.value,target:"_blank",class:"link-display"},src.value),(0,runtime_core_esm_bundler.h)(link_tooltip_Icon,{class:"button link-edit-button",icon:config.value.editButton,onClick:onClickEditButton}),(0,runtime_core_esm_bundler.h)(link_tooltip_Icon,{class:"button link-remove-button",icon:config.value.removeButton,onClick:onClickRemoveButton}))}});var _content,_provider,_slice,_config,_src,_onEdit,_onRemove,_app,_hovering,_onStateChange,_onMouseEnter,_onMouseLeave,_hide,__typeError=msg=>{throw TypeError(msg)},__accessCheck=(obj,member,msg)=>member.has(obj)||__typeError("Cannot "+msg),__privateGet=(obj,member,getter)=>(__accessCheck(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd=(obj,member,value)=>member.has(obj)?__typeError("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),__privateSet=(obj,member,value,setter)=>(__accessCheck(obj,member,"write to private field"),member.set(obj,value),value);class LinkPreviewTooltip{constructor(ctx,view){this.ctx=ctx,__privateAdd(this,_content),__privateAdd(this,_provider),__privateAdd(this,_slice,this.ctx.use(linkTooltipState.key)),__privateAdd(this,_config),__privateAdd(this,_src,(0,reactivity_esm_bundler.KR)("")),__privateAdd(this,_onEdit,(0,reactivity_esm_bundler.KR)(()=>{})),__privateAdd(this,_onRemove,(0,reactivity_esm_bundler.KR)(()=>{})),__privateAdd(this,_app),__privateAdd(this,_hovering,!1),__privateAdd(this,_onStateChange,({mode})=>{"edit"===mode&&__privateGet(this,_hide).call(this)}),__privateAdd(this,_onMouseEnter,()=>{__privateSet(this,_hovering,!0)}),__privateAdd(this,_onMouseLeave,()=>{__privateSet(this,_hovering,!1)}),__privateAdd(this,_hide,()=>{__privateGet(this,_provider).hide(),__privateGet(this,_provider).element.removeEventListener("mouseenter",__privateGet(this,_onMouseEnter)),__privateGet(this,_provider).element.removeEventListener("mouseleave",__privateGet(this,_onMouseLeave))}),this.show=(mark,from,to,rect)=>{__privateGet(this,_config).value=this.ctx.get(linkTooltipConfig.key),__privateGet(this,_src).value=mark.attrs.href,__privateGet(this,_onEdit).value=()=>{this.ctx.get(linkTooltipAPI.key).editLink(mark,from,to)},__privateGet(this,_onRemove).value=()=>{this.ctx.get(linkTooltipAPI.key).removeLink(from,to),__privateGet(this,_hide).call(this)},__privateGet(this,_provider).show({getBoundingClientRect:()=>rect}),__privateGet(this,_provider).element.addEventListener("mouseenter",__privateGet(this,_onMouseEnter)),__privateGet(this,_provider).element.addEventListener("mouseleave",__privateGet(this,_onMouseLeave))},this.hide=()=>{__privateGet(this,_hovering)||__privateGet(this,_hide).call(this)},this.update=()=>{},this.destroy=()=>{__privateGet(this,_app).unmount(),__privateGet(this,_slice).off(__privateGet(this,_onStateChange)),__privateGet(this,_provider).destroy(),__privateGet(this,_content).remove()},__privateSet(this,_config,(0,reactivity_esm_bundler.KR)(this.ctx.get(linkTooltipConfig.key))),__privateSet(this,_app,(0,runtime_dom_esm_bundler.Ef)(PreviewLink,{config:__privateGet(this,_config),src:__privateGet(this,_src),onEdit:__privateGet(this,_onEdit),onRemove:__privateGet(this,_onRemove)})),__privateSet(this,_content,document.createElement("div")),__privateGet(this,_content).className="milkdown-link-preview",__privateGet(this,_app).mount(__privateGet(this,_content)),__privateSet(this,_provider,new TooltipProvider({debounce:0,content:__privateGet(this,_content),shouldShow:()=>!1})),__privateGet(this,_provider).update(view),__privateSet(this,_slice,ctx.use(linkTooltipState.key)),__privateGet(this,_slice).on(__privateGet(this,_onStateChange))}}function configureLinkPreviewTooltip(ctx){let linkPreviewTooltipView;const onMouseMove=(0,debounce.A)((view,event)=>{if(!linkPreviewTooltipView)return;if(!view.hasFocus())return;if("edit"===ctx.get(linkTooltipState.key).mode)return;const result=function shouldShowPreviewWhenHover(ctx,view,event){const $pos=view.posAtCoords({left:event.clientX,top:event.clientY});if(!$pos)return;const{pos}=$pos,node=view.state.doc.nodeAt(pos);if(!node)return;const mark=node.marks.find(mark2=>mark2.type===preset_commonmark_lib.Yk.mark.type(ctx));if(!mark)return;return linkPreviewTooltip.pluginKey()?{show:!0,pos,node,mark}:void 0}(ctx,view,event);if(result){const position=view.state.doc.resolve(result.pos),markPosition=function findMarkPosition(mark,node,doc,from,to){let markPos={start:-1,end:-1};return doc.nodesBetween(from,to,(n,pos)=>{if(markPos.start>-1)return!1;-1===markPos.start&&mark.isInSet(n.marks)&&node===n&&(markPos={start:pos,end:pos+Math.max(n.textContent.length,1)})}),markPos}(result.mark,result.node,view.state.doc,position.before(),position.after()),from=markPosition.start,to=markPosition.end;return void linkPreviewTooltipView.show(result.mark,from,to,(0,lib.MG)(view,from,to))}linkPreviewTooltipView.hide()},50);ctx.set(linkPreviewTooltip.key,{props:{handleDOMEvents:{mousemove:onMouseMove,mouseleave:()=>{setTimeout(()=>{null==linkPreviewTooltipView||linkPreviewTooltipView.hide()},50)}}},view:view=>(linkPreviewTooltipView=new LinkPreviewTooltip(ctx,view),linkPreviewTooltipView)})}function configureLinkTooltip(ctx){configureLinkPreviewTooltip(ctx),configureLinkEditTooltip(ctx)}_content=new WeakMap,_provider=new WeakMap,_slice=new WeakMap,_config=new WeakMap,_src=new WeakMap,_onEdit=new WeakMap,_onRemove=new WeakMap,_app=new WeakMap,_hovering=new WeakMap,_onStateChange=new WeakMap,_onMouseEnter=new WeakMap,_onMouseLeave=new WeakMap,_hide=new WeakMap;const linkTooltipPlugin=[linkTooltipState,linkTooltipAPI,linkTooltipConfig,linkPreviewTooltip,linkEditTooltip,toggleLinkCommand].flat();var list_item_block_defProp=Object.defineProperty,list_item_block_getOwnPropSymbols=Object.getOwnPropertySymbols,list_item_block_hasOwnProp=Object.prototype.hasOwnProperty,list_item_block_propIsEnum=Object.prototype.propertyIsEnumerable,list_item_block_defNormalProp=(obj,key,value)=>key in obj?list_item_block_defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,list_item_block_spreadValues=(a,b)=>{for(var prop in b||(b={}))list_item_block_hasOwnProp.call(b,prop)&&list_item_block_defNormalProp(a,prop,b[prop]);if(list_item_block_getOwnPropSymbols)for(var prop of list_item_block_getOwnPropSymbols(b))list_item_block_propIsEnum.call(b,prop)&&list_item_block_defNormalProp(a,prop,b[prop]);return a};function list_item_block_withMeta(plugin,meta){return Object.assign(plugin,{meta:list_item_block_spreadValues({package:"@milkdown/components"},meta)}),plugin}const listItemBlockConfig=(0,utils_lib.Qx)({renderLabel:({label,listType,checked})=>null==checked?"bullet"===listType?"⦿":label:checked?"☑":"□"},"listItemBlockConfigCtx");function list_item_block_Icon({icon,class:className,onClick}){return(0,runtime_core_esm_bundler.h)("span",{class:(0,clsx.A)("milkdown-icon",className),onPointerdown:onClick,ref:el=>{el&&icon&&(el.innerHTML=purify_es.A.sanitize(icon.trim()))}})}list_item_block_withMeta(listItemBlockConfig,{displayName:"Config<list-item-block>",group:"ListItemBlock"}),list_item_block_Icon.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const ListItem=(0,runtime_core_esm_bundler.pM)({props:{label:{type:Object,required:!0},checked:{type:Object,required:!0},listType:{type:Object,required:!0},config:{type:Object,required:!0},readonly:{type:Object,required:!0},selected:{type:Object,required:!0},setAttr:{type:Function,required:!0},onMount:{type:Function,required:!0}},setup({label,checked,listType,config,readonly,setAttr,onMount,selected}){const contentWrapperRef=div=>{null!=div&&div instanceof Element&&onMount(div)},onClickLabel=e=>{e.stopPropagation(),e.preventDefault(),null!=checked.value&&setAttr("checked",!checked.value)},icon=(0,runtime_core_esm_bundler.EW)(()=>config.renderLabel({label:label.value,listType:listType.value,checked:checked.value,readonly:readonly.value})),labelClass=(0,runtime_core_esm_bundler.EW)(()=>null==checked.value?"bullet"===listType.value?"bullet":"ordered":checked.value?"checked":"unchecked");return()=>(0,runtime_core_esm_bundler.h)("li",{class:(0,clsx.A)("list-item",selected.value&&"ProseMirror-selectednode")},(0,runtime_core_esm_bundler.h)("div",{class:"label-wrapper",onPointerdown:onClickLabel,contenteditable:!1},(0,runtime_core_esm_bundler.h)(list_item_block_Icon,{class:(0,clsx.A)("label",readonly.value&&"readonly",labelClass.value),icon:icon.value})),(0,runtime_core_esm_bundler.h)("div",{class:"children",ref:contentWrapperRef}))}}),listItemBlockView=(0,utils_lib.m5)(preset_commonmark_lib.hm.node,ctx=>(initialNode,view,getPos)=>{const dom=document.createElement("div");dom.className="milkdown-list-item-block";const contentDOM=document.createElement("div");contentDOM.setAttribute("data-content-dom","true"),contentDOM.classList.add("content-dom");const label=(0,reactivity_esm_bundler.KR)(initialNode.attrs.label),checked=(0,reactivity_esm_bundler.KR)(initialNode.attrs.checked),listType=(0,reactivity_esm_bundler.KR)(initialNode.attrs.listType),readonly=(0,reactivity_esm_bundler.KR)(!view.editable),config=ctx.get(listItemBlockConfig.key),selected=(0,reactivity_esm_bundler.KR)(!1),disposeSelectedWatcher=(0,runtime_core_esm_bundler.nT)(()=>{selected.value?dom.classList.add("selected"):dom.classList.remove("selected")});let raf=0;const app=(0,runtime_dom_esm_bundler.Ef)(ListItem,{label,checked,listType,readonly,config,selected,setAttr:(attr,value)=>{if(!view.editable)return;const pos=getPos();null!=pos&&(view.hasFocus()||view.focus(),view.dispatch(view.state.tr.setNodeAttribute(pos,attr,value)))},onMount:div=>{const{anchor,head}=view.state.selection;div.appendChild(contentDOM);const anchorPos=view.state.doc.resolve(anchor),headPos=view.state.doc.resolve(head);raf=requestAnimationFrame(()=>{if(cancelAnimationFrame(raf),!anchorPos.doc.eq(view.state.doc))return;const selection=new prosemirror_state_dist.U3(anchorPos,headPos);view.dispatch(view.state.tr.setSelection(selection))})}});app.mount(dom);const bindAttrs=node2=>{listType.value=node2.attrs.listType,label.value=node2.attrs.label,checked.value=node2.attrs.checked,readonly.value=!view.editable};bindAttrs(initialNode);let node=initialNode;return{dom,contentDOM,update:updatedNode=>updatedNode.type===initialNode.type&&(updatedNode.sameMarkup(node)&&updatedNode.content.eq(node.content)||(node=updatedNode,bindAttrs(updatedNode)),!0),ignoreMutation:mutation=>!dom||!contentDOM||"selection"!==mutation.type&&(contentDOM===mutation.target&&"attributes"===mutation.type||!contentDOM.contains(mutation.target)),selectNode:()=>{selected.value=!0},deselectNode:()=>{selected.value=!1},destroy:()=>{disposeSelectedWatcher(),app.unmount(),dom.remove(),contentDOM.remove()}}});list_item_block_withMeta(listItemBlockView,{displayName:"NodeView<list-item-block>",group:"ListItemBlock"});const listItemBlockComponent=[listItemBlockConfig,listItemBlockView];var table_block_defProp$1=Object.defineProperty,table_block_getOwnPropSymbols$1=Object.getOwnPropertySymbols,table_block_hasOwnProp$1=Object.prototype.hasOwnProperty,table_block_propIsEnum$1=Object.prototype.propertyIsEnumerable,table_block_defNormalProp$1=(obj,key,value)=>key in obj?table_block_defProp$1(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,table_block_spreadValues$1=(a,b)=>{for(var prop in b||(b={}))table_block_hasOwnProp$1.call(b,prop)&&table_block_defNormalProp$1(a,prop,b[prop]);if(table_block_getOwnPropSymbols$1)for(var prop of table_block_getOwnPropSymbols$1(b))table_block_propIsEnum$1.call(b,prop)&&table_block_defNormalProp$1(a,prop,b[prop]);return a};function table_block_withMeta(plugin,meta){return Object.assign(plugin,{meta:table_block_spreadValues$1({package:"@milkdown/components"},meta)}),plugin}var table_block_defProp=Object.defineProperty,table_block_getOwnPropSymbols=Object.getOwnPropertySymbols,table_block_hasOwnProp=Object.prototype.hasOwnProperty,table_block_propIsEnum=Object.prototype.propertyIsEnumerable,table_block_defNormalProp=(obj,key,value)=>key in obj?table_block_defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value;const tableBlockConfig=(0,utils_lib.Qx)(((a,b)=>{for(var prop in b||(b={}))table_block_hasOwnProp.call(b,prop)&&table_block_defNormalProp(a,prop,b[prop]);if(table_block_getOwnPropSymbols)for(var prop of table_block_getOwnPropSymbols(b))table_block_propIsEnum.call(b,prop)&&table_block_defNormalProp(a,prop,b[prop]);return a})({},{renderButton:renderType=>{switch(renderType){case"add_row":case"add_col":return"+";case"delete_row":case"delete_col":return"-";case"align_col_left":return"left";case"align_col_center":return"center";case"align_col_right":return"right";case"col_drag_handle":case"row_drag_handle":return"="}}}),"tableBlockConfigCtx");function table_block_Icon({icon,class:className,onClick}){return(0,runtime_core_esm_bundler.h)("span",{class:(0,clsx.A)("milkdown-icon",className),onPointerdown:onClick,ref:el=>{el&&icon&&(el.innerHTML=purify_es.A.sanitize(icon.trim()))}})}function prepareDndContext(refs){const{dragPreviewRef,tableWrapperRef,contentWrapperRef,yLineHandleRef,xLineHandleRef,colHandleRef,rowHandleRef}=refs,preview=dragPreviewRef.value;if(!preview)return;const wrapper=tableWrapperRef.value;if(!wrapper)return;const content=contentWrapperRef.value;if(!content)return;const contentRoot=content.querySelector("tbody");if(!contentRoot)return;const previewRoot=preview.querySelector("tbody");if(!previewRoot)return;const yHandle=yLineHandleRef.value;if(!yHandle)return;const xHandle=xLineHandleRef.value;if(!xHandle)return;const colHandle=colHandleRef.value;if(!colHandle)return;const rowHandle=rowHandleRef.value;if(!rowHandle)return;return{preview,wrapper,content,contentRoot,previewRoot,yHandle,xHandle,colHandle,rowHandle}}function clearPreview(previewRoot){for(;previewRoot.firstChild;)previewRoot.removeChild(previewRoot.firstChild)}function renderPreview(axis,preview,previewRoot,tableContent,index){const{width:tableWidth,height:tableHeight}=tableContent.querySelector("tbody").getBoundingClientRect();if("y"===axis){const row=tableContent.querySelectorAll("tr")[index];if(!row)return;previewRoot.appendChild(row.cloneNode(!0));const height=row.getBoundingClientRect().height;return Object.assign(preview.style,{width:`${tableWidth}px`,height:`${height}px`}),void(preview.dataset.show="true")}if("x"===axis){const rows=tableContent.querySelectorAll("tr");let width;return Array.from(rows).forEach(row=>{const col=row.children[index];if(!col)return;void 0===width&&(width=col.getBoundingClientRect().width);const tr=col.parentElement.cloneNode(!1),clone=col.cloneNode(!0);tr.appendChild(clone),previewRoot.appendChild(tr)}),Object.assign(preview.style,{width:`${width}px`,height:`${tableHeight}px`}),void(preview.dataset.show="true")}}function updateDragInfo(axis,event,context,refs){const{xHandle,yHandle,colHandle,rowHandle,preview}=context;xHandle.dataset.displayType="y"===axis?"indicator":"none",yHandle.dataset.displayType="x"===axis?"indicator":"none","y"===axis?(colHandle.dataset.show="false",hideButtonGroup(rowHandle)):(rowHandle.dataset.show="false",hideButtonGroup(colHandle));const{hoverIndex,dragInfo}=refs,[rowIndex,colIndex]=hoverIndex.value;dragInfo.value={startCoords:[event.clientX,event.clientY],startIndex:"y"===axis?rowIndex:colIndex,endIndex:"y"===axis?rowIndex:colIndex,type:"y"===axis?"row":"col"},preview.dataset.direction="y"===axis?"vertical":"horizontal"}function handleDrag(refs,event,ctx,fn){const view=null==ctx?void 0:ctx.get(core_lib.kY);if(!(null==view?void 0:view.editable))return;event.stopPropagation(),event.dataTransfer&&(event.dataTransfer.effectAllowed="move");const context=prepareDndContext(refs);context&&requestAnimationFrame(()=>{fn(context)})}function hideButtonGroup(handle){var _a;null==(_a=handle.querySelector(".button-group"))||_a.setAttribute("data-show","false")}function findNodeIndex(parent,child){for(let i=0;i<parent.childCount;i++)if(parent.child(i)===child)return i;return-1}function getRelatedDOM(contentWrapperRef,[rowIndex,columnIndex]){const content=contentWrapperRef.value;if(!content)return;const rows=content.querySelectorAll("tr"),row=rows[rowIndex];if(!row)return;const firstRow=rows[0];if(!firstRow)return;const headerCol=firstRow.children[columnIndex];if(!headerCol)return;const col=row.children[columnIndex];return col?{row,col,headerCol}:void 0}function computeColHandlePositionByIndex({refs,index,before,after}){const{contentWrapperRef,colHandleRef,hoverIndex}=refs,colHandle=colHandleRef.value;if(!colHandle)return;hoverIndex.value=index;const dom=getRelatedDOM(contentWrapperRef,index);if(!dom)return;const{headerCol:col}=dom;colHandle.dataset.show="true",before&&before(colHandle),(0,floating_ui_dom.rD)(col,colHandle,{placement:"top"}).then(({x,y})=>{Object.assign(colHandle.style,{left:`${x}px`,top:`${y}px`}),after&&after(colHandle)}).catch(console.error)}function computeRowHandlePositionByIndex({refs,index,before,after}){const{contentWrapperRef,rowHandleRef,hoverIndex}=refs,rowHandle=rowHandleRef.value;if(!rowHandle)return;hoverIndex.value=index;const dom=getRelatedDOM(contentWrapperRef,index);if(!dom)return;const{row}=dom;rowHandle.dataset.show="true",before&&before(rowHandle),(0,floating_ui_dom.rD)(row,rowHandle,{placement:"left"}).then(({x,y})=>{Object.assign(rowHandle.style,{left:`${x}px`,top:`${y}px`}),after&&after(rowHandle)}).catch(console.error)}function findDragOverElement(elements,pointer,axis){const startProp="x"===axis?"left":"top",endProp="x"===axis?"right":"bottom",lastIndex=elements.length-1,index=elements.findIndex((el,index2)=>{const rect=el.getBoundingClientRect(),boundaryStart=rect[startProp],boundaryEnd=rect[endProp];return boundaryStart<=pointer&&pointer<=boundaryEnd||(index2===lastIndex&&pointer>boundaryEnd||0===index2&&pointer<boundaryStart)}),element=elements[index];return element?[element,index]:void 0}function createDragOverHandler(refs){return(0,throttle.A)(e=>{const context=prepareDndContext(refs);if(!context)return;const{preview,content,contentRoot,xHandle,yHandle}=context,{dragInfo,hoverIndex}=refs;if("false"===preview.dataset.show)return;const dom=getRelatedDOM(refs.contentWrapperRef,hoverIndex.value);if(!dom)return;if(!contentRoot.querySelector("tr"))return;const info=dragInfo.value;if(!info)return;if(!contentRoot.offsetParent)return;const wrapperOffsetTop=contentRoot.offsetParent.offsetTop,wrapperOffsetLeft=contentRoot.offsetParent.offsetLeft;if("col"===info.type){const width=dom.col.getBoundingClientRect().width,{left,width:fullWidth}=contentRoot.getBoundingClientRect(),leftGap=wrapperOffsetLeft-left,previewLeft=e.clientX+leftGap-width/2,[startX]=info.startCoords,direction=startX<e.clientX?"right":"left";preview.style.top=`${wrapperOffsetTop}px`;const previewLeftOffset=previewLeft<left+leftGap-20?left+leftGap-20:previewLeft>left+fullWidth+leftGap-width+20?left+fullWidth+leftGap-width+20:previewLeft;preview.style.left=`${previewLeftOffset}px`;const dragOverColumn=function getDragOverColumn(table,pointerX){const firstRow=table.querySelector("tr");if(!firstRow)return;return findDragOverElement(Array.from(firstRow.children),pointerX,"x")}(contentRoot,e.clientX);if(dragOverColumn){const[col,index]=dragOverColumn,yHandleWidth=yHandle.getBoundingClientRect().width,contentBoundary=content.getBoundingClientRect();info.endIndex=index,(0,floating_ui_dom.rD)(col,yHandle,{placement:"left"===direction?"left":"right",middleware:[(0,floating_ui_dom.cY)("left"===direction?-1*yHandleWidth:0)]}).then(({x})=>{yHandle.dataset.show="true",Object.assign(yHandle.style,{height:`${contentBoundary.height}px`,left:`${x}px`,top:`${wrapperOffsetTop}px`})}).catch(console.error)}}else if("row"===info.type){const height=dom.row.getBoundingClientRect().height,{top,height:fullHeight}=contentRoot.getBoundingClientRect(),topGap=wrapperOffsetTop-top,previewTop=e.clientY+topGap-height/2,[_,startY]=info.startCoords,direction=startY<e.clientY?"down":"up",previewTopOffset=previewTop<top+topGap-20?top+topGap-20:previewTop>top+fullHeight+topGap-height+20?top+fullHeight+topGap-height+20:previewTop;preview.style.top=`${previewTopOffset}px`,preview.style.left=`${wrapperOffsetLeft}px`;const dragOverRow=function getDragOverRow(table,pointerY){return findDragOverElement(Array.from(table.querySelectorAll("tr")),pointerY,"y")}(contentRoot,e.clientY);if(dragOverRow){const[row,index]=dragOverRow,xHandleHeight=xHandle.getBoundingClientRect().height,contentBoundary=content.getBoundingClientRect();info.endIndex=index,(0,floating_ui_dom.rD)(row,xHandle,{placement:"up"===direction?"top":"bottom",middleware:[(0,floating_ui_dom.cY)("up"===direction?-1*xHandleHeight:0)]}).then(({y})=>{xHandle.dataset.show="true",Object.assign(xHandle.style,{width:`${contentBoundary.width}px`,top:`${y}px`})}).catch(console.error)}}},20)}function useDragHandlers(refs,ctx,getPos){const{dragPreviewRef,yLineHandleRef,xLineHandleRef,dragInfo}=refs,dragRow=function createDragRowHandler(refs,ctx){return event=>{handleDrag(refs,event,ctx,context=>{updateDragInfo("y",event,context,refs);const{preview,content,previewRoot}=context;clearPreview(previewRoot);const{hoverIndex}=refs,[rowIndex]=hoverIndex.value;renderPreview("y",preview,previewRoot,content,rowIndex)})}}(refs,ctx),dragCol=function createDragColHandler(refs,ctx){return event=>{handleDrag(refs,event,ctx,context=>{updateDragInfo("x",event,context,refs);const{preview,content,previewRoot}=context,{hoverIndex}=refs,[_,colIndex]=hoverIndex.value;clearPreview(previewRoot),renderPreview("x",preview,previewRoot,content,colIndex)})}}(refs,ctx),onDragEnd=()=>{const preview=dragPreviewRef.value;if(!preview)return;if("false"===preview.dataset.show)return;const previewRoot=null==preview?void 0:preview.querySelector("tbody");for(;null==previewRoot?void 0:previewRoot.firstChild;)null==previewRoot||previewRoot.removeChild(previewRoot.firstChild);preview&&(preview.dataset.show="false")},onDrop=()=>{var _a;const preview=dragPreviewRef.value;if(!preview)return;const yHandle=yLineHandleRef.value;if(!yHandle)return;const xHandle=xLineHandleRef.value;if(!xHandle)return;const info=dragInfo.value;if(!info)return;if(!ctx)return;if("false"===preview.dataset.show)return;if(!refs.colHandleRef.value)return;if(!refs.rowHandleRef.value)return;if(yHandle.dataset.show="false",xHandle.dataset.show="false",info.startIndex===info.endIndex)return;const commands=ctx.get(core_lib.MD),payload={from:info.startIndex,to:info.endIndex,pos:(null!=(_a=null==getPos?void 0:getPos())?_a:0)+1};if("col"===info.type){commands.call(selectColCommand.key,{pos:payload.pos,index:info.startIndex}),commands.call(moveColCommand.key,payload);const index=[0,info.endIndex];computeColHandlePositionByIndex({refs,index})}else{commands.call(selectRowCommand.key,{pos:payload.pos,index:info.startIndex}),commands.call(moveRowCommand.key,payload);const index=[info.endIndex,0];computeRowHandlePositionByIndex({refs,index})}requestAnimationFrame(()=>{ctx.get(core_lib.kY).focus()})},onDragOver=createDragOverHandler(refs);return(0,runtime_core_esm_bundler.sV)(()=>{window.addEventListener("dragover",onDragOver),window.addEventListener("dragend",onDragEnd),window.addEventListener("drop",onDrop)}),(0,runtime_core_esm_bundler.hi)(()=>{window.removeEventListener("dragover",onDragOver),window.removeEventListener("dragend",onDragEnd),window.removeEventListener("drop",onDrop)}),{dragRow,dragCol}}function createPointerMoveHandler(refs,view){return(0,throttle.A)(e=>{if(!(null==view?void 0:view.editable))return;const{contentWrapperRef,yLineHandleRef,xLineHandleRef,colHandleRef,rowHandleRef,hoverIndex,lineHoverIndex}=refs,yHandle=yLineHandleRef.value;if(!yHandle)return;const xHandle=xLineHandleRef.value;if(!xHandle)return;const content=contentWrapperRef.value;if(!content)return;const rowHandle=rowHandleRef.value;if(!rowHandle)return;const colHandle=colHandleRef.value;if(!colHandle)return;const index=function findPointerIndex(event,view){var _a,_b,_c;if(view)try{const posAtCoords=view.posAtCoords({left:event.clientX,top:event.clientY});if(!posAtCoords)return;const pos=null==posAtCoords?void 0:posAtCoords.inside;if(null==pos||pos<0)return;const $pos=view.state.doc.resolve(pos),node=view.state.doc.nodeAt(pos);if(!node)return;const cellType=["table_cell","table_header"],rowType=["table_row","table_header_row"],cell=cellType.includes(node.type.name)?node:null==(_a=(0,lib.gi)(node2=>cellType.includes(node2.type.name))($pos))?void 0:_a.node,row=null==(_b=(0,lib.gi)(node2=>rowType.includes(node2.type.name))($pos))?void 0:_b.node,table=null==(_c=(0,lib.gi)(node2=>"table"===node2.type.name)($pos))?void 0:_c.node;if(!cell||!row||!table)return;const columnIndex=findNodeIndex(row,cell);return[findNodeIndex(table,row),columnIndex]}catch(e){return}}(e,view);if(!index)return;const dom=getRelatedDOM(contentWrapperRef,index);if(!dom)return;const[rowIndex,colIndex]=index,boundary=dom.col.getBoundingClientRect(),closeToBoundaryLeft=Math.abs(e.clientX-boundary.left)<8,closeToBoundaryRight=Math.abs(boundary.right-e.clientX)<8,closeToBoundaryTop=Math.abs(e.clientY-boundary.top)<8,closeToBoundaryBottom=Math.abs(boundary.bottom-e.clientY)<8,closeToBoundary=closeToBoundaryLeft||closeToBoundaryRight||closeToBoundaryTop||closeToBoundaryBottom,rowButtonGroup=rowHandle.querySelector(".button-group"),colButtonGroup=colHandle.querySelector(".button-group");if(rowButtonGroup&&(rowButtonGroup.dataset.show="false"),colButtonGroup&&(colButtonGroup.dataset.show="false"),closeToBoundary){const contentBoundary=content.getBoundingClientRect();rowHandle.dataset.show="false",colHandle.dataset.show="false",xHandle.dataset.displayType="tool",yHandle.dataset.displayType="tool";const yHandleWidth=yHandle.getBoundingClientRect().width,xHandleHeight=xHandle.getBoundingClientRect().height;return closeToBoundaryLeft||closeToBoundaryRight?(lineHoverIndex.value[1]=closeToBoundaryLeft?colIndex:colIndex+1,(0,floating_ui_dom.rD)(dom.col,yHandle,{placement:closeToBoundaryLeft?"left":"right",middleware:[(0,floating_ui_dom.cY)(closeToBoundaryLeft?-1*yHandleWidth:0)]}).then(({x})=>{yHandle.dataset.show="true",Object.assign(yHandle.style,{height:`${contentBoundary.height}px`,left:`${x}px`})}).catch(console.error)):yHandle.dataset.show="false",void(0!==index[0]&&(closeToBoundaryTop||closeToBoundaryBottom)?(lineHoverIndex.value[0]=closeToBoundaryTop?rowIndex:rowIndex+1,(0,floating_ui_dom.rD)(dom.row,xHandle,{placement:closeToBoundaryTop?"top":"bottom",middleware:[(0,floating_ui_dom.cY)(closeToBoundaryTop?-1*xHandleHeight:0)]}).then(({y})=>{xHandle.dataset.show="true",Object.assign(xHandle.style,{width:`${contentBoundary.width}px`,top:`${y}px`})}).catch(console.error)):xHandle.dataset.show="false")}lineHoverIndex.value=[-1,-1],yHandle.dataset.show="false",xHandle.dataset.show="false",rowHandle.dataset.show="true",colHandle.dataset.show="true",computeRowHandlePositionByIndex({refs,index}),computeColHandlePositionByIndex({refs,index}),hoverIndex.value=index},20)}function usePointerHandlers(refs,view){const pointerMove=createPointerMoveHandler(refs,view),pointerLeave=function createPointerLeaveHandler(refs){return()=>{const{rowHandleRef,colHandleRef,yLineHandleRef,xLineHandleRef}=refs;setTimeout(()=>{const rowHandle=rowHandleRef.value;if(!rowHandle)return;const colHandle=colHandleRef.value;if(!colHandle)return;const yHandle=yLineHandleRef.value;if(!yHandle)return;const xHandle=xLineHandleRef.value;xHandle&&(rowHandle.dataset.show="false",colHandle.dataset.show="false",yHandle.dataset.show="false",xHandle.dataset.show="false")},200)}}(refs);return{pointerMove,pointerLeave}}table_block_withMeta(tableBlockConfig,{displayName:"Config<table-block>",group:"TableBlock"}),table_block_Icon.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const TableBlock=(0,runtime_core_esm_bundler.pM)({props:{view:{type:Object,required:!0},ctx:{type:Object,required:!0},getPos:{type:Function,required:!0},config:{type:Object,required:!0},onMount:{type:Function,required:!0},node:{type:Object,required:!0}},setup({view,node,ctx,getPos,config,onMount}){const contentWrapperRef=(0,reactivity_esm_bundler.KR)(),contentWrapperFunctionRef=div=>{null!=div&&(div instanceof HTMLElement?(contentWrapperRef.value=div,onMount(div)):contentWrapperRef.value=void 0)},colHandleRef=(0,reactivity_esm_bundler.KR)(),rowHandleRef=(0,reactivity_esm_bundler.KR)(),xLineHandleRef=(0,reactivity_esm_bundler.KR)(),yLineHandleRef=(0,reactivity_esm_bundler.KR)(),tableWrapperRef=(0,reactivity_esm_bundler.KR)(),dragPreviewRef=(0,reactivity_esm_bundler.KR)(),hoverIndex=(0,reactivity_esm_bundler.KR)([0,0]),lineHoverIndex=(0,reactivity_esm_bundler.KR)([-1,-1]),dragInfo=(0,reactivity_esm_bundler.KR)(),refs={dragPreviewRef,tableWrapperRef,contentWrapperRef,yLineHandleRef,xLineHandleRef,colHandleRef,rowHandleRef,hoverIndex,lineHoverIndex,dragInfo},{pointerLeave,pointerMove}=usePointerHandlers(refs,view),{dragRow,dragCol}=useDragHandlers(refs,ctx,getPos),{onAddRow,onAddCol,selectCol,selectRow,deleteSelected,onAlign}=function useOperation(refs,ctx,getPos){const{xLineHandleRef,contentWrapperRef,colHandleRef,rowHandleRef,hoverIndex,lineHoverIndex}=refs;return{onAddRow:()=>{var _a,_b,_c;if(!ctx)return;const xHandle=xLineHandleRef.value;if(!xHandle)return;const[rowIndex]=lineHoverIndex.value;if(rowIndex<0)return;if(!ctx.get(core_lib.kY).editable)return;const rows=Array.from(null!=(_b=null==(_a=contentWrapperRef.value)?void 0:_a.querySelectorAll("tr"))?_b:[]),commands=ctx.get(core_lib.MD),pos=(null!=(_c=null==getPos?void 0:getPos())?_c:0)+1;rows.length===rowIndex?(commands.call(selectRowCommand.key,{pos,index:rowIndex-1}),commands.call(addRowAfterCommand.key)):(commands.call(selectRowCommand.key,{pos,index:rowIndex}),commands.call(addRowBeforeCommand.key)),commands.call(selectRowCommand.key,{pos,index:rowIndex}),xHandle.dataset.show="false"},onAddCol:()=>{var _a,_b,_c,_d;if(!ctx)return;if(!xLineHandleRef.value)return;const[_,colIndex]=lineHoverIndex.value;if(colIndex<0)return;if(!ctx.get(core_lib.kY).editable)return;const cols=Array.from(null!=(_c=null==(_b=null==(_a=contentWrapperRef.value)?void 0:_a.querySelector("tr"))?void 0:_b.children)?_c:[]),commands=ctx.get(core_lib.MD),pos=(null!=(_d=null==getPos?void 0:getPos())?_d:0)+1;cols.length===colIndex?(commands.call(selectColCommand.key,{pos,index:colIndex-1}),commands.call(addColAfterCommand.key)):(commands.call(selectColCommand.key,{pos,index:colIndex}),commands.call(addColBeforeCommand.key)),commands.call(selectColCommand.key,{pos,index:colIndex})},selectCol:()=>{var _a,_b;if(!ctx)return;const[_,colIndex]=hoverIndex.value,commands=ctx.get(core_lib.MD),pos=(null!=(_a=null==getPos?void 0:getPos())?_a:0)+1;commands.call(selectColCommand.key,{pos,index:colIndex});const buttonGroup=null==(_b=colHandleRef.value)?void 0:_b.querySelector(".button-group");buttonGroup&&(buttonGroup.dataset.show="true"===buttonGroup.dataset.show?"false":"true")},selectRow:()=>{var _a,_b;if(!ctx)return;const[rowIndex,_]=hoverIndex.value,commands=ctx.get(core_lib.MD),pos=(null!=(_a=null==getPos?void 0:getPos())?_a:0)+1;commands.call(selectRowCommand.key,{pos,index:rowIndex});const buttonGroup=null==(_b=rowHandleRef.value)?void 0:_b.querySelector(".button-group");buttonGroup&&rowIndex>0&&(buttonGroup.dataset.show="true"===buttonGroup.dataset.show?"false":"true")},deleteSelected:e=>{ctx&&ctx.get(core_lib.kY).editable&&(e.preventDefault(),e.stopPropagation(),ctx.get(core_lib.MD).call(deleteSelectedCellsCommand.key),requestAnimationFrame(()=>{ctx.get(core_lib.kY).focus()}))},onAlign:direction=>e=>{ctx&&ctx.get(core_lib.kY).editable&&(e.preventDefault(),e.stopPropagation(),ctx.get(core_lib.MD).call(setAlignCommand.key,direction),requestAnimationFrame(()=>{ctx.get(core_lib.kY).focus()}))}}}(refs,ctx,getPos);return(0,runtime_core_esm_bundler.sV)(()=>{requestAnimationFrame(()=>{view.editable&&function recoveryStateBetweenUpdate(refs,view,node){if(!node)return;if(!view)return;const{selection}=view.state;if(!(selection instanceof CellSelection))return;const{$from}=selection,table=dist_findTable($from);if(table&&table.node===node){if(selection.isColSelection()){const{$head}=selection;return void computeColHandlePositionByIndex({refs,index:[0,$head.index($head.depth-1)],before:handleDOM=>{var _a;null==(_a=handleDOM.querySelector(".button-group"))||_a.setAttribute("data-show","true")}})}if(selection.isRowSelection()){const{$head}=selection,rowNode=(0,lib.gi)(node2=>"table_row"===node2.type.name||"table_header_row"===node2.type.name)($head);if(!rowNode)return;const rowIndex=findNodeIndex(table.node,rowNode.node);computeRowHandlePositionByIndex({refs,index:[rowIndex,0],before:handleDOM=>{var _a;rowIndex>0&&(null==(_a=handleDOM.querySelector(".button-group"))||_a.setAttribute("data-show","true"))}})}}}(refs,view,node.value)})}),()=>(0,runtime_core_esm_bundler.h)("div",{onDragstart:e=>e.preventDefault(),onDragover:e=>e.preventDefault(),onDragleave:e=>e.preventDefault(),onPointermove:pointerMove,onPointerleave:pointerLeave},(0,runtime_core_esm_bundler.h)("button",{type:"button","data-show":"false",contenteditable:"false",draggable:"true","data-role":"col-drag-handle",class:"handle cell-handle",onDragstart:dragCol,onClick:selectCol,onPointerdown:e=>e.stopPropagation(),onPointermove:e=>e.stopPropagation(),ref:colHandleRef},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("col_drag_handle")}),(0,runtime_core_esm_bundler.h)("div",{"data-show":"false",class:"button-group",onPointermove:e=>e.stopPropagation()},(0,runtime_core_esm_bundler.h)("button",{type:"button",onPointerdown:onAlign("left")},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("align_col_left")})),(0,runtime_core_esm_bundler.h)("button",{type:"button",onPointerdown:onAlign("center")},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("align_col_center")})),(0,runtime_core_esm_bundler.h)("button",{type:"button",onPointerdown:onAlign("right")},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("align_col_right")})),(0,runtime_core_esm_bundler.h)("button",{type:"button",onPointerdown:deleteSelected},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("delete_col")})))),(0,runtime_core_esm_bundler.h)("button",{type:"button","data-show":"false",contenteditable:"false",draggable:"true","data-role":"row-drag-handle",class:"handle cell-handle",onDragstart:dragRow,onClick:selectRow,onPointerdown:e=>e.stopPropagation(),onPointermove:e=>e.stopPropagation(),ref:rowHandleRef},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("row_drag_handle")}),(0,runtime_core_esm_bundler.h)("div",{"data-show":"false",class:"button-group",onPointermove:e=>e.stopPropagation()},(0,runtime_core_esm_bundler.h)("button",{type:"button",onPointerdown:deleteSelected},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("delete_row")})))),(0,runtime_core_esm_bundler.h)("div",{class:"table-wrapper",ref:tableWrapperRef},(0,runtime_core_esm_bundler.h)("div",{"data-show":"false",class:"drag-preview","data-direction":"vertical",ref:dragPreviewRef},(0,runtime_core_esm_bundler.h)("table",null,(0,runtime_core_esm_bundler.h)("tbody",null))),(0,runtime_core_esm_bundler.h)("div",{"data-show":"false",contenteditable:"false","data-display-type":"tool","data-role":"x-line-drag-handle",class:"handle line-handle",onPointermove:e=>e.stopPropagation(),ref:xLineHandleRef},(0,runtime_core_esm_bundler.h)("button",{type:"button",onClick:onAddRow,class:"add-button"},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("add_row")}))),(0,runtime_core_esm_bundler.h)("div",{"data-show":"false",contenteditable:"false","data-display-type":"tool","data-role":"y-line-drag-handle",class:"handle line-handle",onPointermove:e=>e.stopPropagation(),ref:yLineHandleRef},(0,runtime_core_esm_bundler.h)("button",{type:"button",onClick:onAddCol,class:"add-button"},(0,runtime_core_esm_bundler.h)(table_block_Icon,{icon:config.renderButton("add_col")}))),(0,runtime_core_esm_bundler.h)("table",{ref:contentWrapperFunctionRef,class:"children"})))}});var _TableNodeView_instances,handleClick_fn,table_block_typeError=msg=>{throw TypeError(msg)},__privateMethod=(obj,member,method)=>(((obj,member,msg)=>{member.has(obj)||table_block_typeError("Cannot "+msg)})(obj,member,"access private method"),method);class TableNodeView{constructor(ctx,node,view,getPos){var obj,member,value;this.ctx=ctx,this.node=node,this.view=view,this.getPos=getPos,obj=this,(member=_TableNodeView_instances).has(obj)?table_block_typeError("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value);const dom=document.createElement("div");dom.className="milkdown-table-block";const contentDOM=document.createElement("tbody");this.contentDOM=contentDOM,contentDOM.setAttribute("data-content-dom","true"),contentDOM.classList.add("content-dom"),this.nodeRef=(0,reactivity_esm_bundler.IJ)(node);const app=(0,runtime_dom_esm_bundler.Ef)(TableBlock,{view,ctx,getPos,config:ctx.get(tableBlockConfig.key),onMount:div=>{div.appendChild(contentDOM)},node:this.nodeRef});app.mount(dom),this.app=app,this.dom=dom}update(node){return node.type===this.node.type&&((!node.sameMarkup(this.node)||!node.content.eq(this.node.content))&&(this.node=node,this.nodeRef.value=node,!0))}stopEvent(e){if("drop"===e.type||e.type.startsWith("drag"))return!0;if("mousedown"===e.type||"pointerdown"===e.type){if(e.target instanceof Element&&e.target.closest("button"))return!0;const target=e.target;if(target instanceof HTMLElement&&(target.closest("th")||target.closest("td"))){const event=e;return __privateMethod(this,_TableNodeView_instances,handleClick_fn).call(this,event)}}return!1}ignoreMutation(mutation){return!this.dom||!this.contentDOM||"selection"!==mutation.type&&(this.contentDOM===mutation.target&&"attributes"===mutation.type||!this.contentDOM.contains(mutation.target))}destroy(){this.app.unmount(),this.dom.remove(),this.contentDOM.remove()}}_TableNodeView_instances=new WeakSet,handleClick_fn=function(event){const view=this.view;if(!view.editable)return!1;const{state,dispatch}=view,pos=view.posAtCoords({left:event.clientX,top:event.clientY});if(!pos)return!1;const $pos=state.doc.resolve(pos.inside),node=(0,lib.gi)(node2=>"table_cell"===node2.type.name||"table_header"===node2.type.name)($pos);if(!node)return!1;if(state.selection instanceof prosemirror_state_dist.U3){const currentNode=(0,lib.gi)(node2=>"table_cell"===node2.type.name||"table_header"===node2.type.name)(state.selection.$from);if((null==currentNode?void 0:currentNode.node)===node.node)return!1}const{from}=node,selection=prosemirror_state_dist.nh.create(state.doc,from+1);return!state.selection.eq(selection)&&(state.selection instanceof CellSelection?setTimeout(()=>{dispatch(state.tr.setSelection(selection).scrollIntoView())},20):requestAnimationFrame(()=>{dispatch(state.tr.setSelection(selection).scrollIntoView())}),!0)};const tableBlockView=(0,utils_lib.m5)(tableSchema.node,ctx=>(initialNode,view,getPos)=>new TableNodeView(ctx,initialNode,view,getPos));table_block_withMeta(tableBlockView,{displayName:"NodeView<table-block>",group:"TableBlock"});const tableBlock=[tableBlockConfig,tableBlockView];function isPureText(content){if(!content)return!1;if(Array.isArray(content))return!(content.length>1)&&isPureText(content[0]);const child=content.content;return child?isPureText(child):"text"===content.type}const clipboard=(0,utils_lib.Gf)(ctx=>{const schema=ctx.get(core_lib.pZ);ctx.update(core_lib.QM,prev=>({...prev,editable:prev.editable??(()=>!0)}));const key=new prosemirror_state_dist.hs("MILKDOWN_CLIPBOARD");return new prosemirror_state_dist.k_({key,props:{handlePaste:(view,event)=>{const parser=ctx.get(core_lib.bQ),editable=view.props.editable?.(view.state),{clipboardData}=event;if(!editable||!clipboardData)return!1;if(view.state.selection.$from.node().type.spec.code)return!1;const text=clipboardData.getData("text/plain"),vscodeData=clipboardData.getData("vscode-editor-data");if(vscodeData){const data=JSON.parse(vscodeData),language=data?.mode;if(text&&language){const{tr}=view.state,codeBlock=(0,lib.UX)("code_block",schema);return tr.replaceSelectionWith(codeBlock.create({language})).setSelection(prosemirror_state_dist.U3.near(tr.doc.resolve(Math.max(0,tr.selection.from-2)))).insertText(text.replace(/\r\n?/g,"\n")),view.dispatch(tr),!0}}const html=clipboardData.getData("text/html");if(0===html.length&&0===text.length)return!1;const domParser=prosemirror_model_dist.S4.fromSchema(schema);let dom;if(0===html.length){const slice2=parser(text);if(!slice2||"string"==typeof slice2)return!1;dom=prosemirror_model_dist.ZF.fromSchema(schema).serializeFragment(slice2.content)}else{const template=document.createElement("template");template.innerHTML=html,dom=template.content.cloneNode(!0),template.remove()}const slice=domParser.parseSlice(dom),node=(0,lib.EO)(slice);return node?(view.dispatch(view.state.tr.replaceSelectionWith(node,!0)),!0):(view.dispatch(view.state.tr.replaceSelection(slice)),!0)},clipboardTextSerializer:slice=>{const serializer=ctx.get(core_lib.M);if(isPureText(slice.content.toJSON()))return slice.content.textBetween(0,slice.content.size,"\n\n");const doc=schema.topNodeType.createAndFill(void 0,slice.content);if(!doc)return"";return serializer(doc)}}})});function plugin_history_lib_withMeta(plugin,meta){return Object.assign(plugin,{meta:{package:"@milkdown/plugin-history",...meta}}),plugin}clipboard.meta={displayName:"Prose<clipboard>",package:"@milkdown/plugin-clipboard"};const undoCommand=(0,utils_lib.yu)("Undo",()=>()=>prosemirror_history_dist.tN);plugin_history_lib_withMeta(undoCommand,{displayName:"Command<undo>"});const redoCommand=(0,utils_lib.yu)("Redo",()=>()=>prosemirror_history_dist.ZS);plugin_history_lib_withMeta(redoCommand,{displayName:"Command<redo>"});const historyProviderConfig=(0,utils_lib.Qx)({},"historyProviderConfig");plugin_history_lib_withMeta(historyProviderConfig,{displayName:"Ctx<historyProviderConfig>"});const historyProviderPlugin=(0,utils_lib.Gf)(ctx=>(0,prosemirror_history_dist.b6)(ctx.get(historyProviderConfig.key)));plugin_history_lib_withMeta(historyProviderPlugin,{displayName:"Ctx<historyProviderPlugin>"});const lib_historyKeymap=(0,utils_lib.pq)("historyKeymap",{Undo:{shortcuts:"Mod-z",command:ctx=>{const commands=ctx.get(core_lib.MD);return()=>commands.call(undoCommand.key)}},Redo:{shortcuts:["Mod-y","Shift-Mod-z"],command:ctx=>{const commands=ctx.get(core_lib.MD);return()=>commands.call(redoCommand.key)}}});plugin_history_lib_withMeta(lib_historyKeymap.ctx,{displayName:"KeymapCtx<history>"}),plugin_history_lib_withMeta(lib_historyKeymap.shortcuts,{displayName:"Keymap<history>"});const lib_history=[historyProviderConfig,historyProviderPlugin,lib_historyKeymap,undoCommand,redoCommand].flat();const indentConfig=(0,utils_lib.Qx)({type:"space",size:2},"indentConfig");indentConfig.meta={package:"@milkdown/plugin-indent",displayName:"Ctx<indentConfig>"};const indentPlugin=(0,utils_lib.Ht)(ctx=>({Tab:(state,dispatch)=>{const config=ctx.get(indentConfig.key),{tr}=state,_tr=function updateIndent(tr,options){const{doc,selection}=tr;if(!doc||!selection)return tr;if(!(selection instanceof prosemirror_state_dist.U3||selection instanceof prosemirror_state_dist.i5))return tr;const{to}=selection,text="space"===options.type?Array(options.size).fill(" ").join(""):"\t";return tr.insertText(text,to)}(tr,config);return!!_tr.docChanged&&(dispatch?.(_tr),!0)}}));indentPlugin.meta={package:"@milkdown/plugin-indent",displayName:"Shortcut<indent>"};const indent=[indentConfig,indentPlugin];var plugin_listener_lib=__webpack_require__("./node_modules/@milkdown/plugin-listener/lib/index.js"),plugin_trailing_lib=__webpack_require__("./node_modules/@milkdown/plugin-trailing/lib/index.js"),CrepeFeature=(CrepeFeature2=>(CrepeFeature2.CodeMirror="code-mirror",CrepeFeature2.ListItem="list-item",CrepeFeature2.LinkTooltip="link-tooltip",CrepeFeature2.Cursor="cursor",CrepeFeature2.ImageBlock="image-block",CrepeFeature2.BlockEdit="block-edit",CrepeFeature2.Toolbar="toolbar",CrepeFeature2.Placeholder="placeholder",CrepeFeature2.Table="table",CrepeFeature2.Latex="latex",CrepeFeature2))(CrepeFeature||{});const defaultFeatures={cursor:!0,"list-item":!0,"link-tooltip":!0,"image-block":!0,"block-edit":!0,placeholder:!0,toolbar:!0,"code-mirror":!0,table:!0,latex:!0},chevronDownIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    fill="none"\n    viewBox="0 0 24 24"\n    stroke-width="1.5"\n    stroke="currentColor"\n    class="w-6 h-6"\n  >\n    <path\n      stroke-linecap="round"\n      stroke-linejoin="round"\n      d="M19.5 8.25l-7.5 7.5-7.5-7.5"\n    />\n  </svg>\n',clearIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_1098_15553)">\n      <path\n        d="M18.3007 5.70973C17.9107 5.31973 17.2807 5.31973 16.8907 5.70973L12.0007 10.5897L7.1107 5.69973C6.7207 5.30973 6.0907 5.30973 5.7007 5.69973C5.3107 6.08973 5.3107 6.71973 5.7007 7.10973L10.5907 11.9997L5.7007 16.8897C5.3107 17.2797 5.3107 17.9097 5.7007 18.2997C6.0907 18.6897 6.7207 18.6897 7.1107 18.2997L12.0007 13.4097L16.8907 18.2997C17.2807 18.6897 17.9107 18.6897 18.3007 18.2997C18.6907 17.9097 18.6907 17.2797 18.3007 16.8897L13.4107 11.9997L18.3007 7.10973C18.6807 6.72973 18.6807 6.08973 18.3007 5.70973Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_1098_15553">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',codeIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8081)">\n      <path\n        d="M9.4 16.6L4.8 12L9.4 7.4L8 6L2 12L8 18L9.4 16.6ZM14.6 16.6L19.2 12L14.6 7.4L16 6L22 12L16 18L14.6 16.6Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8081">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',confirmIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n    fill="none"\n  >\n    <g clip-path="url(#clip0_1013_1606)">\n      <path\n        d="M9.00012 16.1998L5.50012 12.6998C5.11012 12.3098 4.49012 12.3098 4.10012 12.6998C3.71012 13.0898 3.71012 13.7098 4.10012 14.0998L8.29012 18.2898C8.68012 18.6798 9.31012 18.6798 9.70012 18.2898L20.3001 7.69982C20.6901 7.30982 20.6901 6.68982 20.3001 6.29982C19.9101 5.90982 19.2901 5.90982 18.9001 6.29982L9.00012 16.1998Z"\n        fill="#817567"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_1013_1606">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',copyIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    height="24px"\n    viewBox="0 -960 960 960"\n    width="24px"\n    fill="none"\n  >\n    <path\n      d="M360-240q-33 0-56.5-23.5T280-320v-480q0-33 23.5-56.5T360-880h360q33 0 56.5 23.5T800-800v480q0 33-23.5 56.5T720-240H360Zm0-80h360v-480H360v480ZM200-80q-33 0-56.5-23.5T120-160v-560h80v560h440v80H200Zm160-240v-480 480Z"\n    />\n  </svg>\n',dragHandleIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="16"\n    height="16"\n    viewBox="0 0 16 16"\n  >\n    <path\n      d="M3.5 9.83366C3.35833 9.83366 3.23961 9.78571 3.14383 9.68983C3.04794 9.59394 3 9.47516 3 9.33349C3 9.19171 3.04794 9.07299 3.14383 8.97733C3.23961 8.88155 3.35833 8.83366 3.5 8.83366H12.5C12.6417 8.83366 12.7604 8.8816 12.8562 8.97749C12.9521 9.07338 13 9.19216 13 9.33383C13 9.4756 12.9521 9.59433 12.8562 9.68999C12.7604 9.78577 12.6417 9.83366 12.5 9.83366H3.5ZM3.5 7.16699C3.35833 7.16699 3.23961 7.11905 3.14383 7.02316C3.04794 6.92727 3 6.80849 3 6.66683C3 6.52505 3.04794 6.40633 3.14383 6.31066C3.23961 6.21488 3.35833 6.16699 3.5 6.16699H12.5C12.6417 6.16699 12.7604 6.21494 12.8562 6.31083C12.9521 6.40671 13 6.52549 13 6.66716C13 6.80894 12.9521 6.92766 12.8562 7.02333C12.7604 7.1191 12.6417 7.16699 12.5 7.16699H3.5Z"\n    />\n  </svg>\n',editIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_1013_1585)">\n      <path\n        d="M14.06 9.02L14.98 9.94L5.92 19H5V18.08L14.06 9.02ZM17.66 3C17.41 3 17.15 3.1 16.96 3.29L15.13 5.12L18.88 8.87L20.71 7.04C21.1 6.65 21.1 6.02 20.71 5.63L18.37 3.29C18.17 3.09 17.92 3 17.66 3ZM14.06 6.19L3 17.25V21H6.75L17.81 9.94L14.06 6.19Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_1013_1585">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',imageIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8075)">\n      <path\n        d="M19 5V19H5V5H19ZM19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM14.14 11.86L11.14 15.73L9 13.14L6 17H18L14.14 11.86Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8075">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',plusIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_971_7676)">\n      <path\n        d="M18 13H13V18C13 18.55 12.55 19 12 19C11.45 19 11 18.55 11 18V13H6C5.45 13 5 12.55 5 12C5 11.45 5.45 11 6 11H11V6C11 5.45 11.45 5 12 5C12.55 5 13 5.45 13 6V11H18C18.55 11 19 11.45 19 12C19 12.55 18.55 13 18 13Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_971_7676">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',removeIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M7.30775 20.4997C6.81058 20.4997 6.385 20.3227 6.031 19.9687C5.677 19.6147 5.5 19.1892 5.5 18.692V5.99973H5.25C5.0375 5.99973 4.85942 5.92782 4.71575 5.78398C4.57192 5.64015 4.5 5.46198 4.5 5.24948C4.5 5.03682 4.57192 4.85873 4.71575 4.71523C4.85942 4.57157 5.0375 4.49973 5.25 4.49973H9C9 4.2549 9.08625 4.04624 9.25875 3.87374C9.43108 3.7014 9.63967 3.61523 9.8845 3.61523H14.1155C14.3603 3.61523 14.5689 3.7014 14.7413 3.87374C14.9138 4.04624 15 4.2549 15 4.49973H18.75C18.9625 4.49973 19.1406 4.57165 19.2843 4.71548C19.4281 4.85932 19.5 5.03748 19.5 5.24998C19.5 5.46265 19.4281 5.64073 19.2843 5.78423C19.1406 5.9279 18.9625 5.99973 18.75 5.99973H18.5V18.692C18.5 19.1892 18.323 19.6147 17.969 19.9687C17.615 20.3227 17.1894 20.4997 16.6923 20.4997H7.30775ZM17 5.99973H7V18.692C7 18.7818 7.02883 18.8556 7.0865 18.9132C7.14417 18.9709 7.21792 18.9997 7.30775 18.9997H16.6923C16.7821 18.9997 16.8558 18.9709 16.9135 18.9132C16.9712 18.8556 17 18.7818 17 18.692V5.99973ZM10.1543 16.9997C10.3668 16.9997 10.5448 16.9279 10.6885 16.7842C10.832 16.6404 10.9037 16.4622 10.9037 16.2497V8.74973C10.9037 8.53723 10.8318 8.35907 10.688 8.21523C10.5443 8.07157 10.3662 7.99973 10.1535 7.99973C9.941 7.99973 9.76292 8.07157 9.61925 8.21523C9.47575 8.35907 9.404 8.53723 9.404 8.74973V16.2497C9.404 16.4622 9.47583 16.6404 9.6195 16.7842C9.76333 16.9279 9.94158 16.9997 10.1543 16.9997ZM13.8465 16.9997C14.059 16.9997 14.2371 16.9279 14.3807 16.7842C14.5243 16.6404 14.596 16.4622 14.596 16.2497V8.74973C14.596 8.53723 14.5242 8.35907 14.3805 8.21523C14.2367 8.07157 14.0584 7.99973 13.8458 7.99973C13.6333 7.99973 13.4552 8.07157 13.3115 8.21523C13.168 8.35907 13.0962 8.53723 13.0962 8.74973V16.2497C13.0962 16.4622 13.1682 16.6404 13.312 16.7842C13.4557 16.9279 13.6338 16.9997 13.8465 16.9997Z"\n    />\n  </svg>\n',searchIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    fill="none"\n    viewBox="0 0 24 24"\n    stroke-width="1.5"\n    stroke="currentColor"\n    class="w-6 h-6"\n  >\n    <path\n      stroke-linecap="round"\n      stroke-linejoin="round"\n      d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"\n    />\n  </svg>\n',functionsIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="32"\n    height="32"\n    viewBox="0 0 24 24"\n  >\n    <path\n      fill="currentColor"\n      d="M7 19v-.808L13.096 12L7 5.808V5h10v1.25H9.102L14.727 12l-5.625 5.77H17V19z"\n    />\n  </svg>\n',visibilityOffIcon='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    height="24px"\n    viewBox="0 -960 960 960"\n    width="24px"\n  >\n    <path\n      d="m644-428-58-58q9-47-27-88t-93-32l-58-58q17-8 34.5-12t37.5-4q75 0 127.5 52.5T660-500q0 20-4 37.5T644-428Zm128 126-58-56q38-29 67.5-63.5T832-500q-50-101-143.5-160.5T480-720q-29 0-57 4t-55 12l-62-62q41-17 84-25.5t90-8.5q151 0 269 83.5T920-500q-23 59-60.5 109.5T772-302Zm20 246L624-222q-35 11-70.5 16.5T480-200q-151 0-269-83.5T40-500q21-53 53-98.5t73-81.5L56-792l56-56 736 736-56 56ZM222-624q-29 26-53 57t-41 67q50 101 143.5 160.5T480-280q20 0 39-2.5t39-5.5l-36-38q-11 3-21 4.5t-21 1.5q-75 0-127.5-52.5T300-500q0-11 1.5-21t4.5-21l-84-82Zm319 93Zm-151 75Z"\n    />\n  </svg>\n',esm_defaultConfig={[CrepeFeature.CodeMirror]:{theme:theme_one_dark_dist.bM,languages:dist.e,expandIcon:chevronDownIcon,searchIcon,clearSearchIcon:clearIcon,searchPlaceholder:"Search language",noResultText:"No result",previewToggleIcon:previewOnlyMode=>previewOnlyMode?editIcon:visibilityOffIcon}},FeaturesCtx=(0,ctx_lib.Z0)([],"FeaturesCtx"),CrepeCtx=(0,ctx_lib.Z0)({},"CrepeCtx");function useCrepeFeatures(ctx){return ctx.use("FeaturesCtx")}function crepeFeatureConfig(feature){return ctx=>{useCrepeFeatures(ctx).update(features=>features.includes(feature)?features:[...features,feature])}}function isInCodeBlock(selection){return"code_block"===selection.$from.parent.type.name}function isInList(selection){var _a;const type=null==(_a=selection.$from.node(selection.$from.depth-1))?void 0:_a.type;return"list_item"===(null==type?void 0:type.name)}var _groups,_getGroupInstance,__typeError$5=msg=>{throw TypeError(msg)},__accessCheck$5=(obj,member,msg)=>member.has(obj)||__typeError$5("Cannot "+msg),__privateGet$5=(obj,member,getter)=>(__accessCheck$5(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd$5=(obj,member,value)=>member.has(obj)?__typeError$5("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value);class GroupBuilder{constructor(){__privateAdd$5(this,_groups,[]),this.clear=()=>{var obj,member,value;return value=[],__accessCheck$5(obj=this,member=_groups,"write to private field"),member.set(obj,value),this},__privateAdd$5(this,_getGroupInstance,group=>{const groupInstance={group,addItem:(key,item)=>{const data={...item,key};return group.items.push(data),groupInstance},clear:()=>(group.items=[],groupInstance)};return groupInstance}),this.addGroup=(key,label)=>{const group={key,label,items:[]};return __privateGet$5(this,_groups).push(group),__privateGet$5(this,_getGroupInstance).call(this,group)},this.getGroup=key=>{const group=__privateGet$5(this,_groups).find(group2=>group2.key===key);if(!group)throw new Error(`Group with key ${key} not found`);return __privateGet$5(this,_getGroupInstance).call(this,group)},this.build=()=>__privateGet$5(this,_groups)}}_groups=new WeakMap,_getGroupInstance=new WeakMap;const Menu=(0,runtime_core_esm_bundler.pM)({props:{ctx:{type:Object,required:!0},show:{type:Object,required:!0},filter:{type:Object,required:!0},hide:{type:Function,required:!0},config:{type:Object,required:!1}},setup({ctx,show,filter,hide,config}){const host=(0,reactivity_esm_bundler.KR)(),groupInfo=(0,runtime_core_esm_bundler.EW)(()=>function getGroups$1(filter,config,ctx){var _a,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l,_m,_n,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_A,_B,_C,_D,_E,_F,_G,_H,_I,_J,_K,_L,_M,_N,_O,_P,_Q,_R,_S,_T,_U,_V,_W,_X,_Y,_Z,__,_$,_aa,_ba,_ca,_da,_ea,_fa,_ga,_ha,_ia,_ja,_ka,_la,_ma,_na,_oa,_pa,_qa,_ra,_sa,_ta,_ua,_va,_wa,_xa,_ya,_za,_Aa,_Ba,_Ca,_Da,_Ea,_Fa,_Ga,_Ha,_Ia,_Ja,_Ka,_La,_Ma,_Na,_Oa,_Pa,_Qa,_Ra,_Sa,_Ta,_Ua,_Va,_Wa,_Xa,_Ya,_Za,__a,_$a,_ab,_bb,_cb,_db,_eb,_fb,_gb,_hb,_ib,_jb,_kb;const flags=ctx&&useCrepeFeatures(ctx).get(),isLatexEnabled=null==flags?void 0:flags.includes(CrepeFeature.Latex),isImageBlockEnabled=null==flags?void 0:flags.includes(CrepeFeature.ImageBlock),isTableEnabled=null==flags?void 0:flags.includes(CrepeFeature.Table),groupBuilder=new GroupBuilder;if(null!==(null==config?void 0:config.textGroup)){const textGroup=groupBuilder.addGroup("text",null!=(_b=null==(_a=null==config?void 0:config.textGroup)?void 0:_a.label)?_b:"Text");null!==(null==(_c=null==config?void 0:config.textGroup)?void 0:_c.text)&&textGroup.addItem("text",{label:null!=(_f=null==(_e=null==(_d=null==config?void 0:config.textGroup)?void 0:_d.text)?void 0:_e.label)?_f:"Text",icon:null!=(_i=null==(_h=null==(_g=null==config?void 0:config.textGroup)?void 0:_g.text)?void 0:_h.icon)?_i:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_992_5547)">\n      <path\n        d="M5 5.5C5 6.33 5.67 7 6.5 7H10.5V17.5C10.5 18.33 11.17 19 12 19C12.83 19 13.5 18.33 13.5 17.5V7H17.5C18.33 7 19 6.33 19 5.5C19 4.67 18.33 4 17.5 4H6.5C5.67 4 5 4.67 5 5.5Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_992_5547">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),paragraph=preset_commonmark_lib.Wf.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Pv.key,{nodeType:paragraph})}}),null!==(null==(_j=null==config?void 0:config.textGroup)?void 0:_j.h1)&&textGroup.addItem("h1",{label:null!=(_m=null==(_l=null==(_k=null==config?void 0:config.textGroup)?void 0:_k.h1)?void 0:_l.label)?_m:"Heading 1",icon:null!=(_p=null==(_o=null==(_n=null==config?void 0:config.textGroup)?void 0:_n.h1)?void 0:_o.icon)?_p:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_992_5553)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM12 17H14V7H10V9H12V17Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_992_5553">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),heading=preset_commonmark_lib.Y4.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Pv.key,{nodeType:heading,attrs:{level:1}})}}),null!==(null==(_q=null==config?void 0:config.textGroup)?void 0:_q.h2)&&textGroup.addItem("h2",{label:null!=(_t=null==(_s=null==(_r=null==config?void 0:config.textGroup)?void 0:_r.h2)?void 0:_s.label)?_t:"Heading 2",icon:null!=(_w=null==(_v=null==(_u=null==config?void 0:config.textGroup)?void 0:_u.h2)?void 0:_v.icon)?_w:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_992_5559)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15H11V13H13C14.1 13 15 12.11 15 11V9C15 7.89 14.1 7 13 7H9V9H13V11H11C9.9 11 9 11.89 9 13V17H15V15Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_992_5559">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),heading=preset_commonmark_lib.Y4.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Pv.key,{nodeType:heading,attrs:{level:2}})}}),null!==(null==(_x=null==config?void 0:config.textGroup)?void 0:_x.h3)&&textGroup.addItem("h3",{label:null!=(_A=null==(_z=null==(_y=null==config?void 0:config.textGroup)?void 0:_y.h3)?void 0:_z.label)?_A:"Heading 3",icon:null!=(_D=null==(_C=null==(_B=null==config?void 0:config.textGroup)?void 0:_B.h3)?void 0:_C.icon)?_D:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_992_5565)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15V13.5C15 12.67 14.33 12 13.5 12C14.33 12 15 11.33 15 10.5V9C15 7.89 14.1 7 13 7H9V9H13V11H11V13H13V15H9V17H13C14.1 17 15 16.11 15 15Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_992_5565">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),heading=preset_commonmark_lib.Y4.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Pv.key,{nodeType:heading,attrs:{level:3}})}}),null!==(null==(_E=null==config?void 0:config.textGroup)?void 0:_E.h4)&&textGroup.addItem("h4",{label:null!=(_H=null==(_G=null==(_F=null==config?void 0:config.textGroup)?void 0:_F.h4)?void 0:_G.label)?_H:"Heading 4",icon:null!=(_K=null==(_J=null==(_I=null==config?void 0:config.textGroup)?void 0:_I.h4)?void 0:_J.icon)?_K:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7757)">\n      <path\n        d="M19.04 3H5.04004C3.94004 3 3.04004 3.9 3.04004 5V19C3.04004 20.1 3.94004 21 5.04004 21H19.04C20.14 21 21.04 20.1 21.04 19V5C21.04 3.9 20.14 3 19.04 3ZM19.04 19H5.04004V5H19.04V19ZM13.04 17H15.04V7H13.04V11H11.04V7H9.04004V13H13.04V17Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7757">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),heading=preset_commonmark_lib.Y4.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Pv.key,{nodeType:heading,attrs:{level:4}})}}),null!==(null==(_L=null==config?void 0:config.textGroup)?void 0:_L.h5)&&textGroup.addItem("h5",{label:null!=(_O=null==(_N=null==(_M=null==config?void 0:config.textGroup)?void 0:_M.h5)?void 0:_N.label)?_O:"Heading 5",icon:null!=(_R=null==(_Q=null==(_P=null==config?void 0:config.textGroup)?void 0:_P.h5)?void 0:_Q.icon)?_R:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7760)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15V13C15 11.89 14.1 11 13 11H11V9H15V7H9V13H13V15H9V17H13C14.1 17 15 16.11 15 15Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7760">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),heading=preset_commonmark_lib.Y4.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Pv.key,{nodeType:heading,attrs:{level:5}})}}),null!==(null==(_S=null==config?void 0:config.textGroup)?void 0:_S.h6)&&textGroup.addItem("h6",{label:null!=(_V=null==(_U=null==(_T=null==config?void 0:config.textGroup)?void 0:_T.h6)?void 0:_U.label)?_V:"Heading 6",icon:null!=(_Y=null==(_X=null==(_W=null==config?void 0:config.textGroup)?void 0:_W.h6)?void 0:_X.icon)?_Y:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7763)">\n      <path\n        d="M11 17H13C14.1 17 15 16.11 15 15V13C15 11.89 14.1 11 13 11H11V9H15V7H11C9.9 7 9 7.89 9 9V15C9 16.11 9.9 17 11 17ZM11 13H13V15H11V13ZM19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7763">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),heading=preset_commonmark_lib.Y4.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Pv.key,{nodeType:heading,attrs:{level:6}})}}),null!==(null==(_Z=null==config?void 0:config.textGroup)?void 0:_Z.quote)&&textGroup.addItem("quote",{label:null!=(_aa=null==(_$=null==(__=null==config?void 0:config.textGroup)?void 0:__.quote)?void 0:_$.label)?_aa:"Quote",icon:null!=(_da=null==(_ca=null==(_ba=null==config?void 0:config.textGroup)?void 0:_ba.quote)?void 0:_ca.icon)?_da:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7897)">\n      <path\n        d="M7.17 17C7.68 17 8.15 16.71 8.37 16.26L9.79 13.42C9.93 13.14 10 12.84 10 12.53V8C10 7.45 9.55 7 9 7H5C4.45 7 4 7.45 4 8V12C4 12.55 4.45 13 5 13H7L5.97 15.06C5.52 15.95 6.17 17 7.17 17ZM17.17 17C17.68 17 18.15 16.71 18.37 16.26L19.79 13.42C19.93 13.14 20 12.84 20 12.53V8C20 7.45 19.55 7 19 7H15C14.45 7 14 7.45 14 8V12C14 12.55 14.45 13 15 13H17L15.97 15.06C15.52 15.95 16.17 17 17.17 17Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7897">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),blockquote=preset_commonmark_lib.JC.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Qb.key,{nodeType:blockquote})}}),null!==(null==(_ea=null==config?void 0:config.textGroup)?void 0:_ea.divider)&&textGroup.addItem("divider",{label:null!=(_ha=null==(_ga=null==(_fa=null==config?void 0:config.textGroup)?void 0:_fa.divider)?void 0:_ga.label)?_ha:"Divider",icon:null!=(_ka=null==(_ja=null==(_ia=null==config?void 0:config.textGroup)?void 0:_ia.divider)?void 0:_ja.icon)?_ka:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7900)">\n      <path\n        fill-rule="evenodd"\n        clip-rule="evenodd"\n        d="M19 13H5C4.45 13 4 12.55 4 12C4 11.45 4.45 11 5 11H19C19.55 11 20 11.45 20 12C20 12.55 19.55 13 19 13Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7900">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),hr=preset_commonmark_lib.Ab.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.w4.key,{nodeType:hr})}})}if(null!==(null==config?void 0:config.listGroup)){const listGroup=groupBuilder.addGroup("list",null!=(_ma=null==(_la=null==config?void 0:config.listGroup)?void 0:_la.label)?_ma:"List");null!==(null==(_na=null==config?void 0:config.listGroup)?void 0:_na.bulletList)&&listGroup.addItem("bullet-list",{label:null!=(_qa=null==(_pa=null==(_oa=null==config?void 0:config.listGroup)?void 0:_oa.bulletList)?void 0:_pa.label)?_qa:"Bullet List",icon:null!=(_ta=null==(_sa=null==(_ra=null==config?void 0:config.listGroup)?void 0:_ra.bulletList)?void 0:_sa.icon)?_ta:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8070)">\n      <path\n        d="M4 10.5C3.17 10.5 2.5 11.17 2.5 12C2.5 12.83 3.17 13.5 4 13.5C4.83 13.5 5.5 12.83 5.5 12C5.5 11.17 4.83 10.5 4 10.5ZM4 4.5C3.17 4.5 2.5 5.17 2.5 6C2.5 6.83 3.17 7.5 4 7.5C4.83 7.5 5.5 6.83 5.5 6C5.5 5.17 4.83 4.5 4 4.5ZM4 16.5C3.17 16.5 2.5 17.18 2.5 18C2.5 18.82 3.18 19.5 4 19.5C4.82 19.5 5.5 18.82 5.5 18C5.5 17.18 4.83 16.5 4 16.5ZM8 19H20C20.55 19 21 18.55 21 18C21 17.45 20.55 17 20 17H8C7.45 17 7 17.45 7 18C7 18.55 7.45 19 8 19ZM8 13H20C20.55 13 21 12.55 21 12C21 11.45 20.55 11 20 11H8C7.45 11 7 11.45 7 12C7 12.55 7.45 13 8 13ZM7 6C7 6.55 7.45 7 8 7H20C20.55 7 21 6.55 21 6C21 5.45 20.55 5 20 5H8C7.45 5 7 5.45 7 6Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8070">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),bulletList=preset_commonmark_lib.UM.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Qb.key,{nodeType:bulletList})}}),null!==(null==(_ua=null==config?void 0:config.listGroup)?void 0:_ua.orderedList)&&listGroup.addItem("ordered-list",{label:null!=(_xa=null==(_wa=null==(_va=null==config?void 0:config.listGroup)?void 0:_va.orderedList)?void 0:_wa.label)?_xa:"Ordered List",icon:null!=(_Aa=null==(_za=null==(_ya=null==config?void 0:config.listGroup)?void 0:_ya.orderedList)?void 0:_za.icon)?_Aa:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8067)">\n      <path\n        d="M8 7H20C20.55 7 21 6.55 21 6C21 5.45 20.55 5 20 5H8C7.45 5 7 5.45 7 6C7 6.55 7.45 7 8 7ZM20 17H8C7.45 17 7 17.45 7 18C7 18.55 7.45 19 8 19H20C20.55 19 21 18.55 21 18C21 17.45 20.55 17 20 17ZM20 11H8C7.45 11 7 11.45 7 12C7 12.55 7.45 13 8 13H20C20.55 13 21 12.55 21 12C21 11.45 20.55 11 20 11ZM4.5 16H2.5C2.22 16 2 16.22 2 16.5C2 16.78 2.22 17 2.5 17H4V17.5H3.5C3.22 17.5 3 17.72 3 18C3 18.28 3.22 18.5 3.5 18.5H4V19H2.5C2.22 19 2 19.22 2 19.5C2 19.78 2.22 20 2.5 20H4.5C4.78 20 5 19.78 5 19.5V16.5C5 16.22 4.78 16 4.5 16ZM2.5 5H3V7.5C3 7.78 3.22 8 3.5 8C3.78 8 4 7.78 4 7.5V4.5C4 4.22 3.78 4 3.5 4H2.5C2.22 4 2 4.22 2 4.5C2 4.78 2.22 5 2.5 5ZM4.5 10H2.5C2.22 10 2 10.22 2 10.5C2 10.78 2.22 11 2.5 11H3.8L2.12 12.96C2.04 13.05 2 13.17 2 13.28V13.5C2 13.78 2.22 14 2.5 14H4.5C4.78 14 5 13.78 5 13.5C5 13.22 4.78 13 4.5 13H3.2L4.88 11.04C4.96 10.95 5 10.83 5 10.72V10.5C5 10.22 4.78 10 4.5 10Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8067">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),orderedList=preset_commonmark_lib.N.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Qb.key,{nodeType:orderedList})}}),null!==(null==(_Ba=null==config?void 0:config.listGroup)?void 0:_Ba.taskList)&&listGroup.addItem("task-list",{label:null!=(_Ea=null==(_Da=null==(_Ca=null==config?void 0:config.listGroup)?void 0:_Ca.taskList)?void 0:_Da.label)?_Ea:"Task List",icon:null!=(_Ha=null==(_Ga=null==(_Fa=null==config?void 0:config.listGroup)?void 0:_Fa.taskList)?void 0:_Ga.icon)?_Ha:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M5.66936 16.3389L9.39244 12.6158C9.54115 12.4671 9.71679 12.3937 9.91936 12.3957C10.1219 12.3976 10.2975 12.4761 10.4463 12.6312C10.5847 12.7823 10.654 12.9585 10.654 13.1599C10.654 13.3613 10.5847 13.5363 10.4463 13.6851L6.32704 17.8197C6.14627 18.0004 5.93538 18.0908 5.69436 18.0908C5.45333 18.0908 5.24243 18.0004 5.06166 17.8197L3.01744 15.7754C2.87899 15.637 2.81136 15.4629 2.81456 15.2533C2.81776 15.0437 2.88859 14.8697 3.02706 14.7312C3.16551 14.5928 3.34008 14.5235 3.55076 14.5235C3.76144 14.5235 3.93494 14.5928 4.07126 14.7312L5.66936 16.3389ZM5.66936 8.72359L9.39244 5.00049C9.54115 4.85177 9.71679 4.77838 9.91936 4.78031C10.1219 4.78223 10.2975 4.86075 10.4463 5.01586C10.5847 5.16691 10.654 5.34314 10.654 5.54454C10.654 5.74592 10.5847 5.92097 10.4463 6.06969L6.32704 10.2043C6.14627 10.3851 5.93538 10.4755 5.69436 10.4755C5.45333 10.4755 5.24243 10.3851 5.06166 10.2043L3.01744 8.16009C2.87899 8.02162 2.81136 7.84759 2.81456 7.63799C2.81776 7.42837 2.88859 7.25433 3.02706 7.11586C3.16551 6.97741 3.34008 6.90819 3.55076 6.90819C3.76144 6.90819 3.93494 6.97741 4.07126 7.11586L5.66936 8.72359ZM13.7597 16.5581C13.5472 16.5581 13.3691 16.4862 13.2253 16.3424C13.0816 16.1986 13.0097 16.0204 13.0097 15.8078C13.0097 15.5952 13.0816 15.4171 13.2253 15.2735C13.3691 15.13 13.5472 15.0582 13.7597 15.0582H20.7597C20.9722 15.0582 21.1503 15.1301 21.2941 15.2739C21.4378 15.4177 21.5097 15.5959 21.5097 15.8085C21.5097 16.0211 21.4378 16.1992 21.2941 16.3427C21.1503 16.4863 20.9722 16.5581 20.7597 16.5581H13.7597ZM13.7597 8.94276C13.5472 8.94276 13.3691 8.87085 13.2253 8.72704C13.0816 8.58324 13.0097 8.40504 13.0097 8.19244C13.0097 7.97985 13.0816 7.80177 13.2253 7.65819C13.3691 7.5146 13.5472 7.44281 13.7597 7.44281H20.7597C20.9722 7.44281 21.1503 7.51471 21.2941 7.65851C21.4378 7.80233 21.5097 7.98053 21.5097 8.19311C21.5097 8.40571 21.4378 8.5838 21.2941 8.72739C21.1503 8.87097 20.9722 8.94276 20.7597 8.94276H13.7597Z"\n    />\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),listItem=preset_commonmark_lib.hm.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Qb.key,{nodeType:listItem,attrs:{checked:!1}})}})}if(null!==(null==config?void 0:config.advancedGroup)){const advancedGroup=groupBuilder.addGroup("advanced",null!=(_Ja=null==(_Ia=null==config?void 0:config.advancedGroup)?void 0:_Ia.label)?_Ja:"Advanced");null!==(null==(_Ka=null==config?void 0:config.advancedGroup)?void 0:_Ka.image)&&isImageBlockEnabled&&advancedGroup.addItem("image",{label:null!=(_Na=null==(_Ma=null==(_La=null==config?void 0:config.advancedGroup)?void 0:_La.image)?void 0:_Ma.label)?_Na:"Image",icon:null!=(_Qa=null==(_Pa=null==(_Oa=null==config?void 0:config.advancedGroup)?void 0:_Oa.image)?void 0:_Pa.icon)?_Qa:imageIcon,onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),imageBlock=imageBlockSchema.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.w4.key,{nodeType:imageBlock})}}),null!==(null==(_Ra=null==config?void 0:config.advancedGroup)?void 0:_Ra.codeBlock)&&advancedGroup.addItem("code",{label:null!=(_Ua=null==(_Ta=null==(_Sa=null==config?void 0:config.advancedGroup)?void 0:_Sa.codeBlock)?void 0:_Ta.label)?_Ua:"Code",icon:null!=(_Xa=null==(_Wa=null==(_Va=null==config?void 0:config.advancedGroup)?void 0:_Va.codeBlock)?void 0:_Wa.icon)?_Xa:codeIcon,onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),codeBlock=preset_commonmark_lib.Ay.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.Pv.key,{nodeType:codeBlock})}}),null!==(null==(_Ya=null==config?void 0:config.advancedGroup)?void 0:_Ya.table)&&isTableEnabled&&advancedGroup.addItem("table",{label:null!=(_$a=null==(__a=null==(_Za=null==config?void 0:config.advancedGroup)?void 0:_Za.table)?void 0:__a.label)?_$a:"Table",icon:null!=(_cb=null==(_bb=null==(_ab=null==config?void 0:config.advancedGroup)?void 0:_ab.table)?void 0:_bb.icon)?_cb:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8078)">\n      <path\n        d="M20 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H20C21.1 21 22 20.1 22 19V5C22 3.9 21.1 3 20 3ZM20 5V8H5V5H20ZM15 19H10V10H15V19ZM5 10H8V19H5V10ZM17 19V10H20V19H17Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8078">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),view=ctx2.get(core_lib.kY);commands.call(preset_commonmark_lib.nx.key);const{from}=view.state.selection;commands.call(preset_commonmark_lib.w4.key,{nodeType:createTable(ctx2,3,3)}),commands.call(preset_commonmark_lib.fI.key,{pos:from})}}),null!==(null==(_db=null==config?void 0:config.advancedGroup)?void 0:_db.math)&&isLatexEnabled&&advancedGroup.addItem("math",{label:null!=(_gb=null==(_fb=null==(_eb=null==config?void 0:config.advancedGroup)?void 0:_eb.math)?void 0:_fb.label)?_gb:"Math",icon:null!=(_jb=null==(_ib=null==(_hb=null==config?void 0:config.advancedGroup)?void 0:_hb.math)?void 0:_ib.icon)?_jb:functionsIcon,onRun:ctx2=>{const commands=ctx2.get(core_lib.MD),codeBlock=preset_commonmark_lib.Ay.type(ctx2);commands.call(preset_commonmark_lib.nx.key),commands.call(preset_commonmark_lib.w4.key,{nodeType:codeBlock,attrs:{language:"LaTex"}})}})}null==(_kb=null==config?void 0:config.buildMenu)||_kb.call(config,groupBuilder);let groups=groupBuilder.build();filter&&(groups=groups.map(group=>{const items2=group.items.filter(item=>item.label.toLowerCase().includes(filter.toLowerCase()));return{...group,items:items2}}).filter(group=>group.items.length>0));const items=groups.flatMap(groups2=>groups2.items);return items.forEach((item,index)=>{Object.assign(item,{index})}),groups.reduce((acc,group)=>{const end=acc+group.items.length;return Object.assign(group,{range:[acc,end]}),end},0),{groups,size:items.length}}(filter.value,config,ctx)),hoverIndex=(0,reactivity_esm_bundler.KR)(0),prevMousePosition=(0,reactivity_esm_bundler.KR)({x:-999,y:-999}),onPointerMove=e=>{const{x,y}=e;prevMousePosition.value={x,y}};(0,runtime_core_esm_bundler.wB)([groupInfo,show],()=>{const{size}=groupInfo.value;0===size&&show.value?hide():hoverIndex.value>=size&&(hoverIndex.value=0)});const onHover=(index,after)=>{const prevHoverIndex=hoverIndex.value,next="function"==typeof index?index(prevHoverIndex):index;null==after||after(next),hoverIndex.value=next},scrollToIndex=index=>{var _a,_b;const target=null==(_a=host.value)?void 0:_a.querySelector(`[data-index="${index}"]`),scrollRoot=null==(_b=host.value)?void 0:_b.querySelector(".menu-groups");target&&scrollRoot&&(scrollRoot.scrollTop=target.offsetTop-scrollRoot.offsetTop)},runByIndex=index=>{const item=groupInfo.value.groups.flatMap(group=>group.items).at(index);item&&ctx&&item.onRun(ctx),hide()},onKeydown=e=>{const{size,groups}=groupInfo.value;return"Escape"===e.key?(e.preventDefault(),void(null==hide||hide())):"ArrowDown"===e.key?(e.preventDefault(),onHover(index=>index<size-1?index+1:index,scrollToIndex)):"ArrowUp"===e.key?(e.preventDefault(),onHover(index=>index<=0?index:index-1,scrollToIndex)):"ArrowLeft"===e.key?(e.preventDefault(),onHover(index=>{const group=groups.find(group2=>group2.range[0]<=index&&group2.range[1]>index);if(!group)return index;const prevGroup=groups[groups.indexOf(group)-1];return prevGroup?prevGroup.range[1]-1:index},scrollToIndex)):"ArrowRight"===e.key?(e.preventDefault(),onHover(index=>{const group=groups.find(group2=>group2.range[0]<=index&&group2.range[1]>index);if(!group)return index;const nextGroup=groups[groups.indexOf(group)+1];return nextGroup?nextGroup.range[0]:index},scrollToIndex)):void("Enter"===e.key&&(e.preventDefault(),runByIndex(hoverIndex.value)))};return(0,runtime_core_esm_bundler.nT)(()=>{show.value?window.addEventListener("keydown",onKeydown,{capture:!0}):window.removeEventListener("keydown",onKeydown,{capture:!0})}),(0,runtime_core_esm_bundler.hi)(()=>{window.removeEventListener("keydown",onKeydown,{capture:!0})}),()=>(0,runtime_core_esm_bundler.h)("div",{ref:host,onPointerdown:e=>e.preventDefault()},(0,runtime_core_esm_bundler.h)("nav",{class:"tab-group"},(0,runtime_core_esm_bundler.h)("ul",null,groupInfo.value.groups.map(group=>(0,runtime_core_esm_bundler.h)("li",{key:group.key,onPointerdown:()=>onHover(group.range[0],scrollToIndex),class:hoverIndex.value>=group.range[0]&&hoverIndex.value<group.range[1]?"selected":""},group.label)))),(0,runtime_core_esm_bundler.h)("div",{class:"menu-groups",onPointermove:onPointerMove},groupInfo.value.groups.map(group=>(0,runtime_core_esm_bundler.h)("div",{key:group.key,class:"menu-group"},(0,runtime_core_esm_bundler.h)("h6",null,group.label),(0,runtime_core_esm_bundler.h)("ul",null,group.items.map(item=>{return(0,runtime_core_esm_bundler.h)("li",{key:item.key,"data-index":item.index,class:hoverIndex.value===item.index?"hover":"",onPointerenter:(index=item.index,e=>{const prevPos=prevMousePosition.value;if(!prevPos)return;const{x,y}=e;x===prevPos.x&&y===prevPos.y||onHover(index)}),onPointerdown:()=>{var _a,_b;null==(_b=null==(_a=host.value)?void 0:_a.querySelector(`[data-index="${item.index}"]`))||_b.classList.add("active")},onPointerup:()=>{var _a,_b;null==(_b=null==(_a=host.value)?void 0:_a.querySelector(`[data-index="${item.index}"]`))||_b.classList.remove("active"),runByIndex(item.index)}},(0,runtime_core_esm_bundler.h)(Icon,{icon:item.icon}),(0,runtime_core_esm_bundler.h)("span",null,item.label));var index}))))))}});var _content$3,_app$3,_filter,_slashProvider,_programmaticallyPos,__typeError$4=msg=>{throw TypeError(msg)},__accessCheck$4=(obj,member,msg)=>member.has(obj)||__typeError$4("Cannot "+msg),__privateGet$4=(obj,member,getter)=>(__accessCheck$4(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd$4=(obj,member,value)=>member.has(obj)?__typeError$4("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),__privateSet$4=(obj,member,value,setter)=>(__accessCheck$4(obj,member,"write to private field"),member.set(obj,value),value);const menu=function slashFactory(id){const slashSpec=(0,utils_lib.Qx)({},`${id}_SLASH_SPEC`),slashPlugin=(0,utils_lib.Gf)(ctx=>{const spec=ctx.get(slashSpec.key);return new prosemirror_state_dist.k_({key:new prosemirror_state_dist.hs(`${id}_SLASH`),...spec})}),result=[slashSpec,slashPlugin];return result.key=slashSpec.key,result.pluginKey=slashPlugin.key,slashSpec.meta={package:"@milkdown/plugin-slash",displayName:`Ctx<slashSpec>|${id}`},slashPlugin.meta={package:"@milkdown/plugin-slash",displayName:`Prose<slash>|${id}`},result}("CREPE_MENU"),menuAPI=(0,utils_lib.Qx)({show:()=>{},hide:()=>{}},"menuAPICtx");class MenuView{constructor(ctx,view,config){__privateAdd$4(this,_content$3),__privateAdd$4(this,_app$3),__privateAdd$4(this,_filter),__privateAdd$4(this,_slashProvider),__privateAdd$4(this,_programmaticallyPos,null),this.update=view=>{__privateGet$4(this,_slashProvider).update(view)},this.show=pos=>{__privateSet$4(this,_programmaticallyPos,pos),__privateGet$4(this,_filter).value="",__privateGet$4(this,_slashProvider).show()},this.hide=()=>{__privateSet$4(this,_programmaticallyPos,null),__privateGet$4(this,_slashProvider).hide()},this.destroy=()=>{__privateGet$4(this,_slashProvider).destroy(),__privateGet$4(this,_app$3).unmount(),__privateGet$4(this,_content$3).remove()};const content=document.createElement("div");content.classList.add("milkdown-slash-menu");const show=(0,reactivity_esm_bundler.KR)(!1),filter=(0,reactivity_esm_bundler.KR)("");__privateSet$4(this,_filter,filter);const hide=this.hide,app=(0,runtime_dom_esm_bundler.Ef)(Menu,{ctx,config,show,filter,hide});__privateSet$4(this,_app$3,app),app.mount(content),__privateSet$4(this,_content$3,content);const self=this;__privateSet$4(this,_slashProvider,new SlashProvider({content:__privateGet$4(this,_content$3),debounce:20,shouldShow(view2){if(isInCodeBlock(view2.state.selection)||isInList(view2.state.selection))return!1;const currentText=this.getContent(view2,node=>["paragraph","heading"].includes(node.type.name));if(null==currentText)return!1;if(!function isSelectionAtEndOfNode(selection){if(!(selection instanceof prosemirror_state_dist.U3))return!1;const{$head}=selection,parent=$head.parent;return $head.parentOffset===parent.content.size}(view2.state.selection))return!1;const pos=__privateGet$4(self,_programmaticallyPos);if(filter.value=currentText.startsWith("/")?currentText.slice(1):currentText,"number"==typeof pos){const maxSize=view2.state.doc.nodeSize-2,validPos=Math.min(pos,maxSize);return view2.state.doc.resolve(validPos).node()===view2.state.doc.resolve(view2.state.selection.from).node()||(__privateSet$4(self,_programmaticallyPos,null),!1)}return!!currentText.startsWith("/")},offset:10})),__privateGet$4(this,_slashProvider).onShow=()=>{show.value=!0},__privateGet$4(this,_slashProvider).onHide=()=>{show.value=!1},this.update(view),ctx.set(menuAPI.key,{show:pos=>this.show(pos),hide:()=>this.hide()})}}_content$3=new WeakMap,_app$3=new WeakMap,_filter=new WeakMap,_slashProvider=new WeakMap,_programmaticallyPos=new WeakMap;const BlockHandle=(0,runtime_core_esm_bundler.pM)({props:{onAdd:{type:Function,required:!0},addIcon:{type:String,required:!0},handleIcon:{type:String,required:!0}},setup(props){const addButton=(0,reactivity_esm_bundler.KR)();return()=>(0,runtime_core_esm_bundler.h)(runtime_core_esm_bundler.FK,null,(0,runtime_core_esm_bundler.h)("div",{ref:addButton,class:"operation-item",onPointerdown:e=>{var _a;e.preventDefault(),e.stopPropagation(),null==(_a=addButton.value)||_a.classList.add("active")},onPointerup:e=>{var _a;e.preventDefault(),e.stopPropagation(),null==(_a=addButton.value)||_a.classList.remove("active"),props.onAdd()}},(0,runtime_core_esm_bundler.h)(Icon,{icon:props.addIcon})),(0,runtime_core_esm_bundler.h)("div",{class:"operation-item"},(0,runtime_core_esm_bundler.h)(Icon,{icon:props.handleIcon})))}});var _content$2,esm_provider$1,_app$2,_ctx,__typeError$3=msg=>{throw TypeError(msg)},__accessCheck$3=(obj,member,msg)=>member.has(obj)||__typeError$3("Cannot "+msg),__privateGet$3=(obj,member,getter)=>(__accessCheck$3(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd$3=(obj,member,value)=>member.has(obj)?__typeError$3("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),__privateSet$3=(obj,member,value,setter)=>(__accessCheck$3(obj,member,"write to private field"),member.set(obj,value),value);class BlockHandleView{constructor(ctx,config){var _a,_b,_c;__privateAdd$3(this,_content$2),__privateAdd$3(this,esm_provider$1),__privateAdd$3(this,_app$2),__privateAdd$3(this,_ctx),this.update=()=>{__privateGet$3(this,esm_provider$1).update()},this.destroy=()=>{__privateGet$3(this,esm_provider$1).destroy(),__privateGet$3(this,_content$2).remove(),__privateGet$3(this,_app$2).unmount()},this.onAdd=()=>{const ctx=__privateGet$3(this,_ctx),view=ctx.get(core_lib.kY);view.hasFocus()||view.focus();const{state,dispatch}=view,active=__privateGet$3(this,esm_provider$1).active;if(!active)return;const pos=active.$pos.pos+active.node.nodeSize;let tr=state.tr.insert(pos,preset_commonmark_lib.Wf.type(ctx).create());tr=tr.setSelection(prosemirror_state_dist.U3.near(tr.doc.resolve(pos))),dispatch(tr.scrollIntoView()),__privateGet$3(this,esm_provider$1).hide(),ctx.get(menuAPI.key).show(tr.selection.from)},__privateSet$3(this,_ctx,ctx);const content=document.createElement("div");content.classList.add("milkdown-block-handle");const app=(0,runtime_dom_esm_bundler.Ef)(BlockHandle,{onAdd:this.onAdd,addIcon:null!=(_a=null==config?void 0:config.handleAddIcon)?_a:plusIcon,handleIcon:null!=(_b=null==config?void 0:config.handleDragIcon)?_b:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_971_7680)">\n      <path\n        d="M11 18C11 19.1 10.1 20 9 20C7.9 20 7 19.1 7 18C7 16.9 7.9 16 9 16C10.1 16 11 16.9 11 18ZM9 10C7.9 10 7 10.9 7 12C7 13.1 7.9 14 9 14C10.1 14 11 13.1 11 12C11 10.9 10.1 10 9 10ZM9 4C7.9 4 7 4.9 7 6C7 7.1 7.9 8 9 8C10.1 8 11 7.1 11 6C11 4.9 10.1 4 9 4ZM15 8C16.1 8 17 7.1 17 6C17 4.9 16.1 4 15 4C13.9 4 13 4.9 13 6C13 7.1 13.9 8 15 8ZM15 10C13.9 10 13 10.9 13 12C13 13.1 13.9 14 15 14C16.1 14 17 13.1 17 12C17 10.9 16.1 10 15 10ZM15 16C13.9 16 13 16.9 13 18C13 19.1 13.9 20 15 20C16.1 20 17 19.1 17 18C17 16.9 16.1 16 15 16Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_971_7680">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n'});app.mount(content),__privateSet$3(this,_app$2,app),__privateSet$3(this,_content$2,content);const blockProviderOptions=null!=(_c=null==config?void 0:config.blockHandle)?_c:{};__privateSet$3(this,esm_provider$1,new BlockProvider({ctx,content,getOffset:()=>16,getPlacement:({active,blockDom})=>{if("heading"===active.node.type.name)return"left";let totalDescendant=0;active.node.descendants(node=>{totalDescendant+=node.childCount});const dom=active.el,domRect=dom.getBoundingClientRect(),handleRect=blockDom.getBoundingClientRect(),style=window.getComputedStyle(dom),paddingTop=Number.parseInt(style.paddingTop,10)||0,paddingBottom=Number.parseInt(style.paddingBottom,10)||0,height=domRect.height-paddingTop-paddingBottom,handleHeight=handleRect.height;return totalDescendant>2||handleHeight<height?"left-start":"left"},...blockProviderOptions})),this.update()}}_content$2=new WeakMap,esm_provider$1=new WeakMap,_app$2=new WeakMap,_ctx=new WeakMap;const blockEdit=(editor,config)=>{editor.config(crepeFeatureConfig(CrepeFeature.BlockEdit)).config(ctx=>function configureBlockHandle(ctx,config){ctx.set(blockConfig.key,{filterNodes:pos=>!(0,lib.gi)(node=>["table","blockquote","math_inline"].includes(node.type.name))(pos)}),ctx.set(block.key,{view:()=>new BlockHandleView(ctx,config)})}(ctx,config)).config(ctx=>function configureMenu(ctx,config){ctx.set(menu.key,{view:view=>new MenuView(ctx,view,config)})}(ctx,config)).use(menuAPI).use(block).use(menu)},blockLatexSchema=preset_commonmark_lib.Ay.extendSchema(prev=>ctx=>{const baseSchema=prev(ctx);return{...baseSchema,toMarkdown:{match:baseSchema.toMarkdown.match,runner:(state,node)=>{var _a,_b;if("latex"!==(null!=(_a=node.attrs.language)?_a:"").toLowerCase())return baseSchema.toMarkdown.runner(state,node);state.addNode("math",void 0,(null==(_b=node.content.firstChild)?void 0:_b.text)||"")}}}}),mathInlineSchema=(0,utils_lib.Yh)("math_inline",()=>({group:"inline",inline:!0,draggable:!0,atom:!0,attrs:{value:{default:""}},parseDOM:[{tag:'span[data-type="math_inline"]',getAttrs:dom=>{var _a;return{value:null!=(_a=dom.dataset.value)?_a:""}}}],toDOM:node=>{const code=node.attrs.value,dom=document.createElement("span");return dom.dataset.type="math_inline",dom.dataset.value=code,katex.default.render(code,dom,{throwOnError:!1}),dom},parseMarkdown:{match:node=>"inlineMath"===node.type,runner:(state,node,type)=>{state.addNode(type,{value:node.value})}},toMarkdown:{match:node=>"math_inline"===node.type.name,runner:(state,node)=>{state.addNode("inlineMath",void 0,node.attrs.value)}}})),toggleLatexCommand=(0,utils_lib.yu)("ToggleLatex",ctx=>()=>(state,dispatch)=>{const{hasNode:hasLatex,pos:latexPos,target:latexNode}=(0,lib.RK)(state,mathInlineSchema.type(ctx)),{selection,doc,tr}=state;if(!hasLatex){const text=doc.textBetween(selection.from,selection.to);let _tr2=tr.replaceSelectionWith(mathInlineSchema.type(ctx).create({value:text}));return dispatch&&dispatch(_tr2.setSelection(prosemirror_state_dist.nh.create(_tr2.doc,selection.from))),!0}const{from,to}=selection;if(!latexNode||latexPos<0)return!1;let _tr=tr.delete(latexPos,latexPos+1);const content=latexNode.attrs.value;return _tr=_tr.insertText(content,latexPos),dispatch&&dispatch(_tr.setSelection(prosemirror_state_dist.U3.create(_tr.doc,from,to+content.length-1))),!0}),inlineLatexTooltip=tooltipFactory("INLINE_LATEX"),LatexTooltip=(0,runtime_core_esm_bundler.pM)({props:{config:{type:Object,required:!0},innerView:{type:Object,required:!0},updateValue:{type:Object,required:!0}},setup(props){const innerViewRef=el=>{if(el&&el instanceof HTMLElement){for(;el.firstChild;)el.removeChild(el.firstChild);props.innerView.value&&el.appendChild(props.innerView.value.dom)}},onUpdate=e=>{e.preventDefault(),props.updateValue.value()};return()=>(0,runtime_core_esm_bundler.h)("div",{class:"container"},props.innerView&&(0,runtime_core_esm_bundler.h)("div",{ref:innerViewRef}),(0,runtime_core_esm_bundler.h)("button",{onPointerdown:onUpdate},(0,runtime_core_esm_bundler.h)(Icon,{icon:props.config.inlineEditConfirm})))}});var esm_content$1,esm_provider,_dom,_innerView,_updateValue,esm_app$1,_onHide,_shouldShow,__typeError$2=msg=>{throw TypeError(msg)},__accessCheck$2=(obj,member,msg)=>member.has(obj)||__typeError$2("Cannot "+msg),__privateGet$2=(obj,member,getter)=>(__accessCheck$2(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd$2=(obj,member,value)=>member.has(obj)?__typeError$2("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),__privateSet$2=(obj,member,value,setter)=>(__accessCheck$2(obj,member,"write to private field"),member.set(obj,value),value);class LatexInlineTooltip{constructor(ctx,view,config){this.ctx=ctx,__privateAdd$2(this,esm_content$1),__privateAdd$2(this,esm_provider),__privateAdd$2(this,_dom),__privateAdd$2(this,_innerView,(0,reactivity_esm_bundler.IJ)(null)),__privateAdd$2(this,_updateValue,(0,reactivity_esm_bundler.IJ)(()=>{})),__privateAdd$2(this,esm_app$1),__privateAdd$2(this,_onHide,()=>{__privateGet$2(this,_innerView).value&&(__privateGet$2(this,_innerView).value.destroy(),__privateGet$2(this,_innerView).value=null)}),__privateAdd$2(this,_shouldShow,view=>{const show=(()=>{const{selection,schema}=view.state;if(selection.empty)return!1;if(!(selection instanceof prosemirror_state_dist.nh))return!1;const node=selection.node;if("math_inline"!==node.type.name)return!1;const textFrom=selection.from,paragraph=schema.nodes.paragraph.create(null,schema.text(node.attrs.value)),innerView=new prosemirror_view_dist.Lz(__privateGet$2(this,_dom),{state:prosemirror_state_dist.$t.create({doc:paragraph,schema:new prosemirror_model_dist.Sj({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",0]},text:{group:"inline"}}}),plugins:[(0,prosemirror_keymap_dist.w)({"Mod-z":prosemirror_history_dist.tN,"Mod-Z":prosemirror_history_dist.ZS,"Mod-y":prosemirror_history_dist.ZS,Enter:()=>(__privateGet$2(this,_updateValue).value(),!0)})]})});return __privateGet$2(this,_innerView).value=innerView,__privateGet$2(this,_updateValue).value=()=>{const{tr}=view.state;tr.setNodeAttribute(textFrom,"value",innerView.state.doc.textContent),view.dispatch(tr),requestAnimationFrame(()=>{view.focus()})},!0})();return show||__privateGet$2(this,_onHide).call(this),show}),this.update=(view,prevState)=>{__privateGet$2(this,esm_provider).update(view,prevState)},this.destroy=()=>{__privateGet$2(this,esm_app$1).unmount(),__privateGet$2(this,esm_provider).destroy(),__privateGet$2(this,esm_content$1).remove()};const content=document.createElement("div");content.className="milkdown-latex-inline-edit",__privateSet$2(this,esm_content$1,content),__privateSet$2(this,esm_app$1,(0,runtime_dom_esm_bundler.Ef)(LatexTooltip,{config,innerView:__privateGet$2(this,_innerView),updateValue:__privateGet$2(this,_updateValue)})),__privateGet$2(this,esm_app$1).mount(content),__privateSet$2(this,esm_provider,new TooltipProvider({debounce:0,content:__privateGet$2(this,esm_content$1),shouldShow:__privateGet$2(this,_shouldShow),offset:10,floatingUIOptions:{placement:"bottom"}})),__privateGet$2(this,esm_provider).update(view),__privateSet$2(this,_dom,document.createElement("div"))}}esm_content$1=new WeakMap,esm_provider=new WeakMap,_dom=new WeakMap,_innerView=new WeakMap,_updateValue=new WeakMap,esm_app$1=new WeakMap,_onHide=new WeakMap,_shouldShow=new WeakMap;const mathInlineInputRule=(0,utils_lib.b_)(ctx=>(0,lib.Bz)(/(?:\$)([^$]+)(?:\$)$/,mathInlineSchema.type(ctx),{getAttr:match=>{var _a;return{value:null!=(_a=match[1])?_a:""}}})),mathBlockInputRule=(0,utils_lib.b_)(ctx=>(0,prosemirror_inputrules_dist.JJ)(/^\$\$[\s\n]$/,preset_commonmark_lib.Ay.type(ctx),()=>({language:"LaTeX"}))),remarkMathPlugin=(0,utils_lib.lz)("remarkMath",()=>remark_math_lib.A);function visitMathBlock(ast){return(0,unist_util_visit_lib.YR)(ast,"math",(node,index,parent)=>{const{value}=node,newNode={type:"code",lang:"LaTeX",value};parent.children.splice(index,1,newNode)})}const remarkMathBlockPlugin=(0,utils_lib.lz)("remarkMathBlock",()=>()=>visitMathBlock),latex=(editor,config)=>{editor.config(crepeFeatureConfig(CrepeFeature.Latex)).config(ctx=>{if(!useCrepeFeatures(ctx).get().includes(CrepeFeature.CodeMirror))throw new Error("You need to enable CodeMirror to use LaTeX feature");ctx.update(code_block.T4.key,prev=>({...prev,renderPreview:(language,content)=>{if("latex"===language.toLowerCase()&&content.length>0)return function renderLatex(content,options){const html=katex.default.renderToString(content,{...options,throwOnError:!1,displayMode:!0});return html}(content,null==config?void 0:config.katexOptions);return(0,prev.renderPreview)(language,content)}})),ctx.set(inlineLatexTooltip.key,{view:view=>{var _a;return new LatexInlineTooltip(ctx,view,{inlineEditConfirm:null!=(_a=null==config?void 0:config.inlineEditConfirm)?_a:confirmIcon,...config})}})}).use(remarkMathPlugin).use(remarkMathBlockPlugin).use(mathInlineSchema).use(inlineLatexTooltip).use(mathInlineInputRule).use(mathBlockInputRule).use(blockLatexSchema).use(toggleLatexCommand)};const listItem=(editor,config)=>{editor.config(crepeFeatureConfig(CrepeFeature.ListItem)).config(ctx=>function configureListItem(ctx,config){ctx.set(listItemBlockConfig.key,{renderLabel:({label,listType,checked})=>{var _a,_b,_c;return null==checked?"bullet"===listType?null!=(_a=null==config?void 0:config.bulletIcon)?_a:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_952_6527)">\n      <circle cx="12" cy="12" r="3" />\n    </g>\n    <defs>\n      <clipPath id="clip0_952_6527">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n':label:checked?null!=(_b=null==config?void 0:config.checkBoxCheckedIcon)?_b:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_1803_1151)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM10.71 16.29C10.32 16.68 9.69 16.68 9.3 16.29L5.71 12.7C5.32 12.31 5.32 11.68 5.71 11.29C6.1 10.9 6.73 10.9 7.12 11.29L10 14.17L16.88 7.29C17.27 6.9 17.9 6.9 18.29 7.29C18.68 7.68 18.68 8.31 18.29 8.7L10.71 16.29Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_1803_1151">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n':null!=(_c=null==config?void 0:config.checkBoxUncheckedIcon)?_c:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_1803_535)">\n      <path\n        d="M18 19H6C5.45 19 5 18.55 5 18V6C5 5.45 5.45 5 6 5H18C18.55 5 19 5.45 19 6V18C19 18.55 18.55 19 18 19ZM19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_1803_535">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n'}})}(ctx,config)).use(listItemBlockComponent)};const placeholderConfig=(0,utils_lib.Qx)({text:"Please enter...",mode:"block"},"placeholderConfigCtx"),placeholderPlugin=(0,utils_lib.Gf)(ctx=>new prosemirror_state_dist.k_({key:new prosemirror_state_dist.hs("CREPE_PLACEHOLDER"),props:{decorations:state=>{var _a;const crepe=function useCrepe(ctx){return ctx.get("CrepeCtx")}(ctx);if(crepe.readonly)return null;const config=ctx.get(placeholderConfig.key);if("doc"===config.mode&&!function isDocEmpty(doc){var _a;return doc.childCount<=1&&!(null==(_a=doc.firstChild)?void 0:_a.content.size)}(state.doc))return null;if(isInCodeBlock(state.selection)||isInList(state.selection))return null;const deco=function createPlaceholderDecoration(state,placeholderText){const{selection}=state;if(!selection.empty)return null;const $pos=selection.$anchor,node=$pos.parent;if(node.content.size>0)return null;if((0,lib.gi)(node2=>"table"===node2.type.name)($pos))return null;const before=$pos.before();return prosemirror_view_dist.NZ.node(before,before+node.nodeSize,{class:"crepe-placeholder","data-placeholder":placeholderText})}(state,null!=(_a=config.text)?_a:"Please enter...");return deco?prosemirror_view_dist.zF.create(state.doc,[deco]):null}}}));const Toolbar=(0,runtime_core_esm_bundler.pM)({props:{ctx:{type:Object,required:!0},hide:{type:Function,required:!0},show:{type:Object,required:!0},selection:{type:Object,required:!0},config:{type:Object,required:!1}},setup(props){const{ctx,config}=props;function checkActive(checker){props.selection.value;return ctx.get(core_lib.Fq).status===core_lib.qv.Created&&checker(ctx)}const groupInfo=(0,runtime_core_esm_bundler.EW)(()=>function getGroups(config,ctx){var _a,_b,_c,_d,_e,_f,_g;const groupBuilder=new GroupBuilder;groupBuilder.addGroup("formatting","Formatting").addItem("bold",{icon:null!=(_a=null==config?void 0:config.boldIcon)?_a:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M8.85758 18.625C8.4358 18.625 8.07715 18.4772 7.78163 18.1817C7.48613 17.8862 7.33838 17.5275 7.33838 17.1058V6.8942C7.33838 6.47242 7.48613 6.11377 7.78163 5.81825C8.07715 5.52275 8.4358 5.375 8.85758 5.375H12.1999C13.2191 5.375 14.1406 5.69231 14.9643 6.32693C15.788 6.96154 16.1999 7.81603 16.1999 8.89038C16.1999 9.63779 16.0194 10.2471 15.6585 10.7183C15.2976 11.1894 14.9088 11.5314 14.4922 11.7442C15.005 11.9211 15.4947 12.2708 15.9614 12.7933C16.428 13.3157 16.6614 14.0192 16.6614 14.9038C16.6614 16.182 16.1902 17.1217 15.2479 17.723C14.3056 18.3243 13.3563 18.625 12.3999 18.625H8.85758ZM9.4883 16.6327H12.3191C13.1063 16.6327 13.6627 16.4141 13.9884 15.9769C14.314 15.5397 14.4768 15.1205 14.4768 14.7192C14.4768 14.3179 14.314 13.8987 13.9884 13.4615C13.6627 13.0243 13.0909 12.8057 12.273 12.8057H9.4883V16.6327ZM9.4883 10.875H12.0826C12.6903 10.875 13.172 10.7013 13.5278 10.3539C13.8836 10.0064 14.0615 9.59037 14.0615 9.10575C14.0615 8.59035 13.8733 8.16918 13.497 7.84225C13.1207 7.51533 12.6595 7.35188 12.1133 7.35188H9.4883V10.875Z"\n    />\n  </svg>\n',active:ctx2=>ctx2.get(core_lib.MD).call(preset_commonmark_lib.Kf.key,preset_commonmark_lib.t6.type(ctx2)),onRun:ctx2=>{ctx2.get(core_lib.MD).call(preset_commonmark_lib.vY.key)}}).addItem("italic",{icon:null!=(_b=null==config?void 0:config.italicIcon)?_b:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M6.29811 18.625C6.04505 18.625 5.83115 18.5375 5.65641 18.3626C5.48166 18.1877 5.39429 17.9736 5.39429 17.7203C5.39429 17.467 5.48166 17.2532 5.65641 17.0788C5.83115 16.9045 6.04505 16.8173 6.29811 16.8173H9.21159L12.452 7.18265H9.53851C9.28545 7.18265 9.07155 7.0952 8.89681 6.9203C8.72206 6.7454 8.63469 6.5313 8.63469 6.278C8.63469 6.02472 8.72206 5.81089 8.89681 5.63652C9.07155 5.46217 9.28545 5.375 9.53851 5.375H16.8847C17.1377 5.375 17.3516 5.46245 17.5264 5.63735C17.7011 5.81225 17.7885 6.02634 17.7885 6.27962C17.7885 6.53293 17.7011 6.74676 17.5264 6.92113C17.3516 7.09548 17.1377 7.18265 16.8847 7.18265H14.2789L11.0385 16.8173H13.6443C13.8973 16.8173 14.1112 16.9048 14.286 17.0797C14.4607 17.2546 14.5481 17.4687 14.5481 17.722C14.5481 17.9752 14.4607 18.1891 14.286 18.3634C14.1112 18.5378 13.8973 18.625 13.6443 18.625H6.29811Z"\n    />\n  </svg>\n',active:ctx2=>ctx2.get(core_lib.MD).call(preset_commonmark_lib.Kf.key,preset_commonmark_lib.Wm.type(ctx2)),onRun:ctx2=>{ctx2.get(core_lib.MD).call(preset_commonmark_lib.e0.key)}}).addItem("strikethrough",{icon:null!=(_c=null==config?void 0:config.strikethroughIcon)?_c:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M3.25 13.7404C3.0375 13.7404 2.85938 13.6684 2.71563 13.5246C2.57188 13.3808 2.5 13.2026 2.5 12.99C2.5 12.7774 2.57188 12.5993 2.71563 12.4558C2.85938 12.3122 3.0375 12.2404 3.25 12.2404H20.75C20.9625 12.2404 21.1406 12.3123 21.2843 12.4561C21.4281 12.5999 21.5 12.7781 21.5 12.9907C21.5 13.2033 21.4281 13.3814 21.2843 13.525C21.1406 13.6686 20.9625 13.7404 20.75 13.7404H3.25ZM10.9423 10.2596V6.62495H6.5673C6.2735 6.62495 6.02377 6.52201 5.8181 6.31613C5.61245 6.11026 5.50963 5.86027 5.50963 5.56615C5.50963 5.27205 5.61245 5.02083 5.8181 4.8125C6.02377 4.60417 6.2735 4.5 6.5673 4.5H17.4423C17.7361 4.5 17.9858 4.60294 18.1915 4.80883C18.3971 5.01471 18.5 5.2647 18.5 5.5588C18.5 5.85292 18.3971 6.10413 18.1915 6.31245C17.9858 6.52078 17.7361 6.62495 17.4423 6.62495H13.0673V10.2596H10.9423ZM10.9423 15.7211H13.0673V18.4423C13.0673 18.7361 12.9643 18.9858 12.7584 19.1915C12.5526 19.3971 12.3026 19.5 12.0085 19.5C11.7144 19.5 11.4631 19.3962 11.2548 19.1887C11.0465 18.9811 10.9423 18.7291 10.9423 18.4327V15.7211Z"\n    />\n  </svg>\n',active:ctx2=>ctx2.get(core_lib.MD).call(preset_commonmark_lib.Kf.key,strikethroughSchema.type(ctx2)),onRun:ctx2=>{ctx2.get(core_lib.MD).call(toggleStrikethroughCommand.key)}});const functionGroup=groupBuilder.addGroup("function","Function");functionGroup.addItem("code",{icon:null!=(_d=null==config?void 0:config.codeIcon)?_d:codeIcon,active:ctx2=>ctx2.get(core_lib.MD).call(preset_commonmark_lib.Kf.key,preset_commonmark_lib.Of.type(ctx2)),onRun:ctx2=>{ctx2.get(core_lib.MD).call(preset_commonmark_lib.A.key)}});const flags=ctx&&useCrepeFeatures(ctx).get();return(null==flags?void 0:flags.includes(CrepeFeature.Latex))&&functionGroup.addItem("latex",{icon:null!=(_e=null==config?void 0:config.latexIcon)?_e:functionsIcon,active:ctx2=>ctx2.get(core_lib.MD).call(preset_commonmark_lib.V4.key,mathInlineSchema.type(ctx2)),onRun:ctx2=>{ctx2.get(core_lib.MD).call(toggleLatexCommand.key)}}),functionGroup.addItem("link",{icon:null!=(_f=null==config?void 0:config.linkIcon)?_f:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M17.0385 19.5003V16.5388H14.0769V15.0388H17.0385V12.0773H18.5384V15.0388H21.5V16.5388H18.5384V19.5003H17.0385ZM10.8077 16.5388H7.03845C5.78282 16.5388 4.7125 16.0963 3.8275 15.2114C2.9425 14.3266 2.5 13.2564 2.5 12.0009C2.5 10.7454 2.9425 9.67504 3.8275 8.78979C4.7125 7.90454 5.78282 7.46191 7.03845 7.46191H10.8077V8.96186H7.03845C6.1987 8.96186 5.48235 9.25834 4.8894 9.85129C4.29645 10.4442 3.99998 11.1606 3.99998 12.0003C3.99998 12.8401 4.29645 13.5564 4.8894 14.1494C5.48235 14.7423 6.1987 15.0388 7.03845 15.0388H10.8077V16.5388ZM8.25 12.7503V11.2504H15.75V12.7503H8.25ZM21.5 12.0003H20C20 11.1606 19.7035 10.4442 19.1106 9.85129C18.5176 9.25834 17.8013 8.96186 16.9615 8.96186H13.1923V7.46191H16.9615C18.2171 7.46191 19.2875 7.90441 20.1725 8.78939C21.0575 9.67439 21.5 10.7447 21.5 12.0003Z"\n    />\n  </svg>\n',active:ctx2=>ctx2.get(core_lib.MD).call(preset_commonmark_lib.Kf.key,preset_commonmark_lib.Yk.type(ctx2)),onRun:ctx2=>{ctx2.get(core_lib.MD).call(toggleLinkCommand.key)}}),null==(_g=null==config?void 0:config.buildToolbar)||_g.call(config,groupBuilder),groupBuilder.build()}(config,ctx));return()=>(0,runtime_core_esm_bundler.h)(runtime_core_esm_bundler.FK,null,groupInfo.value.map(group=>group.items.map(item=>{return(0,runtime_core_esm_bundler.h)("button",{type:"button",class:(0,clsx.A)("toolbar-item",ctx&&checkActive(item.active)&&"active"),onPointerdown:(fn=item.onRun,e=>{e.preventDefault(),ctx&&fn(ctx)})},(0,runtime_core_esm_bundler.h)(Icon,{icon:item.icon}));var fn})).reduce((acc,curr,index)=>(0===index?acc.push(...curr):acc.push((0,runtime_core_esm_bundler.h)("div",{class:"divider"}),...curr),acc),[]))}});var _tooltipProvider,esm_content,esm_app,_selection,_show,esm_typeError$1=msg=>{throw TypeError(msg)},esm_accessCheck$1=(obj,member,msg)=>member.has(obj)||esm_typeError$1("Cannot "+msg),esm_privateGet$1=(obj,member,getter)=>(esm_accessCheck$1(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),esm_privateAdd$1=(obj,member,value)=>member.has(obj)?esm_typeError$1("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),esm_privateSet$1=(obj,member,value,setter)=>(esm_accessCheck$1(obj,member,"write to private field"),member.set(obj,value),value);const toolbarTooltip=tooltipFactory("CREPE_TOOLBAR");class ToolbarView{constructor(ctx,view,config){esm_privateAdd$1(this,_tooltipProvider),esm_privateAdd$1(this,esm_content),esm_privateAdd$1(this,esm_app),esm_privateAdd$1(this,_selection),esm_privateAdd$1(this,_show,(0,reactivity_esm_bundler.KR)(!1)),this.update=(view,prevState)=>{esm_privateGet$1(this,_tooltipProvider).update(view,prevState),esm_privateGet$1(this,_selection).value=view.state.selection},this.destroy=()=>{esm_privateGet$1(this,_tooltipProvider).destroy(),esm_privateGet$1(this,esm_app).unmount(),esm_privateGet$1(this,esm_content).remove()},this.hide=()=>{esm_privateGet$1(this,_tooltipProvider).hide()};const content=document.createElement("div");content.className="milkdown-toolbar",esm_privateSet$1(this,_selection,(0,reactivity_esm_bundler.IJ)(view.state.selection));const app=(0,runtime_dom_esm_bundler.Ef)(Toolbar,{ctx,hide:this.hide,config,selection:esm_privateGet$1(this,_selection),show:esm_privateGet$1(this,_show)});app.mount(content),esm_privateSet$1(this,esm_content,content),esm_privateSet$1(this,esm_app,app),esm_privateSet$1(this,_tooltipProvider,new TooltipProvider({content:esm_privateGet$1(this,esm_content),debounce:20,offset:10,shouldShow(view2){const{doc,selection}=view2.state,{empty,from,to}=selection,isEmptyTextBlock=!doc.textBetween(from,to).length&&selection instanceof prosemirror_state_dist.U3,isNotTextBlock=!(selection instanceof prosemirror_state_dist.U3),activeElement=view2.dom.getRootNode().activeElement,isTooltipChildren=content.contains(activeElement),notHasFocus=!view2.hasFocus()&&!isTooltipChildren,isReadonly=!view2.editable;return!(notHasFocus||isNotTextBlock||empty||isEmptyTextBlock||isReadonly)}})),esm_privateGet$1(this,_tooltipProvider).onShow=()=>{esm_privateGet$1(this,_show).value=!0},esm_privateGet$1(this,_tooltipProvider).onHide=()=>{esm_privateGet$1(this,_show).value=!1},this.update(view)}}_tooltipProvider=new WeakMap,esm_content=new WeakMap,esm_app=new WeakMap,_selection=new WeakMap,_show=new WeakMap;function loadFeature(feature,editor,config){switch(feature){case CrepeFeature.CodeMirror:return((editor,config={})=>{editor.config(crepeFeatureConfig(CrepeFeature.CodeMirror)).config(ctx=>{const{languages=[],theme}=config,extensions=[view_dist.w4.of(commands_dist.pw.concat(commands_dist.Yc)),basicSetup];theme&&extensions.push(theme),config.extensions&&extensions.push(...config.extensions),ctx.update(code_block.T4.key,defaultConfig=>({extensions,languages,expandIcon:config.expandIcon||chevronDownIcon,searchIcon:config.searchIcon||searchIcon,clearSearchIcon:config.clearSearchIcon||clearIcon,searchPlaceholder:config.searchPlaceholder||"Search language",copyText:config.copyText||"Copy",copyIcon:config.copyIcon||copyIcon,onCopy:config.onCopy||(()=>{}),noResultText:config.noResultText||"No result",renderLanguage:config.renderLanguage||defaultConfig.renderLanguage,renderPreview:config.renderPreview||defaultConfig.renderPreview,previewToggleButton:previewOnlyMode=>{var _a,_b;return[(null==(_a=config.previewToggleIcon)?void 0:_a.call(config,previewOnlyMode))||(previewOnlyMode?editIcon:visibilityOffIcon),(null==(_b=config.previewToggleText)?void 0:_b.call(config,previewOnlyMode))||(previewOnlyMode?"Edit":"Hide")].map(v=>v.trim()).join(" ")},previewLabel:config.previewLabel||defaultConfig.previewLabel}))}).use(code_block.MJ)})(editor,config);case CrepeFeature.ListItem:return listItem(editor,config);case CrepeFeature.LinkTooltip:return((editor,config)=>{editor.config(crepeFeatureConfig(CrepeFeature.LinkTooltip)).config(configureLinkTooltip).config(ctx=>{ctx.update(linkTooltipConfig.key,prev=>{var _a,_b,_c,_d,_e,_f;return{...prev,linkIcon:null!=(_a=null==config?void 0:config.linkIcon)?_a:copyIcon,editButton:null!=(_b=null==config?void 0:config.editButton)?_b:editIcon,removeButton:null!=(_c=null==config?void 0:config.removeButton)?_c:removeIcon,confirmButton:null!=(_d=null==config?void 0:config.confirmButton)?_d:confirmIcon,inputPlaceholder:null!=(_e=null==config?void 0:config.inputPlaceholder)?_e:"Paste link...",onCopyLink:null!=(_f=null==config?void 0:config.onCopyLink)?_f:()=>{}}})}).use(linkTooltipPlugin)})(editor,config);case CrepeFeature.ImageBlock:return((editor,config)=>{editor.config(crepeFeatureConfig(CrepeFeature.ImageBlock)).config(ctx=>{ctx.update(inlineImageConfig.key,value=>{var _a,_b,_c,_d,_e,_f;return{uploadButton:null!=(_a=null==config?void 0:config.inlineUploadButton)?_a:"Upload",imageIcon:null!=(_b=null==config?void 0:config.inlineImageIcon)?_b:imageIcon,confirmButton:null!=(_c=null==config?void 0:config.inlineConfirmButton)?_c:confirmIcon,uploadPlaceholderText:null!=(_d=null==config?void 0:config.inlineUploadPlaceholderText)?_d:"or paste link",onUpload:null!=(_f=null!=(_e=null==config?void 0:config.inlineOnUpload)?_e:null==config?void 0:config.onUpload)?_f:value.onUpload,proxyDomURL:null==config?void 0:config.proxyDomURL}}),ctx.update(imageBlockConfig.key,value=>{var _a,_b,_c,_d,_e,_f,_g,_h;return{uploadButton:null!=(_a=null==config?void 0:config.blockUploadButton)?_a:"Upload file",imageIcon:null!=(_b=null==config?void 0:config.blockImageIcon)?_b:imageIcon,captionIcon:null!=(_c=null==config?void 0:config.blockCaptionIcon)?_c:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="32"\n    height="32"\n    viewBox="0 0 24 24"\n  >\n    <path\n      fill="currentColor"\n      d="M9 22a1 1 0 0 1-1-1v-3H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6.1l-3.7 3.71c-.2.19-.45.29-.7.29zm1-6v3.08L13.08 16H20V4H4v12z"\n    />\n  </svg>\n',confirmButton:null!=(_d=null==config?void 0:config.blockConfirmButton)?_d:"Confirm",captionPlaceholderText:null!=(_e=null==config?void 0:config.blockCaptionPlaceholderText)?_e:"Write Image Caption",uploadPlaceholderText:null!=(_f=null==config?void 0:config.blockUploadPlaceholderText)?_f:"or paste link",onUpload:null!=(_h=null!=(_g=null==config?void 0:config.blockOnUpload)?_g:null==config?void 0:config.onUpload)?_h:value.onUpload,proxyDomURL:null==config?void 0:config.proxyDomURL}})}).use(imageBlockComponent).use(imageInlineComponent)})(editor,config);case CrepeFeature.Cursor:return((editor,config)=>{if(editor.config(crepeFeatureConfig(CrepeFeature.Cursor)).config(ctx=>{ctx.update(plugin_cursor_lib.Bp.key,()=>{var _a,_b;return{class:"crepe-drop-cursor",width:null!=(_a=null==config?void 0:config.width)?_a:4,color:null!=(_b=null==config?void 0:config.color)&&_b}})}).use(plugin_cursor_lib.Dy),!1===(null==config?void 0:config.virtual))return;const virtualCursor=createVirtualCursor();editor.use((0,utils_lib.Gf)(()=>virtualCursor))})(editor,config);case CrepeFeature.BlockEdit:return blockEdit(editor,config);case CrepeFeature.Placeholder:return((editor,config)=>{editor.config(crepeFeatureConfig(CrepeFeature.Placeholder)).config(ctx=>{config&&ctx.update(placeholderConfig.key,prev=>({...prev,...config}))}).use(placeholderPlugin).use(placeholderConfig)})(editor,config);case CrepeFeature.Toolbar:return((editor,config)=>{editor.config(crepeFeatureConfig(CrepeFeature.Toolbar)).config(ctx=>{ctx.set(toolbarTooltip.key,{view:view=>new ToolbarView(ctx,view,config)})}).use(toolbarTooltip)})(editor,config);case CrepeFeature.Table:return((editor,config)=>{editor.config(crepeFeatureConfig(CrepeFeature.Table)).config(ctx=>{ctx.update(tableBlockConfig.key,defaultConfig=>({...defaultConfig,renderButton:renderType=>{var _a,_b,_c,_d,_e,_f,_g,_h,_i;switch(renderType){case"add_row":return null!=(_a=null==config?void 0:config.addRowIcon)?_a:plusIcon;case"add_col":return null!=(_b=null==config?void 0:config.addColIcon)?_b:plusIcon;case"delete_row":return null!=(_c=null==config?void 0:config.deleteRowIcon)?_c:removeIcon;case"delete_col":return null!=(_d=null==config?void 0:config.deleteColIcon)?_d:removeIcon;case"align_col_left":return null!=(_e=null==config?void 0:config.alignLeftIcon)?_e:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M4.25 20.5C4.0375 20.5 3.85942 20.4281 3.71575 20.2843C3.57192 20.1404 3.5 19.9622 3.5 19.7498C3.5 19.5371 3.57192 19.359 3.71575 19.2155C3.85942 19.0718 4.0375 19 4.25 19H19.75C19.9625 19 20.1406 19.0719 20.2843 19.2158C20.4281 19.3596 20.5 19.5378 20.5 19.7502C20.5 19.9629 20.4281 20.141 20.2843 20.2845C20.1406 20.4282 19.9625 20.5 19.75 20.5H4.25ZM4.25 16.625C4.0375 16.625 3.85942 16.5531 3.71575 16.4093C3.57192 16.2654 3.5 16.0872 3.5 15.8748C3.5 15.6621 3.57192 15.484 3.71575 15.3405C3.85942 15.1968 4.0375 15.125 4.25 15.125H13.75C13.9625 15.125 14.1406 15.1969 14.2843 15.3408C14.4281 15.4846 14.5 15.6628 14.5 15.8753C14.5 16.0879 14.4281 16.266 14.2843 16.4095C14.1406 16.5532 13.9625 16.625 13.75 16.625H4.25ZM4.25 12.75C4.0375 12.75 3.85942 12.6781 3.71575 12.5343C3.57192 12.3904 3.5 12.2122 3.5 11.9998C3.5 11.7871 3.57192 11.609 3.71575 11.4655C3.85942 11.3218 4.0375 11.25 4.25 11.25H19.75C19.9625 11.25 20.1406 11.3219 20.2843 11.4658C20.4281 11.6096 20.5 11.7878 20.5 12.0003C20.5 12.2129 20.4281 12.391 20.2843 12.5345C20.1406 12.6782 19.9625 12.75 19.75 12.75H4.25ZM4.25 8.875C4.0375 8.875 3.85942 8.80308 3.71575 8.65925C3.57192 8.51542 3.5 8.33725 3.5 8.12475C3.5 7.91208 3.57192 7.734 3.71575 7.5905C3.85942 7.44683 4.0375 7.375 4.25 7.375H13.75C13.9625 7.375 14.1406 7.44692 14.2843 7.59075C14.4281 7.73458 14.5 7.91275 14.5 8.12525C14.5 8.33792 14.4281 8.516 14.2843 8.6595C14.1406 8.80317 13.9625 8.875 13.75 8.875H4.25ZM4.25 5C4.0375 5 3.85942 4.92808 3.71575 4.78425C3.57192 4.64042 3.5 4.46225 3.5 4.24975C3.5 4.03708 3.57192 3.859 3.71575 3.7155C3.85942 3.57183 4.0375 3.5 4.25 3.5H19.75C19.9625 3.5 20.1406 3.57192 20.2843 3.71575C20.4281 3.85958 20.5 4.03775 20.5 4.25025C20.5 4.46292 20.4281 4.641 20.2843 4.7845C20.1406 4.92817 19.9625 5 19.75 5H4.25Z"\n    />\n  </svg>\n';case"align_col_center":return null!=(_f=null==config?void 0:config.alignCenterIcon)?_f:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M4.25 20.5C4.0375 20.5 3.85942 20.4281 3.71575 20.2843C3.57192 20.1404 3.5 19.9622 3.5 19.7498C3.5 19.5371 3.57192 19.359 3.71575 19.2155C3.85942 19.0718 4.0375 19 4.25 19H19.75C19.9625 19 20.1406 19.0719 20.2843 19.2158C20.4281 19.3596 20.5 19.5378 20.5 19.7502C20.5 19.9629 20.4281 20.141 20.2843 20.2845C20.1406 20.4282 19.9625 20.5 19.75 20.5H4.25ZM8.25 16.625C8.0375 16.625 7.85942 16.5531 7.71575 16.4093C7.57192 16.2654 7.5 16.0872 7.5 15.8748C7.5 15.6621 7.57192 15.484 7.71575 15.3405C7.85942 15.1968 8.0375 15.125 8.25 15.125H15.75C15.9625 15.125 16.1406 15.1969 16.2843 15.3408C16.4281 15.4846 16.5 15.6628 16.5 15.8753C16.5 16.0879 16.4281 16.266 16.2843 16.4095C16.1406 16.5532 15.9625 16.625 15.75 16.625H8.25ZM4.25 12.75C4.0375 12.75 3.85942 12.6781 3.71575 12.5343C3.57192 12.3904 3.5 12.2122 3.5 11.9998C3.5 11.7871 3.57192 11.609 3.71575 11.4655C3.85942 11.3218 4.0375 11.25 4.25 11.25H19.75C19.9625 11.25 20.1406 11.3219 20.2843 11.4658C20.4281 11.6096 20.5 11.7878 20.5 12.0003C20.5 12.2129 20.4281 12.391 20.2843 12.5345C20.1406 12.6782 19.9625 12.75 19.75 12.75H4.25ZM8.25 8.875C8.0375 8.875 7.85942 8.80308 7.71575 8.65925C7.57192 8.51542 7.5 8.33725 7.5 8.12475C7.5 7.91208 7.57192 7.734 7.71575 7.5905C7.85942 7.44683 8.0375 7.375 8.25 7.375H15.75C15.9625 7.375 16.1406 7.44692 16.2843 7.59075C16.4281 7.73458 16.5 7.91275 16.5 8.12525C16.5 8.33792 16.4281 8.516 16.2843 8.6595C16.1406 8.80317 15.9625 8.875 15.75 8.875H8.25ZM4.25 5C4.0375 5 3.85942 4.92808 3.71575 4.78425C3.57192 4.64042 3.5 4.46225 3.5 4.24975C3.5 4.03708 3.57192 3.859 3.71575 3.7155C3.85942 3.57183 4.0375 3.5 4.25 3.5H19.75C19.9625 3.5 20.1406 3.57192 20.2843 3.71575C20.4281 3.85958 20.5 4.03775 20.5 4.25025C20.5 4.46292 20.4281 4.641 20.2843 4.7845C20.1406 4.92817 19.9625 5 19.75 5H4.25Z"\n    />\n  </svg>\n';case"align_col_right":return null!=(_g=null==config?void 0:config.alignRightIcon)?_g:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M4.25 5C4.0375 5 3.85942 4.92808 3.71575 4.78425C3.57192 4.64042 3.5 4.46225 3.5 4.24975C3.5 4.03708 3.57192 3.859 3.71575 3.7155C3.85942 3.57183 4.0375 3.5 4.25 3.5H19.75C19.9625 3.5 20.1406 3.57192 20.2843 3.71575C20.4281 3.85958 20.5 4.03775 20.5 4.25025C20.5 4.46292 20.4281 4.641 20.2843 4.7845C20.1406 4.92817 19.9625 5 19.75 5H4.25ZM10.25 8.875C10.0375 8.875 9.85942 8.80308 9.71575 8.65925C9.57192 8.51542 9.5 8.33725 9.5 8.12475C9.5 7.91208 9.57192 7.734 9.71575 7.5905C9.85942 7.44683 10.0375 7.375 10.25 7.375H19.75C19.9625 7.375 20.1406 7.44692 20.2843 7.59075C20.4281 7.73458 20.5 7.91275 20.5 8.12525C20.5 8.33792 20.4281 8.516 20.2843 8.6595C20.1406 8.80317 19.9625 8.875 19.75 8.875H10.25ZM4.25 12.75C4.0375 12.75 3.85942 12.6781 3.71575 12.5343C3.57192 12.3904 3.5 12.2122 3.5 11.9998C3.5 11.7871 3.57192 11.609 3.71575 11.4655C3.85942 11.3218 4.0375 11.25 4.25 11.25H19.75C19.9625 11.25 20.1406 11.3219 20.2843 11.4658C20.4281 11.6096 20.5 11.7878 20.5 12.0003C20.5 12.2129 20.4281 12.391 20.2843 12.5345C20.1406 12.6782 19.9625 12.75 19.75 12.75H4.25ZM10.25 16.625C10.0375 16.625 9.85942 16.5531 9.71575 16.4093C9.57192 16.2654 9.5 16.0872 9.5 15.8748C9.5 15.6621 9.57192 15.484 9.71575 15.3405C9.85942 15.1968 10.0375 15.125 10.25 15.125H19.75C19.9625 15.125 20.1406 15.1969 20.2843 15.3408C20.4281 15.4846 20.5 15.6628 20.5 15.8753C20.5 16.0879 20.4281 16.266 20.2843 16.4095C20.1406 16.5532 19.9625 16.625 19.75 16.625H10.25ZM4.25 20.5C4.0375 20.5 3.85942 20.4281 3.71575 20.2843C3.57192 20.1404 3.5 19.9622 3.5 19.7498C3.5 19.5371 3.57192 19.359 3.71575 19.2155C3.85942 19.0718 4.0375 19 4.25 19H19.75C19.9625 19 20.1406 19.0719 20.2843 19.2158C20.4281 19.3596 20.5 19.5378 20.5 19.7502C20.5 19.9629 20.4281 20.141 20.2843 20.2845C20.1406 20.4282 19.9625 20.5 19.75 20.5H4.25Z"\n    />\n  </svg>\n';case"col_drag_handle":return null!=(_h=null==config?void 0:config.colDragHandleIcon)?_h:dragHandleIcon;case"row_drag_handle":return null!=(_i=null==config?void 0:config.rowDragHandleIcon)?_i:dragHandleIcon}}}))}).use(tableBlock)})(editor,config);case CrepeFeature.Latex:return latex(editor,config)}}var _editor,_rootElement,_editable,esm_typeError=msg=>{throw TypeError(msg)},esm_accessCheck=(obj,member,msg)=>member.has(obj)||esm_typeError("Cannot "+msg),esm_privateGet=(obj,member,getter)=>(esm_accessCheck(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),esm_privateAdd=(obj,member,value)=>member.has(obj)?esm_typeError("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),esm_privateSet=(obj,member,value,setter)=>(esm_accessCheck(obj,member,"write to private field"),member.set(obj,value),value);class CrepeBuilder{constructor({root,defaultValue=""}={}){var _a;esm_privateAdd(this,_editor),esm_privateAdd(this,_rootElement),esm_privateAdd(this,_editable,!0),this.addFeature=(feature,config)=>(feature(esm_privateGet(this,_editor),config),this),this.create=()=>esm_privateGet(this,_editor).create(),this.destroy=()=>esm_privateGet(this,_editor).destroy(),this.setReadonly=value=>(esm_privateSet(this,_editable,!value),esm_privateGet(this,_editor).action(ctx=>{if(esm_privateGet(this,_editor).status===core_lib.qv.Created){ctx.get(core_lib.kY).setProps({editable:()=>!value})}}),this),this.getMarkdown=()=>esm_privateGet(this,_editor).action((0,utils_lib.up)()),this.on=fn=>esm_privateGet(this,_editor).status!==core_lib.qv.Created?(esm_privateGet(this,_editor).config(ctx=>{const listener2=ctx.get(plugin_listener_lib.Ob);fn(listener2)}),this):(esm_privateGet(this,_editor).action(ctx=>{const listener2=ctx.get(plugin_listener_lib.Ob);fn(listener2)}),this),esm_privateSet(this,_rootElement,null!=(_a="string"==typeof root?document.querySelector(root):root)?_a:document.body),esm_privateSet(this,_editor,core_lib.KE.make().config(ctx=>{ctx.inject(CrepeCtx,this),ctx.inject(FeaturesCtx,[])}).config(ctx=>{ctx.set(core_lib.k,esm_privateGet(this,_rootElement)),ctx.set(core_lib.CI,defaultValue),ctx.set(core_lib.QM,{editable:()=>esm_privateGet(this,_editable)}),ctx.update(indentConfig.key,value=>({...value,size:4}))}).use(preset_commonmark_lib.PD).use(plugin_listener_lib.F_).use(lib_history).use(indent).use(plugin_trailing_lib.ZY).use(clipboard).use(gfm))}get editor(){return esm_privateGet(this,_editor)}get readonly(){return!esm_privateGet(this,_editable)}}_editor=new WeakMap,_rootElement=new WeakMap,_editable=new WeakMap;class Crepe extends CrepeBuilder{constructor({features={},featureConfigs={},...crepeBuilderConfig}={}){super(crepeBuilderConfig);const finalConfigs=lodash_es_defaultsDeep(featureConfigs,esm_defaultConfig);Object.entries({...defaultFeatures,...features}).filter(([,enabled])=>enabled).map(([feature])=>feature).forEach(feature=>{const config=finalConfigs[feature];loadFeature(feature,this.editor,config)})}}Crepe.Feature=CrepeFeature},"./node_modules/@milkdown/ctx/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{CR:()=>createTimer,Kj:()=>Ctx,Z0:()=>createSlice,mc:()=>Container,zD:()=>Clock});var _milkdown_exception__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@milkdown/exception/lib/index.js");class Container{constructor(){this.sliceMap=new Map,this.get=slice=>{const context="string"==typeof slice?[...this.sliceMap.values()].find(x=>x.type.name===slice):this.sliceMap.get(slice.id);if(!context){const name="string"==typeof slice?slice:slice.name;throw(0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.XM)(name)}return context},this.remove=slice=>{const context="string"==typeof slice?[...this.sliceMap.values()].find(x=>x.type.name===slice):this.sliceMap.get(slice.id);context&&this.sliceMap.delete(context.type.id)},this.has=slice=>"string"==typeof slice?[...this.sliceMap.values()].some(x=>x.type.name===slice):this.sliceMap.has(slice.id)}}class Slice{constructor(container,value,type){this.#watchers=[],this.#emit=()=>{this.#watchers.forEach(watcher=>watcher(this.#value))},this.set=value2=>{this.#value=value2,this.#emit()},this.get=()=>this.#value,this.update=updater=>{this.#value=updater(this.#value),this.#emit()},this.type=type,this.#value=value,container.set(type.id,this)}#watchers;#value;#emit;on(watcher){return this.#watchers.push(watcher),()=>{this.#watchers=this.#watchers.filter(w=>w!==watcher)}}once(watcher){const off=this.on(value=>{watcher(value),off()});return off}off(watcher){this.#watchers=this.#watchers.filter(w=>w!==watcher)}offAll(){this.#watchers=[]}}class SliceType{constructor(value,name){this.id=Symbol(`Context-${name}`),this.name=name,this._defaultValue=value,this._typeInfo=()=>{throw(0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.dI)()}}create(container,value=this._defaultValue){return new Slice(container,value,this)}}const createSlice=(value,name)=>new SliceType(value,name);class Inspector{constructor(container,clock,meta){this.#injectedSlices=new Set,this.#consumedSlices=new Set,this.#recordedTimers=new Map,this.#waitTimers=new Map,this.read=()=>({metadata:this.#meta,injectedSlices:[...this.#injectedSlices].map(slice=>({name:"string"==typeof slice?slice:slice.name,value:this.#getSlice(slice)})),consumedSlices:[...this.#consumedSlices].map(slice=>({name:"string"==typeof slice?slice:slice.name,value:this.#getSlice(slice)})),recordedTimers:[...this.#recordedTimers].map(([timer,{duration}])=>({name:timer.name,duration,status:this.#getTimer(timer)})),waitTimers:[...this.#waitTimers].map(([timer,{duration}])=>({name:timer.name,duration,status:this.#getTimer(timer)}))}),this.onRecord=timerType=>{this.#recordedTimers.set(timerType,{start:Date.now(),duration:0})},this.onClear=timerType=>{this.#recordedTimers.delete(timerType)},this.onDone=timerType=>{const timer=this.#recordedTimers.get(timerType);timer&&(timer.duration=Date.now()-timer.start)},this.onWait=(timerType,promise)=>{const start=Date.now();promise.finally(()=>{this.#waitTimers.set(timerType,{duration:Date.now()-start})}).catch(console.error)},this.onInject=sliceType=>{this.#injectedSlices.add(sliceType)},this.onRemove=sliceType=>{this.#injectedSlices.delete(sliceType)},this.onUse=sliceType=>{this.#consumedSlices.add(sliceType)},this.#getSlice=sliceType=>this.#container.get(sliceType).get(),this.#getTimer=timerType=>this.#clock.get(timerType).status,this.#container=container,this.#clock=clock,this.#meta=meta}#meta;#container;#clock;#injectedSlices;#consumedSlices;#recordedTimers;#waitTimers;#getSlice;#getTimer}class Ctx{constructor(container,clock,meta){this.produce=meta2=>meta2&&Object.keys(meta2).length?new Ctx(this.#container,this.#clock,{...meta2}):this,this.inject=(sliceType,value)=>{const slice=sliceType.create(this.#container.sliceMap);return null!=value&&slice.set(value),this.#inspector?.onInject(sliceType),this},this.remove=sliceType=>(this.#container.remove(sliceType),this.#inspector?.onRemove(sliceType),this),this.record=timerType=>(timerType.create(this.#clock.store),this.#inspector?.onRecord(timerType),this),this.clearTimer=timerType=>(this.#clock.remove(timerType),this.#inspector?.onClear(timerType),this),this.isInjected=sliceType=>this.#container.has(sliceType),this.isRecorded=timerType=>this.#clock.has(timerType),this.use=sliceType=>(this.#inspector?.onUse(sliceType),this.#container.get(sliceType)),this.get=sliceType=>this.use(sliceType).get(),this.set=(sliceType,value)=>this.use(sliceType).set(value),this.update=(sliceType,updater)=>this.use(sliceType).update(updater),this.timer=timer=>this.#clock.get(timer),this.done=timer=>{this.timer(timer).done(),this.#inspector?.onDone(timer)},this.wait=timer=>{const promise=this.timer(timer).start();return this.#inspector?.onWait(timer,promise),promise},this.waitTimers=async slice=>{await Promise.all(this.get(slice).map(x=>this.wait(x)))},this.#container=container,this.#clock=clock,this.#meta=meta,meta&&(this.#inspector=new Inspector(container,clock,meta))}#container;#clock;#meta;#inspector;get meta(){return this.#meta}get inspector(){return this.#inspector}}class Clock{constructor(){this.store=new Map,this.get=timer=>{const meta=this.store.get(timer.id);if(!meta)throw(0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.nr)(timer.name);return meta},this.remove=timer=>{this.store.delete(timer.id)},this.has=timer=>this.store.has(timer.id)}}class Timer{constructor(clock,type){this.#promise=null,this.#listener=null,this.#status="pending",this.start=()=>(this.#promise??=new Promise((resolve,reject)=>{this.#listener=e=>{e instanceof CustomEvent&&e.detail.id===this.#eventUniqId&&(this.#status="resolved",this.#removeListener(),e.stopImmediatePropagation(),resolve())},this.#waitTimeout(()=>{"pending"===this.#status&&(this.#status="rejected"),this.#removeListener(),reject(new Error(`Timing ${this.type.name} timeout.`))}),this.#status="pending",addEventListener(this.type.name,this.#listener)}),this.#promise),this.done=()=>{const event=new CustomEvent(this.type.name,{detail:{id:this.#eventUniqId}});dispatchEvent(event)},this.#removeListener=()=>{this.#listener&&removeEventListener(this.type.name,this.#listener)},this.#waitTimeout=ifTimeout=>{setTimeout(()=>{ifTimeout()},this.type.timeout)},this.#eventUniqId=Symbol(type.name),this.type=type,clock.set(type.id,this)}#promise;#listener;#eventUniqId;#status;get status(){return this.#status}#removeListener;#waitTimeout}class TimerType{constructor(name,timeout=3e3){this.create=clock=>new Timer(clock,this),this.id=Symbol(`Timer-${name}`),this.name=name,this.timeout=timeout}}const createTimer=(name,timeout=3e3)=>new TimerType(name,timeout)},"./node_modules/@milkdown/exception/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$D:()=>createNodeInParserFail,Ik:()=>expectDomTypeError,TR:()=>stackOverFlow,XM:()=>contextNotFound,Xm:()=>parserMatchError,_K:()=>serializerMatchError,dI:()=>ctxCallOutOfScope,j7:()=>docTypeError,nr:()=>timerNotFound,p8:()=>getAtomFromSchemaFail,pj:()=>missingNodeInSchema,sm:()=>missingMarkInSchema,zD:()=>callCommandBeforeEditorView});var ErrorCode=(ErrorCode2=>(ErrorCode2.docTypeError="docTypeError",ErrorCode2.contextNotFound="contextNotFound",ErrorCode2.timerNotFound="timerNotFound",ErrorCode2.ctxCallOutOfScope="ctxCallOutOfScope",ErrorCode2.createNodeInParserFail="createNodeInParserFail",ErrorCode2.stackOverFlow="stackOverFlow",ErrorCode2.parserMatchError="parserMatchError",ErrorCode2.serializerMatchError="serializerMatchError",ErrorCode2.getAtomFromSchemaFail="getAtomFromSchemaFail",ErrorCode2.expectDomTypeError="expectDomTypeError",ErrorCode2.callCommandBeforeEditorView="callCommandBeforeEditorView",ErrorCode2.missingRootElement="missingRootElement",ErrorCode2.missingNodeInSchema="missingNodeInSchema",ErrorCode2.missingMarkInSchema="missingMarkInSchema",ErrorCode2.ctxNotBind="ctxNotBind",ErrorCode2.missingYjsDoc="missingYjsDoc",ErrorCode2))(ErrorCode||{});class MilkdownError extends Error{constructor(code,message){super(message),this.name="MilkdownError",this.code=code}}const functionReplacer=(_,value)=>"function"==typeof value?"[Function]":value,stringify=x=>JSON.stringify(x,functionReplacer);function docTypeError(type){return new MilkdownError(ErrorCode.docTypeError,`Doc type error, unsupported type: ${stringify(type)}`)}function contextNotFound(name){return new MilkdownError(ErrorCode.contextNotFound,`Context "${name}" not found, do you forget to inject it?`)}function timerNotFound(name){return new MilkdownError(ErrorCode.timerNotFound,`Timer "${name}" not found, do you forget to record it?`)}function ctxCallOutOfScope(){return new MilkdownError(ErrorCode.ctxCallOutOfScope,"Should not call a context out of the plugin.")}function createNodeInParserFail(nodeType,attrs,content){const nodeTypeName="name"in nodeType?nodeType.name:nodeType,serialize=x=>{if(null==x)return"null";if(Array.isArray(x))return`[${x.map(serialize).join(", ")}]`;if("object"==typeof x)return"toJSON"in x&&"function"==typeof x.toJSON?JSON.stringify(x.toJSON()):"spec"in x?JSON.stringify(x.spec):JSON.stringify(x);if("string"==typeof x||"number"==typeof x||"boolean"==typeof x)return JSON.stringify(x);if("function"==typeof x)return`[Function: ${x.name||"anonymous"}]`;try{return String(x)}catch{return"[Unserializable]"}},messages=[["[Description]",`Cannot create node for ${nodeTypeName}`],["[Attributes]",attrs],["[Content]",(content??[]).map(node=>node?"object"==typeof node&&"type"in node?`${node}`:serialize(node):"null")]].reduce((acc,[title,value])=>{const message=`${title}: ${serialize(value)}.`;return acc.concat(message)},[]);return new MilkdownError(ErrorCode.createNodeInParserFail,messages.join("\n"))}function stackOverFlow(){return new MilkdownError(ErrorCode.stackOverFlow,"Stack over flow, cannot pop on an empty stack.")}function parserMatchError(node){return new MilkdownError(ErrorCode.parserMatchError,`Cannot match target parser for node: ${stringify(node)}.`)}function serializerMatchError(node){return new MilkdownError(ErrorCode.serializerMatchError,`Cannot match target serializer for node: ${stringify(node)}.`)}function getAtomFromSchemaFail(type,name){return new MilkdownError(ErrorCode.getAtomFromSchemaFail,`Cannot get ${type}: ${name} from schema.`)}function expectDomTypeError(node){return new MilkdownError(ErrorCode.expectDomTypeError,`Expect to be a dom, but get: ${stringify(node)}.`)}function callCommandBeforeEditorView(){return new MilkdownError(ErrorCode.callCommandBeforeEditorView,"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}function missingNodeInSchema(name){return new MilkdownError(ErrorCode.missingNodeInSchema,`Missing node in schema, milkdown cannot find "${name}" in schema.`)}function missingMarkInSchema(name){return new MilkdownError(ErrorCode.missingMarkInSchema,`Missing mark in schema, milkdown cannot find "${name}" in schema.`)}},"./node_modules/@milkdown/plugin-cursor/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Dy:()=>cursor,Bp:()=>dropIndicatorConfig});var lib=__webpack_require__("./node_modules/@milkdown/utils/lib/index.js"),dist=__webpack_require__("./node_modules/prosemirror-state/dist/index.js");function isElement(node){return 1===node.nodeType}function isHTMLElement(node){return isElement(node)&&"http://www.w3.org/1999/xhtml"===node.namespaceURI}function buildGetTarget(view,onDrag){let prevDoc,prevRect,prevTargets=[];const getTargets=()=>{const rect=view.dom.getBoundingClientRect(),doc=view.state.doc;return prevTargets&&prevDoc&&prevRect&&rect.width===prevRect.width&&rect.height===prevRect.height&&rect.x===prevRect.x&&rect.y===prevRect.y&&prevDoc.eq(doc)||(prevRect=rect,prevDoc=doc,prevTargets=function getTargetsByView(view){let stack=[[-1,view.state.doc]],targets=[];for(;stack.length>0;){const[pos,node]=stack.pop();if(pos>=0){let dom=view.nodeDOM(pos);if(dom&&isHTMLElement(dom)){let{top,bottom,left:x1,right:x2}=dom.getBoundingClientRect();targets.push([pos,[x1,top,x2,top]],[pos+node.nodeSize,[x1,bottom,x2,bottom]])}}if(node.isBlock&&!node.isTextblock){let childPos=pos+1;for(let child of node.children)stack.push([childPos,child]),childPos+=child.nodeSize}}return targets}(view)),prevTargets},getTargetImpl=(point,event)=>{if(!view.editable||view.isDestroyed)return;let targets=getTargets();targets.sort((p1,p2)=>{const[pos1,line1]=p1,[pos2,line2]=p2;return pointLineDistance(point,line1)-pointLineDistance(point,line2)||pos1-pos2}),targets=targets.slice(0,8);const target=targets.find(target$1=>!1!==onDrag?.({view,pos:target$1[0],event}));return target&&function isDraggingToItself(view,pos){const dragging=view.dragging;if(!dragging)return;const{move}=dragging;if(!move)return;const selection=view.state.selection;if(!(selection instanceof dist.nh))return;const{from,to}=selection;return from<=pos&&pos<=to}(view,target[0])?void 0:target};let prevPoint,prevTarget;return(point,event)=>(prevPoint&&function pointEqual(a,b){return a[0]===b[0]&&a[1]===b[1]}(prevPoint,point)||(prevPoint=point,prevTarget=getTargetImpl(point,event)),prevTarget)}function pointPointDistance(a,b){return Math.abs(a[0]-b[0])+Math.abs(a[1]-b[1])}function pointLineDistance(point,line){return Math.min(pointPointDistance(point,[line[0],line[1]]),pointPointDistance(point,[line[2],line[3]]))}function createDropIndicatorPlugin(options){let getTarget;return new dist.k_({key:new dist.hs("prosekit-drop-indicator"),view:view=>(getTarget=buildGetTarget(view,options.onDrag),function createDropIndicatorView(view,getTarget,options){let hideId,prevX,prevY,dom=view.dom,hasDragOverEvent=!1;const scheduleHide=()=>{hideId&&clearTimeout(hideId),hasDragOverEvent=!1,hideId=setTimeout(()=>{hasDragOverEvent||options.onHide?.()},30)},handleDragOver=event=>{hasDragOverEvent=!0;const{clientX,clientY}=event;if(prevX===clientX&&prevY===clientY)return;prevX=clientX,prevY=clientY;let target=getTarget([clientX,clientY],event);if(target){const[pos,[x1,y1,x2,y2]]=target,line={p1:{x:x1,y:y1},p2:{x:x2,y:y2}};options.onShow?.({view,pos,line})}else scheduleHide()};dom.addEventListener("dragover",handleDragOver),dom.addEventListener("dragend",scheduleHide),dom.addEventListener("drop",scheduleHide),dom.addEventListener("dragleave",scheduleHide);return{destroy:()=>{dom.removeEventListener("dragover",handleDragOver),dom.removeEventListener("dragend",scheduleHide),dom.removeEventListener("drop",scheduleHide),dom.removeEventListener("dragleave",scheduleHide)}}}(view,getTarget,options)),props:{handleDrop(view,event,slice,move){if(!getTarget)return!1;const target=getTarget([event.clientX,event.clientY],event);if(!target)return!1;event.preventDefault();let insertPos=target[0],tr=view.state.tr;if(move){let{node}=view.dragging||{};node?node.replace(tr):tr.deleteSelection()}let pos=tr.mapping.map(insertPos),isNode=0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount,beforeInsert=tr.doc;if(isNode?tr.replaceRangeWith(pos,pos,slice.content.firstChild):tr.replaceRange(pos,pos,slice),tr.doc.eq(beforeInsert))return!0;let $pos=tr.doc.resolve(pos);if(isNode&&dist.nh.isSelectable(slice.content.firstChild)&&$pos.nodeAfter&&$pos.nodeAfter.sameMarkup(slice.content.firstChild))tr.setSelection(new dist.nh($pos));else{let end=tr.mapping.map(insertPos);tr.mapping.maps[tr.mapping.maps.length-1].forEach((_from,_to,_newFrom,newTo)=>end=newTo),tr.setSelection(function selectionBetween(view,$anchor,$head,bias){return view.someProp("createSelectionBetween",f=>f(view,$anchor,$head))||dist.U3.between($anchor,$head,bias)}(view,$pos,tr.doc.resolve(end)))}return view.focus(),view.dispatch(tr.setMeta("uiEvent","drop")),!0}}})}var prosemirror_keymap_dist=__webpack_require__("./node_modules/prosemirror-keymap/dist/index.js"),prosemirror_model_dist=__webpack_require__("./node_modules/prosemirror-model/dist/index.js"),prosemirror_view_dist=__webpack_require__("./node_modules/prosemirror-view/dist/index.js");class GapCursor extends dist.LN{constructor($pos){super($pos,$pos)}map(doc,mapping){let $pos=doc.resolve(mapping.map(this.head));return GapCursor.valid($pos)?new GapCursor($pos):dist.LN.near($pos)}content(){return prosemirror_model_dist.Ji.empty}eq(other){return other instanceof GapCursor&&other.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(doc,json){if("number"!=typeof json.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new GapCursor(doc.resolve(json.pos))}getBookmark(){return new GapBookmark(this.anchor)}static valid($pos){let parent=$pos.parent;if(parent.isTextblock||!function closedBefore($pos){for(let d=$pos.depth;d>=0;d--){let index=$pos.index(d),parent=$pos.node(d);if(0!=index)for(let before=parent.child(index-1);;before=before.lastChild){if(0==before.childCount&&!before.inlineContent||before.isAtom||before.type.spec.isolating)return!0;if(before.inlineContent)return!1}else if(parent.type.spec.isolating)return!0}return!0}($pos)||!function closedAfter($pos){for(let d=$pos.depth;d>=0;d--){let index=$pos.indexAfter(d),parent=$pos.node(d);if(index!=parent.childCount)for(let after=parent.child(index);;after=after.firstChild){if(0==after.childCount&&!after.inlineContent||after.isAtom||after.type.spec.isolating)return!0;if(after.inlineContent)return!1}else if(parent.type.spec.isolating)return!0}return!0}($pos))return!1;let override=parent.type.spec.allowGapCursor;if(null!=override)return override;let deflt=parent.contentMatchAt($pos.index()).defaultType;return deflt&&deflt.isTextblock}static findGapCursorFrom($pos,dir,mustMove=!1){search:for(;;){if(!mustMove&&GapCursor.valid($pos))return $pos;let pos=$pos.pos,next=null;for(let d=$pos.depth;;d--){let parent=$pos.node(d);if(dir>0?$pos.indexAfter(d)<parent.childCount:$pos.index(d)>0){next=parent.child(dir>0?$pos.indexAfter(d):$pos.index(d)-1);break}if(0==d)return null;pos+=dir;let $cur=$pos.doc.resolve(pos);if(GapCursor.valid($cur))return $cur}for(;;){let inside=dir>0?next.firstChild:next.lastChild;if(!inside){if(next.isAtom&&!next.isText&&!dist.nh.isSelectable(next)){$pos=$pos.doc.resolve(pos+next.nodeSize*dir),mustMove=!1;continue search}break}next=inside,pos+=dir;let $cur=$pos.doc.resolve(pos);if(GapCursor.valid($cur))return $cur}return null}}}GapCursor.prototype.visible=!1,GapCursor.findFrom=GapCursor.findGapCursorFrom,dist.LN.jsonID("gapcursor",GapCursor);class GapBookmark{constructor(pos){this.pos=pos}map(mapping){return new GapBookmark(mapping.map(this.pos))}resolve(doc){let $pos=doc.resolve(this.pos);return GapCursor.valid($pos)?new GapCursor($pos):dist.LN.near($pos)}}const handleKeyDown=(0,prosemirror_keymap_dist.K)({ArrowLeft:arrow("horiz",-1),ArrowRight:arrow("horiz",1),ArrowUp:arrow("vert",-1),ArrowDown:arrow("vert",1)});function arrow(axis,dir){const dirStr="vert"==axis?dir>0?"down":"up":dir>0?"right":"left";return function(state,dispatch,view){let sel=state.selection,$start=dir>0?sel.$to:sel.$from,mustMove=sel.empty;if(sel instanceof dist.U3){if(!view.endOfTextblock(dirStr)||0==$start.depth)return!1;mustMove=!1,$start=state.doc.resolve(dir>0?$start.after():$start.before())}let $found=GapCursor.findGapCursorFrom($start,dir,mustMove);return!!$found&&(dispatch&&dispatch(state.tr.setSelection(new GapCursor($found))),!0)}}function handleClick(view,pos,event){if(!view||!view.editable)return!1;let $pos=view.state.doc.resolve(pos);if(!GapCursor.valid($pos))return!1;let clickPos=view.posAtCoords({left:event.clientX,top:event.clientY});return!(clickPos&&clickPos.inside>-1&&dist.nh.isSelectable(view.state.doc.nodeAt(clickPos.inside)))&&(view.dispatch(view.state.tr.setSelection(new GapCursor($pos))),!0)}function beforeinput(view,event){if("insertCompositionText"!=event.inputType||!(view.state.selection instanceof GapCursor))return!1;let{$from}=view.state.selection,insert=$from.parent.contentMatchAt($from.index()).findWrapping(view.state.schema.nodes.text);if(!insert)return!1;let frag=prosemirror_model_dist.FK.empty;for(let i=insert.length-1;i>=0;i--)frag=prosemirror_model_dist.FK.from(insert[i].createAndFill(null,frag));let tr=view.state.tr.replace($from.pos,$from.pos,new prosemirror_model_dist.Ji(frag,0,0));return tr.setSelection(dist.U3.near(tr.doc.resolve($from.pos+1))),view.dispatch(tr),!1}function drawGapCursor(state){if(!(state.selection instanceof GapCursor))return null;let node=document.createElement("div");return node.className="ProseMirror-gapcursor",prosemirror_view_dist.zF.create(state.doc,[prosemirror_view_dist.NZ.widget(state.selection.head,node,{key:"gapcursor"})])}function withMeta(plugin,meta){return Object.assign(plugin,{meta:{package:"@milkdown/plugin-cursor",...meta}}),plugin}const dropIndicatorState=(0,lib.Qx)(null,"dropIndicatorState");withMeta(dropIndicatorState,{displayName:"Ctx<dropIndicatorState>"});const dropIndicatorConfig=(0,lib.Qx)({width:2,color:!1,class:"milkdown-drop-indicator"},"dropIndicatorConfig");withMeta(dropIndicatorConfig,{displayName:"Ctx<dropIndicatorConfig>"});const key=new dist.hs("MILKDOWN_DROP_INDICATOR_DOM"),dropIndicatorDOMPlugin=(0,lib.Gf)(ctx=>new dist.k_({key,view:view=>{const config=ctx.get(dropIndicatorConfig.key),dom=document.createElement("div");Object.assign(dom.style,{position:"fixed",pointerEvents:"none",display:"none",backgroundColor:config.color,top:"0",left:"0"}),dom.classList.add(config.class),dom.classList.add("milkdown-drop-indicator"),view.dom.parentNode?.appendChild(dom);const stateSlice=ctx.use(dropIndicatorState.key),onUpdate=state=>{!function renderIndicator(dom,state,config){if(!state)return void Object.assign(dom.style,{display:"none"});const{line}=state,{width:lineWidth}=config,{p1:{x:x1,y:y1},p2:{x:x2,y:y2}}=line;let width,height,top=y1,left=x1;y1===y2?(width=x2-x1,height=lineWidth,top-=lineWidth/2):(width=lineWidth,height=y2-y1,left-=lineWidth/2);top=Math.round(top),left=Math.round(left),Object.assign(dom.style,{display:"block",width:`${width}px`,height:`${height}px`,transform:`translate(${left}px, ${top}px)`})}(dom,state,config)};return stateSlice.on(onUpdate),{destroy:()=>{stateSlice.off(onUpdate),dom.remove()}}}}));withMeta(dropIndicatorDOMPlugin,{displayName:"Prose<dropIndicatorDOM>"});const dropIndicatorPlugin=(0,lib.Gf)(ctx=>createDropIndicatorPlugin({onShow:options=>{ctx.set(dropIndicatorState.key,options)},onHide:()=>{ctx.set(dropIndicatorState.key,null)},onDrag:()=>!0}));withMeta(dropIndicatorPlugin,{displayName:"Prose<dropIndicator>"});const gapCursorPlugin=(0,lib.Gf)(()=>function gapCursor(){return new dist.k_({props:{decorations:drawGapCursor,createSelectionBetween:(_view,$anchor,$head)=>$anchor.pos==$head.pos&&GapCursor.valid($head)?new GapCursor($head):null,handleClick,handleKeyDown,handleDOMEvents:{beforeinput}}})}());withMeta(gapCursorPlugin,{displayName:"Prose<gapCursor>"});const cursor=[gapCursorPlugin,dropIndicatorConfig,dropIndicatorState,dropIndicatorDOMPlugin,dropIndicatorPlugin].flat()},"./node_modules/@milkdown/plugin-listener/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F_:()=>listener,Ob:()=>listenerCtx});var _milkdown_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@milkdown/core/lib/index.js"),_milkdown_ctx__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@milkdown/ctx/lib/index.js"),_milkdown_prose_state__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),lodash_es__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/lodash-es/debounce.js");class ListenerManager{constructor(){this.beforeMountedListeners=[],this.mountedListeners=[],this.updatedListeners=[],this.selectionUpdatedListeners=[],this.markdownUpdatedListeners=[],this.blurListeners=[],this.focusListeners=[],this.destroyListeners=[],this.beforeMount=fn=>(this.beforeMountedListeners.push(fn),this),this.mounted=fn=>(this.mountedListeners.push(fn),this),this.updated=fn=>(this.updatedListeners.push(fn),this)}get listeners(){return{beforeMount:this.beforeMountedListeners,mounted:this.mountedListeners,updated:this.updatedListeners,markdownUpdated:this.markdownUpdatedListeners,blur:this.blurListeners,focus:this.focusListeners,destroy:this.destroyListeners,selectionUpdated:this.selectionUpdatedListeners}}markdownUpdated(fn){return this.markdownUpdatedListeners.push(fn),this}blur(fn){return this.blurListeners.push(fn),this}focus(fn){return this.focusListeners.push(fn),this}destroy(fn){return this.destroyListeners.push(fn),this}selectionUpdated(fn){return this.selectionUpdatedListeners.push(fn),this}}const listenerCtx=(0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_1__.Z0)(new ListenerManager,"listener"),key=new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_2__.hs("MILKDOWN_LISTENER"),listener=ctx=>(ctx.inject(listenerCtx,new ListenerManager),async()=>{await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.ge);const listener2=ctx.get(listenerCtx),{listeners}=listener2;listeners.beforeMount.forEach(fn=>fn(ctx)),await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.g3);const serializer=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.M);let prevDoc=null,prevMarkdown=null,prevSelection=null;const plugin=new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_2__.k_({key,view:()=>({destroy:()=>{listeners.destroy.forEach(fn=>fn(ctx))}}),props:{handleDOMEvents:{focus:()=>(listeners.focus.forEach(fn=>fn(ctx)),!1),blur:()=>(listeners.blur.forEach(fn=>fn(ctx)),!1)}},state:{init:(_,instance)=>{prevDoc=instance.doc,prevMarkdown=serializer(instance.doc)},apply:tr=>{const currentSelection=tr.selection;if((!prevSelection&&currentSelection||prevSelection&&!currentSelection.eq(prevSelection))&&(listeners.selectionUpdated.forEach(fn=>{fn(ctx,currentSelection,prevSelection)}),prevSelection=currentSelection),!tr.docChanged||!1===tr.getMeta("addToHistory"))return;return(0,lodash_es__WEBPACK_IMPORTED_MODULE_3__.A)(()=>{const{doc}=tr;if(listeners.updated.length>0&&prevDoc&&!prevDoc.eq(doc)&&listeners.updated.forEach(fn=>{fn(ctx,doc,prevDoc)}),listeners.markdownUpdated.length>0&&prevDoc&&!prevDoc.eq(doc)){const markdown=serializer(doc);listeners.markdownUpdated.forEach(fn=>{fn(ctx,markdown,prevMarkdown)}),prevMarkdown=markdown}prevDoc=doc},200)()}}});ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.TP,x=>x.concat(plugin)),await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.CU),listeners.mounted.forEach(fn=>fn(ctx))});listener.meta={package:"@milkdown/plugin-listener",displayName:"Listener"}},"./node_modules/@milkdown/plugin-trailing/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N9:()=>trailingConfig,ZY:()=>trailing});var _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@milkdown/utils/lib/index.js");const trailingConfig=(0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.Qx)({shouldAppend:lastNode=>!!lastNode&&!["heading","paragraph"].includes(lastNode.type.name),getNode:state=>state.schema.nodes.paragraph.create()},"trailingConfig");trailingConfig.meta={package:"@milkdown/plugin-trailing",displayName:"Ctx<trailingConfig>"};const trailingPlugin=(0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.Gf)(ctx=>{const trailingPluginKey=new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_0__.hs("MILKDOWN_TRAILING"),{shouldAppend,getNode}=ctx.get(trailingConfig.key),plugin=new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_0__.k_({key:trailingPluginKey,state:{init:(_,state)=>{const lastNode=state.tr.doc.lastChild;return shouldAppend(lastNode,state)},apply:(tr,value,_,state)=>{if(!tr.docChanged)return value;const lastNode=tr.doc.lastChild;return shouldAppend(lastNode,state)}},appendTransaction:(_,__,state)=>{const{doc,tr}=state,nodeType=getNode?.(state),shouldInsertNodeAtEnd=plugin.getState(state),endPosition=doc.content.size;if(shouldInsertNodeAtEnd&&nodeType)return tr.insert(endPosition,nodeType)}});return plugin});trailingPlugin.meta={package:"@milkdown/plugin-trailing",displayName:"Prose<trailing>"};const trailing=[trailingConfig,trailingPlugin]},"./node_modules/@milkdown/plugin-upload/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Se:()=>upload,wu:()=>uploadConfig});var _milkdown_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@milkdown/core/lib/index.js"),_milkdown_prose_state__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),_milkdown_prose_view__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prosemirror-view/dist/index.js"),_milkdown_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@milkdown/utils/lib/index.js"),_milkdown_exception__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@milkdown/exception/lib/index.js");const uploadConfig=(0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_3__.Qx)({uploader:async(files,schema)=>{const imgs=[];for(let i=0;i<files.length;i++){const file=files.item(i);file&&(file.type.includes("image")&&imgs.push(file))}const{image}=schema.nodes;if(!image)throw(0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_4__.pj)("image");return(await Promise.all(imgs.map(img=>function readImageAsBase64(file){return new Promise(resolve=>{const reader=new FileReader;reader.addEventListener("load",()=>{resolve({alt:file.name,src:reader.result})},!1),reader.readAsDataURL(file)})}(img)))).map(({alt,src})=>image.createAndFill({src,alt}))},enableHtmlFileUploader:!1,uploadWidgetFactory:(pos,spec)=>{const widgetDOM=document.createElement("span");return widgetDOM.textContent="Upload in progress...",_milkdown_prose_view__WEBPACK_IMPORTED_MODULE_2__.NZ.widget(pos,widgetDOM,spec)}},"uploadConfig");uploadConfig.meta={package:"@milkdown/plugin-upload",displayName:"Ctx<uploadConfig>"};const uploadPlugin=(0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_3__.Gf)(ctx=>{const pluginKey=new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_1__.hs("MILKDOWN_UPLOAD"),handleUpload=(view,event,files)=>{if(!files||files.length<=0)return!1;const id=Symbol("upload symbol"),schema=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.pZ),{tr}=view.state,insertPos=event instanceof DragEvent?view.posAtCoords({left:event.clientX,top:event.clientY})?.pos??tr.selection.from:tr.selection.from;view.dispatch(tr.setMeta(pluginKey,{add:{id,pos:insertPos}}));const{uploader}=ctx.get(uploadConfig.key);return uploader(files,schema).then(fragment=>{const pos=((state,id)=>{const decorations=pluginKey.getState(state);if(!decorations)return-1;const found=decorations.find(void 0,void 0,spec=>spec.id===id);return found.length?found[0]?.from??-1:-1})(view.state,id);pos<0||view.dispatch(view.state.tr.replaceWith(pos,pos,fragment).setMeta(pluginKey,{remove:{id}}))}).catch(e=>{console.error(e)}),!0};return new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_1__.k_({key:pluginKey,state:{init:()=>_milkdown_prose_view__WEBPACK_IMPORTED_MODULE_2__.zF.empty,apply(tr,set){const _set=set.map(tr.mapping,tr.doc),action=tr.getMeta(this);if(!action)return _set;if(action.add){const{uploadWidgetFactory}=ctx.get(uploadConfig.key),decoration=uploadWidgetFactory(action.add.pos,{id:action.add.id});return _set.add(tr.doc,[decoration])}if(action.remove){const target=_set.find(void 0,void 0,spec=>spec.id===action.remove.id);return _set.remove(target)}return _set}},props:{decorations(state){return this.getState(state)},handlePaste:(view,event)=>{const{enableHtmlFileUploader}=ctx.get(uploadConfig.key);return event instanceof ClipboardEvent&&(!(!enableHtmlFileUploader&&event.clipboardData?.getData("text/html"))&&handleUpload(view,event,event.clipboardData?.files))},handleDrop:(view,event)=>event instanceof DragEvent&&handleUpload(view,event,event.dataTransfer?.files)}})});uploadPlugin.meta={package:"@milkdown/plugin-upload",displayName:"Prose<upload>"};const upload=[uploadConfig,uploadPlugin]},"./node_modules/@milkdown/preset-commonmark/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w4:()=>addBlockTypeCommand,JC:()=>blockquoteSchema,UM:()=>bulletListSchema,nx:()=>clearTextInCurrentBlockCommand,Ay:()=>codeBlockSchema,PD:()=>commonmark,Wm:()=>emphasisSchema,Y4:()=>headingSchema,Ab:()=>hrSchema,Fi:()=>imageSchema,Of:()=>inlineCodeSchema,Kf:()=>isMarkSelectedCommand,V4:()=>isNodeSelectedCommand,Yk:()=>linkSchema,hm:()=>listItemSchema,N:()=>orderedListSchema,Wf:()=>paragraphSchema,fI:()=>selectTextNearPosCommand,Pv:()=>setBlockTypeCommand,t6:()=>strongSchema,e0:()=>toggleEmphasisCommand,A:()=>toggleInlineCodeCommand,vY:()=>toggleStrongCommand,Qb:()=>wrapInBlockTypeCommand});var lib=__webpack_require__("./node_modules/@milkdown/prose/lib/index.js"),dist=__webpack_require__("./node_modules/prosemirror-model/dist/index.js"),prosemirror_state_dist=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),prosemirror_transform_dist=__webpack_require__("./node_modules/prosemirror-transform/dist/index.js"),utils_lib=__webpack_require__("./node_modules/@milkdown/utils/lib/index.js"),core_lib=__webpack_require__("./node_modules/@milkdown/core/lib/index.js"),prosemirror_commands_dist=__webpack_require__("./node_modules/prosemirror-commands/dist/index.js"),unist_util_visit_parents_lib=__webpack_require__("./node_modules/unist-util-visit-parents/lib/index.js"),exception_lib=__webpack_require__("./node_modules/@milkdown/exception/lib/index.js"),prosemirror_inputrules_dist=__webpack_require__("./node_modules/prosemirror-inputrules/dist/index.js");function splitListItem(itemType,itemAttrs){return function(state,dispatch){let{$from,$to,node}=state.selection;if(node&&node.isBlock||$from.depth<2||!$from.sameParent($to))return!1;let grandParent=$from.node(-1);if(grandParent.type!=itemType)return!1;if(0==$from.parent.content.size&&$from.node(-1).childCount==$from.indexAfter(-1)){if(3==$from.depth||$from.node(-3).type!=itemType||$from.index(-2)!=$from.node(-2).childCount-1)return!1;if(dispatch){let wrap=dist.FK.empty,depthBefore=$from.index(-1)?1:$from.index(-2)?2:3;for(let d=$from.depth-depthBefore;d>=$from.depth-3;d--)wrap=dist.FK.from($from.node(d).copy(wrap));let depthAfter=$from.indexAfter(-1)<$from.node(-2).childCount?1:$from.indexAfter(-2)<$from.node(-3).childCount?2:3;wrap=wrap.append(dist.FK.from(itemType.createAndFill()));let start=$from.before($from.depth-(depthBefore-1)),tr=state.tr.replace(start,$from.after(-depthAfter),new dist.Ji(wrap,4-depthBefore,0)),sel=-1;tr.doc.nodesBetween(start,tr.doc.content.size,(node,pos)=>{if(sel>-1)return!1;node.isTextblock&&0==node.content.size&&(sel=pos+1)}),sel>-1&&tr.setSelection(prosemirror_state_dist.LN.near(tr.doc.resolve(sel))),dispatch(tr.scrollIntoView())}return!0}let nextType=$to.pos==$from.end()?grandParent.contentMatchAt(0).defaultType:null,tr=state.tr.delete($from.pos,$to.pos),types=nextType?[itemAttrs?{type:itemType,attrs:itemAttrs}:null,{type:nextType}]:void 0;return!!(0,prosemirror_transform_dist.zy)(tr.doc,$from.pos,2,types)&&(dispatch&&dispatch(tr.split($from.pos,2,types).scrollIntoView()),!0)}}function liftListItem(itemType){return function(state,dispatch){let{$from,$to}=state.selection,range=$from.blockRange($to,node=>node.childCount>0&&node.firstChild.type==itemType);return!!range&&(!dispatch||($from.node(range.depth-1).type==itemType?function liftToOuterList(state,dispatch,itemType,range){let tr=state.tr,end=range.end,endOfList=range.$to.end(range.depth);end<endOfList&&(tr.step(new prosemirror_transform_dist.Wg(end-1,endOfList,end,endOfList,new dist.Ji(dist.FK.from(itemType.create(null,range.parent.copy())),1,0),1,!0)),range=new dist.u$(tr.doc.resolve(range.$from.pos),tr.doc.resolve(endOfList),range.depth));const target=(0,prosemirror_transform_dist.jP)(range);if(null==target)return!1;tr.lift(range,target);let $after=tr.doc.resolve(tr.mapping.map(end,-1)-1);(0,prosemirror_transform_dist.n9)(tr.doc,$after.pos)&&$after.nodeBefore.type==$after.nodeAfter.type&&tr.join($after.pos);return dispatch(tr.scrollIntoView()),!0}(state,dispatch,itemType,range):function liftOutOfList(state,dispatch,range){let tr=state.tr,list=range.parent;for(let pos=range.end,i=range.endIndex-1,e=range.startIndex;i>e;i--)pos-=list.child(i).nodeSize,tr.delete(pos-1,pos+1);let $start=tr.doc.resolve(range.start),item=$start.nodeAfter;if(tr.mapping.map(range.end)!=range.start+$start.nodeAfter.nodeSize)return!1;let atStart=0==range.startIndex,atEnd=range.endIndex==list.childCount,parent=$start.node(-1),indexBefore=$start.index(-1);if(!parent.canReplace(indexBefore+(atStart?0:1),indexBefore+1,item.content.append(atEnd?dist.FK.empty:dist.FK.from(list))))return!1;let start=$start.pos,end=start+item.nodeSize;return tr.step(new prosemirror_transform_dist.Wg(start-(atStart?1:0),end+(atEnd?1:0),start+1,end-1,new dist.Ji((atStart?dist.FK.empty:dist.FK.from(list.copy(dist.FK.empty))).append(atEnd?dist.FK.empty:dist.FK.from(list.copy(dist.FK.empty))),atStart?0:1,atEnd?0:1),atStart?0:1)),dispatch(tr.scrollIntoView()),!0}(state,dispatch,range)))}}var prosemirror_view_dist=__webpack_require__("./node_modules/prosemirror-view/dist/index.js"),unist_util_visit_lib=__webpack_require__("./node_modules/unist-util-visit/lib/index.js");function clean(value){return String(value||"").toUpperCase()}function remarkInlineLinks(){return function(tree){const definition=function definitions(tree){const cache=new Map;if(!tree||!tree.type)throw new Error("mdast-util-definitions expected node");return(0,unist_util_visit_lib.YR)(tree,"definition",function(definition){const id=clean(definition.identifier);id&&!cache.get(id)&&cache.set(id,definition)}),function definition(identifier){const id=clean(identifier);return cache.get(id)}}(tree);(0,unist_util_visit_lib.YR)(tree,function(node,index,parent){if("definition"===node.type&&void 0!==parent&&"number"==typeof index)return parent.children.splice(index,1),[unist_util_visit_parents_lib._Z,index];if("imageReference"===node.type||"linkReference"===node.type){const def=definition(node.identifier);if(def&&parent&&"number"==typeof index)return parent.children[index]="imageReference"===node.type?{type:"image",url:def.url,title:def.title,alt:node.alt}:{type:"link",url:def.url,title:def.title,children:node.children},[unist_util_visit_parents_lib._Z,index]}})}}function serializeText(state,node){if(!(node.childCount>=1&&"hardbreak"===node.lastChild?.type.name))return void state.next(node.content);const contentArr=[];node.content.forEach((n,_,i)=>{i!==node.childCount-1&&contentArr.push(n)}),state.next(dist.FK.fromArray(contentArr))}function withMeta(plugin,meta){return Object.assign(plugin,{meta:{package:"@milkdown/preset-commonmark",...meta}}),plugin}const emphasisAttr=(0,utils_lib.JY)("emphasis");withMeta(emphasisAttr,{displayName:"Attr<emphasis>",group:"Emphasis"});const emphasisSchema=(0,utils_lib.hk)("emphasis",ctx=>({attrs:{marker:{default:ctx.get(core_lib.P5).emphasis||"*",validate:"string"}},parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:value=>"italic"===value}],toDOM:mark=>["em",ctx.get(emphasisAttr.key)(mark)],parseMarkdown:{match:node=>"emphasis"===node.type,runner:(state,node,markType)=>{state.openMark(markType,{marker:node.marker}),state.next(node.children),state.closeMark(markType)}},toMarkdown:{match:mark=>"emphasis"===mark.type.name,runner:(state,mark)=>{state.withMark(mark,"emphasis",void 0,{marker:mark.attrs.marker})}}}));withMeta(emphasisSchema.mark,{displayName:"MarkSchema<emphasis>",group:"Emphasis"}),withMeta(emphasisSchema.ctx,{displayName:"MarkSchemaCtx<emphasis>",group:"Emphasis"});const toggleEmphasisCommand=(0,utils_lib.yu)("ToggleEmphasis",ctx=>()=>(0,prosemirror_commands_dist.wh)(emphasisSchema.type(ctx)));withMeta(toggleEmphasisCommand,{displayName:"Command<toggleEmphasisCommand>",group:"Emphasis"});const emphasisStarInputRule=(0,utils_lib.b_)(ctx=>(0,lib.uX)(/(?:^|[^*])\*([^*]+)\*$/,emphasisSchema.type(ctx),{getAttr:()=>({marker:"*"}),updateCaptured:({fullMatch,start})=>fullMatch.startsWith("*")?{}:{fullMatch:fullMatch.slice(1),start:start+1}}));withMeta(emphasisStarInputRule,{displayName:"InputRule<emphasis>|Star",group:"Emphasis"});const emphasisUnderscoreInputRule=(0,utils_lib.b_)(ctx=>(0,lib.uX)(/\b_(?![_\s])(.*?[^_\s])_\b/,emphasisSchema.type(ctx),{getAttr:()=>({marker:"_"}),updateCaptured:({fullMatch,start})=>fullMatch.startsWith("_")?{}:{fullMatch:fullMatch.slice(1),start:start+1}}));withMeta(emphasisUnderscoreInputRule,{displayName:"InputRule<emphasis>|Underscore",group:"Emphasis"});const emphasisKeymap=(0,utils_lib.pq)("emphasisKeymap",{ToggleEmphasis:{shortcuts:"Mod-i",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(toggleEmphasisCommand.key)}}});withMeta(emphasisKeymap.ctx,{displayName:"KeymapCtx<emphasis>",group:"Emphasis"}),withMeta(emphasisKeymap.shortcuts,{displayName:"Keymap<emphasis>",group:"Emphasis"});const strongAttr=(0,utils_lib.JY)("strong");withMeta(strongAttr,{displayName:"Attr<strong>",group:"Strong"});const strongSchema=(0,utils_lib.hk)("strong",ctx=>({attrs:{marker:{default:ctx.get(core_lib.P5).strong||"*",validate:"string"}},parseDOM:[{tag:"b",getAttrs:node=>"normal"!=node.style.fontWeight&&null},{tag:"strong"},{style:"font-style",getAttrs:value=>"bold"===value},{style:"font-weight=400",clearMark:m=>"strong"==m.type.name},{style:"font-weight",getAttrs:value=>/^(bold(er)?|[5-9]\d{2,})$/.test(value)&&null}],toDOM:mark=>["strong",ctx.get(strongAttr.key)(mark)],parseMarkdown:{match:node=>"strong"===node.type,runner:(state,node,markType)=>{state.openMark(markType,{marker:node.marker}),state.next(node.children),state.closeMark(markType)}},toMarkdown:{match:mark=>"strong"===mark.type.name,runner:(state,mark)=>{state.withMark(mark,"strong",void 0,{marker:mark.attrs.marker})}}}));withMeta(strongSchema.mark,{displayName:"MarkSchema<strong>",group:"Strong"}),withMeta(strongSchema.ctx,{displayName:"MarkSchemaCtx<strong>",group:"Strong"});const toggleStrongCommand=(0,utils_lib.yu)("ToggleStrong",ctx=>()=>(0,prosemirror_commands_dist.wh)(strongSchema.type(ctx)));withMeta(toggleStrongCommand,{displayName:"Command<toggleStrongCommand>",group:"Strong"});const strongInputRule=(0,utils_lib.b_)(ctx=>(0,lib.uX)(new RegExp("(?<![\\w:/])(?:\\*\\*|__)([^*_]+?)(?:\\*\\*|__)(?![\\w/])$"),strongSchema.type(ctx),{getAttr:match=>({marker:match[0].startsWith("*")?"*":"_"})}));withMeta(strongInputRule,{displayName:"InputRule<strong>",group:"Strong"});const strongKeymap=(0,utils_lib.pq)("strongKeymap",{ToggleBold:{shortcuts:["Mod-b"],command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(toggleStrongCommand.key)}}});withMeta(strongKeymap.ctx,{displayName:"KeymapCtx<strong>",group:"Strong"}),withMeta(strongKeymap.shortcuts,{displayName:"Keymap<strong>",group:"Strong"});const inlineCodeAttr=(0,utils_lib.JY)("inlineCode");withMeta(inlineCodeAttr,{displayName:"Attr<inlineCode>",group:"InlineCode"});const inlineCodeSchema=(0,utils_lib.hk)("inlineCode",ctx=>({priority:100,code:!0,parseDOM:[{tag:"code"}],toDOM:mark=>["code",ctx.get(inlineCodeAttr.key)(mark)],parseMarkdown:{match:node=>"inlineCode"===node.type,runner:(state,node,markType)=>{state.openMark(markType),state.addText(node.value),state.closeMark(markType)}},toMarkdown:{match:mark=>"inlineCode"===mark.type.name,runner:(state,mark,node)=>{state.withMark(mark,"inlineCode",node.text||"")}}}));withMeta(inlineCodeSchema.mark,{displayName:"MarkSchema<inlineCode>",group:"InlineCode"}),withMeta(inlineCodeSchema.ctx,{displayName:"MarkSchemaCtx<inlineCode>",group:"InlineCode"});const toggleInlineCodeCommand=(0,utils_lib.yu)("ToggleInlineCode",ctx=>()=>(state,dispatch)=>{const{selection,tr}=state;if(selection.empty)return!1;const{from,to}=selection;if(state.doc.rangeHasMark(from,to,inlineCodeSchema.type(ctx)))return dispatch?.(tr.removeMark(from,to,inlineCodeSchema.type(ctx))),!0;return Object.keys(state.schema.marks).filter(x=>x!==inlineCodeSchema.type.name).map(name=>state.schema.marks[name]).forEach(t=>{tr.removeMark(from,to,t)}),dispatch?.(tr.addMark(from,to,inlineCodeSchema.type(ctx).create())),!0});withMeta(toggleInlineCodeCommand,{displayName:"Command<toggleInlineCodeCommand>",group:"InlineCode"});const inlineCodeInputRule=(0,utils_lib.b_)(ctx=>(0,lib.uX)(/(?:`)([^`]+)(?:`)$/,inlineCodeSchema.type(ctx)));withMeta(inlineCodeInputRule,{displayName:"InputRule<inlineCodeInputRule>",group:"InlineCode"});const inlineCodeKeymap=(0,utils_lib.pq)("inlineCodeKeymap",{ToggleInlineCode:{shortcuts:"Mod-e",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(toggleInlineCodeCommand.key)}}});withMeta(inlineCodeKeymap.ctx,{displayName:"KeymapCtx<inlineCode>",group:"InlineCode"}),withMeta(inlineCodeKeymap.shortcuts,{displayName:"Keymap<inlineCode>",group:"InlineCode"});const linkAttr=(0,utils_lib.JY)("link");withMeta(linkAttr,{displayName:"Attr<link>",group:"Link"});const linkSchema=(0,utils_lib.hk)("link",ctx=>({attrs:{href:{validate:"string"},title:{default:null,validate:"string|null"}},parseDOM:[{tag:"a[href]",getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{href:dom.getAttribute("href"),title:dom.getAttribute("title")}}}],toDOM:mark=>["a",{...ctx.get(linkAttr.key)(mark),...mark.attrs}],parseMarkdown:{match:node=>"link"===node.type,runner:(state,node,markType)=>{const url=node.url,title=node.title;state.openMark(markType,{href:url,title}),state.next(node.children),state.closeMark(markType)}},toMarkdown:{match:mark=>"link"===mark.type.name,runner:(state,mark)=>{state.withMark(mark,"link",void 0,{title:mark.attrs.title,url:mark.attrs.href})}}}));withMeta(linkSchema.mark,{displayName:"MarkSchema<link>",group:"Link"});const toggleLinkCommand=(0,utils_lib.yu)("ToggleLink",ctx=>(payload={})=>(0,prosemirror_commands_dist.wh)(linkSchema.type(ctx),payload));withMeta(toggleLinkCommand,{displayName:"Command<toggleLinkCommand>",group:"Link"});const updateLinkCommand=(0,utils_lib.yu)("UpdateLink",ctx=>(payload={})=>(state,dispatch)=>{if(!dispatch)return!1;let node,pos=-1;const{selection}=state,{from,to}=selection;if(state.doc.nodesBetween(from,from===to?to+1:to,(n,p)=>{if(linkSchema.type(ctx).isInSet(n.marks))return node=n,pos=p,!1}),!node)return!1;const mark=node.marks.find(({type})=>type===linkSchema.type(ctx));if(!mark)return!1;const start=pos,end=pos+node.nodeSize,{tr}=state,linkMark=linkSchema.type(ctx).create({...mark.attrs,...payload});return!!linkMark&&(dispatch(tr.removeMark(start,end,mark).addMark(start,end,linkMark).setSelection(new prosemirror_state_dist.U3(tr.selection.$anchor)).scrollIntoView()),!0)});withMeta(updateLinkCommand,{displayName:"Command<updateLinkCommand>",group:"Link"});const docSchema=(0,utils_lib.dz)("doc",()=>({content:"block+",parseMarkdown:{match:({type})=>"root"===type,runner:(state,node,type)=>{state.injectRoot(node,type)}},toMarkdown:{match:node=>"doc"===node.type.name,runner:(state,node)=>{state.openNode("root"),state.next(node.content)}}}));function visitEmptyLine(ast){return(0,unist_util_visit_parents_lib.VG)(ast,node=>"html"===node.type&&["<br />","<br>","<br >","<br/>"].includes(node.value?.trim()),(node,parents)=>{if(!parents.length)return;const parent=parents[parents.length-1];if(!parent)return;const index=parent.children.indexOf(node);-1!==index&&parent.children.splice(index,1)},!0)}withMeta(docSchema,{displayName:"NodeSchema<doc>",group:"Doc"});const remarkPreserveEmptyLinePlugin=(0,utils_lib.lz)("remark-preserve-empty-line",()=>()=>visitEmptyLine);withMeta(remarkPreserveEmptyLinePlugin.plugin,{displayName:"Remark<remarkPreserveEmptyLine>",group:"Remark"}),withMeta(remarkPreserveEmptyLinePlugin.options,{displayName:"RemarkConfig<remarkPreserveEmptyLine>",group:"Remark"});const paragraphAttr=(0,utils_lib.YR)("paragraph");withMeta(paragraphAttr,{displayName:"Attr<paragraph>",group:"Paragraph"});const paragraphSchema=(0,utils_lib.Yh)("paragraph",ctx=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:node=>["p",ctx.get(paragraphAttr.key)(node),0],parseMarkdown:{match:node=>"paragraph"===node.type,runner:(state,node,type)=>{state.openNode(type),node.children?state.next(node.children):state.addText(node.value||""),state.closeNode()}},toMarkdown:{match:node=>"paragraph"===node.type.name,runner:(state,node)=>{const view=ctx.get(core_lib.kY),lastNode=view.state?.doc.lastChild;state.openNode("paragraph"),node.content&&0!==node.content.size||node===lastNode||!function shouldPreserveEmptyLine(ctx){let shouldPreserveEmptyLine2=!1;try{ctx.get(remarkPreserveEmptyLinePlugin.id),shouldPreserveEmptyLine2=!0}catch{shouldPreserveEmptyLine2=!1}return shouldPreserveEmptyLine2}(ctx)?serializeText(state,node):state.addNode("html",void 0,"<br />"),state.closeNode()}}}));withMeta(paragraphSchema.node,{displayName:"NodeSchema<paragraph>",group:"Paragraph"}),withMeta(paragraphSchema.ctx,{displayName:"NodeSchemaCtx<paragraph>",group:"Paragraph"});const turnIntoTextCommand=(0,utils_lib.yu)("TurnIntoText",ctx=>()=>(0,prosemirror_commands_dist.y_)(paragraphSchema.type(ctx)));withMeta(turnIntoTextCommand,{displayName:"Command<turnIntoTextCommand>",group:"Paragraph"});const paragraphKeymap=(0,utils_lib.pq)("paragraphKeymap",{TurnIntoText:{shortcuts:"Mod-Alt-0",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(turnIntoTextCommand.key)}}});withMeta(paragraphKeymap.ctx,{displayName:"KeymapCtx<paragraph>",group:"Paragraph"}),withMeta(paragraphKeymap.shortcuts,{displayName:"Keymap<paragraph>",group:"Paragraph"});const headingIndex=Array(6).fill(0).map((_,i)=>i+1);const headingIdGenerator=(0,utils_lib.Qx)(function defaultHeadingIdGenerator(node){return node.textContent.toLowerCase().trim().replace(/\s+/g,"-")},"headingIdGenerator");withMeta(headingIdGenerator,{displayName:"Ctx<HeadingIdGenerator>",group:"Heading"});const headingAttr=(0,utils_lib.YR)("heading");withMeta(headingAttr,{displayName:"Attr<heading>",group:"Heading"});const headingSchema=(0,utils_lib.Yh)("heading",ctx=>{const getId=ctx.get(headingIdGenerator.key);return{content:"inline*",group:"block",defining:!0,attrs:{id:{default:"",validate:"string"},level:{default:1,validate:"number"}},parseDOM:headingIndex.map(x=>({tag:`h${x}`,getAttrs:node=>{if(!(node instanceof HTMLElement))throw(0,exception_lib.Ik)(node);return{level:x,id:node.id}}})),toDOM:node=>[`h${node.attrs.level}`,{...ctx.get(headingAttr.key)(node),id:node.attrs.id||getId(node)},0],parseMarkdown:{match:({type})=>"heading"===type,runner:(state,node,type)=>{const depth=node.depth;state.openNode(type,{level:depth}),state.next(node.children),state.closeNode()}},toMarkdown:{match:node=>"heading"===node.type.name,runner:(state,node)=>{state.openNode("heading",void 0,{depth:node.attrs.level}),serializeText(state,node),state.closeNode()}}}});withMeta(headingSchema.node,{displayName:"NodeSchema<heading>",group:"Heading"}),withMeta(headingSchema.ctx,{displayName:"NodeSchemaCtx<heading>",group:"Heading"});const wrapInHeadingInputRule=(0,utils_lib.b_)(ctx=>(0,prosemirror_inputrules_dist.JJ)(/^(?<hashes>#+)\s$/,headingSchema.type(ctx),match=>{const x=match.groups?.hashes?.length||0,view=ctx.get(core_lib.kY),{$from}=view.state.selection,node=$from.node();if("heading"===node.type.name){let level=Number(node.attrs.level)+Number(x);return level>6&&(level=6),{level}}return{level:x}}));withMeta(wrapInHeadingInputRule,{displayName:"InputRule<wrapInHeadingInputRule>",group:"Heading"});const wrapInHeadingCommand=(0,utils_lib.yu)("WrapInHeading",ctx=>level=>(level??=1,level<1?(0,prosemirror_commands_dist.y_)(paragraphSchema.type(ctx)):(0,prosemirror_commands_dist.y_)(headingSchema.type(ctx),{level})));withMeta(wrapInHeadingCommand,{displayName:"Command<wrapInHeadingCommand>",group:"Heading"});const downgradeHeadingCommand=(0,utils_lib.yu)("DowngradeHeading",ctx=>()=>(state,dispatch,view)=>{const{$from}=state.selection,node=$from.node();if(node.type!==headingSchema.type(ctx)||!state.selection.empty||0!==$from.parentOffset)return!1;const level=node.attrs.level-1;return level?(dispatch?.(state.tr.setNodeMarkup(state.selection.$from.before(),void 0,{...node.attrs,level})),!0):(0,prosemirror_commands_dist.y_)(paragraphSchema.type(ctx))(state,dispatch,view)});withMeta(downgradeHeadingCommand,{displayName:"Command<downgradeHeadingCommand>",group:"Heading"});const headingKeymap=(0,utils_lib.pq)("headingKeymap",{TurnIntoH1:{shortcuts:"Mod-Alt-1",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInHeadingCommand.key,1)}},TurnIntoH2:{shortcuts:"Mod-Alt-2",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInHeadingCommand.key,2)}},TurnIntoH3:{shortcuts:"Mod-Alt-3",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInHeadingCommand.key,3)}},TurnIntoH4:{shortcuts:"Mod-Alt-4",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInHeadingCommand.key,4)}},TurnIntoH5:{shortcuts:"Mod-Alt-5",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInHeadingCommand.key,5)}},TurnIntoH6:{shortcuts:"Mod-Alt-6",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInHeadingCommand.key,6)}},DowngradeHeading:{shortcuts:["Delete","Backspace"],command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(downgradeHeadingCommand.key)}}});withMeta(headingKeymap.ctx,{displayName:"KeymapCtx<heading>",group:"Heading"}),withMeta(headingKeymap.shortcuts,{displayName:"Keymap<heading>",group:"Heading"});const blockquoteAttr=(0,utils_lib.YR)("blockquote");withMeta(blockquoteAttr,{displayName:"Attr<blockquote>",group:"Blockquote"});const blockquoteSchema=(0,utils_lib.Yh)("blockquote",ctx=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:node=>["blockquote",ctx.get(blockquoteAttr.key)(node),0],parseMarkdown:{match:({type})=>"blockquote"===type,runner:(state,node,type)=>{state.openNode(type).next(node.children).closeNode()}},toMarkdown:{match:node=>"blockquote"===node.type.name,runner:(state,node)=>{state.openNode("blockquote").next(node.content).closeNode()}}}));withMeta(blockquoteSchema.node,{displayName:"NodeSchema<blockquote>",group:"Blockquote"}),withMeta(blockquoteSchema.ctx,{displayName:"NodeSchemaCtx<blockquote>",group:"Blockquote"});const wrapInBlockquoteInputRule=(0,utils_lib.b_)(ctx=>(0,prosemirror_inputrules_dist.tG)(/^\s*>\s$/,blockquoteSchema.type(ctx)));withMeta(wrapInBlockquoteInputRule,{displayName:"InputRule<wrapInBlockquoteInputRule>",group:"Blockquote"});const wrapInBlockquoteCommand=(0,utils_lib.yu)("WrapInBlockquote",ctx=>()=>(0,prosemirror_commands_dist.Im)(blockquoteSchema.type(ctx)));withMeta(wrapInBlockquoteCommand,{displayName:"Command<wrapInBlockquoteCommand>",group:"Blockquote"});const blockquoteKeymap=(0,utils_lib.pq)("blockquoteKeymap",{WrapInBlockquote:{shortcuts:"Mod-Shift-b",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInBlockquoteCommand.key)}}});withMeta(blockquoteKeymap.ctx,{displayName:"KeymapCtx<blockquote>",group:"Blockquote"}),withMeta(blockquoteKeymap.shortcuts,{displayName:"Keymap<blockquote>",group:"Blockquote"});const codeBlockAttr=(0,utils_lib.YR)("codeBlock",()=>({pre:{},code:{}}));withMeta(codeBlockAttr,{displayName:"Attr<codeBlock>",group:"CodeBlock"});const codeBlockSchema=(0,utils_lib.Yh)("code_block",ctx=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:"",validate:"string"}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{language:dom.dataset.language}}}],toDOM:node=>{const attr=ctx.get(codeBlockAttr.key)(node),language=node.attrs.language,languageAttrs=language&&language.length>0?{"data-language":language}:void 0;return["pre",{...attr.pre,...languageAttrs},["code",attr.code,0]]},parseMarkdown:{match:({type})=>"code"===type,runner:(state,node,type)=>{const language=node.lang??"",value=node.value;state.openNode(type,{language}),value&&state.addText(value),state.closeNode()}},toMarkdown:{match:node=>"code_block"===node.type.name,runner:(state,node)=>{state.addNode("code",void 0,node.content.firstChild?.text||"",{lang:node.attrs.language})}}}));withMeta(codeBlockSchema.node,{displayName:"NodeSchema<codeBlock>",group:"CodeBlock"}),withMeta(codeBlockSchema.ctx,{displayName:"NodeSchemaCtx<codeBlock>",group:"CodeBlock"});const createCodeBlockInputRule=(0,utils_lib.b_)(ctx=>(0,prosemirror_inputrules_dist.JJ)(/^```(?<language>[a-z]*)?[\s\n]$/,codeBlockSchema.type(ctx),match=>({language:match.groups?.language??""})));withMeta(createCodeBlockInputRule,{displayName:"InputRule<createCodeBlockInputRule>",group:"CodeBlock"});const createCodeBlockCommand=(0,utils_lib.yu)("CreateCodeBlock",ctx=>(language="")=>(0,prosemirror_commands_dist.y_)(codeBlockSchema.type(ctx),{language}));withMeta(createCodeBlockCommand,{displayName:"Command<createCodeBlockCommand>",group:"CodeBlock"});withMeta((0,utils_lib.yu)("UpdateCodeBlockLanguage",()=>({pos,language}={pos:-1,language:""})=>(state,dispatch)=>pos>=0&&(dispatch?.(state.tr.setNodeAttribute(pos,"language",language)),!0)),{displayName:"Command<updateCodeBlockLanguageCommand>",group:"CodeBlock"});const codeBlockKeymap=(0,utils_lib.pq)("codeBlockKeymap",{CreateCodeBlock:{shortcuts:"Mod-Alt-c",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(createCodeBlockCommand.key)}}});withMeta(codeBlockKeymap.ctx,{displayName:"KeymapCtx<codeBlock>",group:"CodeBlock"}),withMeta(codeBlockKeymap.shortcuts,{displayName:"Keymap<codeBlock>",group:"CodeBlock"});const imageAttr=(0,utils_lib.YR)("image");withMeta(imageAttr,{displayName:"Attr<image>",group:"Image"});const imageSchema=(0,utils_lib.Yh)("image",ctx=>({inline:!0,group:"inline",selectable:!0,draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:"",validate:"string"},alt:{default:"",validate:"string"},title:{default:"",validate:"string"}},parseDOM:[{tag:"img[src]",getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{src:dom.getAttribute("src")||"",alt:dom.getAttribute("alt")||"",title:dom.getAttribute("title")||dom.getAttribute("alt")||""}}}],toDOM:node=>["img",{...ctx.get(imageAttr.key)(node),...node.attrs}],parseMarkdown:{match:({type})=>"image"===type,runner:(state,node,type)=>{const url=node.url,alt=node.alt,title=node.title;state.addNode(type,{src:url,alt,title})}},toMarkdown:{match:node=>"image"===node.type.name,runner:(state,node)=>{state.addNode("image",void 0,void 0,{title:node.attrs.title,url:node.attrs.src,alt:node.attrs.alt})}}}));withMeta(imageSchema.node,{displayName:"NodeSchema<image>",group:"Image"}),withMeta(imageSchema.ctx,{displayName:"NodeSchemaCtx<image>",group:"Image"});const insertImageCommand=(0,utils_lib.yu)("InsertImage",ctx=>(payload={})=>(state,dispatch)=>{if(!dispatch)return!0;const{src="",alt="",title=""}=payload,node=imageSchema.type(ctx).create({src,alt,title});return!node||(dispatch(state.tr.replaceSelectionWith(node).scrollIntoView()),!0)});withMeta(insertImageCommand,{displayName:"Command<insertImageCommand>",group:"Image"});const updateImageCommand=(0,utils_lib.yu)("UpdateImage",ctx=>(payload={})=>(state,dispatch)=>{const nodeWithPos=(0,lib.UM)(state.selection,imageSchema.type(ctx));if(!nodeWithPos)return!1;const{node,pos}=nodeWithPos,newAttrs={...node.attrs},{src,alt,title}=payload;return void 0!==src&&(newAttrs.src=src),void 0!==alt&&(newAttrs.alt=alt),void 0!==title&&(newAttrs.title=title),dispatch?.(state.tr.setNodeMarkup(pos,void 0,newAttrs).scrollIntoView()),!0});withMeta(updateImageCommand,{displayName:"Command<updateImageCommand>",group:"Image"});withMeta((0,utils_lib.b_)(ctx=>new prosemirror_inputrules_dist.fV(/!\[(?<alt>.*?)]\((?<filename>.*?)\s*(?="|\))"?(?<title>[^"]+)?"?\)/,(state,match,start,end)=>{const[matched,alt,src="",title]=match;return matched?state.tr.replaceWith(start,end,imageSchema.type(ctx).create({src,alt,title})):null})),{displayName:"InputRule<insertImageInputRule>",group:"Image"});const hardbreakAttr=(0,utils_lib.YR)("hardbreak",node=>({"data-type":"hardbreak","data-is-inline":node.attrs.isInline}));withMeta(hardbreakAttr,{displayName:"Attr<hardbreak>",group:"Hardbreak"});const hardbreakSchema=(0,utils_lib.Yh)("hardbreak",ctx=>({inline:!0,group:"inline",attrs:{isInline:{default:!1,validate:"boolean"}},selectable:!1,parseDOM:[{tag:"br"},{tag:'span[data-type="hardbreak"]',getAttrs:()=>({isInline:!0})}],toDOM:node=>node.attrs.isInline?["span",ctx.get(hardbreakAttr.key)(node)," "]:["br",ctx.get(hardbreakAttr.key)(node)],parseMarkdown:{match:({type})=>"break"===type,runner:(state,node,type)=>{state.addNode(type,{isInline:Boolean(node.data?.isInline)})}},leafText:()=>"\n",toMarkdown:{match:node=>"hardbreak"===node.type.name,runner:(state,node)=>{node.attrs.isInline?state.addNode("text",void 0,"\n"):state.addNode("break")}}}));withMeta(hardbreakSchema.node,{displayName:"NodeSchema<hardbreak>",group:"Hardbreak"}),withMeta(hardbreakSchema.ctx,{displayName:"NodeSchemaCtx<hardbreak>",group:"Hardbreak"});const insertHardbreakCommand=(0,utils_lib.yu)("InsertHardbreak",ctx=>()=>(state,dispatch)=>{const{selection,tr}=state;if(!(selection instanceof prosemirror_state_dist.U3))return!1;if(selection.empty){const node=selection.$from.node();if(node.childCount>0&&"hardbreak"===node.lastChild?.type.name)return dispatch?.(tr.replaceRangeWith(selection.to-1,selection.to,state.schema.node("paragraph")).setSelection(prosemirror_state_dist.LN.near(tr.doc.resolve(selection.to))).scrollIntoView()),!0}return dispatch?.(tr.setMeta("hardbreak",!0).replaceSelectionWith(hardbreakSchema.type(ctx).create()).scrollIntoView()),!0});withMeta(insertHardbreakCommand,{displayName:"Command<insertHardbreakCommand>",group:"Hardbreak"});const hardbreakKeymap=(0,utils_lib.pq)("hardbreakKeymap",{InsertHardbreak:{shortcuts:"Shift-Enter",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(insertHardbreakCommand.key)}}});withMeta(hardbreakKeymap.ctx,{displayName:"KeymapCtx<hardbreak>",group:"Hardbreak"}),withMeta(hardbreakKeymap.shortcuts,{displayName:"Keymap<hardbreak>",group:"Hardbreak"});const hrAttr=(0,utils_lib.YR)("hr");withMeta(hrAttr,{displayName:"Attr<hr>",group:"Hr"});const hrSchema=(0,utils_lib.Yh)("hr",ctx=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:node=>["hr",ctx.get(hrAttr.key)(node)],parseMarkdown:{match:({type})=>"thematicBreak"===type,runner:(state,_,type)=>{state.addNode(type)}},toMarkdown:{match:node=>"hr"===node.type.name,runner:state=>{state.addNode("thematicBreak")}}}));withMeta(hrSchema.node,{displayName:"NodeSchema<hr>",group:"Hr"}),withMeta(hrSchema.ctx,{displayName:"NodeSchemaCtx<hr>",group:"Hr"});const insertHrInputRule=(0,utils_lib.b_)(ctx=>new prosemirror_inputrules_dist.fV(/^(?:---|___\s|\*\*\*\s)$/,(state,match,start,end)=>{const{tr}=state;return match[0]&&tr.replaceWith(start-1,end,hrSchema.type(ctx).create()),tr}));withMeta(insertHrInputRule,{displayName:"InputRule<insertHrInputRule>",group:"Hr"});const insertHrCommand=(0,utils_lib.yu)("InsertHr",ctx=>()=>(state,dispatch)=>{if(!dispatch)return!0;const paragraph=paragraphSchema.node.type(ctx).create(),{tr,selection}=state,{from}=selection,node=hrSchema.type(ctx).create();if(!node)return!0;const _tr=tr.replaceSelectionWith(node).insert(from,paragraph),sel=prosemirror_state_dist.LN.findFrom(_tr.doc.resolve(from),1,!0);return!sel||(dispatch(_tr.setSelection(sel).scrollIntoView()),!0)});withMeta(insertHrCommand,{displayName:"Command<insertHrCommand>",group:"Hr"});const bulletListAttr=(0,utils_lib.YR)("bulletList");withMeta(bulletListAttr,{displayName:"Attr<bulletList>",group:"BulletList"});const bulletListSchema=(0,utils_lib.Yh)("bullet_list",ctx=>({content:"listItem+",group:"block",attrs:{spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ul",getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{spread:"true"===dom.dataset.spread}}}],toDOM:node=>["ul",{...ctx.get(bulletListAttr.key)(node),"data-spread":node.attrs.spread},0],parseMarkdown:{match:({type,ordered})=>"list"===type&&!ordered,runner:(state,node,type)=>{const spread=null!=node.spread?`${node.spread}`:"false";state.openNode(type,{spread}).next(node.children).closeNode()}},toMarkdown:{match:node=>"bullet_list"===node.type.name,runner:(state,node)=>{state.openNode("list",void 0,{ordered:!1,spread:node.attrs.spread}).next(node.content).closeNode()}}}));withMeta(bulletListSchema.node,{displayName:"NodeSchema<bulletList>",group:"BulletList"}),withMeta(bulletListSchema.ctx,{displayName:"NodeSchemaCtx<bulletList>",group:"BulletList"});const wrapInBulletListInputRule=(0,utils_lib.b_)(ctx=>(0,prosemirror_inputrules_dist.tG)(/^\s*([-+*])\s$/,bulletListSchema.type(ctx)));withMeta(wrapInBulletListInputRule,{displayName:"InputRule<wrapInBulletListInputRule>",group:"BulletList"});const wrapInBulletListCommand=(0,utils_lib.yu)("WrapInBulletList",ctx=>()=>(0,prosemirror_commands_dist.Im)(bulletListSchema.type(ctx)));withMeta(wrapInBulletListCommand,{displayName:"Command<wrapInBulletListCommand>",group:"BulletList"});const bulletListKeymap=(0,utils_lib.pq)("bulletListKeymap",{WrapInBulletList:{shortcuts:"Mod-Alt-8",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInBulletListCommand.key)}}});withMeta(bulletListKeymap.ctx,{displayName:"KeymapCtx<bulletListKeymap>",group:"BulletList"}),withMeta(bulletListKeymap.shortcuts,{displayName:"Keymap<bulletListKeymap>",group:"BulletList"});const orderedListAttr=(0,utils_lib.YR)("orderedList");withMeta(orderedListAttr,{displayName:"Attr<orderedList>",group:"OrderedList"});const orderedListSchema=(0,utils_lib.Yh)("ordered_list",ctx=>({content:"listItem+",group:"block",attrs:{order:{default:1,validate:"number"},spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ol",getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{spread:dom.dataset.spread,order:dom.hasAttribute("start")?Number(dom.getAttribute("start")):1}}}],toDOM:node=>["ol",{...ctx.get(orderedListAttr.key)(node),...1===node.attrs.order?{}:node.attrs.order,"data-spread":node.attrs.spread},0],parseMarkdown:{match:({type,ordered})=>"list"===type&&!!ordered,runner:(state,node,type)=>{const spread=null!=node.spread?`${node.spread}`:"true";state.openNode(type,{spread}).next(node.children).closeNode()}},toMarkdown:{match:node=>"ordered_list"===node.type.name,runner:(state,node)=>{state.openNode("list",void 0,{ordered:!0,start:1,spread:"true"===node.attrs.spread}),state.next(node.content),state.closeNode()}}}));withMeta(orderedListSchema.node,{displayName:"NodeSchema<orderedList>",group:"OrderedList"}),withMeta(orderedListSchema.ctx,{displayName:"NodeSchemaCtx<orderedList>",group:"OrderedList"});const wrapInOrderedListInputRule=(0,utils_lib.b_)(ctx=>(0,prosemirror_inputrules_dist.tG)(/^\s*(\d+)\.\s$/,orderedListSchema.type(ctx),match=>({order:Number(match[1])}),(match,node)=>node.childCount+node.attrs.order===Number(match[1])));withMeta(wrapInOrderedListInputRule,{displayName:"InputRule<wrapInOrderedListInputRule>",group:"OrderedList"});const wrapInOrderedListCommand=(0,utils_lib.yu)("WrapInOrderedList",ctx=>()=>(0,prosemirror_commands_dist.Im)(orderedListSchema.type(ctx)));withMeta(wrapInOrderedListCommand,{displayName:"Command<wrapInOrderedListCommand>",group:"OrderedList"});const orderedListKeymap=(0,utils_lib.pq)("orderedListKeymap",{WrapInOrderedList:{shortcuts:"Mod-Alt-7",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(wrapInOrderedListCommand.key)}}});withMeta(orderedListKeymap.ctx,{displayName:"KeymapCtx<orderedList>",group:"OrderedList"}),withMeta(orderedListKeymap.shortcuts,{displayName:"Keymap<orderedList>",group:"OrderedList"});const listItemAttr=(0,utils_lib.YR)("listItem");withMeta(listItemAttr,{displayName:"Attr<listItem>",group:"ListItem"});const listItemSchema=(0,utils_lib.Yh)("list_item",ctx=>({group:"listItem",content:"paragraph block*",attrs:{label:{default:"•",validate:"string"},listType:{default:"bullet",validate:"string"},spread:{default:!0,validate:"boolean"}},defining:!0,parseDOM:[{tag:"li",getAttrs:dom=>{if(!(dom instanceof HTMLElement))throw(0,exception_lib.Ik)(dom);return{label:dom.dataset.label,listType:dom.dataset.listType,spread:"true"===dom.dataset.spread}}}],toDOM:node=>["li",{...ctx.get(listItemAttr.key)(node),"data-label":node.attrs.label,"data-list-type":node.attrs.listType,"data-spread":node.attrs.spread},0],parseMarkdown:{match:({type})=>"listItem"===type,runner:(state,node,type)=>{const label=null!=node.label?`${node.label}.`:"•",listType=null!=node.label?"ordered":"bullet",spread=null!=node.spread?`${node.spread}`:"true";state.openNode(type,{label,listType,spread}),state.next(node.children),state.closeNode()}},toMarkdown:{match:node=>"list_item"===node.type.name,runner:(state,node)=>{state.openNode("listItem",void 0,{spread:node.attrs.spread}),state.next(node.content),state.closeNode()}}}));withMeta(listItemSchema.node,{displayName:"NodeSchema<listItem>",group:"ListItem"}),withMeta(listItemSchema.ctx,{displayName:"NodeSchemaCtx<listItem>",group:"ListItem"});const sinkListItemCommand=(0,utils_lib.yu)("SinkListItem",ctx=>()=>function sinkListItem(itemType){return function(state,dispatch){let{$from,$to}=state.selection,range=$from.blockRange($to,node=>node.childCount>0&&node.firstChild.type==itemType);if(!range)return!1;let startIndex=range.startIndex;if(0==startIndex)return!1;let parent=range.parent,nodeBefore=parent.child(startIndex-1);if(nodeBefore.type!=itemType)return!1;if(dispatch){let nestedBefore=nodeBefore.lastChild&&nodeBefore.lastChild.type==parent.type,inner=dist.FK.from(nestedBefore?itemType.create():null),slice=new dist.Ji(dist.FK.from(itemType.create(null,dist.FK.from(parent.type.create(null,inner)))),nestedBefore?3:1,0),before=range.start,after=range.end;dispatch(state.tr.step(new prosemirror_transform_dist.Wg(before-(nestedBefore?3:1),after,before,after,slice,1,!0)).scrollIntoView())}return!0}}(listItemSchema.type(ctx)));withMeta(sinkListItemCommand,{displayName:"Command<sinkListItemCommand>",group:"ListItem"});const liftListItemCommand=(0,utils_lib.yu)("LiftListItem",ctx=>()=>liftListItem(listItemSchema.type(ctx)));withMeta(liftListItemCommand,{displayName:"Command<liftListItemCommand>",group:"ListItem"});const splitListItemCommand=(0,utils_lib.yu)("SplitListItem",ctx=>()=>splitListItem(listItemSchema.type(ctx)));withMeta(splitListItemCommand,{displayName:"Command<splitListItemCommand>",group:"ListItem"});const liftFirstListItemCommand=(0,utils_lib.yu)("LiftFirstListItem",ctx=>()=>function liftFirstListItem(ctx){return(state,dispatch,view)=>{const{selection}=state;if(!(selection instanceof prosemirror_state_dist.U3))return!1;const{empty,$from}=selection;return!(!empty||0!==$from.parentOffset)&&($from.node(-1).type===listItemSchema.type(ctx)&&(0,prosemirror_commands_dist.Qv)(state,dispatch,view))}}(ctx));withMeta(liftFirstListItemCommand,{displayName:"Command<liftFirstListItemCommand>",group:"ListItem"});const listItemKeymap=(0,utils_lib.pq)("listItemKeymap",{NextListItem:{shortcuts:"Enter",command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(splitListItemCommand.key)}},SinkListItem:{shortcuts:["Tab","Mod-]"],command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(sinkListItemCommand.key)}},LiftListItem:{shortcuts:["Shift-Tab","Mod-["],command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(liftListItemCommand.key)}},LiftFirstListItem:{shortcuts:["Backspace","Delete"],command:ctx=>{const commands2=ctx.get(core_lib.MD);return()=>commands2.call(liftFirstListItemCommand.key)}}});withMeta(listItemKeymap.ctx,{displayName:"KeymapCtx<listItem>",group:"ListItem"}),withMeta(listItemKeymap.shortcuts,{displayName:"Keymap<listItem>",group:"ListItem"});const textSchema=(0,utils_lib.dz)("text",()=>({group:"inline",parseMarkdown:{match:({type})=>"text"===type,runner:(state,node)=>{state.addText(node.value)}},toMarkdown:{match:node=>"text"===node.type.name,runner:(state,node)=>{state.addNode("text",void 0,node.text)}}}));withMeta(textSchema,{displayName:"NodeSchema<text>",group:"Text"});const htmlAttr=(0,utils_lib.YR)("html");withMeta(htmlAttr,{displayName:"Attr<html>",group:"Html"});const htmlSchema=(0,utils_lib.Yh)("html",ctx=>({atom:!0,group:"inline",inline:!0,attrs:{value:{default:"",validate:"string"}},toDOM:node=>{const span=document.createElement("span"),attr={...ctx.get(htmlAttr.key)(node),"data-value":node.attrs.value,"data-type":"html"};return span.textContent=node.attrs.value,["span",attr,node.attrs.value]},parseDOM:[{tag:'span[data-type="html"]',getAttrs:dom=>({value:dom.dataset.value??""})}],parseMarkdown:{match:({type})=>Boolean("html"===type),runner:(state,node,type)=>{state.addNode(type,{value:node.value})}},toMarkdown:{match:node=>"html"===node.type.name,runner:(state,node)=>{state.addNode("html",void 0,node.attrs.value)}}}));withMeta(htmlSchema.node,{displayName:"NodeSchema<html>",group:"Html"}),withMeta(htmlSchema.ctx,{displayName:"NodeSchemaCtx<html>",group:"Html"});const schema=[docSchema,paragraphAttr,paragraphSchema,headingIdGenerator,headingAttr,headingSchema,hardbreakAttr,hardbreakSchema,blockquoteAttr,blockquoteSchema,codeBlockAttr,codeBlockSchema,hrAttr,hrSchema,imageAttr,imageSchema,bulletListAttr,bulletListSchema,orderedListAttr,orderedListSchema,listItemAttr,listItemSchema,emphasisAttr,emphasisSchema,strongAttr,strongSchema,inlineCodeAttr,inlineCodeSchema,linkAttr,linkSchema,htmlAttr,htmlSchema,textSchema].flat(),inputRules=[wrapInBlockquoteInputRule,wrapInBulletListInputRule,wrapInOrderedListInputRule,createCodeBlockInputRule,insertHrInputRule,wrapInHeadingInputRule].flat(),markInputRules=[emphasisStarInputRule,emphasisUnderscoreInputRule,inlineCodeInputRule,strongInputRule],isMarkSelectedCommand=(0,utils_lib.yu)("IsMarkSelected",()=>markType=>state=>{if(!markType)return!1;const{doc,selection}=state;return doc.rangeHasMark(selection.from,selection.to,markType)}),isNodeSelectedCommand=(0,utils_lib.yu)("IsNoteSelected",()=>nodeType=>state=>{if(!nodeType)return!1;return(0,lib.RK)(state,nodeType).hasNode}),clearTextInCurrentBlockCommand=(0,utils_lib.yu)("ClearTextInCurrentBlock",()=>()=>(state,dispatch)=>{let tr=state.tr;const{$from,$to}=tr.selection,{pos:from}=$from,{pos:right}=$to,left=from-$from.node().content.size;return!(left<0)&&(tr=tr.deleteRange(left,right),dispatch?.(tr),!0)}),setBlockTypeCommand=(0,utils_lib.yu)("SetBlockType",()=>payload=>(state,dispatch)=>{const{nodeType,attrs=null}=payload??{};if(!nodeType)return!1;const tr=state.tr,{from,to}=tr.selection;try{tr.setBlockType(from,to,nodeType,attrs)}catch{return!1}return dispatch?.(tr),!0}),wrapInBlockTypeCommand=(0,utils_lib.yu)("WrapInBlockType",()=>payload=>(state,dispatch)=>{const{nodeType,attrs=null}=payload??{};if(!nodeType)return!1;let tr=state.tr;try{const{$from,$to}=tr.selection,blockRange=$from.blockRange($to),wrapping=blockRange&&(0,prosemirror_transform_dist.oM)(blockRange,nodeType,attrs);if(!wrapping)return!1;tr=tr.wrap(blockRange,wrapping)}catch{return!1}return dispatch?.(tr),!0}),addBlockTypeCommand=(0,utils_lib.yu)("AddBlockType",()=>payload=>(state,dispatch)=>{const{nodeType,attrs=null}=payload??{};if(!nodeType)return!1;const tr=state.tr;try{const node=nodeType instanceof dist.bP?nodeType:nodeType.createAndFill(attrs);if(!node)return!1;tr.replaceSelectionWith(node)}catch{return!1}return dispatch?.(tr),!0}),selectTextNearPosCommand=(0,utils_lib.yu)("SelectTextNearPos",()=>payload=>(state,dispatch)=>{const{pos}=payload??{};if(null==pos)return!1;const tr=state.tr;try{const $pos=state.doc.resolve((value=pos,min=0,max=state.doc.content.size,Math.min(Math.max(value,min),max)));tr.setSelection(prosemirror_state_dist.U3.near($pos))}catch{return!1}var value,min,max;return dispatch?.(tr.scrollIntoView()),!0}),commands=[turnIntoTextCommand,wrapInBlockquoteCommand,wrapInHeadingCommand,downgradeHeadingCommand,createCodeBlockCommand,insertHardbreakCommand,insertHrCommand,insertImageCommand,updateImageCommand,wrapInOrderedListCommand,wrapInBulletListCommand,sinkListItemCommand,splitListItemCommand,liftListItemCommand,liftFirstListItemCommand,toggleEmphasisCommand,toggleInlineCodeCommand,toggleStrongCommand,toggleLinkCommand,updateLinkCommand,isMarkSelectedCommand,isNodeSelectedCommand,clearTextInCurrentBlockCommand,setBlockTypeCommand,wrapInBlockTypeCommand,addBlockTypeCommand,selectTextNearPosCommand],keymap=[blockquoteKeymap,codeBlockKeymap,hardbreakKeymap,headingKeymap,listItemKeymap,orderedListKeymap,bulletListKeymap,paragraphKeymap,emphasisKeymap,inlineCodeKeymap,strongKeymap].flat(),remarkAddOrderInListPlugin=(0,utils_lib.lz)("remarkAddOrderInList",()=>()=>tree=>{(0,unist_util_visit_lib.YR)(tree,"list",node=>{if(node.ordered){const start=node.start??1;node.children.forEach((child,index)=>{child.label=index+start})}})});withMeta(remarkAddOrderInListPlugin.plugin,{displayName:"Remark<remarkAddOrderInListPlugin>",group:"Remark"}),withMeta(remarkAddOrderInListPlugin.options,{displayName:"RemarkConfig<remarkAddOrderInListPlugin>",group:"Remark"});const remarkLineBreak=(0,utils_lib.lz)("remarkLineBreak",()=>()=>tree=>{const find=/[\t ]*(?:\r?\n|\r)/g;(0,unist_util_visit_lib.YR)(tree,"text",(node,index,parent)=>{if(!node.value||"string"!=typeof node.value)return;const result=[];let start=0;find.lastIndex=0;let match=find.exec(node.value);for(;match;){const position=match.index;start!==position&&result.push({type:"text",value:node.value.slice(start,position)}),result.push({type:"break",data:{isInline:!0}}),start=position+match[0].length,match=find.exec(node.value)}return result.length>0&&parent&&"number"==typeof index?(start<node.value.length&&result.push({type:"text",value:node.value.slice(start)}),parent.children.splice(index,1,...result),index+result.length):void 0})});withMeta(remarkLineBreak.plugin,{displayName:"Remark<remarkLineBreak>",group:"Remark"}),withMeta(remarkLineBreak.options,{displayName:"RemarkConfig<remarkLineBreak>",group:"Remark"});const remarkInlineLinkPlugin=(0,utils_lib.lz)("remarkInlineLink",()=>remarkInlineLinks);withMeta(remarkInlineLinkPlugin.plugin,{displayName:"Remark<remarkInlineLinkPlugin>",group:"Remark"}),withMeta(remarkInlineLinkPlugin.options,{displayName:"RemarkConfig<remarkInlineLinkPlugin>",group:"Remark"});const BLOCK_CONTAINER_TYPES=["root","blockquote","listItem"],remarkHtmlTransformer=(0,utils_lib.lz)("remarkHTMLTransformer",()=>()=>tree=>{!function flatMapWithDepth(ast,fn){return function transform(node,index,parent){if((node=>!!node.children)(node)){const out=[];for(let i=0,n=node.children.length;i<n;i++){const nthChild=node.children[i];if(nthChild){const xs=transform(nthChild,i,node);if(xs)for(let j=0,m=xs.length;j<m;j++){const item=xs[j];item&&out.push(item)}}}node.children=out}return fn(node,index,parent)}(ast,0,null)[0]}(tree,(node,_index,parent)=>(node=>"html"===node.type)(node)?(parent&&BLOCK_CONTAINER_TYPES.includes(parent.type)&&(node.children=[{...node}],delete node.value,node.type="paragraph"),[node]):[node])});withMeta(remarkHtmlTransformer.plugin,{displayName:"Remark<remarkHtmlTransformer>",group:"Remark"}),withMeta(remarkHtmlTransformer.options,{displayName:"RemarkConfig<remarkHtmlTransformer>",group:"Remark"});const remarkMarker=(0,utils_lib.lz)("remarkMarker",()=>()=>(tree,file)=>{(0,unist_util_visit_lib.YR)(tree,node=>["strong","emphasis"].includes(node.type),node=>{node.marker=(node=>file.value.charAt(node.position.start.offset))(node)})});withMeta(remarkMarker.plugin,{displayName:"Remark<remarkMarker>",group:"Remark"}),withMeta(remarkMarker.options,{displayName:"RemarkConfig<remarkMarker>",group:"Remark"});const inlineNodesCursorPlugin=(0,utils_lib.Gf)(()=>{let lock=!1;const inlineNodesCursorPluginKey=new prosemirror_state_dist.hs("MILKDOWN_INLINE_NODES_CURSOR"),inlineNodesCursorPlugin2=new prosemirror_state_dist.k_({key:inlineNodesCursorPluginKey,state:{init:()=>!1,apply(tr){if(!tr.selection.empty)return!1;const pos=tr.selection.$from,left=pos.nodeBefore,right=pos.nodeAfter;return!(!(left&&right&&left.isInline&&!left.isText&&right.isInline)||right.isText)}},props:{handleDOMEvents:{compositionend:(view,e)=>!!lock&&(lock=!1,requestAnimationFrame(()=>{if(inlineNodesCursorPlugin2.getState(view.state)){const from=view.state.selection.from;e.preventDefault(),view.dispatch(view.state.tr.insertText(e.data||"",from))}}),!0),compositionstart:view=>(inlineNodesCursorPlugin2.getState(view.state)&&(lock=!0),!1),beforeinput:(view,e)=>{if(inlineNodesCursorPlugin2.getState(view.state)&&e instanceof InputEvent&&e.data&&!lock){const from=view.state.selection.from;return e.preventDefault(),view.dispatch(view.state.tr.insertText(e.data||"",from)),!0}return!1}},decorations(state){if(inlineNodesCursorPlugin2.getState(state)){const position=state.selection.$from.pos,left=document.createElement("span"),leftDec=prosemirror_view_dist.NZ.widget(position,left,{side:-1}),right=document.createElement("span"),rightDec=prosemirror_view_dist.NZ.widget(position,right);return setTimeout(()=>{left.contentEditable="true",right.contentEditable="true"}),prosemirror_view_dist.zF.create(state.doc,[leftDec,rightDec])}return prosemirror_view_dist.zF.empty}}});return inlineNodesCursorPlugin2});withMeta(inlineNodesCursorPlugin,{displayName:"Prose<inlineNodesCursorPlugin>",group:"Prose"});const hardbreakClearMarkPlugin=(0,utils_lib.Gf)(ctx=>new prosemirror_state_dist.k_({key:new prosemirror_state_dist.hs("MILKDOWN_HARDBREAK_MARKS"),appendTransaction:(trs,_oldState,newState)=>{if(!trs.length)return;const[tr]=trs;if(!tr)return;const[step]=tr.steps;if(tr.getMeta("hardbreak")){if(!(step instanceof prosemirror_transform_dist.Ln))return;const{from}=step;return newState.tr.setNodeMarkup(from,hardbreakSchema.type(ctx),void 0,[])}if(step instanceof prosemirror_transform_dist.XE){let _tr=newState.tr;const{from,to}=step;return newState.doc.nodesBetween(from,to,(node,pos)=>{node.type===hardbreakSchema.type(ctx)&&(_tr=_tr.setNodeMarkup(pos,hardbreakSchema.type(ctx),void 0,[]))}),_tr}}}));withMeta(hardbreakClearMarkPlugin,{displayName:"Prose<hardbreakClearMarkPlugin>",group:"Prose"});const hardbreakFilterNodes=(0,utils_lib.Qx)(["table","code_block"],"hardbreakFilterNodes");withMeta(hardbreakFilterNodes,{displayName:"Ctx<hardbreakFilterNodes>",group:"Prose"});const hardbreakFilterPlugin=(0,utils_lib.Gf)(ctx=>{const notIn=ctx.get(hardbreakFilterNodes.key);return new prosemirror_state_dist.k_({key:new prosemirror_state_dist.hs("MILKDOWN_HARDBREAK_FILTER"),filterTransaction:(tr,state)=>{const isInsertHr=tr.getMeta("hardbreak"),[step]=tr.steps;if(isInsertHr&&step){const{from}=step,$from=state.doc.resolve(from);let curDepth=$from.depth,canApply=!0;for(;curDepth>0;)notIn.includes($from.node(curDepth).type.name)&&(canApply=!1),curDepth--;return canApply}return!0}})});withMeta(hardbreakFilterPlugin,{displayName:"Prose<hardbreakFilterPlugin>",group:"Prose"});const syncHeadingIdPlugin=(0,utils_lib.Gf)(ctx=>{const headingIdPluginKey=new prosemirror_state_dist.hs("MILKDOWN_HEADING_ID"),updateId=view=>{if(view.composing)return;const getId=ctx.get(headingIdGenerator.key),tr=view.state.tr.setMeta("addToHistory",!1);let found=!1;const idMap={};view.state.doc.descendants((node,pos)=>{if(node.type===headingSchema.type(ctx)){if(0===node.textContent.trim().length)return;const attrs=node.attrs;let id=getId(node);idMap[id]?(idMap[id]+=1,id+=`-#${idMap[id]}`):idMap[id]=1,attrs.id!==id&&(found=!0,tr.setMeta(headingIdPluginKey,!0).setNodeMarkup(pos,void 0,{...attrs,id}))}}),found&&view.dispatch(tr)};return new prosemirror_state_dist.k_({key:headingIdPluginKey,view:view=>(updateId(view),{update:(view2,prevState)=>{view2.state.doc.eq(prevState.doc)||updateId(view2)}})})});withMeta(syncHeadingIdPlugin,{displayName:"Prose<syncHeadingIdPlugin>",group:"Prose"});const syncListOrderPlugin=(0,utils_lib.Gf)(ctx=>new prosemirror_state_dist.k_({key:new prosemirror_state_dist.hs("MILKDOWN_KEEP_LIST_ORDER"),appendTransaction:(transactions,_oldState,newState)=>{if(!newState.selection||transactions.some(tr2=>!1===tr2.getMeta("addToHistory")||!tr2.isGeneric))return null;const orderedListType=orderedListSchema.type(ctx),bulletListType=bulletListSchema.type(ctx),listItemType=listItemSchema.type(ctx),handleNodeItem=(attrs,index)=>{let changed=!1;const expectedLabel=`${index+1}.`;return attrs.label!==expectedLabel&&(attrs.label=expectedLabel,changed=!0),changed};let tr=newState.tr,needDispatch=!1;return newState.doc.descendants((node,pos,parent,index)=>{if(node.type===bulletListType){const base=node.maybeChild(0);base?.type===listItemType&&"ordered"===base.attrs.listType&&(needDispatch=!0,tr.setNodeMarkup(pos,orderedListType,{spread:"true"}),node.descendants((child,pos2,_parent,index2)=>{if(child.type===listItemType){const attrs={...child.attrs};handleNodeItem(attrs,index2)&&(tr=tr.setNodeMarkup(pos2,void 0,attrs))}return!1}))}else if(node.type===listItemType&&parent?.type===orderedListType){const attrs={...node.attrs};let changed=!1;"ordered"!==attrs.listType&&(attrs.listType="ordered",changed=!0);const base=parent?.maybeChild(0);base&&(changed=handleNodeItem(attrs,index)),changed&&(tr=tr.setNodeMarkup(pos,void 0,attrs),needDispatch=!0)}}),needDispatch?tr.setMeta("addToHistory",!1):null}}));withMeta(syncListOrderPlugin,{displayName:"Prose<syncListOrderPlugin>",group:"Prose"});const commonmark=[schema,inputRules,markInputRules,commands,keymap,[hardbreakClearMarkPlugin,hardbreakFilterNodes,hardbreakFilterPlugin,inlineNodesCursorPlugin,remarkAddOrderInListPlugin,remarkInlineLinkPlugin,remarkLineBreak,remarkHtmlTransformer,remarkMarker,remarkPreserveEmptyLinePlugin,syncHeadingIdPlugin,syncListOrderPlugin].flat()].flat()},"./node_modules/@milkdown/prose/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Bz:()=>nodeRule,EO:()=>isTextOnlySlice,I9:()=>cloneTr,KP:()=>findParentNode,MG:()=>posToDOMRect,RK:()=>findNodeInSelection,T:()=>browser,UM:()=>findSelectedNodeOfType,UX:()=>getNodeFromSchema,Z6:()=>customInputRules,eL:()=>findParentNodeClosestToPos,gi:()=>findParent,qx:()=>findParentNodeType,uX:()=>markRule});var prosemirror_state__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),prosemirror_inputrules__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prosemirror-inputrules/dist/index.js"),_milkdown_exception__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@milkdown/exception/lib/index.js");const nav="undefined"!=typeof navigator?navigator:null,doc="undefined"!=typeof document?document:null,agent=nav&&nav.userAgent||"",ie_edge=/Edge\/(\d+)/.exec(agent),ie_upto10=/MSIE \d/.exec(agent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(agent),ie=!!(ie_upto10||ie_11up||ie_edge),ie_version=ie_upto10?document.documentMode:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko=!ie&&/gecko\/(\d+)/i.test(agent),gecko_version=gecko&&+(/Firefox\/(\d+)/.exec(agent)||[0,0])[1],_chrome=!ie&&/Chrome\/(\d+)/.exec(agent),chrome=!!_chrome,chrome_version=_chrome?+_chrome[1]:0,safari=!ie&&!!nav&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(agent)||!!nav&&nav.maxTouchPoints>2),mac=ios||!!nav&&/Mac/.test(nav.platform),android=/Android \d/.test(agent),webkit=!!doc&&"webkitFontSmoothing"in doc.documentElement.style,webkit_version=webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;var browser=Object.freeze({__proto__:null,android,chrome,chrome_version,gecko,gecko_version,ie,ie_version,ios,mac,safari,webkit,webkit_version});function run(view,from,to,text,rules,plugin){if(view.composing)return!1;const state=view.state,$from=state.doc.resolve(from);if($from.parent.type.spec.code)return!1;const textBefore=$from.parent.textBetween(Math.max(0,$from.parentOffset-500),$from.parentOffset,void 0,"￼")+text;for(let _matcher of rules){const matcher=_matcher,match=matcher.match.exec(textBefore),tr=match&&match[0]&&matcher.handler(state,match,from-(match[0].length-text.length),to);if(tr)return!1!==matcher.undoable&&tr.setMeta(plugin,{transform:tr,from,to,text}),view.dispatch(tr),!0}return!1}const customInputRulesKey=new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.hs("MILKDOWN_CUSTOM_INPUTRULES");function customInputRules({rules}){const plugin=new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.k_({key:customInputRulesKey,isInputRules:!0,state:{init:()=>null,apply(tr,prev){const stored=tr.getMeta(this);return stored||(tr.selectionSet||tr.docChanged?null:prev)}},props:{handleTextInput:(view,from,to,text)=>run(view,from,to,text,rules,plugin),handleDOMEvents:{compositionend:view=>(setTimeout(()=>{const{$cursor}=view.state.selection;$cursor&&run(view,$cursor.pos,$cursor.pos,"",rules,plugin)}),!1)},handleKeyDown(view,event){if("Enter"!==event.key)return!1;const{$cursor}=view.state.selection;return!!$cursor&&run(view,$cursor.pos,$cursor.pos,"\n",rules,plugin)}}});return plugin}function markRule(regexp,markType,options={}){return new prosemirror_inputrules__WEBPACK_IMPORTED_MODULE_1__.fV(regexp,(state,match,start,end)=>{var _a,_b,_c,_d;const{tr}=state;let group=match[match.length-1],fullMatch=match[0],initialStoredMarks=[],markEnd=end;const captured={group,fullMatch,start,end},result=null==(_a=options.updateCaptured)?void 0:_a.call(options,captured);if(Object.assign(captured,result),({group,fullMatch,start,end}=captured),null===fullMatch)return null;if(""===(null==group?void 0:group.trim()))return null;if(group){const startSpaces=fullMatch.search(/\S/),textStart=start+fullMatch.indexOf(group),textEnd=textStart+group.length;initialStoredMarks=null!=(_b=tr.storedMarks)?_b:[],textEnd<end&&tr.delete(textEnd,end),textStart>start&&tr.delete(start+startSpaces,textStart),markEnd=start+startSpaces+group.length;const attrs=null==(_c=options.getAttr)?void 0:_c.call(options,match);tr.addMark(start,markEnd,markType.create(attrs)),tr.setStoredMarks(initialStoredMarks),null==(_d=options.beforeDispatch)||_d.call(options,{match,start,end,tr})}return tr})}function nodeRule(regexp,nodeType,options={}){return new prosemirror_inputrules__WEBPACK_IMPORTED_MODULE_1__.fV(regexp,(state,match,start,end)=>{var _a,_b,_c;const{tr}=state;let group=match[1],fullMatch=match[0];const captured={group,fullMatch,start,end},result=null==(_a=options.updateCaptured)?void 0:_a.call(options,captured);if(Object.assign(captured,result),({group,fullMatch,start,end}=captured),null===fullMatch)return null;if(!group||""===group.trim())return null;const attrs=null==(_b=options.getAttr)?void 0:_b.call(options,match),node=nodeType.createAndFill(attrs);return node&&(tr.replaceRangeWith(nodeType.isBlock?tr.doc.resolve(start).before():start,end,node),null==(_c=options.beforeDispatch)||_c.call(options,{match:[fullMatch,null!=group?group:""],start,end,tr})),tr})}var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__spreadProps=(a,b)=>__defProps(a,__getOwnPropDescs(b));function minMax(value=0,min=0,max=0){return Math.min(Math.max(value,min),max)}function posToDOMRect(view,from,to){const maxPos=view.state.doc.content.size,resolvedFrom=minMax(from,0,maxPos),resolvedEnd=minMax(to,0,maxPos),start=view.coordsAtPos(resolvedFrom),end=view.coordsAtPos(resolvedEnd,-1),top=Math.min(start.top,end.top),bottom=Math.max(start.bottom,end.bottom),left=Math.min(start.left,end.left),right=Math.max(start.right,end.right),data={top,bottom,left,right,width:right-left,height:bottom-top,x:left,y:top};return __spreadProps(__spreadValues({},data),{toJSON:()=>data})}function cloneTr(tr){return Object.assign(Object.create(tr),tr).setTime(Date.now())}function isTextOnlySlice(slice){if(1===slice.content.childCount){const node=slice.content.firstChild;if("text"===(null==node?void 0:node.type.name)&&0===node.marks.length)return node;if("paragraph"===(null==node?void 0:node.type.name)&&1===node.childCount){const _node=node.firstChild;if("text"===(null==_node?void 0:_node.type.name)&&0===_node.marks.length)return _node}}return!1}function findParent(predicate){return $pos=>{for(let depth=$pos.depth;depth>0;depth-=1){const node=$pos.node(depth);if(predicate(node)){return{from:$pos.before(depth),to:$pos.after(depth),node}}}}}function findParentNodeType($pos,nodeType){return findParent(node=>node.type===nodeType)($pos)}function getNodeFromSchema(type,schema){const target=schema.nodes[type];if(!target)throw(0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_2__.p8)("node",type);return target}function findParentNodeClosestToPos(predicate){return $pos=>{for(let i=$pos.depth;i>0;i--){const node=$pos.node(i);if(predicate(node))return{pos:i>0?$pos.before(i):0,start:$pos.start(i),depth:i,node}}}}function findParentNode(predicate){return selection=>findParentNodeClosestToPos(predicate)(selection.$from)}function findSelectedNodeOfType(selection,nodeType){if(!(selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh))return;const{node,$from}=selection;return function equalNodeType(nodeType,node){return Array.isArray(nodeType)&&nodeType.includes(node.type)||node.type===nodeType}(nodeType,node)?{node,pos:$from.pos,start:$from.start($from.depth),depth:$from.depth}:void 0}const findNodeInSelection=(state,node)=>{const{selection,doc}=state;if(selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh)return{hasNode:selection.node.type===node,pos:selection.from,target:selection.node};const{from,to}=selection;let hasNode=!1,pos=-1,target=null;return doc.nodesBetween(from,to,(n,p)=>!target&&(n.type!==node||(hasNode=!0,pos=p,target=n,!1))),{hasNode,pos,target}}},"./node_modules/@milkdown/react/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Nj:()=>useInstance,hG:()=>useEditor,pb:()=>MilkdownProvider,y5:()=>Milkdown});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");const editorInfoContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)({});const Milkdown=()=>{const domRef=function useGetEditor(){const{dom,editor:editorRef,setLoading,editorFactory:getEditor}=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(editorInfoContext),domRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{const div=domRef.current;if(!getEditor)return;if(!div)return;dom.current=div;const editor=getEditor(div);return editor?(setLoading(!0),editor.create().then(editor2=>{editorRef.current=editor2}).finally(()=>{setLoading(!1)}).catch(console.error),()=>{editor.destroy().catch(console.error)}):void 0},[dom,editorRef,getEditor,setLoading]),domRef}();return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{"data-milkdown-root":!0,ref:domRef})},MilkdownProvider=({children})=>{const dom=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(void 0),[editorFactory,setEditorFactory]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(void 0),editor=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(void 0),[loading,setLoading]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!0),editorInfoCtx=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>({loading,dom,editor,setLoading,editorFactory,setEditorFactory}),[loading,editorFactory]);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(editorInfoContext.Provider,{value:editorInfoCtx},children)};function useEditor(getEditor,deps=[]){const editorInfo=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(editorInfoContext),factory=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(getEditor,deps);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(()=>{editorInfo.setEditorFactory(()=>factory)},[editorInfo,factory]),{loading:editorInfo.loading,get:()=>editorInfo.editor.current}}function useInstance(){const editorInfo=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(editorInfoContext),getInstance=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>editorInfo.editor.current,[editorInfo.editor]);return[editorInfo.loading,getInstance]}},"./node_modules/@milkdown/utils/lib/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Gf:()=>$prose,Ht:()=>$shortcut,JY:()=>$markAttr,Qx:()=>$ctx,YR:()=>$nodeAttr,Yh:()=>$nodeSchema,Yr:()=>insert,b_:()=>$inputRule,dz:()=>$node,hk:()=>$markSchema,lz:()=>$remark,m5:()=>$view,pq:()=>$useKeymap,up:()=>getMarkdown,yu:()=>$command});var _milkdown_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@milkdown/core/lib/index.js"),_milkdown_ctx__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@milkdown/ctx/lib/index.js"),nanoid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/nanoid/index.browser.js"),_milkdown_exception__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@milkdown/exception/lib/index.js"),_milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/prosemirror-model/dist/index.js"),_milkdown_prose__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@milkdown/prose/lib/index.js");(0,nanoid__WEBPACK_IMPORTED_MODULE_2__.d_)("abcedfghicklmn",10);function $command(key,cmd){const cmdKey=(0,_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.qf)(key),plugin=ctx=>async()=>{plugin.key=cmdKey,await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.A2);const command=cmd(ctx);return ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.MD).create(cmdKey,command),plugin.run=payload=>ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.MD).call(key,payload),()=>{ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.MD).remove(cmdKey)}};return plugin}function $inputRule(inputRule){const plugin=ctx=>async()=>{await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.x8);const ir=inputRule(ctx);return ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.f4,irs=>[...irs,ir]),plugin.inputRule=ir,()=>{ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.f4,irs=>irs.filter(x=>x!==ir))}};return plugin}function $node(id,schema){const plugin=ctx=>async()=>{const nodeSchema=schema(ctx);return ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.P_,ns=>[...ns.filter(n=>n[0]!==id),[id,nodeSchema]]),plugin.id=id,plugin.schema=nodeSchema,()=>{ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.P_,ns=>ns.filter(([x])=>x!==id))}};return plugin.type=ctx=>{const nodeType=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.pZ).nodes[id];if(!nodeType)throw(0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_3__.pj)(id);return nodeType},plugin}function $prose(prose){let prosePlugin;const plugin=ctx=>async()=>(await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.x8),prosePlugin=prose(ctx),ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.TP,ps=>[...ps,prosePlugin]),()=>{ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.TP,ps=>ps.filter(x=>x!==prosePlugin))});return plugin.plugin=()=>prosePlugin,plugin.key=()=>prosePlugin.spec.key,plugin}function $shortcut(shortcut){const plugin=ctx=>async()=>{await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.lq);const km=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.nu),keymap=shortcut(ctx),dispose=km.addObjectKeymap(keymap);return plugin.keymap=keymap,()=>{dispose()}};return plugin}function $view(type,view){const plugin=ctx=>async()=>{await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.x8);const v=view(ctx);return type.type(ctx)instanceof _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__.Z6?ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.pe,ps=>[...ps,[type.id,v]]):ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.aD,ps=>[...ps,[type.id,v]]),plugin.view=v,plugin.type=type,()=>{type.type(ctx)instanceof _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__.Z6?ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.pe,ps=>ps.filter(x=>x[0]!==type.id)):ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.aD,ps=>ps.filter(x=>x[0]!==type.id))}};return plugin}function $ctx(value,name){const slice=(0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_1__.Z0)(value,name),plugin=ctx=>(ctx.inject(slice),()=>()=>{ctx.remove(slice)});return plugin.key=slice,plugin}function $nodeSchema(id,schema){const schemaCtx2=$ctx(schema,id),nodeSchema=$node(id,ctx=>ctx.get(schemaCtx2.key)(ctx)),result=[schemaCtx2,nodeSchema];return result.id=nodeSchema.id,result.node=nodeSchema,result.type=ctx=>nodeSchema.type(ctx),result.ctx=schemaCtx2,result.key=schemaCtx2.key,result.extendSchema=handler=>{const nextSchema=handler(schema);return $nodeSchema(id,nextSchema)},result}function $markSchema(id,schema){const schemaCtx2=$ctx(schema,id),markSchema=function $mark(id,schema){const plugin=ctx=>async()=>{const markSchema=schema(ctx);return ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.u7,ns=>[...ns.filter(n=>n[0]!==id),[id,markSchema]]),plugin.id=id,plugin.schema=markSchema,()=>{ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.u7,ns=>ns.filter(([x])=>x!==id))}};return plugin.type=ctx=>{const markType=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.pZ).marks[id];if(!markType)throw(0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_3__.sm)(id);return markType},plugin}(id,ctx=>ctx.get(schemaCtx2.key)(ctx)),result=[schemaCtx2,markSchema];return result.id=markSchema.id,result.mark=markSchema,result.type=ctx=>markSchema.type(ctx),result.ctx=schemaCtx2,result.key=schemaCtx2.key,result.extendSchema=handler=>{const nextSchema=handler(schema);return $markSchema(id,nextSchema)},result}function $useKeymap(name,userKeymap){const keymapDef=$ctx(Object.fromEntries(Object.entries(userKeymap).map(([key2,{shortcuts:shortcuts2,priority}])=>[key2,{shortcuts:shortcuts2,priority}])),`${name}Keymap`),shortcuts=$shortcut(ctx=>{const keys=ctx.get(keymapDef.key),keymapTuple=Object.entries(userKeymap).flatMap(([key2,{command}])=>{const target=keys[key2],targetKeys=[target.shortcuts].flat(),priority=target.priority;return targetKeys.map(targetKey=>[targetKey,{key:targetKey,onRun:command,priority}])});return Object.fromEntries(keymapTuple)}),result=[keymapDef,shortcuts];return result.ctx=keymapDef,result.shortcuts=shortcuts,result.key=keymapDef.key,result.keymap=shortcuts.keymap,result}const $nodeAttr=(name,value=()=>({}))=>$ctx(value,`${name}Attr`),$markAttr=(name,value=()=>({}))=>$ctx(value,`${name}Attr`);function $remark(id,remark,initialOptions){const options=$ctx(initialOptions??{},id),plugin=ctx=>async()=>{await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.ge);const remarkPlugin={plugin:remark(ctx),options:ctx.get(options.key)};return ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.eM,rp=>[...rp,remarkPlugin]),()=>{ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.eM,rp=>rp.filter(x=>x!==remarkPlugin))}},result=[options,plugin];return result.id=id,result.plugin=plugin,result.options=options,result}function getMarkdown(range){return ctx=>{const view=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.kY),schema=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.pZ),serializer=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.M);if(!range)return serializer(view.state.doc);const slice=view.state.doc.slice(range.from,range.to,!0),doc=schema.topNodeType.createAndFill(null,slice.content);return doc?serializer(doc):(console.error("No document found"),"")}}function insert(markdown,inline=!1){return ctx=>{const view=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.kY),doc=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.bQ)(markdown);if(!doc)return;if(!inline){const contentSlice=view.state.selection.content();return view.dispatch(view.state.tr.replaceSelection(new _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__.Ji(doc.content,contentSlice.openStart,contentSlice.openEnd)).scrollIntoView())}const schema=ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_0__.pZ),dom=_milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__.ZF.fromSchema(schema).serializeFragment(doc.content),slice=_milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__.S4.fromSchema(schema).parseSlice(dom),node=(0,_milkdown_prose__WEBPACK_IMPORTED_MODULE_5__.EO)(slice);node?view.dispatch(view.state.tr.replaceSelectionWith(node,!0)):view.dispatch(view.state.tr.replaceSelection(slice))}}},"./node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C4:()=>pauseTracking,EW:()=>computed,Gc:()=>shallowReactive,IG:()=>markRaw,IJ:()=>shallowRef,KR:()=>ref,Kh:()=>reactive,Pr:()=>proxyRefs,R1:()=>unref,X2:()=>ReactiveEffect,bl:()=>resetTracking,hZ:()=>trigger,i9:()=>isRef,ju:()=>isProxy,u4:()=>track,ux:()=>toRaw,wB:()=>watch,yC:()=>EffectScope});var _vue_shared__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@vue/shared/dist/shared.esm-bundler.js");let activeEffectScope,activeSub;class EffectScope{constructor(detached=!1){this.detached=detached,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=activeEffectScope,!detached&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let i,l;if(this._isPaused=!0,this.scopes)for(i=0,l=this.scopes.length;i<l;i++)this.scopes[i].pause();for(i=0,l=this.effects.length;i<l;i++)this.effects[i].pause()}}resume(){if(this._active&&this._isPaused){let i,l;if(this._isPaused=!1,this.scopes)for(i=0,l=this.scopes.length;i<l;i++)this.scopes[i].resume();for(i=0,l=this.effects.length;i<l;i++)this.effects[i].resume()}}run(fn){if(this._active){const currentEffectScope=activeEffectScope;try{return activeEffectScope=this,fn()}finally{activeEffectScope=currentEffectScope}}else 0}on(){1===++this._on&&(this.prevScope=activeEffectScope,activeEffectScope=this)}off(){this._on>0&&0===--this._on&&(activeEffectScope=this.prevScope,this.prevScope=void 0)}stop(fromParent){if(this._active){let i,l;for(this._active=!1,i=0,l=this.effects.length;i<l;i++)this.effects[i].stop();for(this.effects.length=0,i=0,l=this.cleanups.length;i<l;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,l=this.scopes.length;i<l;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!fromParent){const last=this.parent.scopes.pop();last&&last!==this&&(this.parent.scopes[this.index]=last,last.index=this.index)}this.parent=void 0}}}const pausedQueueEffects=new WeakSet;class ReactiveEffect{constructor(fn){this.fn=fn,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,activeEffectScope&&activeEffectScope.active&&activeEffectScope.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,pausedQueueEffects.has(this)&&(pausedQueueEffects.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||batch(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,cleanupEffect(this),prepareDeps(this);const prevEffect=activeSub,prevShouldTrack=shouldTrack;activeSub=this,shouldTrack=!0;try{return this.fn()}finally{0,cleanupDeps(this),activeSub=prevEffect,shouldTrack=prevShouldTrack,this.flags&=-3}}stop(){if(1&this.flags){for(let link=this.deps;link;link=link.nextDep)removeSub(link);this.deps=this.depsTail=void 0,cleanupEffect(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?pausedQueueEffects.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){isDirty(this)&&this.run()}get dirty(){return isDirty(this)}}let batchedSub,batchedComputed,batchDepth=0;function batch(sub,isComputed=!1){if(sub.flags|=8,isComputed)return sub.next=batchedComputed,void(batchedComputed=sub);sub.next=batchedSub,batchedSub=sub}function startBatch(){batchDepth++}function endBatch(){if(--batchDepth>0)return;if(batchedComputed){let e=batchedComputed;for(batchedComputed=void 0;e;){const next=e.next;e.next=void 0,e.flags&=-9,e=next}}let error;for(;batchedSub;){let e=batchedSub;for(batchedSub=void 0;e;){const next=e.next;if(e.next=void 0,e.flags&=-9,1&e.flags)try{e.trigger()}catch(err){error||(error=err)}e=next}}if(error)throw error}function prepareDeps(sub){for(let link=sub.deps;link;link=link.nextDep)link.version=-1,link.prevActiveLink=link.dep.activeLink,link.dep.activeLink=link}function cleanupDeps(sub){let head,tail=sub.depsTail,link=tail;for(;link;){const prev=link.prevDep;-1===link.version?(link===tail&&(tail=prev),removeSub(link),removeDep(link)):head=link,link.dep.activeLink=link.prevActiveLink,link.prevActiveLink=void 0,link=prev}sub.deps=head,sub.depsTail=tail}function isDirty(sub){for(let link=sub.deps;link;link=link.nextDep)if(link.dep.version!==link.version||link.dep.computed&&(refreshComputed(link.dep.computed)||link.dep.version!==link.version))return!0;return!!sub._dirty}function refreshComputed(computed){if(4&computed.flags&&!(16&computed.flags))return;if(computed.flags&=-17,computed.globalVersion===globalVersion)return;if(computed.globalVersion=globalVersion,!computed.isSSR&&128&computed.flags&&(!computed.deps&&!computed._dirty||!isDirty(computed)))return;computed.flags|=2;const dep=computed.dep,prevSub=activeSub,prevShouldTrack=shouldTrack;activeSub=computed,shouldTrack=!0;try{prepareDeps(computed);const value=computed.fn(computed._value);(0===dep.version||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$H)(value,computed._value))&&(computed.flags|=128,computed._value=value,dep.version++)}catch(err){throw dep.version++,err}finally{activeSub=prevSub,shouldTrack=prevShouldTrack,cleanupDeps(computed),computed.flags&=-3}}function removeSub(link,soft=!1){const{dep,prevSub,nextSub}=link;if(prevSub&&(prevSub.nextSub=nextSub,link.prevSub=void 0),nextSub&&(nextSub.prevSub=prevSub,link.nextSub=void 0),dep.subs===link&&(dep.subs=prevSub,!prevSub&&dep.computed)){dep.computed.flags&=-5;for(let l=dep.computed.deps;l;l=l.nextDep)removeSub(l,!0)}soft||--dep.sc||!dep.map||dep.map.delete(dep.key)}function removeDep(link){const{prevDep,nextDep}=link;prevDep&&(prevDep.nextDep=nextDep,link.prevDep=void 0),nextDep&&(nextDep.prevDep=prevDep,link.nextDep=void 0)}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const last=trackStack.pop();shouldTrack=void 0===last||last}function cleanupEffect(e){const{cleanup}=e;if(e.cleanup=void 0,cleanup){const prevSub=activeSub;activeSub=void 0;try{cleanup()}finally{activeSub=prevSub}}}let globalVersion=0;class Link{constructor(sub,dep){this.sub=sub,this.dep=dep,this.version=dep.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Dep{constructor(computed){this.computed=computed,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(debugInfo){if(!activeSub||!shouldTrack||activeSub===this.computed)return;let link=this.activeLink;if(void 0===link||link.sub!==activeSub)link=this.activeLink=new Link(activeSub,this),activeSub.deps?(link.prevDep=activeSub.depsTail,activeSub.depsTail.nextDep=link,activeSub.depsTail=link):activeSub.deps=activeSub.depsTail=link,addSub(link);else if(-1===link.version&&(link.version=this.version,link.nextDep)){const next=link.nextDep;next.prevDep=link.prevDep,link.prevDep&&(link.prevDep.nextDep=next),link.prevDep=activeSub.depsTail,link.nextDep=void 0,activeSub.depsTail.nextDep=link,activeSub.depsTail=link,activeSub.deps===link&&(activeSub.deps=next)}return link}trigger(debugInfo){this.version++,globalVersion++,this.notify(debugInfo)}notify(debugInfo){startBatch();try{0;for(let link=this.subs;link;link=link.prevSub)link.sub.notify()&&link.sub.dep.notify()}finally{endBatch()}}}function addSub(link){if(link.dep.sc++,4&link.sub.flags){const computed=link.dep.computed;if(computed&&!link.dep.subs){computed.flags|=20;for(let l=computed.deps;l;l=l.nextDep)addSub(l)}const currentTail=link.dep.subs;currentTail!==link&&(link.prevSub=currentTail,currentTail&&(currentTail.nextSub=link)),link.dep.subs=link}}const targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol(""),ARRAY_ITERATE_KEY=Symbol("");function track(target,type,key){if(shouldTrack&&activeSub){let depsMap=targetMap.get(target);depsMap||targetMap.set(target,depsMap=new Map);let dep=depsMap.get(key);dep||(depsMap.set(key,dep=new Dep),dep.map=depsMap,dep.key=key),dep.track()}}function trigger(target,type,key,newValue,oldValue,oldTarget){const depsMap=targetMap.get(target);if(!depsMap)return void globalVersion++;const run=dep=>{dep&&dep.trigger()};if(startBatch(),"clear"===type)depsMap.forEach(run);else{const targetIsArray=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.cy)(target),isArrayIndex=targetIsArray&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.yI)(key);if(targetIsArray&&"length"===key){const newLength=Number(newValue);depsMap.forEach((dep,key2)=>{("length"===key2||key2===ARRAY_ITERATE_KEY||!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Bm)(key2)&&key2>=newLength)&&run(dep)})}else switch((void 0!==key||depsMap.has(void 0))&&run(depsMap.get(key)),isArrayIndex&&run(depsMap.get(ARRAY_ITERATE_KEY)),type){case"add":targetIsArray?isArrayIndex&&run(depsMap.get("length")):(run(depsMap.get(ITERATE_KEY)),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.CE)(target)&&run(depsMap.get(MAP_KEY_ITERATE_KEY)));break;case"delete":targetIsArray||(run(depsMap.get(ITERATE_KEY)),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.CE)(target)&&run(depsMap.get(MAP_KEY_ITERATE_KEY)));break;case"set":(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.CE)(target)&&run(depsMap.get(ITERATE_KEY))}}endBatch()}function reactiveReadArray(array){const raw=toRaw(array);return raw===array?raw:(track(raw,0,ARRAY_ITERATE_KEY),isShallow(array)?raw:raw.map(toReactive))}function shallowReadArray(arr){return track(arr=toRaw(arr),0,ARRAY_ITERATE_KEY),arr}const arrayInstrumentations={__proto__:null,[Symbol.iterator](){return iterator(this,Symbol.iterator,toReactive)},concat(...args){return reactiveReadArray(this).concat(...args.map(x=>(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.cy)(x)?reactiveReadArray(x):x))},entries(){return iterator(this,"entries",value=>(value[1]=toReactive(value[1]),value))},every(fn,thisArg){return apply(this,"every",fn,thisArg,void 0,arguments)},filter(fn,thisArg){return apply(this,"filter",fn,thisArg,v=>v.map(toReactive),arguments)},find(fn,thisArg){return apply(this,"find",fn,thisArg,toReactive,arguments)},findIndex(fn,thisArg){return apply(this,"findIndex",fn,thisArg,void 0,arguments)},findLast(fn,thisArg){return apply(this,"findLast",fn,thisArg,toReactive,arguments)},findLastIndex(fn,thisArg){return apply(this,"findLastIndex",fn,thisArg,void 0,arguments)},forEach(fn,thisArg){return apply(this,"forEach",fn,thisArg,void 0,arguments)},includes(...args){return searchProxy(this,"includes",args)},indexOf(...args){return searchProxy(this,"indexOf",args)},join(separator){return reactiveReadArray(this).join(separator)},lastIndexOf(...args){return searchProxy(this,"lastIndexOf",args)},map(fn,thisArg){return apply(this,"map",fn,thisArg,void 0,arguments)},pop(){return noTracking(this,"pop")},push(...args){return noTracking(this,"push",args)},reduce(fn,...args){return reduce(this,"reduce",fn,args)},reduceRight(fn,...args){return reduce(this,"reduceRight",fn,args)},shift(){return noTracking(this,"shift")},some(fn,thisArg){return apply(this,"some",fn,thisArg,void 0,arguments)},splice(...args){return noTracking(this,"splice",args)},toReversed(){return reactiveReadArray(this).toReversed()},toSorted(comparer){return reactiveReadArray(this).toSorted(comparer)},toSpliced(...args){return reactiveReadArray(this).toSpliced(...args)},unshift(...args){return noTracking(this,"unshift",args)},values(){return iterator(this,"values",toReactive)}};function iterator(self,method,wrapValue){const arr=shallowReadArray(self),iter=arr[method]();return arr===self||isShallow(self)||(iter._next=iter.next,iter.next=()=>{const result=iter._next();return result.done||(result.value=wrapValue(result.value)),result}),iter}const arrayProto=Array.prototype;function apply(self,method,fn,thisArg,wrappedRetFn,args){const arr=shallowReadArray(self),needsWrap=arr!==self&&!isShallow(self),methodFn=arr[method];if(methodFn!==arrayProto[method]){const result2=methodFn.apply(self,args);return needsWrap?toReactive(result2):result2}let wrappedFn=fn;arr!==self&&(needsWrap?wrappedFn=function(item,index){return fn.call(this,toReactive(item),index,self)}:fn.length>2&&(wrappedFn=function(item,index){return fn.call(this,item,index,self)}));const result=methodFn.call(arr,wrappedFn,thisArg);return needsWrap&&wrappedRetFn?wrappedRetFn(result):result}function reduce(self,method,fn,args){const arr=shallowReadArray(self);let wrappedFn=fn;return arr!==self&&(isShallow(self)?fn.length>3&&(wrappedFn=function(acc,item,index){return fn.call(this,acc,item,index,self)}):wrappedFn=function(acc,item,index){return fn.call(this,acc,toReactive(item),index,self)}),arr[method](wrappedFn,...args)}function searchProxy(self,method,args){const arr=toRaw(self);track(arr,0,ARRAY_ITERATE_KEY);const res=arr[method](...args);return-1!==res&&!1!==res||!isProxy(args[0])?res:(args[0]=toRaw(args[0]),arr[method](...args))}function noTracking(self,method,args=[]){pauseTracking(),startBatch();const res=toRaw(self)[method].apply(self,args);return endBatch(),resetTracking(),res}const isNonTrackableKeys=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.pD)("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(key=>"arguments"!==key&&"caller"!==key).map(key=>Symbol[key]).filter(_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Bm));function hasOwnProperty(key){(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Bm)(key)||(key=String(key));const obj=toRaw(this);return track(obj,0,key),obj.hasOwnProperty(key)}class BaseReactiveHandler{constructor(_isReadonly=!1,_isShallow=!1){this._isReadonly=_isReadonly,this._isShallow=_isShallow}get(target,key,receiver){if("__v_skip"===key)return target.__v_skip;const isReadonly2=this._isReadonly,isShallow2=this._isShallow;if("__v_isReactive"===key)return!isReadonly2;if("__v_isReadonly"===key)return isReadonly2;if("__v_isShallow"===key)return isShallow2;if("__v_raw"===key)return receiver===(isReadonly2?isShallow2?shallowReadonlyMap:readonlyMap:isShallow2?shallowReactiveMap:reactiveMap).get(target)||Object.getPrototypeOf(target)===Object.getPrototypeOf(receiver)?target:void 0;const targetIsArray=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.cy)(target);if(!isReadonly2){let fn;if(targetIsArray&&(fn=arrayInstrumentations[key]))return fn;if("hasOwnProperty"===key)return hasOwnProperty}const res=Reflect.get(target,key,isRef(target)?target:receiver);if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Bm)(key)?builtInSymbols.has(key):isNonTrackableKeys(key))return res;if(isReadonly2||track(target,0,key),isShallow2)return res;if(isRef(res)){const value=targetIsArray&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.yI)(key)?res:res.value;return isReadonly2&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Gv)(value)?readonly(value):value}return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Gv)(res)?isReadonly2?readonly(res):reactive(res):res}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(isShallow2=!1){super(!1,isShallow2)}set(target,key,value,receiver){let oldValue=target[key];if(!this._isShallow){const isOldValueReadonly=isReadonly(oldValue);if(isShallow(value)||isReadonly(value)||(oldValue=toRaw(oldValue),value=toRaw(value)),!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.cy)(target)&&isRef(oldValue)&&!isRef(value))return isOldValueReadonly||(oldValue.value=value),!0}const hadKey=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.cy)(target)&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.yI)(key)?Number(key)<target.length:(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$3)(target,key),result=Reflect.set(target,key,value,isRef(target)?target:receiver);return target===toRaw(receiver)&&(hadKey?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$H)(value,oldValue)&&trigger(target,"set",key,value):trigger(target,"add",key,value)),result}deleteProperty(target,key){const hadKey=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$3)(target,key),result=(target[key],Reflect.deleteProperty(target,key));return result&&hadKey&&trigger(target,"delete",key,void 0),result}has(target,key){const result=Reflect.has(target,key);return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Bm)(key)&&builtInSymbols.has(key)||track(target,0,key),result}ownKeys(target){return track(target,0,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.cy)(target)?"length":ITERATE_KEY),Reflect.ownKeys(target)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(isShallow2=!1){super(!0,isShallow2)}set(target,key){return!0}deleteProperty(target,key){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=value=>value,getProto=v=>Reflect.getPrototypeOf(v);function createReadonlyMethod(type){return function(...args){return"delete"!==type&&("clear"===type?void 0:this)}}function createInstrumentations(readonly,shallow){const instrumentations={get(key){const target=this.__v_raw,rawTarget=toRaw(target),rawKey=toRaw(key);readonly||((0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$H)(key,rawKey)&&track(rawTarget,0,key),track(rawTarget,0,rawKey));const{has}=getProto(rawTarget),wrap=shallow?toShallow:readonly?toReadonly:toReactive;return has.call(rawTarget,key)?wrap(target.get(key)):has.call(rawTarget,rawKey)?wrap(target.get(rawKey)):void(target!==rawTarget&&target.get(key))},get size(){const target=this.__v_raw;return!readonly&&track(toRaw(target),0,ITERATE_KEY),target.size},has(key){const target=this.__v_raw,rawTarget=toRaw(target),rawKey=toRaw(key);return readonly||((0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$H)(key,rawKey)&&track(rawTarget,0,key),track(rawTarget,0,rawKey)),key===rawKey?target.has(key):target.has(key)||target.has(rawKey)},forEach(callback,thisArg){const observed=this,target=observed.__v_raw,rawTarget=toRaw(target),wrap=shallow?toShallow:readonly?toReadonly:toReactive;return!readonly&&track(rawTarget,0,ITERATE_KEY),target.forEach((value,key)=>callback.call(thisArg,wrap(value),wrap(key),observed))}};(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.X$)(instrumentations,readonly?{add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear")}:{add(value){shallow||isShallow(value)||isReadonly(value)||(value=toRaw(value));const target=toRaw(this);return getProto(target).has.call(target,value)||(target.add(value),trigger(target,"add",value,value)),this},set(key,value){shallow||isShallow(value)||isReadonly(value)||(value=toRaw(value));const target=toRaw(this),{has,get}=getProto(target);let hadKey=has.call(target,key);hadKey||(key=toRaw(key),hadKey=has.call(target,key));const oldValue=get.call(target,key);return target.set(key,value),hadKey?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$H)(value,oldValue)&&trigger(target,"set",key,value):trigger(target,"add",key,value),this},delete(key){const target=toRaw(this),{has,get}=getProto(target);let hadKey=has.call(target,key);hadKey||(key=toRaw(key),hadKey=has.call(target,key));get&&get.call(target,key);const result=target.delete(key);return hadKey&&trigger(target,"delete",key,void 0),result},clear(){const target=toRaw(this),hadItems=0!==target.size,result=target.clear();return hadItems&&trigger(target,"clear",void 0,void 0),result}});return["keys","values","entries",Symbol.iterator].forEach(method=>{instrumentations[method]=function createIterableMethod(method,isReadonly2,isShallow2){return function(...args){const target=this.__v_raw,rawTarget=toRaw(target),targetIsMap=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.CE)(rawTarget),isPair="entries"===method||method===Symbol.iterator&&targetIsMap,isKeyOnly="keys"===method&&targetIsMap,innerIterator=target[method](...args),wrap=isShallow2?toShallow:isReadonly2?toReadonly:toReactive;return!isReadonly2&&track(rawTarget,0,isKeyOnly?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value,done}=innerIterator.next();return done?{value,done}:{value:isPair?[wrap(value[0]),wrap(value[1])]:wrap(value),done}},[Symbol.iterator](){return this}}}}(method,readonly,shallow)}),instrumentations}function createInstrumentationGetter(isReadonly2,shallow){const instrumentations=createInstrumentations(isReadonly2,shallow);return(target,key,receiver)=>"__v_isReactive"===key?!isReadonly2:"__v_isReadonly"===key?isReadonly2:"__v_raw"===key?target:Reflect.get((0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$3)(instrumentations,key)&&key in target?instrumentations:target,key,receiver)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)};const reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function reactive(target){return isReadonly(target)?target:createReactiveObject(target,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(target){return createReactiveObject(target,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(target){return createReactiveObject(target,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(target,isReadonly2,baseHandlers,collectionHandlers,proxyMap){if(!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Gv)(target))return target;if(target.__v_raw&&(!isReadonly2||!target.__v_isReactive))return target;const targetType=function getTargetType(value){return value.__v_skip||!Object.isExtensible(value)?0:function targetTypeMap(rawType){switch(rawType){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Zf)(value))}(target);if(0===targetType)return target;const existingProxy=proxyMap.get(target);if(existingProxy)return existingProxy;const proxy=new Proxy(target,2===targetType?collectionHandlers:baseHandlers);return proxyMap.set(target,proxy),proxy}function isReactive(value){return isReadonly(value)?isReactive(value.__v_raw):!(!value||!value.__v_isReactive)}function isReadonly(value){return!(!value||!value.__v_isReadonly)}function isShallow(value){return!(!value||!value.__v_isShallow)}function isProxy(value){return!!value&&!!value.__v_raw}function toRaw(observed){const raw=observed&&observed.__v_raw;return raw?toRaw(raw):observed}function markRaw(value){return!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$3)(value,"__v_skip")&&Object.isExtensible(value)&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.yQ)(value,"__v_skip",!0),value}const toReactive=value=>(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Gv)(value)?reactive(value):value,toReadonly=value=>(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Gv)(value)?readonly(value):value;function isRef(r){return!!r&&!0===r.__v_isRef}function ref(value){return createRef(value,!1)}function shallowRef(value){return createRef(value,!0)}function createRef(rawValue,shallow){return isRef(rawValue)?rawValue:new RefImpl(rawValue,shallow)}class RefImpl{constructor(value,isShallow2){this.dep=new Dep,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=isShallow2?value:toRaw(value),this._value=isShallow2?value:toReactive(value),this.__v_isShallow=isShallow2}get value(){return this.dep.track(),this._value}set value(newValue){const oldValue=this._rawValue,useDirectValue=this.__v_isShallow||isShallow(newValue)||isReadonly(newValue);newValue=useDirectValue?newValue:toRaw(newValue),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$H)(newValue,oldValue)&&(this._rawValue=newValue,this._value=useDirectValue?newValue:toReactive(newValue),this.dep.trigger())}}function unref(ref2){return isRef(ref2)?ref2.value:ref2}const shallowUnwrapHandlers={get:(target,key,receiver)=>"__v_raw"===key?target:unref(Reflect.get(target,key,receiver)),set:(target,key,value,receiver)=>{const oldValue=target[key];return isRef(oldValue)&&!isRef(value)?(oldValue.value=value,!0):Reflect.set(target,key,value,receiver)}};function proxyRefs(objectWithRefs){return isReactive(objectWithRefs)?objectWithRefs:new Proxy(objectWithRefs,shallowUnwrapHandlers)}class ComputedRefImpl{constructor(fn,setter,isSSR){this.fn=fn,this.setter=setter,this._value=void 0,this.dep=new Dep(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=globalVersion-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!setter,this.isSSR=isSSR}notify(){if(this.flags|=16,!(8&this.flags||activeSub===this))return batch(this,!0),!0}get value(){const link=this.dep.track();return refreshComputed(this),link&&(link.version=this.dep.version),this._value}set value(newValue){this.setter&&this.setter(newValue)}}function computed(getterOrOptions,debugOptions,isSSR=!1){let getter,setter;(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Tn)(getterOrOptions)?getter=getterOrOptions:(getter=getterOrOptions.get,setter=getterOrOptions.set);return new ComputedRefImpl(getter,setter,isSSR)}const INITIAL_WATCHER_VALUE={},cleanupMap=new WeakMap;let activeWatcher;function watch(source,cb,options=_vue_shared__WEBPACK_IMPORTED_MODULE_0__.MZ){const{immediate,deep,once,scheduler,augmentJob,call}=options,reactiveGetter=source2=>deep?source2:isShallow(source2)||!1===deep||0===deep?traverse(source2,1):traverse(source2);let effect,getter,cleanup,boundCleanup,forceTrigger=!1,isMultiSource=!1;if(isRef(source)?(getter=()=>source.value,forceTrigger=isShallow(source)):isReactive(source)?(getter=()=>reactiveGetter(source),forceTrigger=!0):(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.cy)(source)?(isMultiSource=!0,forceTrigger=source.some(s=>isReactive(s)||isShallow(s)),getter=()=>source.map(s=>isRef(s)?s.value:isReactive(s)?reactiveGetter(s):(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Tn)(s)?call?call(s,2):s():void 0)):getter=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Tn)(source)?cb?call?()=>call(source,2):source:()=>{if(cleanup){pauseTracking();try{cleanup()}finally{resetTracking()}}const currentEffect=activeWatcher;activeWatcher=effect;try{return call?call(source,3,[boundCleanup]):source(boundCleanup)}finally{activeWatcher=currentEffect}}:_vue_shared__WEBPACK_IMPORTED_MODULE_0__.tE,cb&&deep){const baseGetter=getter,depth=!0===deep?1/0:deep;getter=()=>traverse(baseGetter(),depth)}const scope=function getCurrentScope(){return activeEffectScope}(),watchHandle=()=>{effect.stop(),scope&&scope.active&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.TF)(scope.effects,effect)};if(once&&cb){const _cb=cb;cb=(...args)=>{_cb(...args),watchHandle()}}let oldValue=isMultiSource?new Array(source.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const job=immediateFirstRun=>{if(1&effect.flags&&(effect.dirty||immediateFirstRun))if(cb){const newValue=effect.run();if(deep||forceTrigger||(isMultiSource?newValue.some((v,i)=>(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$H)(v,oldValue[i])):(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.$H)(newValue,oldValue))){cleanup&&cleanup();const currentWatcher=activeWatcher;activeWatcher=effect;try{const args=[newValue,oldValue===INITIAL_WATCHER_VALUE?void 0:isMultiSource&&oldValue[0]===INITIAL_WATCHER_VALUE?[]:oldValue,boundCleanup];oldValue=newValue,call?call(cb,3,args):cb(...args)}finally{activeWatcher=currentWatcher}}}else effect.run()};return augmentJob&&augmentJob(job),effect=new ReactiveEffect(getter),effect.scheduler=scheduler?()=>scheduler(job,!1):job,boundCleanup=fn=>function onWatcherCleanup(cleanupFn,failSilently=!1,owner=activeWatcher){if(owner){let cleanups=cleanupMap.get(owner);cleanups||cleanupMap.set(owner,cleanups=[]),cleanups.push(cleanupFn)}}(fn,!1,effect),cleanup=effect.onStop=()=>{const cleanups=cleanupMap.get(effect);if(cleanups){if(call)call(cleanups,4);else for(const cleanup2 of cleanups)cleanup2();cleanupMap.delete(effect)}},cb?immediate?job(!0):oldValue=effect.run():scheduler?scheduler(job.bind(null,!0),!0):effect.run(),watchHandle.pause=effect.pause.bind(effect),watchHandle.resume=effect.resume.bind(effect),watchHandle.stop=watchHandle,watchHandle}function traverse(value,depth=1/0,seen){if(depth<=0||!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Gv)(value)||value.__v_skip)return value;if(((seen=seen||new Map).get(value)||0)>=depth)return value;if(seen.set(value,depth),depth--,isRef(value))traverse(value.value,depth,seen);else if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.cy)(value))for(let i=0;i<value.length;i++)traverse(value[i],depth,seen);else if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.vM)(value)||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.CE)(value))value.forEach(v=>{traverse(v,depth,seen)});else if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_0__.Qd)(value)){for(const key in value)traverse(value[key],depth,seen);for(const key of Object.getOwnPropertySymbols(value))Object.prototype.propertyIsEnumerable.call(value,key)&&traverse(value[key],depth,seen)}return value}},"./node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$u:()=>onUpdated,Df:()=>getTransitionRawChildren,EW:()=>computed,FK:()=>Fragment,Gy:()=>useTransitionState,K9:()=>createRenderer,MZ:()=>setTransitionHooks,OW:()=>resolveTransitionHooks,QP:()=>BaseTransitionPropsValidators,bF:()=>createVNode,dY:()=>nextTick,h:()=>h,hi:()=>onUnmounted,nI:()=>getCurrentInstance,nT:()=>watchEffect,pM:()=>defineComponent,qL:()=>callWithAsyncErrorHandling,sV:()=>onMounted,wB:()=>watch});var _vue_reactivity__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js"),_vue_shared__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@vue/shared/dist/shared.esm-bundler.js");function callWithErrorHandling(fn,instance,type,args){try{return args?fn(...args):fn()}catch(err){handleError(err,instance,type)}}function callWithAsyncErrorHandling(fn,instance,type,args){if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(fn)){const res=callWithErrorHandling(fn,instance,type,args);return res&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.yL)(res)&&res.catch(err=>{handleError(err,instance,type)}),res}if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(fn)){const values=[];for(let i=0;i<fn.length;i++)values.push(callWithAsyncErrorHandling(fn[i],instance,type,args));return values}}function handleError(err,instance,type,throwInDev=!0){instance&&instance.vnode;const{errorHandler,throwUnhandledErrorInProduction}=instance&&instance.appContext.config||_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ;if(instance){let cur=instance.parent;const exposedInstance=instance.proxy,errorInfo=`https://vuejs.org/error-reference/#runtime-${type}`;for(;cur;){const errorCapturedHooks=cur.ec;if(errorCapturedHooks)for(let i=0;i<errorCapturedHooks.length;i++)if(!1===errorCapturedHooks[i](err,exposedInstance,errorInfo))return;cur=cur.parent}if(errorHandler)return(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.C4)(),callWithErrorHandling(errorHandler,null,10,[err,exposedInstance,errorInfo]),void(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.bl)()}!function logError(err,type,contextVNode,throwInDev=!0,throwInProd=!1){if(throwInProd)throw err;console.error(err)}(err,0,0,throwInDev,throwUnhandledErrorInProduction)}const queue=[];let flushIndex=-1;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(fn){const p=currentFlushPromise||resolvedPromise;return fn?p.then(this?fn.bind(this):fn):p}function queueJob(job){if(!(1&job.flags)){const jobId=getId(job),lastJob=queue[queue.length-1];!lastJob||!(2&job.flags)&&jobId>=getId(lastJob)?queue.push(job):queue.splice(function findInsertionIndex(id){let start=flushIndex+1,end=queue.length;for(;start<end;){const middle=start+end>>>1,middleJob=queue[middle],middleJobId=getId(middleJob);middleJobId<id||middleJobId===id&&2&middleJob.flags?start=middle+1:end=middle}return start}(jobId),0,job),job.flags|=1,queueFlush()}}function queueFlush(){currentFlushPromise||(currentFlushPromise=resolvedPromise.then(flushJobs))}function queuePostFlushCb(cb){(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(cb)?pendingPostFlushCbs.push(...cb):activePostFlushCbs&&-1===cb.id?activePostFlushCbs.splice(postFlushIndex+1,0,cb):1&cb.flags||(pendingPostFlushCbs.push(cb),cb.flags|=1),queueFlush()}function flushPreFlushCbs(instance,seen,i=flushIndex+1){for(0;i<queue.length;i++){const cb=queue[i];if(cb&&2&cb.flags){if(instance&&cb.id!==instance.uid)continue;0,queue.splice(i,1),i--,4&cb.flags&&(cb.flags&=-2),cb(),4&cb.flags||(cb.flags&=-2)}}}function flushPostFlushCbs(seen){if(pendingPostFlushCbs.length){const deduped=[...new Set(pendingPostFlushCbs)].sort((a,b)=>getId(a)-getId(b));if(pendingPostFlushCbs.length=0,activePostFlushCbs)return void activePostFlushCbs.push(...deduped);for(activePostFlushCbs=deduped,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++){const cb=activePostFlushCbs[postFlushIndex];0,4&cb.flags&&(cb.flags&=-2),8&cb.flags||cb(),cb.flags&=-2}activePostFlushCbs=null,postFlushIndex=0}}const getId=job=>null==job.id?2&job.flags?-1:1/0:job.id;function flushJobs(seen){_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const job=queue[flushIndex];!job||8&job.flags||(4&job.flags&&(job.flags&=-2),callWithErrorHandling(job,job.i,job.i?15:14),4&job.flags||(job.flags&=-2))}}finally{for(;flushIndex<queue.length;flushIndex++){const job=queue[flushIndex];job&&(job.flags&=-2)}flushIndex=-1,queue.length=0,flushPostFlushCbs(),currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs(seen)}}let devtools$1,buffer=[],devtoolsNotInstalled=!1;function emit$1(event,...args){devtools$1?devtools$1.emit(event,...args):devtoolsNotInstalled||buffer.push({event,args})}function setDevtoolsHook$1(hook,target){var _a,_b;if(devtools$1=hook,devtools$1)devtools$1.enabled=!0,buffer.forEach(({event,args})=>devtools$1.emit(event,...args)),buffer=[];else if("undefined"!=typeof window&&window.HTMLElement&&!(null==(_b=null==(_a=window.navigator)?void 0:_a.userAgent)?void 0:_b.includes("jsdom"))){(target.__VUE_DEVTOOLS_HOOK_REPLAY__=target.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(newHook=>{setDevtoolsHook$1(newHook,target)}),setTimeout(()=>{devtools$1||(target.__VUE_DEVTOOLS_HOOK_REPLAY__=null,devtoolsNotInstalled=!0,buffer=[])},3e3)}else devtoolsNotInstalled=!0,buffer=[]}const devtoolsComponentAdded=createDevtoolsComponentHook("component:added"),devtoolsComponentUpdated=createDevtoolsComponentHook("component:updated"),_devtoolsComponentRemoved=createDevtoolsComponentHook("component:removed"),devtoolsComponentRemoved=component=>{devtools$1&&"function"==typeof devtools$1.cleanupBuffer&&!devtools$1.cleanupBuffer(component)&&_devtoolsComponentRemoved(component)};function createDevtoolsComponentHook(hook){return component=>{emit$1(hook,component.appContext.app,component.uid,component.parent?component.parent.uid:void 0,component)}}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(instance){const prev=currentRenderingInstance;return currentRenderingInstance=instance,currentScopeId=instance&&instance.type.__scopeId||null,prev}function withCtx(fn,ctx=currentRenderingInstance,isNonScopedSlot){if(!ctx)return fn;if(fn._n)return fn;const renderFnWithContext=(...args)=>{renderFnWithContext._d&&setBlockTracking(-1);const prevInstance=setCurrentRenderingInstance(ctx);let res;try{res=fn(...args)}finally{setCurrentRenderingInstance(prevInstance),renderFnWithContext._d&&setBlockTracking(1)}return __VUE_PROD_DEVTOOLS__&&devtoolsComponentUpdated(ctx),res};return renderFnWithContext._n=!0,renderFnWithContext._c=!0,renderFnWithContext._d=!0,renderFnWithContext}function invokeDirectiveHook(vnode,prevVNode,instance,name){const bindings=vnode.dirs,oldBindings=prevVNode&&prevVNode.dirs;for(let i=0;i<bindings.length;i++){const binding=bindings[i];oldBindings&&(binding.oldValue=oldBindings[i].value);let hook=binding.dir[name];hook&&((0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.C4)(),callWithAsyncErrorHandling(hook,instance,8,[vnode.el,binding,vnode,prevVNode]),(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.bl)())}}const TeleportEndKey=Symbol("_vte"),isTeleport=type=>type.__isTeleport;const leaveCbKey=Symbol("_leaveCb"),enterCbKey=Symbol("_enterCb");function useTransitionState(){const state={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{state.isMounted=!0}),onBeforeUnmount(()=>{state.isUnmounting=!0}),state}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator};function getLeavingNodesForType(state,vnode){const{leavingVNodes}=state;let leavingVNodesCache=leavingVNodes.get(vnode.type);return leavingVNodesCache||(leavingVNodesCache=Object.create(null),leavingVNodes.set(vnode.type,leavingVNodesCache)),leavingVNodesCache}function resolveTransitionHooks(vnode,props,state,instance,postClone){const{appear,mode,persisted=!1,onBeforeEnter,onEnter,onAfterEnter,onEnterCancelled,onBeforeLeave,onLeave,onAfterLeave,onLeaveCancelled,onBeforeAppear,onAppear,onAfterAppear,onAppearCancelled}=props,key=String(vnode.key),leavingVNodesCache=getLeavingNodesForType(state,vnode),callHook=(hook,args)=>{hook&&callWithAsyncErrorHandling(hook,instance,9,args)},callAsyncHook=(hook,args)=>{const done=args[1];callHook(hook,args),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(hook)?hook.every(hook2=>hook2.length<=1)&&done():hook.length<=1&&done()},hooks={mode,persisted,beforeEnter(el){let hook=onBeforeEnter;if(!state.isMounted){if(!appear)return;hook=onBeforeAppear||onBeforeEnter}el[leaveCbKey]&&el[leaveCbKey](!0);const leavingVNode=leavingVNodesCache[key];leavingVNode&&isSameVNodeType(vnode,leavingVNode)&&leavingVNode.el[leaveCbKey]&&leavingVNode.el[leaveCbKey](),callHook(hook,[el])},enter(el){let hook=onEnter,afterHook=onAfterEnter,cancelHook=onEnterCancelled;if(!state.isMounted){if(!appear)return;hook=onAppear||onEnter,afterHook=onAfterAppear||onAfterEnter,cancelHook=onAppearCancelled||onEnterCancelled}let called=!1;const done=el[enterCbKey]=cancelled=>{called||(called=!0,callHook(cancelled?cancelHook:afterHook,[el]),hooks.delayedLeave&&hooks.delayedLeave(),el[enterCbKey]=void 0)};hook?callAsyncHook(hook,[el,done]):done()},leave(el,remove){const key2=String(vnode.key);if(el[enterCbKey]&&el[enterCbKey](!0),state.isUnmounting)return remove();callHook(onBeforeLeave,[el]);let called=!1;const done=el[leaveCbKey]=cancelled=>{called||(called=!0,remove(),callHook(cancelled?onLeaveCancelled:onAfterLeave,[el]),el[leaveCbKey]=void 0,leavingVNodesCache[key2]===vnode&&delete leavingVNodesCache[key2])};leavingVNodesCache[key2]=vnode,onLeave?callAsyncHook(onLeave,[el,done]):done()},clone(vnode2){const hooks2=resolveTransitionHooks(vnode2,props,state,instance,postClone);return postClone&&postClone(hooks2),hooks2}};return hooks}function setTransitionHooks(vnode,hooks){6&vnode.shapeFlag&&vnode.component?(vnode.transition=hooks,setTransitionHooks(vnode.component.subTree,hooks)):128&vnode.shapeFlag?(vnode.ssContent.transition=hooks.clone(vnode.ssContent),vnode.ssFallback.transition=hooks.clone(vnode.ssFallback)):vnode.transition=hooks}function getTransitionRawChildren(children,keepComment=!1,parentKey){let ret=[],keyedFragmentCount=0;for(let i=0;i<children.length;i++){let child=children[i];const key=null==parentKey?child.key:String(parentKey)+String(null!=child.key?child.key:i);child.type===Fragment?(128&child.patchFlag&&keyedFragmentCount++,ret=ret.concat(getTransitionRawChildren(child.children,keepComment,key))):(keepComment||child.type!==Comment)&&ret.push(null!=key?cloneVNode(child,{key}):child)}if(keyedFragmentCount>1)for(let i=0;i<ret.length;i++)ret[i].patchFlag=-2;return ret}function defineComponent(options,extraOptions){return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(options)?(()=>(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)({name:options.name},extraOptions,{setup:options}))():options}function markAsyncBoundary(instance){instance.ids=[instance.ids[0]+instance.ids[2]+++"-",0,0]}const pendingSetRefMap=new WeakMap;function setRef(rawRef,oldRawRef,parentSuspense,vnode,isUnmount=!1){if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(rawRef))return void rawRef.forEach((r,i)=>setRef(r,oldRawRef&&((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(oldRawRef)?oldRawRef[i]:oldRawRef),parentSuspense,vnode,isUnmount));if(isAsyncWrapper(vnode)&&!isUnmount)return void(512&vnode.shapeFlag&&vnode.type.__asyncResolved&&vnode.component.subTree.component&&setRef(rawRef,oldRawRef,parentSuspense,vnode.component.subTree));const refValue=4&vnode.shapeFlag?getComponentPublicInstance(vnode.component):vnode.el,value=isUnmount?null:refValue,{i:owner,r:ref}=rawRef;const oldRef=oldRawRef&&oldRawRef.r,refs=owner.refs===_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ?owner.refs={}:owner.refs,setupState=owner.setupState,rawSetupState=(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.ux)(setupState),canSetSetupRef=setupState===_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ?_vue_shared__WEBPACK_IMPORTED_MODULE_1__.NO:key=>(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(rawSetupState,key);if(null!=oldRef&&oldRef!==ref)if(invalidatePendingSetRef(oldRawRef),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(oldRef))refs[oldRef]=null,canSetSetupRef(oldRef)&&(setupState[oldRef]=null);else if((0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.i9)(oldRef)){oldRef.value=null;const oldRawRefAtom=oldRawRef;oldRawRefAtom.k&&(refs[oldRawRefAtom.k]=null)}if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(ref))callWithErrorHandling(ref,owner,12,[value,refs]);else{const _isString=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(ref),_isRef=(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.i9)(ref);if(_isString||_isRef){const doSet=()=>{if(rawRef.f){const existing=_isString?canSetSetupRef(ref)?setupState[ref]:refs[ref]:ref.value;if(isUnmount)(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(existing)&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.TF)(existing,refValue);else if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(existing))existing.includes(refValue)||existing.push(refValue);else if(_isString)refs[ref]=[refValue],canSetSetupRef(ref)&&(setupState[ref]=refs[ref]);else{const newVal=[refValue];ref.value=newVal,rawRef.k&&(refs[rawRef.k]=newVal)}}else _isString?(refs[ref]=value,canSetSetupRef(ref)&&(setupState[ref]=value)):_isRef&&(ref.value=value,rawRef.k&&(refs[rawRef.k]=value))};if(value){const job=()=>{doSet(),pendingSetRefMap.delete(rawRef)};job.id=-1,pendingSetRefMap.set(rawRef,job),queuePostRenderEffect(job,parentSuspense)}else invalidatePendingSetRef(rawRef),doSet()}else 0}}function invalidatePendingSetRef(rawRef){const pendingSetRef=pendingSetRefMap.get(rawRef);pendingSetRef&&(pendingSetRef.flags|=8,pendingSetRefMap.delete(rawRef))}(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.We)().requestIdleCallback,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.We)().cancelIdleCallback;const isAsyncWrapper=i=>!!i.type.__asyncLoader;const isKeepAlive=vnode=>vnode.type.__isKeepAlive;RegExp,RegExp;function matches(pattern,name){return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(pattern)?pattern.some(p=>matches(p,name)):(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(pattern)?pattern.split(",").includes(name):!!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.gd)(pattern)&&(pattern.lastIndex=0,pattern.test(name))}function onActivated(hook,target){registerKeepAliveHook(hook,"a",target)}function onDeactivated(hook,target){registerKeepAliveHook(hook,"da",target)}function registerKeepAliveHook(hook,type,target=currentInstance){const wrappedHook=hook.__wdc||(hook.__wdc=()=>{let current=target;for(;current;){if(current.isDeactivated)return;current=current.parent}return hook()});if(injectHook(type,wrappedHook,target),target){let current=target.parent;for(;current&&current.parent;)isKeepAlive(current.parent.vnode)&&injectToKeepAliveRoot(wrappedHook,type,target,current),current=current.parent}}function injectToKeepAliveRoot(hook,type,target,keepAliveRoot){const injected=injectHook(type,hook,keepAliveRoot,!0);onUnmounted(()=>{(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.TF)(keepAliveRoot[type],injected)},target)}function resetShapeFlag(vnode){vnode.shapeFlag&=-257,vnode.shapeFlag&=-513}function getInnerChild(vnode){return 128&vnode.shapeFlag?vnode.ssContent:vnode}function injectHook(type,hook,target=currentInstance,prepend=!1){if(target){const hooks=target[type]||(target[type]=[]),wrappedHook=hook.__weh||(hook.__weh=(...args)=>{(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.C4)();const reset=setCurrentInstance(target),res=callWithAsyncErrorHandling(hook,target,type,args);return reset(),(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.bl)(),res});return prepend?hooks.unshift(wrappedHook):hooks.push(wrappedHook),wrappedHook}}const createHook=lifecycle=>(hook,target=currentInstance)=>{isInSSRComponentSetup&&"sp"!==lifecycle||injectHook(lifecycle,(...args)=>hook(...args),target)},onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(hook,target=currentInstance){injectHook("ec",hook,target)}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");const getPublicInstance=i=>i?isStatefulComponent(i)?getComponentPublicInstance(i):getPublicInstance(i.parent):null,publicPropertiesMap=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>getPublicInstance(i.parent),$root:i=>getPublicInstance(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>__VUE_OPTIONS_API__?resolveMergedOptions(i):i.type,$forceUpdate:i=>i.f||(i.f=()=>{queueJob(i.update)}),$nextTick:i=>i.n||(i.n=nextTick.bind(i.proxy)),$watch:i=>__VUE_OPTIONS_API__?instanceWatch.bind(i):_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE}),hasSetupBinding=(state,key)=>state!==_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ&&!state.__isScriptSetup&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(state,key),PublicInstanceProxyHandlers={get({_:instance},key){if("__v_skip"===key)return!0;const{ctx,setupState,data,props,accessCache,type,appContext}=instance;let normalizedProps;if("$"!==key[0]){const n=accessCache[key];if(void 0!==n)switch(n){case 1:return setupState[key];case 2:return data[key];case 4:return ctx[key];case 3:return props[key]}else{if(hasSetupBinding(setupState,key))return accessCache[key]=1,setupState[key];if(data!==_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(data,key))return accessCache[key]=2,data[key];if((normalizedProps=instance.propsOptions[0])&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(normalizedProps,key))return accessCache[key]=3,props[key];if(ctx!==_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(ctx,key))return accessCache[key]=4,ctx[key];__VUE_OPTIONS_API__&&!shouldCacheAccess||(accessCache[key]=0)}}const publicGetter=publicPropertiesMap[key];let cssModule,globalProperties;return publicGetter?("$attrs"===key&&(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.u4)(instance.attrs,"get",""),publicGetter(instance)):(cssModule=type.__cssModules)&&(cssModule=cssModule[key])?cssModule:ctx!==_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(ctx,key)?(accessCache[key]=4,ctx[key]):(globalProperties=appContext.config.globalProperties,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(globalProperties,key)?globalProperties[key]:void 0)},set({_:instance},key,value){const{data,setupState,ctx}=instance;return hasSetupBinding(setupState,key)?(setupState[key]=value,!0):data!==_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(data,key)?(data[key]=value,!0):!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(instance.props,key)&&(("$"!==key[0]||!(key.slice(1)in instance))&&(ctx[key]=value,!0))},has({_:{data,setupState,accessCache,ctx,appContext,propsOptions,type}},key){let normalizedProps,cssModules;return!!(accessCache[key]||data!==_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ&&"$"!==key[0]&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(data,key)||hasSetupBinding(setupState,key)||(normalizedProps=propsOptions[0])&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(normalizedProps,key)||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(ctx,key)||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(publicPropertiesMap,key)||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(appContext.config.globalProperties,key)||(cssModules=type.__cssModules)&&cssModules[key])},defineProperty(target,key,descriptor){return null!=descriptor.get?target._.accessCache[key]=0:(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(descriptor,"value")&&this.set(target,key,descriptor.value,null),Reflect.defineProperty(target,key,descriptor)}};function normalizePropsOrEmits(props){return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(props)?props.reduce((normalized,p)=>(normalized[p]=null,normalized),{}):props}let shouldCacheAccess=!0;function applyOptions(instance){const options=resolveMergedOptions(instance),publicThis=instance.proxy,ctx=instance.ctx;shouldCacheAccess=!1,options.beforeCreate&&callHook(options.beforeCreate,instance,"bc");const{data:dataOptions,computed:computedOptions,methods,watch:watchOptions,provide:provideOptions,inject:injectOptions,created,beforeMount,mounted,beforeUpdate,updated,activated,deactivated,beforeDestroy,beforeUnmount,destroyed,unmounted,render,renderTracked,renderTriggered,errorCaptured,serverPrefetch,expose,inheritAttrs,components,directives,filters}=options;if(injectOptions&&function resolveInjections(injectOptions,ctx,checkDuplicateProperties=_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE){(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(injectOptions)&&(injectOptions=normalizeInject(injectOptions));for(const key in injectOptions){const opt=injectOptions[key];let injected;injected=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(opt)?"default"in opt?inject(opt.from||key,opt.default,!0):inject(opt.from||key):inject(opt),(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.i9)(injected)?Object.defineProperty(ctx,key,{enumerable:!0,configurable:!0,get:()=>injected.value,set:v=>injected.value=v}):ctx[key]=injected}}(injectOptions,ctx,null),methods)for(const key in methods){const methodHandler=methods[key];(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(methodHandler)&&(ctx[key]=methodHandler.bind(publicThis))}if(dataOptions){0;const data=dataOptions.call(publicThis,publicThis);0,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(data)&&(instance.data=(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.Kh)(data))}if(shouldCacheAccess=!0,computedOptions)for(const key in computedOptions){const opt=computedOptions[key],get=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(opt)?opt.bind(publicThis,publicThis):(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(opt.get)?opt.get.bind(publicThis,publicThis):_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE;0;const set=!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(opt)&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(opt.set)?opt.set.bind(publicThis):_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE,c=computed({get,set});Object.defineProperty(ctx,key,{enumerable:!0,configurable:!0,get:()=>c.value,set:v=>c.value=v})}if(watchOptions)for(const key in watchOptions)createWatcher(watchOptions[key],ctx,publicThis,key);if(provideOptions){const provides=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(provideOptions)?provideOptions.call(publicThis):provideOptions;Reflect.ownKeys(provides).forEach(key=>{!function provide(key,value){if(currentInstance){let provides=currentInstance.provides;const parentProvides=currentInstance.parent&&currentInstance.parent.provides;parentProvides===provides&&(provides=currentInstance.provides=Object.create(parentProvides)),provides[key]=value}else 0}(key,provides[key])})}function registerLifecycleHook(register,hook){(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(hook)?hook.forEach(_hook=>register(_hook.bind(publicThis))):hook&&register(hook.bind(publicThis))}if(created&&callHook(created,instance,"c"),registerLifecycleHook(onBeforeMount,beforeMount),registerLifecycleHook(onMounted,mounted),registerLifecycleHook(onBeforeUpdate,beforeUpdate),registerLifecycleHook(onUpdated,updated),registerLifecycleHook(onActivated,activated),registerLifecycleHook(onDeactivated,deactivated),registerLifecycleHook(onErrorCaptured,errorCaptured),registerLifecycleHook(onRenderTracked,renderTracked),registerLifecycleHook(onRenderTriggered,renderTriggered),registerLifecycleHook(onBeforeUnmount,beforeUnmount),registerLifecycleHook(onUnmounted,unmounted),registerLifecycleHook(onServerPrefetch,serverPrefetch),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(expose))if(expose.length){const exposed=instance.exposed||(instance.exposed={});expose.forEach(key=>{Object.defineProperty(exposed,key,{get:()=>publicThis[key],set:val=>publicThis[key]=val,enumerable:!0})})}else instance.exposed||(instance.exposed={});render&&instance.render===_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE&&(instance.render=render),null!=inheritAttrs&&(instance.inheritAttrs=inheritAttrs),components&&(instance.components=components),directives&&(instance.directives=directives),serverPrefetch&&markAsyncBoundary(instance)}function callHook(hook,instance,type){callWithAsyncErrorHandling((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(hook)?hook.map(h=>h.bind(instance.proxy)):hook.bind(instance.proxy),instance,type)}function createWatcher(raw,ctx,publicThis,key){let getter=key.includes(".")?createPathGetter(publicThis,key):()=>publicThis[key];if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(raw)){const handler=ctx[raw];(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(handler)&&watch(getter,handler)}else if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(raw))watch(getter,raw.bind(publicThis));else if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(raw))if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(raw))raw.forEach(r=>createWatcher(r,ctx,publicThis,key));else{const handler=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(raw.handler)?raw.handler.bind(publicThis):ctx[raw.handler];(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(handler)&&watch(getter,handler,raw)}else 0}function resolveMergedOptions(instance){const base=instance.type,{mixins,extends:extendsOptions}=base,{mixins:globalMixins,optionsCache:cache,config:{optionMergeStrategies}}=instance.appContext,cached=cache.get(base);let resolved;return cached?resolved=cached:globalMixins.length||mixins||extendsOptions?(resolved={},globalMixins.length&&globalMixins.forEach(m=>mergeOptions(resolved,m,optionMergeStrategies,!0)),mergeOptions(resolved,base,optionMergeStrategies)):resolved=base,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(base)&&cache.set(base,resolved),resolved}function mergeOptions(to,from,strats,asMixin=!1){const{mixins,extends:extendsOptions}=from;extendsOptions&&mergeOptions(to,extendsOptions,strats,!0),mixins&&mixins.forEach(m=>mergeOptions(to,m,strats,!0));for(const key in from)if(asMixin&&"expose"===key);else{const strat=internalOptionMergeStrats[key]||strats&&strats[key];to[key]=strat?strat(to[key],from[key]):from[key]}return to}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:function mergeWatchOptions(to,from){if(!to)return from;if(!from)return to;const merged=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)(Object.create(null),to);for(const key in from)merged[key]=mergeAsArray(to[key],from[key]);return merged},provide:mergeDataFn,inject:function mergeInject(to,from){return mergeObjectOptions(normalizeInject(to),normalizeInject(from))}};function mergeDataFn(to,from){return from?to?function mergedDataFn(){return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(to)?to.call(this,this):to,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(from)?from.call(this,this):from)}:from:to}function normalizeInject(raw){if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(raw)){const res={};for(let i=0;i<raw.length;i++)res[raw[i]]=raw[i];return res}return raw}function mergeAsArray(to,from){return to?[...new Set([].concat(to,from))]:from}function mergeObjectOptions(to,from){return to?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)(Object.create(null),to,from):from}function mergeEmitsOrPropsOptions(to,from){return to?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(to)&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(from)?[...new Set([...to,...from])]:(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)(Object.create(null),normalizePropsOrEmits(to),normalizePropsOrEmits(null!=from?from:{})):from}function createAppContext(){return{app:null,config:{isNativeTag:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(render,hydrate){return function createApp(rootComponent,rootProps=null){(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(rootComponent)||(rootComponent=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)({},rootComponent)),null==rootProps||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(rootProps)||(rootProps=null);const context=createAppContext(),installedPlugins=new WeakSet,pluginCleanupFns=[];let isMounted=!1;const app=context.app={_uid:uid$1++,_component:rootComponent,_props:rootProps,_container:null,_context:context,_instance:null,version,get config(){return context.config},set config(v){0},use:(plugin,...options)=>(installedPlugins.has(plugin)||(plugin&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(plugin.install)?(installedPlugins.add(plugin),plugin.install(app,...options)):(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(plugin)&&(installedPlugins.add(plugin),plugin(app,...options))),app),mixin:mixin=>(__VUE_OPTIONS_API__&&(context.mixins.includes(mixin)||context.mixins.push(mixin)),app),component:(name,component)=>component?(context.components[name]=component,app):context.components[name],directive:(name,directive)=>directive?(context.directives[name]=directive,app):context.directives[name],mount(rootContainer,isHydrate,namespace){if(!isMounted){0;const vnode=app._ceVNode||createVNode(rootComponent,rootProps);return vnode.appContext=context,!0===namespace?namespace="svg":!1===namespace&&(namespace=void 0),isHydrate&&hydrate?hydrate(vnode,rootContainer):render(vnode,rootContainer,namespace),isMounted=!0,app._container=rootContainer,rootContainer.__vue_app__=app,__VUE_PROD_DEVTOOLS__&&(app._instance=vnode.component,function devtoolsInitApp(app,version){emit$1("app:init",app,version,{Fragment,Text,Comment,Static})}(app,version)),getComponentPublicInstance(vnode.component)}},onUnmount(cleanupFn){pluginCleanupFns.push(cleanupFn)},unmount(){isMounted&&(callWithAsyncErrorHandling(pluginCleanupFns,app._instance,16),render(null,app._container),__VUE_PROD_DEVTOOLS__&&(app._instance=null,function devtoolsUnmountApp(app){emit$1("app:unmount",app)}(app)),delete app._container.__vue_app__)},provide:(key,value)=>(context.provides[key]=value,app),runWithContext(fn){const lastApp=currentApp;currentApp=app;try{return fn()}finally{currentApp=lastApp}}};return app}}let currentApp=null;function inject(key,defaultValue,treatDefaultAsFactory=!1){const instance=getCurrentInstance();if(instance||currentApp){let provides=currentApp?currentApp._context.provides:instance?null==instance.parent||instance.ce?instance.vnode.appContext&&instance.vnode.appContext.provides:instance.parent.provides:void 0;if(provides&&key in provides)return provides[key];if(arguments.length>1)return treatDefaultAsFactory&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(defaultValue)?defaultValue.call(instance&&instance.proxy):defaultValue}else 0}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=obj=>Object.getPrototypeOf(obj)===internalObjectProto;function setFullProps(instance,rawProps,props,attrs){const[options,needCastKeys]=instance.propsOptions;let rawCastValues,hasAttrsChanged=!1;if(rawProps)for(let key in rawProps){if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.SU)(key))continue;const value=rawProps[key];let camelKey;options&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(options,camelKey=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.PT)(key))?needCastKeys&&needCastKeys.includes(camelKey)?(rawCastValues||(rawCastValues={}))[camelKey]=value:props[camelKey]=value:isEmitListener(instance.emitsOptions,key)||key in attrs&&value===attrs[key]||(attrs[key]=value,hasAttrsChanged=!0)}if(needCastKeys){const rawCurrentProps=(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.ux)(props),castValues=rawCastValues||_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ;for(let i=0;i<needCastKeys.length;i++){const key=needCastKeys[i];props[key]=resolvePropValue(options,rawCurrentProps,key,castValues[key],instance,!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(castValues,key))}}return hasAttrsChanged}function resolvePropValue(options,props,key,value,instance,isAbsent){const opt=options[key];if(null!=opt){const hasDefault=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(opt,"default");if(hasDefault&&void 0===value){const defaultValue=opt.default;if(opt.type!==Function&&!opt.skipFactory&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(defaultValue)){const{propsDefaults}=instance;if(key in propsDefaults)value=propsDefaults[key];else{const reset=setCurrentInstance(instance);value=propsDefaults[key]=defaultValue.call(null,props),reset()}}else value=defaultValue;instance.ce&&instance.ce._setProp(key,value)}opt[0]&&(isAbsent&&!hasDefault?value=!1:!opt[1]||""!==value&&value!==(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tg)(key)||(value=!0))}return value}const mixinPropsCache=new WeakMap;function normalizePropsOptions(comp,appContext,asMixin=!1){const cache=__VUE_OPTIONS_API__&&asMixin?mixinPropsCache:appContext.propsCache,cached=cache.get(comp);if(cached)return cached;const raw=comp.props,normalized={},needCastKeys=[];let hasExtends=!1;if(__VUE_OPTIONS_API__&&!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(comp)){const extendProps=raw2=>{hasExtends=!0;const[props,keys]=normalizePropsOptions(raw2,appContext,!0);(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)(normalized,props),keys&&needCastKeys.push(...keys)};!asMixin&&appContext.mixins.length&&appContext.mixins.forEach(extendProps),comp.extends&&extendProps(comp.extends),comp.mixins&&comp.mixins.forEach(extendProps)}if(!raw&&!hasExtends)return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(comp)&&cache.set(comp,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Oj),_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Oj;if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(raw))for(let i=0;i<raw.length;i++){0;const normalizedKey=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.PT)(raw[i]);validatePropName(normalizedKey)&&(normalized[normalizedKey]=_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ)}else if(raw){0;for(const key in raw){const normalizedKey=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.PT)(key);if(validatePropName(normalizedKey)){const opt=raw[key],prop=normalized[normalizedKey]=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(opt)||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(opt)?{type:opt}:(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)({},opt),propType=prop.type;let shouldCast=!1,shouldCastTrue=!0;if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(propType))for(let index=0;index<propType.length;++index){const type=propType[index],typeName=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(type)&&type.name;if("Boolean"===typeName){shouldCast=!0;break}"String"===typeName&&(shouldCastTrue=!1)}else shouldCast=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(propType)&&"Boolean"===propType.name;prop[0]=shouldCast,prop[1]=shouldCastTrue,(shouldCast||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(prop,"default"))&&needCastKeys.push(normalizedKey)}}}const res=[normalized,needCastKeys];return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(comp)&&cache.set(comp,res),res}function validatePropName(key){return"$"!==key[0]&&!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.SU)(key)}const isInternalKey=key=>"_"===key||"_ctx"===key||"$stable"===key,normalizeSlotValue=value=>(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(value)?value.map(normalizeVNode):[normalizeVNode(value)],normalizeSlot=(key,rawSlot,ctx)=>{if(rawSlot._n)return rawSlot;const normalized=withCtx((...args)=>normalizeSlotValue(rawSlot(...args)),ctx);return normalized._c=!1,normalized},normalizeObjectSlots=(rawSlots,slots,instance)=>{const ctx=rawSlots._ctx;for(const key in rawSlots){if(isInternalKey(key))continue;const value=rawSlots[key];if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(value))slots[key]=normalizeSlot(0,value,ctx);else if(null!=value){0;const normalized=normalizeSlotValue(value);slots[key]=()=>normalized}}},normalizeVNodeSlots=(instance,children)=>{const normalized=normalizeSlotValue(children);instance.slots.default=()=>normalized},assignSlots=(slots,children,optimized)=>{for(const key in children)!optimized&&isInternalKey(key)||(slots[key]=children[key])},initSlots=(instance,children,optimized)=>{const slots=instance.slots=createInternalObject();if(32&instance.vnode.shapeFlag){const type=children._;type?(assignSlots(slots,children,optimized),optimized&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.yQ)(slots,"_",type,!0)):normalizeObjectSlots(children,slots)}else children&&normalizeVNodeSlots(instance,children)},updateSlots=(instance,children,optimized)=>{const{vnode,slots}=instance;let needDeletionCheck=!0,deletionComparisonTarget=_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ;if(32&vnode.shapeFlag){const type=children._;type?optimized&&1===type?needDeletionCheck=!1:assignSlots(slots,children,optimized):(needDeletionCheck=!children.$stable,normalizeObjectSlots(children,slots)),deletionComparisonTarget=children}else children&&(normalizeVNodeSlots(instance,children),deletionComparisonTarget={default:1});if(needDeletionCheck)for(const key in slots)isInternalKey(key)||null!=deletionComparisonTarget[key]||delete slots[key]};const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(options){return baseCreateRenderer(options)}function baseCreateRenderer(options,createHydrationFns){!function initFeatureFlags(){"boolean"!=typeof __VUE_OPTIONS_API__&&((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.We)().__VUE_OPTIONS_API__=!0),"boolean"!=typeof __VUE_PROD_DEVTOOLS__&&((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.We)().__VUE_PROD_DEVTOOLS__=!1),"boolean"!=typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.We)().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1)}();const target=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.We)();target.__VUE__=!0,__VUE_PROD_DEVTOOLS__&&setDevtoolsHook$1(target.__VUE_DEVTOOLS_GLOBAL_HOOK__,target);const{insert:hostInsert,remove:hostRemove,patchProp:hostPatchProp,createElement:hostCreateElement,createText:hostCreateText,createComment:hostCreateComment,setText:hostSetText,setElementText:hostSetElementText,parentNode:hostParentNode,nextSibling:hostNextSibling,setScopeId:hostSetScopeId=_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE,insertStaticContent:hostInsertStaticContent}=options,patch=(n1,n2,container,anchor=null,parentComponent=null,parentSuspense=null,namespace=void 0,slotScopeIds=null,optimized=!!n2.dynamicChildren)=>{if(n1===n2)return;n1&&!isSameVNodeType(n1,n2)&&(anchor=getNextHostNode(n1),unmount(n1,parentComponent,parentSuspense,!0),n1=null),-2===n2.patchFlag&&(optimized=!1,n2.dynamicChildren=null);const{type,ref,shapeFlag}=n2;switch(type){case Text:processText(n1,n2,container,anchor);break;case Comment:processCommentNode(n1,n2,container,anchor);break;case Static:null==n1&&mountStaticNode(n2,container,anchor,namespace);break;case Fragment:processFragment(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);break;default:1&shapeFlag?processElement(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):6&shapeFlag?processComponent(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):(64&shapeFlag||128&shapeFlag)&&type.process(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,internals)}null!=ref&&parentComponent?setRef(ref,n1&&n1.ref,parentSuspense,n2||n1,!n2):null==ref&&n1&&null!=n1.ref&&setRef(n1.ref,null,parentSuspense,n1,!0)},processText=(n1,n2,container,anchor)=>{if(null==n1)hostInsert(n2.el=hostCreateText(n2.children),container,anchor);else{const el=n2.el=n1.el;n2.children!==n1.children&&hostSetText(el,n2.children)}},processCommentNode=(n1,n2,container,anchor)=>{null==n1?hostInsert(n2.el=hostCreateComment(n2.children||""),container,anchor):n2.el=n1.el},mountStaticNode=(n2,container,anchor,namespace)=>{[n2.el,n2.anchor]=hostInsertStaticContent(n2.children,container,anchor,namespace,n2.el,n2.anchor)},removeStaticNode=({el,anchor})=>{let next;for(;el&&el!==anchor;)next=hostNextSibling(el),hostRemove(el),el=next;hostRemove(anchor)},processElement=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{"svg"===n2.type?namespace="svg":"math"===n2.type&&(namespace="mathml"),null==n1?mountElement(n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):patchElement(n1,n2,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)},mountElement=(vnode,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{let el,vnodeHook;const{props,shapeFlag,transition,dirs}=vnode;if(el=vnode.el=hostCreateElement(vnode.type,namespace,props&&props.is,props),8&shapeFlag?hostSetElementText(el,vnode.children):16&shapeFlag&&mountChildren(vnode.children,el,null,parentComponent,parentSuspense,resolveChildrenNamespace(vnode,namespace),slotScopeIds,optimized),dirs&&invokeDirectiveHook(vnode,null,parentComponent,"created"),setScopeId(el,vnode,vnode.scopeId,slotScopeIds,parentComponent),props){for(const key in props)"value"===key||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.SU)(key)||hostPatchProp(el,key,null,props[key],namespace,parentComponent);"value"in props&&hostPatchProp(el,"value",null,props.value,namespace),(vnodeHook=props.onVnodeBeforeMount)&&invokeVNodeHook(vnodeHook,parentComponent,vnode)}__VUE_PROD_DEVTOOLS__&&((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.yQ)(el,"__vnode",vnode,!0),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.yQ)(el,"__vueParentComponent",parentComponent,!0)),dirs&&invokeDirectiveHook(vnode,null,parentComponent,"beforeMount");const needCallTransitionHooks=needTransition(parentSuspense,transition);needCallTransitionHooks&&transition.beforeEnter(el),hostInsert(el,container,anchor),((vnodeHook=props&&props.onVnodeMounted)||needCallTransitionHooks||dirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,vnode),needCallTransitionHooks&&transition.enter(el),dirs&&invokeDirectiveHook(vnode,null,parentComponent,"mounted")},parentSuspense)},setScopeId=(el,vnode,scopeId,slotScopeIds,parentComponent)=>{if(scopeId&&hostSetScopeId(el,scopeId),slotScopeIds)for(let i=0;i<slotScopeIds.length;i++)hostSetScopeId(el,slotScopeIds[i]);if(parentComponent){let subTree=parentComponent.subTree;if(vnode===subTree||isSuspense(subTree.type)&&(subTree.ssContent===vnode||subTree.ssFallback===vnode)){const parentVNode=parentComponent.vnode;setScopeId(el,parentVNode,parentVNode.scopeId,parentVNode.slotScopeIds,parentComponent.parent)}}},mountChildren=(children,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,start=0)=>{for(let i=start;i<children.length;i++){const child=children[i]=optimized?cloneIfMounted(children[i]):normalizeVNode(children[i]);patch(null,child,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)}},patchElement=(n1,n2,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{const el=n2.el=n1.el;__VUE_PROD_DEVTOOLS__&&(el.__vnode=n2);let{patchFlag,dynamicChildren,dirs}=n2;patchFlag|=16&n1.patchFlag;const oldProps=n1.props||_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,newProps=n2.props||_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ;let vnodeHook;if(parentComponent&&toggleRecurse(parentComponent,!1),(vnodeHook=newProps.onVnodeBeforeUpdate)&&invokeVNodeHook(vnodeHook,parentComponent,n2,n1),dirs&&invokeDirectiveHook(n2,n1,parentComponent,"beforeUpdate"),parentComponent&&toggleRecurse(parentComponent,!0),(oldProps.innerHTML&&null==newProps.innerHTML||oldProps.textContent&&null==newProps.textContent)&&hostSetElementText(el,""),dynamicChildren?patchBlockChildren(n1.dynamicChildren,dynamicChildren,el,parentComponent,parentSuspense,resolveChildrenNamespace(n2,namespace),slotScopeIds):optimized||patchChildren(n1,n2,el,null,parentComponent,parentSuspense,resolveChildrenNamespace(n2,namespace),slotScopeIds,!1),patchFlag>0){if(16&patchFlag)patchProps(el,oldProps,newProps,parentComponent,namespace);else if(2&patchFlag&&oldProps.class!==newProps.class&&hostPatchProp(el,"class",null,newProps.class,namespace),4&patchFlag&&hostPatchProp(el,"style",oldProps.style,newProps.style,namespace),8&patchFlag){const propsToUpdate=n2.dynamicProps;for(let i=0;i<propsToUpdate.length;i++){const key=propsToUpdate[i],prev=oldProps[key],next=newProps[key];next===prev&&"value"!==key||hostPatchProp(el,key,prev,next,namespace,parentComponent)}}1&patchFlag&&n1.children!==n2.children&&hostSetElementText(el,n2.children)}else optimized||null!=dynamicChildren||patchProps(el,oldProps,newProps,parentComponent,namespace);((vnodeHook=newProps.onVnodeUpdated)||dirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,n2,n1),dirs&&invokeDirectiveHook(n2,n1,parentComponent,"updated")},parentSuspense)},patchBlockChildren=(oldChildren,newChildren,fallbackContainer,parentComponent,parentSuspense,namespace,slotScopeIds)=>{for(let i=0;i<newChildren.length;i++){const oldVNode=oldChildren[i],newVNode=newChildren[i],container=oldVNode.el&&(oldVNode.type===Fragment||!isSameVNodeType(oldVNode,newVNode)||198&oldVNode.shapeFlag)?hostParentNode(oldVNode.el):fallbackContainer;patch(oldVNode,newVNode,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,!0)}},patchProps=(el,oldProps,newProps,parentComponent,namespace)=>{if(oldProps!==newProps){if(oldProps!==_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ)for(const key in oldProps)(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.SU)(key)||key in newProps||hostPatchProp(el,key,oldProps[key],null,namespace,parentComponent);for(const key in newProps){if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.SU)(key))continue;const next=newProps[key],prev=oldProps[key];next!==prev&&"value"!==key&&hostPatchProp(el,key,prev,next,namespace,parentComponent)}"value"in newProps&&hostPatchProp(el,"value",oldProps.value,newProps.value,namespace)}},processFragment=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{const fragmentStartAnchor=n2.el=n1?n1.el:hostCreateText(""),fragmentEndAnchor=n2.anchor=n1?n1.anchor:hostCreateText("");let{patchFlag,dynamicChildren,slotScopeIds:fragmentSlotScopeIds}=n2;fragmentSlotScopeIds&&(slotScopeIds=slotScopeIds?slotScopeIds.concat(fragmentSlotScopeIds):fragmentSlotScopeIds),null==n1?(hostInsert(fragmentStartAnchor,container,anchor),hostInsert(fragmentEndAnchor,container,anchor),mountChildren(n2.children||[],container,fragmentEndAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)):patchFlag>0&&64&patchFlag&&dynamicChildren&&n1.dynamicChildren?(patchBlockChildren(n1.dynamicChildren,dynamicChildren,container,parentComponent,parentSuspense,namespace,slotScopeIds),(null!=n2.key||parentComponent&&n2===parentComponent.subTree)&&traverseStaticChildren(n1,n2,!0)):patchChildren(n1,n2,container,fragmentEndAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)},processComponent=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{n2.slotScopeIds=slotScopeIds,null==n1?512&n2.shapeFlag?parentComponent.ctx.activate(n2,container,anchor,namespace,optimized):mountComponent(n2,container,anchor,parentComponent,parentSuspense,namespace,optimized):updateComponent(n1,n2,optimized)},mountComponent=(initialVNode,container,anchor,parentComponent,parentSuspense,namespace,optimized)=>{const instance=initialVNode.component=createComponentInstance(initialVNode,parentComponent,parentSuspense);if(isKeepAlive(initialVNode)&&(instance.ctx.renderer=internals),setupComponent(instance,!1,optimized),instance.asyncDep){if(parentSuspense&&parentSuspense.registerDep(instance,setupRenderEffect,optimized),!initialVNode.el){const placeholder=instance.subTree=createVNode(Comment);processCommentNode(null,placeholder,container,anchor),initialVNode.placeholder=placeholder.el}}else setupRenderEffect(instance,initialVNode,container,anchor,parentSuspense,namespace,optimized)},updateComponent=(n1,n2,optimized)=>{const instance=n2.component=n1.component;if(function shouldUpdateComponent(prevVNode,nextVNode,optimized){const{props:prevProps,children:prevChildren,component}=prevVNode,{props:nextProps,children:nextChildren,patchFlag}=nextVNode,emits=component.emitsOptions;0;if(nextVNode.dirs||nextVNode.transition)return!0;if(!(optimized&&patchFlag>=0))return!(!prevChildren&&!nextChildren||nextChildren&&nextChildren.$stable)||prevProps!==nextProps&&(prevProps?!nextProps||hasPropsChanged(prevProps,nextProps,emits):!!nextProps);if(1024&patchFlag)return!0;if(16&patchFlag)return prevProps?hasPropsChanged(prevProps,nextProps,emits):!!nextProps;if(8&patchFlag){const dynamicProps=nextVNode.dynamicProps;for(let i=0;i<dynamicProps.length;i++){const key=dynamicProps[i];if(nextProps[key]!==prevProps[key]&&!isEmitListener(emits,key))return!0}}return!1}(n1,n2,optimized)){if(instance.asyncDep&&!instance.asyncResolved)return void updateComponentPreRender(instance,n2,optimized);instance.next=n2,instance.update()}else n2.el=n1.el,instance.vnode=n2},setupRenderEffect=(instance,initialVNode,container,anchor,parentSuspense,namespace,optimized)=>{const componentUpdateFn=()=>{if(instance.isMounted){let{next,bu,u,parent,vnode}=instance;{const nonHydratedAsyncRoot=locateNonHydratedAsyncRoot(instance);if(nonHydratedAsyncRoot)return next&&(next.el=vnode.el,updateComponentPreRender(instance,next,optimized)),void nonHydratedAsyncRoot.asyncDep.then(()=>{instance.isUnmounted||componentUpdateFn()})}let vnodeHook,originNext=next;0,toggleRecurse(instance,!1),next?(next.el=vnode.el,updateComponentPreRender(instance,next,optimized)):next=vnode,bu&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.DY)(bu),(vnodeHook=next.props&&next.props.onVnodeBeforeUpdate)&&invokeVNodeHook(vnodeHook,parent,next,vnode),toggleRecurse(instance,!0);const nextTree=renderComponentRoot(instance);0;const prevTree=instance.subTree;instance.subTree=nextTree,patch(prevTree,nextTree,hostParentNode(prevTree.el),getNextHostNode(prevTree),instance,parentSuspense,namespace),next.el=nextTree.el,null===originNext&&updateHOCHostEl(instance,nextTree.el),u&&queuePostRenderEffect(u,parentSuspense),(vnodeHook=next.props&&next.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(vnodeHook,parent,next,vnode),parentSuspense),__VUE_PROD_DEVTOOLS__&&devtoolsComponentUpdated(instance)}else{let vnodeHook;const{el,props}=initialVNode,{bm,m,parent,root,type}=instance,isAsyncWrapperVNode=isAsyncWrapper(initialVNode);if(toggleRecurse(instance,!1),bm&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.DY)(bm),!isAsyncWrapperVNode&&(vnodeHook=props&&props.onVnodeBeforeMount)&&invokeVNodeHook(vnodeHook,parent,initialVNode),toggleRecurse(instance,!0),el&&hydrateNode){const hydrateSubTree=()=>{instance.subTree=renderComponentRoot(instance),hydrateNode(el,instance.subTree,instance,parentSuspense,null)};isAsyncWrapperVNode&&type.__asyncHydrate?type.__asyncHydrate(el,instance,hydrateSubTree):hydrateSubTree()}else{root.ce&&!1!==root.ce._def.shadowRoot&&root.ce._injectChildStyle(type);const subTree=instance.subTree=renderComponentRoot(instance);0,patch(null,subTree,container,anchor,instance,parentSuspense,namespace),initialVNode.el=subTree.el}if(m&&queuePostRenderEffect(m,parentSuspense),!isAsyncWrapperVNode&&(vnodeHook=props&&props.onVnodeMounted)){const scopedInitialVNode=initialVNode;queuePostRenderEffect(()=>invokeVNodeHook(vnodeHook,parent,scopedInitialVNode),parentSuspense)}(256&initialVNode.shapeFlag||parent&&isAsyncWrapper(parent.vnode)&&256&parent.vnode.shapeFlag)&&instance.a&&queuePostRenderEffect(instance.a,parentSuspense),instance.isMounted=!0,__VUE_PROD_DEVTOOLS__&&devtoolsComponentAdded(instance),initialVNode=container=anchor=null}};instance.scope.on();const effect=instance.effect=new _vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.X2(componentUpdateFn);instance.scope.off();const update=instance.update=effect.run.bind(effect),job=instance.job=effect.runIfDirty.bind(effect);job.i=instance,job.id=instance.uid,effect.scheduler=()=>queueJob(job),toggleRecurse(instance,!0),update()},updateComponentPreRender=(instance,nextVNode,optimized)=>{nextVNode.component=instance;const prevProps=instance.vnode.props;instance.vnode=nextVNode,instance.next=null,function updateProps(instance,rawProps,rawPrevProps,optimized){const{props,attrs,vnode:{patchFlag}}=instance,rawCurrentProps=(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.ux)(props),[options]=instance.propsOptions;let hasAttrsChanged=!1;if(!(optimized||patchFlag>0)||16&patchFlag){let kebabKey;setFullProps(instance,rawProps,props,attrs)&&(hasAttrsChanged=!0);for(const key in rawCurrentProps)rawProps&&((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(rawProps,key)||(kebabKey=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tg)(key))!==key&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(rawProps,kebabKey))||(options?!rawPrevProps||void 0===rawPrevProps[key]&&void 0===rawPrevProps[kebabKey]||(props[key]=resolvePropValue(options,rawCurrentProps,key,void 0,instance,!0)):delete props[key]);if(attrs!==rawCurrentProps)for(const key in attrs)rawProps&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(rawProps,key)||(delete attrs[key],hasAttrsChanged=!0)}else if(8&patchFlag){const propsToUpdate=instance.vnode.dynamicProps;for(let i=0;i<propsToUpdate.length;i++){let key=propsToUpdate[i];if(isEmitListener(instance.emitsOptions,key))continue;const value=rawProps[key];if(options)if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(attrs,key))value!==attrs[key]&&(attrs[key]=value,hasAttrsChanged=!0);else{const camelizedKey=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.PT)(key);props[camelizedKey]=resolvePropValue(options,rawCurrentProps,camelizedKey,value,instance,!1)}else value!==attrs[key]&&(attrs[key]=value,hasAttrsChanged=!0)}}hasAttrsChanged&&(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.hZ)(instance.attrs,"set","")}(instance,nextVNode.props,prevProps,optimized),updateSlots(instance,nextVNode.children,optimized),(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.C4)(),flushPreFlushCbs(instance),(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.bl)()},patchChildren=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized=!1)=>{const c1=n1&&n1.children,prevShapeFlag=n1?n1.shapeFlag:0,c2=n2.children,{patchFlag,shapeFlag}=n2;if(patchFlag>0){if(128&patchFlag)return void patchKeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);if(256&patchFlag)return void patchUnkeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)}8&shapeFlag?(16&prevShapeFlag&&unmountChildren(c1,parentComponent,parentSuspense),c2!==c1&&hostSetElementText(container,c2)):16&prevShapeFlag?16&shapeFlag?patchKeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):unmountChildren(c1,parentComponent,parentSuspense,!0):(8&prevShapeFlag&&hostSetElementText(container,""),16&shapeFlag&&mountChildren(c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized))},patchUnkeyedChildren=(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{c1=c1||_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Oj,c2=c2||_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Oj;const oldLength=c1.length,newLength=c2.length,commonLength=Math.min(oldLength,newLength);let i;for(i=0;i<commonLength;i++){const nextChild=c2[i]=optimized?cloneIfMounted(c2[i]):normalizeVNode(c2[i]);patch(c1[i],nextChild,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)}oldLength>newLength?unmountChildren(c1,parentComponent,parentSuspense,!0,!1,commonLength):mountChildren(c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,commonLength)},patchKeyedChildren=(c1,c2,container,parentAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{let i=0;const l2=c2.length;let e1=c1.length-1,e2=l2-1;for(;i<=e1&&i<=e2;){const n1=c1[i],n2=c2[i]=optimized?cloneIfMounted(c2[i]):normalizeVNode(c2[i]);if(!isSameVNodeType(n1,n2))break;patch(n1,n2,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),i++}for(;i<=e1&&i<=e2;){const n1=c1[e1],n2=c2[e2]=optimized?cloneIfMounted(c2[e2]):normalizeVNode(c2[e2]);if(!isSameVNodeType(n1,n2))break;patch(n1,n2,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),e1--,e2--}if(i>e1){if(i<=e2){const nextPos=e2+1,anchor=nextPos<l2?c2[nextPos].el:parentAnchor;for(;i<=e2;)patch(null,c2[i]=optimized?cloneIfMounted(c2[i]):normalizeVNode(c2[i]),container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),i++}}else if(i>e2)for(;i<=e1;)unmount(c1[i],parentComponent,parentSuspense,!0),i++;else{const s1=i,s2=i,keyToNewIndexMap=new Map;for(i=s2;i<=e2;i++){const nextChild=c2[i]=optimized?cloneIfMounted(c2[i]):normalizeVNode(c2[i]);null!=nextChild.key&&keyToNewIndexMap.set(nextChild.key,i)}let j,patched=0;const toBePatched=e2-s2+1;let moved=!1,maxNewIndexSoFar=0;const newIndexToOldIndexMap=new Array(toBePatched);for(i=0;i<toBePatched;i++)newIndexToOldIndexMap[i]=0;for(i=s1;i<=e1;i++){const prevChild=c1[i];if(patched>=toBePatched){unmount(prevChild,parentComponent,parentSuspense,!0);continue}let newIndex;if(null!=prevChild.key)newIndex=keyToNewIndexMap.get(prevChild.key);else for(j=s2;j<=e2;j++)if(0===newIndexToOldIndexMap[j-s2]&&isSameVNodeType(prevChild,c2[j])){newIndex=j;break}void 0===newIndex?unmount(prevChild,parentComponent,parentSuspense,!0):(newIndexToOldIndexMap[newIndex-s2]=i+1,newIndex>=maxNewIndexSoFar?maxNewIndexSoFar=newIndex:moved=!0,patch(prevChild,c2[newIndex],container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),patched++)}const increasingNewIndexSequence=moved?function getSequence(arr){const p=arr.slice(),result=[0];let i,j,u,v,c;const len=arr.length;for(i=0;i<len;i++){const arrI=arr[i];if(0!==arrI){if(j=result[result.length-1],arr[j]<arrI){p[i]=j,result.push(i);continue}for(u=0,v=result.length-1;u<v;)c=u+v>>1,arr[result[c]]<arrI?u=c+1:v=c;arrI<arr[result[u]]&&(u>0&&(p[i]=result[u-1]),result[u]=i)}}u=result.length,v=result[u-1];for(;u-- >0;)result[u]=v,v=p[v];return result}(newIndexToOldIndexMap):_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Oj;for(j=increasingNewIndexSequence.length-1,i=toBePatched-1;i>=0;i--){const nextIndex=s2+i,nextChild=c2[nextIndex],anchorVNode=c2[nextIndex+1],anchor=nextIndex+1<l2?anchorVNode.el||anchorVNode.placeholder:parentAnchor;0===newIndexToOldIndexMap[i]?patch(null,nextChild,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):moved&&(j<0||i!==increasingNewIndexSequence[j]?move(nextChild,container,anchor,2):j--)}}},move=(vnode,container,anchor,moveType,parentSuspense=null)=>{const{el,type,transition,children,shapeFlag}=vnode;if(6&shapeFlag)return void move(vnode.component.subTree,container,anchor,moveType);if(128&shapeFlag)return void vnode.suspense.move(container,anchor,moveType);if(64&shapeFlag)return void type.move(vnode,container,anchor,internals);if(type===Fragment){hostInsert(el,container,anchor);for(let i=0;i<children.length;i++)move(children[i],container,anchor,moveType);return void hostInsert(vnode.anchor,container,anchor)}if(type===Static)return void(({el,anchor},container,nextSibling)=>{let next;for(;el&&el!==anchor;)next=hostNextSibling(el),hostInsert(el,container,nextSibling),el=next;hostInsert(anchor,container,nextSibling)})(vnode,container,anchor);if(2!==moveType&&1&shapeFlag&&transition)if(0===moveType)transition.beforeEnter(el),hostInsert(el,container,anchor),queuePostRenderEffect(()=>transition.enter(el),parentSuspense);else{const{leave,delayLeave,afterLeave}=transition,remove2=()=>{vnode.ctx.isUnmounted?hostRemove(el):hostInsert(el,container,anchor)},performLeave=()=>{el._isLeaving&&el[leaveCbKey](!0),leave(el,()=>{remove2(),afterLeave&&afterLeave()})};delayLeave?delayLeave(el,remove2,performLeave):performLeave()}else hostInsert(el,container,anchor)},unmount=(vnode,parentComponent,parentSuspense,doRemove=!1,optimized=!1)=>{const{type,props,ref,children,dynamicChildren,shapeFlag,patchFlag,dirs,cacheIndex}=vnode;if(-2===patchFlag&&(optimized=!1),null!=ref&&((0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.C4)(),setRef(ref,null,parentSuspense,vnode,!0),(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.bl)()),null!=cacheIndex&&(parentComponent.renderCache[cacheIndex]=void 0),256&shapeFlag)return void parentComponent.ctx.deactivate(vnode);const shouldInvokeDirs=1&shapeFlag&&dirs,shouldInvokeVnodeHook=!isAsyncWrapper(vnode);let vnodeHook;if(shouldInvokeVnodeHook&&(vnodeHook=props&&props.onVnodeBeforeUnmount)&&invokeVNodeHook(vnodeHook,parentComponent,vnode),6&shapeFlag)unmountComponent(vnode.component,parentSuspense,doRemove);else{if(128&shapeFlag)return void vnode.suspense.unmount(parentSuspense,doRemove);shouldInvokeDirs&&invokeDirectiveHook(vnode,null,parentComponent,"beforeUnmount"),64&shapeFlag?vnode.type.remove(vnode,parentComponent,parentSuspense,internals,doRemove):dynamicChildren&&!dynamicChildren.hasOnce&&(type!==Fragment||patchFlag>0&&64&patchFlag)?unmountChildren(dynamicChildren,parentComponent,parentSuspense,!1,!0):(type===Fragment&&384&patchFlag||!optimized&&16&shapeFlag)&&unmountChildren(children,parentComponent,parentSuspense),doRemove&&remove(vnode)}(shouldInvokeVnodeHook&&(vnodeHook=props&&props.onVnodeUnmounted)||shouldInvokeDirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,vnode),shouldInvokeDirs&&invokeDirectiveHook(vnode,null,parentComponent,"unmounted")},parentSuspense)},remove=vnode=>{const{type,el,anchor,transition}=vnode;if(type===Fragment)return void removeFragment(el,anchor);if(type===Static)return void removeStaticNode(vnode);const performRemove=()=>{hostRemove(el),transition&&!transition.persisted&&transition.afterLeave&&transition.afterLeave()};if(1&vnode.shapeFlag&&transition&&!transition.persisted){const{leave,delayLeave}=transition,performLeave=()=>leave(el,performRemove);delayLeave?delayLeave(vnode.el,performRemove,performLeave):performLeave()}else performRemove()},removeFragment=(cur,end)=>{let next;for(;cur!==end;)next=hostNextSibling(cur),hostRemove(cur),cur=next;hostRemove(end)},unmountComponent=(instance,parentSuspense,doRemove)=>{const{bum,scope,job,subTree,um,m,a}=instance;invalidateMount(m),invalidateMount(a),bum&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.DY)(bum),scope.stop(),job&&(job.flags|=8,unmount(subTree,instance,parentSuspense,doRemove)),um&&queuePostRenderEffect(um,parentSuspense),queuePostRenderEffect(()=>{instance.isUnmounted=!0},parentSuspense),__VUE_PROD_DEVTOOLS__&&devtoolsComponentRemoved(instance)},unmountChildren=(children,parentComponent,parentSuspense,doRemove=!1,optimized=!1,start=0)=>{for(let i=start;i<children.length;i++)unmount(children[i],parentComponent,parentSuspense,doRemove,optimized)},getNextHostNode=vnode=>{if(6&vnode.shapeFlag)return getNextHostNode(vnode.component.subTree);if(128&vnode.shapeFlag)return vnode.suspense.next();const el=hostNextSibling(vnode.anchor||vnode.el),teleportEnd=el&&el[TeleportEndKey];return teleportEnd?hostNextSibling(teleportEnd):el};let isFlushing=!1;const render=(vnode,container,namespace)=>{null==vnode?container._vnode&&unmount(container._vnode,null,null,!0):patch(container._vnode||null,vnode,container,null,null,null,namespace),container._vnode=vnode,isFlushing||(isFlushing=!0,flushPreFlushCbs(),flushPostFlushCbs(),isFlushing=!1)},internals={p:patch,um:unmount,m:move,r:remove,mt:mountComponent,mc:mountChildren,pc:patchChildren,pbc:patchBlockChildren,n:getNextHostNode,o:options};let hydrate,hydrateNode;return createHydrationFns&&([hydrate,hydrateNode]=createHydrationFns(internals)),{render,hydrate,createApp:createAppAPI(render,hydrate)}}function resolveChildrenNamespace({type,props},currentNamespace){return"svg"===currentNamespace&&"foreignObject"===type||"mathml"===currentNamespace&&"annotation-xml"===type&&props&&props.encoding&&props.encoding.includes("html")?void 0:currentNamespace}function toggleRecurse({effect,job},allowed){allowed?(effect.flags|=32,job.flags|=4):(effect.flags&=-33,job.flags&=-5)}function needTransition(parentSuspense,transition){return(!parentSuspense||parentSuspense&&!parentSuspense.pendingBranch)&&transition&&!transition.persisted}function traverseStaticChildren(n1,n2,shallow=!1){const ch1=n1.children,ch2=n2.children;if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(ch1)&&(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(ch2))for(let i=0;i<ch1.length;i++){const c1=ch1[i];let c2=ch2[i];1&c2.shapeFlag&&!c2.dynamicChildren&&((c2.patchFlag<=0||32===c2.patchFlag)&&(c2=ch2[i]=cloneIfMounted(ch2[i]),c2.el=c1.el),shallow||-2===c2.patchFlag||traverseStaticChildren(c1,c2)),c2.type===Text&&-1!==c2.patchFlag&&(c2.el=c1.el),c2.type!==Comment||c2.el||(c2.el=c1.el)}}function locateNonHydratedAsyncRoot(instance){const subComponent=instance.subTree.component;if(subComponent)return subComponent.asyncDep&&!subComponent.asyncResolved?subComponent:locateNonHydratedAsyncRoot(subComponent)}function invalidateMount(hooks){if(hooks)for(let i=0;i<hooks.length;i++)hooks[i].flags|=8}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>{{const ctx=inject(ssrContextKey);return ctx}};function watchEffect(effect,options){return doWatch(effect,null,options)}function watch(source,cb,options){return doWatch(source,cb,options)}function doWatch(source,cb,options=_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ){const{immediate,deep,flush,once}=options;const baseWatchOptions=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)({},options);const runsImmediately=cb&&immediate||!cb&&"post"!==flush;let ssrCleanup;if(isInSSRComponentSetup)if("sync"===flush){const ctx=useSSRContext();ssrCleanup=ctx.__watcherHandles||(ctx.__watcherHandles=[])}else if(!runsImmediately){const watchStopHandle=()=>{};return watchStopHandle.stop=_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE,watchStopHandle.resume=_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE,watchStopHandle.pause=_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE,watchStopHandle}const instance=currentInstance;baseWatchOptions.call=(fn,type,args)=>callWithAsyncErrorHandling(fn,instance,type,args);let isPre=!1;"post"===flush?baseWatchOptions.scheduler=job=>{queuePostRenderEffect(job,instance&&instance.suspense)}:"sync"!==flush&&(isPre=!0,baseWatchOptions.scheduler=(job,isFirstRun)=>{isFirstRun?job():queueJob(job)}),baseWatchOptions.augmentJob=job=>{cb&&(job.flags|=4),isPre&&(job.flags|=2,instance&&(job.id=instance.uid,job.i=instance))};const watchHandle=(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.wB)(source,cb,baseWatchOptions);return isInSSRComponentSetup&&(ssrCleanup?ssrCleanup.push(watchHandle):runsImmediately&&watchHandle()),watchHandle}function instanceWatch(source,value,options){const publicThis=this.proxy,getter=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(source)?source.includes(".")?createPathGetter(publicThis,source):()=>publicThis[source]:source.bind(publicThis,publicThis);let cb;(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(value)?cb=value:(cb=value.handler,options=value);const reset=setCurrentInstance(this),res=doWatch(getter,cb.bind(publicThis),options);return reset(),res}function createPathGetter(ctx,path){const segments=path.split(".");return()=>{let cur=ctx;for(let i=0;i<segments.length&&cur;i++)cur=cur[segments[i]];return cur}}const getModelModifiers=(props,modelName)=>"modelValue"===modelName||"model-value"===modelName?props.modelModifiers:props[`${modelName}Modifiers`]||props[`${(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.PT)(modelName)}Modifiers`]||props[`${(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tg)(modelName)}Modifiers`];function emit(instance,event,...rawArgs){if(instance.isUnmounted)return;const props=instance.vnode.props||_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ;let args=rawArgs;const isModelListener=event.startsWith("update:"),modifiers=isModelListener&&getModelModifiers(props,event.slice(7));let handlerName;modifiers&&(modifiers.trim&&(args=rawArgs.map(a=>(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(a)?a.trim():a)),modifiers.number&&(args=rawArgs.map(_vue_shared__WEBPACK_IMPORTED_MODULE_1__.bB))),__VUE_PROD_DEVTOOLS__&&function devtoolsComponentEmit(component,event,params){emit$1("component:emit",component.appContext.app,component,event,params)}(instance,event,args);let handler=props[handlerName=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.rU)(event)]||props[handlerName=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.rU)((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.PT)(event))];!handler&&isModelListener&&(handler=props[handlerName=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.rU)((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tg)(event))]),handler&&callWithAsyncErrorHandling(handler,instance,6,args);const onceHandler=props[handlerName+"Once"];if(onceHandler){if(instance.emitted){if(instance.emitted[handlerName])return}else instance.emitted={};instance.emitted[handlerName]=!0,callWithAsyncErrorHandling(onceHandler,instance,6,args)}}const mixinEmitsCache=new WeakMap;function normalizeEmitsOptions(comp,appContext,asMixin=!1){const cache=__VUE_OPTIONS_API__&&asMixin?mixinEmitsCache:appContext.emitsCache,cached=cache.get(comp);if(void 0!==cached)return cached;const raw=comp.emits;let normalized={},hasExtends=!1;if(__VUE_OPTIONS_API__&&!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(comp)){const extendEmits=raw2=>{const normalizedFromExtend=normalizeEmitsOptions(raw2,appContext,!0);normalizedFromExtend&&(hasExtends=!0,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)(normalized,normalizedFromExtend))};!asMixin&&appContext.mixins.length&&appContext.mixins.forEach(extendEmits),comp.extends&&extendEmits(comp.extends),comp.mixins&&comp.mixins.forEach(extendEmits)}return raw||hasExtends?((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(raw)?raw.forEach(key=>normalized[key]=null):(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)(normalized,raw),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(comp)&&cache.set(comp,normalized),normalized):((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(comp)&&cache.set(comp,null),null)}function isEmitListener(options,key){return!(!options||!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Mp)(key))&&(key=key.slice(2).replace(/Once$/,""),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(options,key[0].toLowerCase()+key.slice(1))||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(options,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tg)(key))||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.$3)(options,key))}function renderComponentRoot(instance){const{type:Component,vnode,proxy,withProxy,propsOptions:[propsOptions],slots,attrs,emit,render,renderCache,props,data,setupState,ctx,inheritAttrs}=instance,prev=setCurrentRenderingInstance(instance);let result,fallthroughAttrs;try{if(4&vnode.shapeFlag){const proxyToUse=withProxy||proxy,thisProxy=proxyToUse;result=normalizeVNode(render.call(thisProxy,proxyToUse,renderCache,props,setupState,data,ctx)),fallthroughAttrs=attrs}else{const render2=Component;0,result=normalizeVNode(render2.length>1?render2(props,{attrs,slots,emit}):render2(props,null)),fallthroughAttrs=Component.props?attrs:getFunctionalFallthrough(attrs)}}catch(err){blockStack.length=0,handleError(err,instance,1),result=createVNode(Comment)}let root=result;if(fallthroughAttrs&&!1!==inheritAttrs){const keys=Object.keys(fallthroughAttrs),{shapeFlag}=root;keys.length&&7&shapeFlag&&(propsOptions&&keys.some(_vue_shared__WEBPACK_IMPORTED_MODULE_1__.CP)&&(fallthroughAttrs=filterModelListeners(fallthroughAttrs,propsOptions)),root=cloneVNode(root,fallthroughAttrs,!1,!0))}return vnode.dirs&&(root=cloneVNode(root,null,!1,!0),root.dirs=root.dirs?root.dirs.concat(vnode.dirs):vnode.dirs),vnode.transition&&setTransitionHooks(root,vnode.transition),result=root,setCurrentRenderingInstance(prev),result}const getFunctionalFallthrough=attrs=>{let res;for(const key in attrs)("class"===key||"style"===key||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Mp)(key))&&((res||(res={}))[key]=attrs[key]);return res},filterModelListeners=(attrs,props)=>{const res={};for(const key in attrs)(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.CP)(key)&&key.slice(9)in props||(res[key]=attrs[key]);return res};function hasPropsChanged(prevProps,nextProps,emitsOptions){const nextKeys=Object.keys(nextProps);if(nextKeys.length!==Object.keys(prevProps).length)return!0;for(let i=0;i<nextKeys.length;i++){const key=nextKeys[i];if(nextProps[key]!==prevProps[key]&&!isEmitListener(emitsOptions,key))return!0}return!1}function updateHOCHostEl({vnode,parent},el){for(;parent;){const root=parent.subTree;if(root.suspense&&root.suspense.activeBranch===vnode&&(root.el=vnode.el),root!==vnode)break;(vnode=parent.vnode).el=el,parent=parent.parent}}const isSuspense=type=>type.__isSuspense;function queueEffectWithSuspense(fn,suspense){suspense&&suspense.pendingBranch?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(fn)?suspense.effects.push(...fn):suspense.effects.push(fn):queuePostFlushCb(fn)}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;let isBlockTreeEnabled=1;function setBlockTracking(value,inVOnce=!1){isBlockTreeEnabled+=value,value<0&&currentBlock&&inVOnce&&(currentBlock.hasOnce=!0)}function isVNode(value){return!!value&&!0===value.__v_isVNode}function isSameVNodeType(n1,n2){return n1.type===n2.type&&n1.key===n2.key}const normalizeKey=({key})=>null!=key?key:null,normalizeRef=({ref,ref_key,ref_for})=>("number"==typeof ref&&(ref=""+ref),null!=ref?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(ref)||(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.i9)(ref)||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(ref)?{i:currentRenderingInstance,r:ref,k:ref_key,f:!!ref_for}:ref:null);function createBaseVNode(type,props=null,children=null,patchFlag=0,dynamicProps=null,shapeFlag=(type===Fragment?0:1),isBlockNode=!1,needFullChildrenNormalization=!1){const vnode={__v_isVNode:!0,__v_skip:!0,type,props,key:props&&normalizeKey(props),ref:props&&normalizeRef(props),scopeId:currentScopeId,slotScopeIds:null,children,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag,patchFlag,dynamicProps,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return needFullChildrenNormalization?(normalizeChildren(vnode,children),128&shapeFlag&&type.normalize(vnode)):children&&(vnode.shapeFlag|=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(children)?8:16),isBlockTreeEnabled>0&&!isBlockNode&&currentBlock&&(vnode.patchFlag>0||6&shapeFlag)&&32!==vnode.patchFlag&&currentBlock.push(vnode),vnode}const createVNode=_createVNode;function _createVNode(type,props=null,children=null,patchFlag=0,dynamicProps=null,isBlockNode=!1){if(type&&type!==NULL_DYNAMIC_COMPONENT||(type=Comment),isVNode(type)){const cloned=cloneVNode(type,props,!0);return children&&normalizeChildren(cloned,children),isBlockTreeEnabled>0&&!isBlockNode&&currentBlock&&(6&cloned.shapeFlag?currentBlock[currentBlock.indexOf(type)]=cloned:currentBlock.push(cloned)),cloned.patchFlag=-2,cloned}if(isClassComponent(type)&&(type=type.__vccOpts),props){props=function guardReactiveProps(props){return props?(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.ju)(props)||isInternalObject(props)?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)({},props):props:null}(props);let{class:klass,style}=props;klass&&!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(klass)&&(props.class=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.C4)(klass)),(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(style)&&((0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.ju)(style)&&!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(style)&&(style=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)({},style)),props.style=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tr)(style))}return createBaseVNode(type,props,children,patchFlag,dynamicProps,(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Kg)(type)?1:isSuspense(type)?128:isTeleport(type)?64:(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(type)?4:(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(type)?2:0,isBlockNode,!0)}function cloneVNode(vnode,extraProps,mergeRef=!1,cloneTransition=!1){const{props,ref,patchFlag,children,transition}=vnode,mergedProps=extraProps?function mergeProps(...args){const ret={};for(let i=0;i<args.length;i++){const toMerge=args[i];for(const key in toMerge)if("class"===key)ret.class!==toMerge.class&&(ret.class=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.C4)([ret.class,toMerge.class]));else if("style"===key)ret.style=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tr)([ret.style,toMerge.style]);else if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Mp)(key)){const existing=ret[key],incoming=toMerge[key];!incoming||existing===incoming||(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(existing)&&existing.includes(incoming)||(ret[key]=existing?[].concat(existing,incoming):incoming)}else""!==key&&(ret[key]=toMerge[key])}return ret}(props||{},extraProps):props,cloned={__v_isVNode:!0,__v_skip:!0,type:vnode.type,props:mergedProps,key:mergedProps&&normalizeKey(mergedProps),ref:extraProps&&extraProps.ref?mergeRef&&ref?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(ref)?ref.concat(normalizeRef(extraProps)):[ref,normalizeRef(extraProps)]:normalizeRef(extraProps):ref,scopeId:vnode.scopeId,slotScopeIds:vnode.slotScopeIds,children,target:vnode.target,targetStart:vnode.targetStart,targetAnchor:vnode.targetAnchor,staticCount:vnode.staticCount,shapeFlag:vnode.shapeFlag,patchFlag:extraProps&&vnode.type!==Fragment?-1===patchFlag?16:16|patchFlag:patchFlag,dynamicProps:vnode.dynamicProps,dynamicChildren:vnode.dynamicChildren,appContext:vnode.appContext,dirs:vnode.dirs,transition,component:vnode.component,suspense:vnode.suspense,ssContent:vnode.ssContent&&cloneVNode(vnode.ssContent),ssFallback:vnode.ssFallback&&cloneVNode(vnode.ssFallback),placeholder:vnode.placeholder,el:vnode.el,anchor:vnode.anchor,ctx:vnode.ctx,ce:vnode.ce};return transition&&cloneTransition&&setTransitionHooks(cloned,transition.clone(cloned)),cloned}function createTextVNode(text=" ",flag=0){return createVNode(Text,null,text,flag)}function normalizeVNode(child){return null==child||"boolean"==typeof child?createVNode(Comment):(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(child)?createVNode(Fragment,null,child.slice()):isVNode(child)?cloneIfMounted(child):createVNode(Text,null,String(child))}function cloneIfMounted(child){return null===child.el&&-1!==child.patchFlag||child.memo?child:cloneVNode(child)}function normalizeChildren(vnode,children){let type=0;const{shapeFlag}=vnode;if(null==children)children=null;else if((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(children))type=16;else if("object"==typeof children){if(65&shapeFlag){const slot=children.default;return void(slot&&(slot._c&&(slot._d=!1),normalizeChildren(vnode,slot()),slot._c&&(slot._d=!0)))}{type=32;const slotFlag=children._;slotFlag||isInternalObject(children)?3===slotFlag&&currentRenderingInstance&&(1===currentRenderingInstance.slots._?children._=1:(children._=2,vnode.patchFlag|=1024)):children._ctx=currentRenderingInstance}}else(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(children)?(children={default:children,_ctx:currentRenderingInstance},type=32):(children=String(children),64&shapeFlag?(type=16,children=[createTextVNode(children)]):type=8);vnode.children=children,vnode.shapeFlag|=type}function invokeVNodeHook(hook,instance,vnode,prevVNode=null){callWithAsyncErrorHandling(hook,instance,7,[vnode,prevVNode])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(vnode,parent,suspense){const type=vnode.type,appContext=(parent?parent.appContext:vnode.appContext)||emptyAppContext,instance={uid:uid++,vnode,type,parent,appContext,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new _vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.yC(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:parent?parent.provides:Object.create(appContext.provides),ids:parent?parent.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(type,appContext),emitsOptions:normalizeEmitsOptions(type,appContext),emit:null,emitted:null,propsDefaults:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,inheritAttrs:type.inheritAttrs,ctx:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,data:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,props:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,attrs:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,slots:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,refs:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,setupState:_vue_shared__WEBPACK_IMPORTED_MODULE_1__.MZ,setupContext:null,suspense,suspenseId:suspense?suspense.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return instance.ctx={_:instance},instance.root=parent?parent.root:instance,instance.emit=emit.bind(null,instance),vnode.ce&&vnode.ce(instance),instance}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const g=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.We)(),registerGlobalSetter=(key,setter)=>{let setters;return(setters=g[key])||(setters=g[key]=[]),setters.push(setter),v=>{setters.length>1?setters.forEach(set=>set(v)):setters[0](v)}};internalSetCurrentInstance=registerGlobalSetter("__VUE_INSTANCE_SETTERS__",v=>currentInstance=v),setInSSRSetupState=registerGlobalSetter("__VUE_SSR_SETTERS__",v=>isInSSRComponentSetup=v)}const setCurrentInstance=instance=>{const prev=currentInstance;return internalSetCurrentInstance(instance),instance.scope.on(),()=>{instance.scope.off(),internalSetCurrentInstance(prev)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(instance){return 4&instance.vnode.shapeFlag}let compile,installWithProxy,isInSSRComponentSetup=!1;function setupComponent(instance,isSSR=!1,optimized=!1){isSSR&&setInSSRSetupState(isSSR);const{props,children}=instance.vnode,isStateful=isStatefulComponent(instance);!function initProps(instance,rawProps,isStateful,isSSR=!1){const props={},attrs=createInternalObject();instance.propsDefaults=Object.create(null),setFullProps(instance,rawProps,props,attrs);for(const key in instance.propsOptions[0])key in props||(props[key]=void 0);isStateful?instance.props=isSSR?props:(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.Gc)(props):instance.type.props?instance.props=props:instance.props=attrs,instance.attrs=attrs}(instance,props,isStateful,isSSR),initSlots(instance,children,optimized||isSSR);const setupResult=isStateful?function setupStatefulComponent(instance,isSSR){const Component=instance.type;0;instance.accessCache=Object.create(null),instance.proxy=new Proxy(instance.ctx,PublicInstanceProxyHandlers),!1;const{setup}=Component;if(setup){(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.C4)();const setupContext=instance.setupContext=setup.length>1?createSetupContext(instance):null,reset=setCurrentInstance(instance),setupResult=callWithErrorHandling(setup,instance,0,[instance.props,setupContext]),isAsyncSetup=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.yL)(setupResult);if((0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.bl)(),reset(),!isAsyncSetup&&!instance.sp||isAsyncWrapper(instance)||markAsyncBoundary(instance),isAsyncSetup){if(setupResult.then(unsetCurrentInstance,unsetCurrentInstance),isSSR)return setupResult.then(resolvedResult=>{handleSetupResult(instance,resolvedResult,isSSR)}).catch(e=>{handleError(e,instance,0)});instance.asyncDep=setupResult}else handleSetupResult(instance,setupResult,isSSR)}else finishComponentSetup(instance,isSSR)}(instance,isSSR):void 0;return isSSR&&setInSSRSetupState(!1),setupResult}function handleSetupResult(instance,setupResult,isSSR){(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(setupResult)?instance.type.__ssrInlineRender?instance.ssrRender=setupResult:instance.render=setupResult:(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(setupResult)&&(__VUE_PROD_DEVTOOLS__&&(instance.devtoolsRawSetupState=setupResult),instance.setupState=(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.Pr)(setupResult)),finishComponentSetup(instance,isSSR)}function finishComponentSetup(instance,isSSR,skipOptions){const Component=instance.type;if(!instance.render){if(!isSSR&&compile&&!Component.render){const template=Component.template||__VUE_OPTIONS_API__&&resolveMergedOptions(instance).template;if(template){0;const{isCustomElement,compilerOptions}=instance.appContext.config,{delimiters,compilerOptions:componentCompilerOptions}=Component,finalCompilerOptions=(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)((0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.X$)({isCustomElement,delimiters},compilerOptions),componentCompilerOptions);Component.render=compile(template,finalCompilerOptions)}}instance.render=Component.render||_vue_shared__WEBPACK_IMPORTED_MODULE_1__.tE,installWithProxy&&installWithProxy(instance)}if(__VUE_OPTIONS_API__){const reset=setCurrentInstance(instance);(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.C4)();try{applyOptions(instance)}finally{(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.bl)(),reset()}}}const attrsProxyHandlers={get:(target,key)=>((0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.u4)(target,"get",""),target[key])};function createSetupContext(instance){const expose=exposed=>{instance.exposed=exposed||{}};return{attrs:new Proxy(instance.attrs,attrsProxyHandlers),slots:instance.slots,emit:instance.emit,expose}}function getComponentPublicInstance(instance){return instance.exposed?instance.exposeProxy||(instance.exposeProxy=new Proxy((0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.Pr)((0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.IG)(instance.exposed)),{get:(target,key)=>key in target?target[key]:key in publicPropertiesMap?publicPropertiesMap[key](instance):void 0,has:(target,key)=>key in target||key in publicPropertiesMap})):instance.proxy}function getComponentName(Component,includeInferred=!0){return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(Component)?Component.displayName||Component.name:Component.name||includeInferred&&Component.__name}function isClassComponent(value){return(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Tn)(value)&&"__vccOpts"in value}const computed=(getterOrOptions,debugOptions)=>(0,_vue_reactivity__WEBPACK_IMPORTED_MODULE_0__.EW)(getterOrOptions,debugOptions,isInSSRComponentSetup);function h(type,propsOrChildren,children){try{setBlockTracking(-1);const l=arguments.length;return 2===l?(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.Gv)(propsOrChildren)&&!(0,_vue_shared__WEBPACK_IMPORTED_MODULE_1__.cy)(propsOrChildren)?isVNode(propsOrChildren)?createVNode(type,null,[propsOrChildren]):createVNode(type,propsOrChildren):createVNode(type,null,propsOrChildren):(l>3?children=Array.prototype.slice.call(arguments,2):3===l&&isVNode(children)&&(children=[children]),createVNode(type,propsOrChildren,children))}finally{setBlockTracking(1)}}const version="3.5.22"},"./node_modules/@vue/runtime-dom/dist/runtime-dom.esm-bundler.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ef:()=>createApp});var _vue_runtime_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.js"),_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@vue/shared/dist/shared.esm-bundler.js");__webpack_require__("./node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js");let policy;const tt="undefined"!=typeof window&&window.trustedTypes;if(tt)try{policy=tt.createPolicy("vue",{createHTML:val=>val})}catch(e){}const unsafeToTrustedHTML=policy?val=>policy.createHTML(val):val=>val,doc="undefined"!=typeof document?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(child,parent,anchor)=>{parent.insertBefore(child,anchor||null)},remove:child=>{const parent=child.parentNode;parent&&parent.removeChild(child)},createElement:(tag,namespace,is,props)=>{const el="svg"===namespace?doc.createElementNS("http://www.w3.org/2000/svg",tag):"mathml"===namespace?doc.createElementNS("http://www.w3.org/1998/Math/MathML",tag):is?doc.createElement(tag,{is}):doc.createElement(tag);return"select"===tag&&props&&null!=props.multiple&&el.setAttribute("multiple",props.multiple),el},createText:text=>doc.createTextNode(text),createComment:text=>doc.createComment(text),setText:(node,text)=>{node.nodeValue=text},setElementText:(el,text)=>{el.textContent=text},parentNode:node=>node.parentNode,nextSibling:node=>node.nextSibling,querySelector:selector=>doc.querySelector(selector),setScopeId(el,id){el.setAttribute(id,"")},insertStaticContent(content,parent,anchor,namespace,start,end){const before=anchor?anchor.previousSibling:parent.lastChild;if(start&&(start===end||start.nextSibling))for(;parent.insertBefore(start.cloneNode(!0),anchor),start!==end&&(start=start.nextSibling););else{templateContainer.innerHTML=unsafeToTrustedHTML("svg"===namespace?`<svg>${content}</svg>`:"mathml"===namespace?`<math>${content}</math>`:content);const template=templateContainer.content;if("svg"===namespace||"mathml"===namespace){const wrapper=template.firstChild;for(;wrapper.firstChild;)template.appendChild(wrapper.firstChild);template.removeChild(wrapper)}parent.insertBefore(template,anchor)}return[before?before.nextSibling:parent.firstChild,anchor?anchor.previousSibling:parent.lastChild]}},vtcKey=Symbol("_vtc"),DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};_vue_runtime_core__WEBPACK_IMPORTED_MODULE_0__.QP;const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh");const CSS_VAR_TEXT=Symbol("");const displayRE=/(?:^|;)\s*display\s*:/;const importantRE=/\s*!important$/;function setStyle(style,name,val){if((0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.cy)(val))val.forEach(v=>setStyle(style,name,v));else if(null==val&&(val=""),name.startsWith("--"))style.setProperty(name,val);else{const prefixed=function autoPrefix(style,rawName){const cached=prefixCache[rawName];if(cached)return cached;let name=(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.PT)(rawName);if("filter"!==name&&name in style)return prefixCache[rawName]=name;name=(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.ZH)(name);for(let i=0;i<prefixes.length;i++){const prefixed=prefixes[i]+name;if(prefixed in style)return prefixCache[rawName]=prefixed}return rawName}(style,name);importantRE.test(val)?style.setProperty((0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Tg)(prefixed),val.replace(importantRE,""),"important"):style[prefixed]=val}}const prefixes=["Webkit","Moz","ms"],prefixCache={};const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(el,key,value,isSVG,instance,isBoolean=(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.J$)(key)){isSVG&&key.startsWith("xlink:")?null==value?el.removeAttributeNS(xlinkNS,key.slice(6,key.length)):el.setAttributeNS(xlinkNS,key,value):null==value||isBoolean&&!(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Y2)(value)?el.removeAttribute(key):el.setAttribute(key,isBoolean?"":(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Bm)(value)?String(value):value)}function patchDOMProp(el,key,value,parentComponent,attrName){if("innerHTML"===key||"textContent"===key)return void(null!=value&&(el[key]="innerHTML"===key?unsafeToTrustedHTML(value):value));const tag=el.tagName;if("value"===key&&"PROGRESS"!==tag&&!tag.includes("-")){const oldValue="OPTION"===tag?el.getAttribute("value")||"":el.value,newValue=null==value?"checkbox"===el.type?"on":"":String(value);return oldValue===newValue&&"_value"in el||(el.value=newValue),null==value&&el.removeAttribute(key),void(el._value=value)}let needRemove=!1;if(""===value||null==value){const type=typeof el[key];"boolean"===type?value=(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Y2)(value):null==value&&"string"===type?(value="",needRemove=!0):"number"===type&&(value=0,needRemove=!0)}try{el[key]=value}catch(e){0}needRemove&&el.removeAttribute(attrName||key)}function addEventListener(el,event,handler,options){el.addEventListener(event,handler,options)}const veiKey=Symbol("_vei");function patchEvent(el,rawName,prevValue,nextValue,instance=null){const invokers=el[veiKey]||(el[veiKey]={}),existingInvoker=invokers[rawName];if(nextValue&&existingInvoker)existingInvoker.value=nextValue;else{const[name,options]=function parseName(name){let options;if(optionsModifierRE.test(name)){let m;for(options={};m=name.match(optionsModifierRE);)name=name.slice(0,name.length-m[0].length),options[m[0].toLowerCase()]=!0}const event=":"===name[2]?name.slice(3):(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Tg)(name.slice(2));return[event,options]}(rawName);if(nextValue){const invoker=invokers[rawName]=function createInvoker(initialValue,instance){const invoker=e=>{if(e._vts){if(e._vts<=invoker.attached)return}else e._vts=Date.now();(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_0__.qL)(function patchStopImmediatePropagation(e,value){if((0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.cy)(value)){const originalStop=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{originalStop.call(e),e._stopped=!0},value.map(fn=>e2=>!e2._stopped&&fn&&fn(e2))}return value}(e,invoker.value),instance,5,[e])};return invoker.value=initialValue,invoker.attached=getNow(),invoker}(nextValue,instance);addEventListener(el,name,invoker,options)}else existingInvoker&&(!function removeEventListener(el,event,handler,options){el.removeEventListener(event,handler,options)}(el,name,existingInvoker,options),invokers[rawName]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());const isNativeOn=key=>111===key.charCodeAt(0)&&110===key.charCodeAt(1)&&key.charCodeAt(2)>96&&key.charCodeAt(2)<123;"undefined"!=typeof HTMLElement&&HTMLElement;Symbol("_moveCb"),Symbol("_enterCb");Symbol("_assign");const rendererOptions=(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.X$)({patchProp:(el,key,prevValue,nextValue,namespace,parentComponent)=>{const isSVG="svg"===namespace;"class"===key?function patchClass(el,value,isSVG){const transitionClasses=el[vtcKey];transitionClasses&&(value=(value?[value,...transitionClasses]:[...transitionClasses]).join(" ")),null==value?el.removeAttribute("class"):isSVG?el.setAttribute("class",value):el.className=value}(el,nextValue,isSVG):"style"===key?function patchStyle(el,prev,next){const style=el.style,isCssString=(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Kg)(next);let hasControlledDisplay=!1;if(next&&!isCssString){if(prev)if((0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Kg)(prev))for(const prevStyle of prev.split(";")){const key=prevStyle.slice(0,prevStyle.indexOf(":")).trim();null==next[key]&&setStyle(style,key,"")}else for(const key in prev)null==next[key]&&setStyle(style,key,"");for(const key in next)"display"===key&&(hasControlledDisplay=!0),setStyle(style,key,next[key])}else if(isCssString){if(prev!==next){const cssVarText=style[CSS_VAR_TEXT];cssVarText&&(next+=";"+cssVarText),style.cssText=next,hasControlledDisplay=displayRE.test(next)}}else prev&&el.removeAttribute("style");vShowOriginalDisplay in el&&(el[vShowOriginalDisplay]=hasControlledDisplay?style.display:"",el[vShowHidden]&&(style.display="none"))}(el,prevValue,nextValue):(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Mp)(key)?(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.CP)(key)||patchEvent(el,key,0,nextValue,parentComponent):("."===key[0]?(key=key.slice(1),1):"^"===key[0]?(key=key.slice(1),0):function shouldSetAsProp(el,key,value,isSVG){if(isSVG)return"innerHTML"===key||"textContent"===key||!!(key in el&&isNativeOn(key)&&(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Tn)(value));if("spellcheck"===key||"draggable"===key||"translate"===key||"autocorrect"===key)return!1;if("form"===key)return!1;if("list"===key&&"INPUT"===el.tagName)return!1;if("type"===key&&"TEXTAREA"===el.tagName)return!1;if("width"===key||"height"===key){const tag=el.tagName;if("IMG"===tag||"VIDEO"===tag||"CANVAS"===tag||"SOURCE"===tag)return!1}if(isNativeOn(key)&&(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Kg)(value))return!1;return key in el}(el,key,nextValue,isSVG))?(patchDOMProp(el,key,nextValue),el.tagName.includes("-")||"value"!==key&&"checked"!==key&&"selected"!==key||patchAttr(el,key,nextValue,isSVG,0,"value"!==key)):!el._isVueCE||!/[A-Z]/.test(key)&&(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Kg)(nextValue)?("true-value"===key?el._trueValue=nextValue:"false-value"===key&&(el._falseValue=nextValue),patchAttr(el,key,nextValue,isSVG)):patchDOMProp(el,(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.PT)(key),nextValue,0,key)}},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_0__.K9)(rendererOptions))}const createApp=(...args)=>{const app=ensureRenderer().createApp(...args);const{mount}=app;return app.mount=containerOrSelector=>{const container=normalizeContainer(containerOrSelector);if(!container)return;const component=app._component;(0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Tn)(component)||component.render||component.template||(component.template=container.innerHTML),1===container.nodeType&&(container.textContent="");const proxy=mount(container,!1,resolveRootNamespace(container));return container instanceof Element&&(container.removeAttribute("v-cloak"),container.setAttribute("data-v-app","")),proxy},app};function resolveRootNamespace(container){return container instanceof SVGElement?"svg":"function"==typeof MathMLElement&&container instanceof MathMLElement?"mathml":void 0}function normalizeContainer(container){if((0,_vue_runtime_core__WEBPACK_IMPORTED_MODULE_1__.Kg)(container)){return document.querySelector(container)}return container}},"./node_modules/@vue/shared/dist/shared.esm-bundler.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function makeMap(str){const map=Object.create(null);for(const key of str.split(","))map[key]=1;return val=>val in map}__webpack_require__.d(__webpack_exports__,{$3:()=>hasOwn,$H:()=>hasChanged,BH:()=>isGloballyAllowed,BX:()=>looseEqual,Bm:()=>isSymbol,C4:()=>normalizeClass,CE:()=>isMap,CP:()=>isModelListener,DY:()=>invokeArrayFns,Gv:()=>isObject,J$:()=>isSpecialBooleanAttr,Kg:()=>isString,MZ:()=>EMPTY_OBJ,Mp:()=>isOn,NO:()=>NO,Oj:()=>EMPTY_ARR,PT:()=>camelize,Qd:()=>isPlainObject,Ro:()=>toNumber,SU:()=>isReservedProp,TF:()=>remove,Tg:()=>hyphenate,Tn:()=>isFunction,Tr:()=>normalizeStyle,We:()=>getGlobalThis,X$:()=>extend,Y2:()=>includeBooleanAttr,ZH:()=>capitalize,Zf:()=>toRawType,bB:()=>looseToNumber,cy:()=>isArray,gd:()=>isRegExp,pD:()=>makeMap,rU:()=>toHandlerKey,tE:()=>NOOP,u3:()=>looseIndexOf,vM:()=>isSet,yI:()=>isIntegerKey,yL:()=>isPromise,yQ:()=>def});const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=key=>111===key.charCodeAt(0)&&110===key.charCodeAt(1)&&(key.charCodeAt(2)>122||key.charCodeAt(2)<97),isModelListener=key=>key.startsWith("onUpdate:"),extend=Object.assign,remove=(arr,el)=>{const i=arr.indexOf(el);i>-1&&arr.splice(i,1)},hasOwnProperty=Object.prototype.hasOwnProperty,hasOwn=(val,key)=>hasOwnProperty.call(val,key),isArray=Array.isArray,isMap=val=>"[object Map]"===toTypeString(val),isSet=val=>"[object Set]"===toTypeString(val),isDate=val=>"[object Date]"===toTypeString(val),isRegExp=val=>"[object RegExp]"===toTypeString(val),isFunction=val=>"function"==typeof val,isString=val=>"string"==typeof val,isSymbol=val=>"symbol"==typeof val,isObject=val=>null!==val&&"object"==typeof val,isPromise=val=>(isObject(val)||isFunction(val))&&isFunction(val.then)&&isFunction(val.catch),objectToString=Object.prototype.toString,toTypeString=value=>objectToString.call(value),toRawType=value=>toTypeString(value).slice(8,-1),isPlainObject=val=>"[object Object]"===toTypeString(val),isIntegerKey=key=>isString(key)&&"NaN"!==key&&"-"!==key[0]&&""+parseInt(key,10)===key,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=fn=>{const cache=Object.create(null);return str=>cache[str]||(cache[str]=fn(str))},camelizeRE=/-\w/g,camelize=cacheStringFunction(str=>str.replace(camelizeRE,c=>c.slice(1).toUpperCase())),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(str=>str.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(str=>str.charAt(0).toUpperCase()+str.slice(1)),toHandlerKey=cacheStringFunction(str=>str?`on${capitalize(str)}`:""),hasChanged=(value,oldValue)=>!Object.is(value,oldValue),invokeArrayFns=(fns,...arg)=>{for(let i=0;i<fns.length;i++)fns[i](...arg)},def=(obj,key,value,writable=!1)=>{Object.defineProperty(obj,key,{configurable:!0,enumerable:!1,writable,value})},looseToNumber=val=>{const n=parseFloat(val);return isNaN(n)?val:n},toNumber=val=>{const n=isString(val)?Number(val):NaN;return isNaN(n)?val:n};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:{});const isGloballyAllowed=makeMap("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol");function normalizeStyle(value){if(isArray(value)){const res={};for(let i=0;i<value.length;i++){const item=value[i],normalized=isString(item)?parseStringStyle(item):normalizeStyle(item);if(normalized)for(const key in normalized)res[key]=normalized[key]}return res}if(isString(value)||isObject(value))return value}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(cssText){const ret={};return cssText.replace(styleCommentRE,"").split(listDelimiterRE).forEach(item=>{if(item){const tmp=item.split(propertyDelimiterRE);tmp.length>1&&(ret[tmp[0].trim()]=tmp[1].trim())}}),ret}function normalizeClass(value){let res="";if(isString(value))res=value;else if(isArray(value))for(let i=0;i<value.length;i++){const normalized=normalizeClass(value[i]);normalized&&(res+=normalized+" ")}else if(isObject(value))for(const name in value)value[name]&&(res+=name+" ");return res.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(value){return!!value||""===value}function looseEqual(a,b){if(a===b)return!0;let aValidType=isDate(a),bValidType=isDate(b);if(aValidType||bValidType)return!(!aValidType||!bValidType)&&a.getTime()===b.getTime();if(aValidType=isSymbol(a),bValidType=isSymbol(b),aValidType||bValidType)return a===b;if(aValidType=isArray(a),bValidType=isArray(b),aValidType||bValidType)return!(!aValidType||!bValidType)&&function looseCompareArrays(a,b){if(a.length!==b.length)return!1;let equal=!0;for(let i=0;equal&&i<a.length;i++)equal=looseEqual(a[i],b[i]);return equal}(a,b);if(aValidType=isObject(a),bValidType=isObject(b),aValidType||bValidType){if(!aValidType||!bValidType)return!1;if(Object.keys(a).length!==Object.keys(b).length)return!1;for(const key in a){const aHasKey=a.hasOwnProperty(key),bHasKey=b.hasOwnProperty(key);if(aHasKey&&!bHasKey||!aHasKey&&bHasKey||!looseEqual(a[key],b[key]))return!1}}return String(a)===String(b)}function looseIndexOf(arr,val){return arr.findIndex(item=>looseEqual(item,val))}},"./node_modules/clsx/dist/clsx.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function r(e){var t,f,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=" "),n+=f)}else for(f in e)e[f]&&(n&&(n+=" "),n+=f);return n}function clsx(){for(var e,t,f=0,n="",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n}__webpack_require__.d(__webpack_exports__,{$:()=>clsx,A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=clsx},"./node_modules/lodash-es/debounce.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _isObject_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/isObject.js"),_now_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash-es/now.js"),_toNumber_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/lodash-es/toNumber.js"),nativeMax=Math.max,nativeMin=Math.min;const __WEBPACK_DEFAULT_EXPORT__=function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=(0,_now_js__WEBPACK_IMPORTED_MODULE_1__.A)();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function remainingWait(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=(0,_now_js__WEBPACK_IMPORTED_MODULE_1__.A)(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=(0,_toNumber_js__WEBPACK_IMPORTED_MODULE_2__.A)(wait)||0,(0,_isObject_js__WEBPACK_IMPORTED_MODULE_0__.A)(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax((0,_toNumber_js__WEBPACK_IMPORTED_MODULE_2__.A)(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function cancel(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function flush(){return void 0===timerId?result:trailingEdge((0,_now_js__WEBPACK_IMPORTED_MODULE_1__.A)())},debounced}},"./node_modules/lodash-es/isSymbol.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _baseGetTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/_baseGetTag.js"),_isObjectLike_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash-es/isObjectLike.js");const __WEBPACK_DEFAULT_EXPORT__=function isSymbol(value){return"symbol"==typeof value||(0,_isObjectLike_js__WEBPACK_IMPORTED_MODULE_1__.A)(value)&&"[object Symbol]"==(0,_baseGetTag_js__WEBPACK_IMPORTED_MODULE_0__.A)(value)}},"./node_modules/lodash-es/now.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _root_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/_root.js");const __WEBPACK_DEFAULT_EXPORT__=function(){return _root_js__WEBPACK_IMPORTED_MODULE_0__.A.Date.now()}},"./node_modules/lodash-es/throttle.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _debounce_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/debounce.js"),_isObject_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash-es/isObject.js");const __WEBPACK_DEFAULT_EXPORT__=function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");return(0,_isObject_js__WEBPACK_IMPORTED_MODULE_1__.A)(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),(0,_debounce_js__WEBPACK_IMPORTED_MODULE_0__.A)(func,wait,{leading,maxWait:wait,trailing})}},"./node_modules/lodash-es/toNumber.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>lodash_es_toNumber});var reWhitespace=/\s/;const _trimmedEndIndex=function trimmedEndIndex(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index};var reTrimStart=/^\s+/;const _baseTrim=function baseTrim(string){return string?string.slice(0,_trimmedEndIndex(string)+1).replace(reTrimStart,""):string};var isObject=__webpack_require__("./node_modules/lodash-es/isObject.js"),isSymbol=__webpack_require__("./node_modules/lodash-es/isSymbol.js"),reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;const lodash_es_toNumber=function toNumber(value){if("number"==typeof value)return value;if((0,isSymbol.A)(value))return NaN;if((0,isObject.A)(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=(0,isObject.A)(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=_baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}},"./node_modules/nanoid/index.browser.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d_:()=>customAlphabet});let random=bytes=>crypto.getRandomValues(new Uint8Array(bytes)),customAlphabet=(alphabet,size=21)=>((alphabet,defaultSize,getRandom)=>{let mask=(2<<Math.log2(alphabet.length-1))-1,step=-~(1.6*mask*defaultSize/alphabet.length);return(size=defaultSize)=>{let id="";for(;;){let bytes=getRandom(step),j=0|step;for(;j--;)if(id+=alphabet[bytes[j]&mask]||"",id.length>=size)return id}}})(alphabet,0|size,random)},"./node_modules/prosemirror-commands/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I$:()=>exitCode,Im:()=>wrapIn,Qv:()=>joinBackward,RV:()=>baseKeymap,_e:()=>selectNodeBackward,eB:()=>joinTextblockBackward,ic:()=>deleteSelection,st:()=>chainCommands,wh:()=>toggleMark,y_:()=>setBlockType});var prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/prosemirror-transform/dist/index.js"),prosemirror_model__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prosemirror-model/dist/index.js"),prosemirror_state__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prosemirror-state/dist/index.js");const deleteSelection=(state,dispatch)=>!state.selection.empty&&(dispatch&&dispatch(state.tr.deleteSelection().scrollIntoView()),!0);function atBlockStart(state,view){let{$cursor}=state.selection;return!$cursor||(view?!view.endOfTextblock("backward",state):$cursor.parentOffset>0)?null:$cursor}const joinBackward=(state,dispatch,view)=>{let $cursor=atBlockStart(state,view);if(!$cursor)return!1;let $cut=findCutBefore($cursor);if(!$cut){let range=$cursor.blockRange(),target=range&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.jP)(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)}let before=$cut.nodeBefore;if(deleteBarrier(state,$cut,dispatch,-1))return!0;if(0==$cursor.parent.content.size&&(textblockAt(before,"end")||prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh.isSelectable(before)))for(let depth=$cursor.depth;;depth--){let delStep=(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.$L)(state.doc,$cursor.before(depth),$cursor.after(depth),prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji.empty);if(delStep&&delStep.slice.size<delStep.to-delStep.from){if(dispatch){let tr=state.tr.step(delStep);tr.setSelection(textblockAt(before,"end")?prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.LN.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos,-1)),-1):prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh.create(tr.doc,$cut.pos-before.nodeSize)),dispatch(tr.scrollIntoView())}return!0}if(1==depth||$cursor.node(depth-1).childCount>1)break}return!(!before.isAtom||$cut.depth!=$cursor.depth-1)&&(dispatch&&dispatch(state.tr.delete($cut.pos-before.nodeSize,$cut.pos).scrollIntoView()),!0)},joinTextblockBackward=(state,dispatch,view)=>{let $cursor=atBlockStart(state,view);if(!$cursor)return!1;let $cut=findCutBefore($cursor);return!!$cut&&joinTextblocksAround(state,$cut,dispatch)};function joinTextblocksAround(state,$cut,dispatch){let beforeText=$cut.nodeBefore,beforePos=$cut.pos-1;for(;!beforeText.isTextblock;beforePos--){if(beforeText.type.spec.isolating)return!1;let child=beforeText.lastChild;if(!child)return!1;beforeText=child}let afterText=$cut.nodeAfter,afterPos=$cut.pos+1;for(;!afterText.isTextblock;afterPos++){if(afterText.type.spec.isolating)return!1;let child=afterText.firstChild;if(!child)return!1;afterText=child}let step=(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.$L)(state.doc,beforePos,afterPos,prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji.empty);if(!step||step.from!=beforePos||step instanceof prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.Ln&&step.slice.size>=afterPos-beforePos)return!1;if(dispatch){let tr=state.tr.step(step);tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.U3.create(tr.doc,beforePos)),dispatch(tr.scrollIntoView())}return!0}function textblockAt(node,side,only=!1){for(let scan=node;scan;scan="start"==side?scan.firstChild:scan.lastChild){if(scan.isTextblock)return!0;if(only&&1!=scan.childCount)return!1}return!1}const selectNodeBackward=(state,dispatch,view)=>{let{$head,empty}=state.selection,$cut=$head;if(!empty)return!1;if($head.parent.isTextblock){if(view?!view.endOfTextblock("backward",state):$head.parentOffset>0)return!1;$cut=findCutBefore($head)}let node=$cut&&$cut.nodeBefore;return!(!node||!prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh.isSelectable(node))&&(dispatch&&dispatch(state.tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh.create(state.doc,$cut.pos-node.nodeSize)).scrollIntoView()),!0)};function findCutBefore($pos){if(!$pos.parent.type.spec.isolating)for(let i=$pos.depth-1;i>=0;i--){if($pos.index(i)>0)return $pos.doc.resolve($pos.before(i+1));if($pos.node(i).type.spec.isolating)break}return null}function atBlockEnd(state,view){let{$cursor}=state.selection;return!$cursor||(view?!view.endOfTextblock("forward",state):$cursor.parentOffset<$cursor.parent.content.size)?null:$cursor}function findCutAfter($pos){if(!$pos.parent.type.spec.isolating)for(let i=$pos.depth-1;i>=0;i--){let parent=$pos.node(i);if($pos.index(i)+1<parent.childCount)return $pos.doc.resolve($pos.after(i+1));if(parent.type.spec.isolating)break}return null}function defaultBlockAt(match){for(let i=0;i<match.edgeCount;i++){let{type}=match.edge(i);if(type.isTextblock&&!type.hasRequiredAttrs())return type}return null}const exitCode=(state,dispatch)=>{let{$head,$anchor}=state.selection;if(!$head.parent.type.spec.code||!$head.sameParent($anchor))return!1;let above=$head.node(-1),after=$head.indexAfter(-1),type=defaultBlockAt(above.contentMatchAt(after));if(!type||!above.canReplaceWith(after,after,type))return!1;if(dispatch){let pos=$head.after(),tr=state.tr.replaceWith(pos,pos,type.createAndFill());tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.LN.near(tr.doc.resolve(pos),1)),dispatch(tr.scrollIntoView())}return!0};const splitBlock=function splitBlockAs(splitNode){return(state,dispatch)=>{let{$from,$to}=state.selection;if(state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh&&state.selection.node.isBlock)return!(!$from.parentOffset||!(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.zy)(state.doc,$from.pos))&&(dispatch&&dispatch(state.tr.split($from.pos).scrollIntoView()),!0);if(!$from.depth)return!1;let splitDepth,deflt,types=[],atEnd=!1,atStart=!1;for(let d=$from.depth;;d--){if($from.node(d).isBlock){atEnd=$from.end(d)==$from.pos+($from.depth-d),atStart=$from.start(d)==$from.pos-($from.depth-d),deflt=defaultBlockAt($from.node(d-1).contentMatchAt($from.indexAfter(d-1)));let splitType=splitNode&&splitNode($to.parent,atEnd,$from);types.unshift(splitType||(atEnd&&deflt?{type:deflt}:null)),splitDepth=d;break}if(1==d)return!1;types.unshift(null)}let tr=state.tr;(state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.U3||state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.i5)&&tr.deleteSelection();let splitPos=tr.mapping.map($from.pos),can=(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.zy)(tr.doc,splitPos,types.length,types);if(can||(types[0]=deflt?{type:deflt}:null,can=(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.zy)(tr.doc,splitPos,types.length,types)),!can)return!1;if(tr.split(splitPos,types.length,types),!atEnd&&atStart&&$from.node(splitDepth).type!=deflt){let first=tr.mapping.map($from.before(splitDepth)),$first=tr.doc.resolve(first);deflt&&$from.node(splitDepth-1).canReplaceWith($first.index(),$first.index()+1,deflt)&&tr.setNodeMarkup(tr.mapping.map($from.before(splitDepth)),deflt)}return dispatch&&dispatch(tr.scrollIntoView()),!0}}();function deleteBarrier(state,$cut,dispatch,dir){let conn,match,before=$cut.nodeBefore,after=$cut.nodeAfter,isolated=before.type.spec.isolating||after.type.spec.isolating;if(!isolated&&function joinMaybeClear(state,$pos,dispatch){let before=$pos.nodeBefore,after=$pos.nodeAfter,index=$pos.index();return!(!(before&&after&&before.type.compatibleContent(after.type))||(!before.content.size&&$pos.parent.canReplace(index-1,index)?(dispatch&&dispatch(state.tr.delete($pos.pos-before.nodeSize,$pos.pos).scrollIntoView()),0):!$pos.parent.canReplace(index,index+1)||!after.isTextblock&&!(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.n9)(state.doc,$pos.pos)||(dispatch&&dispatch(state.tr.join($pos.pos).scrollIntoView()),0)))}(state,$cut,dispatch))return!0;let canDelAfter=!isolated&&$cut.parent.canReplace($cut.index(),$cut.index()+1);if(canDelAfter&&(conn=(match=before.contentMatchAt(before.childCount)).findWrapping(after.type))&&match.matchType(conn[0]||after.type).validEnd){if(dispatch){let end=$cut.pos+after.nodeSize,wrap=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.empty;for(let i=conn.length-1;i>=0;i--)wrap=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(conn[i].create(null,wrap));wrap=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(before.copy(wrap));let tr=state.tr.step(new prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.Wg($cut.pos-1,end,$cut.pos,end,new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji(wrap,1,0),conn.length,!0)),$joinAt=tr.doc.resolve(end+2*conn.length);$joinAt.nodeAfter&&$joinAt.nodeAfter.type==before.type&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.n9)(tr.doc,$joinAt.pos)&&tr.join($joinAt.pos),dispatch(tr.scrollIntoView())}return!0}let selAfter=after.type.spec.isolating||dir>0&&isolated?null:prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.LN.findFrom($cut,1),range=selAfter&&selAfter.$from.blockRange(selAfter.$to),target=range&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.jP)(range);if(null!=target&&target>=$cut.depth)return dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0;if(canDelAfter&&textblockAt(after,"start",!0)&&textblockAt(before,"end")){let at=before,wrap=[];for(;wrap.push(at),!at.isTextblock;)at=at.lastChild;let afterText=after,afterDepth=1;for(;!afterText.isTextblock;afterText=afterText.firstChild)afterDepth++;if(at.canReplace(at.childCount,at.childCount,afterText.content)){if(dispatch){let end=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.empty;for(let i=wrap.length-1;i>=0;i--)end=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(wrap[i].copy(end));dispatch(state.tr.step(new prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.Wg($cut.pos-wrap.length,$cut.pos+after.nodeSize,$cut.pos+afterDepth,$cut.pos+after.nodeSize-afterDepth,new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji(end,wrap.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function selectTextblockSide(side){return function(state,dispatch){let sel=state.selection,$pos=side<0?sel.$from:sel.$to,depth=$pos.depth;for(;$pos.node(depth).isInline;){if(!depth)return!1;depth--}return!!$pos.node(depth).isTextblock&&(dispatch&&dispatch(state.tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.U3.create(state.doc,side<0?$pos.start(depth):$pos.end(depth)))),!0)}}const selectTextblockStart=selectTextblockSide(-1),selectTextblockEnd=selectTextblockSide(1);function wrapIn(nodeType,attrs=null){return function(state,dispatch){let{$from,$to}=state.selection,range=$from.blockRange($to),wrapping=range&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.oM)(range,nodeType,attrs);return!!wrapping&&(dispatch&&dispatch(state.tr.wrap(range,wrapping).scrollIntoView()),!0)}}function setBlockType(nodeType,attrs=null){return function(state,dispatch){let applicable=!1;for(let i=0;i<state.selection.ranges.length&&!applicable;i++){let{$from:{pos:from},$to:{pos:to}}=state.selection.ranges[i];state.doc.nodesBetween(from,to,(node,pos)=>{if(applicable)return!1;if(node.isTextblock&&!node.hasMarkup(nodeType,attrs))if(node.type==nodeType)applicable=!0;else{let $pos=state.doc.resolve(pos),index=$pos.index();applicable=$pos.parent.canReplaceWith(index,index+1,nodeType)}})}if(!applicable)return!1;if(dispatch){let tr=state.tr;for(let i=0;i<state.selection.ranges.length;i++){let{$from:{pos:from},$to:{pos:to}}=state.selection.ranges[i];tr.setBlockType(from,to,nodeType,attrs)}dispatch(tr.scrollIntoView())}return!0}}function toggleMark(markType,attrs=null,options){let removeWhenPresent=!1!==(options&&options.removeWhenPresent),enterAtoms=!1!==(options&&options.enterInlineAtoms),dropSpace=!(options&&options.includeWhitespace);return function(state,dispatch){let{empty,$cursor,ranges}=state.selection;if(empty&&!$cursor||!function markApplies(doc,ranges,type,enterAtoms){for(let i=0;i<ranges.length;i++){let{$from,$to}=ranges[i],can=0==$from.depth&&doc.inlineContent&&doc.type.allowsMarkType(type);if(doc.nodesBetween($from.pos,$to.pos,(node,pos)=>{if(can||!enterAtoms&&node.isAtom&&node.isInline&&pos>=$from.pos&&pos+node.nodeSize<=$to.pos)return!1;can=node.inlineContent&&node.type.allowsMarkType(type)}),can)return!0}return!1}(state.doc,ranges,markType,enterAtoms))return!1;if(dispatch)if($cursor)markType.isInSet(state.storedMarks||$cursor.marks())?dispatch(state.tr.removeStoredMark(markType)):dispatch(state.tr.addStoredMark(markType.create(attrs)));else{let add,tr=state.tr;enterAtoms||(ranges=function removeInlineAtoms(ranges){let result=[];for(let i=0;i<ranges.length;i++){let{$from,$to}=ranges[i];$from.doc.nodesBetween($from.pos,$to.pos,(node,pos)=>{if(node.isAtom&&node.content.size&&node.isInline&&pos>=$from.pos&&pos+node.nodeSize<=$to.pos)return pos+1>$from.pos&&result.push(new prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.yn($from,$from.doc.resolve(pos+1))),$from=$from.doc.resolve(pos+1+node.content.size),!1}),$from.pos<$to.pos&&result.push(new prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.yn($from,$to))}return result}(ranges)),add=removeWhenPresent?!ranges.some(r=>state.doc.rangeHasMark(r.$from.pos,r.$to.pos,markType)):!ranges.every(r=>{let missing=!1;return tr.doc.nodesBetween(r.$from.pos,r.$to.pos,(node,pos,parent)=>{if(missing)return!1;missing=!markType.isInSet(node.marks)&&!!parent&&parent.type.allowsMarkType(markType)&&!(node.isText&&/^\s*$/.test(node.textBetween(Math.max(0,r.$from.pos-pos),Math.min(node.nodeSize,r.$to.pos-pos))))}),!missing});for(let i=0;i<ranges.length;i++){let{$from,$to}=ranges[i];if(add){let from=$from.pos,to=$to.pos,start=$from.nodeAfter,end=$to.nodeBefore,spaceStart=dropSpace&&start&&start.isText?/^\s*/.exec(start.text)[0].length:0,spaceEnd=dropSpace&&end&&end.isText?/\s*$/.exec(end.text)[0].length:0;from+spaceStart<to&&(from+=spaceStart,to-=spaceEnd),tr.addMark(from,to,markType.create(attrs))}else tr.removeMark($from.pos,$to.pos,markType)}dispatch(tr.scrollIntoView())}return!0}}function chainCommands(...commands){return function(state,dispatch,view){for(let i=0;i<commands.length;i++)if(commands[i](state,dispatch,view))return!0;return!1}}let backspace=chainCommands(deleteSelection,joinBackward,selectNodeBackward),del=chainCommands(deleteSelection,(state,dispatch,view)=>{let $cursor=atBlockEnd(state,view);if(!$cursor)return!1;let $cut=findCutAfter($cursor);if(!$cut)return!1;let after=$cut.nodeAfter;if(deleteBarrier(state,$cut,dispatch,1))return!0;if(0==$cursor.parent.content.size&&(textblockAt(after,"start")||prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh.isSelectable(after))){let delStep=(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.$L)(state.doc,$cursor.before(),$cursor.after(),prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji.empty);if(delStep&&delStep.slice.size<delStep.to-delStep.from){if(dispatch){let tr=state.tr.step(delStep);tr.setSelection(textblockAt(after,"start")?prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.LN.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos)),1):prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh.create(tr.doc,tr.mapping.map($cut.pos))),dispatch(tr.scrollIntoView())}return!0}}return!(!after.isAtom||$cut.depth!=$cursor.depth-1)&&(dispatch&&dispatch(state.tr.delete($cut.pos,$cut.pos+after.nodeSize).scrollIntoView()),!0)},(state,dispatch,view)=>{let{$head,empty}=state.selection,$cut=$head;if(!empty)return!1;if($head.parent.isTextblock){if(view?!view.endOfTextblock("forward",state):$head.parentOffset<$head.parent.content.size)return!1;$cut=findCutAfter($head)}let node=$cut&&$cut.nodeAfter;return!(!node||!prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh.isSelectable(node))&&(dispatch&&dispatch(state.tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.nh.create(state.doc,$cut.pos)).scrollIntoView()),!0)});const pcBaseKeymap={Enter:chainCommands((state,dispatch)=>{let{$head,$anchor}=state.selection;return!(!$head.parent.type.spec.code||!$head.sameParent($anchor))&&(dispatch&&dispatch(state.tr.insertText("\n").scrollIntoView()),!0)},(state,dispatch)=>{let sel=state.selection,{$from,$to}=sel;if(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.i5||$from.parent.inlineContent||$to.parent.inlineContent)return!1;let type=defaultBlockAt($to.parent.contentMatchAt($to.indexAfter()));if(!type||!type.isTextblock)return!1;if(dispatch){let side=(!$from.parentOffset&&$to.index()<$to.parent.childCount?$from:$to).pos,tr=state.tr.insert(side,type.createAndFill());tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.U3.create(tr.doc,side+1)),dispatch(tr.scrollIntoView())}return!0},(state,dispatch)=>{let{$cursor}=state.selection;if(!$cursor||$cursor.parent.content.size)return!1;if($cursor.depth>1&&$cursor.after()!=$cursor.end(-1)){let before=$cursor.before();if((0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.zy)(state.doc,before))return dispatch&&dispatch(state.tr.split(before).scrollIntoView()),!0}let range=$cursor.blockRange(),target=range&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.jP)(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)},splitBlock),"Mod-Enter":exitCode,Backspace:backspace,"Mod-Backspace":backspace,"Shift-Backspace":backspace,Delete:del,"Mod-Delete":del,"Mod-a":(state,dispatch)=>(dispatch&&dispatch(state.tr.setSelection(new prosemirror_state__WEBPACK_IMPORTED_MODULE_2__.i5(state.doc))),!0)},macBaseKeymap={"Ctrl-h":pcBaseKeymap.Backspace,"Alt-Backspace":pcBaseKeymap["Mod-Backspace"],"Ctrl-d":pcBaseKeymap.Delete,"Ctrl-Alt-Backspace":pcBaseKeymap["Mod-Delete"],"Alt-Delete":pcBaseKeymap["Mod-Delete"],"Alt-d":pcBaseKeymap["Mod-Delete"],"Ctrl-a":selectTextblockStart,"Ctrl-e":selectTextblockEnd};for(let key in pcBaseKeymap)macBaseKeymap[key]=pcBaseKeymap[key];const baseKeymap=("undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!("undefined"==typeof os||!os.platform)&&"darwin"==os.platform())?macBaseKeymap:pcBaseKeymap},"./node_modules/prosemirror-history/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b6:()=>dist_history,ZS:()=>redo,tN:()=>undo});var RopeSequence=function RopeSequence(){};RopeSequence.prototype.append=function append(other){return other.length?(other=RopeSequence.from(other),!this.length&&other||other.length<200&&this.leafAppend(other)||this.length<200&&other.leafPrepend(this)||this.appendInner(other)):this},RopeSequence.prototype.prepend=function prepend(other){return other.length?RopeSequence.from(other).append(this):this},RopeSequence.prototype.appendInner=function appendInner(other){return new Append(this,other)},RopeSequence.prototype.slice=function slice(from,to){return void 0===from&&(from=0),void 0===to&&(to=this.length),from>=to?RopeSequence.empty:this.sliceInner(Math.max(0,from),Math.min(this.length,to))},RopeSequence.prototype.get=function get(i){if(!(i<0||i>=this.length))return this.getInner(i)},RopeSequence.prototype.forEach=function forEach(f,from,to){void 0===from&&(from=0),void 0===to&&(to=this.length),from<=to?this.forEachInner(f,from,to,0):this.forEachInvertedInner(f,from,to,0)},RopeSequence.prototype.map=function map(f,from,to){void 0===from&&(from=0),void 0===to&&(to=this.length);var result=[];return this.forEach(function(elt,i){return result.push(f(elt,i))},from,to),result},RopeSequence.from=function from(values){return values instanceof RopeSequence?values:values&&values.length?new Leaf(values):RopeSequence.empty};var Leaf=function(RopeSequence){function Leaf(values){RopeSequence.call(this),this.values=values}RopeSequence&&(Leaf.__proto__=RopeSequence),Leaf.prototype=Object.create(RopeSequence&&RopeSequence.prototype),Leaf.prototype.constructor=Leaf;var prototypeAccessors={length:{configurable:!0},depth:{configurable:!0}};return Leaf.prototype.flatten=function flatten(){return this.values},Leaf.prototype.sliceInner=function sliceInner(from,to){return 0==from&&to==this.length?this:new Leaf(this.values.slice(from,to))},Leaf.prototype.getInner=function getInner(i){return this.values[i]},Leaf.prototype.forEachInner=function forEachInner(f,from,to,start){for(var i=from;i<to;i++)if(!1===f(this.values[i],start+i))return!1},Leaf.prototype.forEachInvertedInner=function forEachInvertedInner(f,from,to,start){for(var i=from-1;i>=to;i--)if(!1===f(this.values[i],start+i))return!1},Leaf.prototype.leafAppend=function leafAppend(other){if(this.length+other.length<=200)return new Leaf(this.values.concat(other.flatten()))},Leaf.prototype.leafPrepend=function leafPrepend(other){if(this.length+other.length<=200)return new Leaf(other.flatten().concat(this.values))},prototypeAccessors.length.get=function(){return this.values.length},prototypeAccessors.depth.get=function(){return 0},Object.defineProperties(Leaf.prototype,prototypeAccessors),Leaf}(RopeSequence);RopeSequence.empty=new Leaf([]);var Append=function(RopeSequence){function Append(left,right){RopeSequence.call(this),this.left=left,this.right=right,this.length=left.length+right.length,this.depth=Math.max(left.depth,right.depth)+1}return RopeSequence&&(Append.__proto__=RopeSequence),Append.prototype=Object.create(RopeSequence&&RopeSequence.prototype),Append.prototype.constructor=Append,Append.prototype.flatten=function flatten(){return this.left.flatten().concat(this.right.flatten())},Append.prototype.getInner=function getInner(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},Append.prototype.forEachInner=function forEachInner(f,from,to,start){var leftLen=this.left.length;return!(from<leftLen&&!1===this.left.forEachInner(f,from,Math.min(to,leftLen),start))&&(!(to>leftLen&&!1===this.right.forEachInner(f,Math.max(from-leftLen,0),Math.min(this.length,to)-leftLen,start+leftLen))&&void 0)},Append.prototype.forEachInvertedInner=function forEachInvertedInner(f,from,to,start){var leftLen=this.left.length;return!(from>leftLen&&!1===this.right.forEachInvertedInner(f,from-leftLen,Math.max(to,leftLen)-leftLen,start+leftLen))&&(!(to<leftLen&&!1===this.left.forEachInvertedInner(f,Math.min(from,leftLen),to,start))&&void 0)},Append.prototype.sliceInner=function sliceInner(from,to){if(0==from&&to==this.length)return this;var leftLen=this.left.length;return to<=leftLen?this.left.slice(from,to):from>=leftLen?this.right.slice(from-leftLen,to-leftLen):this.left.slice(from,leftLen).append(this.right.slice(0,to-leftLen))},Append.prototype.leafAppend=function leafAppend(other){var inner=this.right.leafAppend(other);if(inner)return new Append(this.left,inner)},Append.prototype.leafPrepend=function leafPrepend(other){var inner=this.left.leafPrepend(other);if(inner)return new Append(inner,this.right)},Append.prototype.appendInner=function appendInner(other){return this.left.depth>=Math.max(this.right.depth,other.depth)+1?new Append(this.left,new Append(this.right,other)):new Append(this,other)},Append}(RopeSequence);const dist=RopeSequence;var prosemirror_transform_dist=__webpack_require__("./node_modules/prosemirror-transform/dist/index.js"),prosemirror_state_dist=__webpack_require__("./node_modules/prosemirror-state/dist/index.js");class Branch{constructor(items,eventCount){this.items=items,this.eventCount=eventCount}popEvent(state,preserveItems){if(0==this.eventCount)return null;let remap,mapFrom,end=this.items.length;for(;;end--){if(this.items.get(end-1).selection){--end;break}}preserveItems&&(remap=this.remapping(end,this.items.length),mapFrom=remap.maps.length);let selection,remaining,transform=state.tr,addAfter=[],addBefore=[];return this.items.forEach((item,i)=>{if(!item.step)return remap||(remap=this.remapping(end,i+1),mapFrom=remap.maps.length),mapFrom--,void addBefore.push(item);if(remap){addBefore.push(new Item(item.map));let map,step=item.step.map(remap.slice(mapFrom));step&&transform.maybeStep(step).doc&&(map=transform.mapping.maps[transform.mapping.maps.length-1],addAfter.push(new Item(map,void 0,void 0,addAfter.length+addBefore.length))),mapFrom--,map&&remap.appendMap(map,mapFrom)}else transform.maybeStep(item.step);return item.selection?(selection=remap?item.selection.map(remap.slice(mapFrom)):item.selection,remaining=new Branch(this.items.slice(0,end).append(addBefore.reverse().concat(addAfter)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining,transform,selection}}addTransform(transform,selection,histOptions,preserveItems){let newItems=[],eventCount=this.eventCount,oldItems=this.items,lastItem=!preserveItems&&oldItems.length?oldItems.get(oldItems.length-1):null;for(let i=0;i<transform.steps.length;i++){let merged,step=transform.steps[i].invert(transform.docs[i]),item=new Item(transform.mapping.maps[i],step,selection);(merged=lastItem&&lastItem.merge(item))&&(item=merged,i?newItems.pop():oldItems=oldItems.slice(0,oldItems.length-1)),newItems.push(item),selection&&(eventCount++,selection=void 0),preserveItems||(lastItem=item)}let overflow=eventCount-histOptions.depth;return overflow>DEPTH_OVERFLOW&&(oldItems=function cutOffEvents(items,n){let cutPoint;return items.forEach((item,i)=>{if(item.selection&&0==n--)return cutPoint=i,!1}),items.slice(cutPoint)}(oldItems,overflow),eventCount-=overflow),new Branch(oldItems.append(newItems),eventCount)}remapping(from,to){let maps=new prosemirror_transform_dist.X9;return this.items.forEach((item,i)=>{let mirrorPos=null!=item.mirrorOffset&&i-item.mirrorOffset>=from?maps.maps.length-item.mirrorOffset:void 0;maps.appendMap(item.map,mirrorPos)},from,to),maps}addMaps(array){return 0==this.eventCount?this:new Branch(this.items.append(array.map(map=>new Item(map))),this.eventCount)}rebased(rebasedTransform,rebasedCount){if(!this.eventCount)return this;let rebasedItems=[],start=Math.max(0,this.items.length-rebasedCount),mapping=rebasedTransform.mapping,newUntil=rebasedTransform.steps.length,eventCount=this.eventCount;this.items.forEach(item=>{item.selection&&eventCount--},start);let iRebased=rebasedCount;this.items.forEach(item=>{let pos=mapping.getMirror(--iRebased);if(null==pos)return;newUntil=Math.min(newUntil,pos);let map=mapping.maps[pos];if(item.step){let step=rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos]),selection=item.selection&&item.selection.map(mapping.slice(iRebased+1,pos));selection&&eventCount++,rebasedItems.push(new Item(map,step,selection))}else rebasedItems.push(new Item(map))},start);let newMaps=[];for(let i=rebasedCount;i<newUntil;i++)newMaps.push(new Item(mapping.maps[i]));let items=this.items.slice(0,start).append(newMaps).append(rebasedItems),branch=new Branch(items,eventCount);return branch.emptyItemCount()>500&&(branch=branch.compress(this.items.length-rebasedItems.length)),branch}emptyItemCount(){let count=0;return this.items.forEach(item=>{item.step||count++}),count}compress(upto=this.items.length){let remap=this.remapping(0,upto),mapFrom=remap.maps.length,items=[],events=0;return this.items.forEach((item,i)=>{if(i>=upto)items.push(item),item.selection&&events++;else if(item.step){let step=item.step.map(remap.slice(mapFrom)),map=step&&step.getMap();if(mapFrom--,map&&remap.appendMap(map,mapFrom),step){let selection=item.selection&&item.selection.map(remap.slice(mapFrom));selection&&events++;let merged,newItem=new Item(map.invert(),step,selection),last=items.length-1;(merged=items.length&&items[last].merge(newItem))?items[last]=merged:items.push(newItem)}}else item.map&&mapFrom--},this.items.length,0),new Branch(dist.from(items.reverse()),events)}}Branch.empty=new Branch(dist.empty,0);class Item{constructor(map,step,selection,mirrorOffset){this.map=map,this.step=step,this.selection=selection,this.mirrorOffset=mirrorOffset}merge(other){if(this.step&&other.step&&!other.selection){let step=other.step.merge(this.step);if(step)return new Item(step.getMap().invert(),step,this.selection)}}}class HistoryState{constructor(done,undone,prevRanges,prevTime,prevComposition){this.done=done,this.undone=undone,this.prevRanges=prevRanges,this.prevTime=prevTime,this.prevComposition=prevComposition}}const DEPTH_OVERFLOW=20;function rangesFor(maps){let result=[];for(let i=maps.length-1;i>=0&&0==result.length;i--)maps[i].forEach((_from,_to,from,to)=>result.push(from,to));return result}function mapRanges(ranges,mapping){if(!ranges)return null;let result=[];for(let i=0;i<ranges.length;i+=2){let from=mapping.map(ranges[i],1),to=mapping.map(ranges[i+1],-1);from<=to&&result.push(from,to)}return result}let cachedPreserveItems=!1,cachedPreserveItemsPlugins=null;function mustPreserveItems(state){let plugins=state.plugins;if(cachedPreserveItemsPlugins!=plugins){cachedPreserveItems=!1,cachedPreserveItemsPlugins=plugins;for(let i=0;i<plugins.length;i++)if(plugins[i].spec.historyPreserveItems){cachedPreserveItems=!0;break}}return cachedPreserveItems}const historyKey=new prosemirror_state_dist.hs("history"),closeHistoryKey=new prosemirror_state_dist.hs("closeHistory");function dist_history(config={}){return config={depth:config.depth||100,newGroupDelay:config.newGroupDelay||500},new prosemirror_state_dist.k_({key:historyKey,state:{init:()=>new HistoryState(Branch.empty,Branch.empty,null,0,-1),apply:(tr,hist,state)=>function applyTransaction(history,state,tr,options){let rebased,historyTr=tr.getMeta(historyKey);if(historyTr)return historyTr.historyState;tr.getMeta(closeHistoryKey)&&(history=new HistoryState(history.done,history.undone,null,0,-1));let appended=tr.getMeta("appendedTransaction");if(0==tr.steps.length)return history;if(appended&&appended.getMeta(historyKey))return appended.getMeta(historyKey).redo?new HistoryState(history.done.addTransform(tr,void 0,options,mustPreserveItems(state)),history.undone,rangesFor(tr.mapping.maps),history.prevTime,history.prevComposition):new HistoryState(history.done,history.undone.addTransform(tr,void 0,options,mustPreserveItems(state)),null,history.prevTime,history.prevComposition);if(!1===tr.getMeta("addToHistory")||appended&&!1===appended.getMeta("addToHistory"))return(rebased=tr.getMeta("rebased"))?new HistoryState(history.done.rebased(tr,rebased),history.undone.rebased(tr,rebased),mapRanges(history.prevRanges,tr.mapping),history.prevTime,history.prevComposition):new HistoryState(history.done.addMaps(tr.mapping.maps),history.undone.addMaps(tr.mapping.maps),mapRanges(history.prevRanges,tr.mapping),history.prevTime,history.prevComposition);{let composition=tr.getMeta("composition"),newGroup=0==history.prevTime||!appended&&history.prevComposition!=composition&&(history.prevTime<(tr.time||0)-options.newGroupDelay||!function isAdjacentTo(transform,prevRanges){if(!prevRanges)return!1;if(!transform.docChanged)return!0;let adjacent=!1;return transform.mapping.maps[0].forEach((start,end)=>{for(let i=0;i<prevRanges.length;i+=2)start<=prevRanges[i+1]&&end>=prevRanges[i]&&(adjacent=!0)}),adjacent}(tr,history.prevRanges)),prevRanges=appended?mapRanges(history.prevRanges,tr.mapping):rangesFor(tr.mapping.maps);return new HistoryState(history.done.addTransform(tr,newGroup?state.selection.getBookmark():void 0,options,mustPreserveItems(state)),Branch.empty,prevRanges,tr.time,null==composition?history.prevComposition:composition)}}(hist,state,tr,config)},config,props:{handleDOMEvents:{beforeinput(view,e){let inputType=e.inputType,command="historyUndo"==inputType?undo:"historyRedo"==inputType?redo:null;return!!command&&(e.preventDefault(),command(view.state,view.dispatch))}}}})}function buildCommand(redo,scroll){return(state,dispatch)=>{let hist=historyKey.getState(state);if(!hist||0==(redo?hist.undone:hist.done).eventCount)return!1;if(dispatch){let tr=function histTransaction(history,state,redo){let preserveItems=mustPreserveItems(state),histOptions=historyKey.get(state).spec.config,pop=(redo?history.undone:history.done).popEvent(state,preserveItems);if(!pop)return null;let selection=pop.selection.resolve(pop.transform.doc),added=(redo?history.done:history.undone).addTransform(pop.transform,state.selection.getBookmark(),histOptions,preserveItems),newHist=new HistoryState(redo?added:pop.remaining,redo?pop.remaining:added,null,0,-1);return pop.transform.setSelection(selection).setMeta(historyKey,{redo,historyState:newHist})}(hist,state,redo);tr&&dispatch(scroll?tr.scrollIntoView():tr)}return!0}}const undo=buildCommand(!1,!0),redo=buildCommand(!0,!0);buildCommand(!1,!1),buildCommand(!0,!1)},"./node_modules/prosemirror-inputrules/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{JJ:()=>textblockTypeInputRule,dv:()=>undoInputRule,fV:()=>InputRule,tG:()=>wrappingInputRule});var prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/prosemirror-transform/dist/index.js");class InputRule{constructor(match,handler,options={}){this.match=match,this.match=match,this.handler="string"==typeof handler?function stringHandler(string){return function(state,match,start,end){let insert=string;if(match[1]){let offset=match[0].lastIndexOf(match[1]);insert+=match[0].slice(offset+match[1].length);let cutOff=(start+=offset)-end;cutOff>0&&(insert=match[0].slice(offset-cutOff,offset)+insert,start=end)}return state.tr.insertText(insert,start,end)}}(handler):handler,this.undoable=!1!==options.undoable,this.inCode=options.inCode||!1,this.inCodeMark=!1!==options.inCodeMark}}const undoInputRule=(state,dispatch)=>{let plugins=state.plugins;for(let i=0;i<plugins.length;i++){let undoable,plugin=plugins[i];if(plugin.spec.isInputRules&&(undoable=plugin.getState(state))){if(dispatch){let tr=state.tr,toUndo=undoable.transform;for(let j=toUndo.steps.length-1;j>=0;j--)tr.step(toUndo.steps[j].invert(toUndo.docs[j]));if(undoable.text){let marks=tr.doc.resolve(undoable.from).marks();tr.replaceWith(undoable.from,undoable.to,state.schema.text(undoable.text,marks))}else tr.delete(undoable.from,undoable.to);dispatch(tr)}return!0}}return!1};new InputRule(/--$/,"—",{inCodeMark:!1}),new InputRule(/\.\.\.$/,"…",{inCodeMark:!1}),new InputRule(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“",{inCodeMark:!1}),new InputRule(/"$/,"”",{inCodeMark:!1}),new InputRule(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘",{inCodeMark:!1}),new InputRule(/'$/,"’",{inCodeMark:!1});function wrappingInputRule(regexp,nodeType,getAttrs=null,joinPredicate){return new InputRule(regexp,(state,match,start,end)=>{let attrs=getAttrs instanceof Function?getAttrs(match):getAttrs,tr=state.tr.delete(start,end),range=tr.doc.resolve(start).blockRange(),wrapping=range&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.oM)(range,nodeType,attrs);if(!wrapping)return null;tr.wrap(range,wrapping);let before=tr.doc.resolve(start-1).nodeBefore;return before&&before.type==nodeType&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_0__.n9)(tr.doc,start-1)&&(!joinPredicate||joinPredicate(match,before))&&tr.join(start-1),tr})}function textblockTypeInputRule(regexp,nodeType,getAttrs=null){return new InputRule(regexp,(state,match,start,end)=>{let $start=state.doc.resolve(start),attrs=getAttrs instanceof Function?getAttrs(match):getAttrs;return $start.node(-1).canReplaceWith($start.index(-1),$start.indexAfter(-1),nodeType)?state.tr.delete(start,end).setBlockType(start,start,nodeType,attrs):null})}},"./node_modules/prosemirror-keymap/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>keydownHandler,w:()=>keymap});var w3c_keyname__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/w3c-keyname/index.js"),prosemirror_state__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prosemirror-state/dist/index.js");const mac="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),windows="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function normalizeKeyName(name){let alt,ctrl,shift,meta,parts=name.split(/-(?!$)/),result=parts[parts.length-1];"Space"==result&&(result=" ");for(let i=0;i<parts.length-1;i++){let mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))meta=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift=!0;else{if(!/^mod$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);mac?meta=!0:ctrl=!0}}return alt&&(result="Alt-"+result),ctrl&&(result="Ctrl-"+result),meta&&(result="Meta-"+result),shift&&(result="Shift-"+result),result}function modifiers(name,event,shift=!0){return event.altKey&&(name="Alt-"+name),event.ctrlKey&&(name="Ctrl-"+name),event.metaKey&&(name="Meta-"+name),shift&&event.shiftKey&&(name="Shift-"+name),name}function keymap(bindings){return new prosemirror_state__WEBPACK_IMPORTED_MODULE_1__.k_({props:{handleKeyDown:keydownHandler(bindings)}})}function keydownHandler(bindings){let map=function normalize(map){let copy=Object.create(null);for(let prop in map)copy[normalizeKeyName(prop)]=map[prop];return copy}(bindings);return function(view,event){let baseName,name=(0,w3c_keyname__WEBPACK_IMPORTED_MODULE_0__.xT)(event),direct=map[modifiers(name,event)];if(direct&&direct(view.state,view.dispatch,view))return!0;if(1==name.length&&" "!=name){if(event.shiftKey){let noShift=map[modifiers(name,event,!1)];if(noShift&&noShift(view.state,view.dispatch,view))return!0}if((event.altKey||event.metaKey||event.ctrlKey)&&!(windows&&event.ctrlKey&&event.altKey)&&(baseName=w3c_keyname__WEBPACK_IMPORTED_MODULE_0__.E3[event.keyCode])&&baseName!=name){let fromCode=map[modifiers(baseName,event)];if(fromCode&&fromCode(view.state,view.dispatch,view))return!0}}return!1}}},"./node_modules/prosemirror-model/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function OrderedMap(content){this.content=content}__webpack_require__.d(__webpack_exports__,{S4:()=>DOMParser,ZF:()=>DOMSerializer,FK:()=>Fragment,CU:()=>Mark,sX:()=>MarkType,bP:()=>Node,u$:()=>NodeRange,Z6:()=>NodeType,vI:()=>ReplaceError,Sj:()=>Schema,Ji:()=>Slice}),OrderedMap.prototype={constructor:OrderedMap,find:function(key){for(var i=0;i<this.content.length;i+=2)if(this.content[i]===key)return i;return-1},get:function(key){var found=this.find(key);return-1==found?void 0:this.content[found+1]},update:function(key,value,newKey){var self=newKey&&newKey!=key?this.remove(newKey):this,found=self.find(key),content=self.content.slice();return-1==found?content.push(newKey||key,value):(content[found+1]=value,newKey&&(content[found]=newKey)),new OrderedMap(content)},remove:function(key){var found=this.find(key);if(-1==found)return this;var content=this.content.slice();return content.splice(found,2),new OrderedMap(content)},addToStart:function(key,value){return new OrderedMap([key,value].concat(this.remove(key).content))},addToEnd:function(key,value){var content=this.remove(key).content.slice();return content.push(key,value),new OrderedMap(content)},addBefore:function(place,key,value){var without=this.remove(key),content=without.content.slice(),found=without.find(place);return content.splice(-1==found?content.length:found,0,key,value),new OrderedMap(content)},forEach:function(f){for(var i=0;i<this.content.length;i+=2)f(this.content[i],this.content[i+1])},prepend:function(map){return(map=OrderedMap.from(map)).size?new OrderedMap(map.content.concat(this.subtract(map).content)):this},append:function(map){return(map=OrderedMap.from(map)).size?new OrderedMap(this.subtract(map).content.concat(map.content)):this},subtract:function(map){var result=this;map=OrderedMap.from(map);for(var i=0;i<map.content.length;i+=2)result=result.remove(map.content[i]);return result},toObject:function(){var result={};return this.forEach(function(key,value){result[key]=value}),result},get size(){return this.content.length>>1}},OrderedMap.from=function(value){if(value instanceof OrderedMap)return value;var content=[];if(value)for(var prop in value)content.push(prop,value[prop]);return new OrderedMap(content)};const dist=OrderedMap;function findDiffStart(a,b,pos){for(let i=0;;i++){if(i==a.childCount||i==b.childCount)return a.childCount==b.childCount?null:pos;let childA=a.child(i),childB=b.child(i);if(childA!=childB){if(!childA.sameMarkup(childB))return pos;if(childA.isText&&childA.text!=childB.text){for(let j=0;childA.text[j]==childB.text[j];j++)pos++;return pos}if(childA.content.size||childB.content.size){let inner=findDiffStart(childA.content,childB.content,pos+1);if(null!=inner)return inner}pos+=childA.nodeSize}else pos+=childA.nodeSize}}function findDiffEnd(a,b,posA,posB){for(let iA=a.childCount,iB=b.childCount;;){if(0==iA||0==iB)return iA==iB?null:{a:posA,b:posB};let childA=a.child(--iA),childB=b.child(--iB),size=childA.nodeSize;if(childA!=childB){if(!childA.sameMarkup(childB))return{a:posA,b:posB};if(childA.isText&&childA.text!=childB.text){let same=0,minSize=Math.min(childA.text.length,childB.text.length);for(;same<minSize&&childA.text[childA.text.length-same-1]==childB.text[childB.text.length-same-1];)same++,posA--,posB--;return{a:posA,b:posB}}if(childA.content.size||childB.content.size){let inner=findDiffEnd(childA.content,childB.content,posA-1,posB-1);if(inner)return inner}posA-=size,posB-=size}else posA-=size,posB-=size}}class Fragment{constructor(content,size){if(this.content=content,this.size=size||0,null==size)for(let i=0;i<content.length;i++)this.size+=content[i].nodeSize}nodesBetween(from,to,f,nodeStart=0,parent){for(let i=0,pos=0;pos<to;i++){let child=this.content[i],end=pos+child.nodeSize;if(end>from&&!1!==f(child,nodeStart+pos,parent||null,i)&&child.content.size){let start=pos+1;child.nodesBetween(Math.max(0,from-start),Math.min(child.content.size,to-start),f,nodeStart+start)}pos=end}}descendants(f){this.nodesBetween(0,this.size,f)}textBetween(from,to,blockSeparator,leafText){let text="",first=!0;return this.nodesBetween(from,to,(node,pos)=>{let nodeText=node.isText?node.text.slice(Math.max(from,pos)-pos,to-pos):node.isLeaf?leafText?"function"==typeof leafText?leafText(node):leafText:node.type.spec.leafText?node.type.spec.leafText(node):"":"";node.isBlock&&(node.isLeaf&&nodeText||node.isTextblock)&&blockSeparator&&(first?first=!1:text+=blockSeparator),text+=nodeText},0),text}append(other){if(!other.size)return this;if(!this.size)return other;let last=this.lastChild,first=other.firstChild,content=this.content.slice(),i=0;for(last.isText&&last.sameMarkup(first)&&(content[content.length-1]=last.withText(last.text+first.text),i=1);i<other.content.length;i++)content.push(other.content[i]);return new Fragment(content,this.size+other.size)}cut(from,to=this.size){if(0==from&&to==this.size)return this;let result=[],size=0;if(to>from)for(let i=0,pos=0;pos<to;i++){let child=this.content[i],end=pos+child.nodeSize;end>from&&((pos<from||end>to)&&(child=child.isText?child.cut(Math.max(0,from-pos),Math.min(child.text.length,to-pos)):child.cut(Math.max(0,from-pos-1),Math.min(child.content.size,to-pos-1))),result.push(child),size+=child.nodeSize),pos=end}return new Fragment(result,size)}cutByIndex(from,to){return from==to?Fragment.empty:0==from&&to==this.content.length?this:new Fragment(this.content.slice(from,to))}replaceChild(index,node){let current=this.content[index];if(current==node)return this;let copy=this.content.slice(),size=this.size+node.nodeSize-current.nodeSize;return copy[index]=node,new Fragment(copy,size)}addToStart(node){return new Fragment([node].concat(this.content),this.size+node.nodeSize)}addToEnd(node){return new Fragment(this.content.concat(node),this.size+node.nodeSize)}eq(other){if(this.content.length!=other.content.length)return!1;for(let i=0;i<this.content.length;i++)if(!this.content[i].eq(other.content[i]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(index){let found=this.content[index];if(!found)throw new RangeError("Index "+index+" out of range for "+this);return found}maybeChild(index){return this.content[index]||null}forEach(f){for(let i=0,p=0;i<this.content.length;i++){let child=this.content[i];f(child,p,i),p+=child.nodeSize}}findDiffStart(other,pos=0){return findDiffStart(this,other,pos)}findDiffEnd(other,pos=this.size,otherPos=other.size){return findDiffEnd(this,other,pos,otherPos)}findIndex(pos){if(0==pos)return retIndex(0,pos);if(pos==this.size)return retIndex(this.content.length,pos);if(pos>this.size||pos<0)throw new RangeError(`Position ${pos} outside of fragment (${this})`);for(let i=0,curPos=0;;i++){let end=curPos+this.child(i).nodeSize;if(end>=pos)return end==pos?retIndex(i+1,end):retIndex(i,curPos);curPos=end}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(n=>n.toJSON()):null}static fromJSON(schema,value){if(!value)return Fragment.empty;if(!Array.isArray(value))throw new RangeError("Invalid input for Fragment.fromJSON");return new Fragment(value.map(schema.nodeFromJSON))}static fromArray(array){if(!array.length)return Fragment.empty;let joined,size=0;for(let i=0;i<array.length;i++){let node=array[i];size+=node.nodeSize,i&&node.isText&&array[i-1].sameMarkup(node)?(joined||(joined=array.slice(0,i)),joined[joined.length-1]=node.withText(joined[joined.length-1].text+node.text)):joined&&joined.push(node)}return new Fragment(joined||array,size)}static from(nodes){if(!nodes)return Fragment.empty;if(nodes instanceof Fragment)return nodes;if(Array.isArray(nodes))return this.fromArray(nodes);if(nodes.attrs)return new Fragment([nodes],nodes.nodeSize);throw new RangeError("Can not convert "+nodes+" to a Fragment"+(nodes.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Fragment.empty=new Fragment([],0);const found={index:0,offset:0};function retIndex(index,offset){return found.index=index,found.offset=offset,found}function compareDeep(a,b){if(a===b)return!0;if(!a||"object"!=typeof a||!b||"object"!=typeof b)return!1;let array=Array.isArray(a);if(Array.isArray(b)!=array)return!1;if(array){if(a.length!=b.length)return!1;for(let i=0;i<a.length;i++)if(!compareDeep(a[i],b[i]))return!1}else{for(let p in a)if(!(p in b)||!compareDeep(a[p],b[p]))return!1;for(let p in b)if(!(p in a))return!1}return!0}class Mark{constructor(type,attrs){this.type=type,this.attrs=attrs}addToSet(set){let copy,placed=!1;for(let i=0;i<set.length;i++){let other=set[i];if(this.eq(other))return set;if(this.type.excludes(other.type))copy||(copy=set.slice(0,i));else{if(other.type.excludes(this.type))return set;!placed&&other.type.rank>this.type.rank&&(copy||(copy=set.slice(0,i)),copy.push(this),placed=!0),copy&&copy.push(other)}}return copy||(copy=set.slice()),placed||copy.push(this),copy}removeFromSet(set){for(let i=0;i<set.length;i++)if(this.eq(set[i]))return set.slice(0,i).concat(set.slice(i+1));return set}isInSet(set){for(let i=0;i<set.length;i++)if(this.eq(set[i]))return!0;return!1}eq(other){return this==other||this.type==other.type&&compareDeep(this.attrs,other.attrs)}toJSON(){let obj={type:this.type.name};for(let _ in this.attrs){obj.attrs=this.attrs;break}return obj}static fromJSON(schema,json){if(!json)throw new RangeError("Invalid input for Mark.fromJSON");let type=schema.marks[json.type];if(!type)throw new RangeError(`There is no mark type ${json.type} in this schema`);let mark=type.create(json.attrs);return type.checkAttrs(mark.attrs),mark}static sameSet(a,b){if(a==b)return!0;if(a.length!=b.length)return!1;for(let i=0;i<a.length;i++)if(!a[i].eq(b[i]))return!1;return!0}static setFrom(marks){if(!marks||Array.isArray(marks)&&0==marks.length)return Mark.none;if(marks instanceof Mark)return[marks];let copy=marks.slice();return copy.sort((a,b)=>a.type.rank-b.type.rank),copy}}Mark.none=[];class ReplaceError extends Error{}class Slice{constructor(content,openStart,openEnd){this.content=content,this.openStart=openStart,this.openEnd=openEnd}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(pos,fragment){let content=insertInto(this.content,pos+this.openStart,fragment);return content&&new Slice(content,this.openStart,this.openEnd)}removeBetween(from,to){return new Slice(removeRange(this.content,from+this.openStart,to+this.openStart),this.openStart,this.openEnd)}eq(other){return this.content.eq(other.content)&&this.openStart==other.openStart&&this.openEnd==other.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let json={content:this.content.toJSON()};return this.openStart>0&&(json.openStart=this.openStart),this.openEnd>0&&(json.openEnd=this.openEnd),json}static fromJSON(schema,json){if(!json)return Slice.empty;let openStart=json.openStart||0,openEnd=json.openEnd||0;if("number"!=typeof openStart||"number"!=typeof openEnd)throw new RangeError("Invalid input for Slice.fromJSON");return new Slice(Fragment.fromJSON(schema,json.content),openStart,openEnd)}static maxOpen(fragment,openIsolating=!0){let openStart=0,openEnd=0;for(let n=fragment.firstChild;n&&!n.isLeaf&&(openIsolating||!n.type.spec.isolating);n=n.firstChild)openStart++;for(let n=fragment.lastChild;n&&!n.isLeaf&&(openIsolating||!n.type.spec.isolating);n=n.lastChild)openEnd++;return new Slice(fragment,openStart,openEnd)}}function removeRange(content,from,to){let{index,offset}=content.findIndex(from),child=content.maybeChild(index),{index:indexTo,offset:offsetTo}=content.findIndex(to);if(offset==from||child.isText){if(offsetTo!=to&&!content.child(indexTo).isText)throw new RangeError("Removing non-flat range");return content.cut(0,from).append(content.cut(to))}if(index!=indexTo)throw new RangeError("Removing non-flat range");return content.replaceChild(index,child.copy(removeRange(child.content,from-offset-1,to-offset-1)))}function insertInto(content,dist,insert,parent){let{index,offset}=content.findIndex(dist),child=content.maybeChild(index);if(offset==dist||child.isText)return parent&&!parent.canReplace(index,index,insert)?null:content.cut(0,dist).append(insert).append(content.cut(dist));let inner=insertInto(child.content,dist-offset-1,insert,child);return inner&&content.replaceChild(index,child.copy(inner))}function replace($from,$to,slice){if(slice.openStart>$from.depth)throw new ReplaceError("Inserted content deeper than insertion position");if($from.depth-slice.openStart!=$to.depth-slice.openEnd)throw new ReplaceError("Inconsistent open depths");return replaceOuter($from,$to,slice,0)}function replaceOuter($from,$to,slice,depth){let index=$from.index(depth),node=$from.node(depth);if(index==$to.index(depth)&&depth<$from.depth-slice.openStart){let inner=replaceOuter($from,$to,slice,depth+1);return node.copy(node.content.replaceChild(index,inner))}if(slice.content.size){if(slice.openStart||slice.openEnd||$from.depth!=depth||$to.depth!=depth){let{start,end}=function prepareSliceForReplace(slice,$along){let extra=$along.depth-slice.openStart,node=$along.node(extra).copy(slice.content);for(let i=extra-1;i>=0;i--)node=$along.node(i).copy(Fragment.from(node));return{start:node.resolveNoCache(slice.openStart+extra),end:node.resolveNoCache(node.content.size-slice.openEnd-extra)}}(slice,$from);return dist_close(node,replaceThreeWay($from,start,end,$to,depth))}{let parent=$from.parent,content=parent.content;return dist_close(parent,content.cut(0,$from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))}}return dist_close(node,replaceTwoWay($from,$to,depth))}function checkJoin(main,sub){if(!sub.type.compatibleContent(main.type))throw new ReplaceError("Cannot join "+sub.type.name+" onto "+main.type.name)}function joinable($before,$after,depth){let node=$before.node(depth);return checkJoin(node,$after.node(depth)),node}function addNode(child,target){let last=target.length-1;last>=0&&child.isText&&child.sameMarkup(target[last])?target[last]=child.withText(target[last].text+child.text):target.push(child)}function addRange($start,$end,depth,target){let node=($end||$start).node(depth),startIndex=0,endIndex=$end?$end.index(depth):node.childCount;$start&&(startIndex=$start.index(depth),$start.depth>depth?startIndex++:$start.textOffset&&(addNode($start.nodeAfter,target),startIndex++));for(let i=startIndex;i<endIndex;i++)addNode(node.child(i),target);$end&&$end.depth==depth&&$end.textOffset&&addNode($end.nodeBefore,target)}function dist_close(node,content){return node.type.checkContent(content),node.copy(content)}function replaceThreeWay($from,$start,$end,$to,depth){let openStart=$from.depth>depth&&joinable($from,$start,depth+1),openEnd=$to.depth>depth&&joinable($end,$to,depth+1),content=[];return addRange(null,$from,depth,content),openStart&&openEnd&&$start.index(depth)==$end.index(depth)?(checkJoin(openStart,openEnd),addNode(dist_close(openStart,replaceThreeWay($from,$start,$end,$to,depth+1)),content)):(openStart&&addNode(dist_close(openStart,replaceTwoWay($from,$start,depth+1)),content),addRange($start,$end,depth,content),openEnd&&addNode(dist_close(openEnd,replaceTwoWay($end,$to,depth+1)),content)),addRange($to,null,depth,content),new Fragment(content)}function replaceTwoWay($from,$to,depth){let content=[];if(addRange(null,$from,depth,content),$from.depth>depth){addNode(dist_close(joinable($from,$to,depth+1),replaceTwoWay($from,$to,depth+1)),content)}return addRange($to,null,depth,content),new Fragment(content)}Slice.empty=new Slice(Fragment.empty,0,0);class ResolvedPos{constructor(pos,path,parentOffset){this.pos=pos,this.path=path,this.parentOffset=parentOffset,this.depth=path.length/3-1}resolveDepth(val){return null==val?this.depth:val<0?this.depth+val:val}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(depth){return this.path[3*this.resolveDepth(depth)]}index(depth){return this.path[3*this.resolveDepth(depth)+1]}indexAfter(depth){return depth=this.resolveDepth(depth),this.index(depth)+(depth!=this.depth||this.textOffset?1:0)}start(depth){return 0==(depth=this.resolveDepth(depth))?0:this.path[3*depth-1]+1}end(depth){return depth=this.resolveDepth(depth),this.start(depth)+this.node(depth).content.size}before(depth){if(!(depth=this.resolveDepth(depth)))throw new RangeError("There is no position before the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]}after(depth){if(!(depth=this.resolveDepth(depth)))throw new RangeError("There is no position after the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]+this.path[3*depth].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let parent=this.parent,index=this.index(this.depth);if(index==parent.childCount)return null;let dOff=this.pos-this.path[this.path.length-1],child=parent.child(index);return dOff?parent.child(index).cut(dOff):child}get nodeBefore(){let index=this.index(this.depth),dOff=this.pos-this.path[this.path.length-1];return dOff?this.parent.child(index).cut(0,dOff):0==index?null:this.parent.child(index-1)}posAtIndex(index,depth){depth=this.resolveDepth(depth);let node=this.path[3*depth],pos=0==depth?0:this.path[3*depth-1]+1;for(let i=0;i<index;i++)pos+=node.child(i).nodeSize;return pos}marks(){let parent=this.parent,index=this.index();if(0==parent.content.size)return Mark.none;if(this.textOffset)return parent.child(index).marks;let main=parent.maybeChild(index-1),other=parent.maybeChild(index);if(!main){let tmp=main;main=other,other=tmp}let marks=main.marks;for(var i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||other&&marks[i].isInSet(other.marks)||(marks=marks[i--].removeFromSet(marks));return marks}marksAcross($end){let after=this.parent.maybeChild(this.index());if(!after||!after.isInline)return null;let marks=after.marks,next=$end.parent.maybeChild($end.index());for(var i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||next&&marks[i].isInSet(next.marks)||(marks=marks[i--].removeFromSet(marks));return marks}sharedDepth(pos){for(let depth=this.depth;depth>0;depth--)if(this.start(depth)<=pos&&this.end(depth)>=pos)return depth;return 0}blockRange(other=this,pred){if(other.pos<this.pos)return other.blockRange(this);for(let d=this.depth-(this.parent.inlineContent||this.pos==other.pos?1:0);d>=0;d--)if(other.pos<=this.end(d)&&(!pred||pred(this.node(d))))return new NodeRange(this,other,d);return null}sameParent(other){return this.pos-this.parentOffset==other.pos-other.parentOffset}max(other){return other.pos>this.pos?other:this}min(other){return other.pos<this.pos?other:this}toString(){let str="";for(let i=1;i<=this.depth;i++)str+=(str?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return str+":"+this.parentOffset}static resolve(doc,pos){if(!(pos>=0&&pos<=doc.content.size))throw new RangeError("Position "+pos+" out of range");let path=[],start=0,parentOffset=pos;for(let node=doc;;){let{index,offset}=node.content.findIndex(parentOffset),rem=parentOffset-offset;if(path.push(node,index,start+offset),!rem)break;if(node=node.child(index),node.isText)break;parentOffset=rem-1,start+=offset+1}return new ResolvedPos(pos,path,parentOffset)}static resolveCached(doc,pos){let cache=resolveCache.get(doc);if(cache)for(let i=0;i<cache.elts.length;i++){let elt=cache.elts[i];if(elt.pos==pos)return elt}else resolveCache.set(doc,cache=new ResolveCache);let result=cache.elts[cache.i]=ResolvedPos.resolve(doc,pos);return cache.i=(cache.i+1)%resolveCacheSize,result}}class ResolveCache{constructor(){this.elts=[],this.i=0}}const resolveCacheSize=12,resolveCache=new WeakMap;class NodeRange{constructor($from,$to,depth){this.$from=$from,this.$to=$to,this.depth=depth}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const emptyAttrs=Object.create(null);class Node{constructor(type,attrs,content,marks=Mark.none){this.type=type,this.attrs=attrs,this.marks=marks,this.content=content||Fragment.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(index){return this.content.child(index)}maybeChild(index){return this.content.maybeChild(index)}forEach(f){this.content.forEach(f)}nodesBetween(from,to,f,startPos=0){this.content.nodesBetween(from,to,f,startPos,this)}descendants(f){this.nodesBetween(0,this.content.size,f)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(from,to,blockSeparator,leafText){return this.content.textBetween(from,to,blockSeparator,leafText)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(other){return this==other||this.sameMarkup(other)&&this.content.eq(other.content)}sameMarkup(other){return this.hasMarkup(other.type,other.attrs,other.marks)}hasMarkup(type,attrs,marks){return this.type==type&&compareDeep(this.attrs,attrs||type.defaultAttrs||emptyAttrs)&&Mark.sameSet(this.marks,marks||Mark.none)}copy(content=null){return content==this.content?this:new Node(this.type,this.attrs,content,this.marks)}mark(marks){return marks==this.marks?this:new Node(this.type,this.attrs,this.content,marks)}cut(from,to=this.content.size){return 0==from&&to==this.content.size?this:this.copy(this.content.cut(from,to))}slice(from,to=this.content.size,includeParents=!1){if(from==to)return Slice.empty;let $from=this.resolve(from),$to=this.resolve(to),depth=includeParents?0:$from.sharedDepth(to),start=$from.start(depth),content=$from.node(depth).content.cut($from.pos-start,$to.pos-start);return new Slice(content,$from.depth-depth,$to.depth-depth)}replace(from,to,slice){return replace(this.resolve(from),this.resolve(to),slice)}nodeAt(pos){for(let node=this;;){let{index,offset}=node.content.findIndex(pos);if(node=node.maybeChild(index),!node)return null;if(offset==pos||node.isText)return node;pos-=offset+1}}childAfter(pos){let{index,offset}=this.content.findIndex(pos);return{node:this.content.maybeChild(index),index,offset}}childBefore(pos){if(0==pos)return{node:null,index:0,offset:0};let{index,offset}=this.content.findIndex(pos);if(offset<pos)return{node:this.content.child(index),index,offset};let node=this.content.child(index-1);return{node,index:index-1,offset:offset-node.nodeSize}}resolve(pos){return ResolvedPos.resolveCached(this,pos)}resolveNoCache(pos){return ResolvedPos.resolve(this,pos)}rangeHasMark(from,to,type){let found=!1;return to>from&&this.nodesBetween(from,to,node=>(type.isInSet(node.marks)&&(found=!0),!found)),found}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let name=this.type.name;return this.content.size&&(name+="("+this.content.toStringInner()+")"),wrapMarks(this.marks,name)}contentMatchAt(index){let match=this.type.contentMatch.matchFragment(this.content,0,index);if(!match)throw new Error("Called contentMatchAt on a node with invalid content");return match}canReplace(from,to,replacement=Fragment.empty,start=0,end=replacement.childCount){let one=this.contentMatchAt(from).matchFragment(replacement,start,end),two=one&&one.matchFragment(this.content,to);if(!two||!two.validEnd)return!1;for(let i=start;i<end;i++)if(!this.type.allowsMarks(replacement.child(i).marks))return!1;return!0}canReplaceWith(from,to,type,marks){if(marks&&!this.type.allowsMarks(marks))return!1;let start=this.contentMatchAt(from).matchType(type),end=start&&start.matchFragment(this.content,to);return!!end&&end.validEnd}canAppend(other){return other.content.size?this.canReplace(this.childCount,this.childCount,other.content):this.type.compatibleContent(other.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let copy=Mark.none;for(let i=0;i<this.marks.length;i++){let mark=this.marks[i];mark.type.checkAttrs(mark.attrs),copy=mark.addToSet(copy)}if(!Mark.sameSet(copy,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(m=>m.type.name)}`);this.content.forEach(node=>node.check())}toJSON(){let obj={type:this.type.name};for(let _ in this.attrs){obj.attrs=this.attrs;break}return this.content.size&&(obj.content=this.content.toJSON()),this.marks.length&&(obj.marks=this.marks.map(n=>n.toJSON())),obj}static fromJSON(schema,json){if(!json)throw new RangeError("Invalid input for Node.fromJSON");let marks;if(json.marks){if(!Array.isArray(json.marks))throw new RangeError("Invalid mark data for Node.fromJSON");marks=json.marks.map(schema.markFromJSON)}if("text"==json.type){if("string"!=typeof json.text)throw new RangeError("Invalid text node in JSON");return schema.text(json.text,marks)}let content=Fragment.fromJSON(schema,json.content),node=schema.nodeType(json.type).create(json.attrs,content,marks);return node.type.checkAttrs(node.attrs),node}}Node.prototype.text=void 0;class TextNode extends Node{constructor(type,attrs,content,marks){if(super(type,attrs,null,marks),!content)throw new RangeError("Empty text nodes are not allowed");this.text=content}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wrapMarks(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(from,to){return this.text.slice(from,to)}get nodeSize(){return this.text.length}mark(marks){return marks==this.marks?this:new TextNode(this.type,this.attrs,this.text,marks)}withText(text){return text==this.text?this:new TextNode(this.type,this.attrs,text,this.marks)}cut(from=0,to=this.text.length){return 0==from&&to==this.text.length?this:this.withText(this.text.slice(from,to))}eq(other){return this.sameMarkup(other)&&this.text==other.text}toJSON(){let base=super.toJSON();return base.text=this.text,base}}function wrapMarks(marks,str){for(let i=marks.length-1;i>=0;i--)str=marks[i].type.name+"("+str+")";return str}class ContentMatch{constructor(validEnd){this.validEnd=validEnd,this.next=[],this.wrapCache=[]}static parse(string,nodeTypes){let stream=new TokenStream(string,nodeTypes);if(null==stream.next)return ContentMatch.empty;let expr=parseExpr(stream);stream.next&&stream.err("Unexpected trailing text");let match=function dfa(nfa){let labeled=Object.create(null);return explore(nullFrom(nfa,0));function explore(states){let out=[];states.forEach(node=>{nfa[node].forEach(({term,to})=>{if(!term)return;let set;for(let i=0;i<out.length;i++)out[i][0]==term&&(set=out[i][1]);nullFrom(nfa,to).forEach(node=>{set||out.push([term,set=[]]),-1==set.indexOf(node)&&set.push(node)})})});let state=labeled[states.join(",")]=new ContentMatch(states.indexOf(nfa.length-1)>-1);for(let i=0;i<out.length;i++){let states=out[i][1].sort(cmp);state.next.push({type:out[i][0],next:labeled[states.join(",")]||explore(states)})}return state}}(function nfa(expr){let nfa=[[]];return connect(compile(expr,0),node()),nfa;function node(){return nfa.push([])-1}function edge(from,to,term){let edge={term,to};return nfa[from].push(edge),edge}function connect(edges,to){edges.forEach(edge=>edge.to=to)}function compile(expr,from){if("choice"==expr.type)return expr.exprs.reduce((out,expr)=>out.concat(compile(expr,from)),[]);if("seq"!=expr.type){if("star"==expr.type){let loop=node();return edge(from,loop),connect(compile(expr.expr,loop),loop),[edge(loop)]}if("plus"==expr.type){let loop=node();return connect(compile(expr.expr,from),loop),connect(compile(expr.expr,loop),loop),[edge(loop)]}if("opt"==expr.type)return[edge(from)].concat(compile(expr.expr,from));if("range"==expr.type){let cur=from;for(let i=0;i<expr.min;i++){let next=node();connect(compile(expr.expr,cur),next),cur=next}if(-1==expr.max)connect(compile(expr.expr,cur),cur);else for(let i=expr.min;i<expr.max;i++){let next=node();edge(cur,next),connect(compile(expr.expr,cur),next),cur=next}return[edge(cur)]}if("name"==expr.type)return[edge(from,void 0,expr.value)];throw new Error("Unknown expr type")}for(let i=0;;i++){let next=compile(expr.exprs[i],from);if(i==expr.exprs.length-1)return next;connect(next,from=node())}}}(expr));return function checkForDeadEnds(match,stream){for(let i=0,work=[match];i<work.length;i++){let state=work[i],dead=!state.validEnd,nodes=[];for(let j=0;j<state.next.length;j++){let{type,next}=state.next[j];nodes.push(type.name),!dead||type.isText||type.hasRequiredAttrs()||(dead=!1),-1==work.indexOf(next)&&work.push(next)}dead&&stream.err("Only non-generatable nodes ("+nodes.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(match,stream),match}matchType(type){for(let i=0;i<this.next.length;i++)if(this.next[i].type==type)return this.next[i].next;return null}matchFragment(frag,start=0,end=frag.childCount){let cur=this;for(let i=start;cur&&i<end;i++)cur=cur.matchType(frag.child(i).type);return cur}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let i=0;i<this.next.length;i++){let{type}=this.next[i];if(!type.isText&&!type.hasRequiredAttrs())return type}return null}compatible(other){for(let i=0;i<this.next.length;i++)for(let j=0;j<other.next.length;j++)if(this.next[i].type==other.next[j].type)return!0;return!1}fillBefore(after,toEnd=!1,startIndex=0){let seen=[this];return function search(match,types){let finished=match.matchFragment(after,startIndex);if(finished&&(!toEnd||finished.validEnd))return Fragment.from(types.map(tp=>tp.createAndFill()));for(let i=0;i<match.next.length;i++){let{type,next}=match.next[i];if(!type.isText&&!type.hasRequiredAttrs()&&-1==seen.indexOf(next)){seen.push(next);let found=search(next,types.concat(type));if(found)return found}}return null}(this,[])}findWrapping(target){for(let i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==target)return this.wrapCache[i+1];let computed=this.computeWrapping(target);return this.wrapCache.push(target,computed),computed}computeWrapping(target){let seen=Object.create(null),active=[{match:this,type:null,via:null}];for(;active.length;){let current=active.shift(),match=current.match;if(match.matchType(target)){let result=[];for(let obj=current;obj.type;obj=obj.via)result.push(obj.type);return result.reverse()}for(let i=0;i<match.next.length;i++){let{type,next}=match.next[i];type.isLeaf||type.hasRequiredAttrs()||type.name in seen||current.type&&!next.validEnd||(active.push({match:type.contentMatch,type,via:current}),seen[type.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(n){if(n>=this.next.length)throw new RangeError(`There's no ${n}th edge in this content match`);return this.next[n]}toString(){let seen=[];return function scan(m){seen.push(m);for(let i=0;i<m.next.length;i++)-1==seen.indexOf(m.next[i].next)&&scan(m.next[i].next)}(this),seen.map((m,i)=>{let out=i+(m.validEnd?"*":" ")+" ";for(let i=0;i<m.next.length;i++)out+=(i?", ":"")+m.next[i].type.name+"->"+seen.indexOf(m.next[i].next);return out}).join("\n")}}ContentMatch.empty=new ContentMatch(!0);class TokenStream{constructor(string,nodeTypes){this.string=string,this.nodeTypes=nodeTypes,this.inline=null,this.pos=0,this.tokens=string.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(tok){return this.next==tok&&(this.pos++||!0)}err(str){throw new SyntaxError(str+" (in content expression '"+this.string+"')")}}function parseExpr(stream){let exprs=[];do{exprs.push(parseExprSeq(stream))}while(stream.eat("|"));return 1==exprs.length?exprs[0]:{type:"choice",exprs}}function parseExprSeq(stream){let exprs=[];do{exprs.push(parseExprSubscript(stream))}while(stream.next&&")"!=stream.next&&"|"!=stream.next);return 1==exprs.length?exprs[0]:{type:"seq",exprs}}function parseExprSubscript(stream){let expr=function parseExprAtom(stream){if(stream.eat("(")){let expr=parseExpr(stream);return stream.eat(")")||stream.err("Missing closing paren"),expr}if(!/\W/.test(stream.next)){let exprs=function resolveName(stream,name){let types=stream.nodeTypes,type=types[name];if(type)return[type];let result=[];for(let typeName in types){let type=types[typeName];type.isInGroup(name)&&result.push(type)}0==result.length&&stream.err("No node type or group '"+name+"' found");return result}(stream,stream.next).map(type=>(null==stream.inline?stream.inline=type.isInline:stream.inline!=type.isInline&&stream.err("Mixing inline and block content"),{type:"name",value:type}));return stream.pos++,1==exprs.length?exprs[0]:{type:"choice",exprs}}stream.err("Unexpected token '"+stream.next+"'")}(stream);for(;;)if(stream.eat("+"))expr={type:"plus",expr};else if(stream.eat("*"))expr={type:"star",expr};else if(stream.eat("?"))expr={type:"opt",expr};else{if(!stream.eat("{"))break;expr=parseExprRange(stream,expr)}return expr}function parseNum(stream){/\D/.test(stream.next)&&stream.err("Expected number, got '"+stream.next+"'");let result=Number(stream.next);return stream.pos++,result}function parseExprRange(stream,expr){let min=parseNum(stream),max=min;return stream.eat(",")&&(max="}"!=stream.next?parseNum(stream):-1),stream.eat("}")||stream.err("Unclosed braced range"),{type:"range",min,max,expr}}function cmp(a,b){return b-a}function nullFrom(nfa,node){let result=[];return function scan(node){let edges=nfa[node];if(1==edges.length&&!edges[0].term)return scan(edges[0].to);result.push(node);for(let i=0;i<edges.length;i++){let{term,to}=edges[i];term||-1!=result.indexOf(to)||scan(to)}}(node),result.sort(cmp)}function defaultAttrs(attrs){let defaults=Object.create(null);for(let attrName in attrs){let attr=attrs[attrName];if(!attr.hasDefault)return null;defaults[attrName]=attr.default}return defaults}function computeAttrs(attrs,value){let built=Object.create(null);for(let name in attrs){let given=value&&value[name];if(void 0===given){let attr=attrs[name];if(!attr.hasDefault)throw new RangeError("No value supplied for attribute "+name);given=attr.default}built[name]=given}return built}function checkAttrs(attrs,values,type,name){for(let name in values)if(!(name in attrs))throw new RangeError(`Unsupported attribute ${name} for ${type} of type ${name}`);for(let name in attrs){let attr=attrs[name];attr.validate&&attr.validate(values[name])}}function initAttrs(typeName,attrs){let result=Object.create(null);if(attrs)for(let name in attrs)result[name]=new Attribute(typeName,name,attrs[name]);return result}class NodeType{constructor(name,schema,spec){this.name=name,this.schema=schema,this.spec=spec,this.markSet=null,this.groups=spec.group?spec.group.split(" "):[],this.attrs=initAttrs(name,spec.attrs),this.defaultAttrs=defaultAttrs(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(spec.inline||"text"==name),this.isText="text"==name}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ContentMatch.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(group){return this.groups.indexOf(group)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let n in this.attrs)if(this.attrs[n].isRequired)return!0;return!1}compatibleContent(other){return this==other||this.contentMatch.compatible(other.contentMatch)}computeAttrs(attrs){return!attrs&&this.defaultAttrs?this.defaultAttrs:computeAttrs(this.attrs,attrs)}create(attrs=null,content,marks){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Node(this,this.computeAttrs(attrs),Fragment.from(content),Mark.setFrom(marks))}createChecked(attrs=null,content,marks){return content=Fragment.from(content),this.checkContent(content),new Node(this,this.computeAttrs(attrs),content,Mark.setFrom(marks))}createAndFill(attrs=null,content,marks){if(attrs=this.computeAttrs(attrs),(content=Fragment.from(content)).size){let before=this.contentMatch.fillBefore(content);if(!before)return null;content=before.append(content)}let matched=this.contentMatch.matchFragment(content),after=matched&&matched.fillBefore(Fragment.empty,!0);return after?new Node(this,attrs,content.append(after),Mark.setFrom(marks)):null}validContent(content){let result=this.contentMatch.matchFragment(content);if(!result||!result.validEnd)return!1;for(let i=0;i<content.childCount;i++)if(!this.allowsMarks(content.child(i).marks))return!1;return!0}checkContent(content){if(!this.validContent(content))throw new RangeError(`Invalid content for node ${this.name}: ${content.toString().slice(0,50)}`)}checkAttrs(attrs){checkAttrs(this.attrs,attrs,"node",this.name)}allowsMarkType(markType){return null==this.markSet||this.markSet.indexOf(markType)>-1}allowsMarks(marks){if(null==this.markSet)return!0;for(let i=0;i<marks.length;i++)if(!this.allowsMarkType(marks[i].type))return!1;return!0}allowedMarks(marks){if(null==this.markSet)return marks;let copy;for(let i=0;i<marks.length;i++)this.allowsMarkType(marks[i].type)?copy&&copy.push(marks[i]):copy||(copy=marks.slice(0,i));return copy?copy.length?copy:Mark.none:marks}static compile(nodes,schema){let result=Object.create(null);nodes.forEach((name,spec)=>result[name]=new NodeType(name,schema,spec));let topType=schema.spec.topNode||"doc";if(!result[topType])throw new RangeError("Schema is missing its top node type ('"+topType+"')");if(!result.text)throw new RangeError("Every schema needs a 'text' type");for(let _ in result.text.attrs)throw new RangeError("The text node type should not have attributes");return result}}class Attribute{constructor(typeName,attrName,options){this.hasDefault=Object.prototype.hasOwnProperty.call(options,"default"),this.default=options.default,this.validate="string"==typeof options.validate?function validateType(typeName,attrName,type){let types=type.split("|");return value=>{let name=null===value?"null":typeof value;if(types.indexOf(name)<0)throw new RangeError(`Expected value of type ${types} for attribute ${attrName} on type ${typeName}, got ${name}`)}}(typeName,attrName,options.validate):options.validate}get isRequired(){return!this.hasDefault}}class MarkType{constructor(name,rank,schema,spec){this.name=name,this.rank=rank,this.schema=schema,this.spec=spec,this.attrs=initAttrs(name,spec.attrs),this.excluded=null;let defaults=defaultAttrs(this.attrs);this.instance=defaults?new Mark(this,defaults):null}create(attrs=null){return!attrs&&this.instance?this.instance:new Mark(this,computeAttrs(this.attrs,attrs))}static compile(marks,schema){let result=Object.create(null),rank=0;return marks.forEach((name,spec)=>result[name]=new MarkType(name,rank++,schema,spec)),result}removeFromSet(set){for(var i=0;i<set.length;i++)set[i].type==this&&(set=set.slice(0,i).concat(set.slice(i+1)),i--);return set}isInSet(set){for(let i=0;i<set.length;i++)if(set[i].type==this)return set[i]}checkAttrs(attrs){checkAttrs(this.attrs,attrs,"mark",this.name)}excludes(other){return this.excluded.indexOf(other)>-1}}class Schema{constructor(spec){this.linebreakReplacement=null,this.cached=Object.create(null);let instanceSpec=this.spec={};for(let prop in spec)instanceSpec[prop]=spec[prop];instanceSpec.nodes=dist.from(spec.nodes),instanceSpec.marks=dist.from(spec.marks||{}),this.nodes=NodeType.compile(this.spec.nodes,this),this.marks=MarkType.compile(this.spec.marks,this);let contentExprCache=Object.create(null);for(let prop in this.nodes){if(prop in this.marks)throw new RangeError(prop+" can not be both a node and a mark");let type=this.nodes[prop],contentExpr=type.spec.content||"",markExpr=type.spec.marks;if(type.contentMatch=contentExprCache[contentExpr]||(contentExprCache[contentExpr]=ContentMatch.parse(contentExpr,this.nodes)),type.inlineContent=type.contentMatch.inlineContent,type.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!type.isInline||!type.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=type}type.markSet="_"==markExpr?null:markExpr?gatherMarks(this,markExpr.split(" ")):""!=markExpr&&type.inlineContent?null:[]}for(let prop in this.marks){let type=this.marks[prop],excl=type.spec.excludes;type.excluded=null==excl?[type]:""==excl?[]:gatherMarks(this,excl.split(" "))}this.nodeFromJSON=json=>Node.fromJSON(this,json),this.markFromJSON=json=>Mark.fromJSON(this,json),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(type,attrs=null,content,marks){if("string"==typeof type)type=this.nodeType(type);else{if(!(type instanceof NodeType))throw new RangeError("Invalid node type: "+type);if(type.schema!=this)throw new RangeError("Node type from different schema used ("+type.name+")")}return type.createChecked(attrs,content,marks)}text(text,marks){let type=this.nodes.text;return new TextNode(type,type.defaultAttrs,text,Mark.setFrom(marks))}mark(type,attrs){return"string"==typeof type&&(type=this.marks[type]),type.create(attrs)}nodeType(name){let found=this.nodes[name];if(!found)throw new RangeError("Unknown node type: "+name);return found}}function gatherMarks(schema,marks){let found=[];for(let i=0;i<marks.length;i++){let name=marks[i],mark=schema.marks[name],ok=mark;if(mark)found.push(mark);else for(let prop in schema.marks){let mark=schema.marks[prop];("_"==name||mark.spec.group&&mark.spec.group.split(" ").indexOf(name)>-1)&&found.push(ok=mark)}if(!ok)throw new SyntaxError("Unknown mark type: '"+marks[i]+"'")}return found}class DOMParser{constructor(schema,rules){this.schema=schema,this.rules=rules,this.tags=[],this.styles=[];let matchedStyles=this.matchedStyles=[];rules.forEach(rule=>{if(function isTagRule(rule){return null!=rule.tag}(rule))this.tags.push(rule);else if(function isStyleRule(rule){return null!=rule.style}(rule)){let prop=/[^=]*/.exec(rule.style)[0];matchedStyles.indexOf(prop)<0&&matchedStyles.push(prop),this.styles.push(rule)}}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let node=schema.nodes[r.node];return node.contentMatch.matchType(node)})}parse(dom,options={}){let context=new ParseContext(this,options,!1);return context.addAll(dom,Mark.none,options.from,options.to),context.finish()}parseSlice(dom,options={}){let context=new ParseContext(this,options,!0);return context.addAll(dom,Mark.none,options.from,options.to),Slice.maxOpen(context.finish())}matchTag(dom,context,after){for(let i=after?this.tags.indexOf(after)+1:0;i<this.tags.length;i++){let rule=this.tags[i];if(matches(dom,rule.tag)&&(void 0===rule.namespace||dom.namespaceURI==rule.namespace)&&(!rule.context||context.matchesContext(rule.context))){if(rule.getAttrs){let result=rule.getAttrs(dom);if(!1===result)continue;rule.attrs=result||void 0}return rule}}}matchStyle(prop,value,context,after){for(let i=after?this.styles.indexOf(after)+1:0;i<this.styles.length;i++){let rule=this.styles[i],style=rule.style;if(!(0!=style.indexOf(prop)||rule.context&&!context.matchesContext(rule.context)||style.length>prop.length&&(61!=style.charCodeAt(prop.length)||style.slice(prop.length+1)!=value))){if(rule.getAttrs){let result=rule.getAttrs(value);if(!1===result)continue;rule.attrs=result||void 0}return rule}}}static schemaRules(schema){let result=[];function insert(rule){let priority=null==rule.priority?50:rule.priority,i=0;for(;i<result.length;i++){let next=result[i];if((null==next.priority?50:next.priority)<priority)break}result.splice(i,0,rule)}for(let name in schema.marks){let rules=schema.marks[name].spec.parseDOM;rules&&rules.forEach(rule=>{insert(rule=copy(rule)),rule.mark||rule.ignore||rule.clearMark||(rule.mark=name)})}for(let name in schema.nodes){let rules=schema.nodes[name].spec.parseDOM;rules&&rules.forEach(rule=>{insert(rule=copy(rule)),rule.node||rule.ignore||rule.mark||(rule.node=name)})}return result}static fromSchema(schema){return schema.cached.domParser||(schema.cached.domParser=new DOMParser(schema,DOMParser.schemaRules(schema)))}}const blockTags={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ignoreTags={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},listTags={ol:!0,ul:!0};function wsOptionsFor(type,preserveWhitespace,base){return null!=preserveWhitespace?(preserveWhitespace?1:0)|("full"===preserveWhitespace?2:0):type&&"pre"==type.whitespace?3:-5&base}class NodeContext{constructor(type,attrs,marks,solid,match,options){this.type=type,this.attrs=attrs,this.marks=marks,this.solid=solid,this.options=options,this.content=[],this.activeMarks=Mark.none,this.match=match||(4&options?null:type.contentMatch)}findWrapping(node){if(!this.match){if(!this.type)return[];let fill=this.type.contentMatch.fillBefore(Fragment.from(node));if(!fill){let wrap,start=this.type.contentMatch;return(wrap=start.findWrapping(node.type))?(this.match=start,wrap):null}this.match=this.type.contentMatch.matchFragment(fill)}return this.match.findWrapping(node.type)}finish(openEnd){if(!(1&this.options)){let m,last=this.content[this.content.length-1];if(last&&last.isText&&(m=/[ \t\r\n\u000c]+$/.exec(last.text))){let text=last;last.text.length==m[0].length?this.content.pop():this.content[this.content.length-1]=text.withText(text.text.slice(0,text.text.length-m[0].length))}}let content=Fragment.from(this.content);return!openEnd&&this.match&&(content=content.append(this.match.fillBefore(Fragment.empty,!0))),this.type?this.type.create(this.attrs,content,this.marks):content}inlineContext(node){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:node.parentNode&&!blockTags.hasOwnProperty(node.parentNode.nodeName.toLowerCase())}}class ParseContext{constructor(parser,options,isOpen){this.parser=parser,this.options=options,this.isOpen=isOpen,this.open=0,this.localPreserveWS=!1;let topContext,topNode=options.topNode,topOptions=wsOptionsFor(null,options.preserveWhitespace,0)|(isOpen?4:0);topContext=topNode?new NodeContext(topNode.type,topNode.attrs,Mark.none,!0,options.topMatch||topNode.type.contentMatch,topOptions):new NodeContext(isOpen?null:parser.schema.topNodeType,null,Mark.none,!0,null,topOptions),this.nodes=[topContext],this.find=options.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(dom,marks){3==dom.nodeType?this.addTextNode(dom,marks):1==dom.nodeType&&this.addElement(dom,marks)}addTextNode(dom,marks){let value=dom.nodeValue,top=this.top,preserveWS=2&top.options?"full":this.localPreserveWS||(1&top.options)>0;if("full"===preserveWS||top.inlineContext(dom)||/[^ \t\r\n\u000c]/.test(value)){if(preserveWS)value="full"!==preserveWS?value.replace(/\r?\n|\r/g," "):value.replace(/\r\n?/g,"\n");else if(value=value.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(value)&&this.open==this.nodes.length-1){let nodeBefore=top.content[top.content.length-1],domNodeBefore=dom.previousSibling;(!nodeBefore||domNodeBefore&&"BR"==domNodeBefore.nodeName||nodeBefore.isText&&/[ \t\r\n\u000c]$/.test(nodeBefore.text))&&(value=value.slice(1))}value&&this.insertNode(this.parser.schema.text(value),marks,!/\S/.test(value)),this.findInText(dom)}else this.findInside(dom)}addElement(dom,marks,matchAfter){let outerWS=this.localPreserveWS,top=this.top;("PRE"==dom.tagName||/pre/.test(dom.style&&dom.style.whiteSpace))&&(this.localPreserveWS=!0);let ruleID,name=dom.nodeName.toLowerCase();listTags.hasOwnProperty(name)&&this.parser.normalizeLists&&function normalizeList(dom){for(let child=dom.firstChild,prevItem=null;child;child=child.nextSibling){let name=1==child.nodeType?child.nodeName.toLowerCase():null;name&&listTags.hasOwnProperty(name)&&prevItem?(prevItem.appendChild(child),child=prevItem):"li"==name?prevItem=child:name&&(prevItem=null)}}(dom);let rule=this.options.ruleFromNode&&this.options.ruleFromNode(dom)||(ruleID=this.parser.matchTag(dom,this,matchAfter));out:if(rule?rule.ignore:ignoreTags.hasOwnProperty(name))this.findInside(dom),this.ignoreFallback(dom,marks);else if(!rule||rule.skip||rule.closeParent){rule&&rule.closeParent?this.open=Math.max(0,this.open-1):rule&&rule.skip.nodeType&&(dom=rule.skip);let sync,oldNeedsBlock=this.needsBlock;if(blockTags.hasOwnProperty(name))top.content.length&&top.content[0].isInline&&this.open&&(this.open--,top=this.top),sync=!0,top.type||(this.needsBlock=!0);else if(!dom.firstChild){this.leafFallback(dom,marks);break out}let innerMarks=rule&&rule.skip?marks:this.readStyles(dom,marks);innerMarks&&this.addAll(dom,innerMarks),sync&&this.sync(top),this.needsBlock=oldNeedsBlock}else{let innerMarks=this.readStyles(dom,marks);innerMarks&&this.addElementByRule(dom,rule,innerMarks,!1===rule.consuming?ruleID:void 0)}this.localPreserveWS=outerWS}leafFallback(dom,marks){"BR"==dom.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(dom.ownerDocument.createTextNode("\n"),marks)}ignoreFallback(dom,marks){"BR"!=dom.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),marks,!0)}readStyles(dom,marks){let styles=dom.style;if(styles&&styles.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let name=this.parser.matchedStyles[i],value=styles.getPropertyValue(name);if(value)for(let after;;){let rule=this.parser.matchStyle(name,value,this,after);if(!rule)break;if(rule.ignore)return null;if(marks=rule.clearMark?marks.filter(m=>!rule.clearMark(m)):marks.concat(this.parser.schema.marks[rule.mark].create(rule.attrs)),!1!==rule.consuming)break;after=rule}}return marks}addElementByRule(dom,rule,marks,continueAfter){let sync,nodeType;if(rule.node)if(nodeType=this.parser.schema.nodes[rule.node],nodeType.isLeaf)this.insertNode(nodeType.create(rule.attrs),marks,"BR"==dom.nodeName)||this.leafFallback(dom,marks);else{let inner=this.enter(nodeType,rule.attrs||null,marks,rule.preserveWhitespace);inner&&(sync=!0,marks=inner)}else{let markType=this.parser.schema.marks[rule.mark];marks=marks.concat(markType.create(rule.attrs))}let startIn=this.top;if(nodeType&&nodeType.isLeaf)this.findInside(dom);else if(continueAfter)this.addElement(dom,marks,continueAfter);else if(rule.getContent)this.findInside(dom),rule.getContent(dom,this.parser.schema).forEach(node=>this.insertNode(node,marks,!1));else{let contentDOM=dom;"string"==typeof rule.contentElement?contentDOM=dom.querySelector(rule.contentElement):"function"==typeof rule.contentElement?contentDOM=rule.contentElement(dom):rule.contentElement&&(contentDOM=rule.contentElement),this.findAround(dom,contentDOM,!0),this.addAll(contentDOM,marks),this.findAround(dom,contentDOM,!1)}sync&&this.sync(startIn)&&this.open--}addAll(parent,marks,startIndex,endIndex){let index=startIndex||0;for(let dom=startIndex?parent.childNodes[startIndex]:parent.firstChild,end=null==endIndex?null:parent.childNodes[endIndex];dom!=end;dom=dom.nextSibling,++index)this.findAtPoint(parent,index),this.addDOM(dom,marks);this.findAtPoint(parent,index)}findPlace(node,marks,cautious){let route,sync;for(let depth=this.open,penalty=0;depth>=0;depth--){let cx=this.nodes[depth],found=cx.findWrapping(node);if(found&&(!route||route.length>found.length+penalty)&&(route=found,sync=cx,!found.length))break;if(cx.solid){if(cautious)break;penalty+=2}}if(!route)return null;this.sync(sync);for(let i=0;i<route.length;i++)marks=this.enterInner(route[i],null,marks,!1);return marks}insertNode(node,marks,cautious){if(node.isInline&&this.needsBlock&&!this.top.type){let block=this.textblockFromContext();block&&(marks=this.enterInner(block,null,marks))}let innerMarks=this.findPlace(node,marks,cautious);if(innerMarks){this.closeExtra();let top=this.top;top.match&&(top.match=top.match.matchType(node.type));let nodeMarks=Mark.none;for(let m of innerMarks.concat(node.marks))(top.type?top.type.allowsMarkType(m.type):markMayApply(m.type,node.type))&&(nodeMarks=m.addToSet(nodeMarks));return top.content.push(node.mark(nodeMarks)),!0}return!1}enter(type,attrs,marks,preserveWS){let innerMarks=this.findPlace(type.create(attrs),marks,!1);return innerMarks&&(innerMarks=this.enterInner(type,attrs,marks,!0,preserveWS)),innerMarks}enterInner(type,attrs,marks,solid=!1,preserveWS){this.closeExtra();let top=this.top;top.match=top.match&&top.match.matchType(type);let options=wsOptionsFor(type,preserveWS,top.options);4&top.options&&0==top.content.length&&(options|=4);let applyMarks=Mark.none;return marks=marks.filter(m=>!(top.type?top.type.allowsMarkType(m.type):markMayApply(m.type,type))||(applyMarks=m.addToSet(applyMarks),!1)),this.nodes.push(new NodeContext(type,attrs,applyMarks,solid,null,options)),this.open++,marks}closeExtra(openEnd=!1){let i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(openEnd));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(to){for(let i=this.open;i>=0;i--){if(this.nodes[i]==to)return this.open=i,!0;this.localPreserveWS&&(this.nodes[i].options|=1)}return!1}get currentPos(){this.closeExtra();let pos=0;for(let i=this.open;i>=0;i--){let content=this.nodes[i].content;for(let j=content.length-1;j>=0;j--)pos+=content[j].nodeSize;i&&pos++}return pos}findAtPoint(parent,offset){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==parent&&this.find[i].offset==offset&&(this.find[i].pos=this.currentPos)}findInside(parent){if(this.find)for(let i=0;i<this.find.length;i++)null==this.find[i].pos&&1==parent.nodeType&&parent.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)}findAround(parent,content,before){if(parent!=content&&this.find)for(let i=0;i<this.find.length;i++)if(null==this.find[i].pos&&1==parent.nodeType&&parent.contains(this.find[i].node)){content.compareDocumentPosition(this.find[i].node)&(before?2:4)&&(this.find[i].pos=this.currentPos)}}findInText(textNode){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==textNode&&(this.find[i].pos=this.currentPos-(textNode.nodeValue.length-this.find[i].offset))}matchesContext(context){if(context.indexOf("|")>-1)return context.split(/\s*\|\s*/).some(this.matchesContext,this);let parts=context.split("/"),option=this.options.context,useRoot=!(this.isOpen||option&&option.parent.type!=this.nodes[0].type),minDepth=-(option?option.depth+1:0)+(useRoot?0:1),match=(i,depth)=>{for(;i>=0;i--){let part=parts[i];if(""==part){if(i==parts.length-1||0==i)continue;for(;depth>=minDepth;depth--)if(match(i-1,depth))return!0;return!1}{let next=depth>0||0==depth&&useRoot?this.nodes[depth].type:option&&depth>=minDepth?option.node(depth-minDepth).type:null;if(!next||next.name!=part&&!next.isInGroup(part))return!1;depth--}}return!0};return match(parts.length-1,this.open)}textblockFromContext(){let $context=this.options.context;if($context)for(let d=$context.depth;d>=0;d--){let deflt=$context.node(d).contentMatchAt($context.indexAfter(d)).defaultType;if(deflt&&deflt.isTextblock&&deflt.defaultAttrs)return deflt}for(let name in this.parser.schema.nodes){let type=this.parser.schema.nodes[name];if(type.isTextblock&&type.defaultAttrs)return type}}}function matches(dom,selector){return(dom.matches||dom.msMatchesSelector||dom.webkitMatchesSelector||dom.mozMatchesSelector).call(dom,selector)}function copy(obj){let copy={};for(let prop in obj)copy[prop]=obj[prop];return copy}function markMayApply(markType,nodeType){let nodes=nodeType.schema.nodes;for(let name in nodes){let parent=nodes[name];if(!parent.allowsMarkType(markType))continue;let seen=[],scan=match=>{seen.push(match);for(let i=0;i<match.edgeCount;i++){let{type,next}=match.edge(i);if(type==nodeType)return!0;if(seen.indexOf(next)<0&&scan(next))return!0}};if(scan(parent.contentMatch))return!0}}class DOMSerializer{constructor(nodes,marks){this.nodes=nodes,this.marks=marks}serializeFragment(fragment,options={},target){target||(target=doc(options).createDocumentFragment());let top=target,active=[];return fragment.forEach(node=>{if(active.length||node.marks.length){let keep=0,rendered=0;for(;keep<active.length&&rendered<node.marks.length;){let next=node.marks[rendered];if(this.marks[next.type.name]){if(!next.eq(active[keep][0])||!1===next.type.spec.spanning)break;keep++,rendered++}else rendered++}for(;keep<active.length;)top=active.pop()[1];for(;rendered<node.marks.length;){let add=node.marks[rendered++],markDOM=this.serializeMark(add,node.isInline,options);markDOM&&(active.push([add,top]),top.appendChild(markDOM.dom),top=markDOM.contentDOM||markDOM.dom)}}top.appendChild(this.serializeNodeInner(node,options))}),target}serializeNodeInner(node,options){let{dom,contentDOM}=renderSpec(doc(options),this.nodes[node.type.name](node),null,node.attrs);if(contentDOM){if(node.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(node.content,options,contentDOM)}return dom}serializeNode(node,options={}){let dom=this.serializeNodeInner(node,options);for(let i=node.marks.length-1;i>=0;i--){let wrap=this.serializeMark(node.marks[i],node.isInline,options);wrap&&((wrap.contentDOM||wrap.dom).appendChild(dom),dom=wrap.dom)}return dom}serializeMark(mark,inline,options={}){let toDOM=this.marks[mark.type.name];return toDOM&&renderSpec(doc(options),toDOM(mark,inline),null,mark.attrs)}static renderSpec(doc,structure,xmlNS=null,blockArraysIn){return renderSpec(doc,structure,xmlNS,blockArraysIn)}static fromSchema(schema){return schema.cached.domSerializer||(schema.cached.domSerializer=new DOMSerializer(this.nodesFromSchema(schema),this.marksFromSchema(schema)))}static nodesFromSchema(schema){let result=gatherToDOM(schema.nodes);return result.text||(result.text=node=>node.text),result}static marksFromSchema(schema){return gatherToDOM(schema.marks)}}function gatherToDOM(obj){let result={};for(let name in obj){let toDOM=obj[name].spec.toDOM;toDOM&&(result[name]=toDOM)}return result}function doc(options){return options.document||window.document}const suspiciousAttributeCache=new WeakMap;function suspiciousAttributes(attrs){let value=suspiciousAttributeCache.get(attrs);return void 0===value&&suspiciousAttributeCache.set(attrs,value=function suspiciousAttributesInner(attrs){let result=null;function scan(value){if(value&&"object"==typeof value)if(Array.isArray(value))if("string"==typeof value[0])result||(result=[]),result.push(value);else for(let i=0;i<value.length;i++)scan(value[i]);else for(let prop in value)scan(value[prop])}return scan(attrs),result}(attrs)),value}function renderSpec(doc,structure,xmlNS,blockArraysIn){if("string"==typeof structure)return{dom:doc.createTextNode(structure)};if(null!=structure.nodeType)return{dom:structure};if(structure.dom&&null!=structure.dom.nodeType)return structure;let suspicious,tagName=structure[0];if("string"!=typeof tagName)throw new RangeError("Invalid array passed to renderSpec");if(blockArraysIn&&(suspicious=suspiciousAttributes(blockArraysIn))&&suspicious.indexOf(structure)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let contentDOM,space=tagName.indexOf(" ");space>0&&(xmlNS=tagName.slice(0,space),tagName=tagName.slice(space+1));let dom=xmlNS?doc.createElementNS(xmlNS,tagName):doc.createElement(tagName),attrs=structure[1],start=1;if(attrs&&"object"==typeof attrs&&null==attrs.nodeType&&!Array.isArray(attrs)){start=2;for(let name in attrs)if(null!=attrs[name]){let space=name.indexOf(" ");space>0?dom.setAttributeNS(name.slice(0,space),name.slice(space+1),attrs[name]):"style"==name&&dom.style?dom.style.cssText=attrs[name]:dom.setAttribute(name,attrs[name])}}for(let i=start;i<structure.length;i++){let child=structure[i];if(0===child){if(i<structure.length-1||i>start)throw new RangeError("Content hole must be the only child of its parent node");return{dom,contentDOM:dom}}{let{dom:inner,contentDOM:innerContent}=renderSpec(doc,child,xmlNS,blockArraysIn);if(dom.appendChild(inner),innerContent){if(contentDOM)throw new RangeError("Multiple content holes");contentDOM=innerContent}}}return{dom,contentDOM}}},"./node_modules/prosemirror-state/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$t:()=>EditorState,LN:()=>Selection,U3:()=>TextSelection,hs:()=>PluginKey,i5:()=>AllSelection,k_:()=>Plugin,nh:()=>NodeSelection,yn:()=>SelectionRange});var prosemirror_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/prosemirror-model/dist/index.js"),prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prosemirror-transform/dist/index.js");const classesById=Object.create(null);class Selection{constructor($anchor,$head,ranges){this.$anchor=$anchor,this.$head=$head,this.ranges=ranges||[new SelectionRange($anchor.min($head),$anchor.max($head))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let ranges=this.ranges;for(let i=0;i<ranges.length;i++)if(ranges[i].$from.pos!=ranges[i].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(tr,content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty){let lastNode=content.content.lastChild,lastParent=null;for(let i=0;i<content.openEnd;i++)lastParent=lastNode,lastNode=lastNode.lastChild;let mapFrom=tr.steps.length,ranges=this.ranges;for(let i=0;i<ranges.length;i++){let{$from,$to}=ranges[i],mapping=tr.mapping.slice(mapFrom);tr.replaceRange(mapping.map($from.pos),mapping.map($to.pos),i?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty:content),0==i&&selectionToInsertionEnd(tr,mapFrom,(lastNode?lastNode.isInline:lastParent&&lastParent.isTextblock)?-1:1)}}replaceWith(tr,node){let mapFrom=tr.steps.length,ranges=this.ranges;for(let i=0;i<ranges.length;i++){let{$from,$to}=ranges[i],mapping=tr.mapping.slice(mapFrom),from=mapping.map($from.pos),to=mapping.map($to.pos);i?tr.deleteRange(from,to):(tr.replaceRangeWith(from,to,node),selectionToInsertionEnd(tr,mapFrom,node.isInline?-1:1))}}static findFrom($pos,dir,textOnly=!1){let inner=$pos.parent.inlineContent?new TextSelection($pos):findSelectionIn($pos.node(0),$pos.parent,$pos.pos,$pos.index(),dir,textOnly);if(inner)return inner;for(let depth=$pos.depth-1;depth>=0;depth--){let found=dir<0?findSelectionIn($pos.node(0),$pos.node(depth),$pos.before(depth+1),$pos.index(depth),dir,textOnly):findSelectionIn($pos.node(0),$pos.node(depth),$pos.after(depth+1),$pos.index(depth)+1,dir,textOnly);if(found)return found}return null}static near($pos,bias=1){return this.findFrom($pos,bias)||this.findFrom($pos,-bias)||new AllSelection($pos.node(0))}static atStart(doc){return findSelectionIn(doc,doc,0,0,1)||new AllSelection(doc)}static atEnd(doc){return findSelectionIn(doc,doc,doc.content.size,doc.childCount,-1)||new AllSelection(doc)}static fromJSON(doc,json){if(!json||!json.type)throw new RangeError("Invalid input for Selection.fromJSON");let cls=classesById[json.type];if(!cls)throw new RangeError(`No selection type ${json.type} defined`);return cls.fromJSON(doc,json)}static jsonID(id,selectionClass){if(id in classesById)throw new RangeError("Duplicate use of selection JSON ID "+id);return classesById[id]=selectionClass,selectionClass.prototype.jsonID=id,selectionClass}getBookmark(){return TextSelection.between(this.$anchor,this.$head).getBookmark()}}Selection.prototype.visible=!0;class SelectionRange{constructor($from,$to){this.$from=$from,this.$to=$to}}let warnedAboutTextSelection=!1;function checkTextSelection($pos){warnedAboutTextSelection||$pos.parent.inlineContent||(warnedAboutTextSelection=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+$pos.parent.type.name+")"))}class TextSelection extends Selection{constructor($anchor,$head=$anchor){checkTextSelection($anchor),checkTextSelection($head),super($anchor,$head)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(doc,mapping){let $head=doc.resolve(mapping.map(this.head));if(!$head.parent.inlineContent)return Selection.near($head);let $anchor=doc.resolve(mapping.map(this.anchor));return new TextSelection($anchor.parent.inlineContent?$anchor:$head,$head)}replace(tr,content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty){if(super.replace(tr,content),content==prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty){let marks=this.$from.marksAcross(this.$to);marks&&tr.ensureMarks(marks)}}eq(other){return other instanceof TextSelection&&other.anchor==this.anchor&&other.head==this.head}getBookmark(){return new TextBookmark(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(doc,json){if("number"!=typeof json.anchor||"number"!=typeof json.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new TextSelection(doc.resolve(json.anchor),doc.resolve(json.head))}static create(doc,anchor,head=anchor){let $anchor=doc.resolve(anchor);return new this($anchor,head==anchor?$anchor:doc.resolve(head))}static between($anchor,$head,bias){let dPos=$anchor.pos-$head.pos;if(bias&&!dPos||(bias=dPos>=0?1:-1),!$head.parent.inlineContent){let found=Selection.findFrom($head,bias,!0)||Selection.findFrom($head,-bias,!0);if(!found)return Selection.near($head,bias);$head=found.$head}return $anchor.parent.inlineContent||(0==dPos||($anchor=(Selection.findFrom($anchor,-bias,!0)||Selection.findFrom($anchor,bias,!0)).$anchor).pos<$head.pos!=dPos<0)&&($anchor=$head),new TextSelection($anchor,$head)}}Selection.jsonID("text",TextSelection);class TextBookmark{constructor(anchor,head){this.anchor=anchor,this.head=head}map(mapping){return new TextBookmark(mapping.map(this.anchor),mapping.map(this.head))}resolve(doc){return TextSelection.between(doc.resolve(this.anchor),doc.resolve(this.head))}}class NodeSelection extends Selection{constructor($pos){let node=$pos.nodeAfter,$end=$pos.node(0).resolve($pos.pos+node.nodeSize);super($pos,$end),this.node=node}map(doc,mapping){let{deleted,pos}=mapping.mapResult(this.anchor),$pos=doc.resolve(pos);return deleted?Selection.near($pos):new NodeSelection($pos)}content(){return new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(this.node),0,0)}eq(other){return other instanceof NodeSelection&&other.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new NodeBookmark(this.anchor)}static fromJSON(doc,json){if("number"!=typeof json.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new NodeSelection(doc.resolve(json.anchor))}static create(doc,from){return new NodeSelection(doc.resolve(from))}static isSelectable(node){return!node.isText&&!1!==node.type.spec.selectable}}NodeSelection.prototype.visible=!1,Selection.jsonID("node",NodeSelection);class NodeBookmark{constructor(anchor){this.anchor=anchor}map(mapping){let{deleted,pos}=mapping.mapResult(this.anchor);return deleted?new TextBookmark(pos,pos):new NodeBookmark(pos)}resolve(doc){let $pos=doc.resolve(this.anchor),node=$pos.nodeAfter;return node&&NodeSelection.isSelectable(node)?new NodeSelection($pos):Selection.near($pos)}}class AllSelection extends Selection{constructor(doc){super(doc.resolve(0),doc.resolve(doc.content.size))}replace(tr,content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty){if(content==prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty){tr.delete(0,tr.doc.content.size);let sel=Selection.atStart(tr.doc);sel.eq(tr.selection)||tr.setSelection(sel)}else super.replace(tr,content)}toJSON(){return{type:"all"}}static fromJSON(doc){return new AllSelection(doc)}map(doc){return new AllSelection(doc)}eq(other){return other instanceof AllSelection}getBookmark(){return AllBookmark}}Selection.jsonID("all",AllSelection);const AllBookmark={map(){return this},resolve:doc=>new AllSelection(doc)};function findSelectionIn(doc,node,pos,index,dir,text=!1){if(node.inlineContent)return TextSelection.create(doc,pos);for(let i=index-(dir>0?0:1);dir>0?i<node.childCount:i>=0;i+=dir){let child=node.child(i);if(child.isAtom){if(!text&&NodeSelection.isSelectable(child))return NodeSelection.create(doc,pos-(dir<0?child.nodeSize:0))}else{let inner=findSelectionIn(doc,child,pos+dir,dir<0?child.childCount:0,dir,text);if(inner)return inner}pos+=child.nodeSize*dir}return null}function selectionToInsertionEnd(tr,startLen,bias){let last=tr.steps.length-1;if(last<startLen)return;let end,step=tr.steps[last];(step instanceof prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.Ln||step instanceof prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.Wg)&&(tr.mapping.maps[last].forEach((_from,_to,_newFrom,newTo)=>{null==end&&(end=newTo)}),tr.setSelection(Selection.near(tr.doc.resolve(end),bias)))}class Transaction extends prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.dL{constructor(state){super(state.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=state.selection,this.storedMarks=state.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(selection){if(selection.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=selection,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(marks){return this.storedMarks=marks,this.updated|=2,this}ensureMarks(marks){return prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.CU.sameSet(this.storedMarks||this.selection.$from.marks(),marks)||this.setStoredMarks(marks),this}addStoredMark(mark){return this.ensureMarks(mark.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(mark){return this.ensureMarks(mark.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(step,doc){super.addStep(step,doc),this.updated=-3&this.updated,this.storedMarks=null}setTime(time){return this.time=time,this}replaceSelection(slice){return this.selection.replace(this,slice),this}replaceSelectionWith(node,inheritMarks=!0){let selection=this.selection;return inheritMarks&&(node=node.mark(this.storedMarks||(selection.empty?selection.$from.marks():selection.$from.marksAcross(selection.$to)||prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.CU.none))),selection.replaceWith(this,node),this}deleteSelection(){return this.selection.replace(this),this}insertText(text,from,to){let schema=this.doc.type.schema;if(null==from)return text?this.replaceSelectionWith(schema.text(text),!0):this.deleteSelection();{if(null==to&&(to=from),to=null==to?from:to,!text)return this.deleteRange(from,to);let marks=this.storedMarks;if(!marks){let $from=this.doc.resolve(from);marks=to==from?$from.marks():$from.marksAcross(this.doc.resolve(to))}return this.replaceRangeWith(from,to,schema.text(text,marks)),this.selection.empty||this.setSelection(Selection.near(this.selection.$to)),this}}setMeta(key,value){return this.meta["string"==typeof key?key:key.key]=value,this}getMeta(key){return this.meta["string"==typeof key?key:key.key]}get isGeneric(){for(let _ in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function bind(f,self){return self&&f?f.bind(self):f}class FieldDesc{constructor(name,desc,self){this.name=name,this.init=bind(desc.init,self),this.apply=bind(desc.apply,self)}}const baseFields=[new FieldDesc("doc",{init:config=>config.doc||config.schema.topNodeType.createAndFill(),apply:tr=>tr.doc}),new FieldDesc("selection",{init:(config,instance)=>config.selection||Selection.atStart(instance.doc),apply:tr=>tr.selection}),new FieldDesc("storedMarks",{init:config=>config.storedMarks||null,apply:(tr,_marks,_old,state)=>state.selection.$cursor?tr.storedMarks:null}),new FieldDesc("scrollToSelection",{init:()=>0,apply:(tr,prev)=>tr.scrolledIntoView?prev+1:prev})];class Configuration{constructor(schema,plugins){this.schema=schema,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=baseFields.slice(),plugins&&plugins.forEach(plugin=>{if(this.pluginsByKey[plugin.key])throw new RangeError("Adding different instances of a keyed plugin ("+plugin.key+")");this.plugins.push(plugin),this.pluginsByKey[plugin.key]=plugin,plugin.spec.state&&this.fields.push(new FieldDesc(plugin.key,plugin.spec.state,plugin))})}}class EditorState{constructor(config){this.config=config}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(tr){return this.applyTransaction(tr).state}filterTransaction(tr,ignore=-1){for(let i=0;i<this.config.plugins.length;i++)if(i!=ignore){let plugin=this.config.plugins[i];if(plugin.spec.filterTransaction&&!plugin.spec.filterTransaction.call(plugin,tr,this))return!1}return!0}applyTransaction(rootTr){if(!this.filterTransaction(rootTr))return{state:this,transactions:[]};let trs=[rootTr],newState=this.applyInner(rootTr),seen=null;for(;;){let haveNew=!1;for(let i=0;i<this.config.plugins.length;i++){let plugin=this.config.plugins[i];if(plugin.spec.appendTransaction){let n=seen?seen[i].n:0,oldState=seen?seen[i].state:this,tr=n<trs.length&&plugin.spec.appendTransaction.call(plugin,n?trs.slice(n):trs,oldState,newState);if(tr&&newState.filterTransaction(tr,i)){if(tr.setMeta("appendedTransaction",rootTr),!seen){seen=[];for(let j=0;j<this.config.plugins.length;j++)seen.push(j<i?{state:newState,n:trs.length}:{state:this,n:0})}trs.push(tr),newState=newState.applyInner(tr),haveNew=!0}seen&&(seen[i]={state:newState,n:trs.length})}}if(!haveNew)return{state:newState,transactions:trs}}}applyInner(tr){if(!tr.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let newInstance=new EditorState(this.config),fields=this.config.fields;for(let i=0;i<fields.length;i++){let field=fields[i];newInstance[field.name]=field.apply(tr,this[field.name],this,newInstance)}return newInstance}get tr(){return new Transaction(this)}static create(config){let $config=new Configuration(config.doc?config.doc.type.schema:config.schema,config.plugins),instance=new EditorState($config);for(let i=0;i<$config.fields.length;i++)instance[$config.fields[i].name]=$config.fields[i].init(config,instance);return instance}reconfigure(config){let $config=new Configuration(this.schema,config.plugins),fields=$config.fields,instance=new EditorState($config);for(let i=0;i<fields.length;i++){let name=fields[i].name;instance[name]=this.hasOwnProperty(name)?this[name]:fields[i].init(config,instance)}return instance}toJSON(pluginFields){let result={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(result.storedMarks=this.storedMarks.map(m=>m.toJSON())),pluginFields&&"object"==typeof pluginFields)for(let prop in pluginFields){if("doc"==prop||"selection"==prop)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let plugin=pluginFields[prop],state=plugin.spec.state;state&&state.toJSON&&(result[prop]=state.toJSON.call(plugin,this[plugin.key]))}return result}static fromJSON(config,json,pluginFields){if(!json)throw new RangeError("Invalid input for EditorState.fromJSON");if(!config.schema)throw new RangeError("Required config field 'schema' missing");let $config=new Configuration(config.schema,config.plugins),instance=new EditorState($config);return $config.fields.forEach(field=>{if("doc"==field.name)instance.doc=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.bP.fromJSON(config.schema,json.doc);else if("selection"==field.name)instance.selection=Selection.fromJSON(instance.doc,json.selection);else if("storedMarks"==field.name)json.storedMarks&&(instance.storedMarks=json.storedMarks.map(config.schema.markFromJSON));else{if(pluginFields)for(let prop in pluginFields){let plugin=pluginFields[prop],state=plugin.spec.state;if(plugin.key==field.name&&state&&state.fromJSON&&Object.prototype.hasOwnProperty.call(json,prop))return void(instance[field.name]=state.fromJSON.call(plugin,config,json[prop],instance))}instance[field.name]=field.init(config,instance)}}),instance}}function bindProps(obj,self,target){for(let prop in obj){let val=obj[prop];val instanceof Function?val=val.bind(self):"handleDOMEvents"==prop&&(val=bindProps(val,self,{})),target[prop]=val}return target}class Plugin{constructor(spec){this.spec=spec,this.props={},spec.props&&bindProps(spec.props,this,this.props),this.key=spec.key?spec.key.key:createKey("plugin")}getState(state){return state[this.key]}}const keys=Object.create(null);function createKey(name){return name in keys?name+"$"+ ++keys[name]:(keys[name]=0,name+"$")}class PluginKey{constructor(name="key"){this.key=createKey(name)}get(state){return state.config.pluginsByKey[this.key]}getState(state){return state[this.key]}}},"./node_modules/prosemirror-transform/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$L:()=>replaceStep,Ln:()=>ReplaceStep,Um:()=>dropPoint,Wg:()=>ReplaceAroundStep,X9:()=>Mapping,XE:()=>AddMarkStep,dL:()=>Transform,jP:()=>liftTarget,n9:()=>canJoin,oM:()=>findWrapping,zy:()=>canSplit});var prosemirror_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/prosemirror-model/dist/index.js");const factor16=Math.pow(2,16);function makeRecover(index,offset){return index+offset*factor16}function recoverIndex(value){return 65535&value}class MapResult{constructor(pos,delInfo,recover){this.pos=pos,this.delInfo=delInfo,this.recover=recover}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class StepMap{constructor(ranges,inverted=!1){if(this.ranges=ranges,this.inverted=inverted,!ranges.length&&StepMap.empty)return StepMap.empty}recover(value){let diff=0,index=recoverIndex(value);if(!this.inverted)for(let i=0;i<index;i++)diff+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*index]+diff+function recoverOffset(value){return(value-(65535&value))/factor16}(value)}mapResult(pos,assoc=1){return this._map(pos,assoc,!1)}map(pos,assoc=1){return this._map(pos,assoc,!0)}_map(pos,assoc,simple){let diff=0,oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2;for(let i=0;i<this.ranges.length;i+=3){let start=this.ranges[i]-(this.inverted?diff:0);if(start>pos)break;let oldSize=this.ranges[i+oldIndex],newSize=this.ranges[i+newIndex],end=start+oldSize;if(pos<=end){let result=start+diff+((oldSize?pos==start?-1:pos==end?1:assoc:assoc)<0?0:newSize);if(simple)return result;let recover=pos==(assoc<0?start:end)?null:makeRecover(i/3,pos-start),del=pos==start?2:pos==end?1:4;return(assoc<0?pos!=start:pos!=end)&&(del|=8),new MapResult(result,del,recover)}diff+=newSize-oldSize}return simple?pos+diff:new MapResult(pos+diff,0,null)}touches(pos,recover){let diff=0,index=recoverIndex(recover),oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2;for(let i=0;i<this.ranges.length;i+=3){let start=this.ranges[i]-(this.inverted?diff:0);if(start>pos)break;let oldSize=this.ranges[i+oldIndex];if(pos<=start+oldSize&&i==3*index)return!0;diff+=this.ranges[i+newIndex]-oldSize}return!1}forEach(f){let oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2;for(let i=0,diff=0;i<this.ranges.length;i+=3){let start=this.ranges[i],oldStart=start-(this.inverted?diff:0),newStart=start+(this.inverted?0:diff),oldSize=this.ranges[i+oldIndex],newSize=this.ranges[i+newIndex];f(oldStart,oldStart+oldSize,newStart,newStart+newSize),diff+=newSize-oldSize}}invert(){return new StepMap(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(n){return 0==n?StepMap.empty:new StepMap(n<0?[0,-n,0]:[0,0,n])}}StepMap.empty=new StepMap([]);class Mapping{constructor(maps,mirror,from=0,to=(maps?maps.length:0)){this.mirror=mirror,this.from=from,this.to=to,this._maps=maps||[],this.ownData=!(maps||mirror)}get maps(){return this._maps}slice(from=0,to=this.maps.length){return new Mapping(this._maps,this.mirror,from,to)}appendMap(map,mirrors){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(map),null!=mirrors&&this.setMirror(this._maps.length-1,mirrors)}appendMapping(mapping){for(let i=0,startSize=this._maps.length;i<mapping._maps.length;i++){let mirr=mapping.getMirror(i);this.appendMap(mapping._maps[i],null!=mirr&&mirr<i?startSize+mirr:void 0)}}getMirror(n){if(this.mirror)for(let i=0;i<this.mirror.length;i++)if(this.mirror[i]==n)return this.mirror[i+(i%2?-1:1)]}setMirror(n,m){this.mirror||(this.mirror=[]),this.mirror.push(n,m)}appendMappingInverted(mapping){for(let i=mapping.maps.length-1,totalSize=this._maps.length+mapping._maps.length;i>=0;i--){let mirr=mapping.getMirror(i);this.appendMap(mapping._maps[i].invert(),null!=mirr&&mirr>i?totalSize-mirr-1:void 0)}}invert(){let inverse=new Mapping;return inverse.appendMappingInverted(this),inverse}map(pos,assoc=1){if(this.mirror)return this._map(pos,assoc,!0);for(let i=this.from;i<this.to;i++)pos=this._maps[i].map(pos,assoc);return pos}mapResult(pos,assoc=1){return this._map(pos,assoc,!1)}_map(pos,assoc,simple){let delInfo=0;for(let i=this.from;i<this.to;i++){let result=this._maps[i].mapResult(pos,assoc);if(null!=result.recover){let corr=this.getMirror(i);if(null!=corr&&corr>i&&corr<this.to){i=corr,pos=this._maps[corr].recover(result.recover);continue}}delInfo|=result.delInfo,pos=result.pos}return simple?pos:new MapResult(pos,delInfo,null)}}const stepsByID=Object.create(null);class Step{getMap(){return StepMap.empty}merge(other){return null}static fromJSON(schema,json){if(!json||!json.stepType)throw new RangeError("Invalid input for Step.fromJSON");let type=stepsByID[json.stepType];if(!type)throw new RangeError(`No step type ${json.stepType} defined`);return type.fromJSON(schema,json)}static jsonID(id,stepClass){if(id in stepsByID)throw new RangeError("Duplicate use of step JSON ID "+id);return stepsByID[id]=stepClass,stepClass.prototype.jsonID=id,stepClass}}class StepResult{constructor(doc,failed){this.doc=doc,this.failed=failed}static ok(doc){return new StepResult(doc,null)}static fail(message){return new StepResult(null,message)}static fromReplace(doc,from,to,slice){try{return StepResult.ok(doc.replace(from,to,slice))}catch(e){if(e instanceof prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.vI)return StepResult.fail(e.message);throw e}}}function mapFragment(fragment,f,parent){let mapped=[];for(let i=0;i<fragment.childCount;i++){let child=fragment.child(i);child.content.size&&(child=child.copy(mapFragment(child.content,f,child))),child.isInline&&(child=f(child,parent,i)),mapped.push(child)}return prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.fromArray(mapped)}class AddMarkStep extends Step{constructor(from,to,mark){super(),this.from=from,this.to=to,this.mark=mark}apply(doc){let oldSlice=doc.slice(this.from,this.to),$from=doc.resolve(this.from),parent=$from.node($from.sharedDepth(this.to)),slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(mapFragment(oldSlice.content,(node,parent)=>node.isAtom&&parent.type.allowsMarkType(this.mark.type)?node.mark(this.mark.addToSet(node.marks)):node,parent),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)}invert(){return new RemoveMarkStep(this.from,this.to,this.mark)}map(mapping){let from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new AddMarkStep(from.pos,to.pos,this.mark)}merge(other){return other instanceof AddMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from?new AddMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new AddMarkStep(json.from,json.to,schema.markFromJSON(json.mark))}}Step.jsonID("addMark",AddMarkStep);class RemoveMarkStep extends Step{constructor(from,to,mark){super(),this.from=from,this.to=to,this.mark=mark}apply(doc){let oldSlice=doc.slice(this.from,this.to),slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(mapFragment(oldSlice.content,node=>node.mark(this.mark.removeFromSet(node.marks)),doc),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)}invert(){return new AddMarkStep(this.from,this.to,this.mark)}map(mapping){let from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new RemoveMarkStep(from.pos,to.pos,this.mark)}merge(other){return other instanceof RemoveMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from?new RemoveMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new RemoveMarkStep(json.from,json.to,schema.markFromJSON(json.mark))}}Step.jsonID("removeMark",RemoveMarkStep);class AddNodeMarkStep extends Step{constructor(pos,mark){super(),this.pos=pos,this.mark=mark}apply(doc){let node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at mark step's position");let updated=node.type.create(node.attrs,null,this.mark.addToSet(node.marks));return StepResult.fromReplace(doc,this.pos,this.pos+1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(updated),0,node.isLeaf?0:1))}invert(doc){let node=doc.nodeAt(this.pos);if(node){let newSet=this.mark.addToSet(node.marks);if(newSet.length==node.marks.length){for(let i=0;i<node.marks.length;i++)if(!node.marks[i].isInSet(newSet))return new AddNodeMarkStep(this.pos,node.marks[i]);return new AddNodeMarkStep(this.pos,this.mark)}}return new RemoveNodeMarkStep(this.pos,this.mark)}map(mapping){let pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new AddNodeMarkStep(pos.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(schema,json){if("number"!=typeof json.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new AddNodeMarkStep(json.pos,schema.markFromJSON(json.mark))}}Step.jsonID("addNodeMark",AddNodeMarkStep);class RemoveNodeMarkStep extends Step{constructor(pos,mark){super(),this.pos=pos,this.mark=mark}apply(doc){let node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at mark step's position");let updated=node.type.create(node.attrs,null,this.mark.removeFromSet(node.marks));return StepResult.fromReplace(doc,this.pos,this.pos+1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(updated),0,node.isLeaf?0:1))}invert(doc){let node=doc.nodeAt(this.pos);return node&&this.mark.isInSet(node.marks)?new AddNodeMarkStep(this.pos,this.mark):this}map(mapping){let pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new RemoveNodeMarkStep(pos.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(schema,json){if("number"!=typeof json.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new RemoveNodeMarkStep(json.pos,schema.markFromJSON(json.mark))}}Step.jsonID("removeNodeMark",RemoveNodeMarkStep);class ReplaceStep extends Step{constructor(from,to,slice,structure=!1){super(),this.from=from,this.to=to,this.slice=slice,this.structure=structure}apply(doc){return this.structure&&contentBetween(doc,this.from,this.to)?StepResult.fail("Structure replace would overwrite content"):StepResult.fromReplace(doc,this.from,this.to,this.slice)}getMap(){return new StepMap([this.from,this.to-this.from,this.slice.size])}invert(doc){return new ReplaceStep(this.from,this.from+this.slice.size,doc.slice(this.from,this.to))}map(mapping){let from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deletedAcross&&to.deletedAcross?null:new ReplaceStep(from.pos,Math.max(from.pos,to.pos),this.slice,this.structure)}merge(other){if(!(other instanceof ReplaceStep)||other.structure||this.structure)return null;if(this.from+this.slice.size!=other.from||this.slice.openEnd||other.slice.openStart){if(other.to!=this.from||this.slice.openStart||other.slice.openEnd)return null;{let slice=this.slice.size+other.slice.size==0?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(other.slice.content.append(this.slice.content),other.slice.openStart,this.slice.openEnd);return new ReplaceStep(other.from,this.to,slice,this.structure)}}{let slice=this.slice.size+other.slice.size==0?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(this.slice.content.append(other.slice.content),this.slice.openStart,other.slice.openEnd);return new ReplaceStep(this.from,this.to+(other.to-other.from),slice,this.structure)}}toJSON(){let json={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json}static fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ReplaceStep(json.from,json.to,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.fromJSON(schema,json.slice),!!json.structure)}}Step.jsonID("replace",ReplaceStep);class ReplaceAroundStep extends Step{constructor(from,to,gapFrom,gapTo,slice,insert,structure=!1){super(),this.from=from,this.to=to,this.gapFrom=gapFrom,this.gapTo=gapTo,this.slice=slice,this.insert=insert,this.structure=structure}apply(doc){if(this.structure&&(contentBetween(doc,this.from,this.gapFrom)||contentBetween(doc,this.gapTo,this.to)))return StepResult.fail("Structure gap-replace would overwrite content");let gap=doc.slice(this.gapFrom,this.gapTo);if(gap.openStart||gap.openEnd)return StepResult.fail("Gap is not a flat range");let inserted=this.slice.insertAt(this.insert,gap.content);return inserted?StepResult.fromReplace(doc,this.from,this.to,inserted):StepResult.fail("Content does not fit in gap")}getMap(){return new StepMap([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(doc){let gap=this.gapTo-this.gapFrom;return new ReplaceAroundStep(this.from,this.from+this.slice.size+gap,this.from+this.insert,this.from+this.insert+gap,doc.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(mapping){let from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1),gapFrom=this.from==this.gapFrom?from.pos:mapping.map(this.gapFrom,-1),gapTo=this.to==this.gapTo?to.pos:mapping.map(this.gapTo,1);return from.deletedAcross&&to.deletedAcross||gapFrom<from.pos||gapTo>to.pos?null:new ReplaceAroundStep(from.pos,to.pos,gapFrom,gapTo,this.slice,this.insert,this.structure)}toJSON(){let json={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json}static fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to||"number"!=typeof json.gapFrom||"number"!=typeof json.gapTo||"number"!=typeof json.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ReplaceAroundStep(json.from,json.to,json.gapFrom,json.gapTo,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.fromJSON(schema,json.slice),json.insert,!!json.structure)}}function contentBetween(doc,from,to){let $from=doc.resolve(from),dist=to-from,depth=$from.depth;for(;dist>0&&depth>0&&$from.indexAfter(depth)==$from.node(depth).childCount;)depth--,dist--;if(dist>0){let next=$from.node(depth).maybeChild($from.indexAfter(depth));for(;dist>0;){if(!next||next.isLeaf)return!0;next=next.firstChild,dist--}}return!1}function clearIncompatible(tr,pos,parentType,match=parentType.contentMatch,clearNewlines=!0){let node=tr.doc.nodeAt(pos),replSteps=[],cur=pos+1;for(let i=0;i<node.childCount;i++){let child=node.child(i),end=cur+child.nodeSize,allowed=match.matchType(child.type);if(allowed){match=allowed;for(let j=0;j<child.marks.length;j++)parentType.allowsMarkType(child.marks[j].type)||tr.step(new RemoveMarkStep(cur,end,child.marks[j]));if(clearNewlines&&child.isText&&"pre"!=parentType.whitespace){let m,slice,newline=/\r?\n|\r/g;for(;m=newline.exec(child.text);)slice||(slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(parentType.schema.text(" ",parentType.allowedMarks(child.marks))),0,0)),replSteps.push(new ReplaceStep(cur+m.index,cur+m.index+m[0].length,slice))}}else replSteps.push(new ReplaceStep(cur,end,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty));cur=end}if(!match.validEnd){let fill=match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty,!0);tr.replace(cur,cur,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(fill,0,0))}for(let i=replSteps.length-1;i>=0;i--)tr.step(replSteps[i])}function canCut(node,start,end){return(0==start||node.canReplace(start,node.childCount))&&(end==node.childCount||node.canReplace(0,end))}function liftTarget(range){let content=range.parent.content.cutByIndex(range.startIndex,range.endIndex);for(let depth=range.depth;;--depth){let node=range.$from.node(depth),index=range.$from.index(depth),endIndex=range.$to.indexAfter(depth);if(depth<range.depth&&node.canReplace(index,endIndex,content))return depth;if(0==depth||node.type.spec.isolating||!canCut(node,index,endIndex))break}return null}function findWrapping(range,nodeType,attrs=null,innerRange=range){let around=function findWrappingOutside(range,type){let{parent,startIndex,endIndex}=range,around=parent.contentMatchAt(startIndex).findWrapping(type);if(!around)return null;let outer=around.length?around[0]:type;return parent.canReplaceWith(startIndex,endIndex,outer)?around:null}(range,nodeType),inner=around&&function findWrappingInside(range,type){let{parent,startIndex,endIndex}=range,inner=parent.child(startIndex),inside=type.contentMatch.findWrapping(inner.type);if(!inside)return null;let innerMatch=(inside.length?inside[inside.length-1]:type).contentMatch;for(let i=startIndex;innerMatch&&i<endIndex;i++)innerMatch=innerMatch.matchType(parent.child(i).type);return innerMatch&&innerMatch.validEnd?inside:null}(innerRange,nodeType);return inner?around.map(withAttrs).concat({type:nodeType,attrs}).concat(inner.map(withAttrs)):null}function withAttrs(type){return{type,attrs:null}}function replaceNewlines(tr,node,pos,mapFrom){node.forEach((child,offset)=>{if(child.isText){let m,newline=/\r?\n|\r/g;for(;m=newline.exec(child.text);){let start=tr.mapping.slice(mapFrom).map(pos+1+offset+m.index);tr.replaceWith(start,start+1,node.type.schema.linebreakReplacement.create())}}})}function replaceLinebreaks(tr,node,pos,mapFrom){node.forEach((child,offset)=>{if(child.type==child.type.schema.linebreakReplacement){let start=tr.mapping.slice(mapFrom).map(pos+1+offset);tr.replaceWith(start,start+1,node.type.schema.text("\n"))}})}function canSplit(doc,pos,depth=1,typesAfter){let $pos=doc.resolve(pos),base=$pos.depth-depth,innerType=typesAfter&&typesAfter[typesAfter.length-1]||$pos.parent;if(base<0||$pos.parent.type.spec.isolating||!$pos.parent.canReplace($pos.index(),$pos.parent.childCount)||!innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(),$pos.parent.childCount)))return!1;for(let d=$pos.depth-1,i=depth-2;d>base;d--,i--){let node=$pos.node(d),index=$pos.index(d);if(node.type.spec.isolating)return!1;let rest=node.content.cutByIndex(index,node.childCount),overrideChild=typesAfter&&typesAfter[i+1];overrideChild&&(rest=rest.replaceChild(0,overrideChild.type.create(overrideChild.attrs)));let after=typesAfter&&typesAfter[i]||node;if(!node.canReplace(index+1,node.childCount)||!after.type.validContent(rest))return!1}let index=$pos.indexAfter(base),baseType=typesAfter&&typesAfter[0];return $pos.node(base).canReplaceWith(index,index,baseType?baseType.type:$pos.node(base+1).type)}function canJoin(doc,pos){let $pos=doc.resolve(pos),index=$pos.index();return joinable($pos.nodeBefore,$pos.nodeAfter)&&$pos.parent.canReplace(index,index+1)}function joinable(a,b){return!(!a||!b||a.isLeaf||!function canAppendWithSubstitutedLinebreaks(a,b){b.content.size||a.type.compatibleContent(b.type);let match=a.contentMatchAt(a.childCount),{linebreakReplacement}=a.type.schema;for(let i=0;i<b.childCount;i++){let child=b.child(i),type=child.type==linebreakReplacement?a.type.schema.nodes.text:child.type;if(match=match.matchType(type),!match)return!1;if(!a.type.allowsMarks(child.marks))return!1}return match.validEnd}(a,b))}function dropPoint(doc,pos,slice){let $pos=doc.resolve(pos);if(!slice.content.size)return pos;let content=slice.content;for(let i=0;i<slice.openStart;i++)content=content.firstChild.content;for(let pass=1;pass<=(0==slice.openStart&&slice.size?2:1);pass++)for(let d=$pos.depth;d>=0;d--){let bias=d==$pos.depth?0:$pos.pos<=($pos.start(d+1)+$pos.end(d+1))/2?-1:1,insertPos=$pos.index(d)+(bias>0?1:0),parent=$pos.node(d),fits=!1;if(1==pass)fits=parent.canReplace(insertPos,insertPos,content);else{let wrapping=parent.contentMatchAt(insertPos).findWrapping(content.firstChild.type);fits=wrapping&&parent.canReplaceWith(insertPos,insertPos,wrapping[0])}if(fits)return 0==bias?$pos.pos:bias<0?$pos.before(d+1):$pos.after(d+1)}return null}function replaceStep(doc,from,to=from,slice=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty){if(from==to&&!slice.size)return null;let $from=doc.resolve(from),$to=doc.resolve(to);return fitsTrivially($from,$to,slice)?new ReplaceStep(from,to,slice):new Fitter($from,$to,slice).fit()}function fitsTrivially($from,$to,slice){return!slice.openStart&&!slice.openEnd&&$from.start()==$to.start()&&$from.parent.canReplace($from.index(),$to.index(),slice.content)}Step.jsonID("replaceAround",ReplaceAroundStep);class Fitter{constructor($from,$to,unplaced){this.$from=$from,this.$to=$to,this.unplaced=unplaced,this.frontier=[],this.placed=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty;for(let i=0;i<=$from.depth;i++){let node=$from.node(i);this.frontier.push({type:node.type,match:node.contentMatchAt($from.indexAfter(i))})}for(let i=$from.depth;i>0;i--)this.placed=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from($from.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let fit=this.findFittable();fit?this.placeNodes(fit):this.openMore()||this.dropNode()}let moveInline=this.mustMoveInline(),placedSize=this.placed.size-this.depth-this.$from.depth,$from=this.$from,$to=this.close(moveInline<0?this.$to:$from.doc.resolve(moveInline));if(!$to)return null;let content=this.placed,openStart=$from.depth,openEnd=$to.depth;for(;openStart&&openEnd&&1==content.childCount;)content=content.firstChild.content,openStart--,openEnd--;let slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(content,openStart,openEnd);return moveInline>-1?new ReplaceAroundStep($from.pos,moveInline,this.$to.pos,this.$to.end(),slice,placedSize):slice.size||$from.pos!=this.$to.pos?new ReplaceStep($from.pos,$to.pos,slice):null}findFittable(){let startDepth=this.unplaced.openStart;for(let cur=this.unplaced.content,d=0,openEnd=this.unplaced.openEnd;d<startDepth;d++){let node=cur.firstChild;if(cur.childCount>1&&(openEnd=0),node.type.spec.isolating&&openEnd<=d){startDepth=d;break}cur=node.content}for(let pass=1;pass<=2;pass++)for(let sliceDepth=1==pass?startDepth:this.unplaced.openStart;sliceDepth>=0;sliceDepth--){let fragment,parent=null;sliceDepth?(parent=contentAt(this.unplaced.content,sliceDepth-1).firstChild,fragment=parent.content):fragment=this.unplaced.content;let first=fragment.firstChild;for(let frontierDepth=this.depth;frontierDepth>=0;frontierDepth--){let wrap,{type,match}=this.frontier[frontierDepth],inject=null;if(1==pass&&(first?match.matchType(first.type)||(inject=match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(first),!1)):parent&&type.compatibleContent(parent.type)))return{sliceDepth,frontierDepth,parent,inject};if(2==pass&&first&&(wrap=match.findWrapping(first.type)))return{sliceDepth,frontierDepth,parent,wrap};if(parent&&match.matchType(parent.type))break}}}openMore(){let{content,openStart,openEnd}=this.unplaced,inner=contentAt(content,openStart);return!(!inner.childCount||inner.firstChild.isLeaf)&&(this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(content,openStart+1,Math.max(openEnd,inner.size+openStart>=content.size-openEnd?openStart+1:0)),!0)}dropNode(){let{content,openStart,openEnd}=this.unplaced,inner=contentAt(content,openStart);if(inner.childCount<=1&&openStart>0){let openAtEnd=content.size-openStart<=openStart+inner.size;this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(dropFromFragment(content,openStart-1,1),openStart-1,openAtEnd?openStart-1:openEnd)}else this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(dropFromFragment(content,openStart,1),openStart,openEnd)}placeNodes({sliceDepth,frontierDepth,parent,inject,wrap}){for(;this.depth>frontierDepth;)this.closeFrontierNode();if(wrap)for(let i=0;i<wrap.length;i++)this.openFrontierNode(wrap[i]);let slice=this.unplaced,fragment=parent?parent.content:slice.content,openStart=slice.openStart-sliceDepth,taken=0,add=[],{match,type}=this.frontier[frontierDepth];if(inject){for(let i=0;i<inject.childCount;i++)add.push(inject.child(i));match=match.matchFragment(inject)}let openEndCount=fragment.size+sliceDepth-(slice.content.size-slice.openEnd);for(;taken<fragment.childCount;){let next=fragment.child(taken),matches=match.matchType(next.type);if(!matches)break;taken++,(taken>1||0==openStart||next.content.size)&&(match=matches,add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)),1==taken?openStart:0,taken==fragment.childCount?openEndCount:-1)))}let toEnd=taken==fragment.childCount;toEnd||(openEndCount=-1),this.placed=addToFragment(this.placed,frontierDepth,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(add)),this.frontier[frontierDepth].match=match,toEnd&&openEndCount<0&&parent&&parent.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let i=0,cur=fragment;i<openEndCount;i++){let node=cur.lastChild;this.frontier.push({type:node.type,match:node.contentMatchAt(node.childCount)}),cur=node.content}this.unplaced=toEnd?0==sliceDepth?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(dropFromFragment(slice.content,sliceDepth-1,1),sliceDepth-1,openEndCount<0?slice.openEnd:sliceDepth-1):new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(dropFromFragment(slice.content,sliceDepth,taken),slice.openStart,slice.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let level,top=this.frontier[this.depth];if(!top.type.isTextblock||!contentAfterFits(this.$to,this.$to.depth,top.type,top.match,!1)||this.$to.depth==this.depth&&(level=this.findCloseLevel(this.$to))&&level.depth==this.depth)return-1;let{depth}=this.$to,after=this.$to.after(depth);for(;depth>1&&after==this.$to.end(--depth);)++after;return after}findCloseLevel($to){scan:for(let i=Math.min(this.depth,$to.depth);i>=0;i--){let{match,type}=this.frontier[i],dropInner=i<$to.depth&&$to.end(i+1)==$to.pos+($to.depth-(i+1)),fit=contentAfterFits($to,i,type,match,dropInner);if(fit){for(let d=i-1;d>=0;d--){let{match,type}=this.frontier[d],matches=contentAfterFits($to,d,type,match,!0);if(!matches||matches.childCount)continue scan}return{depth:i,fit,move:dropInner?$to.doc.resolve($to.after(i+1)):$to}}}}close($to){let close=this.findCloseLevel($to);if(!close)return null;for(;this.depth>close.depth;)this.closeFrontierNode();close.fit.childCount&&(this.placed=addToFragment(this.placed,close.depth,close.fit)),$to=close.move;for(let d=close.depth+1;d<=$to.depth;d++){let node=$to.node(d),add=node.type.contentMatch.fillBefore(node.content,!0,$to.index(d));this.openFrontierNode(node.type,node.attrs,add)}return $to}openFrontierNode(type,attrs=null,content){let top=this.frontier[this.depth];top.match=top.match.matchType(type),this.placed=addToFragment(this.placed,this.depth,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(type.create(attrs,content))),this.frontier.push({type,match:type.contentMatch})}closeFrontierNode(){let add=this.frontier.pop().match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty,!0);add.childCount&&(this.placed=addToFragment(this.placed,this.frontier.length,add))}}function dropFromFragment(fragment,depth,count){return 0==depth?fragment.cutByIndex(count,fragment.childCount):fragment.replaceChild(0,fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content,depth-1,count)))}function addToFragment(fragment,depth,content){return 0==depth?fragment.append(content):fragment.replaceChild(fragment.childCount-1,fragment.lastChild.copy(addToFragment(fragment.lastChild.content,depth-1,content)))}function contentAt(fragment,depth){for(let i=0;i<depth;i++)fragment=fragment.firstChild.content;return fragment}function closeNodeStart(node,openStart,openEnd){if(openStart<=0)return node;let frag=node.content;return openStart>1&&(frag=frag.replaceChild(0,closeNodeStart(frag.firstChild,openStart-1,1==frag.childCount?openEnd-1:0))),openStart>0&&(frag=node.type.contentMatch.fillBefore(frag).append(frag),openEnd<=0&&(frag=frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty,!0)))),node.copy(frag)}function contentAfterFits($to,depth,type,match,open){let node=$to.node(depth),index=open?$to.indexAfter(depth):$to.index(depth);if(index==node.childCount&&!type.compatibleContent(node.type))return null;let fit=match.fillBefore(node.content,!0,index);return fit&&!function invalidMarks(type,fragment,start){for(let i=start;i<fragment.childCount;i++)if(!type.allowsMarks(fragment.child(i).marks))return!0;return!1}(type,node.content,index)?fit:null}function definesContent(type){return type.spec.defining||type.spec.definingForContent}function closeFragment(fragment,depth,oldOpen,newOpen,parent){if(depth<oldOpen){let first=fragment.firstChild;fragment=fragment.replaceChild(0,first.copy(closeFragment(first.content,depth+1,oldOpen,newOpen,first)))}if(depth>newOpen){let match=parent.contentMatchAt(0),start=match.fillBefore(fragment).append(fragment);fragment=start.append(match.matchFragment(start).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty,!0))}return fragment}function coveredDepths($from,$to){let result=[];for(let d=Math.min($from.depth,$to.depth);d>=0;d--){let start=$from.start(d);if(start<$from.pos-($from.depth-d)||$to.end(d)>$to.pos+($to.depth-d)||$from.node(d).type.spec.isolating||$to.node(d).type.spec.isolating)break;(start==$to.start(d)||d==$from.depth&&d==$to.depth&&$from.parent.inlineContent&&$to.parent.inlineContent&&d&&$to.start(d-1)==start-1)&&result.push(d)}return result}class AttrStep extends Step{constructor(pos,attr,value){super(),this.pos=pos,this.attr=attr,this.value=value}apply(doc){let node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at attribute step's position");let attrs=Object.create(null);for(let name in node.attrs)attrs[name]=node.attrs[name];attrs[this.attr]=this.value;let updated=node.type.create(attrs,null,node.marks);return StepResult.fromReplace(doc,this.pos,this.pos+1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(updated),0,node.isLeaf?0:1))}getMap(){return StepMap.empty}invert(doc){return new AttrStep(this.pos,this.attr,doc.nodeAt(this.pos).attrs[this.attr])}map(mapping){let pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new AttrStep(pos.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(schema,json){if("number"!=typeof json.pos||"string"!=typeof json.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new AttrStep(json.pos,json.attr,json.value)}}Step.jsonID("attr",AttrStep);class DocAttrStep extends Step{constructor(attr,value){super(),this.attr=attr,this.value=value}apply(doc){let attrs=Object.create(null);for(let name in doc.attrs)attrs[name]=doc.attrs[name];attrs[this.attr]=this.value;let updated=doc.type.create(attrs,doc.content,doc.marks);return StepResult.ok(updated)}getMap(){return StepMap.empty}invert(doc){return new DocAttrStep(this.attr,doc.attrs[this.attr])}map(mapping){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(schema,json){if("string"!=typeof json.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new DocAttrStep(json.attr,json.value)}}Step.jsonID("docAttr",DocAttrStep);let TransformError=class extends Error{};TransformError=function TransformError(message){let err=Error.call(this,message);return err.__proto__=TransformError.prototype,err},(TransformError.prototype=Object.create(Error.prototype)).constructor=TransformError,TransformError.prototype.name="TransformError";class Transform{constructor(doc){this.doc=doc,this.steps=[],this.docs=[],this.mapping=new Mapping}get before(){return this.docs.length?this.docs[0]:this.doc}step(step){let result=this.maybeStep(step);if(result.failed)throw new TransformError(result.failed);return this}maybeStep(step){let result=step.apply(this.doc);return result.failed||this.addStep(step,result.doc),result}get docChanged(){return this.steps.length>0}addStep(step,doc){this.docs.push(this.doc),this.steps.push(step),this.mapping.appendMap(step.getMap()),this.doc=doc}replace(from,to=from,slice=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty){let step=replaceStep(this.doc,from,to,slice);return step&&this.step(step),this}replaceWith(from,to,content){return this.replace(from,to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(content),0,0))}delete(from,to){return this.replace(from,to,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty)}insert(pos,content){return this.replaceWith(pos,pos,content)}replaceRange(from,to,slice){return function replaceRange(tr,from,to,slice){if(!slice.size)return tr.deleteRange(from,to);let $from=tr.doc.resolve(from),$to=tr.doc.resolve(to);if(fitsTrivially($from,$to,slice))return tr.step(new ReplaceStep(from,to,slice));let targetDepths=coveredDepths($from,tr.doc.resolve(to));0==targetDepths[targetDepths.length-1]&&targetDepths.pop();let preferredTarget=-($from.depth+1);targetDepths.unshift(preferredTarget);for(let d=$from.depth,pos=$from.pos-1;d>0;d--,pos--){let spec=$from.node(d).type.spec;if(spec.defining||spec.definingAsContext||spec.isolating)break;targetDepths.indexOf(d)>-1?preferredTarget=d:$from.before(d)==pos&&targetDepths.splice(1,0,-d)}let preferredTargetIndex=targetDepths.indexOf(preferredTarget),leftNodes=[],preferredDepth=slice.openStart;for(let content=slice.content,i=0;;i++){let node=content.firstChild;if(leftNodes.push(node),i==slice.openStart)break;content=node.content}for(let d=preferredDepth-1;d>=0;d--){let leftNode=leftNodes[d],def=definesContent(leftNode.type);if(def&&!leftNode.sameMarkup($from.node(Math.abs(preferredTarget)-1)))preferredDepth=d;else if(def||!leftNode.type.isTextblock)break}for(let j=slice.openStart;j>=0;j--){let openDepth=(j+preferredDepth+1)%(slice.openStart+1),insert=leftNodes[openDepth];if(insert)for(let i=0;i<targetDepths.length;i++){let targetDepth=targetDepths[(i+preferredTargetIndex)%targetDepths.length],expand=!0;targetDepth<0&&(expand=!1,targetDepth=-targetDepth);let parent=$from.node(targetDepth-1),index=$from.index(targetDepth-1);if(parent.canReplaceWith(index,index,insert.type,insert.marks))return tr.replace($from.before(targetDepth),expand?$to.after(targetDepth):to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(closeFragment(slice.content,0,slice.openStart,openDepth),openDepth,slice.openEnd))}}let startSteps=tr.steps.length;for(let i=targetDepths.length-1;i>=0&&(tr.replace(from,to,slice),!(tr.steps.length>startSteps));i--){let depth=targetDepths[i];depth<0||(from=$from.before(depth),to=$to.after(depth))}}(this,from,to,slice),this}replaceRangeWith(from,to,node){return function replaceRangeWith(tr,from,to,node){if(!node.isInline&&from==to&&tr.doc.resolve(from).parent.content.size){let point=function insertPoint(doc,pos,nodeType){let $pos=doc.resolve(pos);if($pos.parent.canReplaceWith($pos.index(),$pos.index(),nodeType))return pos;if(0==$pos.parentOffset)for(let d=$pos.depth-1;d>=0;d--){let index=$pos.index(d);if($pos.node(d).canReplaceWith(index,index,nodeType))return $pos.before(d+1);if(index>0)return null}if($pos.parentOffset==$pos.parent.content.size)for(let d=$pos.depth-1;d>=0;d--){let index=$pos.indexAfter(d);if($pos.node(d).canReplaceWith(index,index,nodeType))return $pos.after(d+1);if(index<$pos.node(d).childCount)return null}return null}(tr.doc,from,node.type);null!=point&&(from=to=point)}tr.replaceRange(from,to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(node),0,0))}(this,from,to,node),this}deleteRange(from,to){return function deleteRange(tr,from,to){let $from=tr.doc.resolve(from),$to=tr.doc.resolve(to),covered=coveredDepths($from,$to);for(let i=0;i<covered.length;i++){let depth=covered[i],last=i==covered.length-1;if(last&&0==depth||$from.node(depth).type.contentMatch.validEnd)return tr.delete($from.start(depth),$to.end(depth));if(depth>0&&(last||$from.node(depth-1).canReplace($from.index(depth-1),$to.indexAfter(depth-1))))return tr.delete($from.before(depth),$to.after(depth))}for(let d=1;d<=$from.depth&&d<=$to.depth;d++)if(from-$from.start(d)==$from.depth-d&&to>$from.end(d)&&$to.end(d)-to!=$to.depth-d&&$from.start(d-1)==$to.start(d-1)&&$from.node(d-1).canReplace($from.index(d-1),$to.index(d-1)))return tr.delete($from.before(d),to);tr.delete(from,to)}(this,from,to),this}lift(range,target){return function lift(tr,range,target){let{$from,$to,depth}=range,gapStart=$from.before(depth+1),gapEnd=$to.after(depth+1),start=gapStart,end=gapEnd,before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty,openStart=0;for(let d=depth,splitting=!1;d>target;d--)splitting||$from.index(d)>0?(splitting=!0,before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from($from.node(d).copy(before)),openStart++):start--;let after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty,openEnd=0;for(let d=depth,splitting=!1;d>target;d--)splitting||$to.after(d+1)<$to.end(d)?(splitting=!0,after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from($to.node(d).copy(after)),openEnd++):end++;tr.step(new ReplaceAroundStep(start,end,gapStart,gapEnd,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(before.append(after),openStart,openEnd),before.size-openStart,!0))}(this,range,target),this}join(pos,depth=1){return function join(tr,pos,depth){let convertNewlines=null,{linebreakReplacement}=tr.doc.type.schema,$before=tr.doc.resolve(pos-depth),beforeType=$before.node().type;if(linebreakReplacement&&beforeType.inlineContent){let pre="pre"==beforeType.whitespace,supportLinebreak=!!beforeType.contentMatch.matchType(linebreakReplacement);pre&&!supportLinebreak?convertNewlines=!1:!pre&&supportLinebreak&&(convertNewlines=!0)}let mapFrom=tr.steps.length;if(!1===convertNewlines){let $after=tr.doc.resolve(pos+depth);replaceLinebreaks(tr,$after.node(),$after.before(),mapFrom)}beforeType.inlineContent&&clearIncompatible(tr,pos+depth-1,beforeType,$before.node().contentMatchAt($before.index()),null==convertNewlines);let mapping=tr.mapping.slice(mapFrom),start=mapping.map(pos-depth);if(tr.step(new ReplaceStep(start,mapping.map(pos+depth,-1),prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji.empty,!0)),!0===convertNewlines){let $full=tr.doc.resolve(start);replaceNewlines(tr,$full.node(),$full.before(),tr.steps.length)}return tr}(this,pos,depth),this}wrap(range,wrappers){return function wrap(tr,range,wrappers){let content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty;for(let i=wrappers.length-1;i>=0;i--){if(content.size){let match=wrappers[i].type.contentMatch.matchFragment(content);if(!match||!match.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(wrappers[i].type.create(wrappers[i].attrs,content))}let start=range.start,end=range.end;tr.step(new ReplaceAroundStep(start,end,start,end,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(content,0,0),wrappers.length,!0))}(this,range,wrappers),this}setBlockType(from,to=from,type,attrs=null){return function setBlockType(tr,from,to,type,attrs){if(!type.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let mapFrom=tr.steps.length;tr.doc.nodesBetween(from,to,(node,pos)=>{let attrsHere="function"==typeof attrs?attrs(node):attrs;if(node.isTextblock&&!node.hasMarkup(type,attrsHere)&&function canChangeType(doc,pos,type){let $pos=doc.resolve(pos),index=$pos.index();return $pos.parent.canReplaceWith(index,index+1,type)}(tr.doc,tr.mapping.slice(mapFrom).map(pos),type)){let convertNewlines=null;if(type.schema.linebreakReplacement){let pre="pre"==type.whitespace,supportLinebreak=!!type.contentMatch.matchType(type.schema.linebreakReplacement);pre&&!supportLinebreak?convertNewlines=!1:!pre&&supportLinebreak&&(convertNewlines=!0)}!1===convertNewlines&&replaceLinebreaks(tr,node,pos,mapFrom),clearIncompatible(tr,tr.mapping.slice(mapFrom).map(pos,1),type,void 0,null===convertNewlines);let mapping=tr.mapping.slice(mapFrom),startM=mapping.map(pos,1),endM=mapping.map(pos+node.nodeSize,1);return tr.step(new ReplaceAroundStep(startM,endM,startM+1,endM-1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(type.create(attrsHere,null,node.marks)),0,0),1,!0)),!0===convertNewlines&&replaceNewlines(tr,node,pos,mapFrom),!1}})}(this,from,to,type,attrs),this}setNodeMarkup(pos,type,attrs=null,marks){return function setNodeMarkup(tr,pos,type,attrs,marks){let node=tr.doc.nodeAt(pos);if(!node)throw new RangeError("No node at given position");type||(type=node.type);let newNode=type.create(attrs,null,marks||node.marks);if(node.isLeaf)return tr.replaceWith(pos,pos+node.nodeSize,newNode);if(!type.validContent(node.content))throw new RangeError("Invalid content for node type "+type.name);tr.step(new ReplaceAroundStep(pos,pos+node.nodeSize,pos+1,pos+node.nodeSize-1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(newNode),0,0),1,!0))}(this,pos,type,attrs,marks),this}setNodeAttribute(pos,attr,value){return this.step(new AttrStep(pos,attr,value)),this}setDocAttribute(attr,value){return this.step(new DocAttrStep(attr,value)),this}addNodeMark(pos,mark){return this.step(new AddNodeMarkStep(pos,mark)),this}removeNodeMark(pos,mark){let node=this.doc.nodeAt(pos);if(!node)throw new RangeError("No node at position "+pos);if(mark instanceof prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.CU)mark.isInSet(node.marks)&&this.step(new RemoveNodeMarkStep(pos,mark));else{let found,set=node.marks,steps=[];for(;found=mark.isInSet(set);)steps.push(new RemoveNodeMarkStep(pos,found)),set=found.removeFromSet(set);for(let i=steps.length-1;i>=0;i--)this.step(steps[i])}return this}split(pos,depth=1,typesAfter){return function split(tr,pos,depth=1,typesAfter){let $pos=tr.doc.resolve(pos),before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty,after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.empty;for(let d=$pos.depth,e=$pos.depth-depth,i=depth-1;d>e;d--,i--){before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from($pos.node(d).copy(before));let typeAfter=typesAfter&&typesAfter[i];after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.FK.from(typeAfter?typeAfter.type.create(typeAfter.attrs,after):$pos.node(d).copy(after))}tr.step(new ReplaceStep(pos,pos,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.Ji(before.append(after),depth,depth),!0))}(this,pos,depth,typesAfter),this}addMark(from,to,mark){return function addMark(tr,from,to,mark){let removing,adding,removed=[],added=[];tr.doc.nodesBetween(from,to,(node,pos,parent)=>{if(!node.isInline)return;let marks=node.marks;if(!mark.isInSet(marks)&&parent.type.allowsMarkType(mark.type)){let start=Math.max(pos,from),end=Math.min(pos+node.nodeSize,to),newSet=mark.addToSet(marks);for(let i=0;i<marks.length;i++)marks[i].isInSet(newSet)||(removing&&removing.to==start&&removing.mark.eq(marks[i])?removing.to=end:removed.push(removing=new RemoveMarkStep(start,end,marks[i])));adding&&adding.to==start?adding.to=end:added.push(adding=new AddMarkStep(start,end,mark))}}),removed.forEach(s=>tr.step(s)),added.forEach(s=>tr.step(s))}(this,from,to,mark),this}removeMark(from,to,mark){return function removeMark(tr,from,to,mark){let matched=[],step=0;tr.doc.nodesBetween(from,to,(node,pos)=>{if(!node.isInline)return;step++;let toRemove=null;if(mark instanceof prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.sX){let found,set=node.marks;for(;found=mark.isInSet(set);)(toRemove||(toRemove=[])).push(found),set=found.removeFromSet(set)}else mark?mark.isInSet(node.marks)&&(toRemove=[mark]):toRemove=node.marks;if(toRemove&&toRemove.length){let end=Math.min(pos+node.nodeSize,to);for(let i=0;i<toRemove.length;i++){let found,style=toRemove[i];for(let j=0;j<matched.length;j++){let m=matched[j];m.step==step-1&&style.eq(matched[j].style)&&(found=m)}found?(found.to=end,found.step=step):matched.push({style,from:Math.max(pos,from),to:end,step})}}}),matched.forEach(m=>tr.step(new RemoveMarkStep(m.from,m.to,m.style)))}(this,from,to,mark),this}clearIncompatible(pos,parentType,match){return clearIncompatible(this,pos,parentType,match),this}}},"./node_modules/prosemirror-view/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Lz:()=>EditorView,NZ:()=>Decoration,zF:()=>DecorationSet});var prosemirror_state__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/prosemirror-state/dist/index.js"),prosemirror_model__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prosemirror-model/dist/index.js"),prosemirror_transform__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prosemirror-transform/dist/index.js");const domIndex=function(node){for(var index=0;;index++)if(!(node=node.previousSibling))return index},parentNode=function(node){let parent=node.assignedSlot||node.parentNode;return parent&&11==parent.nodeType?parent.host:parent};let reusedRange=null;const textRange=function(node,from,to){let range=reusedRange||(reusedRange=document.createRange());return range.setEnd(node,null==to?node.nodeValue.length:to),range.setStart(node,from||0),range},isEquivalentPosition=function(node,off,targetNode,targetOff){return targetNode&&(scanFor(node,off,targetNode,targetOff,-1)||scanFor(node,off,targetNode,targetOff,1))},atomElements=/^(img|br|input|textarea|hr)$/i;function scanFor(node,off,targetNode,targetOff,dir){for(var _a;;){if(node==targetNode&&off==targetOff)return!0;if(off==(dir<0?0:nodeSize(node))){let parent=node.parentNode;if(!parent||1!=parent.nodeType||hasBlockDesc(node)||atomElements.test(node.nodeName)||"false"==node.contentEditable)return!1;off=domIndex(node)+(dir<0?0:1),node=parent}else{if(1!=node.nodeType)return!1;{let child=node.childNodes[off+(dir<0?-1:0)];if(1==child.nodeType&&"false"==child.contentEditable){if(!(null===(_a=child.pmViewDesc)||void 0===_a?void 0:_a.ignoreForSelection))return!1;off+=dir}else node=child,off=dir<0?nodeSize(node):0}}}}function nodeSize(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function hasBlockDesc(dom){let desc;for(let cur=dom;cur&&!(desc=cur.pmViewDesc);cur=cur.parentNode);return desc&&desc.node&&desc.node.isBlock&&(desc.dom==dom||desc.contentDOM==dom)}const selectionCollapsed=function(domSel){return domSel.focusNode&&isEquivalentPosition(domSel.focusNode,domSel.focusOffset,domSel.anchorNode,domSel.anchorOffset)};function keyEvent(keyCode,key){let event=document.createEvent("Event");return event.initEvent("keydown",!0,!0),event.keyCode=keyCode,event.key=event.code=key,event}const nav="undefined"!=typeof navigator?navigator:null,doc="undefined"!=typeof document?document:null,agent=nav&&nav.userAgent||"",ie_edge=/Edge\/(\d+)/.exec(agent),ie_upto10=/MSIE \d/.exec(agent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(agent),ie=!!(ie_upto10||ie_11up||ie_edge),ie_version=ie_upto10?document.documentMode:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko=!ie&&/gecko\/(\d+)/i.test(agent);gecko&&(/Firefox\/(\d+)/.exec(agent)||[0,0])[1];const _chrome=!ie&&/Chrome\/(\d+)/.exec(agent),chrome=!!_chrome,chrome_version=_chrome?+_chrome[1]:0,safari=!ie&&!!nav&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(agent)||!!nav&&nav.maxTouchPoints>2),mac=ios||!!nav&&/Mac/.test(nav.platform),windows=!!nav&&/Win/.test(nav.platform),android=/Android \d/.test(agent),webkit=!!doc&&"webkitFontSmoothing"in doc.documentElement.style,webkit_version=webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function windowRect(doc){let vp=doc.defaultView&&doc.defaultView.visualViewport;return vp?{left:0,right:vp.width,top:0,bottom:vp.height}:{left:0,right:doc.documentElement.clientWidth,top:0,bottom:doc.documentElement.clientHeight}}function getSide(value,side){return"number"==typeof value?value:value[side]}function clientRect(node){let rect=node.getBoundingClientRect(),scaleX=rect.width/node.offsetWidth||1,scaleY=rect.height/node.offsetHeight||1;return{left:rect.left,right:rect.left+node.clientWidth*scaleX,top:rect.top,bottom:rect.top+node.clientHeight*scaleY}}function scrollRectIntoView(view,rect,startDOM){let scrollThreshold=view.someProp("scrollThreshold")||0,scrollMargin=view.someProp("scrollMargin")||5,doc=view.dom.ownerDocument;for(let parent=startDOM||view.dom;parent;){if(1!=parent.nodeType){parent=parentNode(parent);continue}let elt=parent,atTop=elt==doc.body,bounding=atTop?windowRect(doc):clientRect(elt),moveX=0,moveY=0;if(rect.top<bounding.top+getSide(scrollThreshold,"top")?moveY=-(bounding.top-rect.top+getSide(scrollMargin,"top")):rect.bottom>bounding.bottom-getSide(scrollThreshold,"bottom")&&(moveY=rect.bottom-rect.top>bounding.bottom-bounding.top?rect.top+getSide(scrollMargin,"top")-bounding.top:rect.bottom-bounding.bottom+getSide(scrollMargin,"bottom")),rect.left<bounding.left+getSide(scrollThreshold,"left")?moveX=-(bounding.left-rect.left+getSide(scrollMargin,"left")):rect.right>bounding.right-getSide(scrollThreshold,"right")&&(moveX=rect.right-bounding.right+getSide(scrollMargin,"right")),moveX||moveY)if(atTop)doc.defaultView.scrollBy(moveX,moveY);else{let startX=elt.scrollLeft,startY=elt.scrollTop;moveY&&(elt.scrollTop+=moveY),moveX&&(elt.scrollLeft+=moveX);let dX=elt.scrollLeft-startX,dY=elt.scrollTop-startY;rect={left:rect.left-dX,top:rect.top-dY,right:rect.right-dX,bottom:rect.bottom-dY}}let pos=atTop?"fixed":getComputedStyle(parent).position;if(/^(fixed|sticky)$/.test(pos))break;parent="absolute"==pos?parent.offsetParent:parentNode(parent)}}function scrollStack(dom){let stack=[],doc=dom.ownerDocument;for(let cur=dom;cur&&(stack.push({dom:cur,top:cur.scrollTop,left:cur.scrollLeft}),dom!=doc);cur=parentNode(cur));return stack}function restoreScrollStack(stack,dTop){for(let i=0;i<stack.length;i++){let{dom,top,left}=stack[i];dom.scrollTop!=top+dTop&&(dom.scrollTop=top+dTop),dom.scrollLeft!=left&&(dom.scrollLeft=left)}}let preventScrollSupported=null;function findOffsetInNode(node,coords){let closest,coordsClosest,firstBelow,coordsBelow,dxClosest=2e8,offset=0,rowBot=coords.top,rowTop=coords.top;for(let child=node.firstChild,childIndex=0;child;child=child.nextSibling,childIndex++){let rects;if(1==child.nodeType)rects=child.getClientRects();else{if(3!=child.nodeType)continue;rects=textRange(child).getClientRects()}for(let i=0;i<rects.length;i++){let rect=rects[i];if(rect.top<=rowBot&&rect.bottom>=rowTop){rowBot=Math.max(rect.bottom,rowBot),rowTop=Math.min(rect.top,rowTop);let dx=rect.left>coords.left?rect.left-coords.left:rect.right<coords.left?coords.left-rect.right:0;if(dx<dxClosest){closest=child,dxClosest=dx,coordsClosest=dx&&3==closest.nodeType?{left:rect.right<coords.left?rect.right:rect.left,top:coords.top}:coords,1==child.nodeType&&dx&&(offset=childIndex+(coords.left>=(rect.left+rect.right)/2?1:0));continue}}else rect.top>coords.top&&!firstBelow&&rect.left<=coords.left&&rect.right>=coords.left&&(firstBelow=child,coordsBelow={left:Math.max(rect.left,Math.min(rect.right,coords.left)),top:rect.top});!closest&&(coords.left>=rect.right&&coords.top>=rect.top||coords.left>=rect.left&&coords.top>=rect.bottom)&&(offset=childIndex+1)}}return!closest&&firstBelow&&(closest=firstBelow,coordsClosest=coordsBelow,dxClosest=0),closest&&3==closest.nodeType?function findOffsetInText(node,coords){let len=node.nodeValue.length,range=document.createRange();for(let i=0;i<len;i++){range.setEnd(node,i+1),range.setStart(node,i);let rect=singleRect(range,1);if(rect.top!=rect.bottom&&inRect(coords,rect))return{node,offset:i+(coords.left>=(rect.left+rect.right)/2?1:0)}}return{node,offset:0}}(closest,coordsClosest):!closest||dxClosest&&1==closest.nodeType?{node,offset}:findOffsetInNode(closest,coordsClosest)}function inRect(coords,rect){return coords.left>=rect.left-1&&coords.left<=rect.right+1&&coords.top>=rect.top-1&&coords.top<=rect.bottom+1}function elementFromPoint(element,coords,box){let len=element.childNodes.length;if(len&&box.top<box.bottom)for(let startI=Math.max(0,Math.min(len-1,Math.floor(len*(coords.top-box.top)/(box.bottom-box.top))-2)),i=startI;;){let child=element.childNodes[i];if(1==child.nodeType){let rects=child.getClientRects();for(let j=0;j<rects.length;j++){let rect=rects[j];if(inRect(coords,rect))return elementFromPoint(child,coords,rect)}}if((i=(i+1)%len)==startI)break}return element}function posAtCoords(view,coords){let node,doc=view.dom.ownerDocument,offset=0,caret=function caretFromPoint(doc,x,y){if(doc.caretPositionFromPoint)try{let pos=doc.caretPositionFromPoint(x,y);if(pos)return{node:pos.offsetNode,offset:Math.min(nodeSize(pos.offsetNode),pos.offset)}}catch(_){}if(doc.caretRangeFromPoint){let range=doc.caretRangeFromPoint(x,y);if(range)return{node:range.startContainer,offset:Math.min(nodeSize(range.startContainer),range.startOffset)}}}(doc,coords.left,coords.top);caret&&({node,offset}=caret);let pos,elt=(view.root.elementFromPoint?view.root:doc).elementFromPoint(coords.left,coords.top);if(!elt||!view.dom.contains(1!=elt.nodeType?elt.parentNode:elt)){let box=view.dom.getBoundingClientRect();if(!inRect(coords,box))return null;if(elt=elementFromPoint(view.dom,coords,box),!elt)return null}if(safari)for(let p=elt;node&&p;p=parentNode(p))p.draggable&&(node=void 0);if(elt=function targetKludge(dom,coords){let parent=dom.parentNode;return parent&&/^li$/i.test(parent.nodeName)&&coords.left<dom.getBoundingClientRect().left?parent:dom}(elt,coords),node){if(gecko&&1==node.nodeType&&(offset=Math.min(offset,node.childNodes.length),offset<node.childNodes.length)){let box,next=node.childNodes[offset];"IMG"==next.nodeName&&(box=next.getBoundingClientRect()).right<=coords.left&&box.bottom>coords.top&&offset++}let prev;webkit&&offset&&1==node.nodeType&&1==(prev=node.childNodes[offset-1]).nodeType&&"false"==prev.contentEditable&&prev.getBoundingClientRect().top>=coords.top&&offset--,node==view.dom&&offset==node.childNodes.length-1&&1==node.lastChild.nodeType&&coords.top>node.lastChild.getBoundingClientRect().bottom?pos=view.state.doc.content.size:0!=offset&&1==node.nodeType&&"BR"==node.childNodes[offset-1].nodeName||(pos=function posFromCaret(view,node,offset,coords){let outsideBlock=-1;for(let cur=node,sawBlock=!1;cur!=view.dom;){let rect,desc=view.docView.nearestDesc(cur,!0);if(!desc)return null;if(1==desc.dom.nodeType&&(desc.node.isBlock&&desc.parent||!desc.contentDOM)&&((rect=desc.dom.getBoundingClientRect()).width||rect.height)&&(desc.node.isBlock&&desc.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(desc.dom.nodeName)&&(!sawBlock&&rect.left>coords.left||rect.top>coords.top?outsideBlock=desc.posBefore:(!sawBlock&&rect.right<coords.left||rect.bottom<coords.top)&&(outsideBlock=desc.posAfter),sawBlock=!0),!desc.contentDOM&&outsideBlock<0&&!desc.node.isText))return(desc.node.isBlock?coords.top<(rect.top+rect.bottom)/2:coords.left<(rect.left+rect.right)/2)?desc.posBefore:desc.posAfter;cur=desc.dom.parentNode}return outsideBlock>-1?outsideBlock:view.docView.posFromDOM(node,offset,-1)}(view,node,offset,coords))}null==pos&&(pos=function posFromElement(view,elt,coords){let{node,offset}=findOffsetInNode(elt,coords),bias=-1;if(1==node.nodeType&&!node.firstChild){let rect=node.getBoundingClientRect();bias=rect.left!=rect.right&&coords.left>(rect.left+rect.right)/2?1:-1}return view.docView.posFromDOM(node,offset,bias)}(view,elt,coords));let desc=view.docView.nearestDesc(elt,!0);return{pos,inside:desc?desc.posAtStart-desc.border:-1}}function nonZero(rect){return rect.top<rect.bottom||rect.left<rect.right}function singleRect(target,bias){let rects=target.getClientRects();if(rects.length){let first=rects[bias<0?0:rects.length-1];if(nonZero(first))return first}return Array.prototype.find.call(rects,nonZero)||target.getBoundingClientRect()}const BIDI=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function coordsAtPos(view,pos,side){let{node,offset,atom}=view.docView.domFromPos(pos,side<0?-1:1),supportEmptyRange=webkit||gecko;if(3==node.nodeType){if(!supportEmptyRange||!BIDI.test(node.nodeValue)&&(side<0?offset:offset!=node.nodeValue.length)){let from=offset,to=offset,takeSide=side<0?1:-1;return side<0&&!offset?(to++,takeSide=-1):side>=0&&offset==node.nodeValue.length?(from--,takeSide=1):side<0?from--:to++,flattenV(singleRect(textRange(node,from,to),takeSide),takeSide<0)}{let rect=singleRect(textRange(node,offset,offset),side);if(gecko&&offset&&/\s/.test(node.nodeValue[offset-1])&&offset<node.nodeValue.length){let rectBefore=singleRect(textRange(node,offset-1,offset-1),-1);if(rectBefore.top==rect.top){let rectAfter=singleRect(textRange(node,offset,offset+1),-1);if(rectAfter.top!=rect.top)return flattenV(rectAfter,rectAfter.left<rectBefore.left)}}return rect}}if(!view.state.doc.resolve(pos-(atom||0)).parent.inlineContent){if(null==atom&&offset&&(side<0||offset==nodeSize(node))){let before=node.childNodes[offset-1];if(1==before.nodeType)return flattenH(before.getBoundingClientRect(),!1)}if(null==atom&&offset<nodeSize(node)){let after=node.childNodes[offset];if(1==after.nodeType)return flattenH(after.getBoundingClientRect(),!0)}return flattenH(node.getBoundingClientRect(),side>=0)}if(null==atom&&offset&&(side<0||offset==nodeSize(node))){let before=node.childNodes[offset-1],target=3==before.nodeType?textRange(before,nodeSize(before)-(supportEmptyRange?0:1)):1!=before.nodeType||"BR"==before.nodeName&&before.nextSibling?null:before;if(target)return flattenV(singleRect(target,1),!1)}if(null==atom&&offset<nodeSize(node)){let after=node.childNodes[offset];for(;after.pmViewDesc&&after.pmViewDesc.ignoreForCoords;)after=after.nextSibling;let target=after?3==after.nodeType?textRange(after,0,supportEmptyRange?0:1):1==after.nodeType?after:null:null;if(target)return flattenV(singleRect(target,-1),!0)}return flattenV(singleRect(3==node.nodeType?textRange(node):node,-side),side>=0)}function flattenV(rect,left){if(0==rect.width)return rect;let x=left?rect.left:rect.right;return{top:rect.top,bottom:rect.bottom,left:x,right:x}}function flattenH(rect,top){if(0==rect.height)return rect;let y=top?rect.top:rect.bottom;return{top:y,bottom:y,left:rect.left,right:rect.right}}function withFlushedState(view,state,f){let viewState=view.state,active=view.root.activeElement;viewState!=state&&view.updateState(state),active!=view.dom&&view.focus();try{return f()}finally{viewState!=state&&view.updateState(viewState),active!=view.dom&&active&&active.focus()}}const maybeRTL=/[\u0590-\u08ac]/;let cachedState=null,cachedDir=null,cachedResult=!1;function endOfTextblock(view,state,dir){return cachedState==state&&cachedDir==dir?cachedResult:(cachedState=state,cachedDir=dir,cachedResult="up"==dir||"down"==dir?function endOfTextblockVertical(view,state,dir){let sel=state.selection,$pos="up"==dir?sel.$from:sel.$to;return withFlushedState(view,state,()=>{let{node:dom}=view.docView.domFromPos($pos.pos,"up"==dir?-1:1);for(;;){let nearest=view.docView.nearestDesc(dom,!0);if(!nearest)break;if(nearest.node.isBlock){dom=nearest.contentDOM||nearest.dom;break}dom=nearest.dom.parentNode}let coords=coordsAtPos(view,$pos.pos,1);for(let child=dom.firstChild;child;child=child.nextSibling){let boxes;if(1==child.nodeType)boxes=child.getClientRects();else{if(3!=child.nodeType)continue;boxes=textRange(child,0,child.nodeValue.length).getClientRects()}for(let i=0;i<boxes.length;i++){let box=boxes[i];if(box.bottom>box.top+1&&("up"==dir?coords.top-box.top>2*(box.bottom-coords.top):box.bottom-coords.bottom>2*(coords.bottom-box.top)))return!1}}return!0})}(view,state,dir):function endOfTextblockHorizontal(view,state,dir){let{$head}=state.selection;if(!$head.parent.isTextblock)return!1;let offset=$head.parentOffset,atStart=!offset,atEnd=offset==$head.parent.content.size,sel=view.domSelection();return sel?maybeRTL.test($head.parent.textContent)&&sel.modify?withFlushedState(view,state,()=>{let{focusNode:oldNode,focusOffset:oldOff,anchorNode,anchorOffset}=view.domSelectionRange(),oldBidiLevel=sel.caretBidiLevel;sel.modify("move",dir,"character");let parentDOM=$head.depth?view.docView.domAfterPos($head.before()):view.dom,{focusNode:newNode,focusOffset:newOff}=view.domSelectionRange(),result=newNode&&!parentDOM.contains(1==newNode.nodeType?newNode:newNode.parentNode)||oldNode==newNode&&oldOff==newOff;try{sel.collapse(anchorNode,anchorOffset),oldNode&&(oldNode!=anchorNode||oldOff!=anchorOffset)&&sel.extend&&sel.extend(oldNode,oldOff)}catch(_){}return null!=oldBidiLevel&&(sel.caretBidiLevel=oldBidiLevel),result}):"left"==dir||"backward"==dir?atStart:atEnd:$head.pos==$head.start()||$head.pos==$head.end()}(view,state,dir))}class ViewDesc{constructor(parent,children,dom,contentDOM){this.parent=parent,this.children=children,this.dom=dom,this.contentDOM=contentDOM,this.dirty=0,dom.pmViewDesc=this}matchesWidget(widget){return!1}matchesMark(mark){return!1}matchesNode(node,outerDeco,innerDeco){return!1}matchesHack(nodeName){return!1}parseRule(){return null}stopEvent(event){return!1}get size(){let size=0;for(let i=0;i<this.children.length;i++)size+=this.children[i].size;return size}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let i=0;i<this.children.length;i++)this.children[i].destroy()}posBeforeChild(child){for(let i=0,pos=this.posAtStart;;i++){let cur=this.children[i];if(cur==child)return pos;pos+=cur.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(dom,offset,bias){if(this.contentDOM&&this.contentDOM.contains(1==dom.nodeType?dom:dom.parentNode)){if(bias<0){let domBefore,desc;if(dom==this.contentDOM)domBefore=dom.childNodes[offset-1];else{for(;dom.parentNode!=this.contentDOM;)dom=dom.parentNode;domBefore=dom.previousSibling}for(;domBefore&&(!(desc=domBefore.pmViewDesc)||desc.parent!=this);)domBefore=domBefore.previousSibling;return domBefore?this.posBeforeChild(desc)+desc.size:this.posAtStart}{let domAfter,desc;if(dom==this.contentDOM)domAfter=dom.childNodes[offset];else{for(;dom.parentNode!=this.contentDOM;)dom=dom.parentNode;domAfter=dom.nextSibling}for(;domAfter&&(!(desc=domAfter.pmViewDesc)||desc.parent!=this);)domAfter=domAfter.nextSibling;return domAfter?this.posBeforeChild(desc):this.posAtEnd}}let atEnd;if(dom==this.dom&&this.contentDOM)atEnd=offset>domIndex(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))atEnd=2&dom.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==offset)for(let search=dom;;search=search.parentNode){if(search==this.dom){atEnd=!1;break}if(search.previousSibling)break}if(null==atEnd&&offset==dom.childNodes.length)for(let search=dom;;search=search.parentNode){if(search==this.dom){atEnd=!0;break}if(search.nextSibling)break}}return(null==atEnd?bias>0:atEnd)?this.posAtEnd:this.posAtStart}nearestDesc(dom,onlyNodes=!1){for(let first=!0,cur=dom;cur;cur=cur.parentNode){let nodeDOM,desc=this.getDesc(cur);if(desc&&(!onlyNodes||desc.node)){if(!first||!(nodeDOM=desc.nodeDOM)||(1==nodeDOM.nodeType?nodeDOM.contains(1==dom.nodeType?dom:dom.parentNode):nodeDOM==dom))return desc;first=!1}}}getDesc(dom){let desc=dom.pmViewDesc;for(let cur=desc;cur;cur=cur.parent)if(cur==this)return desc}posFromDOM(dom,offset,bias){for(let scan=dom;scan;scan=scan.parentNode){let desc=this.getDesc(scan);if(desc)return desc.localPosFromDOM(dom,offset,bias)}return-1}descAt(pos){for(let i=0,offset=0;i<this.children.length;i++){let child=this.children[i],end=offset+child.size;if(offset==pos&&end!=offset){for(;!child.border&&child.children.length;)for(let i=0;i<child.children.length;i++){let inner=child.children[i];if(inner.size){child=inner;break}}return child}if(pos<end)return child.descAt(pos-offset-child.border);offset=end}}domFromPos(pos,side){if(!this.contentDOM)return{node:this.dom,offset:0,atom:pos+1};let i=0,offset=0;for(let curPos=0;i<this.children.length;i++){let child=this.children[i],end=curPos+child.size;if(end>pos||child instanceof TrailingHackViewDesc){offset=pos-curPos;break}curPos=end}if(offset)return this.children[i].domFromPos(offset-this.children[i].border,side);for(let prev;i&&!(prev=this.children[i-1]).size&&prev instanceof WidgetViewDesc&&prev.side>=0;i--);if(side<=0){let prev,enter=!0;for(;prev=i?this.children[i-1]:null,prev&&prev.dom.parentNode!=this.contentDOM;i--,enter=!1);return prev&&side&&enter&&!prev.border&&!prev.domAtom?prev.domFromPos(prev.size,side):{node:this.contentDOM,offset:prev?domIndex(prev.dom)+1:0}}{let next,enter=!0;for(;next=i<this.children.length?this.children[i]:null,next&&next.dom.parentNode!=this.contentDOM;i++,enter=!1);return next&&enter&&!next.border&&!next.domAtom?next.domFromPos(0,side):{node:this.contentDOM,offset:next?domIndex(next.dom):this.contentDOM.childNodes.length}}}parseRange(from,to,base=0){if(0==this.children.length)return{node:this.contentDOM,from,to,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let fromOffset=-1,toOffset=-1;for(let offset=base,i=0;;i++){let child=this.children[i],end=offset+child.size;if(-1==fromOffset&&from<=end){let childBase=offset+child.border;if(from>=childBase&&to<=end-child.border&&child.node&&child.contentDOM&&this.contentDOM.contains(child.contentDOM))return child.parseRange(from,to,childBase);from=offset;for(let j=i;j>0;j--){let prev=this.children[j-1];if(prev.size&&prev.dom.parentNode==this.contentDOM&&!prev.emptyChildAt(1)){fromOffset=domIndex(prev.dom)+1;break}from-=prev.size}-1==fromOffset&&(fromOffset=0)}if(fromOffset>-1&&(end>to||i==this.children.length-1)){to=end;for(let j=i+1;j<this.children.length;j++){let next=this.children[j];if(next.size&&next.dom.parentNode==this.contentDOM&&!next.emptyChildAt(-1)){toOffset=domIndex(next.dom);break}to+=next.size}-1==toOffset&&(toOffset=this.contentDOM.childNodes.length);break}offset=end}return{node:this.contentDOM,from,to,fromOffset,toOffset}}emptyChildAt(side){if(this.border||!this.contentDOM||!this.children.length)return!1;let child=this.children[side<0?0:this.children.length-1];return 0==child.size||child.emptyChildAt(side)}domAfterPos(pos){let{node,offset}=this.domFromPos(pos,0);if(1!=node.nodeType||offset==node.childNodes.length)throw new RangeError("No node after pos "+pos);return node.childNodes[offset]}setSelection(anchor,head,view,force=!1){let from=Math.min(anchor,head),to=Math.max(anchor,head);for(let i=0,offset=0;i<this.children.length;i++){let child=this.children[i],end=offset+child.size;if(from>offset&&to<end)return child.setSelection(anchor-offset-child.border,head-offset-child.border,view,force);offset=end}let anchorDOM=this.domFromPos(anchor,anchor?-1:1),headDOM=head==anchor?anchorDOM:this.domFromPos(head,head?-1:1),domSel=view.root.getSelection(),selRange=view.domSelectionRange(),brKludge=!1;if((gecko||safari)&&anchor==head){let{node,offset}=anchorDOM;if(3==node.nodeType){if(brKludge=!(!offset||"\n"!=node.nodeValue[offset-1]),brKludge&&offset==node.nodeValue.length)for(let after,scan=node;scan;scan=scan.parentNode){if(after=scan.nextSibling){"BR"==after.nodeName&&(anchorDOM=headDOM={node:after.parentNode,offset:domIndex(after)+1});break}let desc=scan.pmViewDesc;if(desc&&desc.node&&desc.node.isBlock)break}}else{let prev=node.childNodes[offset-1];brKludge=prev&&("BR"==prev.nodeName||"false"==prev.contentEditable)}}if(gecko&&selRange.focusNode&&selRange.focusNode!=headDOM.node&&1==selRange.focusNode.nodeType){let after=selRange.focusNode.childNodes[selRange.focusOffset];after&&"false"==after.contentEditable&&(force=!0)}if(!(force||brKludge&&safari)&&isEquivalentPosition(anchorDOM.node,anchorDOM.offset,selRange.anchorNode,selRange.anchorOffset)&&isEquivalentPosition(headDOM.node,headDOM.offset,selRange.focusNode,selRange.focusOffset))return;let domSelExtended=!1;if((domSel.extend||anchor==head)&&(!brKludge||!gecko)){domSel.collapse(anchorDOM.node,anchorDOM.offset);try{anchor!=head&&domSel.extend(headDOM.node,headDOM.offset),domSelExtended=!0}catch(_){}}if(!domSelExtended){if(anchor>head){let tmp=anchorDOM;anchorDOM=headDOM,headDOM=tmp}let range=document.createRange();range.setEnd(headDOM.node,headDOM.offset),range.setStart(anchorDOM.node,anchorDOM.offset),domSel.removeAllRanges(),domSel.addRange(range)}}ignoreMutation(mutation){return!this.contentDOM&&"selection"!=mutation.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(from,to){for(let offset=0,i=0;i<this.children.length;i++){let child=this.children[i],end=offset+child.size;if(offset==end?from<=end&&to>=offset:from<end&&to>offset){let startInside=offset+child.border,endInside=end-child.border;if(from>=startInside&&to<=endInside)return this.dirty=from==offset||to==end?2:1,void(from!=startInside||to!=endInside||!child.contentLost&&child.dom.parentNode==this.contentDOM?child.markDirty(from-startInside,to-startInside):child.dirty=3);child.dirty=child.dom!=child.contentDOM||child.dom.parentNode!=this.contentDOM||child.children.length?3:2}offset=end}this.dirty=2}markParentsDirty(){let level=1;for(let node=this.parent;node;node=node.parent,level++){let dirty=1==level?2:1;node.dirty<dirty&&(node.dirty=dirty)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(text){return!1}}class WidgetViewDesc extends ViewDesc{constructor(parent,widget,view,pos){let self,dom=widget.type.toDOM;if("function"==typeof dom&&(dom=dom(view,()=>self?self.parent?self.parent.posBeforeChild(self):void 0:pos)),!widget.type.spec.raw){if(1!=dom.nodeType){let wrap=document.createElement("span");wrap.appendChild(dom),dom=wrap}dom.contentEditable="false",dom.classList.add("ProseMirror-widget")}super(parent,[],dom,null),this.widget=widget,this.widget=widget,self=this}matchesWidget(widget){return 0==this.dirty&&widget.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(event){let stop=this.widget.spec.stopEvent;return!!stop&&stop(event)}ignoreMutation(mutation){return"selection"!=mutation.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class CompositionViewDesc extends ViewDesc{constructor(parent,dom,textDOM,text){super(parent,[],dom,null),this.textDOM=textDOM,this.text=text}get size(){return this.text.length}localPosFromDOM(dom,offset){return dom!=this.textDOM?this.posAtStart+(offset?this.size:0):this.posAtStart+offset}domFromPos(pos){return{node:this.textDOM,offset:pos}}ignoreMutation(mut){return"characterData"===mut.type&&mut.target.nodeValue==mut.oldValue}}class MarkViewDesc extends ViewDesc{constructor(parent,mark,dom,contentDOM,spec){super(parent,[],dom,contentDOM),this.mark=mark,this.spec=spec}static create(parent,mark,inline,view){let custom=view.nodeViews[mark.type.name],spec=custom&&custom(mark,view,inline);return spec&&spec.dom||(spec=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.ZF.renderSpec(document,mark.type.spec.toDOM(mark,inline),null,mark.attrs)),new MarkViewDesc(parent,mark,spec.dom,spec.contentDOM||spec.dom,spec)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(mark){return 3!=this.dirty&&this.mark.eq(mark)}markDirty(from,to){if(super.markDirty(from,to),0!=this.dirty){let parent=this.parent;for(;!parent.node;)parent=parent.parent;parent.dirty<this.dirty&&(parent.dirty=this.dirty),this.dirty=0}}slice(from,to,view){let copy=MarkViewDesc.create(this.parent,this.mark,!0,view),nodes=this.children,size=this.size;to<size&&(nodes=replaceNodes(nodes,to,size,view)),from>0&&(nodes=replaceNodes(nodes,0,from,view));for(let i=0;i<nodes.length;i++)nodes[i].parent=copy;return copy.children=nodes,copy}ignoreMutation(mutation){return this.spec.ignoreMutation?this.spec.ignoreMutation(mutation):super.ignoreMutation(mutation)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class NodeViewDesc extends ViewDesc{constructor(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos){super(parent,[],dom,contentDOM),this.node=node,this.outerDeco=outerDeco,this.innerDeco=innerDeco,this.nodeDOM=nodeDOM}static create(parent,node,outerDeco,innerDeco,view,pos){let descObj,custom=view.nodeViews[node.type.name],spec=custom&&custom(node,view,()=>descObj?descObj.parent?descObj.parent.posBeforeChild(descObj):void 0:pos,outerDeco,innerDeco),dom=spec&&spec.dom,contentDOM=spec&&spec.contentDOM;if(node.isText)if(dom){if(3!=dom.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else dom=document.createTextNode(node.text);else if(!dom){let spec=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.ZF.renderSpec(document,node.type.spec.toDOM(node),null,node.attrs);({dom,contentDOM}=spec)}contentDOM||node.isText||"BR"==dom.nodeName||(dom.hasAttribute("contenteditable")||(dom.contentEditable="false"),node.type.spec.draggable&&(dom.draggable=!0));let nodeDOM=dom;return dom=applyOuterDeco(dom,outerDeco,node),spec?descObj=new CustomNodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM||null,nodeDOM,spec,view,pos+1):node.isText?new TextViewDesc(parent,node,outerDeco,innerDeco,dom,nodeDOM,view):new NodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM||null,nodeDOM,view,pos+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let rule={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(rule.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let i=this.children.length-1;i>=0;i--){let child=this.children[i];if(this.dom.contains(child.dom.parentNode)){rule.contentElement=child.dom.parentNode;break}}rule.contentElement||(rule.getContent=()=>prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.empty)}else rule.contentElement=this.contentDOM;else rule.getContent=()=>this.node.content;return rule}matchesNode(node,outerDeco,innerDeco){return 0==this.dirty&&node.eq(this.node)&&sameOuterDeco(outerDeco,this.outerDeco)&&innerDeco.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(view,pos){let inline=this.node.inlineContent,off=pos,composition=view.composing?this.localCompositionInfo(view,pos):null,localComposition=composition&&composition.pos>-1?composition:null,compositionInChild=composition&&composition.pos<0,updater=new ViewTreeUpdater(this,localComposition&&localComposition.node,view);!function iterDeco(parent,deco,onWidget,onNode){let locals=deco.locals(parent),offset=0;if(0==locals.length){for(let i=0;i<parent.childCount;i++){let child=parent.child(i);onNode(child,locals,deco.forChild(offset,child),i),offset+=child.nodeSize}return}let decoIndex=0,active=[],restNode=null;for(let parentIndex=0;;){let widget,widgets,child,index;for(;decoIndex<locals.length&&locals[decoIndex].to==offset;){let next=locals[decoIndex++];next.widget&&(widget?(widgets||(widgets=[widget])).push(next):widget=next)}if(widget)if(widgets){widgets.sort(compareSide);for(let i=0;i<widgets.length;i++)onWidget(widgets[i],parentIndex,!!restNode)}else onWidget(widget,parentIndex,!!restNode);if(restNode)index=-1,child=restNode,restNode=null;else{if(!(parentIndex<parent.childCount))break;index=parentIndex,child=parent.child(parentIndex++)}for(let i=0;i<active.length;i++)active[i].to<=offset&&active.splice(i--,1);for(;decoIndex<locals.length&&locals[decoIndex].from<=offset&&locals[decoIndex].to>offset;)active.push(locals[decoIndex++]);let end=offset+child.nodeSize;if(child.isText){let cutAt=end;decoIndex<locals.length&&locals[decoIndex].from<cutAt&&(cutAt=locals[decoIndex].from);for(let i=0;i<active.length;i++)active[i].to<cutAt&&(cutAt=active[i].to);cutAt<end&&(restNode=child.cut(cutAt-offset),child=child.cut(0,cutAt-offset),end=cutAt,index=-1)}else for(;decoIndex<locals.length&&locals[decoIndex].to<end;)decoIndex++;onNode(child,child.isInline&&!child.isLeaf?active.filter(d=>!d.inline):active.slice(),deco.forChild(offset,child),index),offset=end}}(this.node,this.innerDeco,(widget,i,insideNode)=>{widget.spec.marks?updater.syncToMarks(widget.spec.marks,inline,view):widget.type.side>=0&&!insideNode&&updater.syncToMarks(i==this.node.childCount?prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.CU.none:this.node.child(i).marks,inline,view),updater.placeWidget(widget,view,off)},(child,outerDeco,innerDeco,i)=>{let compIndex;updater.syncToMarks(child.marks,inline,view),updater.findNodeMatch(child,outerDeco,innerDeco,i)||compositionInChild&&view.state.selection.from>off&&view.state.selection.to<off+child.nodeSize&&(compIndex=updater.findIndexWithChild(composition.node))>-1&&updater.updateNodeAt(child,outerDeco,innerDeco,compIndex,view)||updater.updateNextNode(child,outerDeco,innerDeco,view,i,off)||updater.addNode(child,outerDeco,innerDeco,view,off),off+=child.nodeSize}),updater.syncToMarks([],inline,view),this.node.isTextblock&&updater.addTextblockHacks(),updater.destroyRest(),(updater.changed||2==this.dirty)&&(localComposition&&this.protectLocalComposition(view,localComposition),renderDescs(this.contentDOM,this.children,view),ios&&function iosHacks(dom){if("UL"==dom.nodeName||"OL"==dom.nodeName){let oldCSS=dom.style.cssText;dom.style.cssText=oldCSS+"; list-style: square !important",window.getComputedStyle(dom).listStyle,dom.style.cssText=oldCSS}}(this.dom))}localCompositionInfo(view,pos){let{from,to}=view.state.selection;if(!(view.state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3)||from<pos||to>pos+this.node.content.size)return null;let textNode=view.input.compositionNode;if(!textNode||!this.dom.contains(textNode.parentNode))return null;if(this.node.inlineContent){let text=textNode.nodeValue,textPos=function findTextInFragment(frag,text,from,to){for(let i=0,pos=0;i<frag.childCount&&pos<=to;){let child=frag.child(i++),childStart=pos;if(pos+=child.nodeSize,!child.isText)continue;let str=child.text;for(;i<frag.childCount;){let next=frag.child(i++);if(pos+=next.nodeSize,!next.isText)break;str+=next.text}if(pos>=from){if(pos>=to&&str.slice(to-text.length-childStart,to-childStart)==text)return to-text.length;let found=childStart<to?str.lastIndexOf(text,to-childStart-1):-1;if(found>=0&&found+text.length+childStart>=from)return childStart+found;if(from==to&&str.length>=to+text.length-childStart&&str.slice(to-childStart,to-childStart+text.length)==text)return to}}return-1}(this.node.content,text,from-pos,to-pos);return textPos<0?null:{node:textNode,pos:textPos,text}}return{node:textNode,pos:-1,text:""}}protectLocalComposition(view,{node,pos,text}){if(this.getDesc(node))return;let topNode=node;for(;topNode.parentNode!=this.contentDOM;topNode=topNode.parentNode){for(;topNode.previousSibling;)topNode.parentNode.removeChild(topNode.previousSibling);for(;topNode.nextSibling;)topNode.parentNode.removeChild(topNode.nextSibling);topNode.pmViewDesc&&(topNode.pmViewDesc=void 0)}let desc=new CompositionViewDesc(this,topNode,node,text);view.input.compositionNodes.push(desc),this.children=replaceNodes(this.children,pos,pos+text.length,view,desc)}update(node,outerDeco,innerDeco,view){return!(3==this.dirty||!node.sameMarkup(this.node))&&(this.updateInner(node,outerDeco,innerDeco,view),!0)}updateInner(node,outerDeco,innerDeco,view){this.updateOuterDeco(outerDeco),this.node=node,this.innerDeco=innerDeco,this.contentDOM&&this.updateChildren(view,this.posAtStart),this.dirty=0}updateOuterDeco(outerDeco){if(sameOuterDeco(outerDeco,this.outerDeco))return;let needsWrap=1!=this.nodeDOM.nodeType,oldDOM=this.dom;this.dom=patchOuterDeco(this.dom,this.nodeDOM,computeOuterDeco(this.outerDeco,this.node,needsWrap),computeOuterDeco(outerDeco,this.node,needsWrap)),this.dom!=oldDOM&&(oldDOM.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=outerDeco}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function docViewDesc(doc,outerDeco,innerDeco,dom,view){applyOuterDeco(dom,outerDeco,doc);let docView=new NodeViewDesc(void 0,doc,outerDeco,innerDeco,dom,dom,dom,view,0);return docView.contentDOM&&docView.updateChildren(view,0),docView}class TextViewDesc extends NodeViewDesc{constructor(parent,node,outerDeco,innerDeco,dom,nodeDOM,view){super(parent,node,outerDeco,innerDeco,dom,null,nodeDOM,view,0)}parseRule(){let skip=this.nodeDOM.parentNode;for(;skip&&skip!=this.dom&&!skip.pmIsDeco;)skip=skip.parentNode;return{skip:skip||!0}}update(node,outerDeco,innerDeco,view){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!node.sameMarkup(this.node))&&(this.updateOuterDeco(outerDeco),0==this.dirty&&node.text==this.node.text||node.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=node.text,view.trackWrites==this.nodeDOM&&(view.trackWrites=null)),this.node=node,this.dirty=0,!0)}inParent(){let parentDOM=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==parentDOM)return!0;return!1}domFromPos(pos){return{node:this.nodeDOM,offset:pos}}localPosFromDOM(dom,offset,bias){return dom==this.nodeDOM?this.posAtStart+Math.min(offset,this.node.text.length):super.localPosFromDOM(dom,offset,bias)}ignoreMutation(mutation){return"characterData"!=mutation.type&&"selection"!=mutation.type}slice(from,to,view){let node=this.node.cut(from,to),dom=document.createTextNode(node.text);return new TextViewDesc(this.parent,node,this.outerDeco,this.innerDeco,dom,dom,view)}markDirty(from,to){super.markDirty(from,to),this.dom==this.nodeDOM||0!=from&&to!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(text){return this.node.text==text}}class TrailingHackViewDesc extends ViewDesc{parseRule(){return{ignore:!0}}matchesHack(nodeName){return 0==this.dirty&&this.dom.nodeName==nodeName}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class CustomNodeViewDesc extends NodeViewDesc{constructor(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,spec,view,pos){super(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos),this.spec=spec}update(node,outerDeco,innerDeco,view){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==node.type||this.spec.multiType)){let result=this.spec.update(node,outerDeco,innerDeco);return result&&this.updateInner(node,outerDeco,innerDeco,view),result}return!(!this.contentDOM&&!node.isLeaf)&&super.update(node,outerDeco,innerDeco,view)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(anchor,head,view,force){this.spec.setSelection?this.spec.setSelection(anchor,head,view.root):super.setSelection(anchor,head,view,force)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(event){return!!this.spec.stopEvent&&this.spec.stopEvent(event)}ignoreMutation(mutation){return this.spec.ignoreMutation?this.spec.ignoreMutation(mutation):super.ignoreMutation(mutation)}}function renderDescs(parentDOM,descs,view){let dom=parentDOM.firstChild,written=!1;for(let i=0;i<descs.length;i++){let desc=descs[i],childDOM=desc.dom;if(childDOM.parentNode==parentDOM){for(;childDOM!=dom;)dom=rm(dom),written=!0;dom=dom.nextSibling}else written=!0,parentDOM.insertBefore(childDOM,dom);if(desc instanceof MarkViewDesc){let pos=dom?dom.previousSibling:parentDOM.lastChild;renderDescs(desc.contentDOM,desc.children,view),dom=pos?pos.nextSibling:parentDOM.firstChild}}for(;dom;)dom=rm(dom),written=!0;written&&view.trackWrites==parentDOM&&(view.trackWrites=null)}const OuterDecoLevel=function(nodeName){nodeName&&(this.nodeName=nodeName)};OuterDecoLevel.prototype=Object.create(null);const noDeco=[new OuterDecoLevel];function computeOuterDeco(outerDeco,node,needsWrap){if(0==outerDeco.length)return noDeco;let top=needsWrap?noDeco[0]:new OuterDecoLevel,result=[top];for(let i=0;i<outerDeco.length;i++){let attrs=outerDeco[i].type.attrs;if(attrs){attrs.nodeName&&result.push(top=new OuterDecoLevel(attrs.nodeName));for(let name in attrs){let val=attrs[name];null!=val&&(needsWrap&&1==result.length&&result.push(top=new OuterDecoLevel(node.isInline?"span":"div")),"class"==name?top.class=(top.class?top.class+" ":"")+val:"style"==name?top.style=(top.style?top.style+";":"")+val:"nodeName"!=name&&(top[name]=val))}}}return result}function patchOuterDeco(outerDOM,nodeDOM,prevComputed,curComputed){if(prevComputed==noDeco&&curComputed==noDeco)return nodeDOM;let curDOM=nodeDOM;for(let i=0;i<curComputed.length;i++){let deco=curComputed[i],prev=prevComputed[i];if(i){let parent;prev&&prev.nodeName==deco.nodeName&&curDOM!=outerDOM&&(parent=curDOM.parentNode)&&parent.nodeName.toLowerCase()==deco.nodeName||(parent=document.createElement(deco.nodeName),parent.pmIsDeco=!0,parent.appendChild(curDOM),prev=noDeco[0]),curDOM=parent}patchAttributes(curDOM,prev||noDeco[0],deco)}return curDOM}function patchAttributes(dom,prev,cur){for(let name in prev)"class"==name||"style"==name||"nodeName"==name||name in cur||dom.removeAttribute(name);for(let name in cur)"class"!=name&&"style"!=name&&"nodeName"!=name&&cur[name]!=prev[name]&&dom.setAttribute(name,cur[name]);if(prev.class!=cur.class){let prevList=prev.class?prev.class.split(" ").filter(Boolean):[],curList=cur.class?cur.class.split(" ").filter(Boolean):[];for(let i=0;i<prevList.length;i++)-1==curList.indexOf(prevList[i])&&dom.classList.remove(prevList[i]);for(let i=0;i<curList.length;i++)-1==prevList.indexOf(curList[i])&&dom.classList.add(curList[i]);0==dom.classList.length&&dom.removeAttribute("class")}if(prev.style!=cur.style){if(prev.style){let m,prop=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;m=prop.exec(prev.style);)dom.style.removeProperty(m[1])}cur.style&&(dom.style.cssText+=cur.style)}}function applyOuterDeco(dom,deco,node){return patchOuterDeco(dom,dom,noDeco,computeOuterDeco(deco,node,1!=dom.nodeType))}function sameOuterDeco(a,b){if(a.length!=b.length)return!1;for(let i=0;i<a.length;i++)if(!a[i].type.eq(b[i].type))return!1;return!0}function rm(dom){let next=dom.nextSibling;return dom.parentNode.removeChild(dom),next}class ViewTreeUpdater{constructor(top,lock,view){this.lock=lock,this.view=view,this.index=0,this.stack=[],this.changed=!1,this.top=top,this.preMatch=function preMatch(frag,parentDesc){let curDesc=parentDesc,descI=curDesc.children.length,fI=frag.childCount,matched=new Map,matches=[];outer:for(;fI>0;){let desc;for(;;)if(descI){let next=curDesc.children[descI-1];if(!(next instanceof MarkViewDesc)){desc=next,descI--;break}curDesc=next,descI=next.children.length}else{if(curDesc==parentDesc)break outer;descI=curDesc.parent.children.indexOf(curDesc),curDesc=curDesc.parent}let node=desc.node;if(node){if(node!=frag.child(fI-1))break;--fI,matched.set(desc,fI),matches.push(desc)}}return{index:fI,matched,matches:matches.reverse()}}(top.node.content,top)}destroyBetween(start,end){if(start!=end){for(let i=start;i<end;i++)this.top.children[i].destroy();this.top.children.splice(start,end-start),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(marks,inline,view){let keep=0,depth=this.stack.length>>1,maxKeep=Math.min(depth,marks.length);for(;keep<maxKeep&&(keep==depth-1?this.top:this.stack[keep+1<<1]).matchesMark(marks[keep])&&!1!==marks[keep].type.spec.spanning;)keep++;for(;keep<depth;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),depth--;for(;depth<marks.length;){this.stack.push(this.top,this.index+1);let found=-1;for(let i=this.index;i<Math.min(this.index+3,this.top.children.length);i++){let next=this.top.children[i];if(next.matchesMark(marks[depth])&&!this.isLocked(next.dom)){found=i;break}}if(found>-1)found>this.index&&(this.changed=!0,this.destroyBetween(this.index,found)),this.top=this.top.children[this.index];else{let markDesc=MarkViewDesc.create(this.top,marks[depth],inline,view);this.top.children.splice(this.index,0,markDesc),this.top=markDesc,this.changed=!0}this.index=0,depth++}}findNodeMatch(node,outerDeco,innerDeco,index){let targetDesc,found=-1;if(index>=this.preMatch.index&&(targetDesc=this.preMatch.matches[index-this.preMatch.index]).parent==this.top&&targetDesc.matchesNode(node,outerDeco,innerDeco))found=this.top.children.indexOf(targetDesc,this.index);else for(let i=this.index,e=Math.min(this.top.children.length,i+5);i<e;i++){let child=this.top.children[i];if(child.matchesNode(node,outerDeco,innerDeco)&&!this.preMatch.matched.has(child)){found=i;break}}return!(found<0)&&(this.destroyBetween(this.index,found),this.index++,!0)}updateNodeAt(node,outerDeco,innerDeco,index,view){let child=this.top.children[index];return 3==child.dirty&&child.dom==child.contentDOM&&(child.dirty=2),!!child.update(node,outerDeco,innerDeco,view)&&(this.destroyBetween(this.index,index),this.index++,!0)}findIndexWithChild(domNode){for(;;){let parent=domNode.parentNode;if(!parent)return-1;if(parent==this.top.contentDOM){let desc=domNode.pmViewDesc;if(desc)for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==desc)return i;return-1}domNode=parent}}updateNextNode(node,outerDeco,innerDeco,view,index,pos){for(let i=this.index;i<this.top.children.length;i++){let next=this.top.children[i];if(next instanceof NodeViewDesc){let preMatch=this.preMatch.matched.get(next);if(null!=preMatch&&preMatch!=index)return!1;let updated,nextDOM=next.dom,locked=this.isLocked(nextDOM)&&!(node.isText&&next.node&&next.node.isText&&next.nodeDOM.nodeValue==node.text&&3!=next.dirty&&sameOuterDeco(outerDeco,next.outerDeco));if(!locked&&next.update(node,outerDeco,innerDeco,view))return this.destroyBetween(this.index,i),next.dom!=nextDOM&&(this.changed=!0),this.index++,!0;if(!locked&&(updated=this.recreateWrapper(next,node,outerDeco,innerDeco,view,pos)))return this.destroyBetween(this.index,i),this.top.children[this.index]=updated,updated.contentDOM&&(updated.dirty=2,updated.updateChildren(view,pos+1),updated.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(next,node,outerDeco,innerDeco,view,pos){if(next.dirty||node.isAtom||!next.children.length||!next.node.content.eq(node.content)||!sameOuterDeco(outerDeco,next.outerDeco)||!innerDeco.eq(next.innerDeco))return null;let wrapper=NodeViewDesc.create(this.top,node,outerDeco,innerDeco,view,pos);if(wrapper.contentDOM){wrapper.children=next.children,next.children=[];for(let ch of wrapper.children)ch.parent=wrapper}return next.destroy(),wrapper}addNode(node,outerDeco,innerDeco,view,pos){let desc=NodeViewDesc.create(this.top,node,outerDeco,innerDeco,view,pos);desc.contentDOM&&desc.updateChildren(view,pos+1),this.top.children.splice(this.index++,0,desc),this.changed=!0}placeWidget(widget,view,pos){let next=this.index<this.top.children.length?this.top.children[this.index]:null;if(!next||!next.matchesWidget(widget)||widget!=next.widget&&next.widget.type.toDOM.parentNode){let desc=new WidgetViewDesc(this.top,widget,view,pos);this.top.children.splice(this.index++,0,desc),this.changed=!0}else this.index++}addTextblockHacks(){let lastChild=this.top.children[this.index-1],parent=this.top;for(;lastChild instanceof MarkViewDesc;)parent=lastChild,lastChild=parent.children[parent.children.length-1];(!lastChild||!(lastChild instanceof TextViewDesc)||/\n$/.test(lastChild.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(lastChild.node.text))&&((safari||chrome)&&lastChild&&"false"==lastChild.dom.contentEditable&&this.addHackNode("IMG",parent),this.addHackNode("BR",this.top))}addHackNode(nodeName,parent){if(parent==this.top&&this.index<parent.children.length&&parent.children[this.index].matchesHack(nodeName))this.index++;else{let dom=document.createElement(nodeName);"IMG"==nodeName&&(dom.className="ProseMirror-separator",dom.alt=""),"BR"==nodeName&&(dom.className="ProseMirror-trailingBreak");let hack=new TrailingHackViewDesc(this.top,[],dom,null);parent!=this.top?parent.children.push(hack):parent.children.splice(this.index++,0,hack),this.changed=!0}}isLocked(node){return this.lock&&(node==this.lock||1==node.nodeType&&node.contains(this.lock.parentNode))}}function compareSide(a,b){return a.type.side-b.type.side}function replaceNodes(nodes,from,to,view,replacement){let result=[];for(let i=0,off=0;i<nodes.length;i++){let child=nodes[i],start=off,end=off+=child.size;start>=to||end<=from?result.push(child):(start<from&&result.push(child.slice(0,from-start,view)),replacement&&(result.push(replacement),replacement=void 0),end>to&&result.push(child.slice(to-start,child.size,view)))}return result}function selectionFromDOM(view,origin=null){let domSel=view.domSelectionRange(),doc=view.state.doc;if(!domSel.focusNode)return null;let nearestDesc=view.docView.nearestDesc(domSel.focusNode),inWidget=nearestDesc&&0==nearestDesc.size,head=view.docView.posFromDOM(domSel.focusNode,domSel.focusOffset,1);if(head<0)return null;let anchor,selection,$head=doc.resolve(head);if(selectionCollapsed(domSel)){for(anchor=head;nearestDesc&&!nearestDesc.node;)nearestDesc=nearestDesc.parent;let nearestDescNode=nearestDesc.node;if(nearestDesc&&nearestDescNode.isAtom&&prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.isSelectable(nearestDescNode)&&nearestDesc.parent&&(!nearestDescNode.isInline||!function isOnEdge(node,offset,parent){for(let atStart=0==offset,atEnd=offset==nodeSize(node);atStart||atEnd;){if(node==parent)return!0;let index=domIndex(node);if(!(node=node.parentNode))return!1;atStart=atStart&&0==index,atEnd=atEnd&&index==nodeSize(node)}}(domSel.focusNode,domSel.focusOffset,nearestDesc.dom))){let pos=nearestDesc.posBefore;selection=new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh(head==pos?$head:doc.resolve(pos))}}else{if(domSel instanceof view.dom.ownerDocument.defaultView.Selection&&domSel.rangeCount>1){let min=head,max=head;for(let i=0;i<domSel.rangeCount;i++){let range=domSel.getRangeAt(i);min=Math.min(min,view.docView.posFromDOM(range.startContainer,range.startOffset,1)),max=Math.max(max,view.docView.posFromDOM(range.endContainer,range.endOffset,-1))}if(min<0)return null;[anchor,head]=max==view.state.selection.anchor?[max,min]:[min,max],$head=doc.resolve(head)}else anchor=view.docView.posFromDOM(domSel.anchorNode,domSel.anchorOffset,1);if(anchor<0)return null}let $anchor=doc.resolve(anchor);if(!selection){selection=selectionBetween(view,$anchor,$head,"pointer"==origin||view.state.selection.head<$head.pos&&!inWidget?1:-1)}return selection}function editorOwnsSelection(view){return view.editable?view.hasFocus():hasSelection(view)&&document.activeElement&&document.activeElement.contains(view.dom)}function selectionToDOM(view,force=!1){let sel=view.state.selection;if(syncNodeSelection(view,sel),editorOwnsSelection(view)){if(!force&&view.input.mouseDown&&view.input.mouseDown.allowDefault&&chrome){let domSel=view.domSelectionRange(),curSel=view.domObserver.currentSelection;if(domSel.anchorNode&&curSel.anchorNode&&isEquivalentPosition(domSel.anchorNode,domSel.anchorOffset,curSel.anchorNode,curSel.anchorOffset))return view.input.mouseDown.delayedSelectionSync=!0,void view.domObserver.setCurSelection()}if(view.domObserver.disconnectSelection(),view.cursorWrapper)!function selectCursorWrapper(view){let domSel=view.domSelection();if(!domSel)return;let node=view.cursorWrapper.dom,img="IMG"==node.nodeName;img?domSel.collapse(node.parentNode,domIndex(node)+1):domSel.collapse(node,0);!img&&!view.state.selection.visible&&ie&&ie_version<=11&&(node.disabled=!0,node.disabled=!1)}(view);else{let resetEditableFrom,resetEditableTo,{anchor,head}=sel;!brokenSelectBetweenUneditable||sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3||(sel.$from.parent.inlineContent||(resetEditableFrom=temporarilyEditableNear(view,sel.from)),sel.empty||sel.$from.parent.inlineContent||(resetEditableTo=temporarilyEditableNear(view,sel.to))),view.docView.setSelection(anchor,head,view,force),brokenSelectBetweenUneditable&&(resetEditableFrom&&resetEditable(resetEditableFrom),resetEditableTo&&resetEditable(resetEditableTo)),sel.visible?view.dom.classList.remove("ProseMirror-hideselection"):(view.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function removeClassOnSelectionChange(view){let doc=view.dom.ownerDocument;doc.removeEventListener("selectionchange",view.input.hideSelectionGuard);let domSel=view.domSelectionRange(),node=domSel.anchorNode,offset=domSel.anchorOffset;doc.addEventListener("selectionchange",view.input.hideSelectionGuard=()=>{domSel.anchorNode==node&&domSel.anchorOffset==offset||(doc.removeEventListener("selectionchange",view.input.hideSelectionGuard),setTimeout(()=>{editorOwnsSelection(view)&&!view.state.selection.visible||view.dom.classList.remove("ProseMirror-hideselection")},20))})}(view))}view.domObserver.setCurSelection(),view.domObserver.connectSelection()}}const brokenSelectBetweenUneditable=safari||chrome&&chrome_version<63;function temporarilyEditableNear(view,pos){let{node,offset}=view.docView.domFromPos(pos,0),after=offset<node.childNodes.length?node.childNodes[offset]:null,before=offset?node.childNodes[offset-1]:null;if(safari&&after&&"false"==after.contentEditable)return setEditable(after);if(!(after&&"false"!=after.contentEditable||before&&"false"!=before.contentEditable)){if(after)return setEditable(after);if(before)return setEditable(before)}}function setEditable(element){return element.contentEditable="true",safari&&element.draggable&&(element.draggable=!1,element.wasDraggable=!0),element}function resetEditable(element){element.contentEditable="false",element.wasDraggable&&(element.draggable=!0,element.wasDraggable=null)}function syncNodeSelection(view,sel){if(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh){let desc=view.docView.descAt(sel.from);desc!=view.lastSelectedViewDesc&&(clearNodeSelection(view),desc&&desc.selectNode(),view.lastSelectedViewDesc=desc)}else clearNodeSelection(view)}function clearNodeSelection(view){view.lastSelectedViewDesc&&(view.lastSelectedViewDesc.parent&&view.lastSelectedViewDesc.deselectNode(),view.lastSelectedViewDesc=void 0)}function selectionBetween(view,$anchor,$head,bias){return view.someProp("createSelectionBetween",f=>f(view,$anchor,$head))||prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3.between($anchor,$head,bias)}function hasFocusAndSelection(view){return!(view.editable&&!view.hasFocus())&&hasSelection(view)}function hasSelection(view){let sel=view.domSelectionRange();if(!sel.anchorNode)return!1;try{return view.dom.contains(3==sel.anchorNode.nodeType?sel.anchorNode.parentNode:sel.anchorNode)&&(view.editable||view.dom.contains(3==sel.focusNode.nodeType?sel.focusNode.parentNode:sel.focusNode))}catch(_){return!1}}function moveSelectionBlock(state,dir){let{$anchor,$head}=state.selection,$side=dir>0?$anchor.max($head):$anchor.min($head),$start=$side.parent.inlineContent?$side.depth?state.doc.resolve(dir>0?$side.after():$side.before()):null:$side;return $start&&prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.LN.findFrom($start,dir)}function apply(view,sel){return view.dispatch(view.state.tr.setSelection(sel).scrollIntoView()),!0}function selectHorizontally(view,dir,mods){let sel=view.state.selection;if(!(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3)){if(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh&&sel.node.isInline)return apply(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3(dir>0?sel.$to:sel.$from));{let next=moveSelectionBlock(view.state,dir);return!!next&&apply(view,next)}}if(mods.indexOf("s")>-1){let{$head}=sel,node=$head.textOffset?null:dir<0?$head.nodeBefore:$head.nodeAfter;if(!node||node.isText||!node.isLeaf)return!1;let $newHead=view.state.doc.resolve($head.pos+node.nodeSize*(dir<0?-1:1));return apply(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3(sel.$anchor,$newHead))}if(!sel.empty)return!1;if(view.endOfTextblock(dir>0?"forward":"backward")){let next=moveSelectionBlock(view.state,dir);return!!(next&&next instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh)&&apply(view,next)}if(!(mac&&mods.indexOf("m")>-1)){let desc,$head=sel.$head,node=$head.textOffset?null:dir<0?$head.nodeBefore:$head.nodeAfter;if(!node||node.isText)return!1;let nodePos=dir<0?$head.pos-node.nodeSize:$head.pos;return!!(node.isAtom||(desc=view.docView.descAt(nodePos))&&!desc.contentDOM)&&(prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.isSelectable(node)?apply(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh(dir<0?view.state.doc.resolve($head.pos-node.nodeSize):$head)):!!webkit&&apply(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3(view.state.doc.resolve(dir<0?nodePos:nodePos+node.nodeSize))))}}function nodeLen(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function isIgnorable(dom,dir){let desc=dom.pmViewDesc;return desc&&0==desc.size&&(dir<0||dom.nextSibling||"BR"!=dom.nodeName)}function skipIgnoredNodes(view,dir){return dir<0?function skipIgnoredNodesBefore(view){let sel=view.domSelectionRange(),node=sel.focusNode,offset=sel.focusOffset;if(!node)return;let moveNode,moveOffset,force=!1;gecko&&1==node.nodeType&&offset<nodeLen(node)&&isIgnorable(node.childNodes[offset],-1)&&(force=!0);for(;;)if(offset>0){if(1!=node.nodeType)break;{let before=node.childNodes[offset-1];if(isIgnorable(before,-1))moveNode=node,moveOffset=--offset;else{if(3!=before.nodeType)break;node=before,offset=node.nodeValue.length}}}else{if(isBlockNode(node))break;{let prev=node.previousSibling;for(;prev&&isIgnorable(prev,-1);)moveNode=node.parentNode,moveOffset=domIndex(prev),prev=prev.previousSibling;if(prev)node=prev,offset=nodeLen(node);else{if(node=node.parentNode,node==view.dom)break;offset=0}}}force?setSelFocus(view,node,offset):moveNode&&setSelFocus(view,moveNode,moveOffset)}(view):function skipIgnoredNodesAfter(view){let sel=view.domSelectionRange(),node=sel.focusNode,offset=sel.focusOffset;if(!node)return;let moveNode,moveOffset,len=nodeLen(node);for(;;)if(offset<len){if(1!=node.nodeType)break;if(!isIgnorable(node.childNodes[offset],1))break;moveNode=node,moveOffset=++offset}else{if(isBlockNode(node))break;{let next=node.nextSibling;for(;next&&isIgnorable(next,1);)moveNode=next.parentNode,moveOffset=domIndex(next)+1,next=next.nextSibling;if(next)node=next,offset=0,len=nodeLen(node);else{if(node=node.parentNode,node==view.dom)break;offset=len=0}}}moveNode&&setSelFocus(view,moveNode,moveOffset)}(view)}function isBlockNode(dom){let desc=dom.pmViewDesc;return desc&&desc.node&&desc.node.isBlock}function setSelFocus(view,node,offset){if(3!=node.nodeType){let before,after;(after=function textNodeAfter(node,offset){for(;node&&offset==node.childNodes.length&&!hasBlockDesc(node);)offset=domIndex(node)+1,node=node.parentNode;for(;node&&offset<node.childNodes.length;){let next=node.childNodes[offset];if(3==next.nodeType)return next;if(1==next.nodeType&&"false"==next.contentEditable)break;node=next,offset=0}}(node,offset))?(node=after,offset=0):(before=function textNodeBefore(node,offset){for(;node&&!offset&&!hasBlockDesc(node);)offset=domIndex(node),node=node.parentNode;for(;node&&offset;){let next=node.childNodes[offset-1];if(3==next.nodeType)return next;if(1==next.nodeType&&"false"==next.contentEditable)break;offset=(node=next).childNodes.length}}(node,offset))&&(node=before,offset=before.nodeValue.length)}let sel=view.domSelection();if(!sel)return;if(selectionCollapsed(sel)){let range=document.createRange();range.setEnd(node,offset),range.setStart(node,offset),sel.removeAllRanges(),sel.addRange(range)}else sel.extend&&sel.extend(node,offset);view.domObserver.setCurSelection();let{state}=view;setTimeout(()=>{view.state==state&&selectionToDOM(view)},50)}function findDirection(view,pos){let $pos=view.state.doc.resolve(pos);if(!chrome&&!windows&&$pos.parent.inlineContent){let coords=view.coordsAtPos(pos);if(pos>$pos.start()){let before=view.coordsAtPos(pos-1),mid=(before.top+before.bottom)/2;if(mid>coords.top&&mid<coords.bottom&&Math.abs(before.left-coords.left)>1)return before.left<coords.left?"ltr":"rtl"}if(pos<$pos.end()){let after=view.coordsAtPos(pos+1),mid=(after.top+after.bottom)/2;if(mid>coords.top&&mid<coords.bottom&&Math.abs(after.left-coords.left)>1)return after.left>coords.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(view.dom).direction?"rtl":"ltr"}function selectVertically(view,dir,mods){let sel=view.state.selection;if(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3&&!sel.empty||mods.indexOf("s")>-1)return!1;if(mac&&mods.indexOf("m")>-1)return!1;let{$from,$to}=sel;if(!$from.parent.inlineContent||view.endOfTextblock(dir<0?"up":"down")){let next=moveSelectionBlock(view.state,dir);if(next&&next instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh)return apply(view,next)}if(!$from.parent.inlineContent){let side=dir<0?$from:$to,beyond=sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.i5?prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.LN.near(side,dir):prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.LN.findFrom(side,dir);return!!beyond&&apply(view,beyond)}return!1}function stopNativeHorizontalDelete(view,dir){if(!(view.state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3))return!0;let{$head,$anchor,empty}=view.state.selection;if(!$head.sameParent($anchor))return!0;if(!empty)return!1;if(view.endOfTextblock(dir>0?"forward":"backward"))return!0;let nextNode=!$head.textOffset&&(dir<0?$head.nodeBefore:$head.nodeAfter);if(nextNode&&!nextNode.isText){let tr=view.state.tr;return dir<0?tr.delete($head.pos-nextNode.nodeSize,$head.pos):tr.delete($head.pos,$head.pos+nextNode.nodeSize),view.dispatch(tr),!0}return!1}function switchEditable(view,node,state){view.domObserver.stop(),node.contentEditable=state,view.domObserver.start()}function captureKeyDown(view,event){let code=event.keyCode,mods=function getMods(event){let result="";return event.ctrlKey&&(result+="c"),event.metaKey&&(result+="m"),event.altKey&&(result+="a"),event.shiftKey&&(result+="s"),result}(event);if(8==code||mac&&72==code&&"c"==mods)return stopNativeHorizontalDelete(view,-1)||skipIgnoredNodes(view,-1);if(46==code&&!event.shiftKey||mac&&68==code&&"c"==mods)return stopNativeHorizontalDelete(view,1)||skipIgnoredNodes(view,1);if(13==code||27==code)return!0;if(37==code||mac&&66==code&&"c"==mods){let dir=37==code?"ltr"==findDirection(view,view.state.selection.from)?-1:1:-1;return selectHorizontally(view,dir,mods)||skipIgnoredNodes(view,dir)}if(39==code||mac&&70==code&&"c"==mods){let dir=39==code?"ltr"==findDirection(view,view.state.selection.from)?1:-1:1;return selectHorizontally(view,dir,mods)||skipIgnoredNodes(view,dir)}return 38==code||mac&&80==code&&"c"==mods?selectVertically(view,-1,mods)||skipIgnoredNodes(view,-1):40==code||mac&&78==code&&"c"==mods?function safariDownArrowBug(view){if(!safari||view.state.selection.$head.parentOffset>0)return!1;let{focusNode,focusOffset}=view.domSelectionRange();if(focusNode&&1==focusNode.nodeType&&0==focusOffset&&focusNode.firstChild&&"false"==focusNode.firstChild.contentEditable){let child=focusNode.firstChild;switchEditable(view,child,"true"),setTimeout(()=>switchEditable(view,child,"false"),20)}return!1}(view)||selectVertically(view,1,mods)||skipIgnoredNodes(view,1):mods==(mac?"m":"c")&&(66==code||73==code||89==code||90==code)}function serializeForClipboard(view,slice){view.someProp("transformCopied",f=>{slice=f(slice,view)});let context=[],{content,openStart,openEnd}=slice;for(;openStart>1&&openEnd>1&&1==content.childCount&&1==content.firstChild.childCount;){openStart--,openEnd--;let node=content.firstChild;context.push(node.type.name,node.attrs!=node.type.defaultAttrs?node.attrs:null),content=node.content}let serializer=view.someProp("clipboardSerializer")||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.ZF.fromSchema(view.state.schema),doc=detachedDoc(),wrap=doc.createElement("div");wrap.appendChild(serializer.serializeFragment(content,{document:doc}));let needsWrap,firstChild=wrap.firstChild,wrappers=0;for(;firstChild&&1==firstChild.nodeType&&(needsWrap=wrapMap[firstChild.nodeName.toLowerCase()]);){for(let i=needsWrap.length-1;i>=0;i--){let wrapper=doc.createElement(needsWrap[i]);for(;wrap.firstChild;)wrapper.appendChild(wrap.firstChild);wrap.appendChild(wrapper),wrappers++}firstChild=wrap.firstChild}return firstChild&&1==firstChild.nodeType&&firstChild.setAttribute("data-pm-slice",`${openStart} ${openEnd}${wrappers?` -${wrappers}`:""} ${JSON.stringify(context)}`),{dom:wrap,text:view.someProp("clipboardTextSerializer",f=>f(slice,view))||slice.content.textBetween(0,slice.content.size,"\n\n"),slice}}function parseFromClipboard(view,text,html,plainText,$context){let dom,slice,inCode=$context.parent.type.spec.code;if(!html&&!text)return null;let asText=!!text&&(plainText||inCode||!html);if(asText){if(view.someProp("transformPastedText",f=>{text=f(text,inCode||plainText,view)}),inCode)return slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(view.state.schema.text(text.replace(/\r\n?/g,"\n"))),0,0),view.someProp("transformPasted",f=>{slice=f(slice,view,!0)}),slice;let parsed=view.someProp("clipboardTextParser",f=>f(text,$context,plainText,view));if(parsed)slice=parsed;else{let marks=$context.marks(),{schema}=view.state,serializer=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.ZF.fromSchema(schema);dom=document.createElement("div"),text.split(/(?:\r\n?|\n)+/).forEach(block=>{let p=dom.appendChild(document.createElement("p"));block&&p.appendChild(serializer.serializeNode(schema.text(block,marks)))})}}else view.someProp("transformPastedHTML",f=>{html=f(html,view)}),dom=function readHTML(html){let metas=/^(\s*<meta [^>]*>)*/.exec(html);metas&&(html=html.slice(metas[0].length));let wrap,elt=detachedDoc().createElement("div"),firstTag=/<([a-z][^>\s]+)/i.exec(html);(wrap=firstTag&&wrapMap[firstTag[1].toLowerCase()])&&(html=wrap.map(n=>"<"+n+">").join("")+html+wrap.map(n=>"</"+n+">").reverse().join(""));if(elt.innerHTML=function maybeWrapTrusted(html){let trustedTypes=window.trustedTypes;if(!trustedTypes)return html;_policy||(_policy=trustedTypes.defaultPolicy||trustedTypes.createPolicy("ProseMirrorClipboard",{createHTML:s=>s}));return _policy.createHTML(html)}(html),wrap)for(let i=0;i<wrap.length;i++)elt=elt.querySelector(wrap[i])||elt;return elt}(html),webkit&&function restoreReplacedSpaces(dom){let nodes=dom.querySelectorAll(chrome?"span:not([class]):not([style])":"span.Apple-converted-space");for(let i=0;i<nodes.length;i++){let node=nodes[i];1==node.childNodes.length&&" "==node.textContent&&node.parentNode&&node.parentNode.replaceChild(dom.ownerDocument.createTextNode(" "),node)}}(dom);let contextNode=dom&&dom.querySelector("[data-pm-slice]"),sliceData=contextNode&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(contextNode.getAttribute("data-pm-slice")||"");if(sliceData&&sliceData[3])for(let i=+sliceData[3];i>0;i--){let child=dom.firstChild;for(;child&&1!=child.nodeType;)child=child.nextSibling;if(!child)break;dom=child}if(!slice){let parser=view.someProp("clipboardParser")||view.someProp("domParser")||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.S4.fromSchema(view.state.schema);slice=parser.parseSlice(dom,{preserveWhitespace:!(!asText&&!sliceData),context:$context,ruleFromNode:dom=>"BR"!=dom.nodeName||dom.nextSibling||!dom.parentNode||inlineParents.test(dom.parentNode.nodeName)?null:{ignore:!0}})}if(sliceData)slice=function addContext(slice,context){if(!slice.size)return slice;let array,schema=slice.content.firstChild.type.schema;try{array=JSON.parse(context)}catch(e){return slice}let{content,openStart,openEnd}=slice;for(let i=array.length-2;i>=0;i-=2){let type=schema.nodes[array[i]];if(!type||type.hasRequiredAttrs())break;content=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(type.create(array[i+1],content)),openStart++,openEnd++}return new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji(content,openStart,openEnd)}(closeSlice(slice,+sliceData[1],+sliceData[2]),sliceData[4]);else if(slice=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji.maxOpen(function normalizeSiblings(fragment,$context){if(fragment.childCount<2)return fragment;for(let d=$context.depth;d>=0;d--){let lastWrap,match=$context.node(d).contentMatchAt($context.index(d)),result=[];if(fragment.forEach(node=>{if(!result)return;let inLast,wrap=match.findWrapping(node.type);if(!wrap)return result=null;if(inLast=result.length&&lastWrap.length&&addToSibling(wrap,lastWrap,node,result[result.length-1],0))result[result.length-1]=inLast;else{result.length&&(result[result.length-1]=closeRight(result[result.length-1],lastWrap.length));let wrapped=withWrappers(node,wrap);result.push(wrapped),match=match.matchType(wrapped.type),lastWrap=wrap}}),result)return prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(result)}return fragment}(slice.content,$context),!0),slice.openStart||slice.openEnd){let openStart=0,openEnd=0;for(let node=slice.content.firstChild;openStart<slice.openStart&&!node.type.spec.isolating;openStart++,node=node.firstChild);for(let node=slice.content.lastChild;openEnd<slice.openEnd&&!node.type.spec.isolating;openEnd++,node=node.lastChild);slice=closeSlice(slice,openStart,openEnd)}return view.someProp("transformPasted",f=>{slice=f(slice,view,asText)}),slice}const inlineParents=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function withWrappers(node,wrap,from=0){for(let i=wrap.length-1;i>=from;i--)node=wrap[i].create(null,prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(node));return node}function addToSibling(wrap,lastWrap,node,sibling,depth){if(depth<wrap.length&&depth<lastWrap.length&&wrap[depth]==lastWrap[depth]){let inner=addToSibling(wrap,lastWrap,node,sibling.lastChild,depth+1);if(inner)return sibling.copy(sibling.content.replaceChild(sibling.childCount-1,inner));if(sibling.contentMatchAt(sibling.childCount).matchType(depth==wrap.length-1?node.type:wrap[depth+1]))return sibling.copy(sibling.content.append(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(withWrappers(node,wrap,depth+1))))}}function closeRight(node,depth){if(0==depth)return node;let fragment=node.content.replaceChild(node.childCount-1,closeRight(node.lastChild,depth-1)),fill=node.contentMatchAt(node.childCount).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.empty,!0);return node.copy(fragment.append(fill))}function closeRange(fragment,side,from,to,depth,openEnd){let node=side<0?fragment.firstChild:fragment.lastChild,inner=node.content;return fragment.childCount>1&&(openEnd=0),depth<to-1&&(inner=closeRange(inner,side,from,to,depth+1,openEnd)),depth>=from&&(inner=side<0?node.contentMatchAt(0).fillBefore(inner,openEnd<=depth).append(inner):inner.append(node.contentMatchAt(node.childCount).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.empty,!0))),fragment.replaceChild(side<0?0:fragment.childCount-1,node.copy(inner))}function closeSlice(slice,openStart,openEnd){return openStart<slice.openStart&&(slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji(closeRange(slice.content,-1,openStart,slice.openStart,0,slice.openEnd),openStart,slice.openEnd)),openEnd<slice.openEnd&&(slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji(closeRange(slice.content,1,openEnd,slice.openEnd,0,0),slice.openStart,openEnd)),slice}const wrapMap={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let _detachedDoc=null;function detachedDoc(){return _detachedDoc||(_detachedDoc=document.implementation.createHTMLDocument("title"))}let _policy=null;const handlers={},editHandlers={},passiveHandlers={touchstart:!0,touchmove:!0};class InputState{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function setSelectionOrigin(view,origin){view.input.lastSelectionOrigin=origin,view.input.lastSelectionTime=Date.now()}function ensureListeners(view){view.someProp("handleDOMEvents",currentHandlers=>{for(let type in currentHandlers)view.input.eventHandlers[type]||view.dom.addEventListener(type,view.input.eventHandlers[type]=event=>runCustomHandler(view,event))})}function runCustomHandler(view,event){return view.someProp("handleDOMEvents",handlers=>{let handler=handlers[event.type];return!!handler&&(handler(view,event)||event.defaultPrevented)})}function eventBelongsToView(view,event){if(!event.bubbles)return!0;if(event.defaultPrevented)return!1;for(let node=event.target;node!=view.dom;node=node.parentNode)if(!node||11==node.nodeType||node.pmViewDesc&&node.pmViewDesc.stopEvent(event))return!1;return!0}function eventCoords(event){return{left:event.clientX,top:event.clientY}}function runHandlerOnContext(view,propName,pos,inside,event){if(-1==inside)return!1;let $pos=view.state.doc.resolve(inside);for(let i=$pos.depth+1;i>0;i--)if(view.someProp(propName,f=>i>$pos.depth?f(view,pos,$pos.nodeAfter,$pos.before(i),event,!0):f(view,pos,$pos.node(i),$pos.before(i),event,!1)))return!0;return!1}function updateSelection(view,selection,origin){if(view.focused||view.focus(),view.state.selection.eq(selection))return;let tr=view.state.tr.setSelection(selection);"pointer"==origin&&tr.setMeta("pointer",!0),view.dispatch(tr)}function handleSingleClick(view,pos,inside,event,selectNode){return runHandlerOnContext(view,"handleClickOn",pos,inside,event)||view.someProp("handleClick",f=>f(view,pos,event))||(selectNode?function selectClickedNode(view,inside){if(-1==inside)return!1;let selectedNode,selectAt,sel=view.state.selection;sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh&&(selectedNode=sel.node);let $pos=view.state.doc.resolve(inside);for(let i=$pos.depth+1;i>0;i--){let node=i>$pos.depth?$pos.nodeAfter:$pos.node(i);if(prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.isSelectable(node)){selectAt=selectedNode&&sel.$from.depth>0&&i>=sel.$from.depth&&$pos.before(sel.$from.depth+1)==sel.$from.pos?$pos.before(sel.$from.depth):$pos.before(i);break}}return null!=selectAt&&(updateSelection(view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.create(view.state.doc,selectAt),"pointer"),!0)}(view,inside):function selectClickedLeaf(view,inside){if(-1==inside)return!1;let $pos=view.state.doc.resolve(inside),node=$pos.nodeAfter;return!!(node&&node.isAtom&&prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.isSelectable(node))&&(updateSelection(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh($pos),"pointer"),!0)}(view,inside))}function handleDoubleClick(view,pos,inside,event){return runHandlerOnContext(view,"handleDoubleClickOn",pos,inside,event)||view.someProp("handleDoubleClick",f=>f(view,pos,event))}function handleTripleClick(view,pos,inside,event){return runHandlerOnContext(view,"handleTripleClickOn",pos,inside,event)||view.someProp("handleTripleClick",f=>f(view,pos,event))||function defaultTripleClick(view,inside,event){if(0!=event.button)return!1;let doc=view.state.doc;if(-1==inside)return!!doc.inlineContent&&(updateSelection(view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3.create(doc,0,doc.content.size),"pointer"),!0);let $pos=doc.resolve(inside);for(let i=$pos.depth+1;i>0;i--){let node=i>$pos.depth?$pos.nodeAfter:$pos.node(i),nodePos=$pos.before(i);if(node.inlineContent)updateSelection(view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3.create(doc,nodePos+1,nodePos+1+node.content.size),"pointer");else{if(!prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.isSelectable(node))continue;updateSelection(view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.create(doc,nodePos),"pointer")}return!0}}(view,inside,event)}function forceDOMFlush(view){return endComposition(view)}editHandlers.keydown=(view,_event)=>{let event=_event;if(view.input.shiftKey=16==event.keyCode||event.shiftKey,!inOrNearComposition(view,event)&&(view.input.lastKeyCode=event.keyCode,view.input.lastKeyCodeTime=Date.now(),!android||!chrome||13!=event.keyCode))if(229!=event.keyCode&&view.domObserver.forceFlush(),!ios||13!=event.keyCode||event.ctrlKey||event.altKey||event.metaKey)view.someProp("handleKeyDown",f=>f(view,event))||captureKeyDown(view,event)?event.preventDefault():setSelectionOrigin(view,"key");else{let now=Date.now();view.input.lastIOSEnter=now,view.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{view.input.lastIOSEnter==now&&(view.someProp("handleKeyDown",f=>f(view,keyEvent(13,"Enter"))),view.input.lastIOSEnter=0)},200)}},editHandlers.keyup=(view,event)=>{16==event.keyCode&&(view.input.shiftKey=!1)},editHandlers.keypress=(view,_event)=>{let event=_event;if(inOrNearComposition(view,event)||!event.charCode||event.ctrlKey&&!event.altKey||mac&&event.metaKey)return;if(view.someProp("handleKeyPress",f=>f(view,event)))return void event.preventDefault();let sel=view.state.selection;if(!(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3&&sel.$from.sameParent(sel.$to))){let text=String.fromCharCode(event.charCode),deflt=()=>view.state.tr.insertText(text).scrollIntoView();/[\r\n]/.test(text)||view.someProp("handleTextInput",f=>f(view,sel.$from.pos,sel.$to.pos,text,deflt))||view.dispatch(deflt()),event.preventDefault()}};const selectNodeModifier=mac?"metaKey":"ctrlKey";handlers.mousedown=(view,_event)=>{let event=_event;view.input.shiftKey=event.shiftKey;let flushed=forceDOMFlush(view),now=Date.now(),type="singleClick";now-view.input.lastClick.time<500&&function isNear(event,click){let dx=click.x-event.clientX,dy=click.y-event.clientY;return dx*dx+dy*dy<100}(event,view.input.lastClick)&&!event[selectNodeModifier]&&view.input.lastClick.button==event.button&&("singleClick"==view.input.lastClick.type?type="doubleClick":"doubleClick"==view.input.lastClick.type&&(type="tripleClick")),view.input.lastClick={time:now,x:event.clientX,y:event.clientY,type,button:event.button};let pos=view.posAtCoords(eventCoords(event));pos&&("singleClick"==type?(view.input.mouseDown&&view.input.mouseDown.done(),view.input.mouseDown=new MouseDown(view,pos,event,!!flushed)):("doubleClick"==type?handleDoubleClick:handleTripleClick)(view,pos.pos,pos.inside,event)?event.preventDefault():setSelectionOrigin(view,"pointer"))};class MouseDown{constructor(view,pos,event,flushed){let targetNode,targetPos;if(this.view=view,this.pos=pos,this.event=event,this.flushed=flushed,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=view.state.doc,this.selectNode=!!event[selectNodeModifier],this.allowDefault=event.shiftKey,pos.inside>-1)targetNode=view.state.doc.nodeAt(pos.inside),targetPos=pos.inside;else{let $pos=view.state.doc.resolve(pos.pos);targetNode=$pos.parent,targetPos=$pos.depth?$pos.before():0}const target=flushed?null:event.target,targetDesc=target?view.docView.nearestDesc(target,!0):null;this.target=targetDesc&&1==targetDesc.nodeDOM.nodeType?targetDesc.nodeDOM:null;let{selection}=view.state;(0==event.button&&targetNode.type.spec.draggable&&!1!==targetNode.type.spec.selectable||selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh&&selection.from<=targetPos&&selection.to>targetPos)&&(this.mightDrag={node:targetNode,pos:targetPos,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!gecko||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),view.root.addEventListener("mouseup",this.up=this.up.bind(this)),view.root.addEventListener("mousemove",this.move=this.move.bind(this)),setSelectionOrigin(view,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>selectionToDOM(this.view)),this.view.input.mouseDown=null}up(event){if(this.done(),!this.view.dom.contains(event.target))return;let pos=this.pos;this.view.state.doc!=this.startDoc&&(pos=this.view.posAtCoords(eventCoords(event))),this.updateAllowDefault(event),this.allowDefault||!pos?setSelectionOrigin(this.view,"pointer"):handleSingleClick(this.view,pos.pos,pos.inside,event,this.selectNode)?event.preventDefault():0==event.button&&(this.flushed||safari&&this.mightDrag&&!this.mightDrag.node.isAtom||chrome&&!this.view.state.selection.visible&&Math.min(Math.abs(pos.pos-this.view.state.selection.from),Math.abs(pos.pos-this.view.state.selection.to))<=2)?(updateSelection(this.view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.LN.near(this.view.state.doc.resolve(pos.pos)),"pointer"),event.preventDefault()):setSelectionOrigin(this.view,"pointer")}move(event){this.updateAllowDefault(event),setSelectionOrigin(this.view,"pointer"),0==event.buttons&&this.done()}updateAllowDefault(event){!this.allowDefault&&(Math.abs(this.event.x-event.clientX)>4||Math.abs(this.event.y-event.clientY)>4)&&(this.allowDefault=!0)}}function inOrNearComposition(view,event){return!!view.composing||!!(safari&&Math.abs(event.timeStamp-view.input.compositionEndedAt)<500)&&(view.input.compositionEndedAt=-2e8,!0)}handlers.touchstart=view=>{view.input.lastTouch=Date.now(),forceDOMFlush(view),setSelectionOrigin(view,"pointer")},handlers.touchmove=view=>{view.input.lastTouch=Date.now(),setSelectionOrigin(view,"pointer")},handlers.contextmenu=view=>forceDOMFlush(view);const timeoutComposition=android?5e3:-1;function scheduleComposeEnd(view,delay){clearTimeout(view.input.composingTimeout),delay>-1&&(view.input.composingTimeout=setTimeout(()=>endComposition(view),delay))}function clearComposition(view){for(view.composing&&(view.input.composing=!1,view.input.compositionEndedAt=function timestampFromCustomEvent(){let event=document.createEvent("Event");return event.initEvent("event",!0,!0),event.timeStamp}());view.input.compositionNodes.length>0;)view.input.compositionNodes.pop().markParentsDirty()}function findCompositionNode(view){let sel=view.domSelectionRange();if(!sel.focusNode)return null;let textBefore=function textNodeBefore$1(node,offset){for(;;){if(3==node.nodeType&&offset)return node;if(1==node.nodeType&&offset>0){if("false"==node.contentEditable)return null;offset=nodeSize(node=node.childNodes[offset-1])}else{if(!node.parentNode||hasBlockDesc(node))return null;offset=domIndex(node),node=node.parentNode}}}(sel.focusNode,sel.focusOffset),textAfter=function textNodeAfter$1(node,offset){for(;;){if(3==node.nodeType&&offset<node.nodeValue.length)return node;if(1==node.nodeType&&offset<node.childNodes.length){if("false"==node.contentEditable)return null;node=node.childNodes[offset],offset=0}else{if(!node.parentNode||hasBlockDesc(node))return null;offset=domIndex(node)+1,node=node.parentNode}}}(sel.focusNode,sel.focusOffset);if(textBefore&&textAfter&&textBefore!=textAfter){let descAfter=textAfter.pmViewDesc,lastChanged=view.domObserver.lastChangedTextNode;if(textBefore==lastChanged||textAfter==lastChanged)return lastChanged;if(!descAfter||!descAfter.isText(textAfter.nodeValue))return textAfter;if(view.input.compositionNode==textAfter){let descBefore=textBefore.pmViewDesc;if(descBefore&&descBefore.isText(textBefore.nodeValue))return textAfter}}return textBefore||textAfter}function endComposition(view,restarting=!1){if(!(android&&view.domObserver.flushingSoon>=0)){if(view.domObserver.forceFlush(),clearComposition(view),restarting||view.docView&&view.docView.dirty){let sel=selectionFromDOM(view),cur=view.state.selection;return sel&&!sel.eq(cur)?view.dispatch(view.state.tr.setSelection(sel)):!view.markCursor&&!restarting||cur.$from.node(cur.$from.sharedDepth(cur.to)).inlineContent?view.updateState(view.state):view.dispatch(view.state.tr.deleteSelection()),!0}return!1}}editHandlers.compositionstart=editHandlers.compositionupdate=view=>{if(!view.composing){view.domObserver.flush();let{state}=view,$pos=state.selection.$to;if(state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3&&(state.storedMarks||!$pos.textOffset&&$pos.parentOffset&&$pos.nodeBefore.marks.some(m=>!1===m.type.spec.inclusive)))view.markCursor=view.state.storedMarks||$pos.marks(),endComposition(view,!0),view.markCursor=null;else if(endComposition(view,!state.selection.empty),gecko&&state.selection.empty&&$pos.parentOffset&&!$pos.textOffset&&$pos.nodeBefore.marks.length){let sel=view.domSelectionRange();for(let node=sel.focusNode,offset=sel.focusOffset;node&&1==node.nodeType&&0!=offset;){let before=offset<0?node.lastChild:node.childNodes[offset-1];if(!before)break;if(3==before.nodeType){let sel=view.domSelection();sel&&sel.collapse(before,before.nodeValue.length);break}node=before,offset=-1}}view.input.composing=!0}scheduleComposeEnd(view,timeoutComposition)},editHandlers.compositionend=(view,event)=>{view.composing&&(view.input.composing=!1,view.input.compositionEndedAt=event.timeStamp,view.input.compositionPendingChanges=view.domObserver.pendingRecords().length?view.input.compositionID:0,view.input.compositionNode=null,view.input.compositionPendingChanges&&Promise.resolve().then(()=>view.domObserver.flush()),view.input.compositionID++,scheduleComposeEnd(view,20))};const brokenClipboardAPI=ie&&ie_version<15||ios&&webkit_version<604;function doPaste(view,text,html,preferPlain,event){let slice=parseFromClipboard(view,text,html,preferPlain,view.state.selection.$from);if(view.someProp("handlePaste",f=>f(view,event,slice||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji.empty)))return!0;if(!slice)return!1;let singleNode=function sliceSingleNode(slice){return 0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount?slice.content.firstChild:null}(slice),tr=singleNode?view.state.tr.replaceSelectionWith(singleNode,preferPlain):view.state.tr.replaceSelection(slice);return view.dispatch(tr.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function getText(clipboardData){let text=clipboardData.getData("text/plain")||clipboardData.getData("Text");if(text)return text;let uris=clipboardData.getData("text/uri-list");return uris?uris.replace(/\r?\n/g," "):""}handlers.copy=editHandlers.cut=(view,_event)=>{let event=_event,sel=view.state.selection,cut="cut"==event.type;if(sel.empty)return;let data=brokenClipboardAPI?null:event.clipboardData,slice=sel.content(),{dom,text}=serializeForClipboard(view,slice);data?(event.preventDefault(),data.clearData(),data.setData("text/html",dom.innerHTML),data.setData("text/plain",text)):function captureCopy(view,dom){if(!view.dom.parentNode)return;let wrap=view.dom.parentNode.appendChild(document.createElement("div"));wrap.appendChild(dom),wrap.style.cssText="position: fixed; left: -10000px; top: 10px";let sel=getSelection(),range=document.createRange();range.selectNodeContents(dom),view.dom.blur(),sel.removeAllRanges(),sel.addRange(range),setTimeout(()=>{wrap.parentNode&&wrap.parentNode.removeChild(wrap),view.focus()},50)}(view,dom),cut&&view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},editHandlers.paste=(view,_event)=>{let event=_event;if(view.composing&&!android)return;let data=brokenClipboardAPI?null:event.clipboardData,plain=view.input.shiftKey&&45!=view.input.lastKeyCode;data&&doPaste(view,getText(data),data.getData("text/html"),plain,event)?event.preventDefault():function capturePaste(view,event){if(!view.dom.parentNode)return;let plainText=view.input.shiftKey||view.state.selection.$from.parent.type.spec.code,target=view.dom.parentNode.appendChild(document.createElement(plainText?"textarea":"div"));plainText||(target.contentEditable="true"),target.style.cssText="position: fixed; left: -10000px; top: 10px",target.focus();let plain=view.input.shiftKey&&45!=view.input.lastKeyCode;setTimeout(()=>{view.focus(),target.parentNode&&target.parentNode.removeChild(target),plainText?doPaste(view,target.value,null,plain,event):doPaste(view,target.textContent,target.innerHTML,plain,event)},50)}(view,event)};class Dragging{constructor(slice,move,node){this.slice=slice,this.move=move,this.node=node}}const dragCopyModifier=mac?"altKey":"ctrlKey";function dragMoves(view,event){let moves=view.someProp("dragCopies",test=>!test(event));return null!=moves?moves:!event[dragCopyModifier]}handlers.dragstart=(view,_event)=>{let event=_event,mouseDown=view.input.mouseDown;if(mouseDown&&mouseDown.done(),!event.dataTransfer)return;let node,sel=view.state.selection,pos=sel.empty?null:view.posAtCoords(eventCoords(event));if(pos&&pos.pos>=sel.from&&pos.pos<=(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh?sel.to-1:sel.to));else if(mouseDown&&mouseDown.mightDrag)node=prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.create(view.state.doc,mouseDown.mightDrag.pos);else if(event.target&&1==event.target.nodeType){let desc=view.docView.nearestDesc(event.target,!0);desc&&desc.node.type.spec.draggable&&desc!=view.docView&&(node=prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.create(view.state.doc,desc.posBefore))}let draggedSlice=(node||view.state.selection).content(),{dom,text,slice}=serializeForClipboard(view,draggedSlice);(!event.dataTransfer.files.length||!chrome||chrome_version>120)&&event.dataTransfer.clearData(),event.dataTransfer.setData(brokenClipboardAPI?"Text":"text/html",dom.innerHTML),event.dataTransfer.effectAllowed="copyMove",brokenClipboardAPI||event.dataTransfer.setData("text/plain",text),view.dragging=new Dragging(slice,dragMoves(view,event),node)},handlers.dragend=view=>{let dragging=view.dragging;window.setTimeout(()=>{view.dragging==dragging&&(view.dragging=null)},50)},editHandlers.dragover=editHandlers.dragenter=(_,e)=>e.preventDefault(),editHandlers.drop=(view,_event)=>{let event=_event,dragging=view.dragging;if(view.dragging=null,!event.dataTransfer)return;let eventPos=view.posAtCoords(eventCoords(event));if(!eventPos)return;let $mouse=view.state.doc.resolve(eventPos.pos),slice=dragging&&dragging.slice;slice?view.someProp("transformPasted",f=>{slice=f(slice,view,!1)}):slice=parseFromClipboard(view,getText(event.dataTransfer),brokenClipboardAPI?null:event.dataTransfer.getData("text/html"),!1,$mouse);let move=!(!dragging||!dragMoves(view,event));if(view.someProp("handleDrop",f=>f(view,event,slice||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.Ji.empty,move)))return void event.preventDefault();if(!slice)return;event.preventDefault();let insertPos=slice?(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_2__.Um)(view.state.doc,$mouse.pos,slice):$mouse.pos;null==insertPos&&(insertPos=$mouse.pos);let tr=view.state.tr;if(move){let{node}=dragging;node?node.replace(tr):tr.deleteSelection()}let pos=tr.mapping.map(insertPos),isNode=0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount,beforeInsert=tr.doc;if(isNode?tr.replaceRangeWith(pos,pos,slice.content.firstChild):tr.replaceRange(pos,pos,slice),tr.doc.eq(beforeInsert))return;let $pos=tr.doc.resolve(pos);if(isNode&&prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.isSelectable(slice.content.firstChild)&&$pos.nodeAfter&&$pos.nodeAfter.sameMarkup(slice.content.firstChild))tr.setSelection(new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh($pos));else{let end=tr.mapping.map(insertPos);tr.mapping.maps[tr.mapping.maps.length-1].forEach((_from,_to,_newFrom,newTo)=>end=newTo),tr.setSelection(selectionBetween(view,$pos,tr.doc.resolve(end)))}view.focus(),view.dispatch(tr.setMeta("uiEvent","drop"))},handlers.focus=view=>{view.input.lastFocus=Date.now(),view.focused||(view.domObserver.stop(),view.dom.classList.add("ProseMirror-focused"),view.domObserver.start(),view.focused=!0,setTimeout(()=>{view.docView&&view.hasFocus()&&!view.domObserver.currentSelection.eq(view.domSelectionRange())&&selectionToDOM(view)},20))},handlers.blur=(view,_event)=>{let event=_event;view.focused&&(view.domObserver.stop(),view.dom.classList.remove("ProseMirror-focused"),view.domObserver.start(),event.relatedTarget&&view.dom.contains(event.relatedTarget)&&view.domObserver.currentSelection.clear(),view.focused=!1)},handlers.beforeinput=(view,_event)=>{if(chrome&&android&&"deleteContentBackward"==_event.inputType){view.domObserver.flushSoon();let{domChangeCount}=view.input;setTimeout(()=>{if(view.input.domChangeCount!=domChangeCount)return;if(view.dom.blur(),view.focus(),view.someProp("handleKeyDown",f=>f(view,keyEvent(8,"Backspace"))))return;let{$cursor}=view.state.selection;$cursor&&$cursor.pos>0&&view.dispatch(view.state.tr.delete($cursor.pos-1,$cursor.pos).scrollIntoView())},50)}};for(let prop in editHandlers)handlers[prop]=editHandlers[prop];function compareObjs(a,b){if(a==b)return!0;for(let p in a)if(a[p]!==b[p])return!1;for(let p in b)if(!(p in a))return!1;return!0}class WidgetType{constructor(toDOM,spec){this.toDOM=toDOM,this.spec=spec||noSpec,this.side=this.spec.side||0}map(mapping,span,offset,oldOffset){let{pos,deleted}=mapping.mapResult(span.from+oldOffset,this.side<0?-1:1);return deleted?null:new Decoration(pos-offset,pos-offset,this)}valid(){return!0}eq(other){return this==other||other instanceof WidgetType&&(this.spec.key&&this.spec.key==other.spec.key||this.toDOM==other.toDOM&&compareObjs(this.spec,other.spec))}destroy(node){this.spec.destroy&&this.spec.destroy(node)}}class InlineType{constructor(attrs,spec){this.attrs=attrs,this.spec=spec||noSpec}map(mapping,span,offset,oldOffset){let from=mapping.map(span.from+oldOffset,this.spec.inclusiveStart?-1:1)-offset,to=mapping.map(span.to+oldOffset,this.spec.inclusiveEnd?1:-1)-offset;return from>=to?null:new Decoration(from,to,this)}valid(_,span){return span.from<span.to}eq(other){return this==other||other instanceof InlineType&&compareObjs(this.attrs,other.attrs)&&compareObjs(this.spec,other.spec)}static is(span){return span.type instanceof InlineType}destroy(){}}class NodeType{constructor(attrs,spec){this.attrs=attrs,this.spec=spec||noSpec}map(mapping,span,offset,oldOffset){let from=mapping.mapResult(span.from+oldOffset,1);if(from.deleted)return null;let to=mapping.mapResult(span.to+oldOffset,-1);return to.deleted||to.pos<=from.pos?null:new Decoration(from.pos-offset,to.pos-offset,this)}valid(node,span){let child,{index,offset}=node.content.findIndex(span.from);return offset==span.from&&!(child=node.child(index)).isText&&offset+child.nodeSize==span.to}eq(other){return this==other||other instanceof NodeType&&compareObjs(this.attrs,other.attrs)&&compareObjs(this.spec,other.spec)}destroy(){}}class Decoration{constructor(from,to,type){this.from=from,this.to=to,this.type=type}copy(from,to){return new Decoration(from,to,this.type)}eq(other,offset=0){return this.type.eq(other.type)&&this.from+offset==other.from&&this.to+offset==other.to}map(mapping,offset,oldOffset){return this.type.map(mapping,this,offset,oldOffset)}static widget(pos,toDOM,spec){return new Decoration(pos,pos,new WidgetType(toDOM,spec))}static inline(from,to,attrs,spec){return new Decoration(from,to,new InlineType(attrs,spec))}static node(from,to,attrs,spec){return new Decoration(from,to,new NodeType(attrs,spec))}get spec(){return this.type.spec}get inline(){return this.type instanceof InlineType}get widget(){return this.type instanceof WidgetType}}const none=[],noSpec={};class DecorationSet{constructor(local,children){this.local=local.length?local:none,this.children=children.length?children:none}static create(doc,decorations){return decorations.length?buildTree(decorations,doc,0,noSpec):empty}find(start,end,predicate){let result=[];return this.findInner(null==start?0:start,null==end?1e9:end,result,0,predicate),result}findInner(start,end,result,offset,predicate){for(let i=0;i<this.local.length;i++){let span=this.local[i];span.from<=end&&span.to>=start&&(!predicate||predicate(span.spec))&&result.push(span.copy(span.from+offset,span.to+offset))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<end&&this.children[i+1]>start){let childOff=this.children[i]+1;this.children[i+2].findInner(start-childOff,end-childOff,result,offset+childOff,predicate)}}map(mapping,doc,options){return this==empty||0==mapping.maps.length?this:this.mapInner(mapping,doc,0,0,options||noSpec)}mapInner(mapping,node,offset,oldOffset,options){let newLocal;for(let i=0;i<this.local.length;i++){let mapped=this.local[i].map(mapping,offset,oldOffset);mapped&&mapped.type.valid(node,mapped)?(newLocal||(newLocal=[])).push(mapped):options.onRemove&&options.onRemove(this.local[i].spec)}return this.children.length?function mapChildren(oldChildren,newLocal,mapping,node,offset,oldOffset,options){let children=oldChildren.slice();for(let i=0,baseOffset=oldOffset;i<mapping.maps.length;i++){let moved=0;mapping.maps[i].forEach((oldStart,oldEnd,newStart,newEnd)=>{let dSize=newEnd-newStart-(oldEnd-oldStart);for(let i=0;i<children.length;i+=3){let end=children[i+1];if(end<0||oldStart>end+baseOffset-moved)continue;let start=children[i]+baseOffset-moved;oldEnd>=start?children[i+1]=oldStart<=start?-2:-1:oldStart>=baseOffset&&dSize&&(children[i]+=dSize,children[i+1]+=dSize)}moved+=dSize}),baseOffset=mapping.maps[i].map(baseOffset,-1)}let mustRebuild=!1;for(let i=0;i<children.length;i+=3)if(children[i+1]<0){if(-2==children[i+1]){mustRebuild=!0,children[i+1]=-1;continue}let from=mapping.map(oldChildren[i]+oldOffset),fromLocal=from-offset;if(fromLocal<0||fromLocal>=node.content.size){mustRebuild=!0;continue}let toLocal=mapping.map(oldChildren[i+1]+oldOffset,-1)-offset,{index,offset:childOffset}=node.content.findIndex(fromLocal),childNode=node.maybeChild(index);if(childNode&&childOffset==fromLocal&&childOffset+childNode.nodeSize==toLocal){let mapped=children[i+2].mapInner(mapping,childNode,from+1,oldChildren[i]+oldOffset+1,options);mapped!=empty?(children[i]=fromLocal,children[i+1]=toLocal,children[i+2]=mapped):(children[i+1]=-2,mustRebuild=!0)}else mustRebuild=!0}if(mustRebuild){let decorations=function mapAndGatherRemainingDecorations(children,oldChildren,decorations,mapping,offset,oldOffset,options){function gather(set,oldOffset){for(let i=0;i<set.local.length;i++){let mapped=set.local[i].map(mapping,offset,oldOffset);mapped?decorations.push(mapped):options.onRemove&&options.onRemove(set.local[i].spec)}for(let i=0;i<set.children.length;i+=3)gather(set.children[i+2],set.children[i]+oldOffset+1)}for(let i=0;i<children.length;i+=3)-1==children[i+1]&&gather(children[i+2],oldChildren[i]+oldOffset+1);return decorations}(children,oldChildren,newLocal,mapping,offset,oldOffset,options),built=buildTree(decorations,node,0,options);newLocal=built.local;for(let i=0;i<children.length;i+=3)children[i+1]<0&&(children.splice(i,3),i-=3);for(let i=0,j=0;i<built.children.length;i+=3){let from=built.children[i];for(;j<children.length&&children[j]<from;)j+=3;children.splice(j,0,built.children[i],built.children[i+1],built.children[i+2])}}return new DecorationSet(newLocal.sort(byPos),children)}(this.children,newLocal||[],mapping,node,offset,oldOffset,options):newLocal?new DecorationSet(newLocal.sort(byPos),none):empty}add(doc,decorations){return decorations.length?this==empty?DecorationSet.create(doc,decorations):this.addInner(doc,decorations,0):this}addInner(doc,decorations,offset){let children,childIndex=0;doc.forEach((childNode,childOffset)=>{let found,baseOffset=childOffset+offset;if(found=takeSpansForNode(decorations,childNode,baseOffset)){for(children||(children=this.children.slice());childIndex<children.length&&children[childIndex]<childOffset;)childIndex+=3;children[childIndex]==childOffset?children[childIndex+2]=children[childIndex+2].addInner(childNode,found,baseOffset+1):children.splice(childIndex,0,childOffset,childOffset+childNode.nodeSize,buildTree(found,childNode,baseOffset+1,noSpec)),childIndex+=3}});let local=moveSpans(childIndex?withoutNulls(decorations):decorations,-offset);for(let i=0;i<local.length;i++)local[i].type.valid(doc,local[i])||local.splice(i--,1);return new DecorationSet(local.length?this.local.concat(local).sort(byPos):this.local,children||this.children)}remove(decorations){return 0==decorations.length||this==empty?this:this.removeInner(decorations,0)}removeInner(decorations,offset){let children=this.children,local=this.local;for(let i=0;i<children.length;i+=3){let found,from=children[i]+offset,to=children[i+1]+offset;for(let span,j=0;j<decorations.length;j++)(span=decorations[j])&&span.from>from&&span.to<to&&(decorations[j]=null,(found||(found=[])).push(span));if(!found)continue;children==this.children&&(children=this.children.slice());let removed=children[i+2].removeInner(found,from+1);removed!=empty?children[i+2]=removed:(children.splice(i,3),i-=3)}if(local.length)for(let span,i=0;i<decorations.length;i++)if(span=decorations[i])for(let j=0;j<local.length;j++)local[j].eq(span,offset)&&(local==this.local&&(local=this.local.slice()),local.splice(j--,1));return children==this.children&&local==this.local?this:local.length||children.length?new DecorationSet(local,children):empty}forChild(offset,node){if(this==empty)return this;if(node.isLeaf)return DecorationSet.empty;let child,local;for(let i=0;i<this.children.length;i+=3)if(this.children[i]>=offset){this.children[i]==offset&&(child=this.children[i+2]);break}let start=offset+1,end=start+node.content.size;for(let i=0;i<this.local.length;i++){let dec=this.local[i];if(dec.from<end&&dec.to>start&&dec.type instanceof InlineType){let from=Math.max(start,dec.from)-start,to=Math.min(end,dec.to)-start;from<to&&(local||(local=[])).push(dec.copy(from,to))}}if(local){let localSet=new DecorationSet(local.sort(byPos),none);return child?new DecorationGroup([localSet,child]):localSet}return child||empty}eq(other){if(this==other)return!0;if(!(other instanceof DecorationSet)||this.local.length!=other.local.length||this.children.length!=other.children.length)return!1;for(let i=0;i<this.local.length;i++)if(!this.local[i].eq(other.local[i]))return!1;for(let i=0;i<this.children.length;i+=3)if(this.children[i]!=other.children[i]||this.children[i+1]!=other.children[i+1]||!this.children[i+2].eq(other.children[i+2]))return!1;return!0}locals(node){return removeOverlap(this.localsInner(node))}localsInner(node){if(this==empty)return none;if(node.inlineContent||!this.local.some(InlineType.is))return this.local;let result=[];for(let i=0;i<this.local.length;i++)this.local[i].type instanceof InlineType||result.push(this.local[i]);return result}forEachSet(f){f(this)}}DecorationSet.empty=new DecorationSet([],[]),DecorationSet.removeOverlap=removeOverlap;const empty=DecorationSet.empty;class DecorationGroup{constructor(members){this.members=members}map(mapping,doc){const mappedDecos=this.members.map(member=>member.map(mapping,doc,noSpec));return DecorationGroup.from(mappedDecos)}forChild(offset,child){if(child.isLeaf)return DecorationSet.empty;let found=[];for(let i=0;i<this.members.length;i++){let result=this.members[i].forChild(offset,child);result!=empty&&(result instanceof DecorationGroup?found=found.concat(result.members):found.push(result))}return DecorationGroup.from(found)}eq(other){if(!(other instanceof DecorationGroup)||other.members.length!=this.members.length)return!1;for(let i=0;i<this.members.length;i++)if(!this.members[i].eq(other.members[i]))return!1;return!0}locals(node){let result,sorted=!0;for(let i=0;i<this.members.length;i++){let locals=this.members[i].localsInner(node);if(locals.length)if(result){sorted&&(result=result.slice(),sorted=!1);for(let j=0;j<locals.length;j++)result.push(locals[j])}else result=locals}return result?removeOverlap(sorted?result:result.sort(byPos)):none}static from(members){switch(members.length){case 0:return empty;case 1:return members[0];default:return new DecorationGroup(members.every(m=>m instanceof DecorationSet)?members:members.reduce((r,m)=>r.concat(m instanceof DecorationSet?m:m.members),[]))}}forEachSet(f){for(let i=0;i<this.members.length;i++)this.members[i].forEachSet(f)}}function moveSpans(spans,offset){if(!offset||!spans.length)return spans;let result=[];for(let i=0;i<spans.length;i++){let span=spans[i];result.push(new Decoration(span.from+offset,span.to+offset,span.type))}return result}function takeSpansForNode(spans,node,offset){if(node.isLeaf)return null;let end=offset+node.nodeSize,found=null;for(let span,i=0;i<spans.length;i++)(span=spans[i])&&span.from>offset&&span.to<end&&((found||(found=[])).push(span),spans[i]=null);return found}function withoutNulls(array){let result=[];for(let i=0;i<array.length;i++)null!=array[i]&&result.push(array[i]);return result}function buildTree(spans,node,offset,options){let children=[],hasNulls=!1;node.forEach((childNode,localStart)=>{let found=takeSpansForNode(spans,childNode,localStart+offset);if(found){hasNulls=!0;let subtree=buildTree(found,childNode,offset+localStart+1,options);subtree!=empty&&children.push(localStart,localStart+childNode.nodeSize,subtree)}});let locals=moveSpans(hasNulls?withoutNulls(spans):spans,-offset).sort(byPos);for(let i=0;i<locals.length;i++)locals[i].type.valid(node,locals[i])||(options.onRemove&&options.onRemove(locals[i].spec),locals.splice(i--,1));return locals.length||children.length?new DecorationSet(locals,children):empty}function byPos(a,b){return a.from-b.from||a.to-b.to}function removeOverlap(spans){let working=spans;for(let i=0;i<working.length-1;i++){let span=working[i];if(span.from!=span.to)for(let j=i+1;j<working.length;j++){let next=working[j];if(next.from!=span.from){next.from<span.to&&(working==spans&&(working=spans.slice()),working[i]=span.copy(span.from,next.from),insertAhead(working,j,span.copy(next.from,span.to)));break}next.to!=span.to&&(working==spans&&(working=spans.slice()),working[j]=next.copy(next.from,span.to),insertAhead(working,j+1,next.copy(span.to,next.to)))}}return working}function insertAhead(array,i,deco){for(;i<array.length&&byPos(deco,array[i])>0;)i++;array.splice(i,0,deco)}function viewDecorations(view){let found=[];return view.someProp("decorations",f=>{let result=f(view.state);result&&result!=empty&&found.push(result)}),view.cursorWrapper&&found.push(DecorationSet.create(view.state.doc,[view.cursorWrapper.deco])),DecorationGroup.from(found)}const observeOptions={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},useCharData=ie&&ie_version<=11;class SelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(sel){this.anchorNode=sel.anchorNode,this.anchorOffset=sel.anchorOffset,this.focusNode=sel.focusNode,this.focusOffset=sel.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(sel){return sel.anchorNode==this.anchorNode&&sel.anchorOffset==this.anchorOffset&&sel.focusNode==this.focusNode&&sel.focusOffset==this.focusOffset}}class DOMObserver{constructor(view,handleDOMChange){this.view=view,this.handleDOMChange=handleDOMChange,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new SelectionState,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(mutations=>{for(let i=0;i<mutations.length;i++)this.queue.push(mutations[i]);ie&&ie_version<=11&&mutations.some(m=>"childList"==m.type&&m.removedNodes.length||"characterData"==m.type&&m.oldValue.length>m.target.nodeValue.length)?this.flushSoon():this.flush()}),useCharData&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,observeOptions)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let take=this.observer.takeRecords();if(take.length){for(let i=0;i<take.length;i++)this.queue.push(take[i]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(hasFocusAndSelection(this.view)){if(this.suppressingSelectionUpdates)return selectionToDOM(this.view);if(ie&&ie_version<=11&&!this.view.state.selection.empty){let sel=this.view.domSelectionRange();if(sel.focusNode&&isEquivalentPosition(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(sel){if(!sel.focusNode)return!0;let container,ancestors=new Set;for(let scan=sel.focusNode;scan;scan=parentNode(scan))ancestors.add(scan);for(let scan=sel.anchorNode;scan;scan=parentNode(scan))if(ancestors.has(scan)){container=scan;break}let desc=container&&this.view.docView.nearestDesc(container);return desc&&desc.ignoreMutation({type:"selection",target:3==container.nodeType?container.parentNode:container})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let mut of this.observer.takeRecords())this.queue.push(mut);return this.queue}flush(){let{view}=this;if(!view.docView||this.flushingSoon>-1)return;let mutations=this.pendingRecords();mutations.length&&(this.queue=[]);let sel=view.domSelectionRange(),newSel=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(sel)&&hasFocusAndSelection(view)&&!this.ignoreSelectionChange(sel),from=-1,to=-1,typeOver=!1,added=[];if(view.editable)for(let i=0;i<mutations.length;i++){let result=this.registerMutation(mutations[i],added);result&&(from=from<0?result.from:Math.min(result.from,from),to=to<0?result.to:Math.max(result.to,to),result.typeOver&&(typeOver=!0))}if(gecko&&added.length){let brs=added.filter(n=>"BR"==n.nodeName);if(2==brs.length){let[a,b]=brs;a.parentNode&&a.parentNode.parentNode==b.parentNode?b.remove():a.remove()}else{let{focusNode}=this.currentSelection;for(let br of brs){let parent=br.parentNode;!parent||"LI"!=parent.nodeName||focusNode&&blockParent(view,focusNode)==parent||br.remove()}}}let readSel=null;from<0&&newSel&&view.input.lastFocus>Date.now()-200&&Math.max(view.input.lastTouch,view.input.lastClick.time)<Date.now()-300&&selectionCollapsed(sel)&&(readSel=selectionFromDOM(view))&&readSel.eq(prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.LN.near(view.state.doc.resolve(0),1))?(view.input.lastFocus=0,selectionToDOM(view),this.currentSelection.set(sel),view.scrollToSelection()):(from>-1||newSel)&&(from>-1&&(view.docView.markDirty(from,to),function checkCSS(view){if(cssChecked.has(view))return;if(cssChecked.set(view,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(view.dom).whiteSpace)){if(view.requiresGeckoHackNode=gecko,cssCheckWarned)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),cssCheckWarned=!0}}(view)),this.handleDOMChange(from,to,typeOver,added),view.docView&&view.docView.dirty?view.updateState(view.state):this.currentSelection.eq(sel)||selectionToDOM(view),this.currentSelection.set(sel))}registerMutation(mut,added){if(added.indexOf(mut.target)>-1)return null;let desc=this.view.docView.nearestDesc(mut.target);if("attributes"==mut.type&&(desc==this.view.docView||"contenteditable"==mut.attributeName||"style"==mut.attributeName&&!mut.oldValue&&!mut.target.getAttribute("style")))return null;if(!desc||desc.ignoreMutation(mut))return null;if("childList"==mut.type){for(let i=0;i<mut.addedNodes.length;i++){let node=mut.addedNodes[i];added.push(node),3==node.nodeType&&(this.lastChangedTextNode=node)}if(desc.contentDOM&&desc.contentDOM!=desc.dom&&!desc.contentDOM.contains(mut.target))return{from:desc.posBefore,to:desc.posAfter};let prev=mut.previousSibling,next=mut.nextSibling;if(ie&&ie_version<=11&&mut.addedNodes.length)for(let i=0;i<mut.addedNodes.length;i++){let{previousSibling,nextSibling}=mut.addedNodes[i];(!previousSibling||Array.prototype.indexOf.call(mut.addedNodes,previousSibling)<0)&&(prev=previousSibling),(!nextSibling||Array.prototype.indexOf.call(mut.addedNodes,nextSibling)<0)&&(next=nextSibling)}let fromOffset=prev&&prev.parentNode==mut.target?domIndex(prev)+1:0,from=desc.localPosFromDOM(mut.target,fromOffset,-1),toOffset=next&&next.parentNode==mut.target?domIndex(next):mut.target.childNodes.length;return{from,to:desc.localPosFromDOM(mut.target,toOffset,1)}}return"attributes"==mut.type?{from:desc.posAtStart-desc.border,to:desc.posAtEnd+desc.border}:(this.lastChangedTextNode=mut.target,{from:desc.posAtStart,to:desc.posAtEnd,typeOver:mut.target.nodeValue==mut.oldValue})}}let cssChecked=new WeakMap,cssCheckWarned=!1;function rangeToSelectionRange(view,range){let anchorNode=range.startContainer,anchorOffset=range.startOffset,focusNode=range.endContainer,focusOffset=range.endOffset,currentAnchor=view.domAtPos(view.state.selection.anchor);return isEquivalentPosition(currentAnchor.node,currentAnchor.offset,focusNode,focusOffset)&&([anchorNode,anchorOffset,focusNode,focusOffset]=[focusNode,focusOffset,anchorNode,anchorOffset]),{anchorNode,anchorOffset,focusNode,focusOffset}}function blockParent(view,node){for(let p=node.parentNode;p&&p!=view.dom;p=p.parentNode){let desc=view.docView.nearestDesc(p,!0);if(desc&&desc.node.isBlock)return p}return null}function ruleFromNode(dom){let desc=dom.pmViewDesc;if(desc)return desc.parseRule();if("BR"==dom.nodeName&&dom.parentNode){if(safari&&/^(ul|ol)$/i.test(dom.parentNode.nodeName)){let skip=document.createElement("div");return skip.appendChild(document.createElement("li")),{skip}}if(dom.parentNode.lastChild==dom||safari&&/^(tr|table)$/i.test(dom.parentNode.nodeName))return{ignore:!0}}else if("IMG"==dom.nodeName&&dom.getAttribute("mark-placeholder"))return{ignore:!0};return null}const isInline=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function readDOMChange(view,from,to,typeOver,addedNodes){let compositionID=view.input.compositionPendingChanges||(view.composing?view.input.compositionID:0);if(view.input.compositionPendingChanges=0,from<0){let origin=view.input.lastSelectionTime>Date.now()-50?view.input.lastSelectionOrigin:null,newSel=selectionFromDOM(view,origin);if(newSel&&!view.state.selection.eq(newSel)){if(chrome&&android&&13===view.input.lastKeyCode&&Date.now()-100<view.input.lastKeyCodeTime&&view.someProp("handleKeyDown",f=>f(view,keyEvent(13,"Enter"))))return;let tr=view.state.tr.setSelection(newSel);"pointer"==origin?tr.setMeta("pointer",!0):"key"==origin&&tr.scrollIntoView(),compositionID&&tr.setMeta("composition",compositionID),view.dispatch(tr)}return}let $before=view.state.doc.resolve(from),shared=$before.sharedDepth(to);from=$before.before(shared+1),to=view.state.doc.resolve(to).after(shared+1);let preferredPos,preferredSide,sel=view.state.selection,parse=function parseBetween(view,from_,to_){let find,{node:parent,fromOffset,toOffset,from,to}=view.docView.parseRange(from_,to_),domSel=view.domSelectionRange(),anchor=domSel.anchorNode;if(anchor&&view.dom.contains(1==anchor.nodeType?anchor:anchor.parentNode)&&(find=[{node:anchor,offset:domSel.anchorOffset}],selectionCollapsed(domSel)||find.push({node:domSel.focusNode,offset:domSel.focusOffset})),chrome&&8===view.input.lastKeyCode)for(let off=toOffset;off>fromOffset;off--){let node=parent.childNodes[off-1],desc=node.pmViewDesc;if("BR"==node.nodeName&&!desc){toOffset=off;break}if(!desc||desc.size)break}let startDoc=view.state.doc,parser=view.someProp("domParser")||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.S4.fromSchema(view.state.schema),$from=startDoc.resolve(from),sel=null,doc=parser.parse(parent,{topNode:$from.parent,topMatch:$from.parent.contentMatchAt($from.index()),topOpen:!0,from:fromOffset,to:toOffset,preserveWhitespace:"pre"!=$from.parent.type.whitespace||"full",findPositions:find,ruleFromNode,context:$from});if(find&&null!=find[0].pos){let anchor=find[0].pos,head=find[1]&&find[1].pos;null==head&&(head=anchor),sel={anchor:anchor+from,head:head+from}}return{doc,sel,from,to}}(view,from,to),doc=view.state.doc,compare=doc.slice(parse.from,parse.to);8===view.input.lastKeyCode&&Date.now()-100<view.input.lastKeyCodeTime?(preferredPos=view.state.selection.to,preferredSide="end"):(preferredPos=view.state.selection.from,preferredSide="start"),view.input.lastKeyCode=null;let change=function findDiff(a,b,pos,preferredPos,preferredSide){let start=a.findDiffStart(b,pos);if(null==start)return null;let{a:endA,b:endB}=a.findDiffEnd(b,pos+a.size,pos+b.size);if("end"==preferredSide){preferredPos-=endA+Math.max(0,start-Math.min(endA,endB))-start}if(endA<start&&a.size<b.size){let move=preferredPos<=start&&preferredPos>=endA?start-preferredPos:0;start-=move,start&&start<b.size&&isSurrogatePair(b.textBetween(start-1,start+1))&&(start+=move?1:-1),endB=start+(endB-endA),endA=start}else if(endB<start){let move=preferredPos<=start&&preferredPos>=endB?start-preferredPos:0;start-=move,start&&start<a.size&&isSurrogatePair(a.textBetween(start-1,start+1))&&(start+=move?1:-1),endA=start+(endA-endB),endB=start}return{start,endA,endB}}(compare.content,parse.doc.content,parse.from,preferredPos,preferredSide);if(change&&view.input.domChangeCount++,(ios&&view.input.lastIOSEnter>Date.now()-225||android)&&addedNodes.some(n=>1==n.nodeType&&!isInline.test(n.nodeName))&&(!change||change.endA>=change.endB)&&view.someProp("handleKeyDown",f=>f(view,keyEvent(13,"Enter"))))return void(view.input.lastIOSEnter=0);if(!change){if(!(typeOver&&sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3&&!sel.empty&&sel.$head.sameParent(sel.$anchor))||view.composing||parse.sel&&parse.sel.anchor!=parse.sel.head){if(parse.sel){let sel=resolveSelection(view,view.state.doc,parse.sel);if(sel&&!sel.eq(view.state.selection)){let tr=view.state.tr.setSelection(sel);compositionID&&tr.setMeta("composition",compositionID),view.dispatch(tr)}}return}change={start:sel.from,endA:sel.to,endB:sel.to}}view.state.selection.from<view.state.selection.to&&change.start==change.endB&&view.state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.U3&&(change.start>view.state.selection.from&&change.start<=view.state.selection.from+2&&view.state.selection.from>=parse.from?change.start=view.state.selection.from:change.endA<view.state.selection.to&&change.endA>=view.state.selection.to-2&&view.state.selection.to<=parse.to&&(change.endB+=view.state.selection.to-change.endA,change.endA=view.state.selection.to)),ie&&ie_version<=11&&change.endB==change.start+1&&change.endA==change.start&&change.start>parse.from&&"  "==parse.doc.textBetween(change.start-parse.from-1,change.start-parse.from+1)&&(change.start--,change.endA--,change.endB--);let nextSel,$from=parse.doc.resolveNoCache(change.start-parse.from),$to=parse.doc.resolveNoCache(change.endB-parse.from),$fromA=doc.resolve(change.start),inlineChange=$from.sameParent($to)&&$from.parent.inlineContent&&$fromA.end()>=change.endA;if((ios&&view.input.lastIOSEnter>Date.now()-225&&(!inlineChange||addedNodes.some(n=>"DIV"==n.nodeName||"P"==n.nodeName))||!inlineChange&&$from.pos<parse.doc.content.size&&(!$from.sameParent($to)||!$from.parent.inlineContent)&&!/\S/.test(parse.doc.textBetween($from.pos,$to.pos,"",""))&&(nextSel=prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.LN.findFrom(parse.doc.resolve($from.pos+1),1,!0))&&nextSel.head>$from.pos)&&view.someProp("handleKeyDown",f=>f(view,keyEvent(13,"Enter"))))return void(view.input.lastIOSEnter=0);if(view.state.selection.anchor>change.start&&function looksLikeBackspace(old,start,end,$newStart,$newEnd){if(end-start<=$newEnd.pos-$newStart.pos||skipClosingAndOpening($newStart,!0,!1)<$newEnd.pos)return!1;let $start=old.resolve(start);if(!$newStart.parent.isTextblock){let after=$start.nodeAfter;return null!=after&&end==start+after.nodeSize}if($start.parentOffset<$start.parent.content.size||!$start.parent.isTextblock)return!1;let $next=old.resolve(skipClosingAndOpening($start,!0,!0));return!(!$next.parent.isTextblock||$next.pos>end||skipClosingAndOpening($next,!0,!1)<end)&&$newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)}(doc,change.start,change.endA,$from,$to)&&view.someProp("handleKeyDown",f=>f(view,keyEvent(8,"Backspace"))))return void(android&&chrome&&view.domObserver.suppressSelectionUpdates());chrome&&change.endB==change.start&&(view.input.lastChromeDelete=Date.now()),android&&!inlineChange&&$from.start()!=$to.start()&&0==$to.parentOffset&&$from.depth==$to.depth&&parse.sel&&parse.sel.anchor==parse.sel.head&&parse.sel.head==change.endA&&(change.endB-=2,$to=parse.doc.resolveNoCache(change.endB-parse.from),setTimeout(()=>{view.someProp("handleKeyDown",function(f){return f(view,keyEvent(13,"Enter"))})},20));let markChange,chFrom=change.start,chTo=change.endA,mkTr=base=>{let tr=base||view.state.tr.replace(chFrom,chTo,parse.doc.slice(change.start-parse.from,change.endB-parse.from));if(parse.sel){let sel=resolveSelection(view,tr.doc,parse.sel);sel&&!(chrome&&view.composing&&sel.empty&&(change.start!=change.endB||view.input.lastChromeDelete<Date.now()-100)&&(sel.head==chFrom||sel.head==tr.mapping.map(chTo)-1)||ie&&sel.empty&&sel.head==chFrom)&&tr.setSelection(sel)}return compositionID&&tr.setMeta("composition",compositionID),tr.scrollIntoView()};if(inlineChange){if($from.pos==$to.pos){ie&&ie_version<=11&&0==$from.parentOffset&&(view.domObserver.suppressSelectionUpdates(),setTimeout(()=>selectionToDOM(view),20));let tr=mkTr(view.state.tr.delete(chFrom,chTo)),marks=doc.resolve(change.start).marksAcross(doc.resolve(change.endA));marks&&tr.ensureMarks(marks),view.dispatch(tr)}else if(change.endA==change.endB&&(markChange=function isMarkChange(cur,prev){let type,mark,update,curMarks=cur.firstChild.marks,prevMarks=prev.firstChild.marks,added=curMarks,removed=prevMarks;for(let i=0;i<prevMarks.length;i++)added=prevMarks[i].removeFromSet(added);for(let i=0;i<curMarks.length;i++)removed=curMarks[i].removeFromSet(removed);if(1==added.length&&0==removed.length)mark=added[0],type="add",update=node=>node.mark(mark.addToSet(node.marks));else{if(0!=added.length||1!=removed.length)return null;mark=removed[0],type="remove",update=node=>node.mark(mark.removeFromSet(node.marks))}let updated=[];for(let i=0;i<prev.childCount;i++)updated.push(update(prev.child(i)));if(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.FK.from(updated).eq(cur))return{mark,type}}($from.parent.content.cut($from.parentOffset,$to.parentOffset),$fromA.parent.content.cut($fromA.parentOffset,change.endA-$fromA.start())))){let tr=mkTr(view.state.tr);"add"==markChange.type?tr.addMark(chFrom,chTo,markChange.mark):tr.removeMark(chFrom,chTo,markChange.mark),view.dispatch(tr)}else if($from.parent.child($from.index()).isText&&$from.index()==$to.index()-($to.textOffset?0:1)){let text=$from.parent.textBetween($from.parentOffset,$to.parentOffset),deflt=()=>mkTr(view.state.tr.insertText(text,chFrom,chTo));view.someProp("handleTextInput",f=>f(view,chFrom,chTo,text,deflt))||view.dispatch(deflt())}}else view.dispatch(mkTr())}function resolveSelection(view,doc,parsedSel){return Math.max(parsedSel.anchor,parsedSel.head)>doc.content.size?null:selectionBetween(view,doc.resolve(parsedSel.anchor),doc.resolve(parsedSel.head))}function skipClosingAndOpening($pos,fromEnd,mayOpen){let depth=$pos.depth,end=fromEnd?$pos.end():$pos.pos;for(;depth>0&&(fromEnd||$pos.indexAfter(depth)==$pos.node(depth).childCount);)depth--,end++,fromEnd=!1;if(mayOpen){let next=$pos.node(depth).maybeChild($pos.indexAfter(depth));for(;next&&!next.isLeaf;)next=next.firstChild,end++}return end}function isSurrogatePair(str){if(2!=str.length)return!1;let a=str.charCodeAt(0),b=str.charCodeAt(1);return a>=56320&&a<=57343&&b>=55296&&b<=56319}class EditorView{constructor(place,props){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new InputState,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=props,this.state=props.state,this.directPlugins=props.plugins||[],this.directPlugins.forEach(checkStateComponent),this.dispatch=this.dispatch.bind(this),this.dom=place&&place.mount||document.createElement("div"),place&&(place.appendChild?place.appendChild(this.dom):"function"==typeof place?place(this.dom):place.mount&&(this.mounted=!0)),this.editable=getEditable(this),updateCursorWrapper(this),this.nodeViews=buildNodeViews(this),this.docView=docViewDesc(this.state.doc,computeDocDeco(this),viewDecorations(this),this.dom,this),this.domObserver=new DOMObserver(this,(from,to,typeOver,added)=>readDOMChange(this,from,to,typeOver,added)),this.domObserver.start(),function initInput(view){for(let event in handlers){let handler=handlers[event];view.dom.addEventListener(event,view.input.eventHandlers[event]=event=>{!eventBelongsToView(view,event)||runCustomHandler(view,event)||!view.editable&&event.type in editHandlers||handler(view,event)},passiveHandlers[event]?{passive:!0}:void 0)}safari&&view.dom.addEventListener("input",()=>null),ensureListeners(view)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let prev=this._props;this._props={};for(let name in prev)this._props[name]=prev[name];this._props.state=this.state}return this._props}update(props){props.handleDOMEvents!=this._props.handleDOMEvents&&ensureListeners(this);let prevProps=this._props;this._props=props,props.plugins&&(props.plugins.forEach(checkStateComponent),this.directPlugins=props.plugins),this.updateStateInner(props.state,prevProps)}setProps(props){let updated={};for(let name in this._props)updated[name]=this._props[name];updated.state=this.state;for(let name in props)updated[name]=props[name];this.update(updated)}updateState(state){this.updateStateInner(state,this._props)}updateStateInner(state,prevProps){var _a;let prev=this.state,redraw=!1,updateSel=!1;state.storedMarks&&this.composing&&(clearComposition(this),updateSel=!0),this.state=state;let pluginsChanged=prev.plugins!=state.plugins||this._props.plugins!=prevProps.plugins;if(pluginsChanged||this._props.plugins!=prevProps.plugins||this._props.nodeViews!=prevProps.nodeViews){let nodeViews=buildNodeViews(this);(function changedNodeViews(a,b){let nA=0,nB=0;for(let prop in a){if(a[prop]!=b[prop])return!0;nA++}for(let _ in b)nB++;return nA!=nB})(nodeViews,this.nodeViews)&&(this.nodeViews=nodeViews,redraw=!0)}(pluginsChanged||prevProps.handleDOMEvents!=this._props.handleDOMEvents)&&ensureListeners(this),this.editable=getEditable(this),updateCursorWrapper(this);let innerDeco=viewDecorations(this),outerDeco=computeDocDeco(this),scroll=prev.plugins==state.plugins||prev.doc.eq(state.doc)?state.scrollToSelection>prev.scrollToSelection?"to selection":"preserve":"reset",updateDoc=redraw||!this.docView.matchesNode(state.doc,outerDeco,innerDeco);!updateDoc&&state.selection.eq(prev.selection)||(updateSel=!0);let oldScrollPos="preserve"==scroll&&updateSel&&null==this.dom.style.overflowAnchor&&function storeScrollPos(view){let refDOM,refTop,rect=view.dom.getBoundingClientRect(),startY=Math.max(0,rect.top);for(let x=(rect.left+rect.right)/2,y=startY+1;y<Math.min(innerHeight,rect.bottom);y+=5){let dom=view.root.elementFromPoint(x,y);if(!dom||dom==view.dom||!view.dom.contains(dom))continue;let localRect=dom.getBoundingClientRect();if(localRect.top>=startY-20){refDOM=dom,refTop=localRect.top;break}}return{refDOM,refTop,stack:scrollStack(view.dom)}}(this);if(updateSel){this.domObserver.stop();let forceSelUpdate=updateDoc&&(ie||chrome)&&!this.composing&&!prev.selection.empty&&!state.selection.empty&&function selectionContextChanged(sel1,sel2){let depth=Math.min(sel1.$anchor.sharedDepth(sel1.head),sel2.$anchor.sharedDepth(sel2.head));return sel1.$anchor.start(depth)!=sel2.$anchor.start(depth)}(prev.selection,state.selection);if(updateDoc){let chromeKludge=chrome?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=findCompositionNode(this)),!redraw&&this.docView.update(state.doc,outerDeco,innerDeco,this)||(this.docView.updateOuterDeco(outerDeco),this.docView.destroy(),this.docView=docViewDesc(state.doc,outerDeco,innerDeco,this.dom,this)),chromeKludge&&!this.trackWrites&&(forceSelUpdate=!0)}forceSelUpdate||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function anchorInRightPlace(view){let anchorDOM=view.docView.domFromPos(view.state.selection.anchor,0),domSel=view.domSelectionRange();return isEquivalentPosition(anchorDOM.node,anchorDOM.offset,domSel.anchorNode,domSel.anchorOffset)}(this))?selectionToDOM(this,forceSelUpdate):(syncNodeSelection(this,state.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(prev),(null===(_a=this.dragging)||void 0===_a?void 0:_a.node)&&!prev.doc.eq(state.doc)&&this.updateDraggedNode(this.dragging,prev),"reset"==scroll?this.dom.scrollTop=0:"to selection"==scroll?this.scrollToSelection():oldScrollPos&&function resetScrollPos({refDOM,refTop,stack}){let newRefTop=refDOM?refDOM.getBoundingClientRect().top:0;restoreScrollStack(stack,0==newRefTop?0:newRefTop-refTop)}(oldScrollPos)}scrollToSelection(){let startDOM=this.domSelectionRange().focusNode;if(startDOM&&this.dom.contains(1==startDOM.nodeType?startDOM:startDOM.parentNode))if(this.someProp("handleScrollToSelection",f=>f(this)));else if(this.state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh){let target=this.docView.domAfterPos(this.state.selection.from);1==target.nodeType&&scrollRectIntoView(this,target.getBoundingClientRect(),startDOM)}else scrollRectIntoView(this,this.coordsAtPos(this.state.selection.head,1),startDOM);else;}destroyPluginViews(){let view;for(;view=this.pluginViews.pop();)view.destroy&&view.destroy()}updatePluginViews(prevState){if(prevState&&prevState.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let i=0;i<this.pluginViews.length;i++){let pluginView=this.pluginViews[i];pluginView.update&&pluginView.update(this,prevState)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let i=0;i<this.directPlugins.length;i++){let plugin=this.directPlugins[i];plugin.spec.view&&this.pluginViews.push(plugin.spec.view(this))}for(let i=0;i<this.state.plugins.length;i++){let plugin=this.state.plugins[i];plugin.spec.view&&this.pluginViews.push(plugin.spec.view(this))}}}updateDraggedNode(dragging,prev){let sel=dragging.node,found=-1;if(this.state.doc.nodeAt(sel.from)==sel.node)found=sel.from;else{let movedPos=sel.from+(this.state.doc.content.size-prev.doc.content.size);(movedPos>0&&this.state.doc.nodeAt(movedPos))==sel.node&&(found=movedPos)}this.dragging=new Dragging(dragging.slice,dragging.move,found<0?void 0:prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.nh.create(this.state.doc,found))}someProp(propName,f){let value,prop=this._props&&this._props[propName];if(null!=prop&&(value=f?f(prop):prop))return value;for(let i=0;i<this.directPlugins.length;i++){let prop=this.directPlugins[i].props[propName];if(null!=prop&&(value=f?f(prop):prop))return value}let plugins=this.state.plugins;if(plugins)for(let i=0;i<plugins.length;i++){let prop=plugins[i].props[propName];if(null!=prop&&(value=f?f(prop):prop))return value}}hasFocus(){if(ie){let node=this.root.activeElement;if(node==this.dom)return!0;if(!node||!this.dom.contains(node))return!1;for(;node&&this.dom!=node&&this.dom.contains(node);){if("false"==node.contentEditable)return!1;node=node.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function focusPreventScroll(dom){if(dom.setActive)return dom.setActive();if(preventScrollSupported)return dom.focus(preventScrollSupported);let stored=scrollStack(dom);dom.focus(null==preventScrollSupported?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),preventScrollSupported||(preventScrollSupported=!1,restoreScrollStack(stored,0))}(this.dom),selectionToDOM(this),this.domObserver.start()}get root(){let cached=this._root;if(null==cached)for(let search=this.dom.parentNode;search;search=search.parentNode)if(9==search.nodeType||11==search.nodeType&&search.host)return search.getSelection||(Object.getPrototypeOf(search).getSelection=()=>search.ownerDocument.getSelection()),this._root=search;return cached||document}updateRoot(){this._root=null}posAtCoords(coords){return posAtCoords(this,coords)}coordsAtPos(pos,side=1){return coordsAtPos(this,pos,side)}domAtPos(pos,side=0){return this.docView.domFromPos(pos,side)}nodeDOM(pos){let desc=this.docView.descAt(pos);return desc?desc.nodeDOM:null}posAtDOM(node,offset,bias=-1){let pos=this.docView.posFromDOM(node,offset,bias);if(null==pos)throw new RangeError("DOM position not inside the editor");return pos}endOfTextblock(dir,state){return endOfTextblock(this,state||this.state,dir)}pasteHTML(html,event){return doPaste(this,"",html,!1,event||new ClipboardEvent("paste"))}pasteText(text,event){return doPaste(this,text,null,!0,event||new ClipboardEvent("paste"))}serializeForClipboard(slice){return serializeForClipboard(this,slice)}destroy(){this.docView&&(!function destroyInput(view){view.domObserver.stop();for(let type in view.input.eventHandlers)view.dom.removeEventListener(type,view.input.eventHandlers[type]);clearTimeout(view.input.composingTimeout),clearTimeout(view.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],viewDecorations(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,reusedRange=null)}get isDestroyed(){return null==this.docView}dispatchEvent(event){return function dispatchEvent(view,event){runCustomHandler(view,event)||!handlers[event.type]||!view.editable&&event.type in editHandlers||handlers[event.type](view,event)}(this,event)}domSelectionRange(){let sel=this.domSelection();return sel?safari&&11===this.root.nodeType&&function deepActiveElement(doc){let elt=doc.activeElement;for(;elt&&elt.shadowRoot;)elt=elt.shadowRoot.activeElement;return elt}(this.dom.ownerDocument)==this.dom&&function safariShadowSelectionRange(view,selection){if(selection.getComposedRanges){let range=selection.getComposedRanges(view.root)[0];if(range)return rangeToSelectionRange(view,range)}let found;function read(event){event.preventDefault(),event.stopImmediatePropagation(),found=event.getTargetRanges()[0]}return view.dom.addEventListener("beforeinput",read,!0),document.execCommand("indent"),view.dom.removeEventListener("beforeinput",read,!0),found?rangeToSelectionRange(view,found):null}(this,sel)||sel:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function computeDocDeco(view){let attrs=Object.create(null);return attrs.class="ProseMirror",attrs.contenteditable=String(view.editable),view.someProp("attributes",value=>{if("function"==typeof value&&(value=value(view.state)),value)for(let attr in value)"class"==attr?attrs.class+=" "+value[attr]:"style"==attr?attrs.style=(attrs.style?attrs.style+";":"")+value[attr]:attrs[attr]||"contenteditable"==attr||"nodeName"==attr||(attrs[attr]=String(value[attr]))}),attrs.translate||(attrs.translate="no"),[Decoration.node(0,view.state.doc.content.size,attrs)]}function updateCursorWrapper(view){if(view.markCursor){let dom=document.createElement("img");dom.className="ProseMirror-separator",dom.setAttribute("mark-placeholder","true"),dom.setAttribute("alt",""),view.cursorWrapper={dom,deco:Decoration.widget(view.state.selection.from,dom,{raw:!0,marks:view.markCursor})}}else view.cursorWrapper=null}function getEditable(view){return!view.someProp("editable",value=>!1===value(view.state))}function buildNodeViews(view){let result=Object.create(null);function add(obj){for(let prop in obj)Object.prototype.hasOwnProperty.call(result,prop)||(result[prop]=obj[prop])}return view.someProp("nodeViews",add),view.someProp("markViews",add),result}function checkStateComponent(plugin){if(plugin.spec.state||plugin.spec.filterTransaction||plugin.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}EditorView.prototype.dispatch=function(tr){let dispatchTransaction=this._props.dispatchTransaction;dispatchTransaction?dispatchTransaction.call(this,tr):this.updateState(this.state.apply(tr))}}}]);